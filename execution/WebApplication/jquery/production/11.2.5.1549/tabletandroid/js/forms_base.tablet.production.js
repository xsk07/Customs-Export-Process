function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(t){function i(e,t,i){var a=r(e,t,i),n=a.tabsMetaInfo,o=a.tabMetaInfo,s=0;if(n&&o){var l="rtl"===i?n.scrollLeftNormalized+n.clientWidth-n.scrollWidth:n.scrollLeft;s=o.left-n.left+l}return{left:s,width:o?o.width:0}}function r(e,t,i){var r=void 0;if(e){var n=e.getBoundingClientRect();r={clientWidth:e?e.clientWidth:0,scrollLeft:e?e.scrollLeft:0,scrollLeftNormalized:e?a(e,i):0,scrollWidth:e?e.scrollWidth:0,left:n.left,right:n.right}}var o=void 0;return e&&!1!==t&&(o=t.getBoundingClientRect()),{tabsMetaInfo:r,tabMetaInfo:o}}function a(t,i){var r=t.scrollLeft;if("rtl"!==i)return r;var a=function(e){if(!e||!window.document.body)return"indeterminate";var t=window.document.createElement("div");t.appendChild(document.createTextNode("ABCD")),t.dir="rtl",t.style.fontSize="14px",t.style.width="4px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.overflow="scroll",document.body.appendChild(t),type="reverse",t.scrollLeft>0?type="default":(t.scrollLeft=1,0===t.scrollLeft&&(type="negative"));return document.body.removeChild(t),type}(t);if("indeterminate"===a)return Number.NaN;switch(a){case"negative":return e.scrollWidth-e.clientWidth+r;case"reverse":return e.scrollWidth-e.clientWidth-r}return r}t.fn.material_bizagi_tabs=function(e,a){var n=t.extend({},t.fn.material_bizagi_tabs.defaults,e),o={index:0,tabs:[],$el:void 0,$active:void 0,$active_content:void 0,init:function(e,a){var o,s=this,l=t(">ul.bz-tabs",e),d=s.$el=t(e);function c(e,t){if(void 0!==t){var a=i(l.get(0),e.get(0),n.direction);t.css("left",a.left).css("width",a.width)}var o=scrollSelectedIntoView(l.get(0),e.get(0),n.direction);l.scrollLeft(o),l.trigger("updatePositions",r(l.get(0),e.get(0),n.direction))}s.index=n.active_index_tab,t(">li.bz-tab",l).each((function(e,i){e===n.active_index_tab?(s.$active=t(this),s.$active.addClass("active")):t(t(i).data("reference"),d).hide(),s.tabs.push({index:e,element:i})})),s.$active_content=t(s.$active.data("reference"),d),c(s.$active),l.on("click","> li.bz-tab",(function(e){if(e.stopPropagation(),void 0===o){o=t("<li class='bz-indicator-bar'></li>");var r=i(l.get(0),s.$active.get(0),n.direction);o.css("left",r.left).css("width",r.width),o=l.prepend(o).find(".bz-indicator-bar")}s.$active.removeClass("active"),s.$active_content.hide(),s.$active=t(this);var a=s.$active.data("reference");s.index=s.$active.data("index"),s.$active_content=t(a,d),s.$active.addClass("active"),c(s.$active,o),l.trigger("updateActive",{index:s.index}),s.$active_content.show(),e.preventDefault()}))},getActiveTab:function(){return{index:this.index,tab:this.$active,contantTab:this.$active_content}},moveToNextTab:function(){var e=this.index+1<this.tabs.length?this.index+1:0;this.tabs[e].element.click()},refreshPositions:function(){this.tabs[this.index].element.click()},refreshTab:function(e){var i=this.tabs.find((function(i){var r=t(i.element).data("reference");return r&&-1!==r.indexOf(e)}));if(i)if(i.index===this.index){this.$active=t(i.element),this.$active.addClass("active");var r=this.$el,a=this.$active.data("reference");this.index=this.$active.data("index"),this.$active_content=t(a,r)}else t(t(i.element).data("reference"),this.$el).hide()}};return"string"==typeof e&&e?(void 0===(o=t(this).data("base"))&&console.error("this plugin is has not been initialized!!"),o[e](a)):this.each((function(){o.init(this,a),t(this).data("base",o)}))},t.fn.material_bizagi_tabs.defaults={direction:"ltr",active_index_tab:0},scrollSelectedIntoView=function(e,t,i){var a=r(e,t,i),n=a.tabsMetaInfo,o=a.tabMetaInfo;if(o&&n){var s=void 0;return o.left<n.left?s=n.scrollLeft+(o.left-n.left):o.right>n.right&&(s=n.scrollLeft+(o.right-n.right)),s}}}($),function(e){e.fn.mfb=function(t){"use strict";var i=this,r={element:e("<div class='mfb-component__overlay'></div>"),opened:!1};(t=t||{}).buttons=t.buttons||[],t.activePrincipalButton=t.activePrincipalButton||!1,t.placement=void 0!==t.placement&&-1!==["mfb-component--tl","mfb-component--tr","mfb-component--bl","mfb-component--br"].indexOf(t.placement)?t.placement:"mfb-component--br",t.efect=void 0!==t.efect&&-1!==["mfb-zoomin","mfb-slidein","mfb-slidein-spring","mfb-fountain"].indexOf(t.efect)?t.efect:"mfb-slidein",t.clickHoverOpt=t.clickHoverOpt||"click",t.toggleMethod=t.toggleMethod||"data-mfb-toggle",t.menuState=t.menuState||"data-mfb-state",t.menuStateValue=t.menuStateValue||"closed",t.isOpen=t.isOpen||"open",t.isClosed=t.isClosed||"closed",t.mainButtonClass=t.mainButtonClass||"mfb-component__button--main",t.restingIcon=t.restingIcon||"mo-icon bz-plus",t.activeIcon=t.activeIcon||"mo-icon bz-cross",e(this).children(".mfb-component-holder").remove();var a,n;function o(e,t,i){for(var r=0,a=e.length;r<a;r++)e[r].addEventListener(t,i,!1)}function s(e,t){t?(e.siblings().addClass("mfb-component__overlay--blur"),e.closest("[data-role]").siblings().addClass("mfb-component__overlay--blur")):(e.siblings().removeClass("mfb-component__overlay--blur"),e.closest("[data-role]").siblings().removeClass("mfb-component__overlay--blur"))}var l=kendo.template('<ul class="mfb-component-holder #: data.placement # #: data.efect #" #: data.toggleMethod #="#: data.clickHoverOpt #" #: data.menuState#="#: data.menuStateValue #">   <li class="mfb-component__wrap">      #if (data.activePrincipalButton && data.buttons.length >= 1){#       <a #if(typeof data.buttons[0].label !== "undefined"){# data-mfb-label="#: data.buttons[0].label #"#}# class="mfb-component__button--main">           <i class="mfb-component__main-icon--resting mfb-icon-font bz-#:data.restingIcon#"></i><i class="mfb-component__main-icon--active mfb-icon-font bz-#:data.buttons[0].icon#"></i>       </a>       #}else{#       <a #if(typeof data.label !== "undefined"){# data-mfb-label="#: data.label #"#}# class="mfb-component__button--main">           <i class="mfb-component__main-icon--resting mfb-icon-font bz-#:data.restingIcon#"></i><i class="mfb-component__main-icon--active mfb-icon-font bz-#:data.activeIcon#"></i>       </a>       #}#       # if(data.buttons.length > 0){#       <ul class="mfb-component__list">           #for(var i = (data.activePrincipalButton ? 1 : 0), len = data.buttons.length; i< len; i++){#           <li data-id="#: data.buttons[i].id #">               <a href="#: data.buttons[i].link #" data-index="#: i#" #if(typeof data.buttons[i].label !== "undefined"){# data-mfb-label="#: data.buttons[i].label #"#}# class="mfb-component__button--child">                  <i class="mfb-component__child-icon mfb-icon-font bz-#: data.buttons[i].icon #"></i>               </a>           </li>           #}#       </ul>       #}#   </li></ul>',{useWithBlock:!1})(t);"prepend"===t.position?this.prepend(l):this.append(l);var d=t.buttons.length>0?function(i){for(a=i.target;a&&!a.getAttribute(t.toggleMethod);)if(!(a=a.parentNode))return;if(n=a.getAttribute(t.menuState)===t.isOpen?t.isClosed:t.isOpen,t.activePrincipalButton&&"open"!==n){var o=t.buttons[0];t.click&&t.click(i,e.extend(o,{principal:!0}),this),s(e(a),!0)}"open"!==n||r.opened?(r.element.remove(),s(e(a),!1)):(r.element.appendTo(a).bind("click",(function(){this.remove(),r.opened=!1,a.setAttribute(t.menuState,"close"),s(e(a),!1)})),s(e(a),!0)),r.opened=!r.opened,a.setAttribute(t.menuState,n)}:function(e){t.click&&(e.preventDefault(),t.click(e,{principal:!0},this))};o(e("["+t.toggleMethod+"='"+t.clickHoverOpt+"'] ."+t.mainButtonClass,this),"click",d),o(e(".mfb-component__button--child",this),"click",(function(r){var a=e(this).data("index"),n=t.buttons[a];e(".mfb-component__overlay",i).click(),t.click&&(r.preventDefault(),t.click(r,e.extend(n,{principal:!1}),this))}))}}(jQuery),function(e){e.fn.bz_navigation_buttons=function(t){var i=(t=t||{}).buttons||[],r=t.isDesign||!1,a=t.buttonSelected,n=t.lastActionExecuted||!1,o=t.allowAddButtons||!1,s=this;s.empty(),s.addClass("bz-buttons--navigation");var l=e('<ul class="bz-buttons--container"></ul>');l.appendTo(s);return function(){for(var t=2,d=0;d<i.length;d++)!function(i){var n=i.properties.caption,o=e('<li class="bz-button--container" data-id="{1}"><button class="bz-btn">{0}</button></li>'.replace("{0}",n).replace("{1}",i.properties.id)),s=0,d=function(){l.trigger("onSelectButton",{$element:o,button:i});var e=l.get(0),t=e.clientWidth,a=r?35:0;e.scrollWidth>t&&(s>t?e.scrollLeft=s-t+a:s-e.scrollLeft<e.scrollLeft&&(e.scrollLeft=s-(e.scrollLeft+a)))};o.on("click",d).appendTo(l),s=t=t+o.get(0).offsetWidth+2,r&&"string"==typeof a&&i.properties.id==a&&setTimeout(d,100)}(i[d].button);if(r){var c=e('<div class="bz-button--add"><svg class="ico_16x16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-plus"></use></svg></div>');o&&(c.click((function(){l.trigger("onAddButton")})),c.appendTo(s));var u=l.get(0),p=c.get(0).scrollWidth,h=s.get(0).scrollWidth,g=u.scrollWidth,m=e('<div class="bz-button--rigth"><svg class="ico_16x16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-arrow-rigth"></use></svg></div>'),f=g>h-p;f&&m.insertAfter(l),m.on("click",(function(){u.scrollLeft+=40}));var b=!1,v=e('<div class="bz-button--left"><svg class="ico_16x16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-arrow-left"></use></svg></div>');v.on("click",(function(){u.scrollLeft-=40})),l.on("scroll",(function(e){var t=e.target,i=t.scrollWidth-t.clientWidth,r=t.scrollLeft;0===r&&b&&(b=!1,v.detach()),f&&r===i&&(f=!1,m.detach()),!b&&r>0&&(v.prependTo(s),b=!0),!f&&r<i&&(f=!0,m.insertAfter(l))})),"addButton"===n&&f&&(u.scrollLeft=u.scrollWidth-u.clientWidth)}}(),l}}(jQuery),function(e){var t;if(void 0===t){var i=e('<div style="background:none;display:none;"/>').appendTo("body");t=i.css("backgroundColor"),i.remove()}e.fn.rippleEffect=function(i){var r=e.extend({},e.fn.rippleEffect.defaults,i);return this.each((function(){e(this).on("click",(function(i){var a,n,o,s,l,d,c,u,p=e(this),h=i.type;function g(){return""!=r.inkColor?r.inkColor:function(i,r){var a,n,o,s;a=function(e,i){return function e(r){return r.css("backgroundColor")==t?r.is("body")?i||t:e(r.parent()):r.css("backgroundColor")}(e)}(i,r),n=e.fn.rippleEffect.colorToHex(a),s=(o=e.fn.rippleEffect.getLuminationValue(n))<=239?o<=70?e.fn.rippleEffect.getColorLuminance(n,.8):e.fn.rippleEffect.getColorLuminance(n,.2):e.fn.rippleEffect.getColorLuminance(n,-.15);return s}(u,r.inkDefaultColor)}if(u=p,""!=r.appendInkTo&&(u=p.closest(r.appendInkTo)),0==u.find("."+r.inkClass).length&&u.append('<span class="'+r.inkContainerClass+'"><span class="'+r.inkClass+'"></span></span>'),(c=u.find("."+r.inkContainerClass+" >  ."+r.inkClass)).removeClass("animate"),!c.height()&&!c.width()){if(l=Math.max(u.outerWidth(),u.outerHeight()),void 0!==p.data("ripple")&&""!=p.data("ripple"))d=p.data("ripple");else if(void 0!==p.data("ripple-getcolorfromid")&&""!=p.data("ripple-getcolorfromid")){var m=p.data("ripple-getcolorfromid");d=e(m).length>0?e(m).css("background-color"):g()}else d=g();c.css({height:l,width:l,"background-color":d})}if("click"===h)a=i.pageX,n=i.pageY;else if("touchstart"===h){var f=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];a=f.pageX,n=f.pageY}o=a-u.offset().left-c.width()/2,s=n-u.offset().top-c.height()/2,c.css({top:s+"px",left:o+"px"}).addClass("animate"),setTimeout((function(){c.removeClass("animate")}),400)}))}))},e.fn.rippleEffect.defaults={inkContainerClass:"ripple",inkClass:"ink",inkDefaultColor:"#F0F0F0",inkColor:"",appendInkTo:""},e.fn.rippleEffect.getLuminationValue=function(e){e=e.substring(1);var t=parseInt(e,16);return.2126*(t>>16&255)+.7152*(t>>8&255)+.0722*(t>>0&255)},e.fn.rippleEffect.getColorLuminance=function(e,t){(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var i,r,a="#";for(r=0;r<3;r++)i=parseInt(e.substr(2*r,2),16),a+=("00"+(i=Math.round(Math.min(Math.max(0,i+i*t),255)).toString(16))).substr(i.length);return a},e.fn.rippleEffect.colorToHex=function(e){return"#"===e.substr(0,1)?color:(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}}(jQuery),function(e){e.widget("ui.bizagi_grid_tablet",e.ui.bizagi_grid,{_init:function(){this._super(),this.isOfflineForm=void 0!==this.options.isOfflineForm&&bizagi.util.parseBoolean(this.options.isOfflineForm)},attachHandlers:function(){var t=this;t._getComponent("pager").find("ul li button").bind("click",(function(){var i=parseInt(e(this).attr("data-page-number"));i&&t.changePage(i)})),t._getComponent("dynamicPager").find("input").bind("click",(function(){t.selectDynamicPager()})),t._getComponent("columns").find(".bz-tablet-grid__label.bz-table__column-sort").bind("click",(function(){if(!t.isOfflineForm){var i=e(this).attr("data-column-index");t.sortBy(i)}})),t._getComponent("buttons").find("[data-action]").bind("click",(function(){"totalizer"===e(this).attr("data-action")?t.totalizer():(t.processAction(e(this).attr("data-action")),t.unselectRow())})),t._getComponent("rowButtons").find("[data-action]").bind("click",(function(){t.processAction(e(this).attr("data-action")),t.unselectRow()})),bizagi.util.isiOSDevice()&&t._resizeListener(),this.isOfflineForm?t._getComponent("rows").on("click",".bz-tablet-grid__cell-actions [data-action=more]",(function(i){var r=e(i.target).parents("[data-bizagi-component=cells]");if(r&&r.hasClass("bz-tablet-grid__row")){var a=r.attr("data-business-key");bizagi.util.parseBoolean(r.attr("data-new-row"))||!1?t.onRemoveNewRow(a):t.processAction("remove",{key:a})}})):(t._getComponent("rows").find("tr").bind("click",(function(i){var r=e(i.target).closest(".bz-tablet-grid__cell");if(i.stopPropagation(),r&&r.hasClass("bz-tablet-grid__cell")){var a=e(this).attr("data-key"),n=e(this).attr("data-business-key");t.selectRow(a,n)}})),t._addColumnActions())},totalizer:function(){this.options.totalData()},onRowSelected:function(){e.ui.bizagi_grid.prototype.onRowSelected.apply(this,arguments),this._showRowButtons()},onRowUnselected:function(){e.ui.bizagi_grid.prototype.onRowUnselected.apply(this,arguments),this._hideRowButtons()},getCell:function(t,i,r){var a,n=this._getComponent("rows").find("[data-business-key="+t+"]");return a=e("td",e(n))[r+1],e(a)},_canShowButtons:function(){var e=this.options.actions;return this.isOfflineForm?e.add||e.remove||e.edit||e.inlineAdd:e.add||e.hasTotalizer},drawRow:function(t,i){var r=this,a=r.options,n=t[r.columnKeyIndex],o=i||!1,s=Math.floor(1e4*Math.random()),l=e.fasttmpl(a.template.row,{key:s,isNewRow:i,businessKey:n}),d="";return e.each(t,(function(e,t){d+=r.drawCell(e,n,t,o)})),r._canShowRowButtons()&&(d+=r.drawSpecialCell(r.options.columns.length+1)),l=r._replaceElement(l,"cells",d)},drawPager:function(){for(var t=this.options,i=[],r=1;r<=this.data.total;r++)i.push({number:r,active:r==this.data.page});var a={renderPages:this.data.page<3||this.data.page>this.data.total-2?[]:[this.data.page-1,this.data.page,this.data.page+1],pages:i,pagination:{totalPages:this.data.total,currentPage:this.data.page}};return e.fasttmpl(t.template.pager,a)},_canShowRowButtons:function(){var e=this.options.actions;return this.isOfflineForm?e.remove:e.edit||e.details||e.remove||"adhocGrid"==this.options.subType},_showRowButtons:function(){window.document;this.element.find("[data-bizagi-component=rows] tr[data-key="+this.selectedRow+"]").addClass("ui-bizagi-state-selected")},_hideRowButtons:function(){var t=this;e.ui.bizagi_grid.prototype.onRowUnselected.apply(t,arguments);var i=t._getComponent("rows").find("tr[data-key="+t.selectedRow+"]");if(i.removeClass("ui-bizagi-state-selected"),!t.isOfflineForm){var r=t._getComponent("rowButtons");r.hide()}},getNewRowKeys:function(t){return t=t||this._getComponent("rows").find("[data-new-row=true]"),e.map(t,(function(t,i){return e(t).data("business-key")}))},processAction:function(t){var i=this;e.ui.bizagi_grid.prototype.processAction.apply(i,arguments),"save"===t&&i.onSaveAddedRows(),"cancel"===t&&i.onCancelEdition()},isNewRecord:function(t){var i=this._getComponent("rows");return!(!i||(t=i.find("[data-business-key='"+t+"']"),!e(t).data("new-row")))},addInlineRow:function(){this._triggerHandler("beforeInlineAdd");var t=this.drawRow(this.createAddRowData(),!0),i=e(t);this.postRenderRow(i),this._getComponent("rows").append(i);var r=this._getComponent("buttons");this.isOfflineForm?(r.find("[data-action=save]").removeClass("bz-tablet-grid__buttons--hidden"),r.find("[data-action=cancel]").removeClass("bz-tablet-grid__buttons--hidden")):(r.find("[data-action=save]").css("display","inline-block"),r.find("[data-action=cancel]").css("display","inline-block")),0===this.data.rows.length&&(this._getComponent("table").show(),this._getComponent("emptyTable").hide()),this._triggerHandler("afterInlineAdd",i.data())},createAddRowData:function(){var t=this,i=t.options,r=[];return e.each(i.columns,(function(e){if(e===t.columnKeyIndex){var i=Math.ceil(1e5*Math.random());r.push(i)}else r.push(null)})),r},onAddRow:function(){if(this.options.actions.add)return this.options.actions.inlineAdd?this.addInlineRow():this._triggerHandler("addRow")},onCancelEdition:function(){var e=this._getComponent("rows").find("[data-new-row=true]"),t=this._getComponent("rows").find("[data-new-row=false]");e.detach();var i=this._getComponent("buttons");return this.isOfflineForm?(i.find("[data-action=save]").addClass("bz-tablet-grid__buttons--hidden"),i.find("[data-action=cancel]").addClass("bz-tablet-grid__buttons--hidden")):(i.find("[data-action=save]").hide(),i.find("[data-action=cancel]").hide()),0===t.length&&(this._getComponent("table").hide(),this._getComponent("emptyTable").show()),this._triggerHandler("cancelEdition",{keys:this.getNewRowKeys(e)})},onSaveAddedRows:function(){var t=this.getNewRowKeys(),i=this._getComponent("buttons");if(t.length>=1&&this.isValid()){var r=this._getComponent("rows");return this.isOfflineForm?(e.each(t,(function(t,i){var a=r.find("[data-business-key='"+i+"']");e(a).attr("data-new-row","false")})),i.find("[data-action=save]").addClass("bz-tablet-grid__buttons--hidden"),i.find("[data-action=cancel]").addClass("bz-tablet-grid__buttons--hidden"),this._triggerHandler("saveAddedRows",{keys:t}),!0):(i.find("[data-action=save]").hide(),i.find("[data-action=cancel]").hide(),this._triggerHandler("saveAddedRows",{keys:t}),this._triggerHandler("removeNewRecords",{keys:t}))}return!0},hideHeaderButtons:function(){var e=this._getComponent("buttons");e&&e.length&&(e.find("[data-action=save]").addClass("bz-tablet-grid__buttons--hidden"),e.find("[data-action=cancel]").addClass("bz-tablet-grid__buttons--hidden"))},_addColumnActions:function(){var t=this,i=[];t.options.actions.details&&i.push({name:bizagi.localization.getResource("render-collection-navigator-details-form"),fn:function(i){var r=e(i).parents("[data-bizagi-component=cells]").attr("data-business-key");t.options.actions.details?t.processAction("details",{key:r}):t.processAction("more",{key:r})}}),t.options.actions.edit&&i.push({name:bizagi.localization.getResource("render-grid-edit-label"),fn:function(i){var r=e(i).parents("[data-bizagi-component=cells]").attr("data-business-key");t.processAction("edit",{key:r})}}),t.options.actions.remove&&i.push({name:bizagi.localization.getResource("render-ecm-confirm-bt-delete"),fn:function(i){var r=e(i).parents("[data-bizagi-component=cells]").attr("data-business-key");t.processAction("remove",{key:r})}}),t._getComponent("rows").find("[data-action=more]").overflowMenu({items:i})},onRemoveNewRow:function(e){var t=this._getComponent("buttons"),i=this._getComponent("rows").find("tr[data-business-key="+e+"]"),r=this._getComponent("rows").find("[data-new-row=false]"),a=this._getComponent("rows").find("[data-new-row=true]");return i.detach(),1===a.length&&(t.find("[data-action=save]").addClass("bz-tablet-grid__buttons--hidden"),t.find("[data-action=cancel]").addClass("bz-tablet-grid__buttons--hidden")),0===r.length&&1===a.length&&(this._getComponent("table").hide(),this._getComponent("emptyTable").show()),this._triggerHandler("cancelEdition",{keys:this.getNewRowKeys(i)})},_replaceElement:function(e,t,i){return e.replace(new RegExp("{{element "+t+"}}","g"),i)},_resizeListener:function(){var t=Math.ceil(1e5*Math.random()),i=0,r=this,a=r._getComponent("table"),n=new IntersectionObserver((function(n){n.forEach((function(i){i.isIntersecting?e(window).on("resize."+t,r._fixHorizontalScroll.bind(r)):e(window).off("resize."+t)})),i!=a.width()&&(i=a.width(),r._fixHorizontalScroll())}));n.POLL_INTERVAL=100,n.observe(r._getComponent("table").get(0))},_fixHorizontalScroll:function(){var e=this._getComponent("table");e.css({webkitOverflowScrolling:"auto","overflow-x":"hidden"}),setTimeout((function(){e.css({webkitOverflowScrolling:"touch","overflow-x":"auto"})}),10)}})}(jQuery),function(e){e.fn.bztabs=function(t){var i=e(this);(t=t||{}).activeTab=t.activeTab||0,t.tabNumber=t.tabNumber||1;var r=t.activate&&"function"==typeof t.activate?t.activate:function(){},a=(t.beforeActivate&&"function"==typeof t.beforeActivate&&t.beforeActivate,i.find(">div.bz-bizagi-container-tap-popup").hide()),n=a.children().length,o=e("<div class='bz-header_select'></div>"),s=t.tabNumber>n?n:t.tabNumber,l=Math.floor(100/Number(s));a.children().each((function(e,t){o.append("<div class='bz-wp-tabs-ui bz-wp-tabs-item' data-index='"+e+"' data-reference-tab='"+t.getAttribute("data-reference-tab")+"'><span>"+t.textContent+"</span></div>")})),o.find("> .bz-wp-tabs-ui").css("width",l+"%"),o.append("<div class='bz-wp-tabs-arrow-container'><div class='bz-cm-icon bz-mo-icon bz-plus'></div></div>"),i.prepend(o);var d=i.find("> .bz-bizagi-container-tap-popup > .bz-container-items-tabs").eq(t.activeTab);e(e(d).data("reference-tab"),i).addClass("childrenActive"),d.addClass("tabSelected");var c=e(".bz-wp-tabs-ui:nth-child("+(t.activeTab+1)+")",o).addClass("tabSelected"),u=l+(100-l*s);function p(){t.tabNumber<n?(e(".bz-wp-tabs-arrow-container",i).first().addClass("show-pluss"),o.addClass("show-pluss"),c.trigger("click",{origin:"popUp"})):(e(".bz-wp-tabs-arrow-container",i).removeClass("show-pluss"),o.removeClass("show-pluss"),o.find("> .bz-wp-tabs-ui:last").addClass("bz-wp-no-border"))}function h(t,n){if((n=n||{}).origin=n.origin||"header",t.stopPropagation(),t.preventDefault(),!e(this).hasClass("tabSelected")||"popUp"===n.origin){var s=t.currentTarget.getAttribute("data-reference-tab"),d=e(s,i);c=e(t.currentTarget),i.find(">div.childrenActive").removeClass("childrenActive"),d.addClass("childrenActive"),o.find(">div.tabSelected").removeClass("tabSelected").css("width",l+"%"),"block"===a.css("display")&&a.toggle(),n.origin&&"popUp"===n.origin&&(c=e("[data-reference-tab='"+s+"']",o),function(e){var t=o.find(".bz-wp-tabs-ui"),i=!0;t.each((function(t,r){e!==r.getAttribute("data-reference-tab")&&i?(o.remove("[data-reference-tab='"+e+"']"),o.append(r)):i=!1}))}(s)),c.addClass("tabSelected").css("width",u+"%"),r(t,n)}}c.css("width",u+"%"),void 0!==t.domIncluded?e.when(t.domIncluded).done((function(){p()})):p(),i.find(".bz-wp-tabs-arrow-container").first().bind("click",(function(t){var i=o.innerWidth()-29,r=0;e(".bz-container-items-tabs",a).removeClass("show"),o.find(".bz-wp-tabs-ui").each((function(t,n){(r+=e(":first-child",n).outerWidth())>i&&a.children().each((function(t,i){if(i.textContent===n.textContent)return e(i).addClass("show"),e(".cell.bz-container-items-tabs").css("border-bottom",""),void e(".cell.bz-container-items-tabs.show").last().css("border-bottom","none")}))})),t.stopPropagation(),t.preventDefault(),a.toggle()})),e(">div.cell",a).bind("click",(function(e){h(e,{origin:"popUp"})})),e(".bz-wp-tabs-ui",o).bind("click",h),o.bind("resizeHeader",(function(){p()}))}}(jQuery),function(e,t){e.mobiscroll=function(e){"use strict";function t(e,t,i){var r=e;return"object"===(void 0===t?"undefined":I(t))?e.each((function(){new t.component(this,t)})):("string"==typeof t&&e.each((function(){var e,a=A.instances[this.id];if(a&&a[t]&&void 0!==(e=a[t].apply(this,Array.prototype.slice.call(i,1))))return r=e,!1})),r)}function i(){}function r(e){var t,i=[];for(t in e)i.push(e[t]);return i}function a(e){return e-parseFloat(e)>=0}function n(e){return"string"==typeof e}function o(e,t,i){return Math.max(t,Math.min(e,i))}function s(e,t){for(e+="",t=t||2;e.length<t;)e="0"+e;return e}function l(){K++,setTimeout((function(){K--}),500)}function d(e,t,i){var r=e.originalEvent||e,a=(i?"page":"client")+t;return r.targetTouches&&r.targetTouches[0]?r.targetTouches[0][a]:r.changedTouches&&r.changedTouches[0]?r.changedTouches[0][a]:e[a]}function c(e,t,i,r,a,n){var o,s,c,u,p,h=(0,A.$)(t);a=a||9,e.settings.tap&&h.on("touchstart.mbsc",(function(e){c||(r&&e.preventDefault(),c=this,o=d(e,"X"),s=d(e,"Y"),u=!1,p=new Date)})).on("touchcancel.mbsc",(function(){c=!1})).on("touchmove.mbsc",(function(e){c&&!u&&(Math.abs(d(e,"X")-o)>a||Math.abs(d(e,"Y")-s)>a)&&(u=!0)})).on("touchend.mbsc",(function(e){c&&(n&&new Date-p<100||!u?function(e,t){if(!t.mbscClick){var i=(e.originalEvent||e).changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),r.isMbscTap=!0,r.isIonicTap=!0,Z=!0,t.mbscChange=!0,t.mbscClick=!0,t.dispatchEvent(r),Z=!1,l(),setTimeout((function(){delete t.mbscClick}))}}(e,e.target):l(),c=!1)})),h.on("click.mbsc",(function(t){r&&t.preventDefault(),i.call(this,t,e)}))}function u(e){if(K&&!Z&&!e.isMbscTap&&("TEXTAREA"!=e.target.nodeName||"mousedown"!=e.type))return e.stopPropagation(),e.preventDefault(),!1}function p(e){return e[0].innerWidth||e.innerWidth()}function h(e,t,i,r,a,n,o){var s=new Date(e,t,i,r||0,a||0,n||0,o||0);return 23==s.getHours()&&0===(r||0)&&s.setHours(s.getHours()+2),s}function g(e,t,i){if(!t)return null;var r,a,n=oe({},pe,i),o=function(t){for(var i=0;r+1<e.length&&e.charAt(r+1)==t;)i++,r++;return i},s=function(e,t,i){var r=""+t;if(o(e))for(;r.length<i;)r="0"+r;return r},l=function(e,t,i,r){return o(e)?r[t]:i[t]},d="",c=!1;for(r=0;r<e.length;r++)if(c)"'"!=e.charAt(r)||o("'")?d+=e.charAt(r):c=!1;else switch(e.charAt(r)){case"d":d+=s("d",n.getDay(t),2);break;case"D":d+=l("D",t.getDay(),n.dayNamesShort,n.dayNames);break;case"o":d+=s("o",(t.getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5,3);break;case"m":d+=s("m",n.getMonth(t)+1,2);break;case"M":d+=l("M",n.getMonth(t),n.monthNamesShort,n.monthNames);break;case"y":a=n.getYear(t),d+=o("y")?a:(a%100<10?"0":"")+a%100;break;case"h":var u=t.getHours();d+=s("h",u>12?u-12:0===u?12:u,2);break;case"H":d+=s("H",t.getHours(),2);break;case"i":d+=s("i",t.getMinutes(),2);break;case"s":d+=s("s",t.getSeconds(),2);break;case"a":d+=t.getHours()>11?n.pmText:n.amText;break;case"A":d+=t.getHours()>11?n.pmText.toUpperCase():n.amText.toUpperCase();break;case"'":o("'")?d+="'":c=!0;break;default:d+=e.charAt(r)}return d}function m(e,t,i){var r=oe({},pe,i),a=C(r.defaultValue||new Date);if(!e||!t)return a;if(t.getTime)return t;t="object"==(void 0===t?"undefined":I(t))?t.toString():t+"";var n,o=r.shortYearCutoff,s=r.getYear(a),l=r.getMonth(a)+1,d=r.getDay(a),c=-1,u=a.getHours(),p=a.getMinutes(),h=0,g=-1,m=!1,f=function(t){var i=n+1<e.length&&e.charAt(n+1)==t;return i&&n++,i},b=function(e){f(e);var i=new RegExp("^\\d{1,"+("@"==e?14:"!"==e?20:"y"==e?4:"o"==e?3:2)+"}"),r=t.substr(x).match(i);return r?(x+=r[0].length,parseInt(r[0],10)):0},v=function(e,i,r){var a,n=f(e)?r:i;for(a=0;a<n.length;a++)if(t.substr(x,n[a].length).toLowerCase()==n[a].toLowerCase())return x+=n[a].length,a+1;return 0},y=function(){x++},x=0;for(n=0;n<e.length;n++)if(m)"'"!=e.charAt(n)||f("'")?y():m=!1;else switch(e.charAt(n)){case"d":d=b("d");break;case"D":v("D",r.dayNamesShort,r.dayNames);break;case"o":c=b("o");break;case"m":l=b("m");break;case"M":l=v("M",r.monthNamesShort,r.monthNames);break;case"y":s=b("y");break;case"H":u=b("H");break;case"h":u=b("h");break;case"i":p=b("i");break;case"s":h=b("s");break;case"a":g=v("a",[r.amText,r.pmText],[r.amText,r.pmText])-1;break;case"A":g=v("A",[r.amText,r.pmText],[r.amText,r.pmText])-1;break;case"'":f("'")?y():m=!0;break;default:y()}if(s<100&&(s+=(new Date).getFullYear()-(new Date).getFullYear()%100+(s<=("string"!=typeof o?o:(new Date).getFullYear()%100+parseInt(o,10))?0:-100)),c>-1){l=1,d=c;do{var T=32-new Date(s,l-1,32,12).getDate();d>T&&(l++,d-=T)}while(d>T)}u=-1==g?u:g&&u<12?u+12:g||12!=u?u:0;var w=r.getDate(s,l-1,d,u,p,h);return r.getYear(w)!=s||r.getMonth(w)+1!=l||r.getDay(w)!=d?a:w}function f(e,t){return Math.round((t-e)/864e5)}function b(e){return h(e.getFullYear(),e.getMonth(),e.getDate())}function v(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function y(e,t,i){var r,a,n={y:1,m:2,d:3,h:4,i:5,s:6,u:7,tz:8};if(i)for(r in n)(a=e[n[r]-t])&&(i[r]="tz"==r?a:1)}function x(e,t,i){var r=window.moment||t.moment,a=t.returnFormat;if(e){if("moment"==a&&r)return r(e);if("locale"==a)return g(i,e,t);if("iso8601"==a)return function(e,t){var i="",r="";return e&&(t.h&&(r+=s(e.getHours())+":"+s(e.getMinutes()),t.s&&(r+=":"+s(e.getSeconds())),t.u&&(r+="."+s(e.getMilliseconds(),3)),t.tz&&(r+=t.tz)),t.y?(i+=e.getFullYear(),t.m&&(i+="-"+s(e.getMonth()+1),t.d&&(i+="-"+s(e.getDate())),t.h&&(i+="T"+r))):t.h&&(i=r)),i}(e,t.isoParts)}return e}function C(e,t,i,r){var a;return e?e.getTime?e:e.toDate?e.toDate():("string"==typeof e&&(e=e.trim()),(a=de.exec(e))?(y(a,2,r),new Date(1970,0,1,a[2]?+a[2]:0,a[3]?+a[3]:0,a[4]?+a[4]:0,a[5]?+a[5]:0)):(a||(a=le.exec(e)),a?(y(a,0,r),new Date(a[1]?+a[1]:1970,a[2]?a[2]-1:0,a[3]?+a[3]:1,a[4]?+a[4]:0,a[5]?+a[5]:0,a[6]?+a[6]:0,a[7]?+a[7]:0)):m(t,e,i))):null}function T(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function w(e){var t;for(t in e)if(void 0!==ge[e[t]])return!0;return!1}function z(e,t){if("touchstart"==e.type)ee(t).attr("data-touch","1");else if(ee(t).attr("data-touch"))return ee(t).removeAttr("data-touch"),!1;return!0}function S(e,t){var i,r=getComputedStyle(e[0]);return ee.each(["t","webkitT","MozT","OT","msT"],(function(e,t){if(void 0!==r[t+"ransform"])return i=r[t+"ransform"],!1})),i=i.split(")")[0].split(", "),t?i[13]||i[5]:i[12]||i[4]}function D(e){if(e){if(ye[e])return ye[e];var t=ee('<div style="background-color:'+e+';"></div>').appendTo("body"),i=getComputedStyle(t[0]).backgroundColor.replace(/rgb|rgba|\(|\)|\s/g,"").split(","),r=.299*i[0]+.587*i[1]+.114*i[2]<130?"#fff":"#000";return t.remove(),ye[e]=r,r}}function E(e,t,r,a,n,o){function s(e){var t;g=ee(this),C=+g.attr("data-step"),f=+g.attr("data-index"),m=!0,n&&e.stopPropagation(),"touchstart"==e.type&&g.closest(".mbsc-no-touch").removeClass("mbsc-no-touch"),"mousedown"==e.type&&e.preventDefault(),"keydown"!=e.type?(y=d(e,"X"),x=d(e,"Y"),t=z(e,this)):t=32===e.keyCode,b||!t||g.hasClass("mbsc-disabled")||(p(f,C,e)&&(g.addClass("mbsc-active"),o&&o.addRipple(g.find(".mbsc-segmented-content"),e)),"mousedown"==e.type&&ee(document).on("mousemove",l).on("mouseup",c))}function l(e){(Math.abs(y-d(e,"X"))>7||Math.abs(x-d(e,"Y"))>7)&&(m=!0,u())}function c(e){"touchend"==e.type&&e.preventDefault(),u(),"mouseup"==e.type&&ee(document).off("mousemove",l).off("mouseup",c)}function u(){b=!1,clearInterval(T),g&&(g.removeClass("mbsc-active"),o&&setTimeout((function(){o.removeRipple()}),100))}function p(e,t,i){return b||w(e)||(f=e,C=t,v=i,b=!0,m=!1,setTimeout(h,100)),b}function h(){return g&&g.hasClass("mbsc-disabled")?void u():(!b&&m||(m=!0,t(f,C,v,h)),void(b&&r&&(clearInterval(T),T=setInterval((function(){t(f,C,v)}),r))))}var g,m,f,b,v,y,x,C,T,w=a||i;return e.on("touchstart mousedown keydown",s).on("touchmove",l).on("touchend touchcancel keyup",c),{start:p,stop:u,destroy:function(){e.off("touchstart mousedown keydown",s).off("touchmove",l).off("touchend touchcancel keyup",c)}}}function R(e,t,i){function r(){l.style.width="100000px",l.style.height="100000px",s.scrollLeft=1e5,s.scrollTop=1e5,u.scrollLeft=1e5,u.scrollTop=1e5}function a(){var e=new Date;d=0,p||(e-h>200&&!s.scrollTop&&!s.scrollLeft&&(h=e,r()),d||(d=j(a)))}function n(){c||(c=j(o))}function o(){c=0,r(),t()}var s=void 0,l=void 0,d=void 0,c=void 0,u=void 0,p=void 0,h=0,g=document.createElement("div");return g.innerHTML=ze,g.dir="ltr",u=g.childNodes[1],s=g.childNodes[0],l=s.childNodes[0],e.appendChild(g),s.addEventListener("scroll",n),u.addEventListener("scroll",n),i?i.runOutsideAngular((function(){j(a)})):j(a),{detach:function(){e.removeChild(g),p=!0}}}function _(e){return(e+"").replace('"',"___")}function F(e){return e<-1e-7?Math.ceil(e-1e-7):Math.floor(e+1e-7)}function M(e,t,i){e=parseInt(e),t=parseInt(t),i=parseInt(i);var r,a,n,o,s=new Array(0,0,0);return r=e>1582||1582==e&&t>10||1582==e&&10==t&&i>14?F(1461*(e+4800+F((t-14)/12))/4)+F(367*(t-2-12*F((t-14)/12))/12)-F(3*F((e+4900+F((t-14)/12))/100)/4)+i-32075:367*e-F(7*(e+5001+F((t-9)/7))/4)+F(275*t/9)+i+1729777,o=F(((a=r-1948440+10632)-1)/10631),n=F((10985-(a=a-10631*o+354))/5316)*F(50*a/17719)+F(a/5670)*F(43*a/15238),a=a-F((30-n)/15)*F(17719*n/50)-F(n/16)*F(15238*n/43)+29,t=F(24*a/709),i=a-F(709*t/24),e=30*o+n-30,s[2]=i,s[1]=t,s[0]=e,s}e=e&&e.hasOwnProperty("default")?e.default:e;var A=A||{},V={},k={},I="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},P=e.extend,N={};A.$=e,e.mobiscroll=A,e.fn.mobiscroll=function(e){return P(this,N),t(this,e,arguments)};var $,O,B,L,H=[],q="undefined"!=typeof window,U=q?navigator.userAgent:"",W=q?navigator.platform:"",Y=q?navigator.maxTouchPoints:0,X=/Safari/.test(U),G=U.match(/Android|iPhone|iPad|iPod|Windows Phone|Windows|MSIE/i),j=q&&window.requestAnimationFrame||function(e){return setTimeout(e,20)},J=q&&window.cancelAnimationFrame||function(e){clearTimeout(e)};/Android/i.test(G)?($="android",(O=U.match(/Android\s+([\d\.]+)/i))&&(H=O[0].replace("Android ","").split("."))):/iPhone|iPad|iPod/i.test(G)||/iPhone|iPad|iPod/i.test(W)||"MacIntel"===W&&Y>1?($="ios",(O=U.match(/OS\s+([\d\_]+)/i))&&(H=O[0].replace(/_/g,".").replace("OS ","").split("."))):/Windows Phone/i.test(G)?$="wp":/Windows|MSIE/i.test(G)&&($="windows"),B=H[0],L=H[1];var K=0,Z=void 0;q&&(["mouseover","mousedown","mouseup","click"].forEach((function(e){document.addEventListener(e,u,!0)})),"android"==$&&B<5&&document.addEventListener("change",(function(e){K&&"checkbox"==e.target.type&&!e.target.mbscChange&&(e.stopPropagation(),e.preventDefault()),delete e.target.mbscChange}),!0)),A.uid="11fd4721";var Q,ee=A.$,te=+new Date,ie={},re={},ae={},ne={xsmall:0,small:576,medium:768,large:992,xlarge:1200},oe=ee.extend;oe(V,{getCoord:d,preventClick:l,vibrate:function(e){"vibrate"in navigator&&navigator.vibrate(e||50)}}),Q=oe(A,{$:ee,version:"4.8.5",autoTheme:"mobiscroll",themes:{form:{},page:{},frame:{},scroller:{},listview:{},navigation:{},progress:{},card:{}},platform:{name:$,majorVersion:B,minorVersion:L},i18n:{},instances:ie,classes:re,util:V,settings:{},setDefaults:function(e){oe(this.settings,e)},customTheme:function(e,t){var i,r=A.themes,a=["frame","scroller","listview","navigation","form","page","progress","card"];for(i=0;i<a.length;i++)r[a[i]][e]=oe({},r[a[i]][t],{baseTheme:t})}});var se=function(e,t){function r(e){var t,i=ae;return l.responsive&&(t=e||p(a),ee.each(l.responsive,(function(e,r){t>=(r.breakpoint||ne[e])&&(i=r)}))),i}var a,n,o,s,l,d,u,h,g,m=this;m.settings={},m.element=e,m._init=i,m._destroy=i,m._processSettings=i,m._checkResp=function(e){if(m&&m._responsive){var t=r(e);if(s!==t)return s=t,m.init({}),!0}},m._getRespCont=function(){return ee(l.context)[0]},m.init=function(i,c){var p,f;for(p in i&&m.getVal&&(f=m.getVal()),m.settings)delete m.settings[p];l=m.settings,oe(t,i),m._hasDef&&(g=Q.settings),oe(l,m._defaults,g,t),m._hasTheme&&("auto"!=(u=l.theme)&&u||(u=Q.autoTheme),"default"==u&&(u="mobiscroll"),t.theme=u,d=Q.themes[m._class]?Q.themes[m._class][u]:{}),m._hasLang&&(n=Q.i18n[l.lang]),oe(l,d,n,g,t),a=m._getRespCont(),m._responsive&&(s||(s=r()),oe(l,s)),m._processSettings(s||{}),m._presets&&((o=m._presets[l.preset])&&(o=o.call(e,m,t),oe(l,o,t,s))),m._init(i),i&&m.setVal&&m.setVal(void 0===c?f:c,!0),h("onInit")},m.destroy=function(){m&&(m._destroy(),h("onDestroy"),delete ie[e.id],m=null)},m.tap=function(e,t,i,r,a){c(m,e,t,i,r,a)},m.trigger=function(i,r){var a,n,s,l=[g,d,o,t];for(n=0;n<4;n++)(s=l[n])&&s[i]&&(a=s[i].call(e,r||{},m));return a},m.option=function(e,i,r){var a={},n=["data","invalid","valid","readonly"];/calendar|eventcalendar|range/.test(l.preset)&&n.push("marked","labels","colors"),"object"===(void 0===e?"undefined":I(e))?a=e:a[e]=i,n.forEach((function(e){t[e]=l[e]})),m.init(a,r)},m.getInst=function(){return m},t=t||{},h=m.trigger,m.__ready||(ee(e).addClass("mbsc-comp"),e.id?ie[e.id]&&ie[e.id].destroy():e.id="mobiscroll"+ ++te,ie[e.id]=m,m.__ready=!0)},le=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?((Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,de=/^((\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,ce=/^\d{1,2}(\/\d{1,2})?$/,ue=/^w\d$/i,pe={shortYearCutoff:"+10",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["S","M","T","W","T","F","S"],amText:"am",pmText:"pm",getYear:function(e){return e.getFullYear()},getMonth:function(e){return e.getMonth()},getDay:function(e){return e.getDate()},getDate:h,getMaxDayOfMonth:function(e,t){return 32-new Date(e,t,32,12).getDate()},getWeekNumber:function(e){(e=new Date(e)).setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}};V.datetime={formatDate:g,parseDate:m};var he,ge,me,fe,be,ve,ye={};q&&(ge=document.createElement("modernizr").style,me=function(){var e,t=["Webkit","Moz","O","ms"];for(e in t)if(w([t[e]+"Transform"]))return"-"+t[e].toLowerCase()+"-";return""}(),ve=me.replace(/^\-/,"").replace(/\-$/,"").replace("moz","Moz"),he=void 0!==ge.animation?"animationend":"webkitAnimationEnd",void 0!==ge.transition,be=(fe="ios"===$&&!X)&&window.webkit&&window.webkit.messageHandlers,void 0===ge.touchAction||fe&&!be);var xe,Ce,Te="position:absolute;left:0;top:0;",we=Te+"right:0;bottom:0;overflow:hidden;z-index:-1;",ze='<div style="'+we+'"><div style="'+Te+'"></div></div><div style="'+we+'"><div style="'+Te+'width:200%;height:200%;"></div></div>',Se=A.themes,De=/(iphone|ipod)/i.test(U)&&B>=7,Ee="android"==$,Re="ios"==$,_e=Re&&8==B,Fe=Re&&B>7,Me=function(e){e.preventDefault()},Ae="input,select,textarea,button",Ve=function(e,t,r){function a(e){M&&M.removeClass("mbsc-active"),(M=ee(this)).hasClass("mbsc-disabled")||M.hasClass("mbsc-fr-btn-nhl")||M.addClass("mbsc-active"),"mousedown"===e.type?ee(document).on("mouseup",s):"pointerdown"===e.type&&ee(document).on("pointerup",s)}function s(e){M&&(M.removeClass("mbsc-active"),M=null),"mouseup"===e.type?ee(document).off("mouseup",s):"pointerup"===e.type&&ee(document).off("pointerup",s)}function c(e){A.activeInstance==ie&&(13!=e.keyCode||ee(e.target).is('textarea,button,input[type="button"],input[type="submit"]')&&!e.shiftKey?27==e.keyCode&&ie.cancel():ie.select())}function u(e){e||Ee||!ie._activeElm||(ne=new Date,ie._activeElm.focus())}function p(e){var t=xe,i=j.focusOnClose;ie._markupRemove(),w.remove(),P&&(V.mbscModals--,j.scrollLock&&V.mbscLock--,V.mbscLock||T.removeClass("mbsc-fr-lock"),q&&(V.mbscIOSLock--,V.mbscIOSLock||(T.removeClass("mbsc-fr-lock-ios"),x.css({top:"",left:""}),E.scrollLeft(V.mbscScrollLeft),E.scrollTop(V.mbscScrollTop))),V.mbscModals||T.removeClass("mbsc-fr-lock-ctx"),V.mbscModals&&!G||e||(t||(t=re),setTimeout((function(){void 0===i||!0===i?(Ce=!0,t[0].focus()):i&&ee(i)[0].focus()}),200))),G=void 0,N=!1,Z("onHide")}function h(){clearTimeout(X),X=setTimeout((function(){ie.position(!0)&&(Y.style.visibility="hidden",Y.offsetHeight,Y.style.visibility="")}),200)}function g(e){A.activeInstance==ie&&e.target.nodeType&&!W.contains(e.target)&&new Date-ne>100&&(ne=new Date,ie._activeElm.focus())}function m(e,t){if(P)w.appendTo(x);else if(re.is("div")&&!ie._hasContent)re.empty().append(w);else if(re.hasClass("mbsc-control")){var i=re.closest(".mbsc-control-w");w.insertAfter(i),i.hasClass("mbsc-select")&&i.addClass("mbsc-select-inline")}else w.insertAfter(re);var r,o,c,p;(N=!0,ie._markupInserted(w),Z("onMarkupInserted",{target:O}),P&&j.closeOnOverlayTap)&&z.on("touchstart mousedown",(function(e){o||e.target!=W||(o=!0,r=!1,c=d(e,"X"),p=d(e,"Y"))})).on("touchmove mousemove",(function(e){o&&!r&&(Math.abs(d(e,"X")-c)>9||Math.abs(d(e,"Y")-p)>9)&&(r=!0)})).on("touchcancel",(function(){o=!1})).on("touchend click",(function(e){o&&!r&&(ie.cancel(),"touchend"==e.type&&l()),o=!1}));w.on("mousedown",".mbsc-btn-e,.mbsc-fr-btn-e",Me).on("touchstart mousedown",(function(e){j.stopProp&&e.stopPropagation()})).on("keydown",".mbsc-fr-btn-e",(function(e){32==e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.click())})).on("keydown",(function(e){if(32!=e.keyCode||ee(e.target).is(Ae)){if(9==e.keyCode&&P&&j.focusTrap){var t=w.find('input,select,textarea,button,[tabindex="0"]').filter((function(){return this.offsetWidth>0||this.offsetHeight>0})),i=t.index(ee(":focus",w)),r=t.length-1,a=0;e.shiftKey&&(r=0,a=-1),i===r&&(t.eq(a)[0].focus(),e.preventDefault())}}else e.preventDefault()})).on("touchstart mousedown pointerdown",".mbsc-fr-btn-e",a).on("touchend",".mbsc-fr-btn-e",s),O.addEventListener("touchstart",(function(){K||(K=!0,x.find(".mbsc-no-touch").removeClass("mbsc-no-touch"))}),!0),ee.each(F,(function(e,t){ie.tap(ee(".mbsc-fr-btn"+e,w),(function(e){t=n(t)?ie.buttons[t]:t,(n(t.handler)?ie.handlers[t.handler]:t.handler).call(this,e,ie)}),!0)})),ie._attachEvents(w),!1!==ie.position()&&((P||ie._checkSize)&&(U=R(O,h,j.zone)),P&&(w.removeClass("mbsc-fr-pos"),k&&!e?w.addClass("mbsc-anim-in mbsc-anim-trans mbsc-anim-trans-"+k).on(he,(function e(){w.off(he,e).removeClass("mbsc-anim-in mbsc-anim-trans mbsc-anim-trans-"+k).find(".mbsc-fr-popup").removeClass("mbsc-anim-"+k),u(t)})).find(".mbsc-fr-popup").addClass("mbsc-anim-"+k):u(t)),Z("onShow",{target:O,valueText:ie._tempValue}))}function f(e,t){ie._isVisible||(e&&e(),!1!==ie.show()&&(xe=t))}function b(){ie._fillValue(),Z("onSet",{valueText:ie._value})}function v(){Z("onCancel",{valueText:ie._value})}function y(){ie.setVal(null,!0)}var x,C,T,w,z,S,D,E,_,F,M,V,k,I,P,N,$,O,B,L,H,q,U,W,Y,X,G,j,J,K,Z,Q,te,ie=this,re=ee(e),ae=[],ne=new Date;se.call(this,e,t,!0),ie.position=function(e){var t,i,r,a,n,s,l,d,c,u,p,h,g,m,f,b,v,y,C,T={},z=0,R=0,F=0,M=0;if(!N)return!1;if(b=Q,f=te,g=O.offsetHeight,(m=O.offsetWidth)&&g&&(Q!==m||te!==g||!e)){if(ie._checkResp(m))return!1;if(Q=m,te=g,ie._isFullScreen||/top|bottom/.test(j.display)?D.width(m):P&&_.width(""),ie._position(w),!ie._isFullScreen&&/center|bubble/.test(j.display)&&(ee(".mbsc-w-p",w).each((function(){v=this.getBoundingClientRect().width,M+=v,F=v>F?v:F})),h=M>m-16||!0===j.tabs,_.css({width:ie._isLiquid?Math.min(j.maxPopupWidth,m-16):Math.ceil(h?F:M),"white-space":h?"":"nowrap"})),!1!==Z("onPosition",{target:O,popup:Y,hasTabs:h,oldWidth:b,oldHeight:f,windowWidth:m,windowHeight:g})&&P)return H&&(z=E.scrollLeft(),R=E.scrollTop(),Q&&S.css({width:"",height:""})),B=Y.offsetWidth,L=Y.offsetHeight,J=L<=g&&B<=m,"center"==j.display?(C=Math.max(0,z+(m-B)/2),y=Math.max(0,R+(g-L)/2)):"bubble"==j.display?(t=void 0===j.anchor?re:ee(j.anchor),l=ee(".mbsc-fr-arr-i",w)[0],n=(a=t.offset()).top+(I?R-x.offset().top:0),s=a.left+(I?z-x.offset().left:0),i=t[0].offsetWidth,r=t[0].offsetHeight,d=l.offsetWidth,c=l.offsetHeight,C=o(s-(B-i)/2,z+3,z+m-B-3),(y=n+r+c/2)+L+8>R+g&&n-L-c/2>R?(D.removeClass("mbsc-fr-bubble-bottom").addClass("mbsc-fr-bubble-top"),y=n-L-c/2):D.removeClass("mbsc-fr-bubble-top").addClass("mbsc-fr-bubble-bottom"),ee(".mbsc-fr-arr",w).css({left:o(s+i/2-(C+(B-d)/2),0,d)}),J=y>R&&C>z&&y+L<=R+g&&C+B<=z+m):(C=z,y="top"==j.display?R:Math.max(0,R+g-L)),H&&(u=Math.max(y+L,I?V.scrollHeight:ee(document).height()),p=Math.max(C+B,I?V.scrollWidth:ee(document).width()),S.css({width:p,height:u}),j.scroll&&"bubble"==j.display&&(y+L+8>R+g||n>R+g||n+r<R)&&E.scrollTop(Math.min(n,y+L-g+8,u-g))),T.top=Math.floor(y),T.left=Math.floor(C),D.css(T),!0}},ie.attachShow=function(e,t){var i,r=ee(e).off(".mbsc"),a=r.prop("readonly");"inline"!==j.display&&((j.showOnFocus||j.showOnTap)&&r.is("input,select")&&(r.prop("readonly",!0).on("mousedown.mbsc",(function(e){e.preventDefault()})).on("focus.mbsc",(function(){ie._isVisible&&this.blur()})),(i=ee('label[for="'+r.attr("id")+'"]')).length||(i=r.closest("label"))),r.is("select")||(j.showOnFocus&&r.on("focus.mbsc",(function(){Ce?Ce=!1:f(t,r)})),j.showOnTap&&(r.on("keydown.mbsc",(function(e){32!=e.keyCode&&13!=e.keyCode||(e.preventDefault(),e.stopPropagation(),f(t,r))})),ie.tap(r,(function(e){e.isMbscTap&&(K=!0),f(t,r)})),i&&i.length&&ie.tap(i,(function(e){e.preventDefault(),e.target!==r[0]&&f(t,r)})))),ae.push({readOnly:a,el:r,lbl:i}))},ie.select=function(){P?ie.hide(!1,"set",!1,b):b()},ie.cancel=function(){P?ie.hide(!1,"cancel",!1,v):v()},ie.clear=function(){ie._clearValue(),Z("onClear"),P&&ie._isVisible&&!ie.live?ie.hide(!1,"clear",!1,y):y()},ie.enable=function(){j.disabled=!1,ee.each(ae,(function(e,t){t.el.is("input,select")&&(t.el[0].disabled=!1)}))},ie.disable=function(){j.disabled=!0,ee.each(ae,(function(e,t){t.el.is("input,select")&&(t.el[0].disabled=!0)}))},ie.show=function(e,t){var i,r,a,o;if(!j.disabled&&!ie._isVisible){if(ie._readValue(),!1===Z("onBeforeShow"))return!1;if(xe=null,k=j.animate,F=j.buttons||[],H=I||"bubble"==j.display,q=De&&!H&&j.scrollLock,i=F.length>0,!1!==k&&("top"==j.display?k=k||"slidedown":"bottom"==j.display?k=k||"slideup":"center"!=j.display&&"bubble"!=j.display||(k=k||"pop")),P&&(Q=0,te=0,q&&!T.hasClass("mbsc-fr-lock-ios")&&(V.mbscScrollTop=o=Math.max(0,E.scrollTop()),V.mbscScrollLeft=a=Math.max(0,E.scrollLeft()),x.css({top:-o+"px",left:-a+"px"})),T.addClass((j.scrollLock?"mbsc-fr-lock":"")+(q?" mbsc-fr-lock-ios":"")+(I?" mbsc-fr-lock-ctx":"")),ee(document.activeElement).is("input,textarea")&&document.activeElement.blur(),G=A.activeInstance,A.activeInstance=ie,V.mbscModals=(V.mbscModals||0)+1,q&&(V.mbscIOSLock=(V.mbscIOSLock||0)+1),j.scrollLock&&(V.mbscLock=(V.mbscLock||0)+1)),r='<div lang="'+j.lang+'" class="mbsc-fr mbsc-'+j.theme+(j.baseTheme?" mbsc-"+j.baseTheme:"")+" mbsc-fr-"+j.display+" "+(j.cssClass||"")+" "+(j.compClass||"")+(ie._isLiquid?" mbsc-fr-liq":"")+(P?" mbsc-fr-pos"+(j.showOverlay?"":" mbsc-fr-no-overlay"):"")+($?" mbsc-fr-pointer":"")+(Fe?" mbsc-fr-hb":"")+(K?"":" mbsc-no-touch")+(q?" mbsc-platform-ios":"")+(i?F.length>=3?" mbsc-fr-btn-block ":"":" mbsc-fr-nobtn")+'">'+(P?'<div class="mbsc-fr-persp">'+(j.showOverlay?'<div class="mbsc-fr-overlay"></div>':"")+'<div role="dialog" class="mbsc-fr-scroll">':"")+'<div class="mbsc-fr-popup'+(j.rtl?" mbsc-rtl":" mbsc-ltr")+(j.headerText?" mbsc-fr-has-hdr":"")+'">'+("bubble"===j.display?'<div class="mbsc-fr-arr-w"><div class="mbsc-fr-arr-i"><div class="mbsc-fr-arr"></div></div></div>':"")+(P?'<div class="mbsc-fr-focus" tabindex="-1"></div>':"")+'<div class="mbsc-fr-w">'+(j.headerText?'<div class="mbsc-fr-hdr">'+(n(j.headerText)?j.headerText:"")+"</div>":"")+'<div class="mbsc-fr-c">',r+=ie._generateContent(),r+="</div>",i){var s,l,d,u=F.length;for(r+='<div class="mbsc-fr-btn-cont">',l=0;l<F.length;l++)d=j.btnReverse?u-l-1:l,"set"===(s=n(s=F[d])?ie.buttons[s]:s).handler&&(s.parentClass="mbsc-fr-btn-s"),"cancel"===s.handler&&(s.parentClass="mbsc-fr-btn-c"),r+="<div"+(j.btnWidth?' style="width:'+100/F.length+'%"':"")+' class="mbsc-fr-btn-w '+(s.parentClass||"")+'"><div tabindex="0" role="button" class="mbsc-fr-btn'+d+" mbsc-fr-btn-e "+(void 0===s.cssClass?j.btnClass:s.cssClass)+(s.icon?" mbsc-ic mbsc-ic-"+s.icon:"")+'">'+(s.text||"")+"</div></div>";r+="</div>"}w=ee(r+="</div></div></div></div>"+(P?"</div></div>":"")),S=ee(".mbsc-fr-persp",w),z=ee(".mbsc-fr-scroll",w),_=ee(".mbsc-fr-w",w),D=ee(".mbsc-fr-popup",w),C=ee(".mbsc-fr-hdr",w),O=w[0],W=z[0],Y=D[0],ie._activeElm=ee(".mbsc-fr-focus",w)[0],ie._markup=w,ie._isVisible=!0,ie.markup=O,ie._markupReady(w),Z("onMarkupReady",{target:O}),P&&(ee(window).on("keydown",c),j.scrollLock&&w.on("touchmove mousewheel wheel",(function(e){J&&e.preventDefault()})),j.focusTrap&&E.on("focusin",g)),P?setTimeout((function(){m(e,t)}),q?100:0):m(e,t)}},ie.hide=function(e,t,i,r){return!(!ie._isVisible||!i&&!ie._isValid&&"set"==t||!i&&!1===Z("onBeforeClose",{valueText:ie._tempValue,button:t}))&&(ie._isVisible=!1,U&&(U.detach(),U=null),P&&(ee(document.activeElement).is("input,textarea")&&Y.contains(document.activeElement)&&document.activeElement.blur(),A.activeInstance==ie&&(A.activeInstance=G),ee(window).off("keydown",c),E.off("focusin",g)),w&&(P&&k&&!e?w.addClass("mbsc-anim-out mbsc-anim-trans mbsc-anim-trans-"+k).on(he,(function t(){w.off(he,t),p(e)})).find(".mbsc-fr-popup").addClass("mbsc-anim-"+k):p(e),ie._detachEvents(w)),r&&r(),re.trigger("blur"),void Z("onClose",{valueText:ie._value}))},ie.isVisible=function(){return ie._isVisible},ie.setVal=i,ie.getVal=i,ie._generateContent=i,ie._attachEvents=i,ie._detachEvents=i,ie._readValue=i,ie._clearValue=i,ie._fillValue=i,ie._markupReady=i,ie._markupInserted=i,ie._markupRemove=i,ie._position=i,ie.__processSettings=i,ie.__init=i,ie.__destroy=i,ie._destroy=function(){ie.hide(!0,!1,!0),re.off(".mbsc"),ee.each(ae,(function(e,t){t.el.off(".mbsc").prop("readonly",t.readOnly),t.lbl&&t.lbl.off(".mbsc")})),ie.__destroy()},ie._updateHeader=function(){var t=j.headerText,i=t?"function"==typeof t?t.call(e,ie._tempValue):t.replace(/\{value\}/i,ie._tempValue):"";C.html(i||"&nbsp;")},ie._getRespCont=function(){return I="body"!=j.context,E=ee(I?j.context:window),"inline"==j.display?re.is("div")?re:re.parent():E},ie._processSettings=function(e){var i,r;for(ie.__processSettings(e),($=!j.touchUi)&&(j.display=e.display||t.display||"bubble",j.buttons=e.buttons||t.buttons||[],j.showOverlay=e.showOverlay||t.showOverlay||!1),j.buttons=j.buttons||("inline"!==j.display?["cancel","set"]:[]),j.headerText=void 0===j.headerText?"inline"!==j.display&&"{value}":j.headerText,F=j.buttons||[],P="inline"!==j.display,x=ee(j.context),T=I?x:ee("body,html"),V=x[0],ie.live=!0,r=0;r<F.length;r++)"ok"!=(i=F[r])&&"set"!=i&&"set"!=i.handler||(ie.live=!1);ie.buttons.set={text:j.setText,icon:j.setIcon,handler:"set"},ie.buttons.cancel={text:j.cancelText,icon:j.cancelIcon,handler:"cancel"},ie.buttons.close={text:j.closeText,icon:j.closeIcon,handler:"cancel"},ie.buttons.clear={text:j.clearText,icon:j.clearIcon,handler:"clear"},ie._isInput=re.is("input")},ie._init=function(e){var t=ie._isVisible,i=t&&!w.hasClass("mbsc-fr-pos");t&&ie.hide(!0,!1,!0),re.off(".mbsc"),ie.__init(e),ie._isLiquid="liquid"==j.layout,P?(ie._readValue(),ie._hasContent||j.skipShow||ie.attachShow(re),t&&ie.show(i)):ie.show(),re.removeClass("mbsc-cloak").filter("input, select, textarea").on("change.mbsc",(function(){ie._preventChange||ie.setVal(re.val(),!0,!1),ie._preventChange=!1}))},ie.buttons={},ie.handlers={set:ie.select,cancel:ie.cancel,clear:ie.clear},ie._value=null,ie._isValid=!0,ie._isVisible=!1,j=ie.settings,Z=ie.trigger,r||ie.init()};Ve.prototype._defaults={lang:"en",setText:"Set",selectedText:"{count} selected",closeText:"Close",cancelText:"Cancel",clearText:"Clear",context:"body",maxPopupWidth:600,disabled:!1,closeOnOverlayTap:!0,showOnFocus:Ee||Re,showOnTap:!0,display:"center",scroll:!0,scrollLock:!0,showOverlay:!0,tap:!0,touchUi:!0,btnClass:"mbsc-fr-btn",btnWidth:!0,focusTrap:!0,focusOnClose:!_e},re.Frame=Ve,Se.frame.mobiscroll={headerText:!1,btnWidth:!1},Se.scroller.mobiscroll=oe({},Se.frame.mobiscroll,{rows:5,showLabel:!1,selectedLineBorder:1,weekDays:"min",checkIcon:"ion-ios7-checkmark-empty",btnPlusClass:"mbsc-ic mbsc-ic-arrow-down5",btnMinusClass:"mbsc-ic mbsc-ic-arrow-up5",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left5",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right5"}),q&&ee(window).on("focus",(function(){xe&&(Ce=!0)}));var ke="ios"==$,Ie=function(e,t,i){function r(e){he("onStart",{domEvent:e}),Ce.stopProp&&e.stopPropagation(),Ce.prevDef&&e.preventDefault(),Ce.readonly||Ce.lock&&L||z(e,this)&&!B&&(y&&y.removeClass("mbsc-active"),I=!1,L||(y=ee(e.target).closest(".mbsc-btn-e",this)).length&&!y.hasClass("mbsc-disabled")&&(I=!0,T=setTimeout((function(){y.addClass("mbsc-active")}),100)),B=!0,K=!1,H=!1,be.scrolled=L,oe=d(e,"X"),le=d(e,"Y"),A=oe,D=0,E=0,R=0,ne=new Date,ae=+S(ce,ge)||0,L&&v(ae,ke?0:1),"mousedown"===e.type&&ee(document).on("mousemove",s).on("mouseup",c))}function s(e){B&&(Ce.stopProp&&e.stopPropagation(),A=d(e,"X"),V=d(e,"Y"),D=A-oe,E=V-le,R=ge?E:D,I&&(Math.abs(E)>Ce.thresholdY||Math.abs(D)>Ce.thresholdX)&&(clearTimeout(T),y.removeClass("mbsc-active"),I=!1),(be.scrolled||!H&&Math.abs(R)>pe)&&(K||he("onGestureStart",k),be.scrolled=K=!0,U||(U=!0,q=j(l))),ge||Ce.scrollLock?e.preventDefault():be.scrolled?e.preventDefault():Math.abs(E)>7&&(H=!0,be.scrolled=!0,c()))}function l(){$&&(R=o(R,-ie*$,ie*$)),v(o(ae+R,O-M,N+M)),U=!1}function c(e){if(B){var t,i=new Date-ne;Ce.stopProp&&e&&e.stopPropagation(),J(q),U=!1,!H&&be.scrolled&&(Ce.momentum&&i<300&&(t=R/i,R=Math.max(Math.abs(R),t*t/Ce.speedUnit)*(R<0?-1:1)),b(R)),I&&(clearTimeout(T),y.addClass("mbsc-active"),setTimeout((function(){y.removeClass("mbsc-active")}),100),H||be.scrolled||he("onBtnTap",{target:y[0],domEvent:e})),e&&"mouseup"==e.type&&ee(document).off("mousemove",s).off("mouseup",c),B=!1}}function u(e){if(e=e.originalEvent||e,R=ge?null==e.deltaY?e.wheelDelta||e.detail:e.deltaY:e.deltaX,he("onStart",{domEvent:e}),Ce.stopProp&&e.stopPropagation(),R){if(e.preventDefault(),e.deltaMode&&1==e.deltaMode&&(R*=15),R=o(-R,-Q,Q),ae=fe,Ce.readonly)return;if(K||f(),ae+R<O&&(ae=O,R=0),ae+R>N&&(ae=N,R=0),U||(U=!0,q=j(l)),!R&&K)return;K=!0,clearTimeout(Z),Z=setTimeout((function(){J(q),U=!1,K=!1,b(R)}),200)}}function p(e){he("onStart",{domEvent:e}),Ce.readonly||(e.stopPropagation(),ae=fe,K=!1,e.target==W?(le=d(e,"Y",!0),ee(document).on("mousemove",h).on("mouseup",g)):(le=x.offset().top,h(e),g()))}function h(e){var t=(d(e,"Y",!0)-le)/w;P?R=o(R=-($*ie*2+w)*t,-ie*$,ie*$):R=(O-N-w)*t,K||f(),K=!0,v(o(ae+R,O-M,N+M))}function g(){ae=fe,b(0),ee(document).off("mousemove",h).off("mouseup",g)}function m(e){e.stopPropagation()}function f(){he("onGestureStart",k={posX:ge?0:fe,posY:ge?fe:0,originX:ge?0:ae,originY:ge?ae:0,direction:R>0?ge?270:360:ge?90:180})}function b(e){var t,i,r;if($&&(e=o(e,-ie*$,ie*$)),r=o(Math.round((ae+e)/ie)*ie,O,N),re){if(e<0){for(t=re.length-1;t>=0;t--)if(Math.abs(r)+w>=re[t].breakpoint){ye=t,xe=2,r=re[t].snap2;break}}else if(e>=0)for(t=0;t<re.length;t++)if(Math.abs(r)<=re[t].breakpoint){ye=t,xe=1,r=re[t].snap1;break}r=o(r,O,N)}i=Ce.time||(fe<O||fe>N?1e3:Math.max(1e3,Math.abs(r-fe)*Ce.timeUnit)),k.destinationX=ge?0:r,k.destinationY=ge?r:0,k.duration=i,k.transitionTiming=F,he("onGestureEnd",k),be.scroll(r,i)}function v(e,t,i,r){var a,n=e!=fe,o=t>1,s=t?me+"transform "+Math.round(t)+"ms "+F:"",l=function(){clearInterval(te),clearTimeout(ue),L=!1,fe=e,k.posX=ge?0:e,k.posY=ge?e:0,n&&he("onMove",k),o&&he("onAnimationEnd",k),r&&r()};k={posX:ge?0:fe,posY:ge?fe:0,originX:ge?0:ae,originY:ge?ae:0,direction:e-fe>0?ge?270:360:ge?90:180},fe=e,o&&(k.destinationX=ge?0:e,k.destinationY=ge?e:0,k.duration=t,k.transitionTiming=F,he("onAnimationStart",k)),de[ve+"Transition"]=s,de[ve+"Transform"]="translate3d("+(ge?"0,"+e+"px,":e+"px,0,")+"0)",W&&Y&&(a=P?(X-e)/($*ie*2):(e-N)/(O-N),W.style[ve+"Transition"]=s,W.style[ve+"Transform"]="translate3d(0,"+Math.max(0,Math.min((w-Y)*a,w-Y))+"px,0)"),!n&&!L||!t||t<=1?l():t&&(L=!i,clearInterval(te),te=setInterval((function(){var t=+S(ce,ge)||0;k.posX=ge?0:t,k.posY=ge?t:0,he("onMove",k),Math.abs(t-e)<2&&l()}),100),clearTimeout(ue),ue=setTimeout((function(){l()}),t)),Ce.sync&&Ce.sync(e,t,F)}var y,x,C,T,w,D,E,R,_,F,M,A,V,k,I,P,N,$,O,B,L,H,q,U,W,Y,X,G,K,Z,Q,te,ie,re,ae,ne,oe,le,de,ce,ue,pe,he,ge,fe,be=this,ye=0,xe=1,Ce=t,Te=ee(e);se.call(this,e,t,!0),be.scrolled=!1,be.scroll=function(t,i,r,n){t=o(t=a(t)?Math.round(t/ie)*ie:Math.ceil((ee(t,e).length?Math.round(ce.offset()[_]-ee(t,e).offset()[_]):fe)/ie)*ie,O,N),ye=Math.round(t/ie),ae=fe,X=$*ie+t,v(t,i,r,n)},be.refresh=function(e){var t;for(w=(void 0===Ce.contSize?ge?Te.height():Te.width():Ce.contSize)||0,N=(void 0===Ce.maxScroll?0:Ce.maxScroll)||0,O=Math.min(N,void 0===Ce.minScroll?Math.min(0,ge?w-ce.height():w-ce.width()):Ce.minScroll)||0,re=null,!ge&&Ce.rtl&&(t=N,N=-O,O=-t),n(Ce.snap)&&(re=[],ce.find(Ce.snap).each((function(){var e=ge?this.offsetTop:this.offsetLeft,t=ge?this.offsetHeight:this.offsetWidth;re.push({breakpoint:e+t/2,snap1:-e,snap2:w-e-t})}))),ie=a(Ce.snap)?Ce.snap:1,$=Ce.snap?Ce.maxSnapScroll:0,F=Ce.easing,M=Ce.elastic?a(Ce.snap)?ie:a(Ce.elastic)?Ce.elastic:0:0,Q=ie;Q>44;)Q/=2;Q=Math.round(44/Q)*Q,W&&(P=O==-1/0||N==1/0,Y=O<N?Math.max(20,w*w/(N-O+w)):0,W.style.height=Y+"px",G.style.height=Y?"":0),void 0===fe&&(fe=Ce.initialPos,ye=Math.round(fe/ie)),e||be.scroll(Ce.snap?re?re[ye]["snap"+xe]:ye*ie:fe)},be._processSettings=function(){ge="Y"==Ce.axis,_=ge?"top":"left",ce=Ce.moveElement||Te.children().eq(0),de=ce[0].style,pe=ge?Ce.thresholdY:Ce.thresholdX,Ce.scrollbar&&(C=Ce.scrollbar,x=C.find(".mbsc-sc-bar"),W=x[0],G=C[0])},be._init=function(){be.refresh(),Te.on("touchstart mousedown",r).on("touchmove",s).on("touchend touchcancel",c),Ce.mousewheel&&Te.on("wheel mousewheel",u),W&&C.on("mousedown",p).on("click",m),e.addEventListener("click",(function(e){be.scrolled&&(be.scrolled=!1,e.stopPropagation(),e.preventDefault())}),!0)},be._destroy=function(){clearInterval(te),Te.off("touchstart mousedown",r).off("touchmove",s).off("touchend touchcancel",c).off("wheel mousewheel",u),W&&C.off("mousedown",p).off("click",m)},Ce=be.settings,he=be.trigger,i||be.init()};Ie.prototype={_defaults:{speedUnit:.0022,timeUnit:3,initialPos:0,axis:"Y",thresholdX:10,thresholdY:5,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",stopProp:!0,momentum:!0,mousewheel:!0,elastic:!0}};var Pe={},Ne=q?window.CSS:null,$e=Ne&&Ne.supports&&Ne.supports("(transform-style: preserve-3d)"),Oe=function(e,t,i){function n(e){var t,i,r=+ee(this).attr("data-index");38==e.keyCode?(t=!0,i=-1):40==e.keyCode?(t=!0,i=1):32==e.keyCode&&(t=!0,s(r,ee(e.target))),t&&(e.stopPropagation(),e.preventDefault(),i&&M.start(r,i,e))}function o(){M.stop()}function s(e,t){var i=B[e],n=+t.attr("data-index"),o=g(i,n),s=U._tempSelected[e],l=a(i.multiple)?i.multiple:1/0;!1!==$("onItemTap",{target:t[0],index:e,value:o,selected:t.hasClass("mbsc-sc-itm-sel")})&&(i.multiple&&!i._disabled[o]&&(void 0!==s[o]?(t.removeClass(R).removeAttr("aria-selected"),delete s[o]):(1==l&&(U._tempSelected[e]=s={},i._$markup.find(".mbsc-sc-itm-sel").removeClass(R).removeAttr("aria-selected")),r(s).length<l&&(t.addClass(R).attr("aria-selected","true"),s[o]=o))),C(i,e,n,q,i._index<n?1:2,!0,i.multiple),U.live&&(!i.multiple||1===i.multiple&&N.tapSelect)&&(!0===N.setOnTap||N.setOnTap[e])&&setTimeout((function(){U.select()}),N.tapSelect?0:200))}function l(e){return-(e.max-e._offset-(e.multiple&&!D?Math.floor(N.rows/2):0))*V}function d(e){return-(e.min-e._offset+(e.multiple&&!D?Math.floor(N.rows/2):0))*V}function c(e,t){return(e._array?e._map[t]:+e.getIndex(t,U))||0}function u(e,t){var i=e.data;if(t>=e.min&&t<=e.max)return e._array?e.circular?ee(i).get(t%e._length):i[t]:ee.isFunction(i)?i(t,U):""}function p(e){return ee.isPlainObject(e)?void 0!==e.value?e.value:e.display:e}function h(e){var t=ee.isPlainObject(e)?e.display:e;return void 0===t?"":t}function g(e,t){return p(u(e,t))}function m(e,t,i){var r=B[e];C(r,e,r._index+t,N.delay+100,1==t?1:2,!1,!1,"keydown"==i.type)}function f(e){return ee.isArray(N.readonly)?N.readonly[e]:N.readonly}function b(e,t,i){var r=e._index-e._batch;return e.data=e.data||[],e.key=void 0!==e.key?e.key:t,e.label=void 0!==e.label?e.label:t,e._map={},e._array=ee.isArray(e.data),e._array&&(e._length=e.data.length,ee.each(e.data,(function(t,i){e._map[p(i)]=t}))),e.circular=void 0===N.circular?void 0===e.circular?e._array&&e._length>N.rows:e.circular:ee.isArray(N.circular)?N.circular[t]:N.circular,e.min=e._array?e.circular?-1/0:0:void 0===e.min?-1/0:e.min,e.max=e._array?e.circular?1/0:e._length-1:void 0===e.max?1/0:e.max,e._nr=t,e._index=c(e,A[t]),e._disabled={},e._batch=0,e._current=e._index,e._first=e._index-H,e._last=e._index+H,e._offset=e._first,i?(e._offset-=e._margin/V+(e._index-r),e._margin+=(e._index-r)*V):e._margin=0,e._refresh=function(t){oe(e._scroller.settings,{minScroll:l(e),maxScroll:d(e)}),e._scroller.refresh(t)},L[e.key]=e,e}function v(e,t,i,r,a){var n,o,s,l,d,c,g,m,f="",b=U._tempSelected[t],v=e._disabled||{};for(n=i;n<=r;n++)d=h(s=u(e,n)),l=p(s),o=s&&void 0!==s.cssClass?s.cssClass:"",c=s&&void 0!==s.label?s.label:"",g=s&&s.invalid,m=void 0!==l&&l==A[t]&&!e.multiple,f+='<div role="option" tabindex="-1" aria-selected="'+!!b[l]+'" class="mbsc-sc-itm '+(a?"mbsc-sc-itm-3d ":"")+o+" "+(m?"mbsc-sc-itm-sel ":"")+(b[l]?R:"")+(void 0===l?" mbsc-sc-itm-ph":" mbsc-btn-e")+(g?" mbsc-sc-itm-inv-h mbsc-disabled":"")+(v[l]?" mbsc-sc-itm-inv mbsc-disabled":"")+'" data-index="'+n+'" data-val="'+_(l)+'"'+(c?' aria-label="'+c+'"':"")+(m?' aria-selected="true"':"")+' style="height:'+V+"px;line-height:"+V+"px;"+(a?me+"transform:rotateX("+(e._offset-n)*S%360+"deg) translateZ("+V*N.rows/2+"px);":"")+'">'+(O>1?'<div class="mbsc-sc-itm-ml" style="line-height:'+Math.round(V/O)+"px;font-size:"+Math.round(V/O*.8)+'px;">':"")+d+(O>1?"</div>":"")+"</div>";return f}function y(e,t,i,r){var a,n=B[e],o=r||n._disabled,s=c(n,t),l=g(n,s),d=l,u=l,p=0,h=0;if(!0===o[l]){for(a=0;s-p>=n.min&&o[d]&&a<100;)a++,d=g(n,s-++p);for(a=0;s+h<n.max&&o[u]&&a<100;)a++,u=g(n,s+ ++h);l=(h<p&&h&&2!==i||!p||s-p<0||1==i)&&!o[u]?u:d}return l}function x(t,i,r,a,n,o,s){var l,d,u,p,h=U._isVisible;P=!0,p=N.validate.call(e,{values:A.slice(0),index:i,direction:r},U)||{},P=!1,p.valid&&(U._tempWheelArray=A=p.valid.slice(0)),o||ee.each(B,(function(e,a){if(h&&a._$markup.find(".mbsc-sc-itm-inv").removeClass("mbsc-sc-itm-inv mbsc-disabled"),a._disabled={},p.disabled&&p.disabled[e]&&ee.each(p.disabled[e],(function(e,t){a._disabled[t]=!0,h&&a._$markup.find('.mbsc-sc-itm[data-val="'+_(t)+'"]').addClass("mbsc-sc-itm-inv mbsc-disabled")})),A[e]=a.multiple?A[e]:y(e,A[e],r),h){if(a.multiple&&void 0!==i||a._$markup.find(".mbsc-sc-itm-sel").removeClass(R).removeAttr("aria-selected"),d=c(a,A[e]),l=d-a._index+a._batch,Math.abs(l)>2*H+1&&(u=l+(2*H+1)*(l>0?-1:1),a._offset+=u,a._margin-=u*V,a._refresh()),a._index=d+a._batch,a.multiple){if(void 0===i)for(var o in U._tempSelected[e])a._$markup.find('.mbsc-sc-itm[data-val="'+_(o)+'"]').addClass(R).attr("aria-selected","true")}else a._$markup.find('.mbsc-sc-itm[data-val="'+_(A[e])+'"]').addClass("mbsc-sc-itm-sel").attr("aria-selected","true");a._$active&&a._$active.attr("tabindex",-1),a._$active=a._$markup.find('.mbsc-sc-itm[data-index="'+a._index+'"]').eq(D&&a.multiple?1:0).attr("tabindex",0),s&&i===e&&a._$active.length&&(a._$active[0].focus(),a._$scroller.parent().scrollTop(0)),a._scroller.scroll(-(d-a._offset+a._batch)*V,i===e||void 0===i?t:q,n)}})),$("onValidated",{index:i,time:t}),U._tempValue=N.formatValue.call(e,A,U),h&&U._updateHeader(),U.live&&function(e,t){var i=B[e];return i&&(!i.multiple||1!==i.multiple&&t&&(!0===N.setOnTap||N.setOnTap[e]))}(i,o)&&(U._hasValue=a||U._hasValue,T(a,a,0,!0),a&&$("onSet",{valueText:U._value})),a&&$("onChange",{index:i,valueText:U._tempValue})}function C(e,t,i,r,a,n,o,s){var l=g(e,i);void 0!==l&&(A[t]=l,e._batch=e._array?Math.floor(i/e._length)*e._length:0,e._index=i,setTimeout((function(){x(r,t,a,!0,n,o,s)}),10))}function T(t,i,r,a,n){if(a?U._tempValue=N.formatValue.call(e,U._tempWheelArray,U):x(r),!n){U._wheelArray=[];for(var o=0;o<A.length;o++)U._wheelArray[o]=B[o]&&B[o].multiple?Object.keys(U._tempSelected[o]||{})[0]:A[o];U._value=U._hasValue?U._tempValue:null,U._selected=oe(!0,{},U._tempSelected)}t&&(U._isInput&&W.val(U._hasValue?U._tempValue:""),$("onFill",{valueText:U._hasValue?U._tempValue:"",change:i}),i&&(U._preventChange=!0,W.trigger("change")))}var w,z,S,D,R,F,M,A,V,k,I,P,N,$,O,B,L,H=40,q=1e3,U=this,W=ee(e);Ve.call(this,e,t,!0),U.setVal=U._setVal=function(t,i,r,a,n){U._hasValue=null!=t,U._tempWheelArray=A=ee.isArray(t)?t.slice(0):N.parseValue.call(e,t,U)||[],T(i,void 0===r?i:r,n,!1,a)},U.getVal=U._getVal=function(e){var t=U._hasValue||e?U[e?"_tempValue":"_value"]:null;return a(t)?+t:t},U.setArrayVal=U.setVal,U.getArrayVal=function(e){return e?U._tempWheelArray:U._wheelArray},U.changeWheel=function(e,t,i){var r,a;ee.each(e,(function(e,t){(a=L[e])&&(r=a._nr,oe(a,t),b(a,r,!0),U._isVisible&&(D&&a._$3d.html(v(a,r,a._first+H-z+1,a._last-H+z,!0)),a._$scroller.html(v(a,r,a._first,a._last)).css("margin-top",a._margin+"px"),a._refresh(P)))})),!U._isVisible||U._isLiquid||P||U.position(),P||x(t,void 0,void 0,i)},U.getValidValue=y,U._generateContent=function(){var e,t=0,i="",r=D?me+"transform: translateZ("+(V*N.rows/2+3)+"px);":"",a='<div class="mbsc-sc-whl-l" style="'+r+"height:"+V+"px;margin-top:-"+(V/2+(N.selectedLineBorder||0))+'px;"></div>',n=0;return ee.each(N.wheels,(function(o,s){i+='<div class="mbsc-w-p mbsc-sc-whl-gr-c'+(D?" mbsc-sc-whl-gr-3d-c":"")+(N.showLabel?" mbsc-sc-lbl-v":"")+'">'+a+'<div class="mbsc-sc-whl-gr'+(D?" mbsc-sc-whl-gr-3d":"")+(F?" mbsc-sc-cp":"")+(N.width||N.maxWidth?'"':'" style="max-width:'+N.maxPopupWidth+'px;"')+">",ee.each(s,(function(o,s){U._tempSelected[n]=oe({},U._selected[n]),B[n]=b(s,n),t+=N.maxWidth?N.maxWidth[n]||N.maxWidth:N.width?N.width[n]||N.width:0,e=void 0!==s.label?s.label:o,i+='<div class="mbsc-sc-whl-w '+(s.cssClass||"")+(s.multiple?" mbsc-sc-whl-multi":"")+'" style="'+(N.width?"width:"+(N.width[n]||N.width)+"px;":(N.minWidth?"min-width:"+(N.minWidth[n]||N.minWidth)+"px;":"")+(N.maxWidth?"max-width:"+(N.maxWidth[n]||N.maxWidth)+"px;":""))+'">'+(I?'<div class="mbsc-sc-bar-c"><div class="mbsc-sc-bar"></div></div>':"")+'<div class="mbsc-sc-whl-o" style="'+r+'"></div>'+a+'<div aria-live="off" aria-label="'+e+'"'+(s.multiple?' aria-multiselectable="true"':"")+' role="listbox" data-index="'+n+'" class="mbsc-sc-whl" style="height:'+N.rows*V*(D?1.1:1)+'px;">'+(F?'<div data-index="'+n+'" data-step="1" class="mbsc-sc-btn mbsc-sc-btn-plus '+(N.btnPlusClass||"")+'"></div><div data-index="'+n+'" data-step="-1" class="mbsc-sc-btn mbsc-sc-btn-minus '+(N.btnMinusClass||"")+'"></div>':"")+'<div class="mbsc-sc-lbl">'+e+'</div><div class="mbsc-sc-whl-c" style="height:'+k+"px;margin-top:-"+(k/2+1)+"px;"+r+'"><div class="mbsc-sc-whl-sc" style="top:'+(k-V)/2+'px;">',i+=v(s,n,s._first,s._last)+"</div></div>",D&&(i+='<div class="mbsc-sc-whl-3d" style="height:'+V+"px;margin-top:-"+V/2+'px;">',i+=v(s,n,s._first+H-z+1,s._last-H+z,!0),i+="</div>"),i+="</div></div>",n++})),i+="</div></div>"})),t&&(N.maxPopupWidth=t),i},U._attachEvents=function(e){M=E(ee(".mbsc-sc-btn",e),m,N.delay,f,!0),ee(".mbsc-sc-whl",e).on("keydown",n).on("keyup",o)},U._detachEvents=function(){M.stop();for(var e=0;e<B.length;e++)B[e]._scroller.destroy()},U._markupReady=function(e){ee(".mbsc-sc-whl-w",w=e).each((function(e){var t,i=ee(this),r=B[e];r._$markup=i,r._$scroller=ee(".mbsc-sc-whl-sc",this),r._$3d=ee(".mbsc-sc-whl-3d",this),r._scroller=new Ie(this,{mousewheel:N.mousewheel,moveElement:r._$scroller,scrollbar:ee(".mbsc-sc-bar-c",this),initialPos:(r._first-r._index)*V,contSize:N.rows*V,snap:V,minScroll:l(r),maxScroll:d(r),maxSnapScroll:H,prevDef:!0,stopProp:!0,timeUnit:3,easing:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",sync:function(e,t,i){var a=t?me+"transform "+Math.round(t)+"ms "+i:"";D&&(r._$3d[0].style[ve+"Transition"]=a,r._$3d[0].style[ve+"Transform"]="rotateX("+-e/V*S+"deg)")},onStart:function(t,i){i.settings.readonly=f(e)},onGestureStart:function(){i.addClass("mbsc-sc-whl-a mbsc-sc-whl-anim"),$("onWheelGestureStart",{index:e})},onGestureEnd:function(i){var a=90==i.direction?1:2,n=i.duration,o=i.destinationY;t=Math.round(-o/V)+r._offset,C(r,e,t,n,a)},onAnimationStart:function(){i.addClass("mbsc-sc-whl-anim")},onAnimationEnd:function(){i.removeClass("mbsc-sc-whl-a mbsc-sc-whl-anim"),$("onWheelAnimationEnd",{index:e}),r._$3d.find(".mbsc-sc-itm-del").remove()},onMove:function(t){!function(e,t,i){var r=Math.round(-i/V)+e._offset,a=r-e._current,n=e._first,o=e._last,s=n+H-z+1,l=o-H+z;a&&(e._first+=a,e._last+=a,e._current=r,a>0?(e._$scroller.append(v(e,t,Math.max(o+1,n+a),o+a)),ee(".mbsc-sc-itm",e._$scroller).slice(0,Math.min(a,o-n+1)).remove(),D&&(e._$3d.append(v(e,t,Math.max(l+1,s+a),l+a,!0)),ee(".mbsc-sc-itm",e._$3d).slice(0,Math.min(a,l-s+1)).attr("class","mbsc-sc-itm-del"))):a<0&&(e._$scroller.prepend(v(e,t,n+a,Math.min(n-1,o+a))),ee(".mbsc-sc-itm",e._$scroller).slice(Math.max(a,n-o-1)).remove(),D&&(e._$3d.prepend(v(e,t,s+a,Math.min(s-1,l+a),!0)),ee(".mbsc-sc-itm",e._$3d).slice(Math.max(a,s-l-1)).attr("class","mbsc-sc-itm-del"))),e._margin+=a*V,e._$scroller.css("margin-top",e._margin+"px"))}(r,e,t.posY)},onBtnTap:function(t){s(e,ee(t.target))}})})),x()},U._fillValue=function(){U._hasValue=!0,T(!0,!0,0,!0)},U._clearValue=function(){ee(".mbsc-sc-whl-multi .mbsc-sc-itm-sel",w).removeClass(R).removeAttr("aria-selected")},U._readValue=function(){var t=W.val()||"",i=0;""!==t&&(U._hasValue=!0),U._tempWheelArray=A=U._hasValue&&U._wheelArray?U._wheelArray.slice(0):N.parseValue.call(e,t,U)||[],U._tempSelected=oe(!0,{},U._selected),ee.each(N.wheels,(function(e,t){ee.each(t,(function(e,t){B[i]=b(t,i),i++}))})),T(!1,!1,0,!0),$("onRead")},U.__processSettings=function(e){N=U.settings,$=U.trigger,O=N.multiline,R="mbsc-sc-itm-sel mbsc-ic mbsc-ic-"+N.checkIcon,(I=!N.touchUi)&&(N.tapSelect=!0,N.circular=!1,N.rows=e.rows||t.rows||7)},U.__init=function(e){e&&(U._wheelArray=null),B=[],L={},F=N.showScrollArrows,D=N.scroll3d&&$e&&!F&&!I&&("ios"==N.theme||"ios"==N.baseTheme),V=N.height,k=D?2*Math.round((V-.03*(V*N.rows/2+3))/2):V,z=Math.round(1.8*N.rows),S=360/(2*z),F&&(N.rows=Math.max(3,N.rows))},U._getItemValue=p,U._tempSelected={},U._selected={},i||U.init()};Oe.prototype={_hasDef:!0,_hasTheme:!0,_hasLang:!0,_responsive:!0,_class:"scroller",_presets:Pe,_defaults:oe({},Ve.prototype._defaults,{minWidth:80,height:40,rows:3,multiline:1,delay:200,readonly:!1,showLabel:!0,setOnTap:!1,wheels:[],preset:"",speedUnit:.0012,timeUnit:.08,checkIcon:"checkmark",compClass:"mbsc-sc",validate:function(){},formatValue:function(e){return e.join(" ")},parseValue:function(e,t){var i,r,a=[],n=[],o=0;return null!=e&&(a=(e+"").split(" ")),ee.each(t.settings.wheels,(function(e,s){ee.each(s,(function(e,s){r=s.data,i=t._getItemValue(r[0]),ee.each(r,(function(e,r){if(a[o]==t._getItemValue(r))return i=t._getItemValue(r),!1})),n.push(i),o++}))})),n}})},re.Scroller=Oe;var Be={separator:" ",dateFormat:"mm/dd/yy",dateDisplay:"MMddyy",timeFormat:"h:ii A",dayText:"Day",monthText:"Month",yearText:"Year",hourText:"Hours",minuteText:"Minutes",ampmText:"&nbsp;",secText:"Seconds",nowText:"Now",todayText:"Today"},Le=function(e){function t(e){var t,i,r,a,n=[];if(e){for(t=0;t<e.length;t++)if((i=e[t]).start&&i.end&&!de.test(i.start))for(r=new Date(C(i.start,$,I)),a=new Date(C(i.end,$,I));r<=a;)n.push(h(r.getFullYear(),r.getMonth(),r.getDate())),r.setDate(r.getDate()+1);else n.push(i);return n}return e}function i(e,t,i,r){return Math.min(r,Math.floor(e/t)*t+i)}function r(e,t,i){return Math.floor((i-t)/e)*e+t}function a(e){return e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate())}function n(e,t,i,r){var a;return void 0===E[t]||(a=+e[E[t]],isNaN(a))?i?be[t](i):void 0!==R[t]?R[t]:be[t](r):a}function o(e){var t,i=new Date((new Date).setHours(0,0,0,0));if(null===e)return e;void 0!==E.dd&&(t=e[E.dd].split("-"),t=new Date(t[0],t[1]-1,t[2])),void 0!==E.tt&&(t=t||i,t=new Date(t.getTime()+e[E.tt]%86400*1e3));var r=n(e,"y",t,i),a=n(e,"m",t,i),o=Math.min(n(e,"d",t,i),I.getMaxDayOfMonth(r,a)),s=n(e,"h",t,i);return I.getDate(r,a,o,j&&n(e,"a",t,i)?s+12:s,n(e,"i",t,i),n(e,"s",t,i),n(e,"u",t,i))}function l(e,t){var i,r,a=["y","m","d","a","h","i","s","u","dd","tt"],n=[];if(null==e)return e;for(i=0;i<a.length;i++)void 0!==E[r=a[i]]&&(n[E[r]]=be[r](e)),t&&(R[r]=be[r](e));return n}function d(e,t){return t?Math.floor(new Date(e)/864e5):e.getMonth()+12*(e.getFullYear()-1970)}function c(e){return{value:e,display:(/yy/i.test(L)?e:(e+"").substr(2,2))+(I.yearSuffix||"")}}function u(e){return e}function p(e){var t=/d/i.test(e);return{label:"",cssClass:"mbsc-dt-whl-date",min:Y?d(a(Y),t):void 0,max:X?d(a(X),t):void 0,data:function(i){var r=new Date((new Date).setHours(0,0,0,0)),n=t?new Date(864e5*i):new Date(1970,i,1);return t&&(n=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),{invalid:t&&!v(n,!0),value:a(n),display:r.getTime()==n.getTime()?I.todayText:g(e,n,I)}},getIndex:function(e){return d(e,t)}}}function f(e){var t,i,r,a=[];for(/s/i.test(e)?i=te:/i/i.test(e)?i=60*Q:/h/i.test(e)&&(i=3600*Z),z=fe.tt=i,t=0;t<86400;t+=i)r=new Date((new Date).setHours(0,0,0,0)+1e3*t),a.push({value:t,display:g(e,r,I)});return{label:"",cssClass:"mbsc-dt-whl-time",data:a}}function b(e,t){return I.getYear(e)===I.getYear(t)&&I.getMonth(e)===I.getMonth(t)}function v(e,t){return!(!t&&e<Y||!t&&e>X||!y(e,W)&&y(e,U))}function y(e,t){var i,r,a;if(t)for(r=0;r<t.length;r++)if(a=(i=t[r])+"",!i.start)if(ue.test(a)){if((a=+a.replace("w",""))==e.getDay())return!0}else if(ce.test(a)){if((a=a.split("/"))[1]){if(a[0]-1==e.getMonth()&&a[1]==e.getDate())return!0}else if(a[0]==e.getDate())return!0}else if(i=C(i,$,I),e.getFullYear()==i.getFullYear()&&e.getMonth()==i.getMonth()&&e.getDate()==i.getDate())return!0;return!1}function T(e,t,i,r,a,n,o){var s,l,d,c;if(e)for(l=0;l<e.length;l++)if(c=(s=e[l])+"",!s.start)if(ue.test(c))for(d=(c=+c.replace("w",""))-r;d<a;d+=7)d>=0&&(n[d+1]=o);else ce.test(c)?(c=c.split("/"))[1]?c[0]-1==i&&(n[c[1]]=o):n[c[0]]=o:(s=C(s,$,I),I.getYear(s)==t&&I.getMonth(s)==i&&(n[I.getDay(s)]=o))}function w(e,t,r,a,n,o,s,l){var d,c,u,p,h,g,m,f,b,v,y,x,C,T,w,S,D,E,R,_,M={},A=I.getDate(a,n,o),V=["a","h","i","s"];if(e){for(m=0;m<e.length;m++)(y=e[m]).start&&(y.apply=!1,E=(D=(u=y.d)+"").split("/"),u&&(u.getTime&&a==I.getYear(u)&&n==I.getMonth(u)&&o==I.getDay(u)||!ue.test(D)&&(E[1]&&o==E[1]&&n==E[0]-1||!E[1]&&o==E[0])||ue.test(D)&&A.getDay()==+D.replace("w",""))&&(y.apply=!0,M[A]=!0));for(m=0;m<e.length;m++)if(y=e[m],d=0,S=0,f=ge[r],b=me[r],T=!0,w=!0,c=!1,y.start&&(y.apply||!y.d&&!M[A])){for(x=y.start.split(":"),C=y.end.split(":"),v=0;v<3;v++)void 0===x[v]&&(x[v]=0),void 0===C[v]&&(C[v]=59),x[v]=+x[v],C[v]=+C[v];if("tt"==r)f=i(Math.round((new Date(A).setHours(x[0],x[1],x[2])-new Date(A).setHours(0,0,0,0))/1e3),z,0,86400),b=i(Math.round((new Date(A).setHours(C[0],C[1],C[2])-new Date(A).setHours(0,0,0,0))/1e3),z,0,86400);else{for(x.unshift(x[0]>11?1:0),C.unshift(C[0]>11?1:0),j&&(x[1]>=12&&(x[1]=x[1]-12),C[1]>=12&&(C[1]=C[1]-12)),v=0;v<t;v++)void 0!==F[v]&&(R=i(x[v],fe[V[v]],ge[V[v]],me[V[v]]),_=i(C[v],fe[V[v]],ge[V[v]],me[V[v]]),p=0,h=0,g=0,j&&1==v&&(p=x[0]?12:0,h=C[0]?12:0,g=F[0]?12:0),T||(R=0),w||(_=me[V[v]]),(T||w)&&R+p<F[v]+g&&F[v]+g<_+h&&(c=!0),F[v]!=R&&(T=!1),F[v]!=_&&(w=!1));if(!l)for(v=t+1;v<4;v++)x[v]>0&&(d=fe[r]),C[v]<me[V[v]]&&(S=fe[r]);c||(R=i(x[t],fe[r],ge[r],me[r])+d,_=i(C[t],fe[r],ge[r],me[r])-S,T&&(f=R),w&&(b=_))}if(T||w||c)for(v=f;v<=b;v+=fe[r])s[v]=!l}}}var z,S,D,E={},R={},_={},F=[],M=function(e){var t,i,r,a={};if(e.is("input")){switch(e.attr("type")){case"date":t="yy-mm-dd";break;case"datetime":t="yy-mm-ddTHH:ii:ssZ";break;case"datetime-local":t="yy-mm-ddTHH:ii:ss";break;case"month":t="yy-mm",a.dateOrder="mmyy";break;case"time":t="HH:ii:ss"}a.format=t,i=e.attr("min"),r=e.attr("max"),i&&"undefined"!=i&&(a.min=m(t,i)),r&&"undefined"!=r&&(a.max=m(t,r))}return a}(ee(this)),A=oe({},e.settings),V=k[A.calendarSystem],I=oe(e.settings,pe,V,Be,M,A),P=I.preset,N="datetime"==P?I.dateFormat+I.separator+I.timeFormat:"time"==P?I.timeFormat:I.dateFormat,$=M.format||N,O=I.dateWheels||I.dateFormat,B=I.timeWheels||I.timeFormat,L=I.dateWheels||I.dateDisplay,H=B,q=I.baseTheme||I.theme,U=t(I.invalid),W=t(I.valid),Y=C(I.min,$,I),X=C(I.max,$,I),G=/time/i.test(P),j=/h/.test(H),J=/D/.test(L),K=I.steps||{},Z=K.hour||I.stepHour||1,Q=K.minute||I.stepMinute||1,te=K.second||I.stepSecond||1,ie=K.zeroBased,re=ie||!Y?0:Y.getHours()%Z,ae=ie||!Y?0:Y.getMinutes()%Q,ne=ie||!Y?0:Y.getSeconds()%te,se=r(Z,re,j?11:23),le=r(Q,ae,59),he=r(Q,ae,59),ge={y:Y?Y.getFullYear():-1/0,m:0,d:1,h:re,i:ae,s:ne,a:0,tt:0},me={y:X?X.getFullYear():1/0,m:11,d:31,h:se,i:le,s:he,a:1,tt:86400},fe={y:1,m:1,d:1,h:Z,i:Q,s:te,a:1,tt:1},be={y:function(e){return I.getYear(e)},m:function(e){return I.getMonth(e)},d:function(e){return I.getDay(e)},h:function(e){var t=e.getHours();return i(t=j&&t>=12?t-12:t,Z,re,se)},i:function(e){return i(e.getMinutes(),Q,ae,le)},s:function(e){return i(e.getSeconds(),te,ne,he)},u:function(e){return e.getMilliseconds()},a:function(e){return e.getHours()>11?1:0},dd:a,tt:function(e){return i(Math.round((e.getTime()-new Date(e).setHours(0,0,0,0))/1e3),z||1,0,86400)}};return e.getVal=function(t){return e._hasValue||t?x(o(e.getArrayVal(t)),I,$):null},e.getDate=function(t){return e._hasValue||t?o(e.getArrayVal(t)):null},e.setDate=function(t,i,r,a,n){e.setArrayVal(l(t,!0),i,n,a,r)},D=function(){var e,t,i,r,a,n,o,l,d=0,h=[],g=[],m=[];if(/date/i.test(P)){for(e=O.split(/\|/.test(O)?"|":""),r=0;r<e.length;r++)if(n=0,(i=e[r]).length)if(/y/i.test(i)&&(_.y=1,n++),/m/i.test(i)&&(_.y=1,_.m=1,n++),/d/i.test(i)&&(_.y=1,_.m=1,_.d=1,n++),n>1&&void 0===E.dd)E.dd=d,d++,g.push(p(i)),m=g,S=!0;else if(/y/i.test(i)&&void 0===E.y)E.y=d,d++,g.push({cssClass:"mbsc-dt-whl-y",label:I.yearText,min:Y?I.getYear(Y):void 0,max:X?I.getYear(X):void 0,data:c,getIndex:u});else if(/m/i.test(i)&&void 0===E.m){for(E.m=d,o=[],d++,a=0;a<12;a++)l=L.replace(/[dy|]/gi,"").replace(/mm/,s(a+1)+(I.monthSuffix||"")).replace(/m/,a+1+(I.monthSuffix||"")),o.push({value:a,display:/MM/.test(l)?l.replace(/MM/,'<span class="mbsc-dt-month">'+I.monthNames[a]+"</span>"):l.replace(/M/,'<span class="mbsc-dt-month">'+I.monthNamesShort[a]+"</span>")});g.push({cssClass:"mbsc-dt-whl-m",label:I.monthText,data:o})}else if(/d/i.test(i)&&void 0===E.d){for(E.d=d,o=[],d++,a=1;a<32;a++)o.push({value:a,display:(/dd/i.test(L)?s(a):a)+(I.daySuffix||"")});g.push({cssClass:"mbsc-dt-whl-d",label:I.dayText,data:o})}h.push(g)}if(/time/i.test(P)){for(t=B.split(/\|/.test(B)?"|":""),r=0;r<t.length;r++)if(n=0,(i=t[r]).length&&(/h/i.test(i)&&(_.h=1,n++),/i/i.test(i)&&(_.i=1,n++),/s/i.test(i)&&(_.s=1,n++),/a/i.test(i)&&n++),n>1&&void 0===E.tt)E.tt=d,d++,m.push(f(i));else if(/h/i.test(i)&&void 0===E.h){for(o=[],E.h=d,_.h=1,d++,a=re;a<(j?12:24);a+=Z)o.push({value:a,display:j&&0===a?12:/hh/i.test(H)?s(a):a});m.push({cssClass:"mbsc-dt-whl-h",label:I.hourText,data:o})}else if(/i/i.test(i)&&void 0===E.i){for(o=[],E.i=d,_.i=1,d++,a=ae;a<60;a+=Q)o.push({value:a,display:/ii/i.test(H)?s(a):a});m.push({cssClass:"mbsc-dt-whl-i",label:I.minuteText,data:o})}else if(/s/i.test(i)&&void 0===E.s){for(o=[],E.s=d,_.s=1,d++,a=ne;a<60;a+=te)o.push({value:a,display:/ss/i.test(H)?s(a):a});m.push({cssClass:"mbsc-dt-whl-s",label:I.secText,data:o})}else/a/i.test(i)&&void 0===E.a&&(E.a=d,d++,m.push({cssClass:"mbsc-dt-whl-a",label:I.ampmText,data:/A/.test(i)?[{value:0,display:I.amText.toUpperCase()},{value:1,display:I.pmText.toUpperCase()}]:[{value:0,display:I.amText},{value:1,display:I.pmText}]}));m!=g&&h.push(m)}return h}(),I.isoParts=_,e._format=N,e._order=E,e.handlers.now=function(){e.setDate(new Date,e.live,1e3,!0,!0)},e.buttons.now={text:I.nowText,icon:I.nowIcon,handler:"now"},{minWidth:S&&G?{bootstrap:46,ios:50,material:46,mobiscroll:46,windows:50}[q]:void 0,compClass:"mbsc-dt mbsc-sc",wheels:D,headerText:!!I.headerText&&function(){return g(N,o(e.getArrayVal(!0)),I)},formatValue:function(e){return g($,o(e),I)},parseValue:function(t){return t||(R={},e._hasValue=!1),l(C(t||I.defaultValue||new Date,$,I,_),!!t)},validate:function(t){var i,r,a,n,s=t.values,d=t.index,c=t.direction,u=I.wheels[0][E.d],p=function(e,t){var i,r,a=!1,n=!1,s=0,d=0,c=Y?o(l(Y)):-1/0,u=X?o(l(X)):1/0;if(v(e))return e;if(e<c&&(e=c),e>u&&(e=u),i=e,r=e,2!==t)for(a=v(i,!0);!a&&i<u&&s<100;)a=v(i=new Date(i.getTime()+864e5),!0),s++;if(1!==t)for(n=v(r,!0);!n&&r>c&&d<100;)n=v(r=new Date(r.getTime()-864e5),!0),d++;return 1===t&&a?i:2===t&&n?r:b(e,i)?i:b(e,r)?r:d<=s&&n?r:i}(o(s),c),h=l(p),g=[],m={},f=be.y(p),y=be.m(p),x=I.getMaxDayOfMonth(f,y),C=!0,z=!0;if(ee.each(["dd","y","m","d","tt","a","h","i","s"],(function(e,t){var i=ge[t],a=me[t],n=be[t](p);if(g[E[t]]=[],C&&Y&&(i=be[t](Y)),z&&X&&(a=be[t](X)),n<i&&(n=i),n>a&&(n=a),"dd"!==t&&"tt"!==t&&(C&&(C=n==i),z&&(z=n==a)),void 0!==E[t]){if("y"!=t&&"dd"!=t)for(r=ge[t];r<=me[t];r+=fe[t])(r<i||r>a)&&g[E[t]].push(r);if("d"==t){var o=I.getDate(f,y,1).getDay(),s={};T(U,f,y,o,x,s,1),T(W,f,y,o,x,s,0),ee.each(s,(function(e,i){i&&g[E[t]].push(e)}))}}})),G&&ee.each(["a","h","i","s","tt"],(function(t,i){var r=be[i](p),a=be.d(p),n={};void 0!==E[i]&&(w(U,t,i,f,y,a,n,0),w(W,t,i,f,y,a,n,1),ee.each(n,(function(e,t){t&&g[E[i]].push(e)})),F[t]=e.getValidValue(E[i],r,c,n))})),u&&(u._length!==x||J&&(void 0===d||d===E.y||d===E.m))){for(m[E.d]=u,u.data=[],i=1;i<=x;i++)n=I.getDate(f,y,i).getDay(),a=L.replace(/[my|]/gi,"").replace(/dd/,(i<10?"0"+i:i)+(I.daySuffix||"")).replace(/d/,i+(I.daySuffix||"")),u.data.push({value:i,display:/DD/.test(a)?a.replace(/DD/,'<span class="mbsc-dt-day">'+I.dayNames[n]+"</span>"):a.replace(/D/,'<span class="mbsc-dt-day">'+I.dayNamesShort[n]+"</span>")});e._tempWheelArray[E.d]=h[E.d],e.changeWheel(m)}return{disabled:g,valid:h}}}},He={controls:["calendar"],firstDay:0,weekDays:"short",maxMonthWidth:170,breakPointMd:768,months:1,pageBuffer:1,weeks:6,highlight:!0,outerMonthChange:!0,quickNav:!0,yearChange:!0,tabs:"auto",todayClass:"mbsc-cal-today",btnCalPrevClass:"mbsc-ic mbsc-ic-arrow-left6",btnCalNextClass:"mbsc-ic mbsc-ic-arrow-right6",dateText:"Date",timeText:"Time",todayText:"Today",fromText:"Start",toText:"End",moreEventsText:"{count} more",prevMonthText:"Previous Month",nextMonthText:"Next Month",prevYearText:"Previous Year",nextYearText:"Next Year"},qe=function(e){function t(t){t.hasClass("mbsc-cal-h")&&(t.removeClass("mbsc-cal-h"),e._onSelectShow())}function r(e){e.hasClass("mbsc-cal-h")||e.addClass("mbsc-cal-h")}function a(e){e.hasClass("mbsc-cal-h")?t(e):r(e)}function n(e,t,i){e[t]=e[t]||[],e[t].push(i)}function o(e,t,i){var r,a,o,s,l=rt.getYear(t),d=rt.getMonth(t),c={};return e&&ee.each(e,(function(e,u){if(r=u.d||u.start||u,a=r+"",u.start&&u.end)for(s=b(C(u.start,ye,rt)),o=b(C(u.end,ye,rt));s<=o;)n(c,s,u),s=rt.getDate(rt.getYear(s),rt.getMonth(s),rt.getDay(s)+1);else if(ue.test(a))for(s=N(t,!1,+a.replace("w",""));s<=i;)n(c,s,u),s=rt.getDate(rt.getYear(s),rt.getMonth(s),rt.getDay(s)+7);else if(ce.test(a))if((a=a.split("/"))[1])for(s=rt.getDate(l,a[0]-1,a[1]);s<=i;)n(c,s,u),s=rt.getDate(rt.getYear(s)+1,rt.getMonth(s),a[1]);else for(s=rt.getDate(l,d,a[0]);s<=i;)n(c,s,u),s=rt.getDate(rt.getYear(s),rt.getMonth(s)+1,a[0]);else n(c,b(C(r,ye,rt)),u)})),c}function s(e){return!(e<qe||e>Pe||void 0!==De[e]&&void 0===ot[e])}function d(t){var i,r,a,n,o=!!Ve[t]&&Ve[t],s=!!ke[t]&&ke[t],l=s&&s[0].background?s[0].background:o&&o[0].background,d="";if(s)for(i=0;i<s.length;i++)d+=(s[i].cssClass||"")+" ";if(o){for(a='<div class="mbsc-cal-marks">',i=0;i<o.length;i++)d+=((r=o[i]).cssClass||"")+" ",a+='<div class="mbsc-cal-mark"'+(r.color?' style="background:'+r.color+';"':"")+"></div>";a+="</div>"}return n={marked:o,background:l,cssClass:d,markup:fe[t]?fe[t].join(""):we?a:""},oe(n,e._getDayProps(t,n))}function c(e){return' style="'+(Me?"transform: translateY("+100*e+"%)":"left:"+100*e*it+"%")+'"'}function u(e){return $(e,Qe-1)>Pe&&(e=$(Pe,1-Qe)),e<qe&&(e=qe),e}function g(e,t,i){var r=e.color,a=e.text;return'<div data-id="'+e._id+'" data-index="'+t+'" class="mbsc-cal-txt" title="'+ee("<div>"+a+"</div>").text()+'"'+(r?' style="background:'+r+(i?";color:"+D(r):"")+';"':"")+">"+(i?a:"")+"</div>"}function m(t){var i=N($(t,-et-Ze),!1),r=N($(t,-et+Qe+Ze-1),!1);r=rt.getDate(rt.getYear(r),rt.getMonth(r),rt.getDay(r)+7*re),e._onGenMonth(i,r),De=o(rt.invalid,i,r),ot=o(rt.valid,i,r),Ve=o(rt.labels||rt.events||rt.marked,i,r),ke=o(rt.colors,i,r),Ae=e._labels||Ve||ke,(Te=rt.labels||e._labels)&&function(){fe={};for(var e={},t=i,a=function(){t.getDay()==xe&&(e={});for(var i=$e,r=Ae[t]||[],a=r.length,n=[],o=void 0,s=void 0,l=0,d=0,c=0,u=void 0;l<i;)if(o=null,r.forEach((function(t,i){e[l]==t&&(o=t,s=i)})),l==i-1&&(d<a-1||a&&c==a&&!o)){var p=a-d,h=(p>1&&rt.moreEventsPluralText||rt.moreEventsText).replace(/{count}/,p);p&&n.push('<div class="mbsc-cal-txt-more">'+h+"</div>"),o&&(e[l]=null,o._days.forEach((function(e){fe[e][l]='<div class="mbsc-cal-txt-more">'+rt.moreEventsText.replace(/{count}/,1)+"</div>"}))),d++,l++}else if(o)s==c&&c++,T(t,C(o.end))&&(e[l]=null),n.push(g(o,s)),l++,d++,o._days.push(t);else if(c<a){var m=r[c],v=m.start&&C(m.start),y=m.end&&C(m.end),x=t.getDay(),w=xe-x>0?7:0,z=y&&!T(v,y);v&&!T(t,v)&&x!=xe||(void 0===m._id&&(m._id=gt++),z&&(e[l]=m),m._days=[t],u=z?100*Math.min(f(t,b(y))+1,7+xe-x-w):100,n.push(z?'<div class="mbsc-cal-txt-w" style="width:'+u+'%">'+g(m,c,!0)+"</div>"+g(m,c):g(m,c,!0)),l++,d++),c++}else n.push('<div class="mbsc-cal-txt-ph"></div>'),l++;fe[t]=n,t=rt.getDate(rt.getYear(t),rt.getMonth(t),rt.getDay(t)+1)};t<r;)a()}()}function y(e){var t=rt.getYear(e),i=rt.getMonth(e);me=e,te=e,A(e),nt("onMonthChange",{year:t,month:i}),nt("onMonthLoading",{year:t,month:i}),nt("onPageChange",{firstDay:e}),nt("onPageLoading",{firstDay:e}),m(e)}function x(e){var t=rt.getYear(e),i=rt.getMonth(e);void 0===Ke?w(e,t,i):R(e,Ke,!0),_(te,ve.focus),ve.focus=!1}function w(e,t,i){var r=ve.$scroller;ee(".mbsc-cal-slide",r).removeClass("mbsc-cal-slide-a"),ee(".mbsc-cal-slide",r).slice(Ze,Ze+Qe).addClass("mbsc-cal-slide-a"),Te&&ee(".mbsc-cal-slide-a .mbsc-cal-txt",r).on("mouseenter",(function(){var e=ee(this).attr("data-id");ee('.mbsc-cal-txt[data-id="'+e+'"]',r).addClass("mbsc-hover")})).on("mouseleave",(function(){ee(".mbsc-cal-txt.mbsc-hover",r).removeClass("mbsc-hover")})),nt("onMonthLoaded",{year:t,month:i}),nt("onPageLoaded",{firstDay:e})}function z(e,t){var i,r=rt.getYear(e),a='<div class="mbsc-cal-slide"'+c(t)+'><div role="grid" class="mbsc-cal-table"><div class="mbsc-cal-row">';for(i=0;i<12;i++)i&&i%3==0&&(a+='</div><div class="mbsc-cal-row">'),a+='<div role="gridcell" tabindex="-1" aria-label="'+r+'" data-val="'+r+'" class="mbsc-cal-cell mbsc-btn-e '+(r<Ye||r>Be?" mbsc-disabled ":"")+(r==rt.getYear(me)?he:"")+'"><div class="mbsc-cal-cell-i mbsc-cal-cell-txt">'+r+ht+"</div></div>",r++;return a+"</div></div></div>"}function S(t,i){var r,a,n,o,l,u,p,h,g,m,f,b,v,y,x,C,w=1,z=rt.getYear(t),S=rt.getMonth(t),E=rt.getDay(t),R=null!==rt.defaultValue||e._hasValue?e.getDate(!0):null,_=rt.getDate(z,S,E).getDay(),F=xe-_>0?7:0,M='<div class="mbsc-cal-slide"'+c(i)+'><div role="grid" class="mbsc-cal-table"><div class="mbsc-cal-row">';for(C=0;C<7*re;C++)x=C+xe-F,n=(r=rt.getDate(z,S,x-_+E)).getFullYear(),o=r.getMonth(),l=r.getDate(),u=rt.getMonth(r),p=rt.getDay(r),y=rt.getMaxDayOfMonth(n,o),h=n+"-"+(o+1)+"-"+l,m=(g=oe({valid:s(r),selected:R&&T(R,r)},d(r))).valid,f=g.selected,a=g.cssClass,b=new Date(r).setHours(12,0,0,0)===(new Date).setHours(12,0,0,0),v=u!==S,be[h]=g,C&&C%7==0&&(M+='</div><div class="mbsc-cal-row">'),lt&&C%7==0&&("month"==lt&&v&&w>1?w=1==l?1:2:"year"==lt&&(w=rt.getWeekNumber(rt.getDate(n,o,l+(7-xe+1)%7))),M+='<div role="gridcell" class="mbsc-cal-cell mbsc-cal-week-nr">'+w+"</div>",w++),M+='<div role="gridcell" aria-label="'+(b?rt.todayText+", ":"")+rt.dayNames[r.getDay()]+", "+rt.monthNames[u]+" "+p+" "+(g.ariaLabel?", "+g.ariaLabel:"")+'"'+(v&&!at?' aria-hidden="true"':' data-full="'+h+'"')+(f?' aria-selected="true"':"")+(m?' tabindex="-1"':' aria-disabled="true"')+' class="mbsc-cal-cell mbsc-cal-day mbsc-cal-day'+x%7+" "+(rt.dayClass||"")+" "+(f?he:"")+(b?" "+rt.todayClass:"")+(a?" "+a:"")+(1==p?" mbsc-cal-day-first":"")+(p==y?" mbsc-cal-day-last":"")+(v?" mbsc-cal-day-diff":"")+(m?" mbsc-btn-e":" mbsc-disabled")+(g.marked?" mbsc-cal-day-marked":"")+(g.background?" mbsc-cal-day-colored":"")+'"><div class="mbsc-cal-cell-i mbsc-cal-day-i"><div class="mbsc-cal-day-date mbsc-cal-cell-txt"'+(g.background?' style="background:'+g.background+";color:"+D(g.background)+'"':"")+">"+p+"</div>"+(g.markup?"<div>"+g.markup+"</div>":"")+"</div></div>";return M+"</div></div></div>"}function R(e,t,i){var r,a=rt.getYear(e),n=rt.getMonth(e),o=ve?ve.pos:0,s="";if(be={},re)for(t||(nt("onMonthLoading",{year:a,month:n}),nt("onPageLoading",{firstDay:e})),m(e),r=0;r<tt;r++)s+=S($(e,r-et-Ze),o*it+r-Ze);return Ke=void 0,i&&ve&&(ve.$active=null,ve.$scroller.html(s),w(e,a,n)),s}function _(e,t){if(ve){var i=ve.$active;i&&i.length&&(i[0].blur(),i.hasClass("mbsc-disabled")?i.removeAttr("tabindex"):i.attr("tabindex","-1")),ve.$active=ee('.mbsc-cal-slide-a .mbsc-cal-day[data-full="'+v(e)+'"]',ve.$scroller).attr("tabindex","0"),t&&ve.$active.length&&ve.$active[0].focus()}}function F(e,t){ee(".mbsc-selected",t).removeClass(he).removeAttr("aria-selected"),ee('.mbsc-cal-cell[data-val="'+e+'"]',t).addClass(he).attr("aria-selected","true")}function M(t,i,r,a){var n,o;st&&(t<qe&&(t=qe),t>Pe&&(t=Pe),"calendar"!==st&&ze&&!i||(e._isSetDate=!i,Ce&&re&&(o=N(u(t),_e),Je&&(t<$(me,-et)||t>=$(me,Qe-et))&&((n=_e?rt.getMonth(o)-rt.getMonth(me)+12*(rt.getYear(o)-rt.getYear(me)):Math.floor(f(me,o)/(7*re)))&&(ve.queue=[],ve.focus=a&&r,B(ve,n,r))),n&&r||_(t,a),i||function(t){var i=ve&&ve.$scroller;rt.highlight&&ve&&(ee(".mbsc-selected",i).removeClass(he).removeAttr("aria-selected"),(null!==rt.defaultValue||e._hasValue)&&ee('.mbsc-cal-day[data-full="'+v(t)+'"]',i).addClass(he).attr("aria-selected","true"))}(t),_e||A(t,!0),te=t,Je=!0),e._onSetDate(t,n),e._isSetDate=!1))}function A(e,t){var i,r,a,n=rt.getYear(e),o=rt.getMonth(e),s=n+ht;if(Se){if(F(o,je.$scroller),F(n,pt.$scroller),B(pt,Math.floor(n/12)-Math.floor(rt.getYear(pt.first)/12),!0),ee(".mbsc-cal-cell",je.$scroller).removeClass("mbsc-disabled"),n===Ye)for(i=0;i<We;i++)ee('.mbsc-cal-cell[data-val="'+i+'"]',je.$scroller).addClass("mbsc-disabled");if(n===Be)for(i=Oe+1;i<=12;i++)ee('.mbsc-cal-cell[data-val="'+i+'"]',je.$scroller).addClass("mbsc-disabled")}for(t||(V(ee(".mbsc-cal-prev-m",X),$(e,-et)<=qe),V(ee(".mbsc-cal-next-m",X),$(e,Qe-et)>Pe),V(ee(".mbsc-cal-prev-y",X),rt.getDate(n-1,o+1,1)<=qe),V(ee(".mbsc-cal-next-y",X),rt.getDate(n+1,o,1)>Pe)),Z.attr("aria-label",n).html(s),i=0;i<Qe;i++)e=rt.getDate(n,o-et+i,1),r=rt.getYear(e),a=rt.getMonth(e),s=r+ht,G.eq(i).attr("aria-label",rt.monthNames[a]+(ct?"":" "+n)).html((!ct&&ut<Xe?s+" ":"")+Ge[a]+(!ct&&ut>Xe?" "+s:""))}function V(e,t){t?e.addClass(pe).attr("aria-disabled","true"):e.removeClass(pe).removeAttr("aria-disabled")}function k(t,i){var r=e.getDate(!0),a=t[0],n=t.attr("data-full"),o=n?n.split("-"):[],s=h(o[0],o[1]-1,o[2]),l=h(s.getFullYear(),s.getMonth(),s.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()),d=t.hasClass("mbsc-selected"),c=ee(i.target),u=c[0];if(at||!t.hasClass("mbsc-cal-day-diff")){if(Te&&a.contains(u))for(;u!=a;){if(c.hasClass("mbsc-cal-txt")||c.hasClass("mbsc-cal-txt-more")){var p=c.attr("data-index"),g=Ae[s];if(!1===nt("onLabelTap",{date:l,domEvent:i,target:c[0],labels:g,label:g[p]}))return;break}u=(c=c.parent())[0]}!1===nt("onDayChange",oe(be[n],{date:l,target:a,selected:d}))||rt.readonly||t.hasClass("mbsc-disabled")||e._selectDay(t,s,l,d)}}function I(e){r(j),M(rt.getDate(rt.getYear(ve.first),e.attr("data-val"),1),!0,!0)}function P(e){r(Q),M(rt.getDate(e.attr("data-val"),rt.getMonth(ve.first),1),!0,!0)}function N(e,t,i){var r=rt.getYear(e),a=rt.getMonth(e),n=e.getDay(),o=xe-n>0?7:0;return t?rt.getDate(r,a,1):rt.getDate(r,a,(void 0===i?xe:i)-o-n+rt.getDay(e))}function $(e,t){var i=rt.getYear(e),r=rt.getMonth(e),a=rt.getDay(e);return _e?rt.getDate(i,r+t,1):rt.getDate(i,r,a+t*re*7)}function O(e,t){var i=12*Math.floor(rt.getYear(e)/12);return rt.getDate(i+12*t,0,1)}function B(t,i,r,a){i&&e._isVisible&&(t.queue.push(arguments),1==t.queue.length&&L(t,i,r,a))}function L(t,i,r,a){var n,o,s="",l=t.$scroller,d=t.buffer,c=t.offset,u=t.pages,p=t.total,h=t.first,g=t.genPage,m=t.getFirst,f=i>0?Math.min(i,d):Math.max(i,-d),b=t.pos*it+f-i+c,v=Math.abs(i)>d;t.callback&&(t.load(),t.callback(!0)),t.first=m(h,i),t.pos+=f*it,t.changing=!0,t.load=function(){if(v){for(n=0;n<u;n++)s+=g(m(h,o=i+n-c),b+o);i>0?(ee(".mbsc-cal-slide",l).slice(-u).remove(),l.append(s)):i<0&&(ee(".mbsc-cal-slide",l).slice(0,u).remove(),l.prepend(s))}},t.callback=function(r){var s=Math.abs(f),u="";if(e._isVisible){for(n=0;n<s;n++)u+=g(m(h,o=i+n-c-d+(i>0?p-s:0)),b+o);if(i>0?(l.append(u),ee(".mbsc-cal-slide",l).slice(0,f).remove()):i<0&&(l.prepend(u),ee(".mbsc-cal-slide",l).slice(f).remove()),v){for(u="",n=0;n<s;n++)u+=g(m(h,o=i+n-c-d+(i>0?0:p-s)),b+o);i>0?(ee(".mbsc-cal-slide",l).slice(0,f).remove(),l.prepend(u)):i<0&&(ee(".mbsc-cal-slide",l).slice(f).remove(),l.append(u))}q(t),a&&!r&&a(),t.callback=null,t.load=null,t.queue.shift(),v=!1,t.queue.length?L.apply(this,t.queue[0]):(t.changing=!1,t.onAfterChange(t.first))}},t.onBeforeChange(t.first),t.load&&(t.load(),t.scroller.scroll(-t.pos*t.size,r?200:0,!1,t.callback))}function H(t,i,r,a,n,o,s,d,c,u,p,h,g){var m=Me?"Y":"X",f={$scroller:ee(".mbsc-cal-scroll",t),queue:[],buffer:a,offset:n,pages:o,first:d,total:s,pos:0,min:i,max:r,genPage:h,getFirst:g,onBeforeChange:u,onAfterChange:p};return f.scroller=new Ie(t,{axis:m,easing:"",contSize:0,maxSnapScroll:a,mousewheel:void 0===rt.mousewheel?Me:rt.mousewheel,time:200,lock:!0,rtl:Fe,stopProp:!1,minScroll:0,maxScroll:0,onBtnTap:function(e){"touchend"==e.domEvent.type&&l(),c(ee(e.target),e.domEvent)},onAnimationStart:function(){f.changing=!0},onAnimationEnd:function(e){h&&B(f,Math.round((-f.pos*f.size-e["pos"+m])/f.size)*it)}}),e._scrollers.push(f.scroller),f}function q(e,t){var i,r=0,a=0,n=e.first;if(!e.changing||!t){if(e.getFirst){for(r=e.buffer,a=e.buffer;a&&e.getFirst(n,a+e.pages-e.offset-1)>e.max;)a--;for(;r&&e.getFirst(n,1-r-e.offset)<=e.min;)r--}i=Math.round(ae/e.pages),Re&&i&&e.size!=i&&e.$scroller[Me?"height":"width"](i),oe(e.scroller.settings,{snap:i,minScroll:(-e.pos*it-a)*i,maxScroll:(-e.pos*it+r)*i}),e.size=i,e.scroller.refresh()}}function U(t){e._onRefresh(t),e._isVisible&&Ce&&re&&(ve&&ve.changing?Ke=t:(R(me,t,!0),_(te)))}function W(){if(Ce&&re){var t=ee(".mbsc-cal-scroll-c",X);ve=H(t[0],qe,Pe,Ze,et,Qe,tt,me,k,y,x,S,$),Se&&(je=H(t[1],null,null,1,0,1,3,me,I),pt=H(t[2],Ue,Ne,1,0,1,3,me,P,i,i,z,O),e.tap(G,(function(){a(j),r(Q)})),e.tap(Z,(function(){a(Q),r(j)}))),E(ee(".mbsc-cal-btn",X),(function(e,t,i,r){B(ve,t,!0,r)})),x(me),null===rt.defaultValue&&!e._hasValue||e._multiple||(e._activeElm=ve.$active[0]),Y.on("keydown",(function(e){var t,i=rt.getYear(te),r=rt.getMonth(te),a=rt.getDay(te);switch(e.keyCode){case 32:k(ve.$active,e);break;case 37:t=rt.getDate(i,r,a-1*it);break;case 39:t=rt.getDate(i,r,a+1*it);break;case 38:t=rt.getDate(i,r,a-7);break;case 40:t=rt.getDate(i,r,a+7);break;case 36:t=rt.getDate(i,r,1);break;case 35:t=rt.getDate(i,r+1,0);break;case 33:t=e.altKey?rt.getDate(i-1,r,a):_e?rt.getDate(i,r-1,a):rt.getDate(i,r,a-7*re);break;case 34:t=e.altKey?rt.getDate(i+1,r,a):_e?rt.getDate(i,r+1,a):rt.getDate(i,r,a+7*re)}t&&(e.preventDefault(),M(t,!0,!1,!0))}))}e.tap(ee(".mbsc-cal-tab",X),(function(){e.changeTab(ee(this).attr("data-control"))}))}var Y,X,G,j,J,K,Z,Q,te,ie,re,ae,ne,se,le,de,pe,he,ge,me,fe,be,ve,ye,xe,Ce,Te,we,ze,Se,De,Ee,Re,_e,Fe,Me,Ae,Ve,ke,Pe,Ne,$e,Oe,Be,qe,Ue,We,Ye,Xe,Ge,je,Je,Ke,Ze,Qe,et,tt,it,rt,at,nt,ot,st,lt,dt,ct,ut,pt,ht,gt=1,mt=this;return function(){var t,i,r;le={},de=[],fe={},nt=e.trigger,r=oe({},e.settings),t=(rt=oe(e.settings,He,r)).controls.join(","),xe=rt.firstDay,Fe=rt.rtl,Ze=rt.pageBuffer,lt=rt.weekCounter,re=rt.weeks,_e=6==re,Me="vertical"==rt.calendarScroll,se=e._getRespCont(),dt="full"==rt.weekDays?"":"min"==rt.weekDays?"Min":"Short",i=rt.layout||("inline"==rt.display||/top|bottom/.test(rt.display)&&rt.touchUi?"liquid":""),ne=(Re="liquid"==i)?null:rt.calendarWidth,it=Fe&&!Me?-1:1,pe="mbsc-disabled "+(rt.disabledClass||""),ge="mbsc-selected "+(rt.selectedTabClass||""),he="mbsc-selected "+(rt.selectedClass||""),$e=Math.max(1,Math.floor(((rt.calendarHeight||0)/re-45)/18)),t.match(/calendar/)&&(le.calendar=1,Ce=!0),t.match(/date/)&&!Ce&&(le.date=1),t.match(/time/)&&(le.time=1),rt.controls.forEach((function(e){le[e]&&de.push(e)})),Se=rt.quickNav&&Ce&&_e,ct=rt.yearChange&&_e,Re&&Ce&&"center"==rt.display&&(e._isFullScreen=!0),rt.layout=i,rt.preset=(le.date||Ce?"date":"")+(le.time?"time":"")}(),ie=Le.call(this,e),Ge=ct?rt.monthNamesShort:rt.monthNames,ht=rt.yearSuffix||"",Xe=(rt.dateWheels||rt.dateFormat).search(/m/i),ut=(rt.dateWheels||rt.dateFormat).search(/y/i),ye=e._format,rt.min&&(qe=b(C(rt.min,ye,rt)),Ye=rt.getYear(qe),We=rt.getMonth(qe),Ue=rt.getDate(12*Math.floor(Ye/12),0,1)),rt.max&&(Pe=b(C(rt.max,ye,rt)),Be=rt.getYear(Pe),Oe=rt.getMonth(Pe),Ne=rt.getDate(12*Math.floor(Be/12),0,1)),e.refresh=function(){U(!1)},e.redraw=function(){U(!0)},e.navigate=function(e,t){M(C(e,ye,rt),!0,t)},e.changeTab=function(t){e._isVisible&&le[t]&&st!=t&&(st=t,ee(".mbsc-cal-tab",X).removeClass(ge).removeAttr("aria-selected"),ee('.mbsc-cal-tab[data-control="'+t+'"]',X).addClass(ge).attr("aria-selected","true"),ze&&(K.addClass("mbsc-cal-h"),le[st].removeClass("mbsc-cal-h")),"calendar"==st&&M(e.getDate(!0),!1,!0),e._showDayPicker(),e.trigger("onTabChange",{tab:st}))},e._checkSize=!0,e._onGenMonth=i,e._onSelectShow=i,e._onSetDate=i,e._onRefresh=i,e._getDayProps=i,e._prepareObj=o,e._showDayPicker=function(){Se&&(r(Q),r(j))},e._selectDay=e.__selectDay=function(t,i,r){var a=e.live;Je=rt.outerMonthChange,Ee=!0,e.setDate(r,a,1e3,!a,!0),a&&nt("onSet",{valueText:e._value})},oe(ie,{labels:null,compClass:"mbsc-calendar mbsc-dt mbsc-sc",onMarkupReady:function(t){var i=0;X=ee(t.target),J=ee(".mbsc-fr-c",X),te=e.getDate(!0),ae=0,Ce&&(we=!(!rt.marked&&!rt.data||rt.labels||rt.multiLabel||rt.showEventCount),Je=!0,st="calendar",Qe="auto"==rt.months?Math.max(1,Math.min(3,Math.floor((ne||p(se))/280))):+rt.months,tt=Qe+2*Ze,et=0,Me=Me&&Qe<2,at=void 0===rt.showOuterDays?Qe<2&&!Me:rt.showOuterDays,me=N(u(te),_e),J.append(function(){var e,t,i,r,a,n,o="",s=Fe?rt.btnCalNextClass:rt.btnCalPrevClass,l=Fe?rt.btnCalPrevClass:rt.btnCalNextClass;for(a='<div class="mbsc-cal-btn-w"><div data-step="-1" role="button" tabindex="0" aria-label="'+rt.prevMonthText+'" class="'+s+' mbsc-cal-prev mbsc-cal-prev-m mbsc-cal-btn mbsc-fr-btn mbsc-fr-btn-e"></div>',t=0;t<(re?Qe:1);t++)a+='<div role="button" class="mbsc-cal-month"></div>';if(a+='<div data-step="1" role="button" tabindex="0" aria-label="'+rt.nextMonthText+'" class="'+l+' mbsc-cal-next mbsc-cal-next-m mbsc-cal-btn mbsc-fr-btn mbsc-fr-btn-e"></div></div>',ct&&(o='<div class="mbsc-cal-btn-w"><div data-step="-12" role="button" tabindex="0" aria-label="'+rt.prevYearText+'" class="'+s+' mbsc-cal-prev mbsc-cal-prev-y mbsc-cal-btn mbsc-fr-btn mbsc-fr-btn-e"></div><div role="button" class="mbsc-cal-year"></div><div data-step="12" role="button" tabindex="0" aria-label="'+rt.nextYearText+'" class="'+l+' mbsc-cal-next mbsc-cal-next-y mbsc-cal-btn mbsc-fr-btn mbsc-fr-btn-e"></div></div>'),re&&(n=R(me)),e='<div class="mbsc-w-p mbsc-cal-c"><div class="mbsc-cal '+(_e?"":" mbsc-cal-week-view")+(Qe>1?" mbsc-cal-multi ":"")+(lt?" mbsc-cal-weeks ":"")+(Me?" mbsc-cal-vertical":"")+(we?" mbsc-cal-has-marks":"")+(Te?" mbsc-cal-has-labels":"")+(at?"":" mbsc-cal-hide-diff ")+(rt.calendarClass||"")+'"'+(Re?"":' style="width:'+(ne||280*Qe)+'px;"')+'><div class="mbsc-cal-hdr">'+(ut<Xe||Qe>1?o+a:a+o)+"</div>",re){for(e+='<div class="mbsc-cal-body"><div class="mbsc-cal-day-picker"><div class="mbsc-cal-days-c">',i=0;i<Qe;i++){for(e+='<div class="mbsc-cal-days">',t=0;t<7;t++)e+='<div class="mbsc-cal-week-day'+(r=(t+xe)%7)+'" aria-label="'+rt.dayNames[r]+'">'+rt["dayNames"+dt][r]+"</div>";e+="</div>"}e+='</div><div class="mbsc-cal-scroll-c mbsc-cal-day-scroll-c '+(rt.calendarClass||"")+'"'+(rt.calendarHeight?' style="height:'+rt.calendarHeight+'px"':"")+'><div class="mbsc-cal-scroll" style="width:'+100/Qe+'%">'+n+"</div></div>"}if(e+="</div>",Se){for(e+='<div class="mbsc-cal-month-picker mbsc-cal-picker mbsc-cal-h"><div class="mbsc-cal-scroll-c '+(rt.calendarClass||"")+'"><div class="mbsc-cal-scroll">',t=0;t<3;t++){for(e+='<div class="mbsc-cal-slide"'+c(t-1)+'><div role="grid" class="mbsc-cal-table"><div class="mbsc-cal-row">',i=0;i<12;i++)i&&i%3==0&&(e+='</div><div class="mbsc-cal-row">'),e+='<div role="gridcell"'+(1==t?' tabindex="-1" aria-label="'+rt.monthNames[i]+'" data-val="'+i+'"':"")+' class="mbsc-cal-cell'+(1==t?" mbsc-btn-e":"")+'"><div class="mbsc-cal-cell-i mbsc-cal-cell-txt">'+(1==t?rt.monthNamesShort[i]:"&nbsp;")+"</div></div>";e+="</div></div></div>"}for(e+="</div></div></div>",e+='<div class="mbsc-cal-year-picker mbsc-cal-picker mbsc-cal-h"><div class="mbsc-cal-scroll-c '+(rt.calendarClass||"")+'"><div class="mbsc-cal-scroll">',t=-1;t<2;t++)e+=z(O(me,t),t);e+="</div></div></div>"}return e+"</div></div></div>"}()),G=ee(".mbsc-cal-month",X),Z=ee(".mbsc-cal-year",X),Y=ee(".mbsc-cal-day-scroll-c",X)),Se&&(Q=ee(".mbsc-cal-year-picker",X),j=ee(".mbsc-cal-month-picker",X)),K=ee(".mbsc-w-p",X),de.length>1&&J.before(function(){var e,t;return e='<div class="mbsc-cal-tabs-c"><div class="mbsc-cal-tabs" role="tablist">',de.forEach((function(i,r){t=rt[("calendar"==i?"date":i)+"Text"],e+='<div role="tab" aria-controls="'+mt.id+"-mbsc-pnl-"+r+'" class="mbsc-cal-tab mbsc-fr-btn-e '+(r?"":ge)+'" data-control="'+i+'"'+(rt.tabLink?'><a href="#">'+t+"</a>":' tabindex="0">'+t)+"</div>"})),e+="</div></div>"}()),["date","time","calendar"].forEach((function(e){le[e]?(le[e]=K.eq(i),i++):"date"==e&&!le.date&&Ce&&(K.eq(i).remove(),i++)})),de.forEach((function(e){J.append(le[e])})),!Ce&&le.date&&le.date.css("position","relative"),e._scrollers=[],W()},onShow:function(){Ce&&re&&A(_e?me:te)},onHide:function(){e._scrollers.forEach((function(e){e.destroy()})),be=null,ve=null,je=null,pt=null,st=null},onValidated:function(t){var i,r,a=t.index,n=e._order;r=e.getDate(!0),Ee?i="calendar":void 0!==a&&(i=n.dd==a||n.d==a||n.m==a||n.y==a?"date":"time"),nt("onSetDate",{date:r,control:i}),"time"!==i&&M(r,!1,!!t.time,Ee&&!e._multiple),Ee=!1},onPosition:function(t){var i,r,a,n,o,s,l,d=t.oldHeight,c=t.windowHeight;if(ze=(t.hasTabs||!0===rt.tabs||!1!==rt.tabs&&Re)&&de.length>1,Re&&(t.windowWidth>=rt.breakPointMd?ee(t.target).addClass("mbsc-fr-md"):ee(t.target).removeClass("mbsc-fr-md")),ze?(X.addClass("mbsc-cal-tabbed"),st=ee(".mbsc-cal-tab.mbsc-selected",X).attr("data-control"),K.addClass("mbsc-cal-h"),le[st].removeClass("mbsc-cal-h")):(X.removeClass("mbsc-cal-tabbed"),K.removeClass("mbsc-cal-h")),e._isFullScreen&&(Y.height(""),l=c-(o=t.popup.offsetHeight)+Y[0].offsetHeight,c>=o&&Y.height(l)),Te&&re&&c!=d){var u=l||Y[0].offsetHeight,p=Y.find(".mbsc-cal-txt-ph")[0],h=p.offsetTop,g=p.offsetHeight,m=Math.max(1,Math.floor((u/re-h)/(g+2)));$e!=m&&($e=m,e.redraw())}if(Ce&&re){if(n=(s=Re||Me||ze?Y[0][Me?"offsetHeight":"offsetWidth"]:ne||280*Qe)!=ae,ae=s,Re&&n&&ct)for(Ge=rt.maxMonthWidth>G[0].offsetWidth?rt.monthNamesShort:rt.monthNames,r=rt.getYear(me),a=rt.getMonth(me),i=0;i<Qe;i++)G.eq(i).text(Ge[rt.getMonth(rt.getDate(r,a-et+i,1))]);n&&q(ve,!0)}Se&&n&&(q(je,!0),q(pt,!0))}})},Ue={};Pe.calendar=function(e){function t(e){return h(e.getFullYear(),e.getMonth(),e.getDate())}function i(e){var i,r,a=null;if(y={},e&&e.length)for(r=0;r<e.length;r++)i=C(e[r],l,p,p.isoParts),a=a||i,y[t(i)]=i;return a}function n(){e.redraw()}var o,s,l,d,c,u=oe({},e.settings),p=oe(e.settings,Ue,u),m="mbsc-selected "+(p.selectedClass||""),f=p.defaultValue,b="multiple"==p.select||p.select>1||"week"==p.selectType,v=a(p.select)?p.select:1/0,y={};return o=qe.call(this,e),d=void 0===p.firstSelectDay?p.firstDay:p.firstSelectDay,l=e._format,b&&i(f),e._multiple=b,e._getDayProps=function(e){return{selected:b?void 0!==y[e]:void 0}},e._selectDay=function(t,i,a,o){if(p.setOnDayTap&&"multiple"!=p.select&&"inline"!=p.display)return e.setDate(a),void e.select();if(b)if("week"==p.selectType){var l,c,u=i.getDay()-d;for(u=u<0?7+u:u,"multiple"!=p.select&&(y={}),l=0;l<7;l++)c=h(i.getFullYear(),i.getMonth(),i.getDate()-u+l),o?delete y[c]:r(y).length/7<v&&(y[c]=c);n()}else{var g=ee('.mbsc-cal-day[data-full="'+t.attr("data-full")+'"]',s);o?(g.removeClass(m).removeAttr("aria-selected"),delete y[i]):r(y).length<v&&(g.addClass(m).attr("aria-selected","true"),y[i]=i)}e.__selectDay(t,i,a)},e.setVal=function(t,r,a,o,s){b&&(t=i(t)),e._setVal(t,r,a,o,s),b&&n()},e.getVal=function(t){var i,r=[];if(b){for(i in y)r.push(x(y[i],p,l));return r}return x(e.getDate(t),p,l)},oe({},o,{highlight:!b,outerMonthChange:!b,parseValue:function(e){return b&&e&&"string"==typeof e&&(e=i(e.split(","))),b&&f&&f.length&&(p.defaultValue=f[0]),o.parseValue.call(this,e)},formatValue:function(t){var i,r=[];if(b){for(i in y)r.push(g(l,y[i],p));return r.join(", ")}return o.formatValue.call(this,t,e)},onClear:function(){b&&(y={},n())},onBeforeShow:function(){void 0!==p.setOnDayTap||p.buttons&&p.buttons.length||1!=p.controls.length||(p.setOnDayTap=!0),p.setOnDayTap&&"inline"!=p.display&&(p.outerMonthChange=!1),p.counter&&b&&(p.headerText=function(){var e=0,t="week"==p.selectType?7:1;return ee.each(y,(function(){e++})),((e=Math.round(e/t))>1&&p.selectedPluralText||p.selectedText).replace(/{count}/,e)})},onMarkupReady:function(e){o.onMarkupReady.call(this,e),s=ee(e.target),b&&(ee(".mbsc-fr-hdr",s).attr("aria-live","off"),c=oe({},y))},onCancel:function(){!e.live&&b&&(y=oe({},c))}})},function(e,i,r){N[e]=function(a){return t(this,P(a,{component:i,preset:!1===r?void 0:e}),arguments)}}("calendar",Oe),k.hijri={getYear:function(e){return M(e.getFullYear(),e.getMonth()+1,e.getDate())[0]},getMonth:function(e){return--M(e.getFullYear(),e.getMonth()+1,e.getDate())[1]},getDay:function(e){return M(e.getFullYear(),e.getMonth()+1,e.getDate())[2]},getDate:function(e,t,i,r,a,n,o){t<0&&(e+=Math.floor(t/12),t=12+t%12),t>11&&(e+=Math.floor(t/12),t%=12);var s=function(e,t,i){e=parseInt(e),t=parseInt(t),i=parseInt(i);var r,a,n,o,s,l,d=new Array(3);return(r=F((11*e+3)/30)+354*e+30*t-F((t-1)/2)+i+1948440-385)>2299160?(o=F(4*(a=r+68569)/146097),a-=F((146097*o+3)/4),s=F(4e3*(a+1)/1461001),a=a-F(1461*s/4)+31,n=F(80*a/2447),i=a-F(2447*n/80),t=n+2-12*(a=F(n/11)),e=100*(o-49)+s+a):(l=F(((n=r+1402)-1)/1461),o=F(((a=n-1461*l)-1)/365)-F(a/1461),n=F(80*(s=a-365*o+30)/2447),i=s-F(2447*n/80),t=n+2-12*(s=F(n/11)),e=4*l+o+s-4716),d[2]=i,d[1]=t,d[0]=e,d}(e,+t+1,i);return new Date(s[0],s[1]-1,s[2],r||0,a||0,n||0,o||0)},getMaxDayOfMonth:function(e,t){return[30,29,30,29,30,29,30,29,30,29,30,29][t]+(11===t&&(11*e+14)%30<11?1:0)}},A.customTheme("mobiscroll-dark","mobiscroll"),A.customTheme("bizagitheme","mobiscroll");var We=A.themes,Ye="mobiscroll";return"android"==$?Ye="material":"ios"==$?Ye="ios":"wp"==$&&(Ye="windows"),ee.each(We.frame,(function(e,t){return Ye&&t.baseTheme==Ye&&"mobiscroll-dark"!=e&&"material-dark"!=e&&"windows-dark"!=e&&"ios-dark"!=e?(A.autoTheme=e,!1):void(e==Ye&&(A.autoTheme=e))})),A}(e.jQuery)}(this),function(e){var t={rtl:!1,setText:"Set",cancelText:"Cancel",clearText:"Clear",selectedText:"{count} selected",selectedPluralText:"{count} selected",dateFormat:"dd/mm/yy",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["S","M","T","W","T","F","S"],dayText:"Day",hourText:"Hours",minuteText:"Minutes",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthText:"Month",secText:"Seconds",amText:"am",pmText:"pm",timeFormat:"hh:ii A",yearText:"Year",nowText:"Now",firstDay:0,dateText:"Date",timeText:"Time",calendarText:"Calendar",closeText:"Close",todayText:"Today",prevMonthText:"Previous Month",nextMonthText:"Next Month",prevYearText:"Previous Year",nextYearText:"Next Year",eventText:"event",eventsText:"events",fromText:"Start",toText:"End",wholeText:"Whole",fractionText:"Fraction",unitText:"Unit",delimiter:"/",decimalSeparator:".",thousandsSeparator:",",labels:["Years","Months","Days","Hours","Minutes","Seconds",""],labelsShort:["Yrs","Mths","Days","Hrs","Mins","Secs",""],startText:"Start",stopText:"Stop",resetText:"Reset",lapText:"Lap",hideText:"Hide",offText:"Off",onText:"On",backText:"Back",undoText:"Undo"};function i(){if("undefined"!=typeof bizagi&&void 0!==bizagi.localization&&void 0!==bizagi.localization.language&&void 0!==bizagi.util&&void 0!==bizagi.util.languages){var e="undefined"!=typeof BIZAGI_LANGUAGE?BIZAGI_LANGUAGE:"en",i=bizagi.util.languages[e]||bizagi.localization.language;if(!mobiscroll.i18n[i]){var r=i.toLowerCase().replace(/([^a-z]+)/g,"-").split("-").shift();mobiscroll.i18n[r]?mobiscroll.i18n[i]=mobiscroll.i18n[r]:mobiscroll.i18n[i]=t}var a=mobiscroll.i18n[i],n=bizagi.localization.getResource("datePickerRegional"),o=n.firstDay?parseInt(n.firstDay):a.firstDay;a.closeText=n.closeText||a.closeText,a.clearText=bizagi.localization.getResource("render-search-clear-label",a.clearText),a.nowText=bizagi.localization.getResource("render-timeentry-now",a.nowText),a.todayText=n.currentText||a.todayText,a.dateFormat=n.dateFormat||a.dateFormat,a.dayNames=n.dayNames||a.dayNames,a.dayNamesMin=n.dayNamesMin||a.dayNamesMin,a.dayNamesShort=n.dayNamesShort||a.dayNamesShort,a.firstDay=o,a.rtl=void 0!==n.isRTL?n.isRTL:a.rtl,a.monthNames=n.monthNames||a.monthNames,a.monthNamesShort=n.monthNamesShort||a.monthNamesShort,a.nextMonthText=n.nextText||a.nextMonthText,a.nextYearText=n.nextText||a.nextYearText,a.prevMonthText=n.prevText||a.prevMonthText,a.prevYearText=n.prevText||a.prevYearText,a.yearSuffix=n.yearSuffix=n.yearSuffix||""}}mobiscroll.i18n.de={setText:"OK",cancelText:"Abbrechen",clearText:"Löschen",selectedText:"{count} ausgewählt",dateFormat:"dd.mm.yy",dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["S","M","D","M","D","F","S"],dayText:"Tag",delimiter:".",hourText:"Stunde",minuteText:"Minuten",monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],monthText:"Monat",secText:"Sekunden",timeFormat:"HH:ii",yearText:"Jahr",nowText:"Jetzt",pmText:"pm",amText:"am",todayText:"Heute",firstDay:1,dateText:"Datum",timeText:"Zeit",closeText:"Schließen",allDayText:"Ganztägig",noEventsText:"Keine Ereignisse",eventText:"Ereignis",eventsText:"Ereignisse",moreEventsText:"{count} weiteres Element",moreEventsPluralText:"{count} weitere Elemente",fromText:"Von",toText:"Bis",wholeText:"Ganze Zahl",fractionText:"Bruchzahl",unitText:"Maßeinheit",labels:["Jahre","Monate","Tage","Stunden","Minuten","Sekunden",""],labelsShort:["Jahr.","Mon.","Tag.","Std.","Min.","Sek.",""],startText:"Starten",stopText:"Stoppen",resetText:"Zurücksetzen",lapText:"Lap",hideText:"Ausblenden",backText:"Zurück",undoText:"Rückgängig machen",offText:"Aus",onText:"Ein",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.es={setText:"Aceptar",cancelText:"Cancelar",clearText:"Borrar",selectedText:"{count} seleccionado",selectedPluralText:"{count} seleccionados",dateFormat:"dd/mm/yy",dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],dayNamesMin:["D","L","M","M","J","V","S"],dayText:"Día",hourText:"Horas",minuteText:"Minutos",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],monthText:"Mes",secText:"Segundos",timeFormat:"HH:ii",yearText:"A&ntilde;o",nowText:"Ahora",pmText:"pm",amText:"am",todayText:"Hoy",firstDay:1,dateText:"Fecha",timeText:"Tiempo",closeText:"Cerrar",allDayText:"Todo el día",noEventsText:"No hay eventos",eventText:"Evento",eventsText:"Eventos",moreEventsText:"{count} más",fromText:"Iniciar",toText:"Final",wholeText:"Entero",fractionText:"Fracción",unitText:"Unidad",labels:["Años","Meses","Días","Horas","Minutos","Segundos",""],labelsShort:["Año","Mes","Día","Hora","Min","Seg",""],startText:"Iniciar",stopText:"Deténgase",resetText:"Reinicializar",lapText:"Lap",hideText:"Esconder",backText:"Atrás",undoText:"Deshacer",offText:"No",onText:"Sí",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.fr={setText:"Terminer",cancelText:"Annuler",clearText:"Effacer",selectedText:"{count} sélectionné",selectedPluralText:"{count} sélectionnés",dateFormat:"dd/mm/yy",dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],dayNamesMin:["D","L","M","M","J","V","S"],dayText:"Jour",monthText:"Mois",monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Janv.","Févr.","Mars","Avril","Mai","Juin","Juil.","Août","Sept.","Oct.","Nov.","Déc."],hourText:"Heures",minuteText:"Minutes",secText:"Secondes",timeFormat:"HH:ii",yearText:"Année",nowText:"Maintenant",pmText:"pm",amText:"am",todayText:"Aujourd'hui",firstDay:1,dateText:"Date",timeText:"Heure",closeText:"Fermer",allDayText:"Toute la journée",noEventsText:"Aucun événement",eventText:"Événement",eventsText:"Événements",moreEventsText:"{count} autre",moreEventsPluralText:"{count} autres",fromText:"Démarrer",toText:"Fin",wholeText:"Entier",fractionText:"Fraction",unitText:"Unité",labels:["Ans","Mois","Jours","Heures","Minutes","Secondes",""],labelsShort:["Ans","Mois","Jours","Hrs","Min","Sec",""],startText:"Démarrer",stopText:"Arrêter",resetText:"Réinitialiser",lapText:"Lap",hideText:"Cachez",backText:"Retour",undoText:"Annuler",offText:"Non",onText:"Oui",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.it={setText:"OK",cancelText:"Annulla",clearText:"Chiarire",selectedText:"{count} selezionato",selectedPluralText:"{count} selezionati",dateFormat:"dd/mm/yy",dayNames:["Domenica","Lunedì","Mertedì","Mercoledì","Giovedì","Venerdì","Sabato"],dayNamesShort:["Do","Lu","Ma","Me","Gi","Ve","Sa"],dayNamesMin:["D","L","M","M","G","V","S"],dayText:"Giorno",hourText:"Ore",minuteText:"Minuti",monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],monthText:"Mese",secText:"Secondi",timeFormat:"HH:ii",yearText:"Anno",nowText:"Ora",pmText:"pm",amText:"am",todayText:"Oggi",firstDay:1,dateText:"Data",timeText:"Volta",closeText:"Chiudere",allDayText:"Tutto il giorno",noEventsText:"Nessun evento",eventText:"Evento",eventsText:"Eventi",moreEventsText:"{count} altro",moreEventsPluralText:"altri {count}",fromText:"Inizio",toText:"Fine",wholeText:"Intero",fractionText:"Frazione",unitText:"Unità",labels:["Anni","Mesi","Giorni","Ore","Minuti","Secondi",""],labelsShort:["Anni","Mesi","Gio","Ore","Min","Sec",""],startText:"Inizio",stopText:"Arresto",resetText:"Ripristina",lapText:"Lap",hideText:"Nascondi",backText:"Indietro",undoText:"Annulla",offText:"Via",onText:"Su",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.zh={setText:"确定",cancelText:"取消",clearText:"明确",selectedText:"{count} 选",dateFormat:"yy年mm月d日",dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["日","一","二","三","四","五","六"],dayNamesMin:["日","一","二","三","四","五","六"],dayText:"日",hourText:"时",minuteText:"分",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["一","二","三","四","五","六","七","八","九","十","十一","十二"],monthText:"月",secText:"秒",timeFormat:"HH:ii",yearText:"年",nowText:"当前",pmText:"下午",amText:"上午",yearSuffix:"年",monthSuffix:"月",daySuffix:"日",todayText:"今天",dateText:"日",timeText:"时间",closeText:"关闭",allDayText:"全天",noEventsText:"无事件",eventText:"活动",eventsText:"活动",moreEventsText:"他 {count} 件",fromText:"开始时间",toText:"结束时间",wholeText:"合计",fractionText:"分数",unitText:"单位",labels:["年","月","日","小时","分钟","秒",""],labelsShort:["年","月","日","点","分","秒",""],startText:"开始",stopText:"停止",resetText:"重置",lapText:"圈",hideText:"隐藏",backText:"返回",undoText:"复原",offText:"关闭",onText:"开启",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.nl={setText:"Instellen",cancelText:"Annuleren",clearText:"Leegmaken",selectedText:"{count} gekozen",dateFormat:"dd-mm-yy",dayNames:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],dayNamesShort:["zo","ma","di","wo","do","vr","za"],dayNamesMin:["z","m","d","w","d","v","z"],dayText:"Dag",hourText:"Uur",minuteText:"Minuten",monthNames:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthNamesShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],monthText:"Maand",secText:"Seconden",timeFormat:"HH:ii",yearText:"Jaar",nowText:"Nu",pmText:"pm",amText:"am",todayText:"Vandaag",firstDay:1,dateText:"Datum",timeText:"Tijd",closeText:"Sluiten",allDayText:"Hele dag",noEventsText:"Geen activiteiten",eventText:"Activiteit",eventsText:"Activiteiten",moreEventsText:"nog {count}",fromText:"Start",toText:"Einde",wholeText:"geheel",fractionText:"fractie",unitText:"eenheid",labels:["Jaren","Maanden","Dagen","Uren","Minuten","Seconden",""],labelsShort:["j","m","d","u","min","sec",""],startText:"Start",stopText:"Stop",resetText:"Reset",lapText:"Ronde",hideText:"Verbergen",backText:"Terug",undoText:"Onged. maken",offText:"Uit",onText:"Aan",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.ja={setText:"セット",cancelText:"キャンセル",clearText:"クリア",selectedText:"{count} 選択",dateFormat:"yy年mm月dd日",dayNames:["日","月","火","水","木","金","土"],dayNamesShort:["日","月","火","水","木","金","土"],dayNamesMin:["日","月","火","水","木","金","土"],dayText:"日",hourText:"時",minuteText:"分",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthText:"月",secText:"秒",timeFormat:"HH:ii",yearText:"年",nowText:"今",pmText:"午後",amText:"午前",yearSuffix:"年",monthSuffix:"月",daySuffix:"日",todayText:"今日",dateText:"日付",timeText:"時間",closeText:"クローズ",allDayText:"終日",noEventsText:"イベントはありません",eventText:"イベント",eventsText:"イベント",moreEventsText:"他 {count} 件",fromText:"開始",toText:"終わり",wholeText:"全数",fractionText:"分数",unitText:"単位",labels:["年間","月間","日間","時間","分","秒",""],labelsShort:["年間","月間","日間","時間","分","秒",""],startText:"開始",stopText:"停止",resetText:"リセット",lapText:"ラップ",hideText:"隠す",backText:"バック",undoText:"アンドゥ"},mobiscroll.i18n.pt=mobiscroll.i18n["pt-PT"]={setText:"Seleccionar",cancelText:"Cancelar",clearText:"Claro",selectedText:"{count} selecionado",selectedPluralText:"{count} selecionados",dateFormat:"dd-mm-yy",dayNames:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayNamesMin:["D","S","T","Q","Q","S","S"],dayText:"Dia",hourText:"Horas",minuteText:"Minutos",monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],monthText:"Mês",secText:"Segundo",timeFormat:"HH:ii",yearText:"Ano",nowText:"Actualizar",pmText:"pm",amText:"am",todayText:"Hoy",firstDay:1,dateText:"Data",timeText:"Tempo",closeText:"Fechar",allDayText:"Todo o dia",noEventsText:"Nenhum evento",eventText:"Evento",eventsText:"Eventos",moreEventsText:"mais {count}",fromText:"Início",toText:"Fim",wholeText:"Inteiro",fractionText:"Fracção",unitText:"Unidade",labels:["Anos","Meses","Dias","Horas","Minutos","Segundos",""],labelsShort:["Ano","Mês","Dia","Hora","Min","Seg",""],startText:"Começar",stopText:"Parar",resetText:"Reinicializar",lapText:"Lap",hideText:"Esconder",backText:"Anterior",undoText:"Anular",offText:"Desl",onText:"Lig",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n["pt-BR"]={setText:"Selecionar",cancelText:"Cancelar",clearText:"Claro",selectedText:"{count} selecionado",selectedPluralText:"{count} selecionados",dateFormat:"dd/mm/yy",dayNames:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayNamesMin:["D","S","T","Q","Q","S","S"],dayText:"Dia",hourText:"Hora",minuteText:"Minutos",monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],monthText:"Mês",secText:"Segundo",timeFormat:"HH:ii",yearText:"Ano",nowText:"Agora",pmText:"pm",amText:"am",todayText:"Hoje",dateText:"Data",timeText:"Tempo",closeText:"Fechar",allDayText:"Dia inteiro",noEventsText:"Nenhum evento",eventText:"Evento",eventsText:"Eventos",moreEventsText:"Mais {count}",fromText:"In&iacute;cio",toText:"Fim",wholeText:"Inteiro",fractionText:"Fração",unitText:"Unidade",labels:["Anos","Meses","Dias","Horas","Minutos","Segundos",""],labelsShort:["Ano","M&ecirc;s","Dia","Hora","Min","Seg",""],startText:"Começar",stopText:"Pare",resetText:"Reinicializar",lapText:"Lap",hideText:"Esconder",backText:"Anterior",undoText:"Desfazer",offText:"Desl",onText:"Lig",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.cs={setText:"Zadej",cancelText:"Storno",clearText:"Vymazat",selectedText:"Označený: {count}",dateFormat:"dd.mm.yy",dayNames:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"],dayNamesShort:["Ne","Po","Út","St","Čt","Pá","So"],dayNamesMin:["N","P","Ú","S","Č","P","S"],dayText:"Den",hourText:"Hodiny",minuteText:"Minuty",monthNames:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],monthNamesShort:["Led","Úno","Bře","Dub","Kvě","Čer","Čvc","Spr","Zář","Říj","Lis","Pro"],monthText:"Měsíc",secText:"Sekundy",timeFormat:"HH:ii",yearText:"Rok",nowText:"Teď",amText:"am",pmText:"pm",todayText:"Dnes",firstDay:1,dateText:"Datum",timeText:"Čas",closeText:"Zavřít",allDayText:"Celý den",noEventsText:"Žádné události",eventText:"Událostí",eventsText:"Události",moreEventsText:"{count} další",fromText:"Začátek",toText:"Konec",wholeText:"Celý",fractionText:"Část",unitText:"Jednotka",labels:["Roky","Měsíce","Dny","Hodiny","Minuty","Sekundy",""],labelsShort:["Rok","Měs","Dny","Hod","Min","Sec",""],startText:"Start",stopText:"Stop",resetText:"Resetovat",lapText:"Etapa",hideText:"Schovat",backText:"Zpět",undoText:"Zpět",offText:"O",onText:"I",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.ru=mobiscroll.i18n["ru-RU"]={setText:"Установить",cancelText:"Отмена",clearText:"Очистить",selectedText:"{count} Выбрать",dateFormat:"dd.mm.yy",dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вс","пн","вт","ср","чт","пт","сб"],dayNamesMin:["в","п","в","с","ч","п","с"],dayText:"День",delimiter:".",hourText:"Час",minuteText:"Минут",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],monthText:"Месяц",secText:"Секунд",timeFormat:"HH:ii",yearText:"Год",nowText:"Сейчас",amText:"am",pmText:"pm",todayText:"Cегодня",firstDay:1,dateText:"Дата",timeText:"Время",closeText:"Закрыть",allDayText:"Весь день",noEventsText:"Нет событий",eventText:"Мероприятия",eventsText:"Мероприятия",moreEventsText:"Ещё {count}",fromText:"Начало",toText:"Конец",wholeText:"Целое",fractionText:"Дробное",unitText:"Единица",labels:["Лет","Месяцев","Дней","Часов","Минут","Секунд",""],labelsShort:["Лет","Мес","Дн","Час","Мин","Сек",""],startText:"Старт",stopText:"Стоп",resetText:"Сбросить",lapText:"Круг",hideText:"Скрыть",backText:"назад",undoText:"ОтменитЬ",offText:"O",onText:"I",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.ar={rtl:!0,setText:"تعيين",cancelText:"إلغاء",clearText:"مسح",selectedText:"{count} المحدد",dateFormat:"dd/mm/yy",dayNames:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],dayNamesShort:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],dayNamesMin:["ح","ن","ث","ر","خ","ج","س"],dayText:"يوم",hourText:"ساعات",minuteText:"الدقائق",monthNames:["كانون الثاني","شهر فبراير","مارس","أبريل","قد","يونيو","يوليو","أغسطس","سبتمبر","شهر اكتوبر","شهر نوفمبر","ديسمبر"],monthNamesShort:["كانون الثاني","شهر فبراير","مارس","أبريل","قد","يونيو","يوليو","أغسطس","سبتمبر","شهر اكتوبر","شهر نوفمبر","ديسمبر"],monthText:"شهر",secText:"ثواني",amText:"ص",pmText:"م",timeFormat:"hh:ii A",yearText:"عام",nowText:"الآن",firstDay:0,dateText:"تاريخ",timeText:"وقت",closeText:"إغلاق",todayText:"اليوم",prevMonthText:"الشهر السابق",nextMonthText:"الشهر القادم",prevYearText:"السنه السابقة",nextYearText:"العام القادم",allDayText:"اليوم كله",noEventsText:"لا توجد احداث",eventText:"الحدث",eventsText:"أحداث",moreEventsText:"واحد آخر",moreEventsPluralText:"اثنان آخران {count}",fromText:"يبدا",toText:"ينتهي",wholeText:"كامل",fractionText:"جزء",unitText:"وحدة",delimiter:"/",decimalSeparator:".",thousandsSeparator:",",labels:["سنوات","أشهر","أيام","ساعة","دقائق","ثواني",""],labelsShort:["سنوات","أشهر","أيام","ساعة","دقائق","ثواني",""],startText:"بدء",stopText:"إيقاف",resetText:"إعادة ضبط",lapText:"الدورة",hideText:"إخفاء",offText:"إيقاف",onText:"تشغيل",backText:"رجوع",undoText:"تراجع"},mobiscroll.i18n.ko={setText:"설정",cancelText:"취소",clearText:"삭제",selectedText:"{count} 선택된",dateFormat:"yy년mm월dd일",dayNames:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],dayNamesShort:["일","월","화","수","목","금","토"],dayNamesMin:["일","월","화","수","목","금","토"],dayText:"일",delimiter:"-",hourText:"시간",minuteText:"분",monthNames:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthNamesShort:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],monthText:"달",secText:"초",timeFormat:"H:ii",yearText:"년",nowText:"지금",pmText:"오후",amText:"오전",yearSuffix:"년",monthSuffix:"월",daySuffix:"일",firstDay:0,dateText:"날짜",timeText:"시간",todayText:"오늘",prevMonthText:"이전 달",nextMonthText:"다음 달",prevYearText:"이전 년",nextYearText:"다음 년",closeText:"닫기",eventText:"이벤트",eventsText:"이벤트",allDayText:"종일",noEventsText:"이벤트 없음",moreEventsText:"{count}개 더보기",fromText:"시작",toText:"종료",wholeText:"정수",fractionText:"분수",unitText:"단위",labels:["년","달","일","시간","분","초",""],labelsShort:["년","달","일","시간","분","초",""],startText:"시작",stopText:"중지 ",resetText:"초기화",lapText:"기록",hideText:"숨는 장소",backText:"뒤로",undoText:"실행취소",offText:"끔",onText:"켬",decimalSeparator:",",thousandsSeparator:" "},mobiscroll.i18n.ua={setText:"встановити",cancelText:"відміна",clearText:"очистити",selectedText:"{count} вибрані",dateFormat:"dd.mm.yy",dayNames:["неділя","понеділок","вівторок","середа","четвер","п’ятниця","субота"],dayNamesShort:["нед","пнд","вів","срд","чтв","птн","сбт"],dayNamesMin:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],dayText:"День",delimiter:".",hourText:"година",minuteText:"хвилина",monthNames:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],monthNamesShort:["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],monthText:"Місяць",secText:"Секунд",timeFormat:"H:ii",yearText:"Рік",nowText:"Зараз",pmText:"pm",amText:"am",firstDay:1,dateText:"дата",timeText:"Час",todayText:"Сьогодні",prevMonthText:"Попередній місяць",nextMonthText:"Наступного місяця",prevYearText:"Попередній рік",nextYearText:"Наступного року",closeText:"Закрити",eventText:"подія",eventsText:"події",allDayText:"Увесь день",noEventsText:"Жодної події",moreEventsText:"та ще {count}",fromText:"від",toText:"кінець",wholeText:"всі",fractionText:"фракція",unitText:"одиниця",labels:["Рік","Місяць","День","година","хвилина","Секунд",""],labelsShort:["Рік","Місяць","День","година","хвилина","Секунд",""],startText:"Початок",stopText:"СТОП",resetText:"скинути",lapText:"коло",hideText:"сховати",backText:"назад",undoText:"відмінити",offText:"Вимикати",onText:"Увімкнути",decimalSeparator:",",thousandsSeparator:" "},i(),bizagi.localization&&bizagi.localization.observableElement&&bizagi.localization.observableElement.bind("setLanguage",(function(){i()}))}(jQuery),$.Class.extend("bizagi.rendering.element",{ELEMENT_TYPE_CONTAINER:1,ELEMENT_TYPE_RENDER:2,ELEMENT_TYPE_COLUMN:3},{init:function(e){this.renderFactory=e.renderFactory,this.dataService=e.dataService,this.parent=e.parent,this.resources=bizagi.localization,this.observableElement=$("<div />"),this.disposed=!1,this.initializeData(e.data),this.subscribers=[]},initializeData:function(e){this.properties={},e&&e.properties&&(this.properties=e.properties),this.properties.xpathContext=this.getXpathContext(),this.properties.idPageCache=this.getPageCache(),this.visualChanges=this.visualChanges||{}},getXpathContext:function(){return null!=this.parent&&"function"==typeof this.parent.getXpathContext?this.parent.getXpathContext():""},getXpath:function(){return this.properties.xpath},getPageCache:function(){return null!=this.parent&&"function"==typeof this.parent.getPageCache?this.parent.getPageCache():""},getFormContainer:function(){if(void 0!==this.parent)return this.parent.getFormContainer()},getResource:function(e){return this.resources.getResource(e)},getElementType:function(){},resize:function(e){},focus:function(){if(this.properties.required){var e=$("#ui-bizagi-wp-app-render-form-content");bizagi.util.isScrolledIntoView(this.element,e)||$(this.element).attr("tabindex",-1).focus(),this.element&&this.element.effect("highlight",2e3)}this.parent&&"function"==typeof this.parent.focus&&this.parent.focus()},triggerGlobalHandler:function(e,t){return this.disposed?null:this.parent?this.parent.triggerGlobalHandler(e,t):null},trigger:function(e,t){return this.disposed?null:this.observableElement?this.observableElement.trigger(e,t):null},triggerHandler:function(e,t){return this.disposed?null:this.observableElement?this.observableElement.triggerHandler(e,t):null},bind:function(e,t){return this.disposed?null:this.observableElement?this.observableElement.bind(e,t):(this.subscribers.push({event:e}),null)},unbind:function(e,t){return this.disposed?null:this.observableElement?this.observableElement.unbind(e,t):null},one:function(e,t){return this.disposed?null:this.observableElement?this.observableElement.one(e,t):(this.subscribers.push({event:e}),null)},getRenderedElement:function(){},getMode:function(){if(this.parent)return this.parent.getMode()},getParams:function(){if(this.parent)return this.parent.getParams()},getFormType:function(){return this.getFormContainer().properties.type||"form"},ready:function(){},isReadyToSave:function(){},getCustomHandlers:function(){return null},dispose:function(){var e=this;e.disposed=!0;var t=setTimeout((function(){null!=e.subscribers&&$.each(e.subscribers,(function(t,i){e.unbind(i.event)})),delete e.subscribers,e.observableElement&&e.observableElement.off(),bizagi.util.dispose(e),clearTimeout(t)}),bizagi.override.disposeTime||50)},isDisposed:function(){return this.disposed},processFailMessage:function(e){var t=this.getFormContainer(),i=bizagi.util.isOfflineForm({context:this});if("CustomMessageException"===e.errorType){t.validationController.clearValidationMessages();var r=bizagi.localization.getResource(e.message);t.validationController.showErrorMessage(r)}else if("InvalidCaseStateException"===e.errorType){var a=t.getParams();t.validationController.clearValidationMessages(),t.container.trigger("routing",{idCase:a.idCase||bizagi.context.idCase})}else{var n=(e="string"==typeof(e=e||{})?JSON.parse(e):e).type||"error",o=e.code||"code";if(e=e.responseText||e.message||e,"not-processed"===n)return;if("not-shown"===n)return;if(i&&"AUTH_ERROR"===o)return;t.validationController.clearValidationMessages(),"alert"==n?t.validationController.showAlertMessage(e):t.validationController.showErrorMessage(e)}return e},startLoading:function(){},endLoading:function(){},beforeToRefresh:function(){},afterToRefresh:function(){bizagi.override&&!0===bizagi.override.enableExecuteRefreshAction&&this.getFormContainer().tryToExecuteFunction(this.properties.xpath||this.properties.id)},getResourceByKey:function(e,t){return t=t||e,bizagi.localization.getResource(e,t)},restoreAppearance:function(){for(var e in this.visualChanges)switch(e){case"color":this.changeColor(this.visualChanges[e]);break;case"backgroundColor":this.changeBackgroundColor(this.visualChanges[e]);break;case"required":this.changeRequired(this.visualChanges[e]);break;case"editability":this.changeEditability(this.visualChanges[e]);break;case"visibility":this.changeVisibility(this.visualChanges[e]);break;case"minValue":this.changeMinValue(this.visualChanges[e]);break;case"maxValue":this.changeMaxValue(this.visualChanges[e])}},getOrientation:function(){for(var e=this;e;){if(properties=e.properties||{},"auto"!==properties.orientation)return properties.orientation;e=e.parent}return"auto"}}),bizagi.rendering.element.extend("bizagi.rendering.container",{TYPE_QUERY_FORM:"queryForm"},{initializeData:function(e){var t=this;t._super(e);var i=t.properties;i.uniqueId=Math.ceil(1e6*Math.random()),i.editable=void 0===i.editable||bizagi.util.parseBoolean(i.editable),i.visible=void 0===i.visible||bizagi.util.parseBoolean(i.visible),i.orientation=i.orientation||"auto",this.originalProperties=JSON.parse(JSON.encode(i)),this.children=[],this.childrenHash={},e.elements&&$.each(e.elements,(function(e,i){i.render?t.createRenderElement(i):i.container?t.createContainerElement(i):i.form&&t.createFormElement(i)}))},createRenderElement:function(e){var t,i=this.properties;0==i.editable&&(e.render.properties.editable=i.editable),!1===i.required&&(e.render.properties.required=i.required),"duplicate"==e.render.properties.retype&&(t=bizagi.clone(e));var r=this.renderFactory.getRender({type:e.render.properties.type,data:e.render,dataService:this.dataService,parent:this,mode:this.getMode()});this.children.push(r),"duplicate"==e.render.properties.retype&&this.processDuplicateRender(r,t),this.getFormContainer().registerRender(r)},createContainerElement:function(e){var t=this.properties;0==t.editable&&(e.container.properties.editable=t.editable),!1===t.required&&(e.container.properties.required=t.required);var i=this.renderFactory.getContainer({type:e.container.properties.type,data:e.container,parent:this,dataService:this.dataService,mode:this.getMode(),isDesign:"design"===this.getMode()});this.children.push(i),this.getFormContainer().registerRender(i)},createFormElement:function(e){var t=this.properties;0==t.editable&&(e.container.properties.editable=t.editable);var i=this.renderFactory.getContainer({type:e.form.properties.type||"form",data:e.form,parent:this,dataService:this.dataService,mode:this.getMode()});this.children.push(i)},getElement:function(){return this.container},getElementsByType:function(e,t){t=t||[];return $.each(this.children,(function(i,r){r.properties.type==e&&t.push(r),r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&r.getElementsByType(e,t)})),t},processDuplicateRender:function(e,t){var i=JSON.parse(JSON.encode(t.render));i.properties.displayName=i.properties.displayName+" "+this.getResource("render-text-duplicate-label-sufix"),i.properties.xpath=i.properties.xpath+".clone",i.properties.isClone=!0;var r=this.renderFactory.getRender({type:i.properties.type,data:i,parent:this,mode:this.getMode()});e.cloneRender=r,this.children.push(r)},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER},render:function(){var e;this.getMode();return e=this.internalRender(),this.applyContainerDefaults(),e.attr("data-container-id",this.properties.id),this.properties.tag&&e.attr("data-tag",this.properties.tag),this.params&&this.params.requestedForm&&e.addClass(this.params.requestedForm),e},internalRender:function(){var e=this.renderContainerHtml(),t=this.container=$(e);return this.postRenderContainer(t),this.container},renderContainerHtml:function(){return this.renderingDeferred=this.renderingDeferred||new $.Deferred,this.renderContainer()},isRendered:function(){return!!this.renderingDeferred&&this.renderingDeferred.promise()},getRenderedElement:function(){return bizagi.util.isEmpty(this.container)&&alert("container hasn't been rendered!"),this.container},applyContainerDefaults:function(){var e=this.properties;e.backgroundColor&&this.changeBackgroundColor(e.backgroundColor),e.visible||this.changeVisibility(e.visible)},changeBackgroundColor:function(e){this.properties.backgroundColor=e,$.each(this.children,(function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.changeBackgroundColor(e):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.changeBackgroundColor(e)}))},changeVisibility:function(e){var t=this.properties;t.visible=bizagi.util.parseBoolean(e),t.visible?this.container.show():this.container.hide()},changeEditability:function(e){this.properties.editable="Default"==e?this.originalProperties.editable:bizagi.util.parseBoolean(e),$.each(this.children,(function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?$.when(i.ready()).done((function(){i.changeEditability(e)})):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.changeEditability(e)}))},replaceTag:function(e,t,i){bizagi.util.replaceSelector(e,t,i)},replaceChildrenTag:function(e,t){this.replaceTag(e,".children",t)},replaceChildrenHtml:function(e,t){return e.replaceFirstWithoutPatterns("{{children}}",t)},renderContainer:function(){},postRenderContainer:function(e){var t=this.getMode();this.renderingDeferred&&this.renderingDeferred.resolve(),this.container=e,this.executeChildrenPostRender(e),"execution"==t&&(this.configureHandlers(),this.applyPlaceHolderPolyfill()),"design"==t&&this.configureDesignView(),"layout"==t&&(this.configureDesignView(),this.configureLayoutView())},applyPlaceHolderPolyfill:function(){var e=window.placeHolderConfig||{};("placeholder"in $("<input>")[0]||"placeHolder"in $("<input>")[0])&&!e.forceApply||Placeholders.enable()},executeChildrenPostRender:function(e){var t=this,i=e.children();$.each(i,(function(e,i){i=$(i);var r=Number(i.data("unique-id"));if(r){var a=t.childrenHash[r];if(a){var n=a.getElementType();n==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&a.postRenderElement(i),n==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&a.postRenderContainer(i)}}else t.executeChildrenPostRender(i)}))},configureHandlers:function(){},configureDesignView:function(){},configureLayoutView:function(){},renderChildrenHtml:function(){var e=this,t="";return $.each(e.children,(function(i,r){var a=r.getElementType();a==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(t+=r.renderElement()),a==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(t+=r.renderContainerHtml()),e.childrenHash[r.properties.uniqueId]=r})),t},collectRenderValues:function(e){this.children&&$.each(this.children,(function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.collectRenderValues(e):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.canBeSent()&&i.collectData(e)}))},hasChanged:function(e){if((e=e||[]).length)return e;this.children&&$.each(this.children,(function(t,i){if(e.length||i.hasChanged(e))return!1}))},collectRenderValuesQueryForm:function(e){$.each(this.children,(function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.collectRenderValuesQueryForm(e):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.canBeSentQueryForm()&&i.collectDataQueryForm(e)}))},firstChild:function(){return this.children[0]},getRenders:function(e,t){return t=t||[],e.indexOf("[")>0&&(e=e.substring(0,e.indexOf("["))),$.each(this.children,(function(i,r){r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?r.getRenders(e,t):r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&e==r.properties.xpath&&t.push(r)})),t},getRender:function(e){var t=this.getRenders(e),i=null;return $.each(t,(function(e,t){t.properties.editable&&null==i&&(i=t)})),null==i&&$.each(t,(function(e,t){i=t})),i},getRendersByXpath:function(e){return this.getRenders(e)},getContainer:function(e){var t;return this.properties.id==e?this:($.each(this.children,(function(i,r){if(r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER){var a=r.getContainer(e);if(null!=a)return t=a,!1}})),t)},isValid:function(e){return this.children&&$.each(this.children,(function(t,i){i.properties.visible&&(i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.isValid(e):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.isValid(e))})),0==e.length},hasValidGrids:function(e){return $.each(this.children,(function(t,i){i.properties.visible&&(i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.hasValidGrids(e):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&void 0!==i.grid&&i.isValid(e))})),0==e.length},ready:function(){return $.when(this.parent.ready(),this.isRendered())},isReadyToSave:function(){var e=$.map(this.children,(function(e){return e.isReadyToSave()}));return $.when.apply($,e)},getFocus:function(){var e;return $.each(this.children,(function(t,i){if(i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER){var r=i.getFocus();bizagi.util.isEmpty(r)||(e=r)}})),e},getCustomHandlers:function(){var e=this.getFormContainer();if(e)return e.getCustomHandlers()},getCustomHandler:function(e){var t=this.getCustomHandlers();if(t)return t[e]},dispose:function(){var e=this,t=setTimeout((function(){e.children&&$.each(e.children,(function(e,t){t.dispose()})),clearTimeout(t)}),bizagi.override.disposeTime||50);e._super()},refreshContainer:function(e){var t=this,i=t.properties,r=t.getFormContainer();return t.startLoading(),t.beforeToRefresh(),$.when(t.dataService.multiaction().refreshControl({xpath:i.xpath,idRender:i.id,idPageCache:i.idPageCache,xpathContext:i.xpathContext||e.xpathContext,contexttype:t.properties.contexttype||"",idForm:r&&r.properties&&r.properties.id?r.properties.id:""})).done((function(e){if(!t.isDisposed()){bizagi.override.restoreAppearanceAfterRefresh&&t.saveChildrenVisualChanges(t),t.unregisterChildren(),delete t.children,delete t.childrenHash,t.getFormContainer().removeActions(),!1===t.properties.editable&&e.container&&e.container.properties&&(e.container.properties.editable=!1),t.initializeData(e.container);var i=t.container,r=t.render();"tabItem"==t.properties.type&&$(r).addClass("childrenActive"),i.replaceWith(r);var a=e.container&&e.container.actions?e.container.actions:[];t.getFormContainer().refreshActions(a),t.triggerChildrenActions(),bizagi.override.restoreAppearanceAfterRefresh&&(t.restoreChildrenVisualChanges(t),delete t.childrenVisualChanges,t.restoreAppearance(e.container)),t.afterToRefresh()}})).fail((function(e){e=t.processFailMessage(e)})).always((function(){t.endLoading()}))},refreshDesignContainer:function(e){var t=this.properties;if(this.beforeToRefresh(e),$.extend(e.properties,{editable:t.editable,contexttype:t.contexttype||"",idPageCache:t.idPageCache,idRender:t.id,messageValidation:t.messageValidation,uniqueId:t.uniqueId,visible:t.visible,xpath:t.xpath,mode:"design",xpathContext:t.xpathContext||""}),!this.isDisposed()){this.unregisterChildren(),delete this.children,delete this.childrenHash,!1===this.properties.editable&&e.container&&e.container.properties&&(e.container.properties.editable=!1),this.initializeData(e.container);var i=this.container,r=this.render();"tabItem"==this.properties.type&&$(r).addClass("childrenActive"),i&&i.replaceWith(r),this.afterToRefresh()}},beforeToRefresh:function(){for(var e=0;e<this.children.length;e++)this.children[e].beforeToRefresh()},afterToRefresh:function(){bizagi.override&&!0===bizagi.override.enableExecuteRefreshAction&&this.getFormContainer().tryToExecuteFunction(this.properties.id);for(var e=0;e<this.children.length;e++)this.children[e].afterToRefresh()},triggerChildrenActions:function(){for(var e=this.children,t=0,i=e.length;t<i;t++){var r=e[t],a=r.getElementType();a===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?r.triggerChildrenActions():a===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&r.triggerRenderChange({changed:!1})}},registerActions:function(e){var t=this.getFormContainer();e&&t.actionController.buildActions(e)},unregisterChildren:function(){for(var e=this.getFormContainer(),t=this.children,i=0,r=t.length;i<r;i++){var a=t[i],n=a.getElementType();n===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?a.unregisterChildren():n===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&e.unregisterRender(a)}},replaceChild:function(e){for(var t=this.children,i=0,r=t.length;i<r;i++){if(t[i].properties.uniqueId==e.properties.uniqueId){t.splice(i,1),t.splice(i,0,e);break}}},getChildById:function(e){for(var t=this.children,i=0,r=t.length;i<r;i++){var a=t[i];if(a.properties.id==e)return a}return null},restoreAppearance:function(e){var t=this;t._super(),(e.elements||[]).forEach((function(e){t.restoreElementAppearance(e.container||e.render)}))},restoreElementAppearance:function(e){var t=this.getChildById(e.properties.id);t&&t.restoreAppearance(e)},saveChildrenVisualChanges:function(e){var t=this;t.childrenVisualChanges=t.childrenVisualChanges||{},(e.children||[]).forEach((function(e){var i=e.getElementType();i===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?(t.childrenVisualChanges[e.properties.id]=e.visualChanges,t.saveChildrenVisualChanges(e)):i===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(t.childrenVisualChanges[e.properties.id]=e.visualChanges)}))},restoreChildrenVisualChanges:function(e){var t=this;(e.children||[]).forEach((function(e){var i=e.getElementType(),r=t.childrenVisualChanges&&t.childrenVisualChanges[e.properties.id]||{};i===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?(e.visualChanges=r,t.restoreChildrenVisualChanges(e)):i===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(e.visualChanges=r)}))}}),bizagi.rendering.element.extend("bizagi.rendering.render",{postRenderTimeout:0,maxRendersPerScreen:50,rendersExecuted:0,renderOptimization:!1,TYPE_QUERY_FORM:"queryForm",startOptimization:function(){bizagi.rendering.render.postRenderTimeout=500,bizagi.rendering.render.rendersExecuted=0,bizagi.rendering.render.renderOptimization=!1},stopOptimization:function(){bizagi.rendering.render.postRenderTimeout=0,bizagi.rendering.render.rendersExecuted=0,bizagi.rendering.render.renderOptimization=!1}},{initializeData:function(e){this._super(e);var t=this.getFormContainer(),i=this.properties;i.included=void 0!==i.included&&bizagi.util.parseBoolean(i.included),i.uniqueId=Math.ceil(1e6*Math.random()),i.displayName=i.displayName||"",i.editable=void 0===i.editable||bizagi.util.parseBoolean(i.editable),i.visible=void 0===i.visible||bizagi.util.parseBoolean(i.visible),i.includedInResult=void 0!==i.includedInResult&&bizagi.util.parseBoolean(i.includedInResult);var r=bizagi.util.normalizeType(i.type);(/^hidden$/i.test(r)||/^queryHidden$/i.test(r))&&(i.visible=!1),i.required=void 0!==i.required&&bizagi.util.parseBoolean(i.required),i.submitOnChange=void 0!==i.submitOnChange&&bizagi.util.parseBoolean(i.submitOnChange),i.maxLength=i.maxLength||0,i.helpText=bizagi.util.trim(i.helpText)||"",i.textFormat=i.textFormat||{},i.valueFormat=i.valueFormat||{},i.isHidden=void 0!==i.isHidden&&bizagi.util.parseBoolean(i.isHidden),i.visible=!i.isHidden&&i.visible,i.editabilityEnabled=!1,i.color&&(i.textFormat.color=i.color),i.backgroundColor&&(i.textFormat.backgroundColor=i.backgroundColor),i.required=!!i.editable&&i.required,i.orientation=i.orientation||"auto",i.contexttype=t.params&&t.params.data&&t.params.data.contextType?t.params.data.contextType:"",this.originalProperties={textFormat:{color:i.textFormat.color,backgroundColor:i.textFormat.backgroundColor},valueFormat:{color:i.textFormat.color,backgroundColor:i.textFormat.backgroundColor},visible:i.visible,editable:i.editable,required:i.required,labelAlign:i.labelAlign,valueAlign:i.valueAlign},this.value=void 0!==i.value?i.value:null,this.properties.originalValue=this.value,this.properties.previousValue=this.value,this.calculateInitialLayoutProperties()},calculateInitialLayoutProperties:function(){var e=this.properties;e.displayType=e.displayType||"normal",e.labelAlign=e.labelAlign||this.getDefaultLabelAlign(e.displayType),e.valueAlign=e.valueAlign||this.getDefaultValueAlign(e.displayType),"rtl"===e.orientation&&(e.labelAlign=this.getRTLAlign(e.labelAlign),e.valueAlign=this.getRTLAlign(e.valueAlign));var t=this.calculateRenderWidth(e.labelWidth,e.valueWidth,e.displayType);e.labelWidth=t.label,e.valueWidth=t.control,"percentage"===e.layoutType&&(e.valueWidth=t.control),0==e.labelWidth&&(e.displayType="value",e.valueWidth=t.control),0==e.valueWidth&&(e.displayType="label"),"userfield"===e.type&&(["both","normal","reversed"].includes(e.displayType)?(e.valueWidth=e.valueWidth||50,e.labelWidth=e.labelWidth||50):"vertical"===e.displayType?(e.valueWidth=100,e.labelWidth=100):"label"===e.displayType?(e.valueWidth=0,e.labelWidth=100):(e.valueWidth=100,e.labelWidth=0))},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_RENDER},render:function(e){return this.renderElement(e)},renderElement:function(e){var t=this.properties,i=this.getFormContainer();this.renderingDeferred=new $.Deferred,e=e||"render";var r=this.renderFactory.getTemplate(e),a=t.displayName;"string"==typeof a&&(a=bizagi.util.encodeString(a));var n="desktop"!==bizagi.util.detectDevice()&&("association"===t.type||"uploadecm"===t.type||("actionLauncher"===t.type||"polymorphicLauncher"===t.type)&&bizagi.util.isTabletDevice()||"grid"===t.type&&!bizagi.util.isTabletDevice()),o=parseFloat(t.labelWidth),s=$.fasttmpl(r,{label:a,helpText:t.helpText,editable:t.editable,isExtendedText:"text"==t.type&&t.isExtended,orientation:t.orientation,uniqueId:t.uniqueId,id:t.id,xpath:t.xpath,tag:t.tag,displayType:t.displayType,displayOptionClass:this.getDisplayOptionClass(t.displayType),labelAlignClass:this.getAlignClass(t.labelAlign),valueAlignClass:this.getAlignClass(t.valueAlign),flexAlignClass:bizagi.util.mapAlignClassName(t.columnAlign),labelWidth:o,stringLabelWidth:o+("pixels"==t.layoutType?"px":"%"),valueWidth:parseFloat(t.valueWidth),stringValueWidth:parseFloat(t.valueWidth)+("pixels"==t.layoutType?"px":"%"),layoutType:t.layoutType,isDesign:"design"===this.getMode(),messageValidation:t.messageValidation,printVersion:i.params.printversion,cssClass:t.cssclass||"",includedInResult:t.includedInResult,included:t.included,type:t.type,showFullRender:n,required:t.required}),l=this.internalRenderControl();return l||(l=""),"object"===_typeof(l)&&l.done?"resolved"===l.state()?(s=this.replaceControlHtml(s,this.resolveResult(l)),this.asyncRenderDeferred=null):(this.asyncRenderDeferred=l,s=this.replaceControlHtml(s,"")):s=this.replaceControlHtml(s,l),s},resolveResult:function(e){return bizagi.resolveResult(e)},isRendered:function(){return!!this.renderingDeferred&&this.renderingDeferred.promise()},internalRenderControl:function(){var e=this.properties;return this.control=null,this.renderFactory.printVersion?(e.editable=!1,this.renderControl()):e.editable?this.renderControl():this.renderReadOnly()},postRenderElement:function(e){var t=this,i=t.properties;t.element=e,i.submitOnChange&&t.configureSubmitOnChange(),isLabelFormat=!0;var r=function(e){if(bizagi.rendering.render.renderOptimization&&bizagi.rendering.render.rendersExecuted>bizagi.rendering.render.maxRendersPerScreen)var i=setTimeout((function(){t.internalPostRender(e),bizagi.rendering.render.postRenderTimeout+=50,clearTimeout(i)}),bizagi.rendering.render.postRenderTimeout);else t.internalPostRender(e);bizagi.rendering.render.rendersExecuted++};t.asyncRenderDeferred?$.when(t.asyncRenderDeferred).done((function(i){var a=t.getControl();"function"==typeof t.emptyControlByAsyncRenderDeferred&&t.emptyControlByAsyncRenderDeferred(),a.append(i),r(e),t.processLayout(!isLabelFormat,t.properties.valueFormat||{})})):r(e)},internalPostRender:function(e){var t=this.properties,i=this.getMode();this.control=this.getControl(),this.renderingDeferred&&this.renderingDeferred.resolve(),t.editable?this.renderFactory.printVersion&&this.postRenderPrintVersion?this.postRenderPrintVersion():this.postRender():this.postRenderReadOnly(e),"execution"==i?this.performExecutionModeMethods():this.performDesignModeMethods(),this.processLayout(isLabelFormat,this.properties.textFormat||{}),this.processLayout(!isLabelFormat,this.properties.valueFormat||{})},performExecutionModeMethods:function(){var e=this.properties;this.getFormType()==this.Class.TYPE_QUERY_FORM&&this.configureHandlersQueryForm(),e.editable?this.configureHandlers():this.configureHandlersReadOnly(),this.internalSetInitialValue()},performDesignModeMethods:function(){this.configureDesignView(),this.internalSetInitialValue()},replaceControlHtml:function(e,t){return t=t||"",(e=e||"").replaceFirstWithoutPatterns("{{control}}",t)},getRenderedElement:function(){return bizagi.util.isEmpty(this.element)&&bizagi.log(" render hasn't been rendered!",this,"error"),this.element},internalSetInitialValue:function(){var e=this.properties;this.internalSetInitialValueFlag=!0,e.editable,bizagi.util.isEmpty(this.value)||this.setDisplayValue(this.value),this.internalSetInitialValueFlag=!1},isValid:function(e){var t,i=this.properties,r=this.grid&&this.grid.properties&&this.grid.properties.inlineAdd;if(!1===bizagi.util.parseBoolean(i.visible))return!0;if(!1===bizagi.util.parseBoolean(i.editable)&&!r)return!0;if(this.setValidationMessage(""),bizagi.util.parseBoolean(i.required)){var a=this.getFormContainer(),n=!1,o=this.grid?[this]:a.getRenders(i.xpath),s=/^query/i.test(i.type);if(o.filter((function(e){return e.properties.id==i.id})).forEach((function(e){if(e.hasValue()&&(e.properties.editable||r))return n=!0,!1})),!n&&!this.properties.isClone){t=this.getResource("render-required-text").replaceAll("#label#",i.displayName);var l={xpath:i.xpath,message:t,id:i.id};return s&&(l=$.extend({},l,{id:i.id,isQuery:s})),e.push(l),!1}}if("duplicate"==i.retype){if(this.cloneRender&&this.cloneRender.getValue()!=this.getValue())return t=this.getResource("render-text-retype-error"),e.push({xpath:i.xpath,message:t}),!1}else if("double"==i.retype){var d=$("input",this.element);if(d&&d.data("oldValue")){if(""===d.val())return t=this.getResource("render-text-retype-error"),e.push({xpath:i.xpath,message:t}),!1;if(d.val()!=d.data("oldValue"))return t=this.getResource("render-text-retype-error"),e.push({xpath:i.xpath,message:t}),!1}}var c=!this.grid||!this.grid.getColumn||this.grid.getColumn(this.properties.xpath).properties.editable;if("userPassword"!==i.type&&void 0!==i.maxLength&&i.maxLength>0&&bizagi.util.isNumeric(i.maxLength)&&(c||!c&&this.controlValueIsChanged())){var u=new Number(i.maxLength),p=this.getValue();if(p&&p.toString().length>u)return t=this.getResource("render-text-maxLength-error").replaceAll("#maxLength#",u),e.push({xpath:i.xpath,message:t}),!1}return!0},hasValue:function(){var e=this.getValue();return e&&"text"===this.properties.type&&(e="string"==typeof e?e.trim():e),!bizagi.util.isEmpty(e)},postRender:function(){},postRenderReadOnly:function(){},configureHandlers:function(){},configureHandlersReadOnly:function(){},configureDesignView:function(){},processLayout:function(e,t){var i=this.properties;if(null!=this.getControl()){(t=t||{}).color&&this.changeColor(t.color,e),t.background&&this.changeBackgroundColor(t.background),!t.bold&&t.bold&&e||this.changeFontBold(t.bold,e),t.italic&&this.changeFontItalic(t.italic,e),t.underline&&this.changeFontUnderline(t.underline,e),t.strikethru&&this.changeFontStrikethru(t.strikethru,e),t.size&&this.changeFontSize(t.size,e),i.required=null!=i.required&&bizagi.util.parseBoolean(i.required);var r=null==i.visible||bizagi.util.parseBoolean(i.visible);i.required&&this.changeRequired(i.required),r||(this.grid?this.changeCellVisibility(r):this.changeVisibility(r))}},setValue:function(e,t){t=void 0===t||t,bizagi.util.identicalObjects(e,this.value)||(this.properties.previousValue=this.properties.originalValue=this.value,this.value=this.properties.value=e,this.properties.required&&"execution"==this.getMode()&&(this.checkRequired([])?this.changeRequiredLabel(!1):this.changeRequiredLabel(!0)),t&&!this.internalSetInitialValueFlag&&(this.triggerRenderChange(),this.triggerRenderValidate()))},checkRequired:function(e){var t=this.properties;return!(bizagi.util.parseBoolean(t.required)&&!this.hasValue())||(message=this.getResource("render-required-text").replaceAll("#label#",t.displayName),e.push({xpath:t.xpath,message:message}),!1)},validateInputRetype:function(){return!this.properties.retype||!this.cloneRender||this.getValue()==this.cloneRender.getValue()},triggerRenderChange:function(e){(e=e||{}).changed=void 0===e.changed||e.changed,this.triggerHandler("renderchange",{render:this,changed:e.changed})},triggerRenderValidate:function(){this.triggerHandler("rendervalidate",{render:this})},setDisplayValue:function(e){var t=this.getControl();if(this.setValue(e,!1),!this.properties.editable&&("check"!==this.properties.display||"check"===this.properties.display&&!0===bizagi.override.enableCheck)){var i=this.getDisplayValue(e);"string"!=typeof i&&"number"!=typeof i||(i=bizagi.util.sanitizeHTML(i),$(t).html("<label class='readonly-control'>"+i+"</label>"))}},getValue:function(){return this.value},getDisplayValue:function(){return this.getValue()},getLabel:function(){bizagi.util.mustImplement("getLabel")},getControl:function(){bizagi.util.mustImplement("getControl")},getControlFiller:function(){bizagi.util.mustImplement("getControlFiller")},renderControl:function(){},setValidationMessage:function(e){this.validationMessage=e},renderReadOnly:function(){var e=this.getValue(),t="";return bizagi.util.isObject(e)&&void 0!==e.value?t=bizagi.util.sanitizeHTML(e.value):bizagi.util.isEmpty(e)||(t=bizagi.util.isString(e)?bizagi.util.encodeHtmlText(e):e),t},postRenderPrintVersion:function(){},changeDisplayOption:function(e){this.properties.displayType=e},getDisplayOptionClass:function(e){return""},changeLabelAlign:function(e){this.properties.labelAlign=e},changeValueAlign:function(e){this.properties.valueAlign=e},getAlignClass:function(e){return""},customizeRenderWidth:function(){},changeColor:function(e,t){var i=this,r=i.getControl(),a=i.getLabel();t=void 0===t&&null==t||t;r&&a&&("none"!=e?"value"!==i.properties.displayType&&t?(i.element.each((function(){this.style.setProperty("color",e,"important")})),"grid"==i.properties.type&&i.getControl().find(".bz-mobile-grid__header-title").each((function(){this.style.setProperty("color",e,"important")})),i.getLabel().find("label").css("color",e,"!important"),!1===i.properties.editable&&(i.getElementsToStylize(i.getControl()).css("color",e,"!important"),i.getElementsToStylize($("label",i.getControl()).css("color",e,"!important")))):(i.getElementsToStylize(i.getControl()).css("color",e,"!important"),i.getControl().find("*").each((function(t,r){i.getElementsToStylize(r).css("color",e,"!important")}))):(i.element.css("color",""),i.getLabel().find("label").css("color",""),i.getControl().css("color",""),i.getControl().find("input, textarea").each((function(e,t){var r=$(t).data("originalColor")||"";i.getElementsToStylize(t).css("color",r)}))))},changeBackgroundColor:function(e){var t=this.getControl(),i=this.getLabel();if(t&&i)if("none"!=e){this.element.each((function(){this.style.setProperty("background-color",e,"important")})),void 0!==i.find("label").style?this.getLabel().find("label").style("background-color",e,"important"):this.getLabel().find("label").css("background-color",e,"!important");var r=this.getLabel().attr("style");r+="; background-color:"+e+"!important",this.getLabel().attr("style",r)}else this.element.css("background-color",""),this.getLabel().find("label").css("background-color",""),this.getControl().css("background-color",""),this.getControl().find("input, textarea").each((function(e,t){var i=$(t).data("originalColor")||"";$(t).css("background-color",i)}))},getFormattingLabel:function(){return this.getLabel().find("label")},changeFontBold:function(e,t){t=void 0===t&&null==t||t;0!=bizagi.util.parseBoolean(e)&&t?(this.getFormattingLabel().css("font-weight","bold","!important"),this.getControl().find("*").each((function(e,t){$(t).css("font-weight","bold","!important")}))):t&&this.getFormattingLabel().css("font-weight","normal","!important"),t||(1==bizagi.util.parseBoolean(e)?this.getControl().find("*").each((function(e,t){$(t).css("font-weight","bold","!important")})):this.surrogateKey&&"summary"==this.surrogateKey||(this.getControl().find("*").each((function(e,t){$(t).css("font-weight","normal","!important")})),this.getControl().css("font-weight","normal","!important")))},controlValueIsChanged:function(){var e=this.properties,t=this.getValue(),i=e.originalValue,r=e.defaultValue,a=!0,n=bizagi.util.normalizeType(e.type),o=this.getFormContainer();if("duplicate"===e.retype&&this.cloneRender&&o.isStartForm())return!0;if($.forceCollectData)return!0;if("grid"===n&&"pending"===this.ready().state())return!1;if(["combo","queryCombo","list","queryList","radio","queryRadio"].includes(n)||/^cascadingcombo$/i.test(n))t&&void 0!==t.length&&(t=t[0]),i&&void 0!==i.length&&(i=i[0]),r&&void 0!==r.length&&(r=r[0]),t=t&&t.id?t.id:t,i=i&&i.id?i.id:i,a=void 0!==(r=r&&r.id?r.id:r)&&null!=r?i!=t||i==r:i!=t;else if("boolean"===n||"queryBoolean"===n||"queryCheck"===n)a=bizagi.util.parseBoolean(i)!=bizagi.util.parseBoolean(t);else if("searchNumber"===n)a=!!t;else if("number"===n)a=(null!==t&&""!==t||null!==i&&""!==i)&&i!==t;else if("text"===n)a=(null!==t&&""!==t||null!==i&&""!==i)&&i!==t;else if("date"===n)i||t?(e.showTime||(t=bizagi.util.getNormalizedDate(t,e.fullFormat),i=bizagi.util.getNormalizedDate(i,e.fullFormat)),a=i!=t):a=!1;else if("actionLauncher"===n){a=!1;var s=[];try{s="string"==typeof i?JSON.parse(i):i}catch(e){}var l=function(e,t){e=e||"";for(var i=!1,r=0,a=(t=t||[]).length;r<a;r++)if(t[r].guidAction==e){i=!0;break}return i};if(s.length==t.length)for(var d=0,c=s.length;d<c;d++)l(s[d].guidAction,t)||(a=!0);else a=!0}else if("polymorphicLauncher"===n||"entityTemplate"===n)a=i.length!=t.length||JSON.encode(t)!=JSON.encode(i);else if("searchList"===n){var u={};try{u=JSON.parse(t)}catch(e){console.log("Error when detect change value on searchList control")}a=JSON.encode(i)!=JSON.encode(u.value)}else a=!["signature","image"].includes(n)&&i!==t;return a},changeFontItalic:function(e,t){var i=this;t=void 0===t&&null==t||t;"value"!=i.properties.displayType&&t?1==bizagi.util.parseBoolean(e)?i.getFormattingLabel().css("font-style","italic","!important"):i.getFormattingLabel().css("font-style","normal","!important"):1==bizagi.util.parseBoolean(e)?(t&&i.getFormattingLabel().css("font-style","italic","!important"),i.properties.editable?i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("font-style","italic","!important")})):i.getElementsToStylize(i.getControl()).css("font-style","italic","!important")):(t&&i.getFormattingLabel().css("font-style","normal","!important"),i.properties.editable?i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("font-style","normal","!important")})):i.getElementsToStylize(i.getControl()).css("font-style","normal","!important"))},changeFontUnderline:function(e,t){var i=this,r=i.properties.textFormat||{},a=i.properties.valueFormat||{},n=bizagi.util.parseBoolean(r.strikethru)?"line-through ":"",o=bizagi.util.parseBoolean(a.strikethru)?"line-through ":"";t=void 0===t&&null==t||t;1==bizagi.util.parseBoolean(e)&&t?(i.getFormattingLabel().css("text-decoration",n+"underline","!important"),i.getControl().each((function(e,t){i.getElementsToStylize(t).css("text-decoration",n+"underline")}))):t&&i.getFormattingLabel().css("text-decoration",n,"!important"),"value"!=i.properties.displayType&&t||(1==bizagi.util.parseBoolean(e)?i.properties.editable?i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("text-decoration",o+"underline","!important")})):i.getElementsToStylize(i.getControl()).css("text-decoration",o+"underline","!important"):i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("text-decoration",o,"!important")})))},changeFontStrikethru:function(e,t){var i=this,r=i.properties.textFormat||{},a=i.properties.valueFormat||{},n=bizagi.util.parseBoolean(r.underline)?"underline ":"",o=bizagi.util.parseBoolean(a.underline)?"underline ":"";t=void 0===t&&null==t||t;1==bizagi.util.parseBoolean(e)&&t?i.getFormattingLabel().css("text-decoration",n+"line-through","!important"):t&&i.getFormattingLabel().css("text-decoration",n,"!important"),"value"!=i.properties.displayType&&t||(1==bizagi.util.parseBoolean(e)?i.properties.editable?i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("text-decoration",o+"line-through","!important")})):i.getElementsToStylize(i.getControl()).css("text-decoration",o+"line-through","!important"):i.properties.editable?i.getControl().find("*").each((function(e,t){i.getElementsToStylize(t).css("text-decoration",o,"!important")})):i.getElementsToStylize(i.getControl()).css("text-decoration",o,"!important"))},changeFontSize:function(e,t){t=void 0===t&&null==t||t;if("0"!=e){var i=this.getFormattingLabel(),r=100+10*Number(e)+"%";if(t&&i.css("font-size",r,"!important"),"value"==this.properties.displayType||!t){var a=this.getControl();"object"==_typeof(a.children())&&a.children().length>0?this.getElementsToStylize(a.children()).css("font-size",r,"!important"):(this.getElementsToStylize(a).css("font-size",r,"!important"),-1!=this.properties.type.indexOf("ombo")&&e>4&&a.children(0).height(2*e+20)),this.getElementsToStylize(a.find(".ui-bizagi-render-date")).css("line-height","normal")}}},getElementsToStylize:function(e){return $(e)},changeVisibility:function(e){var t=this.properties;1==bizagi.util.parseBoolean(e)?"hidden"!==t.type&&(this.element.show(),this.element.css("display",""),t.required&&(this.hasValue()||this.changeRequiredLabel(!0))):this.element&&this.element.hide(),t.visible=e},changeEditability:function(e){var t=this,i=t.properties,r=t.getControl();i.editable="Default"==e?t.originalProperties.editable:bizagi.util.parseBoolean(e),i.editabilityEnabled=i.editabilityEnabled||i.editable,r.empty(),"function"==typeof t.internalRenderControl&&$.when(t.internalRenderControl()).done((function(e){"function"==typeof t.emptyControlByChangeEditability&&t.emptyControlByChangeEditability(),t.asyncRenderDeferred||r.append(e),t.postRenderElement(t.element)}))},changeEditabilityCellControl:function(e,t,i){var r=this.properties,a=this.grid.getColumn(i),n=a.getDecorated(t);r.editable="Default"===e?this.originalProperties.editable:bizagi.util.parseBoolean(e),r.editabilityEnabled=r.editabilityEnabled||r.editable,this.internalRenderCellControl(r.editable,t,a,n)},internalRenderCellControl:function(e,t,i,r){var a=this,n=a.getControl();n.empty(),"function"==typeof a.internalRenderControl&&$.when(a.internalRenderControl()).done((function(o){a.asyncRenderDeferred||n.append(o),a.postRenderElement(a.element),e&&(i.bind("rendered",(function(){i.readyDeferred.resolve()})),r.unbind("renderchange"),r.bind("renderchange",(function(e,r){i.changed=!0,a.grid.onCellChange(i,null,t,r)})))}))},changeRequired:function(e){var t=this.properties,i=t.displayName||"",r=$("label",this.getLabel()),a=this.getControl();t.required=e,"execution"==this.getMode()&&this.checkRequired([])?this.changeRequiredLabel(!1):1==bizagi.util.parseBoolean(e)&&t.editable?"rtl"==this.properties.orientation?a.prepend('<div class="ui-bizagi-render-control-required-rtl"></div>'):(a.addClass("control-required"),a.prepend('<div class="ui-bizagi-render-control-required"></div>')):"rtl"==this.properties.orientation?$(".ui-bizagi-render-control-required-rtl",a).remove():(a.removeClass("control-required"),$(".ui-bizagi-render-control-required",a).remove()),r.html(i),this.triggerRenderValidate()},changeRequiredLabel:function(e){var t=this.properties,i=t.displayName||"",r=$("label",this.getLabel()),a=this.getControl();1==bizagi.util.parseBoolean(e)&&t.editable?"rtl"==this.properties.orientation?a.prepend('<div class="ui-bizagi-render-control-required-rtl"></div>'):(a.addClass("control-required"),a.append('<div class="ui-bizagi-render-control-required"></div>')):"rtl"==this.properties.orientation?$(".ui-bizagi-render-control-required-rtl",a).remove():(a.removeClass("control-required"),$(".ui-bizagi-render-control-required",a).remove()),r.html(i),this.triggerRenderValidate()},refreshControl:function(e){var t=this,i=t.properties,r=(t.value,t.getFormContainer().properties.id||"");return e=e||{},t.startLoading(),t.beforeToRefresh(),$.when(t.dataService.multiaction().refreshControl({xpath:i.xpath,idRender:i.id,idPageCache:i.idPageCache,xpathContext:i.xpathContext||e.xpathContext,idForm:r})).pipe((function(e){t.grid&&bizagi.override.restoreAppearanceAfterRefresh&&t.saveGridChildrenVisualChanges(),t.control=t.controlFiller=t.label=null;var i=t.element;return t.initializeData(e.render),$.when(t.render()).pipe((function(e){var i=$(e);t.postRenderElement(i);return t.properties.originalValue=t.value,i})).pipe((function(e){i.replaceWith(e),t.grid||t.triggerRenderChange({changed:!1}),bizagi.override.restoreAppearanceAfterRefresh&&(t.grid?(t.restoreGridChildrenVisualChanges(),t.restoreGridAppearance()):t.restoreAppearance()),t.afterToRefresh()}))})).fail((function(e){e=t.processFailMessage(e)})).always((function(){t.endLoading()}))},refreshDesignControl:function(e){var t=this,i=t.properties;t.beforeToRefresh(),t.control=t.controlFiller=t.label=null,$.extend(e.render.properties,{xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext||"form",idPageCache:i.idPageCache});var r=t.element;return t.initializeData(e.render),$.when(t.render()).pipe((function(e){var i=$(e);t.postRenderElement(i);return t.properties.originalValue=t.value,i})).pipe((function(e){r.replaceWith(e),t.triggerRenderChange(),t.beforeToRefresh()}))},cleanData:function(){this.setValue(""),this.clearDisplayValue()},clearDisplayValue:function(){var e=this.getControl(),t=e.find("input");t.length>0?t.val(this.getValue()):!1===this.properties.editable&&$(e).html("<label class='readonly-control'></label>")},updateOriginalValue:function(){this.properties.originalValue=this.value},collectData:function(e){var t=this.properties,i=t.xpath,r=this.getValue();this.controlValueIsChanged()&&(bizagi.util.isEmpty(i)||(bizagi.util.isEmpty(r)?""!==r&&null!==r||(e[t.xpath]=""):e[t.xpath]=r)),this.validateInputRetype()||(e[t.xpath]="")},hasChanged:function(e){return!!this.controlValueIsChanged()&&(e.push(!0),!0)},configureHandlersQueryForm:function(){var e=this;e.element.find(".ui-bizagi-render-control-included").change((function(){e.properties.included=$(this).is(":checked")}))},getRenderId:function(){var e=this;return bizagi.util.tryCatch((function(){return e.properties.id}),null)},collectDataQueryForm:function(e){var t=this.properties,i=t.xpath,r=this.getValue(),a=null;if(!bizagi.util.isEmpty(i)){if(null!=r)a=void 0!==r.id?bizagi.util.isEmpty(r.id)?null:[r]:""!==r?r:null;if(null!==a||t.included){var n=(this.properties.typeSearch||this.properties.rangeQuery||"NONE").toUpperCase(),o={value:a,included:this.properties.included,xpath:t.xpath,searchType:n,orderType:"NONE",renderId:this.getRenderId()};void 0!==t.displayXpath&&""!==t.displayXpath&&(o.displayXpath=t.displayXpath),e.push(o)}}},canBeSent:function(){var e,t=this.properties,i=bizagi.util.parseBoolean(t.displayOnly)||!1,r=bizagi.util.parseBoolean(t.editable)||bizagi.util.parseBoolean(t.editabilityEnabled);if(t.isClone)return!1;if(!i&&r)return!0;if(t.xpath&&1==this.getFormContainer().getRenders(t.xpath).length){if(e=!!$.forceCollectData&&$.forceCollectData.toString(),$.forceCollectData=e?void 0:$.forceCollectData,this.controlValueIsChanged())return $.forceCollectData=e?bizagi.util.parseBoolean(e):$.forceCollectData,!0;$.forceCollectData=e?bizagi.util.parseBoolean(e):$.forceCollectData}return!1},canBeSentQueryForm:function(){return!this.properties.isClone},focus:function(e){var t=this;if(t.properties.visible){this._super();var i=$("#ui-bizagi-wp-app-render-form-content"),r=function(){var e=t.getControl(),r="grid"!=t.properties.type?$("input, select, option, textarea",e):$("input, select, option, textarea",e).first();r.length>0&&$.each(r,(function(e){var t=r[e];if("hidden"!=$(t).attr("type")&&"none"!=$(t).css("display")&&"hidden"!=$(t).css("visibility"))try{bizagi.util.isIE()||bizagi.util.autoScrollBottom(i),t.focus()}catch(e){}}))};$.when(t.ready()).done((function(){if(e>0)var t=setTimeout((function(){r(),clearTimeout(t)}),e);else r()}))}},getDefaultLabelAlign:function(e){return"default"},getDefaultValueAlign:function(e){return"default"},getRTLAlign:function(e){return e},configureSubmitOnChange:function(){var e=this,t=e.properties,i="",r=t.id;if(t.editable){t.dependencies=t.dependencies||"all";var a={conditions:{expressions:[{simple:{xpath:i=t.xpath?t.submitOnChangexpathContext?t.submitOnChangexpathContext+"."+t.xpath:t.xpath:t.submitOnChangexpathContext?t.submitOnChangexpathContext+"."+t.id:t.id,renderId:t.id,operator:"changes",argumentType:"const"}}]},commands:[{xpath:i,command:"submit-value",argument:t.dependencies}],dependencies:[i],elseCommands:[]};t.submitOnChangexpathContext&&e.grid&&(a.conditions.expressions[0].simple.containerId=e.grid.properties.id),$.when(e.ready()).done((function(){e.getFormContainer().addSubmitAction(i+"."+r,a)}))}},submitOnChange:function(e,t,i){var r=this,a=$.Deferred();return""!=r.properties.contexttype&&e&&(e[r.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=r.properties.contexttype),$.when(r.isReadyToSave()).done((function(){r.internalSubmitOnChange(e,t,i).done((function(){a.resolve()})).fail((function(){a.reject()}))})),a.promise()},getCacheIdCase:function(){var e=this.getParams().idCase;return void 0===bizagi.cache?(bizagi.cache={},bizagi.cache.idCaseObject={idCase:void 0!==e?e:void 0!==bizagi.cache.idCase?bizagi.cache.idCase:void 0}):void 0!==e&&void 0!==bizagi.cache.idCaseObject?bizagi.cache.idCaseObject.idCase=e:void 0!==e&&void 0===bizagi.cache.idCaseObject&&(bizagi.cache.idCaseObject={},bizagi.cache.idCaseObject.idCase=e),e=void 0===e?void 0===bizagi.cache.idCaseObject?void 0:bizagi.cache.idCaseObject.idCase:e},internalSubmitOnChange:function(e,t,i){var r=this.getFormContainer(),a=this.properties,n={data:e,bRefreshForm:t,notCollect:i,properties:{idCase:this.getCacheIdCase(),id:a.id,xpath:a.xpath,idPageCache:a.idPageCache,contexttype:a.contexttype}};return r.internalSubmitOnChange(n)},ready:function(){return $.when(this.parent.ready(),this.isRendered())},getCustomHandlers:function(){var e=this.getFormContainer();return e?e.getCustomHandlers():null},getCustomHandler:function(e){var t=this.getCustomHandlers();return t?t[e]:null},calculateRenderWidth:function(e,t,i){if(e="100"==t&&void 0===e?"0":e?"0"!=e?e:"50":"50%",t=t?"0"!=t?t:"50":"50%","normal"==i||"both"==i||"reversed"==i){if(e&&bizagi.util.percent2Number(e)<5&&t&&bizagi.util.percent2Number(t)<5)return{label:0,control:100};e&&!t?t=100-(e=bizagi.util.percent2Number(e)):!e&&t?e=100-(t=bizagi.util.percent2Number(t)):(e=bizagi.util.percent2Number(e))+(t=bizagi.util.percent2Number(t))!=100&&void 0!==this.properties&&"pixels"!=this.properties.layoutType&&(t=100-e)}else e=100,t=100;return{label:e,control:t}},getIdCase:function(){return this.getFormContainer().params.idCase||bizagi.context.idCase},getIdWorkitem:function(){return this.getFormContainer().params.idWorkitem||bizagi.context.idWorkitem},getidTask:function(){return this.getFormContainer().params.idTask||bizagi.context.idTask},getSessionId:function(){return this.getFormContainer().properties.sessionId},changeCellColor:function(e){var t=this.getControl();t&&("none"!=e?(t.css("color",e),t.find("input, textarea, label").each((function(t,i){$(i).css("color",e)}))):(t.css("color",""),t.find("input, textarea, label").each((function(e,t){$(t).css("color","")}))))},changeCellBackgroundColor:function(e){var t=this.getControl(),i="",r="";if(t)if("none"!=e&&(i=e,r="none"),this.properties.editable){var a=!1;t.find("input, textarea, .ui-selectmenu").each((function(e,t){"text"!=t.type&&"textarea"!=t.type||$(t).hasClass("ui-select-data")||(a=!0),$(t).css({"background-color":i,"background-image":r})})),a||t.closest("td").each((function(e,t){$(t).css({"background-color":i,"background-image":r})}))}else t.each((function(e,a){($(a).hasClass("ui-bizagi-cell-readonly")?t.closest("td"):$(a)).css({"background-color":i,"background-image":r})}))},changeCellVisibility:function(e){var t=this.properties,i=this.getControl();i&&(1==bizagi.util.parseBoolean(e)?(i.css("visibility","visible"),i.css("display",""),this.element&&this.element.show()):i.css("visibility","hidden")),t.visible=e},changeCellRequired:function(e){var t=this.properties,i=this.getControl();i&&(1==bizagi.util.parseBoolean(e)&&bizagi.util.isEmpty(this.value)?(i.addClass("control-required"),i.append('<div class="ui-bizagi-render-control-required"></div>')):(i.removeClass("control-required"),$(".ui-bizagi-render-control-required",i).remove()),t.required=e)},startActionExecution:function(){this.startLoading(),this.actionExecutionDeferred=new $.Deferred},endActionExecution:function(){this.endLoading(),this.actionExecutionDeferred&&this.actionExecutionDeferred.resolve(),delete this.actionExecutionDeferred},readyActionExecution:function(){return this.actionExecutionDeferred?this.actionExecutionDeferred.promise():$.when(!0)},isFromCreatedRow:function(){if(this.grid)for(var e=this.grid.columns.length;e-- >0;)if(this.grid.columns[e].properties.xpath==this.properties.xpath&&1==this.grid.columns[e].isNewRow)return!0;return!1},submitInvalidatePageCacheRequest:function(e){var t=this.properties,i=e?e.idPageCache:t.idPageCache;this.dataService.invalidatePageCache({idPageCache:i})},isDesignMode:function(){return"design"===this.getMode()},isExecutionMode:function(){return"execution"===this.getMode()},preventDefaultForAnchorTag:function(){(bizagi.util.isSharepointContext()||bizagi.util.isWebpartContext())&&$("a[href='#']",this.getControl()).click((function(e){e.preventDefault()}))},getMainForm:function(e){var t=e.params.fromRender;if(void 0===t)return e;this.getMainForm(t.getFormContainer())},setInterceptionObserver:function(e,t){var i=this,r=new IntersectionObserver((function(){i.pluginInitialized||0===e.width()||("function"==typeof t&&t(),r.disconnect())}));r.POLL_INTERVAL=100,r.observe(e.get(0))},setResizeObserver:function(e,t){var i=this,r=new ResizeObserver((function(){i.pluginInitialized||0===e.width()||("function"==typeof t&&t(),r.disconnect())}));r.observe(e.get(0))},restoreGridAppearance:function(){var e=this.getIndexes();this.restoreAppearance(),this.columns.length>0&&$.each(this.columns,(function(t,i){for(var r=0;r<e.length;r++)i.decorateRenders[e[r]].restoreCellAppearance()}))},saveGridChildrenVisualChanges:function(){var e=this,t=e.getIndexes();e.gridChildrenVisualChanges=[],e.columns.length>0&&$.each(e.columns,(function(i,r){if(r.properties.xpath)for(var a=0;a<t.length;a++){var n=r.decorateRenders[t[a]];n&&n.properties&&(e.gridChildrenVisualChanges[n.properties.id+t[a]]=n.visualChanges)}}))},restoreGridChildrenVisualChanges:function(){var e=this,t=e.getIndexes();e.columns.length>0&&$.each(e.columns,(function(i,r){if(r.properties.xpath)for(var a=0;a<t.length;a++){var n=r.decorateRenders[t[a]];n&&n.properties&&(n.visualChanges=e.gridChildrenVisualChanges[n.properties.id+t[a]]||{})}})),delete e.gridChildrenVisualChanges},restoreCellAppearance:function(){for(var e in this.visualChanges)switch(e){case"color":this.changeCellColor(this.visualChanges[e]);break;case"backgroundColor":this.changeCellBackgroundColor(this.visualChanges[e]);break;case"required":this.changeCellRequired(this.visualChanges[e]);break;case"editability":this.changeEditabilityCellControl(this.visualChanges[e],this.surrogateKey,this.properties.xpath);break;case"visibility":this.changeCellVisibility(this.visualChanges[e]);break;case"minValue":this.changeMinValue(this.visualChanges[e]);break;case"maxValue":this.changeMaxValue(this.visualChanges[e])}},formatValue:function(e){return e}}),$.Class.extend("bizagi.rendering.render.base",{},{processLayout:function(e,t){var i=this.properties;if("boolean"==typeof e)if(e)this.processLabelLayout(t);else{this.processControlLayout(t),i.required=void 0!==i.required&&bizagi.util.parseBoolean(i.required);var r=void 0===i.visible||bizagi.util.parseBoolean(i.visible);i.required&&this.changeRequired(i.required),r||this.changeVisibility(r)}else console.warm("error calling processLayout, 'isLabelFormat' is not boolean")},processLabelLayout:function(e){var t=this.getLabel();null!=t&&(void 0===(e=e||{}).bold&&(e.bold=!0),this.changeBackgroundColor(e.background).changeFontColor(t,e.color).changeFontBold(t,e.bold).changeFontSize(t,e.size).changeFontItalic(t,e.italic).changeTextDecoration(t,(e.underline?"underline":"")+(e.strikethru?" line-through":"")))},processControlLayout:function(e){var t=this.getControl(),i=this.getElementsToStylize(t);e=e||{},this.changeFontColor(i,e.color).changeFontBold(i,e.bold).changeFontItalic(i,e.italic).changeFontSize(i,e.size).changeTextDecoration(i,(e.underline?"underline":"")+(e.strikethru?" line-through":""))},changeColor:function(e){var t=this.getLabel(),i=this.getControl(),r=this.getElementsToStylize(i);return this.changeFontColor(t,e).changeFontColor(r,e)},changeFontColor:function(e,t){if(void 0===e)return this;if(void 0===t)return this;var i="none"!==t?t:"";return e.css("color",i),this},changeFontSize:function(e,t){if(void 0===t)return this;if(void 0===e)return this;if("0"!==t){var i=100+10*Number(t)+"%";e.css("font-size",i)}return this},changeTextDecoration:function(e,t){return void 0===t?this:void 0===e?this:(t&&e.css("text-decoration",t),this)},changeFontItalic:function(e,t){var i=bizagi.util.parseBoolean(t)?"italic":"normal";return e.css("font-style",i),this},changeFontBold:function(e,t){var i=bizagi.util.parseBoolean(t)?"bold":"normal";return e.css("font-weight",i),this},changeBackgroundColor:function(e){return void 0===e?this:("none"!==e?this.element.css("background-color",e):this.element.css("background-color",""),this)},changeCellBackgroundColor:function(e){return this.getCellBackgroundFunction(this.properties.editable.toString(),this.properties.type)(e)},getCellBackgroundFunction:function(e,t){var i={true:{columnDate:this.changeInputBackgroundColor.bind(this)},false:{default:this.changeBackgroundColor.bind(this)},default:this.changeBackgroundColor.bind(this)};return i[e][t]||i.default},changeInputBackgroundColor:function(e){return void 0===e?this:("none"!==e?$(".bz-input-icon",this.element).css("background-color",e):$(".bz-input-icon",this.element).css("background-color",""),this)},changeRequiredLabel:function(){},changeCellRequired:function(e){this.changeRequired(e)},getRTLAlign:function(e){return void 0===e||""==e?"default":e},getDefaultLabelAlign:function(){return"default"},getDefaultValueAlign:function(){return"default"}}),$.Class.extend("bizagi.rendering.form",{},{init:function(e){var t=e.data,i=bizagi.util.detectDevice();this.rendersById={},this.rendersByXpath={},this.rendersByXpathId={},this.rendersByType={},this.idPageCache=t.pageCacheId,this.compatibilityVersion=t.properties.compatibilityVersion||0,this.mode=e.mode||"execution",this.focus=e.focus,this.params=e,this._super(e);var r="";r="desktop"!==i?this.getResource("render-form-user-confirmation-message").replace(/<br(\/| \/)>/g,"\n"):this.getResource("render-form-user-confirmation-message");var a=this.properties;a.sessionId=t.sessionId,a.displayAsReadOnly=bizagi.util.parseBoolean(t.displayAsReadOnly)||!1,a.userConfirmationMessage=a.userConfirmationMessage||r,a.orientation=a.orientation||"ltr",a.hasRule=bizagi.util.parseBoolean(a.hasRule)||!1,a.contexttype=e.contexttype||"",a.paramsRender=e.paramsRender||{},a.processPath=e.data.processPath?e.data.processPath.replaceAll("|/|","  &rsaquo;  "):"",a.breadCrumb=e.data.processPath?e.data.processPath.split("|/|"):[],a.type=a.type||"form",this.validations=t.validations,this.actions=t.actions,this.allowValidateAndSaveAction=bizagi.override&&!0===bizagi.override.enableActionValidateAndSave;var n=bizagi.util.isFeatureEnabled("enableExecuteQuickActions"),o=null===n||n;if(this.useQuickActions=o&&this.hasQuickActions(t,o),this.initializeButtons(t),t.transitions&&(this.transitions=t.transitions),this.originalProcessButton=this.processButton,this.isRoutingDisabled=!1,e.applicationParent)switch(e.applicationParent){case"NEWWORKPORTAL":this.isRoutingDisabled=!0}this.isOfflineFormsV2Supported=bizagi.util.isMobileDevice()&&bizagi.util.isOfflineFormsV2Supported(),this.isOfflineForm=bizagi.util.isOfflineForm({context:this}),this.rendersById[a.id]=this},initializeButtons:function(e){var t=this;t.buttons=[],e.buttons&&$.each(e.buttons,(function(e,i){var r=i.button.properties;r.caption=bizagi.util.isEmpty(r.caption)||t.getResource(r.caption)===r.caption?r.caption:t.getResource(r.caption),r.actions&&$.each(r.actions,(function(e,t){r[t]=!0})),r.ordinal=e,r.action=r.next?"next":r.nextWithoutValidations?"nextWithoutValidations":r.submitData?"save":r.cancel?"cancel":r.back?"back":r.createnewcase?"createnewcase":r.validate?"validate":"",r.save="save"===r.action,r.quickAction="quickactions"===r.type,(r.next||r.back||r.nextWithoutValidations)&&(r.routing=!0),r.hasRule&&(r.executeRule=!0),t.allowValidateAndSaveAction&&r.validate&&(r.submitData=!0,r.refresh=!0,r.save=!0,"next"!==r.action&&"createnewcase"!==r.action||(r.refresh=!1)),r.style=t.buildButtonStyle(r),t.buttons.push(r)}))},getParams:function(){return this.params},setParam:function(e,t){this.params&&(this.params[e]=t)},getMode:function(){return this.mode},getCustomHandlers:function(){if(this.params)return this.params.customHandlers},registerRender:function(e){var t=e.properties.xpath,i=e.properties.id,r=e.properties.type,a=t?t+"."+i:void 0;this.rendersById[i]=e,t&&(this.rendersByXpath[t]||(this.rendersByXpath[t]=[]),this.rendersByXpath[t].push(e)),a&&(this.rendersByXpathId[a]||(this.rendersByXpathId[a]=[]),this.rendersByXpathId[a].push(e)),this.rendersByType[r]||(this.rendersByType[r]=[]),this.rendersByType[r].push(e)},unregisterRender:function(e){if(this.rendersById[e.properties.id]&&delete this.rendersById[e.properties.id],e.properties.xpath){var t;if($.isArray(this.rendersByXpath[e.properties.xpath])&&this.rendersByXpath[e.properties.xpath].length>1)-1!==(t=this.rendersByXpath[e.properties.xpath].findIndex((function(t){return bizagi.util.md5(JSON.stringify(t.properties))===bizagi.util.md5(JSON.stringify(e.properties))})))&&this.rendersByXpath[e.properties.xpath].splice(t,1);else delete this.rendersByXpath[e.properties.xpath];if(e.properties.id)if($.isArray(this.rendersByXpathId[e.properties.xpath+"."+e.properties.id])&&this.rendersByXpathId[e.properties.xpath+"."+e.properties.id].length>1)-1!==(t=this.rendersByXpathId[e.properties.xpath+"."+e.properties.id].findIndex((function(t){return bizagi.util.md5(JSON.stringify(t.properties))===bizagi.util.md5(JSON.stringify(e.properties))})))&&this.rendersByXpathId[e.properties.xpath+"."+e.properties.id].splice(t,1);else delete this.rendersByXpathId[e.properties.xpath+"."+e.properties.id]}if(e.properties.type)for(var i=this.getRenderByType(e.properties.type),r=i.length,a=e.properties.id||e.properties.xpath,n=0;n<r;n++){var o=i[n];if(void 0!==o.properties.id&&o.properties.id==a||void 0!==o.properties.xpath&&o.properties.xpath==a){this.rendersByType[e.properties.type].splice(n,1);break}}},getRenderById:function(e){return this.rendersById[e]},getGridByColumn:function(e){for(var t=this.getRenderByType("grid"),i=0;i<t.length;i++)if(-1!=t[i].columnsIds.indexOf(e))return t[i];return null},getRenders:function(e){return e&&e.indexOf&&e.indexOf("[")>0&&(e=e.substring(0,e.indexOf("["))),this.rendersByXpathId[e]?this.rendersByXpathId[e]:this.rendersByXpath[e]?this.rendersByXpath[e]:[]},getRenderByType:function(e){return"string"==typeof e&&e.length>0&&this.rendersByType[e]?this.rendersByType[e]:[]},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("form"),i=$.fasttmpl(t,{buttons:this.buttons,transitions:this.transitions,uniqueId:e.uniqueId,helptext:e.helpText,mode:this.getMode(),queryForm:"queryForm"===this.getFormType(),summaryForm:this.params.summaryForm||!1,globalForm:this.properties.displayAsReadOnly||!1,idCase:"",displayName:this.params.displayName||"",processPath:e.processPath,breadCrumb:e.breadCrumb,orientation:e.orientation,isEmpty:bizagi.util.isEmpty(this.children)&&bizagi.util.isEmpty(this.transitions),allowQuickActions:this.useQuickActions});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())},postRenderContainer:function(e){var t=this.getMode();e.addClass("ui-bizagi-rendering-mode-"+t),this._super(e)},configureHandlers:function(){var e,t=this,i=t.container;i.length>1?$(i).each((function(){$(this).hasClass("ui-bizagi-container-complexgateway")&&(e=this)})):e=$(".ui-bizagi-container-complexgateway",i),t.activeTransitions={},t.processButtons(i),t.bind("ondomincluded",(function(e,i){var r=t.getValidationsContainer(i);t.validationController=new bizagi.command.controllers.validation(t,t.validations,r),t.actionController=new bizagi.command.controllers.action(t,t.actions),t.readyDeferred.resolve()})),$(e).find(".ui-checkbox").bind("click",(function(){var e=$("label",this),i=e.data("value")||"";void 0===t.activeTransitions[i]&&(t.activeTransitions[i]=!1),bizagi.util.parseBoolean(e.data("checked"))?(e.removeClass("ui-checkbox-state-checked"),e.removeClass("bz-check").addClass("bz-full-ball"),e.data("checked",!1),t.activeTransitions[i]=!1):(e.addClass("ui-checkbox-state-checked"),e.addClass("bz-mo-icon").addClass("bz-check").removeClass("bz-full-ball"),e.data("checked",!0),t.activeTransitions[i]=!0)}))},configureDesignView:function(){var e=this;e.bind("ondomincluded",(function(){e.readyDeferred.resolve()}))},buildButtonStyle:function(e){var t={};if(e.format){if(e.format.size&&"0"!=e.format.size){var i=100+10*Number(e.format.size)+"%";t["font-size"]=i+" !important"}if(e.format.bold&&(t["font-weight"]="bold !important",bizagi.util.isIE()&&(t["font-family"]="'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important")),e.format.italic&&(t["font-style"]="italic !important"),e.format.underline||e.format.strikethru){var r=bizagi.util.parseBoolean(e.format.strikethru)?"line-through ":"",a=bizagi.util.parseBoolean(e.format.underline)?"underline ":"";t["text-decoration"]=r+a+" !important"}e.format.background&&(t["background-color"]=e.format.background+" !important",t["background-image"]="none !important"),e.format.color&&(t.color=e.format.color+" !important")}var n="";for(key in t)n+=key+":"+t[key]+";";return n},render:function(){return this.readyDeferred||(this.readyDeferred=new $.Deferred),this._super()},ready:function(){return this.readyDeferred.promise()},getXpathContext:function(){return this.properties.xpathContext||""},getContextType:function(){return this.properties.contexttype||""},getEndPointAction:function(){if("startform"==this.properties.formtype)return"LOADSTARTFORM"},getPageCache:function(){return this.idPageCache},getFormContainer:function(){return this},processButtons:function(){var e=this,t=e.getButtons();t&&0!==t.length&&t.on("click",(function(t){t.preventDefault(),t.stopImmediatePropagation();var i=$(this),r=i.attr("ordinal"),a=e.buttons.find((function(e){return e.ordinal==r}));i.prop("disabled",!0),i.hasOwnProperty("disabled")&&i.button("disable"),e.propagateExternalEvents(t);var n=setTimeout((function(){$.when(e.buttonExecutionHandler(a)).always((function(){$.contains(document.documentElement,i.get(0))&&(i.prop("disabled",!1),i.hasOwnProperty("enable")&&i.button("enable"))})),clearTimeout(n)}),100)}))},buttonExecutionHandler:function(e){var t=this;return t.startLoading(),t.lastActionButton=e,"next"===e.action&&(e.routingDisabled=t.isRoutingDisabled),$.when(t.processButton(e)).always((function(){t.processDefer=void 0,t.endLoading()}))},preProcessButton:function(e){return!0},postProcessButton:function(e,t){return!0},setLoaderDeferred:function(){this.loaderDeferred=$.Deferred().resolve()},deleteLoaderDeferred:function(){var e=this;e.isLoaderDeferredSet()&&$.when(e.loaderDeferred.promise()).done((function(){delete e.loaderDeferred})).fail((function(){delete e.loaderDeferred}))},useOrSetLoaderDeferred:function(){this.isLoaderDeferredSet()||this.setLoaderDeferred()},getLoaderPromise:function(){return this.isLoaderDeferredSet()?this.loaderDeferred.promise():void 0},isLoaderDeferredSet:function(){return!!this.loaderDeferred},appendWaitForLoader:function(e){var t=e.promise,i=e.create||!1;if(!this.isLoaderDeferredSet()){if(!i)return;this.setLoaderDeferred()}this.loaderDeferred=this.loaderDeferred.then((function(){return t}))},getResolveOrReject:function(){var e=$.Deferred();return this.isLoaderDeferredSet()?$.when(this.loaderDeferred.promise()).done((function(){e.resolve()})).fail((function(){e.resolve()})):e.resolve(),e.promise()},processButton:function(e){var t=this,i=$.Deferred(),r=t.properties;e.routing||bizagi.chrono.initAndStart("submitForm"),bizagi.chrono.init("waiting"),t.validationController.clearValidationMessages();var a=t.getFormContainer(),n=a.getRenderByType("tabItem"),o=n.length;a.innerTabsLoading=!0,t.useOrSetLoaderDeferred();for(var s=0;s<o;s++){var l=n[s];l.loadingDeferred&&l.parent.container&&l.loadingDeferred.resolve()}return delete a.innerTabsLoading,$.when(t.ready(),t.getResolveOrReject()).done((function(){if(t.deleteLoaderDeferred(),!bizagi.util.parseBoolean(e.validate)||t.validationController.performValidations()){["save","next","back","createnewcase","nextWithoutValidations"].includes(e.action)&&!t.isOfflineForm&&$(document).data("auto-save","");var a=t.getConfirmationStatus(r,e);a.hasConfirmation?(t.endLoading(),$.when(bizagi.showConfirmationBox(a.message,null,!1)).done((function(){t.preProcessButton(e)&&(t.triggerGlobalHandler("renderActionButton",e),$.when(t.submitForm(e)).done((function(){i.resolve()})).fail((function(){i.reject(arguments)})))})).fail((function(){i.reject()}))):t.preProcessButton(e)&&(t.triggerGlobalHandler("renderActionButton",e),$.when(t.submitForm(e)).done((function(){$(document).trigger("FORMACTION",e),i.resolve()})).fail((function(){i.reject(arguments)})))}else t.endLoading(),e.submitData?$.when(t.submitData()).done((function(){i.reject()})):i.reject(),t.validationController.expandNotificationBox();var n=t.getCustomHandler("afterFormButtonClick");n&&n(e)})),i.promise()},validateForm:function(){return this.validationController.clearValidationMessages(),this.validationController.performValidations()},saveForm:function(){var e=this;if(bizagi.util.isNativeMobileDevice()&&!this.allowOnlineActions())return $.when((function(){return null}));var t=e.collectRenderValuesForSubmit(),i=null;return t.deferreds&&(i=$.when.apply($,t.deferreds),delete t.deferreds),$.when(i).pipe((function(){e.startLoading();var i={action:"SAVE",data:t,idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,xpathContext:e.properties.xpathContext,idPageCache:e.properties.idPageCache,isOfflineForm:e.isOfflineForm||!1};return e.isOfflineForm&&(i.offlineType=e.params.offlineType),$.when(e.dataService.submitData(i)).always((function(){e.endLoading()}))}))},removeCaseSyncError:function(){if(this.removeSyncErrorOnSubmit)return this.removeSyncErrorOnSubmit=!1,"start"==("task"==this.params.offlineType?"task":"start")?this.dataService.removeStartCaseSyncError(this.params):this.dataService.removeTaskCaseSyncError(this.params)},submitForm:function(e){var t=this,i=$.Deferred();return $.when(t.isReadyToSave()).then((function(){t.isOfflineForm?$.when(t.removeCaseSyncError()).then((function(){return t.internalSubmitFormOffline(e)}),(function(){return t.internalSubmitFormOffline(e)})).then((function(){i.resolve()})).fail((function(){i.reject(arguments)})):$.when(t.internalSubmitForm(e)).done((function(){i.resolve()})).fail((function(){i.reject(arguments)}))})).fail((function(){t.endLoading(),bizagi.log("The form is not saved, no changes were found"),i.reject()})),i.promise()},checkWidgetsData:function(){},isComplexGatewayPainted:function(){return!1},getLastActionButton:function(){return this.lastActionButton},internalSubmitFormOffline:function(e){var t,i=this,r=$.Deferred();if(i.isOfflineForm&&i.properties&&!i.properties.idPageCache&&(i.properties.idPageCache=""),e.submitData||e.executeRule||e.save){t=i.collectRenderValuesForSubmit();var a=null;if(bizagi.loading.start(),e.executeRule&&(null==t&&(t={}),(a=i.dataService.executeButton({idRender:e.id,xpathContext:i.properties.xpathContext||"",idPageCache:i.properties.idPageCache,prepare:!0})).tag="executeRule_"+e.id),i.transitions){var n=[];if($.each(this.activeTransitions,(function(e,t){t&&n.push(e)})),0==bizagi.util.countProps(n))return bizagi.showMessageBox(bizagi.localization.getResource("render-widget-complexgateway-path"),bizagi.localization.getResource("render-widget-complexgateway-error"),"info",!1),i.endLoading(),""}var o=[],s=null;t&&t.deferreds&&(s=$.when.apply($,t.deferreds),o.push(s),delete t.deferreds);var l=[];a&&l.push(a),$.when.apply($,o).done((function(){$.when(i.dataService.submitData({action:e.action,data:t,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,idForm:i.properties.id,prepare:!0,transitions:n||"",idCase:i.params.idCase,idWorkitem:i.params.idWorkitem,isOfflineForm:i.isOfflineForm||!1,offlineType:i.params.offlineType||"",actions:l})).then((function(t){if(i.postProcessButton(t,e)){var a="task"!==i.params.offlineType&&"save"===e.action;if(i.online&&i.isOfflineFormsV2Supported&&!a){var n=new $.Deferred,o=$.extend({deferred:n},i.params);$(document).trigger("tryPushCase.offline",o)}i.isOfflineFormsV2Supported||$(document).trigger("tryPushData.offline"),$.when(n).then((function(t){if(bizagi.loading.stop(),e.routing)!i.online&&i.isOfflineFormsV2Supported?i.triggerHandler("routing",{offlineAction:e.action,idCase:i.params.idCase,idWorkitem:i.params.idWorkitem,buttonPropertiesAction:e.action,radNumber:i.params.radNumber}):(i.showToastOnSuccessSync&&(i.showToastOnSuccessSync=!1,bizagi.util.showMobileToast({type:"success",message:bizagi.localization.getResource("workportal-offline-sync-success")})),i.triggerHandler("routing",{idCase:t.IdCase,caseNumber:t.CaseNumber,buttonPropertiesAction:e.action}));else if(i.online||null!=t||(i.isOfflineRefreshWithEdition=!0),(e.refresh||t&&t.shouldRefresh)&&i.refreshForm(),i.showToastOnSuccessSync&&i.online)i.showToastOnSuccessSync=!1,bizagi.util.showMobileToast({type:"success",message:bizagi.localization.getResource("workportal-offline-save-and-sync-success")});else{var a=bizagi.localization.getResource("workportal-mobile-offline-form-successful","Saved");bizagi.util.showNotification({text:a,stop:!1,type:"success"})}r.resolve()})).fail((function(e){bizagi.loading.stop(),bizagi.util.recreateNativeButtons(i);var t=bizagi.localization.getResource("workportal-mobile-offline-sync-fail","Synchronization failed");if(bizagi.util.showNotification({text:t,stop:!1,type:"error"}),$.isArray(e)){var a,n=e,o="";$.each(n,(function(e,t){var r=i.validationToDisplayMessages(a,t.result.type,t.result.messages,o);a=r.bHasValidations,o=r.alertMessage})),a&&""!==o&&bizagi.modalError.show(o,"workportal-general-word-information",!1)}i.failHandler(e),r.reject(e)}))}})).fail((function(e){var t=bizagi.localization.getResource("workportal-mobile-offline-sync-fail","Synchronization failed");bizagi.util.showNotification({text:t,stop:!1,type:"error"}),r.reject(e)}))}))}},partialSubmitFormOffline:function(e){var t=$.Deferred();return $.when(this.dataService.submitData({action:"save",data:e,xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache,idForm:this.properties.id,prepare:!0,transitions:"",idCase:this.params.idCase,idWorkitem:this.params.idWorkitem,isOfflineForm:this.isOfflineForm||!1,offlineType:this.params.offlineType||"",actions:[]})).fail((function(e){var i=bizagi.localization.getResource("workportal-mobile-offline-form-fail","Not saved");bizagi.util.showNotification({text:i,stop:!1,type:"error"}),t.reject(e)})),t.promise()},internalSubmitForm:function(e){var t=this,i=$.Deferred(),r={};(e.submitData||e.executeRule||e.createnewcase||e.back)&&(r=t.collectRenderValuesForSubmit()),$.when(t.startLoading()).done((function(){$("html, body").animate({scrollTop:$(".ui-bizagi-loading-icon")},"slow")}));var a=null,n=null,o=null,s=null,l=null,d=[],c=null;if(e.executeRule&&(r.deferreds&&(c=$.when.apply($,r.deferreds),d.push(c),delete r.deferreds),(a=t.dataService.submitData({action:"SUBMITDATA",data:r,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,prepare:!0})).tag="submitData",s=t.prepareCheckpointAction(e.id),r={},(n=t.dataService.executeButton({idRender:e.id,xpathContext:t.properties.xpathContext||"",idPageCache:t.properties.idPageCache,prepare:!0})).tag="executeRule",l=t.prepareCommitAction(e.id)),e.next||e.back||e.save||e.createnewcase||e.nextWithoutValidations){if(t.transitions){var u=[];if($.each(this.activeTransitions,(function(e,t){t&&u.push(e)})),0==bizagi.util.countProps(u))return bizagi.showMessageBox(bizagi.localization.getResource("render-widget-complexgateway-path"),bizagi.localization.getResource("render-widget-complexgateway-error"),"info",!1),t.endLoading(),i.reject(),i.promise()}r&&r.deferreds&&(c=$.when.apply($,r.deferreds),d.push(c),delete r.deferreds),(o=t.dataService.submitData({action:t.getButtonAction(e.action),forcePlanCompletion:e.forcePlanCompletion,data:r,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,prepare:!0,transitions:u||"",contexttype:t.properties.contextType,surrogatekey:t.properties.surrogateKey})).tag="performAction"}var p=[];n&&(p.push(a),p.push(s),p.push(n),p.push(l)),o&&p.push(o),bizagi.chrono.initAndStart("submitForm-ajax");var h=new $.Deferred;return r&&r.deferreds?$.when.apply(this,r.deferreds).done((function(e){h.resolve(e)})).fail((function(){h.reject(),console.log("Error: It was not possible resolve async actions on form ")})):h.resolve(),d.push(h),$.when.apply($,d).done((function(){$.when(t.dataService.multiaction().execute({actions:p})).done((function(r){var a;bizagi.chrono.stop("submitForm-ajax"),t.endLoading();var n="";if($.each(r,(function(e,i){var r=t.validationToDisplayMessages(a,i.result.type,i.result.messages,n);a=r.bHasValidations,n=r.alertMessage})),a)""!==n&&bizagi.modalError.show(n,"workportal-general-word-information",!1),e.executeRule&&t.sendRollbackAction(e.id);else{if(!t.postProcessButton(r,e))return;e.refresh&&t.refreshForm(),e.routing&&(bizagi.jqxhrList.abortAll("rendering_"+t.dataService.guid),t.triggerHandler("routing",{idCase:t.params.idCase,routingDisabled:e.routingDisabled})),e.createnewcase&&r.length>0&&(bizagi.jqxhrList.abortAll("rendering_"+t.dataService.guid),t.triggerHandler("routing",{idCase:r[0].result.IdCase,caseNumber:r[0].result.CaseNumber}))}i.resolve()})).fail((function(r,a,n){e.executeRule&&t.sendRollbackAction(e.id),n&&n.error&&("WaitForCompletionPlanException"===n.error.errorType||"InvalidPlanStateException"===n.error.errorType||"CustomMessageException"===n.error.errorType)?(t.endLoading(),$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(n.error.message),null,!1)).then((function(){return $.when(t.internalSubmitForm($.extend({},e,{forcePlanCompletion:!0})))})).done((function(){i.resolve()})).fail((function(){i.reject()}))):(t.failHandler(n),i.reject(n))}))})),i.promise()},validationToDisplayMessages:function(e,t,i,r){return"validationMessages"==t&&(this.addValidationMessage(i),e=!0),"alertMessages"==t&&(r=""===r?i:r+"\n\n"+i,e=!0),{bHasValidations:e,alertMessage:r}},addValidationMessage:function(e,t,i,r,a,n){var o=this;if(bizagi.util.isNativeMobileDevice()&&!this.allowOnlineActions()&&this.clearValidationMessages(),!o.validationController){var s=o.getValidationsContainer();o.validationController=new bizagi.command.controllers.validation(o,void 0,s)}"string"==typeof e?o.validationController.showValidationMessage(e,t,i,r,n):$.each(e,(function(e,a){o.validationController.showValidationMessage(a,t,i,r,n)})),o.validationController.expandNotificationBox(a)},clearValidationMessages:function(e){this.validationController&&this.validationController.clearValidationMessages(e)},addErrorMessage:function(e){bizagi.util.isNativeMobileDevice()&&!this.allowOnlineActions()&&this.clearValidationMessages(),this.validationController&&(this.validationController.showErrorMessage(e),this.validationController.expandNotificationBox())},refreshForm:function(e){var t=this,i=t.properties,r=$.Deferred();(e=e||t.getFocus())&&!e.id&&(e={id:e});var a={idCase:t.params.idCase||"",idWorkitem:t.params.idWorkitem||"",idTask:t.params.idTask||"",focus:e,selectedTabs:t.getSelectedTabs(),selectedSection:t.getSelectedSection(),xpathContext:i.xpathContext,idPageCache:i.idPageCache,isRefresh:!0,contextType:t.getContextType()||"",action:t.getEndPointAction(),idStartScope:t.properties.idStartScope||""};return t.isOfflineRefreshWithEdition&&(a.isEdited=!0,t.isOfflineRefreshWithEdition=!1),t.startLoading(),$.when(t.triggerHandler("refresh",a)).done((function(){r.resolve()})).fail((function(){r.reject()})).always((function(){t.endLoading()})),r.promise()},getSelectedTabs:function(){for(var e=this.getElementsByType("tab"),t=$.map(e,(function(e){return{tab:e.properties.id,selected:e.activeTab}})),i={},r=0,a=t.length;r<a;r++)i[t[r].tab]=t[r].selected;return i},getSelectedSection:function(){return(this.getParams()||{}).selectedSection},getButtons:function(){},addSubmitAction:function(e,t){this.actionController.processInternalSubmitAction(e,t)},startLoading:function(){var e=this.renderFactory.getTemplate("form-waiting");if(!this.waitingOverlay||!this.waitingMessage)if(bizagi.util.isTabletDevice())this.waitingOverlay=$('<div class="ui-widget-overlay" />').appendTo("body",$(document)),this.waitingMessage=$.tmpl(e).appendTo("body",$(document));else{var t="sharepoint"===this.params.context,i=this.params.canvas;t&&(i=bizagi.util.scrollTop(i)).context||(i=$("body",$(document)));var r=this.getSize(),a=this.getOffset();r.height==$(window).height()&&(a.top=0),this.waitingOverlay=$('<div class="ui-widget-overlay" />').appendTo(i),this.waitingMessage=$.tmpl(e).appendTo(i),this.waitingOverlay.css({height:"100%",width:"100%","min-height":r.height,"min-width":r.width}),this.waitingMessage.css({top:a.top+Math.ceil((r.height-this.waitingMessage.outerHeight())/2)+"px",left:Math.ceil((r.width-this.waitingMessage.outerWidth())/2)+"px"}),i.css("position","relative")}},endLoading:function(){if(this.waitingOverlay&&this.waitingMessage){this.waitingOverlay.remove(),this.waitingMessage.remove(),this.waitingOverlay=null,this.waitingMessage=null;var e=this.params.canvas;null!=e&&e.css("position","")}},getFocusedElement:function(){return this.focus},setFocusedElement:function(e){this.focus=e},triggerGlobalHandler:function(e,t){return this.triggerHandler("globalHandler",{eventType:e,data:t})},failHandler:function(e){try{e=JSON.parse(e)}catch(e){}if(e&&e.length&&e.length>1&&(e=e[0]),e.error&&(e=e.error),e.error&&(e=e.error),"object"==_typeof(e)&&e.message)e="WaitForCompletionPlanException"===e.errorType||"InvalidPlanStateException"===e.errorType||"CustomMessageException"===e.errorType?bizagi.localization.getResource(e.message):e.message;else if("string"==typeof e)try{var t=JSON.parse(e);"WaitForCompletionPlanException"!==t.errorType&&"InvalidPlanStateException"!==t.errorType&&"CustomMessageException"!==e.errorType||(t.message=bizagi.localization.getResource(t.message)),e=t.message}catch(e){}this.addErrorMessage(e),this.endLoading()},resize:function(e){this.setSize(e)},setSize:function(e){this.size=e},getSize:function(){if(this.size)return this.size;var e=this.params.canvas?this.params.canvas:this.getFormContainer().container;return{width:e.width(),height:e.height()}},getOffset:function(){return this.getFormContainer().container.offset()},submitData:function(e){var t=this;if(!bizagi.util.isNativeMobileDevice()||this.allowOnlineActions()){var i=t.collectRenderValuesForSubmit(),r=bizagi.util.isOfflineForm({context:t});if(r&&t.properties&&!t.properties.idPageCache&&(t.properties.idPageCache=""),$.each(i,(function(e,i){var r=t.getRenders(e);$.each(r,(function(e,t){t.updateOriginalValue()}))})),!$.isEmptyObject(i)){var a=[],n=null,o=null;return i&&i.deferreds&&(n=$.when.apply($,i.deferreds),a.push(n),delete i.deferreds),o=r?t.dataService.submitData({action:t.isRefreshingAfterSync?"submitdata":"save",data:i,xpathContext:t.properties.xpathContext,contexttype:t.properties.contexttype||"",isOfflineForm:r,offlineType:t.params.offlineType,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem}):t.dataService.multiaction().submitData({action:"SUBMITDATA",data:i,idPageCache:t.properties.idPageCache,xpathContext:t.properties.xpathContext,contexttype:t.properties.contexttype||""}),$.when.apply($,a).then((function(){return $.when(o).fail((function(e){e=t.processFailMessage(e)}))}))}t.isOfflineRefreshWithEdition=!1}},executeRule:function(e){var t=this,i=t.properties,r=e.xpathContext,a=$.Deferred();return""!==i.xpathContext&&(r=""!==r?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeRule({idPageCache:i.idPageCache,rule:e.rule,xpathContext:r,contexttype:t.properties.contexttype||""})).done((function(e){var i=e&&e.type?e.type:"",r=t.getFormContainer();t.getFormContainer().clearValidationMessages({clearOnlyServer:!0}),["validationMessages","alertMessages"].includes(i)?("alertMessages"===i?bizagi.modalError&&bizagi.modalError.show(e.messages.join("\n\n"),"workportal-general-word-information",!1):r.addValidationMessage.apply(t,[e.messages,void 0,void 0,void 0,!1,"serverMessage"]),a.reject(e)):a.resolve(e)})).fail((function(e){e=t.processFailMessage(e),a.reject(e)})),a.promise()},executeInterface:function(e){var t=this,i=t.properties,r=e.xpathContext;return""!=i.xpathContext&&(r=""!=r?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeInterface({idPageCache:i.idPageCache,interface:e.interface,xpathContext:r,contexttype:t.properties.contexttype||""})).done((function(e){t.getFormContainer().clearValidationMessages(),e&&"validationMessages"==e.type&&t.getFormContainer().addValidationMessage(e.messages)})).fail((function(e){e=t.processFailMessage(e)}))},executeSAPConnector:function(e){var t=this,i=t.properties,r=e.xpathContext;return""!=i.xpathContext&&(r=""!=r?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeSAPConnector({idPageCache:i.idPageCache,guidsap:e.guidsap,xpathContext:r,contexttype:t.properties.contexttype||""})).done((function(e){t.getFormContainer().clearValidationMessages(),e&&"validationMessages"==e.type&&t.getFormContainer().addValidationMessage(e.messages)})).fail((function(e){e=t.processFailMessage(e)}))},executeConnector:function(e){var t=this,i=t.properties,r=e.xpathContext;return""!=i.xpathContext&&(r=""!=r?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeConnector({idPageCache:i.idPageCache,guidConnector:e.guidConnector,xpathContext:r,contexttype:t.properties.contexttype||""})).done((function(e){t.getFormContainer().clearValidationMessages(),e&&"validationMessages"==e.type&&t.getFormContainer().addValidationMessage(e.messages)})).fail((function(e){e=t.processFailMessage(e)}))},executePipeline:function(e){var t=this,i=t.properties,r=e.xpathContext;return""!=i.xpathContext&&(r=""!=r?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executePipeline({idPageCache:i.idPageCache,pipeline:e.pipeline,xpathContext:r,contexttype:t.properties.contexttype||""})).done((function(e){t.getFormContainer().clearValidationMessages(),e&&"validationMessages"==e.type&&t.getFormContainer().addValidationMessage(e.messages)})).fail((function(e){e=t.processFailMessage(e)}))},refreshActions:function(e){this.actionController.refreshActions(e)},tryToExecuteFunction:function(e){"execution"==this.getMode()&&this.actionController&&this.actionController.tryToExecuteFunction(e)},removeActions:function(){this.actionController.unbindActions()},collectRenderValuesForSubmit:function(e){var t=this;return e=e||{},t.collectRenderValues(e),$.each(e,(function(e,i){var r=t.getRenders(e);$.each(r,(function(e,t){t.updateOriginalValue()}))})),e},internalSubmitOnChange:function(e){var t=this,i=(e=e||{}).properties,r=new $.Deferred,a=e.data||{},n=void 0===e.bRefreshForm||e.bRefreshForm;(e.notCollect?e.notCollect:void 0)&&!$.isEmptyObject(a)||t.collectRenderValuesForSubmit(a),t.startLoading();var o=null;return a.deferreds&&(o=$.when.apply($,a.deferreds),delete a.deferreds),$.when(o).then((function(){t.dataService.multiaction().submitData({action:"SUBMITONCHANGE",data:a,idRender:i.id,xpath:i.xpath,xpathContext:t.properties.xpathContext,idPageCache:i.idPageCache,contexttype:i.contexttype}).done((function(e){if(t.cancelPreviousRequest(),t.endLoading(),e&&"validationMessages"==e.type)"function"==typeof t.clearValidationMessages&&t.clearValidationMessages(),t.addValidationMessage(e.messages),r.resolve();else if(n){var a={id:i.id,xpath:i.xpath};void 0!==i.idCase&&$.extend(a,{idCaseObject:bizagi.cache.idCaseObject}),e.IdScope&&(t.properties.idStartScope=e.IdScope),$.when(t.refreshForm(a)).done((function(){r.resolve()})).fail((function(){r.resolve()}))}else r.resolve()})).fail((function(e){t.endLoading();var i="object"==_typeof(e)?e.responseText?JSON.parse(e.responseText):e:{},a=i.message||e,n=i.type||"error";["not-processed","not-shown"].includes(n)||(t.validationController.clearValidationMessages(),"alert"===i.type?t.validationController.showAlertMessage(a):t.validationController.showErrorMessage(a)),r.resolve()}))})),r.promise()},cancelPreviousRequest:function(){if(bizagi.multiactionConnection&&bizagi.multiactionConnection.length)for(var e,t=bizagi.multiactionConnection.length,i=0;i<t;i++)(e=bizagi.multiactionConnection.pop())&&e.abort&&(bizagi.showErrorAlertDialog=!1,e.abort())},prepareCheckpointAction:function(e){var t=this.dataService.sendCheckpoint({url:this.properties.checkpointUrl,idRender:e,xpath:"",xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache,prepare:!0});return t.tag="checkpoint",t},prepareCommitAction:function(e){var t=this.dataService.commitLinkForm({url:this.properties.commitUrl,idRender:e,xpath:"",xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache,prepare:!0});return t.tag="commit",t},sendRollbackAction:function(e){this.dataService.rollbackLinkForm({url:this.properties.rollbackUrl,idRender:e,xpath:"",xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache})},dispose:function(){var e=this;e.endLoading();var t=setTimeout((function(){e.params&&delete e.params.canvas,delete e.params,delete e.control,e.validationController&&(e.unbind("rendervalidate"),delete e.validationController),e.actionController&&(e.actionController.unbindActions(),delete e.actionController),clearTimeout(t)}),bizagi.override.disposeTime||50);e._super()},getButton:function(e){return $(".ui-bizagi-button[data-id='"+e+"']",this.container)},getFloatingButton:function(e){return $("li[data-id='"+e+"']",this.container)},propagateExternalEvents:function(e){$(".bz-overflow-menu")&&$(document).trigger("click.overflow"),$(".jquery-image-zoom")&&"block"==$(".jquery-image-zoom").css("display")&&$("div.jquery-image-zoom a").click()},getButtonAction:function(e){return this.allowValidateAndSaveAction&&"validate"===e?"save":e},isConnected:function(){return!0},configureNetworkHandlers:function(){this.online=bizagi.util.isConnected(),this.isOfflineForm&&bizagi.util.isMobileDevice()&&"debug"===(""+BIZAGI_ENVIRONMENT).toLowerCase()&&(this.online=this.getParams().online,console.log("CONNECTED: ",this.online)),(bizagi.util.isNativeMobileDevice()||bizagi.util.isMobileDevice()&&"debug"===(""+BIZAGI_ENVIRONMENT).toLowerCase())&&($(document).off("online.form"),$(document).on("online.form",this.handleConnectionChange.bind(this)),$(document).off("offline.form"),$(document).on("offline.form",this.handleConnectionChange.bind(this)),$(document).off("offline-notify-form-sync-event"),$(document).on("offline-notify-form-sync-event",this.handleOfflineSyncEvent.bind(this)))},handleConnectionChange:function(e){var t=this.getFormContainer();bizagi.util.isMobileDevice()&&"debug"===(""+BIZAGI_ENVIRONMENT).toLowerCase()?this.online="online"===e.type:this.online=bizagi.util.isConnected(),"offline"===e.type&&t.triggerHandler("offlineForm"),"online"===e.type&&t.triggerHandler("onlineForm")},handleOfflineSyncEvent:function(e,t){var i=this,r=i.params||{};if(!r.hasSyncError){var a=r.idCase+"-"+r.idWorkitem;switch(t.type){case"download-form-success":var n=t.idCase+"-"+t.idWorkitem;a===n&&(console.log("Form downloaded successfully. It will be refreshed",t),$.when(i.dataService.database.validateLocalDataForTaskExists(n).then((function(e){!0===e&&(i.isOfflineRefreshWithEdition=!0),$.when(i.refreshForm(null,!1)).then((function(){o(!1)}))}))));break;case"push-tasks-started":null!=t.tasks&&t.tasks[a]&&o(!0);break;case"push-tasks-error":o(!1),null!=i.validationController&&(i.validationController.clearValidationMessages(),i.validationController.showErrorMessage(t.message));break;case"fetch-tasks-started":null!=t.tasks&&t.tasks[a]&&o(!0);break;case"download-finished":case"download-error":o(!1);break;default:console.warn("Event hast not implementation in bizagi.rendering.form - handleOfflineSyncEvent",t.type,t)}}function o(e){if(e?!(!0===i.isSyncLoaderRunning):!0===i.isSyncLoaderRunning){i.isSyncLoaderRunning=e;for(var t=0;t<3;t++)e?bizagi.loading.start():bizagi.loading.stop()}}},allowOnlineActions:function(){return void 0===this.online||(this.online||!this.online&&this.isOfflineForm)},processQuickButton:function(e){var t=this,i=t.buttons.find((function(t){return t.ordinal==e}));i&&(t.startLoading(),t.lastActionButton=i,"next"===i.action&&(i.routingDisabled=t.isRoutingDisabled),setTimeout((function(){$.when(t.processButton(i)).always((function(){t.processDefer=void 0,t.endLoading()}))}),100))},hasQuickActions:function(e,t){return!!t&&(e.buttons||[]).some((function(e){var t=e.button.properties;return t&&"quickactions"===t.type}))},getValidationsContainer:function(e){return(void 0!==e?e:this).container},getConfirmationStatus:function(e,t){var i=bizagi.util.parseBoolean(t.needsUserConfirmation)||!1,r=t.userConfirmationMessage||"",a=bizagi.util.parseBoolean(e.needsUserConfirmation)&&bizagi.util.parseBoolean(t.routing),n=e.userConfirmationMessage||"";return{hasConfirmation:i||a,message:i?r:n}},saveWorkInProgress:function(){var e=this.collectRenderValuesForSubmit();return bizagi.util.isEmpty(e)?$.Deferred().resolve(void 0).promise():this.dataService.submitData({action:"submitdata",data:e,xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache,idForm:this.properties.id,prepare:!0,idCase:this.params.idCase,idWorkitem:this.params.idWorkitem,isOfflineForm:this.isOfflineForm||!1,offlineType:this.params.offlineType||"",actions:[]})},isStartForm:function(){var e=this.getFormContainer(),t=e&&e.properties&&e.properties.formtype||"";return/startform/i.test(t)}}),$.Class.extend("bizagi.rendering.formTemplate",{init:function(e){this._super(e),e.paramsRender&&e.paramsRender.contextEvent&&(self.contextEvent=e.paramsRender.contextEvent)},processTemplate:function(e,t){var i=e.replace(/\{\{(((repeater)\s*(\{["':,-\[\]\w\s]*\}))|([\/repeater]+:item)|(\/repeater)|(repeater)|(separator))\}\}/g,"");return i=(i=i.replace(/\{\{([\w:]*)\s*(\{["':,-\[\]\w\s]*\})\}\}/g,(function(e,i,r,a,n){var o=JSON.parse(r);return t[o.id]||""}))).replace(/{{([\w:]*)\s*}}/g,(function(){return""}))},renderContainer:function(){var e=this,t=e.getRenderByType("layout"),i=t.length>0?t[0]:{},r="function"==typeof i.getTemplate?i.getTemplate():"",a="function"==typeof i.getCss?i.getCss():"",n=e.getMode(),o=e.properties.layoutguid||Math.guid(),s={};return i.children&&$.each(i.children,(function(t,i){if("execution"!=n||"layoutPlaceholder"!=i.properties.type){var r=i.getElementType();r==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(s[i.properties.id]=i.renderElement()),r==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(s[i.properties.id]=i.renderContainerHtml()),e.childrenHash[i.properties.uniqueId]=i}})),bizagi.util.loadStyle(a,o),e.processTemplate(r,s)},getContextEvent:function(){return self.contextEvent}}),$.Class.extend("bizagi.rendering.layout",{},{getTemplate:function(){var e=this.getMode(),t=this.properties.html||"";return"design"==e&&t&&(t="<div class='bz-design-template'>"+t+"</div>"),bizagi.util.stripslashes(t)},getCss:function(){var e=this.properties.css||"";return"design"==this.getMode()&&(e=e&&e.desktop),bizagi.util.stripslashes(e)},postRenderContainer:function(e){var t=this.getMode();this.renderingDeferred&&this.renderingDeferred.resolve(),this.container=e,this.executeChildrenPostRender(e),"execution"==t&&this.configureHandlers(),"design"==t&&this.configureDesignView(),"layout"==t&&(this.configureDesignView(),this.configureLayoutView())}}),$.Class.extend("bizagi.rendering.accordion",{},{initializeData:function(e){this._super(e),$.each(this.children,(function(e,t){t.properties.ordinal=e}))},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("accordion"),i=$.fasttmpl(t,{uniqueId:e.uniqueId});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())}}),$.Class.extend("bizagi.rendering.accordionItem",{},{renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("accordionItem"),i=$.fasttmpl(t,{id:e.id,ordinal:e.ordinal,displayName:e.displayName,orientation:e.orientation,uniqueId:e.uniqueId});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())},activate:function(){this.active=!0},getFocus:function(){var e=this._super();return bizagi.util.isEmpty(e)&&this.active&&(e=this.properties.id),e}}),$.Class.extend("bizagi.rendering.collectionnavigator",{},{initializeData:function(e){this._super(e);var t=this.properties;t.allowAdd=void 0===t.allowAdd||bizagi.util.parseBoolean(t.allowAdd),t.withAddForm=t.withAddForm&&t.allowAdd,t.allowEdit=void 0===t.allowEdit||bizagi.util.parseBoolean(t.allowEdit),t.withEditForm=t.withEditForm&&t.allowEdit,t.allowDetail=void 0!==t.allowDetail&&bizagi.util.parseBoolean(t.allowDetail),t.inlineAdd=void 0===t.inlineAdd||bizagi.util.parseBoolean(t.inlineAdd),t.inlineAdd=t.inlineAdd&&t.allowAdd,t.inlineEdit=void 0===t.inlineEdit||bizagi.util.parseBoolean(t.inlineEdit),t.inlineEdit=t.inlineEdit&&t.allowEdit,t.allowDelete=void 0===t.allowDelete||bizagi.util.parseBoolean(t.allowDelete),this.orientation=this.properties.orientation||"ltr",this.data=this.properties.data,this.keys=this.data?this.getKeys(this.data.rows):[],this.pointer=0,this.totalRows=0,this.inlineAddRecords=[],this.data&&(this.totalRows=this.data.rows.length)},getKeys:function(e){for(var t=[],i=0,r=(e=e||[]).length;i<r;i++){var a=e[i];t.push(a[0])}return t},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("collectionnavigator"),i=this.getMode(),r=$.fasttmpl(t,{uniqueId:e.uniqueId,displayName:e.displayName?e.displayName:"",id:e.id,guid:e.guid,showPreview:this.showPreview(),mode:i,orientation:this.getFormContainer().properties.orientation});return r=this.drawControls(r)},renderReadOnly:function(){return this.renderControl()},drawControls:function(e){},drawActions:function(e){},drawControl:function(e){},drawForms:function(e){},drawPreview:function(){var e="execution"===this.getMode()?"collectionnavigator-execution":"collectionnavigator-preview",t=this.renderFactory.getTemplate(e),i=$.tmpl(t);this.canvas.append(i)},hasData:function(){return this.getTotalRows()>0},getRow:function(){return this.keys[this.pointer]},getNextRow:function(){return this.getTotalRows()>this.pointer+1&&(this.pointer+=1),this.getRow()},getPreviousRow:function(){return this.pointer>0&&(this.pointer-=1),this.getRow()},getFirstRow:function(){return this.pointer=0,this.getRow()},getLastRow:function(){return this.pointer=this.keys.length-1,this.getRow()},getTotalRows:function(){return this.keys.length},getIndexes:function(){return this.properties.data.rows},setPointer:function(e){this.pointer=e-1},isTherePendingInlineRow:function(){return this.inlineAddRecords.length>0},addKey:function(e){this.keys.push(e)},removeKey:function(){var e=this.pointer;if(e>=0){this.keys.splice(e,1);var t=this.getTotalRows();t>0&&e>=t&&this.setPointer(t)}},showPreview:function(){var e=this.getMode(),t=this.properties;return"execution"==e?!this.hasData():!bizagi.util.parseBoolean(t.navigationform)},getParameters:function(e){var t={},i=this.properties,r=i.xpath+"[id="+e.id+"]";return t.idRender=i.id,t.recordXPath=r,t.xpathContext=i.xpathContext,t.idPageCache=i.idPageCache,t.requestedForm=e.requestedForm,t.contextType=i.contextType||i.contexttype,t.url=e.url,t.editable=e.editable,i.orientation,t},submitAddRequest:function(){var e=this,t=e.properties;return e.dataService.addGridRecord({url:t.addUrl,idRender:t.id,xpath:t.xpath,xpathContext:t.xpathContext,contexttype:t.contextType||t.contexttype,idPageCache:t.idPageCache,orientation:t.orientation||"ltr"}).pipe((function(t){return e.properties.temporalRecord=!0,t.idEntity})).promise()},submitEditRequest:function(e){var t=this.properties,i=t.xpath+"[id="+e+"]";return this.dataService.editGridRecord({url:t.editUrl,idRender:t.id,xpath:i,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType||t.contexttype||"",orientation:t.orientation||"ltr"})},submitDeleteRequest:function(e){var t=this,i=t.properties,r=i.xpath+"[id="+e+"]";return t.dataService.deleteGridRecord({url:i.deleteUrl,idRender:i.id,xpath:r,xpathContext:i.xpathContext,idPageCache:i.idPageCache,contexttype:i.contextType||i.contexttype}).pipe((function(e){if("validationMessages"==e.type){var i=t.getFormContainer(),r=e.messages.join(" ");i.failHandler({message:r})}return e}))},submitSaveRequest:function(e,t){var i=this,r=i.properties,a=$.Deferred(),n=r.xpathContext.length>0?r.xpathContext+"."+r.xpath+"[id="+e+"]":r.xpath+"[id="+e+"]",o=null;return t.deferreds&&(o=$.when.apply($,t.deferreds),delete t.deferreds),$.when(o).then((function(){!bizagi.util.isEmpty(t)||i.properties.temporalRecord?(t.idPageCache=t.idPageCache||i.form.getPageCache(),i.dataService.saveGridRecord({url:r.saveUrl,idRender:r.id,xpath:r.xpath,xpathContext:n,contexttype:r.contextType||r.contexttype||"",submitData:t}).done((function(e){delete i.properties.temporalRecord,a.resolve(e)})).fail((function(e){var t=i.getFormContainer(),r=e.responseText?e.responseText:"string"==typeof e?e:e.toString();if("string"==typeof r)try{r=JSON.parse(r).message}catch(e){r=(r=r.match(/"message":(.*)",/)[0]).substr(11,r.length-13)}else r.message||(r=e);t.validateForm(),t.clearValidationMessages(),t.addValidationMessage(r)}))):a.resolve()})),a.promise()},submitRollbackRequest:function(e){var t=this.properties;return this.dataService.rollbackGridAction({url:t.rollbackUrl,idRender:t.id,xpath:t.xpath,xpathContext:t.xpathContext,idPageCache:e.idPageCache,contexttype:this.properties.contexttype||""})},getRemoteData:function(e){var t=this.properties;return e=e||{},$.extend(e,{url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,contexttype:t.contextType||t.contexttype,idPageCache:t.idPageCache}),this.dataService.getData(e)},isValid:function(e){var t=this.form;return void 0!==t&&this.totalRows>0&&(t.children||[]).forEach((function(t){if(t.properties.visible)if(t.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)t.isValid(e);else if(t.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&!t.isValid(e)){var i=e[e.length-1];e[e.length-1]=$.extend(i,{id:t.properties.id})}})),0===e.length},validateControls:function(e){return!!this.form&&this.form.validationController.performValidations(e)}}),$.Class.extend("bizagi.rendering.group",{},{initializeData:function(e){this._super(e);var t=this.properties;t.helpText=t.helpText||t.displayName,t.cssclass=t.cssclass||"cssClassContainer",t.collapse=!(void 0===t.collapse||!bizagi.util.parseBoolean(t.collapse))},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("group");this.expandedIcon=this.getExpandedIcon(),this.collapsedIcon=this.getCollapsedIcon();var i=$.fasttmpl(t,{expandedClassIcon:this.expandedIcon,displayName:e.displayName,editable:e.editable,orientation:e.orientation,uniqueId:e.uniqueId,collapse:e.collapse,isDesign:"execution"!==this.getMode(),messageValidation:e.messageValidation,cssclass:e.cssclass,guid:e.guid});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())},getExpandedIcon:function(){},getCollapsedIcon:function(){},toogleContainer:function(e,t){}}),$.Class.extend("bizagi.rendering.section",{},{initializeData:function(e){this._super(e);var t=this.properties;t.helpText=t.helpText||t.displayName,t.displayAs=t.displayAs||"section"},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("section-header"),i=$.fasttmpl(t,{displayName:e.displayName,editable:e.editable,orientation:e.orientation,uniqueId:e.uniqueId,isDesign:"execution"!==this.getMode(),messageValidation:e.messageValidation,guid:e.guid});return this.sectionContent=$(this.renderSectionContent())[0],i},renderSectionContent:function(){},getBreadcrumb:function(){for(var e=this,t=[];e;){var i=e.properties||{},r=e.params||{};if("section"===i.type){var a=i.displayName?i.displayName:"";t.unshift(a)}else"form"===r.type&&t.unshift(this.getResourceByKey("render-section-breadcrumb-main-form","Main form"));e=e.parent}return t},getParentDisplayName:function(){var e=this.getSectionParent(this.parent);return"form"==e.properties.type?e.properties.formtype&&"startform"==e.properties.formtype?e.params&&e.params.originalParams&&e.params.originalParams.displayName?e.params.originalParams.displayName:"":e.properties.displayName||e.params.displayName||e.params.radNumber||e.params.idCase:e.properties.displayName||""},getSectionParent:function(e){return"section"!==e.properties.type&&e.parent?this.getSectionParent(e.parent):e},getSectionOrientationRTL:function(e){return!(e&&e.properties&&e.properties.orientation&&"ltr"===e.properties.orientation)&&(!!(e&&e.properties&&e.properties.orientation&&"rtl"===e.properties.orientation)||!!e.parent&&this.getSectionOrientationRTL(e.parent))}}),$.Class.extend("bizagi.rendering.horizontal",{},{renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("horizontal"),i=$.fasttmpl(t,{uniqueId:e.uniqueId});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())}}),$.Class.extend("bizagi.rendering.panel",{},{initializeData:function(e){this._super(e);var t=this.properties;(t.displayName=t.displayName||"","nestedForm"==t.type)&&(this.getFormContainer().rendersById[t.idForm]=this)},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("panel"),i=$.fasttmpl(t,{displayName:e.displayName,loading:e.loading,message:e.message,orientation:e.orientation,uniqueId:e.uniqueId,cssClass:e.cssclass});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())},postRenderContainer:function(e){var t=this.properties;t.height&&e.height(t.height),this._super(e)}}),$.Class.extend("bizagi.rendering.contentPanel",{},{initializeData:function(e){this._super(e);var t=this.properties;t.displayName=t.displayName||""},renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("contentPanel"),i=$.fasttmpl(t,{displayName:e.displayName,mode:this.getMode(),uniqueId:e.uniqueId,isDesign:"design"===this.getMode(),messageValidation:e.messageValidation,cssClass:e.cssclass,guid:e.guid});return i=this.replaceChildrenHtml(i,this.renderChildrenHtml())},postRenderContainer:function(e){this._super(e)}}),$.Class.extend("bizagi.rendering.searchForm",{},{renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("searchForm");"entity"!==e.contexttype&&this.parent&&(e.contexttype="function"==typeof this.parent.getContextType?this.parent.getContextType():"");var i=$.fasttmpl(t,{displayName:e.displayName,uniqueId:e.uniqueId});return i=(i=this.replaceChildrenHtml(i,this.renderChildrenHtml())).replaceFirstWithoutPatterns("{{result}}",this.renderResult())},performSearch:function(e){this.properties.searchParams=e,this.submitSearch()},submitSearch:function(){this.refreshResults()},ready:function(){return this.parent.ready()},getRemoteData:function(e){var t=this,i=t.properties,r=new $.Deferred,a=t.collectSearchValues();return bizagi.util.isMapEmpty(a)?(bizagi.showMessageBox(this.getResource("render-search-advanced-no-filters"),this.getResource("render-form-dialog-box-search"),"error"),null):(e.rows=i.searchParams&&i.searchParams.maxRecords&&i.searchParams.maxRecords>0?i.searchParams.maxRecords:e.rows,i.searchParams&&void 0!==i.searchParams.maxRows&&(e.rows=i.searchParams.maxRows||e.rows),t.dataService.submitSearch($.extend(e,{url:i.dataUrl,idRender:i.idRender,idPageCache:i.idPageCache,idSearchForm:i.id,allowFullSearch:i.searchParams.allowFullSearch?i.searchParams.allowFullSearch:null,maxRecords:i.searchParams.maxRecords>0?i.searchParams.maxRecords:null,criteria:a})).done((function(e){i.page=e.page,i.records=e.records,i.totalPages=e.totalPages||0,e.records>1e4?(i.deviceMaxRecordsExceeded=!0,e.deviceMaxRecordsExceeded=!0):delete i.deviceMaxRecordsExceeded,r.resolve(e),t.onSearchFinished()})).fail((function(e){if(bizagi.showErrorAlertDialog=!1,e.responseText)try{var t=JSON.parse(e.responseText).message;bizagi.showMessageBox(t,"","error")}catch(e){}r.reject()})),r.promise())},collectSearchValues:function(){var e={};this.collectRenderValues(e);var t=[];for(key in e){var i=key,r=e[key],a=this.getCriteriaOperation(this.getRender(i)),n={};bizagi.util.isEmpty(r)||(n.xpath=i,n.value=r,n.operation=a,t.push(n))}return t},getCriteriaOperation:function(e){var t=this.properties,i="EQUALS";return"15"==e.properties.dataType&&(void 0!==e.properties.typeSearch&&"approx"!==e.properties.typeSearch||(i=t.allowFullSearch?"FULLLIKE":"LIKE")),i},renderResult:function(){},refreshResults:function(){},parseAdditionalProperties:function(e){return 1==e||2==e||3==e||4==e||6==e||7==e||10==e||11==e?{type:"columnNumber"}:29==e?{type:"columnNumberScientificNotation"}:8==e?{type:"columnMoney"}:12==e||13==e?{type:"columnDate"}:5==e?{type:"columnBoolean"}:{type:"columnText"}},onSearchFinished:function(){}}),$.Class.extend("bizagi.rendering.tab",{},{initializeData:function(e){this._super(e);var t=this.properties;t.helpText=t.helpText||t.displayName,t.cssclass=t.cssclass||""},renderContainer:function(){for(var e=this.properties,t=$.map(this.children,(function(e,t){return e.properties.counter=t,e.properties.tooltip=e.properties.tooltip||e.properties.displayName||"",e.properties})),i=this.renderFactory.getTemplate("tab"),r=this.getMode(),a=$.fasttmpl(i,{id:e.id,tabs:t,mode:r,isDesign:"execution"!==this.getMode(),editable:e.editable,tabOrientation:e.orientation,uniqueId:e.uniqueId,cssclass:e.cssclass}),n=this.activeTab=this.getActiveTab(),o=0,s=this.children.length;o<s;o++)this.children[o].properties.loadOnDemand=o!=n;return a=this.replaceChildrenHtml(a,this.renderChildrenHtml())},getActiveTab:function(){var e=this.properties,t=this.getFormContainer().getParams();"execution"===this.getMode()&&!t.isRefresh&&e.activeTab&&this.getFormContainer().setFocusedElement(e.activeTab);var i=t&&t.selectedTabs?t.selectedTabs:{};if(i[this.properties.id]>=0)return i[this.properties.id];for(var r=0,a=this.children.length;r<a;r++)if(this.children[r].containsFocusedElement())return r;return 0},setActiveTab:function(e){if(this.triggerHandler("selected",{index:e,tab:this.children[e]}),this.children[e]){var t=this.getFormContainer();this.children[e].activate(),this.activeTab=e;var i={};i[this.children[e].parent.properties.id]=e,t.setParam("selectedTabs",i)}}}),$.Class.extend("bizagi.rendering.tabItem",{},{renderContainer:function(){var e=this.properties,t=this.renderFactory.getTemplate("tabItem"),i=$.fasttmpl(t,{id:e.id,uniqueId:e.uniqueId,counter:e.counter,tabOrientation:e.orientation,isDesign:"execution"!==this.getMode()});return i=this.renderTabContent(i)},renderTabContent:function(e){return this.replaceChildrenHtml(e,this.renderChildrenHtml())},activate:function(){this.active=!0},getFocus:function(){var e=this._super();return bizagi.util.isEmpty(e)&&this.active&&(e=this.properties.id),e},containsFocusedElement:function(){var e=this.getFormContainer().getFocusedElement();if(e){if(e.xpath){var t=this.getFormContainer().getRenders(e.xpath);$.each(t,(function(t,r){r.properties.id==e.id&&r.properties.editable&&(i=r)}))}else var i=this.getFormContainer().getContainer(e)||this.getFormContainer().getRenderById(e);if(i)for(;i.parent;){if(i.properties.id==this.properties.id||i.parent.properties.id==this.properties.id)return!0;i=i.parent}}return!1}}),$.Class.extend("bizagi.rendering.nestedForm",{},{}),$.Class.extend("bizagi.rendering.combo",{},{initializeData:function(e){this._super(e);var t=this.properties;t.hasLocalData=t.data||!1,t.value=t.value&&t.value.length>0?t.value[0]:t.defaultValue&&t.defaultValue.length>0?t.defaultValue[0]:null,void 0===t.enableTyping&&(t.enableTyping=!0),t.value&&void 0===t.value.id&&(t.value=null),this.value=t.value,t.hasLocalData&&(t.data=this.complementData(t.data)),t.loadOnDemand=!1},renderControl:function(){var e={},t=bizagi.util.normalizeType(this.properties.type);if(this.isDependant&&this.properties&&/^cascadingcombo$/i.test(t)&&this.getParentCombo){var i=this.getParentCombo().getValue();i&&i.id&&(e[this.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]=i.id)}return this.renderCombo(e)},renderCombo:function(e){var t=this;if(t.properties.loadOnDemand)return t.renderComboTemplate();var i=new $.Deferred,r=t.getData(e);return $.when(r).done((function(e){var r=t.renderComboTemplate(e);t.properties.data=e,i.resolve(r)})).fail((function(e){var r=t.renderComboTemplate({});i.resolve(r)})),i.promise()},renderComboTemplate:function(e){var t=this.properties,i=this.renderFactory.getTemplate(this.getTemplateName()),r=bizagi.override.emptyLabelForCombo||this.getResource("render-combo-empty-selection"),a=t.value?"":r;return e=e||this.properties.data||{},"columnCombo"!==this.properties.type||""!==a||"object"!==_typeof(t.value)||""!==t.value.id||""!==t.value.value&&t.value.value!==this.getResource("render-combo-empty-value")||(a=this.getResource("render-combo-empty-selection")),$.fasttmpl(i,$.extend(this.getTemplateParams(),{id:t.id,xpath:t.xpath,unique:bizagi.util.randomNumber(1e4,1e6),idPageCache:t.idPageCache,items:e,align:t.valueAlign,value:a,editable:t.editable}))},postRenderReadOnly:function(){this._super();var e=this.getValue(),t=this.getControl();this.control&&this.control.parent()&&this.control.parent().addClass("ui-bizagi-noneditable-"+this.properties.displayType),e?(null!=e.value&&"boolean"==typeof e.value&&(!0===bizagi.util.parseBoolean(e.value)?e.value=this.getResource("render-boolean-yes"):0==bizagi.util.parseBoolean(e.value)&&(e.value=this.getResource("render-boolean-no"))),this.getResource("render-combo-empty-value")===e.value||this.getResource("render-combo-empty-selection")===e.value?t.text(""):t.html("<label class='readonly-control'>"+this.formatItem(e.value)+"</label>")):t.text("")},getTemplateName:function(){return"combo"},showEmpty:function(){return!0},showCurrentData:function(){return!0},getData:function(e){var t=this,i=t.properties,r=new $.Deferred,a=t.getMode(),n=bizagi.util.isOfflineForm({context:t});if("execution"!==a)return t.getDummyData();if(i.hasLocalData||n)r.resolve(i.data);else{var o=bizagi.util.normalizeType(i.type);i.remoteDataLoaded&&!/^cascadingcombo$/i.test(o)?r.resolve(i.data):t.dataService.multiaction().getData({url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,extra:e,contexttype:t.properties.contexttype||null}).done((function(e){i.recalculate||(i.remoteDataLoaded=!0),i.data=t.complementData(e),r.resolve(i.data)})).fail((function(e){var i=!0,a=t.getFormContainer();if(bizagi.util.isNativeMobileDevice()&&void 0!==a&&(i=a.allowOnlineActions()),"not-processed"!==e.type||!i){var n=t.properties.displayName+": ";if("string"==typeof e)var o=JSON&&JSON.parse(e)||$.parseJSON(e);else o=e;n+=o.message,a.addValidationMessage(n),r.reject(e)}}))}return r.promise()},getDummyData:function(){var e=this.properties;return e.data?e.data:(e.data=[],e.data=this.complementData(e.data),e.data.push({id:"",value:"Item 1"}),e.data.push({id:"",value:"Item 2"}),e.data)},resetData:function(){var e=this.properties;e.hasLocalData=!1,e.data=null,e.remoteDataLoaded=!1},getDisplayValue:function(){if(this.combo&&this.combo.length>0)return this.getSelectedValue();var e="",t=this.getValue();return t&&(e=this.formatItem(t.value)),e},getSelectedValue:function(){},getTemplateParams:function(){return{}},formatItem:function(e){if(null!=e){if($.isArray(e)){for(var t=0,i=e.length;t<i;t++)null!=e[t]&&"boolean"==typeof e[t]&&(!0===bizagi.util.parseBoolean(e[t])?e[t]=this.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e[t])&&(e[t]=this.getResource("render-boolean-no")));return e.join(" - ")}return e}return""},collectData:function(e){var t=this.properties,i=t.xpath,r=this.getValue();this.controlValueIsChanged()&&(bizagi.util.isEmpty(i)||null==r||("object"!==_typeof(r)||void 0!==r.id&&""!==r.id?e[t.xpath]=void 0!==r.id?r.id:"":e[t.xpath]=""))},controlValueIsChanged:function(){var e=this.properties,t=this.getValue(),i=e.originalValue,r=e.defaultValue,a=!0;return $.forceCollectData?a:(t=t&&void 0!==t.length?t[0]:t,i=i&&void 0!==i.length?i[0]:i,r=r&&void 0!==r.length?r[0]:r,t=t&&void 0!==t.id?t.id:t,i=i&&void 0!==i.id?i.id:i,a=void 0!==(r=r&&void 0!==r.id?r.id:r)?r!=i||r!=t:t!=i)},parseAdditionalValues:function(e){var t=this;return $.map(e,(function(e){var i=e.value?t.formatItem(e.value):e,r={id:e.id,value:i};return e.hidden&&(r.hidden=!0),e}))},complementData:function(e){var t=this,i=t.properties,r=!1;if($.each(e,(function(e,a){void 0!==a.value&&null!==a.value?(a.value=t.formatItem(a.value),i.value&&a.id==i.value.id&&(r=!0)):a.value=""})),t.showEmpty()){for(var a=!1,n=0,o=e.length;n<o;n++)if(""===e[n].id){a=!0;break}if(!a){var s=bizagi.override.emptyLabelForCombo||bizagi.localization.getResource("render-combo-empty-value");e.unshift({id:"",value:s})}}return i.value&&!r&&t.showCurrentData()&&e.unshift({id:i.value.id,value:i.value.value,hidden:!0}),t.parseAdditionalValues(e)},hasValue:function(){var e=this.getValue();return!bizagi.util.isEmpty(e)&&("[object Object]"!==Object.prototype.toString.apply(e)||!bizagi.util.isEmpty(e.id)&&0!=e.id)},cleanData:function(){var e={id:"",label:""};this.setDisplayValue(e),this.setValue(e,!1)},beforeToRefresh:function(){this.column&&!this.column.comboData&&this.getData()},isExtraItem:function(){var e=(this.value||{}).value||"";return""===e||e===this.getResource("render-combo-empty-selection")||e===this.getResource("render-combo-empty-value")},escapeValue:function(e){return bizagi.util.isString(e)?e.replaceAll("<","&lt;").replaceAll(">","&gt;"):e},mapValue:function(e){return e&&e.fromAction?{id:e.value,value:e.label,label:e.label}:e},preprocessValue:function(e){var t=this;if(null==e)return e;var i={id:"",value:void 0};if(e.fromAction&&(e={id:e.value,value:e.label}),"number"==typeof e||"string"==typeof e){i.id="string"==typeof e?Number(e):e;var r=t.findDataValueById(i.id);i.value=r?r.value:""}else if("object"===_typeof(e)){if(void 0!==e.id&&null!==e.id&&("string"==typeof e.id&&""!==e.id?(i.id=Number(e.id),isNaN(i.id)&&(i.id=e.id)):i.id=e.id,""!==i.id&&(void 0===e.value||null===e.value||""===e.value))){r=t.findDataValueById(i.id);i.value=r?r.value:e.value}void 0!==e.value&&null!==e.value&&""!==e.value&&("boolean"==typeof e.value?i.value=e.value?t.getResource("render-boolean-yes"):t.getResource("render-boolean-no"):Array.isArray(e.value)?i.value=e.value.map((function(e){return"boolean"==typeof e?e?t.getResource("render-boolean-yes"):t.getResource("render-boolean-no"):e})).join(" - "):i.value=e.value)}return i},validateValue:function(e){if(null!=e.id&&("number"==typeof e.id&&null!==e.id||"string"==typeof e.id&&e.id.length>0))if(null!==e.value&&"boolean"==typeof e.value)translated=!0,!0===bizagi.util.parseBoolean(e.value)?e.value=bizagi.localization.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e.value)&&(e.value=bizagi.localization.getResource("render-boolean-no"));else if(null!=e.value&&"object"===_typeof(e.value))for(var t=0,i=e.value.length;t<i;t++)null!=e.value[t]&&"boolean"==typeof e.value[t]&&(!0===bizagi.util.parseBoolean(e.value[t])?e.value[t]=bizagi.localization.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e.value[t])&&(e.value[t]=bizagi.localization.getResource("render-boolean-no")));return e},findDataValueById:function(e){return(this.properties.data||[]).find((function(t){return t.id==e}))}}),$.Class.extend("bizagi.rendering.check",{},{initializeData:function(e){this._super(e);var t=this.properties;t.value=void 0!==t.value?bizagi.util.parseBoolean(t.value):null},renderControl:function(){var e=this.renderFactory.getTemplate("check"),t=bizagi.util.randomNumber(100,1e7);return $.fasttmpl(e,{id:t,editable:this.properties.editable})},renderReadOnly:function(){return this.renderControl()},postRender:function(){this._super()},getDisplayValue:function(){var e=this.getValue();return!0===bizagi.util.parseBoolean(e)?this.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e)?this.getResource("render-boolean-no"):""},hasValue:function(){var e=this.getValue();return!bizagi.util.isEmpty(e)&&!(!1===bizagi.util.parseBoolean(e)&&this.properties.required)}}),$.Class.extend("bizagi.rendering.number",{},{initializeData:function(e){this._super(e);var t=this.properties,i=this.getResource("numericFormat");t.allowDecimals=void 0!==t.allowDecimals?bizagi.util.parseBoolean(t.allowDecimals):this.getDefaultAllowDecimals(t.dataType),t.numDecimals=t.allowDecimals?t.numDecimals?t.numDecimals:"undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0,t.symbol="",t.positiveFormat=i.positiveFormat,t.negativeFormat=i.negativeFormat,t.decimalSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:i.decimalSymbol,t.digitGroupSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:i.digitGroupSymbol,t.groupDigits=this.setGroupDigits(),t.colorize=t.colorizeOnNegative||!1,t.dataTypeMinValue=this.calculateMinValue(t.dataType),t.dataTypeMaxValue=this.calculateMaxValue(t.dataType)},renderControl:function(){var e=this.renderFactory.getTemplate("number");return $.fasttmpl(e,{id:this.properties.id,editable:this.properties.editable,value:bizagi.isMobile()?this.getDisplayValue():"",type:bizagi.util.isAndroidDevice()?"tel":"text",isDesign:"execution"!==this.getMode()})},postRender:function(){this._super();var e=this.getControl(),t=this.properties;this.numericInput=e.find("input"),this.numericInput.numeric(this.properties.decimalSymbol),"double"===t.retype&&this.attachRetypeDouble()},configureHandlers:function(){this.attachFormatCurrency()},removeValidations:function(){(this.getFormContainer().parent||this.getFormContainer()).clearValidationMessages()},attachRetypeDouble:function(){},formatNumericInput:function(e){var t=this.properties,i=bizagi.localization.getResource("render-number-retype-fail"),r=this.getFormContainer();if(void 0===r.validationController){var a=r.getValidationsContainer();r.validationController=new bizagi.command.controllers.validation(r,this.validations,a)}var n=r.validationController||r.parent.validationController,o=".",s=",";"undefined"==typeof BIZAGI_DEFAULT_CURRENCY_INFO?(o=this.getResource("numericFormat").decimalSymbol||".",s=this.getResource("numericFormat").digitGroupSymbol||","):(o=BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,s=BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator);var l=this.getMinValue(),d=this.getMaxValue();t.percentage&&this.numericInput.val(this.numericInput.val().replace("%",""));var c=this.numericInput.val();c=(c=","==o?c.replace(/\,0+$/,""):c.replace(/\.0+$/,"")).replace(t.symbol,""),-1!=(c=bizagi.util.replaceAll(c,s,"")).toString().indexOf(o)&&(","==o&&(c=c.replace(/([0-9]+(\,[0-9]+[1-9])?)(\,?0+$)/,"$1")),"."==o&&(c=c.replace(/([0-9]+(\.[0-9]+[1-9])?)(\.?0+$)/,"$1"))),null!=c&&c.length>0&&this.numericInput.val(c),/(.+)-$/.test(c)&&(c=c.replace(/(.+)-$/,"-$1"),this.numericInput.val(c));var u=c.replace(/[^0-9]+/g,"").length,p=this.properties.xpath,h=this.numericInput.val();if(null!=this.isInvalidFormat&&1==this.isInvalidFormat||""!=c&&-1!=["$","£","€","¥",t.symbol].indexOf(c))return this.setValue(""),this.getControl().find("input").val(""),void this.numericInput.val("");if(""!=bizagi.util.trim(c)){var g=parseFloat(c.replace(",","."));if(isNaN(g)&&(g=this.numericInput.asNumber()),i=void 0!==l&&null!=l&&g<l?bizagi.localization.getResource("render-numeric-minimum-validation").replaceAll("#label#",t.displayName+" ("+h+")").replaceAll("#minValue#",l.toString()):null!=d&&g>d?bizagi.localization.getResource("render-numeric-maximum-validation").replaceAll("#label#",t.displayName+" ("+h+")").replaceAll("#maxValue#",d.toString()):i+" "+h,null!=l&&g<l||null!=d&&g>d||10==this.properties.dataType&&u>15||1==this.properties.dataType&&u>19||11==this.properties.dataType&&u>7||11==this.properties.dataType&&u>7||h.match(/[^$£€¥,-.()\d]/)){if(void 0!==n&&null!=n){this.removeValidations();var m=i;-1===m.indexOf(h)&&(m=i+" "+h),n.showValidationMessage(m,p),this.isValidRender=!1,this.isValidRenderMessage=m}i=i.replace(h,"")}else this.isValidRender=!0,this.isValidRenderMessage="",e.value.toString().length>0&&!t.allowDecimals&&!t.groupDigits?(e.value=e.value.toString().replace(/^0+/,""),t.symbol.length>0&&(e.value=e.value.toString().replace(t.symbol+"0",t.symbol)),e.value=e.value.toString().replace(/^0+/,""),0==e.value.replaceAll("0","").length?e.value=t.symbol+"0":e.value.toString()==parseInt(e.value)&&(e.value=t.symbol+e.value)):"money"!==this.properties.type&&"number"!==this.properties.type&&"columnMoney"!==this.properties.type&&"columnNumber"!==this.properties.type||(e.value=e.value.toString().replace(/^0+/,""),""===e.value&&(e.value=0)),this.executeFormatCurrencyPlugin(),this.setValue(this.numericInput.asNumber({symbol:t.symbol,positiveFormat:t.positiveFormat,negativeFormat:t.negativeFormat,decimalSymbol:t.decimalSymbol,digitGroupSymbol:t.digitGroupSymbol,groupDigits:t.groupDigits})),t.percentage&&this.numericInput&&-1==this.numericInput.val().indexOf("%")&&this.numericInput.val(this.numericInput.val()+"%"),i=i.replace(h,"")}else this.setValue("")},attachFormatCurrency:function attachFormatCurrency(){var self=this,properties=self.properties;self.isValidRender=self.isValidRender||!0,null==$.formatCurrency.regions[bizagi.language]&&($.formatCurrency.regions[bizagi.language]=this.getResource("numericFormat")),self.numericInput.blur((function(){self.formatNumericInput(this)})).bind("paste",(function(e){try{var tmpData=bizagi.util.isIE()||bizagi.util.isIE11()?window.clipboardData.getData("text"):e.originalEvent.clipboardData.getData("Text"),totalVal="/[^0-9";properties.decimalSymbol.length>0&&(totalVal+=properties.decimalSymbol),8==properties.dataType&&(properties.symbol.length>0&&(totalVal+=properties.symbol),properties.digitGroupSymbol.length>0&&(totalVal+=properties.digitGroupSymbol)),totalVal+="\\-\\s]/gi";try{tmpData.replace(eval(totalVal),"").length!=tmpData.length&&e.preventDefault()}catch(e){}}catch(e){bizagi.log("Error to pasting content"),self.isInvalidFormat=!0}})).keydown((function(e){self.previousValue=this.value;var t=(e=window.event&&window.event.preventDefault?window.event:e).charCode||e.keyCode;if("undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO&&0==BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits&&(properties.allowDecimals=!1),(properties.dataType<5||8==properties.dataType&&0==properties.allowDecimals)&&(188!=t&&190!=t&&110!=t||e.preventDefault()),this.value&&void 0!==e&&this.value.length>0&&(8==properties.dataType||10==properties.dataType))if(t>47&&t<58){self.formatTimeout&&clearTimeout(self.formatTimeout);var i=this.value+"";properties.digitGroupSymbol&&properties.digitGroupSymbol.length>0&&(i=i.replaceAll(properties.digitGroupSymbol,"")),properties.symbol.length>0&&(i=i.replaceAll(properties.symbol,"")),i=$.trim(i),properties.decimalSymbol&&properties.decimalSymbol.length>0&&(i=i.replaceAll(properties.decimalSymbol,".")),10*i>properties.dataTypeMaxValue&&e.preventDefault()}else if(109==t||189==t)if(0!=this.selectionStart||this.selectionEnd!=this.value.length){var r=this.selectionEnd;this.value=properties.symbol+"-"+this.value.replace(properties.symbol,""),this.selectionStart=this.selectionEnd=r+1}else 0==this.selectionStart&&this.selectionEnd==this.value.length&&(this.value="-",this.selectionStart=this.selectionEnd=this.value.length)})).keyup((function(e){var t=(e=window.event||e).charCode||e.keyCode;if(void 0!==e)switch(t){case 16:case 17:case 13:case 18:break;case 27:this.value=""}})).keypress((function(e){var t=(e=window.event&&window.event.preventDefault?window.event:e).charCode||e.keyCode;if(void 0!==e){35==t||37==t||39==t?e.preventDefault():8!=properties.dataType&&36==t&&e.preventDefault();var i=String.fromCharCode(t);!1===properties.allowDecimals&&0===properties.numDecimals&&i===properties.decimalSymbol&&e.preventDefault()}}))},executeFormatCurrencyPlugin:function(){var e=this.properties;if(this.numericInput&&this.numericInput.formatCurrency({symbol:e.symbol,positiveFormat:e.positiveFormat,negativeFormat:e.negativeFormat,decimalSymbol:e.decimalSymbol,digitGroupSymbol:e.digitGroupSymbol,groupDigits:e.groupDigits,roundToDecimalPlace:e.numDecimals,colorize:e.colorize}),8!==e.dataType&&!0===bizagi.override.removeTrailingZeros){var t=this.numericInput.val(),i=!0;-1!==t.indexOf(")")&&(i=!1,t=t.replace("(","").replace(")",""));var r=new RegExp("("+e.decimalSymbol+"\\d*?[1-9])0+$","g");t=t.replace(r,"$1"),r=new RegExp("\\"+e.decimalSymbol+"0+$","g"),t=t.replace(r,""),this.numericInput.val(t),i||this.numericInput.val("("+t+")")}e.percentage&&this.numericInput.val(this.numericInput.val()+"%")},getDisplayValue:function(){var e=this.properties,t=this.getControl(),i=void 0!==this.getValue()&&null!==this.getValue()?this.getValue():e.defaultValue||e.defaultvalue||$("input",t).val()||"",r=$("<label/>").html(bizagi.util.numberToFixedString(i));if(r.formatCurrency({symbol:e.symbol,positiveFormat:e.positiveFormat,negativeFormat:e.negativeFormat,decimalSymbol:e.decimalSymbol,digitGroupSymbol:e.digitGroupSymbol,groupDigits:e.groupDigits,roundToDecimalPlace:e.numDecimals,colorize:e.colorize}),e.percentage&&(r=$("<label/>").html(r.text()+"%")),!e.editable&&8!==e.dataType&&!0===bizagi.override.removeTrailingZeros){var a=!0;-1!==(i=r.text()).toString().indexOf(")")&&(a=!1,i=i.replace("(","").replace(")",""));var n=new RegExp("("+e.decimalSymbol+"\\d*?[1-9])0+$","g");return i=i.replace(n,"$1"),n=new RegExp("\\"+e.decimalSymbol+"0+$","g"),i=i.replace(n,""),a||(i="("+i+")"),i}return r.text()},isValid:function(e){var t,i=this.properties,r=this._super(e),a=this.getValue(),n=this.getMinValue(),o=this.getMaxValue();if("string"==typeof a&&""!=a&&(a=Number(a)),this.hasValue()&&(bizagi.util.isEmpty(n)||a<n&&(t=this.getResource("render-numeric-minimum-validation").replaceAll("#label#",i.displayName.toString()+" ("+a+")").replaceAll("#minValue#",n.toString()),e.push({xpath:i.xpath,message:t}),r=!1),bizagi.util.isEmpty(o)||a>o&&(t=this.getResource("render-numeric-maximum-validation").replaceAll("#label#",i.displayName.toString()+" ("+a+")").replaceAll("#maxValue#",o.toString()),e.push({xpath:i.xpath,message:t}),r=!1)),!(!1!==this.isValidRender||r&&bizagi.util.isMobileDevice())){r=!1;var s=this.isValidRenderMessage?this.isValidRenderMessage:"error";e.push({xpath:i.xpath,message:s})}return r},getMinValue:function(){var e=this.properties.minValue;return null!=e?e:this.properties.dataTypeMinValue},getMaxValue:function(){var e=this.properties.maxValue;return null!=e?e:this.properties.dataTypeMaxValue},getDefaultAllowDecimals:function(e){if(e){if(1===e||2===e||3===e||4===e||7===e)return!1;if(6===e||8===e||10===e||11===e)return!0}return!1},getDefaultGroupDigits:function(e){if(e){if(1===e||2===e||3===e||4===e||7===e)return!1;if(6===e||8===e||10===e||11===e)return!0}return!1},setGroupDigits:function(){return void 0!==this.properties.thousands?!!this.properties.digitGroupSymbol&&bizagi.util.parseBoolean(this.properties.thousands):!!this.properties.digitGroupSymbol&&this.getDefaultGroupDigits(this.properties.dataType)},calculateMinValue:function(e){return 8===e||10===e?-922337203685477:4===e?0:3===e?-32768:2===e?-2147483648:1===e?-999999999999999:null},calculateMaxValue:function(e){return 8===e||10===e?922337203685477:4===e?255:3===e?32767:2===e?2147483647:1===e?999999999999999:null},performMinValue:function(e){var t=Number(e);return isNaN(t)&&(t=this.calculateMinValue(this.properties.dataType)),t},performMaxValue:function(e){var t=Number(e);return isNaN(t)&&(t=this.calculateMaxValue(this.properties.dataType)),t},changeMinValue:function(e){var t=this.performMinValue(e);this.properties.minValue=this.properties.dataTypeMinValue=t},changeMaxValue:function(e){var t=this.performMaxValue(e);this.properties.maxValue=this.properties.dataTypeMaxValue=t},createTooltip:function(e,t,i){e.data("oldValue",t),e.val("");try{e.tooltip("destroy")}catch(e){}e.attr("title",i),e.tooltip();var r=$.getMaxZindex();e.tooltip().on("tooltipopen",(function(e,t){t.tooltip.zIndex(r)})),e.tooltip("open");var a=setTimeout((function(){e.focus(),clearTimeout(a)}),100)}}),$.Class.extend("bizagi.rendering.numberScientificNotation",{initializeData:function(e){this._super(e),this.properties.decimalSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:format.decimalSymbol},renderControl:function(){var e=this.renderFactory.getTemplate("numberScientificNotation");return $.fasttmpl(e,{})},postRender:function(){var e=this.getControl();this.numericInput=e.find("input"),this.numericInput.numericSN(this.properties.decimalSymbol)},getDisplayValue:function(){return this.getValue().replace(".",this.properties.decimalSymbol)},setValue:function(e){e=(e||"").toString().replace(this.properties.decimalSymbol,"."),this._super(e)},controlValueIsChanged:function(){var e=this.properties,t=this.getValue()||"",i=e.originalValue||"";return!!$.forceCollectData||i.toLowerCase()!=t.toLowerCase()}}),$.Class.extend("bizagi.rendering.date",{},{initializeData:function(e){var t=bizagi.util.dateFormatter;this._super(e);var i=this.properties,r=this.getResource("dateFormat"),a=this.getResource("timeFormat");if(i.displayValue="",i.showTime=void 0!==i.showTime&&bizagi.util.parseBoolean(i.showTime),i.dateFormat=i.dateFormat||r,i.timeFormat=i.timeFormat||a,i.fullFormat=i.dateFormat,i.showTime&&-1===i.fullFormat.search(/[h|H]+/gi)&&(i.fullFormat=i.fullFormat+" "+i.timeFormat),i.value){var n=t.getDateFromInvariant(i.value,i.showTime);if(0!=n){this.value=i.value;var o=bizagi.localization.getResource("datePickerRegional");i.displayValue=bizagi.util.dateFormatter.formatDate(n,i.fullFormat,o)}else this.value=null}r=this.getDateFormat(i.fullFormat);var s=i.fullFormat.substring(0,i.fullFormat.indexOf(":")).lastIndexOf(" ");i.showTime||(i.fullFormat=s>0?i.fullFormat.substring(0,s):i.fullFormat),i.datePickerFormat=r.datePickerFormat,i.timePickerFormat=r.timePickerFormat,this.i18n=bizagi.localization.getResource("datePickerRegional")},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("date"),i=e.fullFormat;return $.fasttmpl(t,{id:e.id,showTime:e.showTime,value:e.value,editable:e.editable,dateFormat:bizagi.override&&!0===bizagi.override.uppercaseDatePlaceholder?i.toUpperCase():i,rtl:"rtl"==e.orientation})},configureHandlers:function(e,t){var i=this,r=i.properties,a=i.getDateControl(),n=i.getTimeControl();a.bind("change",(function(){i.onChangeHandler()})),r.showTime&&n.bind("change",(function(e,t){i.updatingTime?delete i.updatingTime:i.onChangeHandler(t)}))},onChangeHandler:function(){},getDisplayValue:function(e){var t,i=this.properties;if(!i.displayValue&&e){var r=bizagi.util.dateFormatter.getDateFromInvariant(e,i.showTime),a=bizagi.localization.getResource("datePickerRegional");t=bizagi.util.dateFormatter.formatDate(r,i.fullFormat,a)}else t="";return i.displayValue||t||""},collectData:function(e){var t=this.properties,i=t.xpath,r=this.getValue();if(this.controlValueIsChanged()&&!bizagi.util.isEmpty(i))if(bizagi.util.isEmpty(r))""===r&&(e[t.xpath]="");else{var a=bizagi.util.dateFormatter.getDateFromInvariant(r,t.showTime);void 0!==a&&0!==a&&(t.showTime||a.setHours(0,0,0,0),e[t.xpath]=bizagi.util.dateFormatter.formatInvariant(a,!0))}},getDateControl:function(){},getTimeControl:function(){},isValid:function(e){var t,i=this.properties,r=this._super(e),a=this.getValue();if(a&&(!0===bizagi.util.parseBoolean(i.editable)&&0!=(a=this.getNormalizeDate(bizagi.util.dateFormatter.getDateFromInvariant(a,i.showTime))))){if(i.minValue&&("string"==typeof i.minValue||"number"==typeof i.minValue)){var n=this.getNormalizeDate("string"==typeof i.minValue?bizagi.util.dateFormatter.getDateFromInvariant(i.minValue,i.showTime):new Date(i.minValue));a<n&&(t=this.getResource("render-date-minimum-validation").replaceAll("#label#",i.displayName).replaceAll("#minValue#",bizagi.util.dateFormatter.formatDate(n,i.fullFormat)),e.push({xpath:i.xpath,message:t}),r=!1)}if(i.maxValue&&("string"==typeof i.maxValue||"number"==typeof i.maxValue)){var o=this.getNormalizeDate("string"==typeof i.maxValue?bizagi.util.dateFormatter.getDateFromInvariant(i.maxValue,i.showTime):new Date(i.maxValue));a>o&&(t=this.getResource("render-date-maximum-validation").replaceAll("#label#",i.displayName).replaceAll("#maxValue#",bizagi.util.dateFormatter.formatDate(o,i.fullFormat)),e.push({xpath:i.xpath,message:t}),r=!1)}}return r},getDateFormat:function(e){var t,i=e,r=void 0;return-1==e.search("h")&&-1==e.search("H")||(t=-1!=e.search("h")?e.search("h"):e.search("H"),i=e.substring(0,t-1),r=e.substr(t)),i.indexOf("MMMM")>=0?i=i.replaceAll("MMMM","MM"):i.indexOf("MMM")>=0?i=i.replaceAll("MMM","M"):i.indexOf("MM")>=0?i=i.replaceAll("MM","mm"):i.indexOf("M")>=0&&(i=i.replaceAll("M","m")),-1!=i.search("yyyy")?i=i.replaceAll("yyyy","yy"):-1!=i.search("yy")&&(i=i.replaceAll("yy","y")),{datePickerFormat:i=i.replaceAll("dddd","DD"),timePickerFormat:r}},postRender:function(){var e=this.properties;this._super(),void 0===e.maxValue&&(e.maxValue="12/31/"+parseInt((new Date).getFullYear()+200).toString()+" 00:00:00"),void 0===e.minValue&&(e.minValue="01/01/"+parseInt((new Date).getFullYear()-200).toString()+" 00:00:00")},getNormalizeDate:function(e){return 0!=e&&null!=e&&(this.properties.showTime?e.setMilliseconds(0):e.setHours(0,0,0,0)),e},getTimeFormat:function(e){return e.replaceAll("m","i").replaceAll("tt","A")},setValueFromCalendarButtons:function(e){e?e=this.getNormalizeDate(e):(value=null,this.setValue(""),this.setDisplayValue(""))},changeMinValue:function(e){var t=this.properties,i=bizagi.util.dateFormatter;e&&t.editable&&("number"==typeof e?e=i.formatInvariant(this.getNormalizeDate(new Date(e)),t.showTime):(e=this.getNormalizeDate("object"===_typeof(e)?e:i.getDateFromInvariant(e,t.showTime)),e=i.formatInvariant(e)),t.minValue=e)},changeMaxValue:function(e){var t=this.properties,i=bizagi.util.dateFormatter;e&&t.editable&&("number"==typeof e?e=i.formatInvariant(this.getNormalizeDate(new Date(e)),t.showTime):(e=this.getNormalizeDate("object"===_typeof(e)?e:i.getDateFromInvariant(e,t.showTime)),e=i.formatInvariant(e)),t.maxValue=e)}}),$.Class.extend("bizagi.rendering.extendedText",{},{initializeData:function(e){this._super(e),this.isOfflineForm=bizagi.util.isOfflineForm({context:this}),this.hasMaxLines=!!this.properties.maxLines;var t=this.properties;if(t.maxLines=this.properties.maxLines||6,t.regularExpressionExpression){var i=t.regularExpressionMessage||this.getResource("render-text-regular-expression-default-message");t.regularExpression={expression:t.regularExpressionExpression,message:i}}},renderControl:function(){var e=this.renderFactory.getTemplate("extendedText");return $.fasttmpl(e,{id:this.properties.id,isEmptyField:void 0===this.properties.value,editable:this.properties.editable})},postRender:function(){this._super();var e=this.getControl();this.textarea=e.find("textarea"),this.textarea?this.textarea.css({resize:"both"}):this.textarea.css({resize:"none"}),"double"===this.properties.retype&&this.attachRetypeDouble()},attachRetypeDouble:function(){},configureHandlers:function(){var e=this,t=e.properties;t.maxLength&&e.textarea.prop("maxlength",t.maxLength),t.maxLines?e.textarea.prop("rows",t.maxLines):e.textarea.prop("rows",6),e.textarea.bind("change",(function(){e.setValue(e.textarea.val());var i=[];if("duplicate"!==t.retype)if(e.isValid(i)||void 0===t.regularExpression)e.setValue(e.textarea.val(),!0);else{var r=i[0].message;bizagi.showMessageBox(r,"Bizagi","error")}})),e.textarea.bind("blur",(function(){e.setValue(e.textarea.val())}))},isValid:function(e){var t,i=this.properties,r=this._super(e),a=this.getValue(),n=new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g");return this.isOfflineForm&&bizagi.util.isMobileDevice()&&(a=a&&"object"===_typeof(a)&&a.value?a.value:a),i.regularExpression?i.editable&&(a&&(a.match(n)||!a.match(new RegExp(i.regularExpression.expression))&&this.properties&&"userName"===this.properties.xpath)?(t=i.regularExpression.message,e.push({xpath:i.xpath,message:t}),r=!1):!a||!a.match(n)&&a.match(new RegExp(i.regularExpression.expression))||(t=i.regularExpression.message,e.push({xpath:i.xpath,message:t}),r=!1)):a&&a.match(new RegExp(".*?eval\\(","g"))&&a.match(new RegExp(".*?eval\\u0028","g"))&&i.editable&&(t=this.getResource("render-text-regular-expression-default-message"),e.push({xpath:i.xpath,message:t}),r=!1),r},setDisplayValue:function(e){var t=this.getControl();if(0==this.properties.editable&&"string"==typeof e){var i=bizagi.util.encodeHtmlText(this.getDisplayValue());t.html(i)}this.setValue(e,!1)},collectData:function(e){this._super(e)},createTooltip:function(e,t,i){e.data("oldValue",t),e.val(""),e.data("ui-tooltip")&&e.tooltip("destroy"),e.attr("title",i),e.tooltip();var r=$.getMaxZindex();e.tooltip().on("tooltipopen",(function(e,t){t.tooltip.zIndex(r)})),e.tooltip("open");var a=setTimeout((function(){e.focus(),clearTimeout(a)}),100)},validateValue:function(e,t){return t<1||e.length<=t?e:e.substr(0,t)}}),$.Class.extend("bizagi.rendering.grid",{},{initializeData:function(e){var t=this;this._super(e),t.originalProperties=bizagi.clone(e.properties);var i,r,a=this.properties;t.initProperties(),t.columns=[],t.columnsIds=[],t.enabledChecks={},t.exclusiveChanges={},t.originalEnabledChecks=[],$.each(e.elements,(function(e,n){var o=n.render.properties;o.groupBy&&(a.groupBy=o.xpath||"",a.allowGrouping=!bizagi.util.isEmpty(a.groupBy)),/columnBoolean/i.test(o.type)&&o.isExclusive&&(a.hasExclusiveCheck=!0,n.render.properties.required=!1,t.enabledChecks[o.xpath]=[]),t.properties.inlineEdit||(n.render.properties.editable=!1);var s=t.renderFactory.getColumn({type:o.type,data:n.render,parent:t,singleInstance:a.singleInstance});t.columns.push(s),t.columnsIds.push(n.render.properties.id),o.editable&&(i=!0),o.totalize&&o.totalize.operation&&(r=!0,o.totalize.format=o.totalize.format||{},o.totalize.format.bold=void 0===o.totalize.format.bold||o.totalize.format.bold)})),"rtl"===a.orientation&&(t.columns=t.columns.reverse()),a.inlineEdit&&!i&&(a.inlineEdit=!1,a.allowEdit=!1),r&&(a.showSummary=!0,a.rowsPerPage=0)},initProperties:function(){var e=this.getFormContainer(),t=this.properties;$.extend(t,this.initEditabilityProperties(t.editable,t.allowEdit,t.inlineEdit,t.withEditForm),this.initAddAndDeleteProperties(t.editable,t.allowAdd,t.inlineAdd,t.allowDelete)),t.allowDetail=null!=bizagi.util.parseBoolean(t.allowDetail)&&bizagi.util.parseBoolean(t.allowDetail),t.isSortable=null==bizagi.util.parseBoolean(t.isSortable)||bizagi.util.parseBoolean(t.isSortable),t.keyColumn="",t.data=t.data||null,t.displayType="value",t.skipInitialLoad=t.skipInitialLoad||!1,t.allowMore=bizagi.util.parseBoolean(t.allowMore)||!1,t.allowFilter=bizagi.util.parseBoolean(t.allowFilter)||!1,t.allowGrouping=!1,t.groupBy="",t.groupSummary=t.groupSummary||null,t.groupText=this.getResource("render-grid-group-text"),t.groupCollapsed=bizagi.util.parseBoolean(t.groupCollapsed)||!1,t.groupOrder=t.groupOrder||"asc",t.formShowMode=bizagi.util.parseBoolean(t.formShowMode)||"popup",t.floatingHeader=bizagi.util.parseBoolean(t.floatingHeader)||!1,t.sortBy=t.sortBy?t.sortBy:t.data&&t.data.sort?t.data.sort:t.keyColumn,t.sortOrder=void 0!==t.sortOrder&&null!==t.sortOrder?"True"===t.sortOrder?"asc":"desc":t.data&&t.data.order?t.data.order:"asc",t.sort=t.sortBy+" "+t.sortOrder,t.rowsPerPage=t.allowGrouping?1e3:t.rowsPerPage||20,t.page=1,t.records=0,t.totalPages=0,t.addLabel=t.addLabel||$.trim(this.getResource("render-grid-add-label"))+" "+t.displayName,t.editLabel=t.editLabel||$.trim(this.getResource("render-grid-edit-label"))+" "+t.displayName,t.deleteLabel=t.deleteLabel||this.getResource("render-ecm-confirm-bt-delete")+" "+t.displayName,t.exportOptionsLabel=t.exportOptionsLabel||this.getResource("render-grid-export-options-label")+t.displayName,t.detailLabel=t.detailLabel||this.getResource("render-collection-navigator-details-form"),t.tableCssClass=t.cssClass||"",t.alreadySaved=!1,"entity"!=t.contexttype&&(t.contexttype="function"==typeof this.parent.getContextType?this.parent.getContextType():"");try{(this.parent&&"boolean"==typeof this.parent.properties.editable&&!this.parent.properties.editable||!t.editable)&&(t.editable=!1,t.allowEdit=!1,t.inlineEdit=!1,t.allowAdd=!1,t.inlineAdd=!1,t.allowDelete=!1)}catch(e){}t.allowEdit&&(t.inlineEdit||t.withEditForm)||(t.editable=!1),t.labelWidth=0,t.valueWidth="100%",t.overrideGetRemoteData=t.overrideGetRemoteData||void 0,t.singleInstance=!!bizagi.util.isEmpty(t.singleInstance)||t.singleInstance,t.contextType=e.params&&e.params.data&&e.params.data.contextType?e.params.data.contextType:null,this.changes={},this.cellOverrides={},this.isRTL()&&null!=t.data&&(t.data.rows=this.changeOrderData(t.data.rows))},initEditabilityProperties:function(e,t,i,r){return e=null===bizagi.util.parseBoolean(e)||bizagi.util.parseBoolean(e),t=null===bizagi.util.parseBoolean(t)||bizagi.util.parseBoolean(t),i=null===bizagi.util.parseBoolean(i)||bizagi.util.parseBoolean(i),r=null!==bizagi.util.parseBoolean(r)&&bizagi.util.parseBoolean(r),e||(t=i=r=!1),{editable:e,allowEdit:t,inlineEdit:i,withEditForm:r}},initAddAndDeleteProperties:function(e,t,i,r){return e=null===bizagi.util.parseBoolean(e)||bizagi.util.parseBoolean(e),t=null==bizagi.util.parseBoolean(t)||bizagi.util.parseBoolean(t),i=null==bizagi.util.parseBoolean(i)||bizagi.util.parseBoolean(i),r=null==bizagi.util.parseBoolean(r)||bizagi.util.parseBoolean(r),t||(i=!1),e||(t=i=r=!1),{allowAdd:t,inlineAdd:i,allowDelete:r}},hasValue:function(){return this.properties.data&&this.properties.data.rows.length>0},isRTL:function(){var e=this.properties;return!e||"string"==typeof e.orientation&&"RTL"==e.orientation.toUpperCase()},changeOrderData:function(e){var t,i=[],r=e||[];return $.each(r,(function(e,a){t=a.shift(),(i=a.reverse()).unshift(t),r[e]=i})),r},removeRemainingColumns:function(e,t){var i=e||[],r=0;return i.length>0&&(r=i[0].length-t-1),r>0&&$.each(i,(function(e,t){for(var i=0;i<r;i++)t.pop()})),i},getColumn:function(e){var t=null;return $.each(this.columns,(function(i,r){r.properties.xpath!=e&&r.properties.id!=e&&r.properties.xpath+"."+r.properties.id!=e||(t=r)})),t},getColumnType:function(e){var t=this.columnsIds.indexOf(e);return-1!=t?this.columns[t].properties.type:null},getColumnById:function(e){var t=this.columnsIds.indexOf(e);return-1!==t?this.columns[t]:null},renderControl:function(){var e=this.properties,t=new $.Deferred;"execution"!==this.getMode()&&(e.data=this.getDummyData());var i=this.getGridTemplate(),r=this.applyTemplate(i),a=[];return $.each(this.columns,(function(e,t){var i=t.initialize();i&&a.push(i)})),$.when.apply($,a).done((function(){t.resolve(r)})),t.promise()},postRender:function(){var e=this.getControl();this._super(),e.addClass("ui-bizagi-render-grid-container").addClass("ui-bizagi-render-display-block")},getGridTemplate:function(){return this.renderFactory.getTemplate("grid")},applyTemplate:function(e){var t=this.properties;return orientation=this.properties.orientation,$.fasttmpl(e,{id:bizagi.util.encodeXpath(t.xpath),displayName:bizagi.util.encodeXpath(t.displayName),allowAdd:t.allowAdd,addLabel:t.addLabel})},renderReadOnly:function(){return this.renderControl()},getRemoteData:function(e){var t=this,i=t.properties;return e=e||{},$.extend(e,{url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,contexttype:i.contextType,idPageCache:i.idPageCache,sort:i.sortBy,order:i.sortType,page:i.page,rows:i.rowsPerPage,searchFilter:i.searchFilter,orientation:i.orientation||"ltr"}),i.overrideGetRemoteData?i.overrideGetRemoteData(e):t.dataService.multiaction().getGridData(e).then((function(e){return t.originalProperties=t.originalProperties||{},t.originalProperties.data=bizagi.clone(e),i.page=e.page,i.records=e.records,i.totalPages=e.totalPages,e})).fail((function(e){console.error(e.message||"Error")}))},spliceRowData:function(e,t){"execution"===this.getMode()&&e&&e.rows&&$.each(e.rows,(function(i,r){var a=t||e.rows[i].length;e.rows[i].splice(a,0,"")}))},spliceRowDataVisible:function(e,t){"execution"===this.getMode()&&e&&e.visible&&$.each(e.visible,(function(i,r){var a=t||e.visible[i].length;e.visible[i].splice(a,0,!0)}))},spliceRowDataEditable:function(e,t){"execution"===this.getMode()&&e&&e.editable&&$.each(e.editable,(function(i,r){var a=t||e.editable[i].length;e.editable[i].splice(a,0,!0)}))},getDummyData:function(){var e=this.properties;if(e.data)return e.data;for(var t=["1"],i=0;i<this.columns.length;i++)t.push("");return{page:1,total:1,records:1,rows:[t]}},submitEditRequest:function(e){var t=this.properties,i=t.xpath+this.buildCellXpathFilter(e);return this.dataService.editGridRecord({url:t.editUrl,idRender:t.id,xpath:i,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType})},submitSaveRequest:function(e,t){var i=this,r=i.properties,a=null;t.deferreds&&(a=$.when.apply($,t.deferreds),delete t.deferreds);var n=r.xpathContext.length>0?r.xpathContext+"."+r.xpath+i.buildCellXpathFilter(e):r.xpath+i.buildCellXpathFilter(e);return $.when(a).pipe((function(){return i.startLoading(),i.dataService.saveGridRecord({url:r.saveUrl,idRender:r.id,xpath:r.xpath,xpathContext:n,submitData:t,contexttype:r.contextType,disableServerGridValidations:t.disableServerGridValidations||!1}).pipe((function(e){return i.endLoading(),e})).fail((function(e){var t=i.getFormContainer(),r=e.responseText?e.responseText:"string"==typeof e?e:e.toString();if("string"==typeof r)try{r=JSON.parse(r).message}catch(e){r=(r=r.match(/"message":(.*)",/)[0]).substr(11,r.length-13)}else r.message||(r=e);t.validateForm(),t.clearValidationMessages(),t.addValidationMessage(r)}))}))},submitDeleteRequest:function(e){var t=this,i=t.properties,r=i.xpath+t.buildCellXpathFilter(e);return t.dataService.deleteGridRecord({url:i.deleteUrl,idRender:i.id,xpath:r,xpathContext:i.xpathContext,idPageCache:i.idPageCache,contexttype:i.contextType}).pipe((function(e){if("validationMessages"==e.type){var i=t.getFormContainer(),r=e.messages.join(" ");i.failHandler({message:r})}return e}))},submitAddRequest:function(){var e=this.properties;return this.dataService.addGridRecord({url:e.addUrl,idRender:e.id,xpath:e.xpath,xpathContext:e.xpathContext,contexttype:e.contextType,idPageCache:e.idPageCache}).pipe((function(e){return e.idEntity})).promise()},submitRollbackRequest:function(e){var t=this.properties;return this.dataService.rollbackGridAction({url:t.rollbackUrl,idRender:t.id,xpath:t.xpath,xpathContext:t.xpathContext,idPageCache:e?e.idPageCache:t.idPageCache,contexttype:this.properties.contexttype||""})},collectGridChange:function(e){var t=(e=e||{}).id,i=e.dataType,r=e.xpath,a=e.value,n=void 0===e.trigger||e.trigger,o=e.pressed||!1,s=i&&bizagi.util.normalizeType(i),l=e.renderId||"";this.changes[t]=this.changes[t]||{},/^columnsearch$/i.test(s)&&a&&void 0!==a.id?this.changes[t][r]=a.id:this.changes[t][r]=a,n&&this.triggerRenderChange({key:t,column:r,pressed:o,id:l})},configureColumnSubmitOnChange:function(e){var t=this,i=t.properties,r=i.id,a={commands:[{xpath:i.xpath,command:"submit-value",argument:"all"}],conditions:{operator:"and",expressions:[{simple:{operator:"cell-change",xpath:i.xpath+"[]."+e,argumentType:"text",argument:e}}]},dependencies:[i.xpath]};$.when(t.ready()).done((function(){t.getFormContainer().addSubmitAction(e+"."+r,a)}))},collectData:function(e){var t=this,i=t.properties,r=[];if(t.exclusiveChanges)for(var a in t.exclusiveChanges){var n=t.exclusiveChanges[a],o=t.enabledChecks[a];if(n&&o)e[i.xpath+"["+a+"=true]."+a]=!1}for(var s in t.changes){if("summary"!=s)for(var l in t.changes[s])if(t.canColumnBeSent(s,l)){a=i.xpath+t.buildCellXpathFilter(s)+"."+l;var d=t.changes[s][l];e[a]=d}r.push(s)}if(t.exclusiveChanges)for(var a in t.exclusiveChanges){n=t.exclusiveChanges[a],o=t.enabledChecks[a];if(n&&o){var c=t.exclusiveChanges[a];if(c&&c.value)e[i.xpath+t.buildCellXpathFilter(c.key)+"."+a]=c.value}}$.each(r,(function(e,i){delete t.changes[i]}))},hasChanged:function(e){return $.isEmptyObject(this.changes)?!$.isEmptyObject(this.exclusiveChanges)&&(e.push(!0),!0):(e.push(!0),!0)},canColumnBeSent:function(e,t){var i,r;for(i in this.columns)if(this.columns.hasOwnProperty(i)){var a=this.columns[i];if("columnUserfield"!==a.properties.type){if(a.properties.xpath==t){var n=this.getCellOverride(e,a.columnIndex-1);return a.canBeSent(e,n)}}else for(r in a.properties)if(a.properties.hasOwnProperty(r)&&"[object String]"===Object.prototype.toString.apply(a.properties[r])&&a.properties[r].substr(a.properties[r].lastIndexOf(".")+1)===t)return!0}return!1},canBeSent:function(){var e=this.properties;return!(bizagi.util.parseBoolean(e.displayOnly)||!1||!e.inlineEdit&&!e.inlineAdd&&$.isEmptyObject(this.changes))},getCellValue:function(e,t){for(var i=this.properties.data.rows,r=0;r<i.length;r++)if(i[r][0]==e)for(var a=0;a<this.columns.length;a++){if(this.columns[a].properties.xpath==t)return i[r][a+1]}return null},getCellCurrentValue:function(e,t){var i=this.getControlCell(e,t);return i&&"function"==typeof i.getValue?i.getValue():null},getControlCell:function(e,t){var i=null;if(void 0!==this.columns)for(var r=0;r<this.columns.length;r++)if(this.columns[r].properties.xpath==t||this.columns[r].properties.id==t||this.columns[r].properties.xpath+"."+this.columns[r].properties.id==t){i=this.columns[r].getDecorated(e);break}return i},changeRequired:function(e){this.properties.required=e,this.changeRequiredLabel(e)},changeRequiredLabel:function(e){var t=this.getControl();t.length>0&&("execution"!==this.getMode()?1==bizagi.util.parseBoolean(e)&&this.properties.editable?t.addClass("grid-control-required"):t.removeClass("grid-control-required"):1==bizagi.util.parseBoolean(e)&&!this.hasValue()&&this.properties.editable?t.addClass("grid-control-required"):t.removeClass("grid-control-required")),this.triggerRenderValidate()},refresh:function(){},setError:function(e,t){},changeCellBackgroundColor:function(e,t,i){},changeCellColor:function(e,t,i){},changeCellVisibility:function(e,t,i){},changeCellRequired:function(e,t,i){},changeCellEditability:function(e,t,i){},changeCellProperties:function(e,t,i){},changeCellMaxValue:function(e,t,i){},changeCellMinValue:function(e,t,i){},changeColumnEditability:function(e,t){},changeColumnVisibility:function(e,t){},changeColumnRequired:function(e,t){},cleanCellData:function(e,t){},changeEditability:function(e){var t=this,i=t.getControl();t.saveGrid().done((function(){var r="Default"==e?t.originalProperties.editable:bizagi.util.parseBoolean(e);i.empty();var a=t.originalProperties;$.extend(t.properties,t.initEditabilityProperties(r,a.allowEdit,a.inlineEdit,a.withEditForm),t.initAddAndDeleteProperties(r,a.allowAdd,a.inlineAdd,a.allowDelete)),t.properties.editabilityEnabled=t.properties.editabilityEnabled||t.properties.editable,r?t.properties.allowEdit&&t.properties.inlineEdit&&t.changeColumnsEditability(e):t.changeColumnsEditability(!1),"function"==typeof t.internalRenderControl&&$.when(t.internalRenderControl()).done((function(e){i.append(e),t.postRenderElement(t.element)}))}))},saveGrid:function(){var e=this,t=$.Deferred(),i=$("[data-bizagi-component=rows]",e.element).find("[data-new-row=true]");if(i.length>0){var r=$.map(i,(function(e,t){return $(e).data("business-key")}));e.saveInlineAddedRows(r).done((function(){$.when(e.saveRows()).done((function(){e.refresh(),t.resolve()}))}))}else t.resolve();return t.promise()},changeColumnsEditability:function(e){var t=this.columns||[];$.each(t,(function(t,i){i.properties.editable="Default"==e?i.originalProperties.editable:bizagi.util.parseBoolean(e)}))},refreshCell:function(e){var t=this,i=t.properties,r=e.key,a=e.column,n=""!==e.xpathContext?e.xpathContext+"."+t.properties.xpath+t.buildCellXpathFilter(r):t.properties.xpath+t.buildCellXpathFilter(r),o=t.getControlCell(r,e.column),s=t.getFormContainer().properties.id;if(o)return o.beforeToRefresh(),$.when(t.dataService.multiaction().refreshGridCell({idRender:i.id,column:o.properties.id,idPageCache:i.idPageCache,xpathContext:n,idForm:s,typeRender:bizagi.util.normalizeType(o.properties.type)})).done((function(e){var i=function(e){return e&&"object"==_typeof(e)&&e.length>=1?e[0].length>=1?e[0][0]:e[0]:""},n=i(e.rows),s=i(e.editable);bizagi.util.isBoolean(s)||(s=s||!0);var l=i(e.visible);bizagi.util.isBoolean(l)||(l=l||!0),t.changeCellVisibility(r,a,l),t.changeCellEditability(r,a,s);var d=o.formatValue(n);o.setValue(d),o.setDisplayValue(d),t.triggerRenderChange({key:r,column:a,changed:!1}),bizagi.override.restoreAppearanceAfterRefresh&&o.restoreCellAppearance(),null!=o.column&&"desktop"==bizagi.util.detectDevice()&&t.updateAffectedCellManually(r,d,o.column.columnIndex),t.afterToRefresh({action:"refreshCell"})}))},triggerRenderChange:function(e){e=e||{},bizagi.util.isEmpty(e)||0==e.changed||(this.properties.canBeExported=!1),this.triggerHandler("renderchange",{render:this,surrogateKey:e.key,column:e.column,changed:e.changed,rowDeleted:e.rowDeleted,pressed:e.pressed,id:e.id||""})},validate:function(){this.isValid([])},isValid:function(e){var t=!0;if(this.hasErrors=!1,this.setValidationMessage(""),this.properties.data&&this.properties.data.rows){var i=this.getDataNewRows();0==i.length&&bizagi.util.parseBoolean(this.properties.required)&&(this.hasValue()||(message=this.getResource("render-required-text").replaceAll("#label#",this.properties.displayName),e.push({xpath:this.properties.xpath,message:message}),t=!1));for(var r=$.merge($.merge([],this.properties.data.rows),i),a=0;a<this.columns.length;a++){for(var n=[],o={},s=0;s<r.length;s++){var l=r[s][a+1],d=r[s][0];this.columns[a].properties.xpath;void 0!==this.changes[d]&&void 0!==this.changes[d][this.columns[a].properties.xpath]&&(l=this.changes[d][this.columns[a].properties.xpath]),this.columns[a].isValueValid(d,l,n,this.getCellOverride(d,a))||(t=!1,this.hasErrors=!0,this.setError(d,this.columns[a].properties.xpath))}for(var c=0,u=n.length;c<u;c++)null==o[n[c]]&&(o[n[c]]=n[c]);if(n.length>0){var p=this.getResource("render-grid-validation").replaceAll("#grid#",this.properties.displayName);for(d in o)e.push({xpath:this.properties.xpath,message:p+" "+d})}}}return t},configureSubmitOnChange:function(){},getCellOverride:function(e,t){t=Number(t);var i=this.columns[t].properties;return this.cellOverrides[e]||(this.cellOverrides[e]={}),this.cellOverrides[e][t]||(this.cellOverrides[e][t]={visible:i.columnVisible&&i.visible,editable:i.editable,required:i.required}),this.cellOverrides[e][t]},setCellOverrides:function(e,t){var i;if(e.visible)for(var r=0,a=e.visible.length;r<a;r++){i=e.visible[r][0];for(var n=0,o=e.visible[r].length;n<o;n++)if(n>0){var s=this.getCellOverride(i,n-1).visible;this.cellOverrides[i][n-1].visible=!!s&&bizagi.util.parseBoolean(e.visible[r][n])}}if(e.editable)for(r=0,a=e.editable.length;r<a;r++){i=e.editable[r][0];for(n=0,o=e.editable[r].length;n<o;n++)if(n>0){var l=!t||bizagi.util.parseBoolean(t[n-1].properties.editable);this.getCellOverride(i,n-1).editable=!!l&&bizagi.util.parseBoolean(e.editable[r][n])}}if(e.required)for(r=0,a=e.required.length;r<a;r++){i=e.required[r][0];for(n=0,o=e.required[r].length;n<o;n++)n>0&&(this.getCellOverride(i,n-1).required=bizagi.util.parseBoolean(e.required[r][n]))}},getIndexes:function(){var e=$.merge(this.properties.data.rows,this.getDataNewRows());return $.map(e,(function(e,t){return e[0]}))},getDataNewRows:function(){var e=this,t=[];return"object"!=_typeof(e.newRecords)||$.isEmptyObject(e.newRecords)||$.each(e.newRecords,(function(i){var r=[];r.push(i);for(var a=0,n=e.columns.length;a<n;a++)r.push(e.getCellCurrentValue(i,e.columns[a].properties.xpath));t.push(r)})),t},getGridExportFile:function(e){var t=this.properties;return this.dataService.getGridExportFile({idRender:t.id,xpathContext:t.xpathContext||"",idPageCache:t.idPageCache,disposition:e.disposition,exportType:e.exportType,sort:t.sort,idForm:this.getFormContainer().properties.id}).then((function(e){return bizagi.util.handleJSONResponse(e)}))},submitForGridChange:function(){return this.submitOnChange(null,!1)},dispose:function(){var e=this,t=setTimeout((function(){e.columns&&$.each(e.columns,(function(e,t){t.dispose()})),clearTimeout(t)}),bizagi.override.disposeTime||50);e._super()},getEnabledChecks:function(e){var t=this,i=t.properties;e=e||{},$.extend(e,{url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,contexttype:i.contextType,idPageCache:i.idPageCache,rows:i.rowsPerPage,xpathfilter:e.xpath});var r=new $.Deferred;return t.dataService.multiaction().getGridDataExclusivesSelected(e).done((function(e){i.page=e.page,i.records=e.records,i.totalPages=e.totalPages,t.isRTL()&&(e.rows=t.changeOrderData(e.rows)),r.resolve(e)})),r.promise()},buildCellXpathFilter:function(e){return bizagi.util.isNumeric(e)?"[id="+e+"]":"[id='"+e+"']"},cleanNewRecords:function(){this.newRecords={}},setRowAsSaved:function(e){var t=this.getControl();$("[data-bizagi-component=rows]",t).find("tr[data-business-key="+e+"]").attr("data-new-row","false")},changeBackgroundColor:function(e){this._super(e);var t=this.getControl();return t.find(".bz-rn-grid-header-title, .bz-rn-grid-header-title-rtl").css("background-color",e,"!important"),t.find(".bz-rn-grid-container-foother, .bz-rn-grid-container-foother-rtl").css("background-color",e,"!important"),this},hasColorHeader:function(){var e=this.properties.headerFormat||{};return!!e&&!bizagi.util.isEmpty(e.color)},isRTLOrientation:function(e,t){return t&&"auto"!==t||!e?/^rtl$/i.test(t):this.isRTLOrientation(e.parent,e.properties.orientation)},canBeExport:function(){for(var e in this.changes)if("summary"!==e)for(var t in this.changes[e])if(this.canColumnBeSent(e,t))return!1;if(this.exclusiveChanges)for(var i in this.exclusiveChanges)if(this.exclusiveChanges[i]&&this.enabledChecks[i])return!1;return!0},getExclusiveChangeByRow:function(e){var t={};for(var i in this.enabledChecks)if(this.enabledChecks.hasOwnProperty(i)){var r=(this.enabledChecks[i]||[]).find((function(t){return t.id==e&&t.changed}));r&&(t[i]=r.value)}return t},isCurrentGridCell:function(e,t,i){return e===i||t===i||e+"."+t===i},getIndexForCurrentCell:function(e){var t=this;return(t.columns||[]).findIndex((function(i){return t.isCurrentGridCell(i.properties.xpath,i.properties.id,e)}))||0},isSummaryOrGlobalForm:function(){var e=this.getFormContainer(),t=e&&e.properties||{};return e&&["SummaryForm","GlobalForm"].includes(t.typeForm)}}),$.Class.extend("bizagi.rendering.hidden",{},{renderControl:function(){return"design"===this.getMode()?"<div>"+bizagi.localization.getResource("render-hidden-displayName")+"</div>":"<div />"},postRender:function(){var e=this.properties;this._super(),void 0!==e.value&&this.setDisplayValue(e.value)}}),$.Class.extend("bizagi.rendering.label",{},{initializeData:function(e){this._super(e),this.properties.required=!1,this.properties.displayType="label",this.properties.displayName=e.properties.displayName||"",bizagi.util.parseBoolean(this.properties.allowDinamiclabel)&&(this.properties.displayName=e.properties.displayName||bizagi.localization.getResource("render-label-default-display-name")),this.bindingValue(),this.calculateInitialLayoutProperties()},postRender:function(){this._super(),this.changeDisplayOption("label"),"function"==typeof this.configureHelpText&&this.configureHelpText()},postRenderReadOnly:function(){this._super(),this.changeDisplayOption("label"),this.changeLabelAlign(this.properties.labelAlign||"left")},isValid:function(e){},canBeSent:function(){return!1},bindingValue:function(){this.properties.allowDinamiclabel&&this.properties.value&&("object"===_typeof(this.properties.value)&&this.properties.value[0]?this.properties.displayName=this.properties.value[0].value:"string"==typeof this.properties.value&&""!==this.properties.value&&(this.properties.displayName=this.performLabelLineBreak(this.properties.value)))},controlValueIsChanged:function(){return!1},performLabelLineBreak:function(e){return(e||"").replace(/\\n/gm,"\n")}}),$.Class.extend("bizagi.rendering.search",{},{initializeData:function(e){var t=e.properties.submitOnChange;"execution"===this.getMode()&&e.properties.advancedSearch&&(t=void 0!==t?t:!((e.properties.submitVersion||1)>1)),this._super(e);var i=this.properties;i.submitOnChange=bizagi.util.parseBoolean(t)||!1,i.searchForms=i.searchForms||[],i.maxRecords=Number(i.maxRecords)||20,i.advancedSearch=null!==bizagi.util.parseBoolean(i.advancedSearch)&&bizagi.util.parseBoolean(i.advancedSearch),i.allowSuggest=null!==bizagi.util.parseBoolean(i.allowSuggest)&&bizagi.util.parseBoolean(i.allowSuggest),i.allowFullSearch=i.allowFullSearch||!1,i.allowAdd=bizagi.util.parseBoolean(i.allowAdd)||!1,i.allowTyping=null!==bizagi.util.parseBoolean(i.allowTyping)&&bizagi.util.parseBoolean(i.allowTyping),i.allowTyping=!!bizagi.util.parseBoolean(i.allowSuggest)||i.allowTyping,i.allowClear=null!==bizagi.util.parseBoolean(i.allowClear)&&bizagi.util.parseBoolean(i.allowClear),i.editable=null===bizagi.util.parseBoolean(i.editable)||bizagi.util.parseBoolean(i.editable),i.searchLength=i.searchLength||2,i.enableLocalStorage=!1,i.expireCache=9e5},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("search");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,allowTyping:e.allowTyping,advancedSearch:e.advancedSearch,allowSuggest:e.allowSuggest,editable:e.editable,allowClear:e.allowClear,hasValue:this.hasValue()})},getData:function(e){var t=this,i=t.properties,r=new $.Deferred,a=t.getFormContainer(),n=a.getContextType()||a.params.contexttype||!1;if(e=e||{},t.properties.contexttype?e.h_contexttype=t.properties.contexttype:n&&(e.h_contexttype=n),e.h_contexttype=t.properties.enableQuerySuggestBehavior?"metadata":e.h_contexttype,e&&e.h_contexttype&&"metadata"===e.h_contexttype&&(i.xpathContext=""),i.term.indexOf("'")>-1){var o=new RegExp("'","g");i.term=i.term.replace(o,"\\'\\'")}if(i.term.indexOf('"')>-1){o=new RegExp('"',"g");i.term=i.term.replace(o,'"')}return t.dataService.multiaction().getSearchData({url:i.dataUrl,contexttype:e.h_contexttype,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,term:i.allowFullSearch?"%"+i.term:i.term,extra:e}).done((function(e){i.data=e,r.resolve(i.data)})).fail((function(e){var i=e.hideStatus||!1;r.resolve({}),i||t.trigger("onSearchError",e)})),r.promise(r)},setValue:function(e,t){t=void 0===t||t,this._super(e,t),null!=e?(this.value=e,this.selectedValue=e.label):(this.value=null,this.selectedValue=null)},mapValue:function(e){return e&&e.fromAction?{id:e.value,value:e.label,label:e.label}:e},collectData:function(e){var t=this.properties.xpath,i=this.getValue();if(this.controlValueIsChanged()&&!bizagi.util.isEmpty(t)&&null!=i){if("object"==_typeof(i)&&void 0===i.id)return;e[t]=i}},submitData:function(){var e={};this.grid||(e[this.properties.xpath]=this.getValue()),this.submitOnChange(e,void 0,!1)},isValid:function(e){return this._super(e)},hasValue:function(){var e=this.getValue();return void 0!==e&&null!=e&&("object"===_typeof(e)&&""!==e.id&&void 0!==e.id||!bizagi.util.isEmpty(e))},formatItem:function(e){return bizagi.util.formatItem(e)}}),$.Class.extend("bizagi.rendering.text",{},{initializeData:function(e){this._super(e);var t=this.properties;if(t.regularExpressionExpression){var i=t.regularExpressionMessage||this.getResource("render-text-regular-expression-default-message");t.regularExpression={expression:t.regularExpressionExpression,message:i}}},renderControl:function(){var e=this.renderFactory.getTemplate("text");return $.fasttmpl(e,{id:this.properties.id,value:this.properties.value,isEmptyField:void 0===this.properties.value,helpText:this.properties.helpText,editable:this.properties.editable})},renderReadOnly:function(){var e=this.renderFactory.getTemplate("text-read-only"),t=this.getValue();return bizagi.util.isString(t)&&(t=t.replaceAll("`","&#96;")),$.fasttmpl(e,{value:t,editable:this.properties.editable})},postRender:function(){this._super(),this.input=this.getControl().find("input"),"double"===this.properties.retype&&this.attachRetypeDouble()},attachRetypeDouble:function(){},configureHandlers:function(){var e=this,t=e.properties;t.mask&&e.input.mask({mask:t.mask}),e.input.bind("change",(function(){e.setValue(e.input.val(),!1);"duplicate"!==t.retype&&(e.isValid([])||void 0===t.regularExpression)&&e.setValue(e.input.val(),!0)})).keypress((function(e){var t=(e=window.event||e).charCode||e.keyCode;void 0!==e&&13==t&&$(this).trigger("change")})),bizagi.util.isAndroidDevice()&&t.maxLength>0&&e.input.bind("keyup",(function(e){($(this).val()&&$(this).val().length)>=t.maxLength&&(e.preventDefault(),e.target.value=e.target.value.substring(0,t.maxLength))}))},isValid:function(e){var t=this.properties,i=this._super(e),r=this.getValue();if("string"==typeof r)if(t.regularExpression){if(t.editable){var a=new RegExp("");try{a=new RegExp(t.regularExpression.expression)}catch(r){bizagi.override.showDesignValidations&&(bizagi.log(r),e.push({xpath:t.xpath,message:r.message}),i=!1)}if(r&&(r.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!r.match(a)&&this.properties&&"userName"===this.properties.xpath)){var n=t.regularExpression.message;e.push({xpath:t.xpath,message:n}),i=!1}else if(r&&(r.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!r.match(a))){n=t.regularExpression.message;e.push({xpath:t.xpath,message:n}),i=!1}}}else if(r&&r.match(new RegExp(".*?eval\\(","g"))&&r.match(new RegExp(".*?eval\\u0028","g"))&&t.editable){n=this.getResource("render-text-regular-expression-default-message");e.push({xpath:t.xpath,message:n}),i=!1}return i},setDisplayValue:function(e){var t=this.getControl(),i=bizagi.util.decodeURI(e);if(!bizagi.util.parseBoolean(this.properties.editable))if("string"==typeof e){var r=bizagi.util.encodeHtmlText(this.getDisplayValue());t.html("<label class='readonly-control'>"+r+"</label>")}else bizagi.util.isNull(e)&&t.html("");this.setValue(i,!1)},setValue:function(e){this._super(e)},createTooltip:function(e,t,i){e.data("oldValue",t),e.val(""),e.data("ui-tooltip")&&e.tooltip("destroy"),e.attr("title",i),e.tooltip();var r=$.getMaxZindex();e.tooltip().on("tooltipopen",(function(e,t){t.tooltip.zIndex(r)})),e.tooltip("open");var a=setTimeout((function(){e.focus(),clearTimeout(a)}),100)},validateValue:function(e,t){return"string"!=typeof e||t<1||e.length<=t?e:e.substr(0,t)}}),$.Class.extend("bizagi.rendering.readonly",{},{initializeData:function(e){this._super(e)},renderControl:function(){var e=this.renderFactory.getTemplate("readonly-value"),t="execution"==this.getMode()?this.getFormattedValue(this.properties.value,this.properties.dataType):this.getDesignModeValue(this.properties.renderType);return $.fasttmpl(e,{id:this.properties.id,value:t})},renderReadOnly:function(){return this.renderControl()},setDisplayValue:function(e){},setValue:function(e,t){},getFormattedValue:function(e,t){return bizagi.util.isEmpty(e)?"":[1,2,3,4,7].includes(t)?e:[5,17].includes(t)?bizagi.util.formatBoolean(e):[8].includes(t)?bizagi.util.formatMonetaryValue(e):[6,10,11].includes(t)?bizagi.util.formatDecimalValue(e):[12,13].includes(t)?bizagi.util.formatDateValue(e):bizagi.util.sanitizeHTML(e)||""},getDesignModeValue:function(e){return"number"==e?"123":"string"==e?"abc":"date"==e?"1/1/1900":"boolean"==e?"false":"currency"==e?"$123":""},changeBackgroundColor:function(e){return void 0===e?this:("none"!==e?this.element.style("background",e,"important"):this.element.css("background",""),this)},getElementsToStylize:function(e){return $(".bz-input--readonly",e)}}),$.Class.extend("bizagi.rendering.button",{},{initializeData:function(e){this._super(e);var t=this.properties;t.caption=t.caption||"",t.displayType="value",t.required=!1,t.preventDefault=t.preventDefault||!1},renderControl:function(){var e=this.renderFactory.getTemplate("button");return $.fasttmpl(e,{caption:this.properties.caption,cssClass:this.properties.cssclass||"",editable:this.properties.editable})},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},postRender:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},saveForm:function(){return this.getFormContainer().saveForm()},executeButton:function(){var e=this,t=e.properties,i=t.xpathContext||"";return t.submitOnChangexpathContextRow&&(i=i?i+"."+t.submitOnChangexpathContextRow:t.submitOnChangexpathContextRow),e.getFormContainer().startLoading(),e.dataService.multiaction().executeButton({idRender:t.id,xpath:t.xpath||"",xpathContext:i||"",idPageCache:t.idPageCache}).always((function(){return e.getFormContainer().endLoading(),arguments?arguments[0]:void 0}))},refreshForm:function(){this.getFormContainer().refreshForm(this.properties.id)},processButton:function(){this.properties.editable&&this.runButtonAction()},triggerRenderChange:function(e){var t=(e=e||{}).pressed||!1;this.triggerHandler("renderchange",{render:this,pressed:t})},runButtonAction:function(){var e=this;e.getFormContainer().clearValidationMessages(),e.saveForm().pipe((function(){return e.executeButton()})).done((function(t){var i=t&&t.type?t.type:"";if(null==t||1==t||"success"===t.result||"success"===t.type)return e.refreshForm();if(["validationMessages","alertMessages"].includes(i))try{"alertMessages"===i?bizagi.modalError&&bizagi.modalError.show(t.messages.join("\n\n"),"workportal-general-word-information",!1):e.getFormContainer().addValidationMessage(t.messages)}catch(e){}})).fail((function(t){try{var i=bizagi.util.getErrorFormatted(t),r=void 0===i?{message:bizagi.localization.getResource("workportal-general-error")}:i;e.getFormContainer().failHandler(r)}catch(e){}}))},processLayout:function(e,t){e&&(this.changeBackgroundColor(t.background),this._super(!e,t))},changeBackgroundColor:function(e){return void 0===e?this:("none"!==e?this.getElementsToStylize(this.getControl()).style("background",e,"important"):this.getElementsToStylize(this.getControl()).css("background",""),this)},getElementsToStylize:function(e){return $("input",e)},canBeSent:function(){return!1},configureSubmitOnChange:function(){var e=this,t=e.properties,i="";if(t.editable){t.dependencies=t.dependencies||"all";var r={conditions:{expressions:[{simple:{renderId:i=t.submitOnChangexpathContext?t.submitOnChangexpathContext+"."+t.id:t.id,operator:"changes",argumentType:"const"}}]},commands:[{xpath:i,command:"submit-value",argument:t.dependencies}],dependencies:[i],elseCommands:[]};$.when(e.ready()).done((function(){e.getFormContainer().addSubmitAction(i,r)}))}}}),$.Class.extend("bizagi.rendering.fileprint",{},{initializeData:function(e){this._super(e);var t=this.properties,i=$.trim(t.caption);t.caption=bizagi.util.isEmpty(i)?"render-fileprint-property-caption":i,t.filesCount=t.filesCount?t.filesCount:0,t.displayType="value",this.calculateInitialLayoutProperties(),t.required=!1},renderControl:function(){var e=this.renderFactory.getTemplate("fileprint");return $.fasttmpl(e,{caption:this.properties.caption})},renderReadOnly:function(){return this.renderControl()},downloadFile:function(){return this.dataService.getFilePrint({idRender:this.properties.id,xpathContext:this.properties.xpathContext||"",idPageCache:this.properties.idPageCache,contexttype:this.properties.contexttype,disposition:"download"}).then((function(e){return bizagi.util.handleJSONResponse(e)}))}}),$.Class.extend("bizagi.rendering.link",{},{initializeData:function(e){this._super(e);var t=this.properties;t.required=!1,t.displayType="value",this.calculateInitialLayoutProperties()},renderControl:function(){var e=this.renderFactory.getTemplate("link");return $.fasttmpl(e,{displayName:this.properties.displayName,align:this.properties.valueAlign,editable:this.properties.editable})},postRender:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},isValid:function(e){},setDisplayValue:function(e){},canBeSent:function(){return!1}}),$.Class.extend("bizagi.rendering.geolocation",{},{init:function(e){this._super(e),this.geolocation=window.navigator.geolocation;var t=this.properties;t.allowUpdate=!0===bizagi.util.parseBoolean(t.allowUpdate)},renderControl:function(){var e=this.renderFactory.getTemplate("geolocation");return $.fasttmpl(e,this.properties)},isValid:function(e){return this._super(e)},setDisplayValue:function(e){this.setValue(e,!1)},configureHandlers:function(){},getCurrentPosition:function(e,t){var i=this;if(void 0!==i.geolocation){return i.geolocation.getCurrentPosition((function(t){e&&e(t)}),(function(e){var r=i.getErrorMessage(e);t&&t(r)}))}t&&t(bizagi.localization.getResource("render-control-unsuported-by-browser").replace("{0}",i.properties.type))},getErrorMessage:function(e){var t="";switch(e.code){case e.PERMISSION_DENIED:case 1:t=bizagi.localization.getResource("render-geolocation-permission-denied");break;case e.POSITION_UNAVAILABLE:case 2:t=bizagi.localization.getResource("render-geolocation-position-unavailable");break;case e.TIMEOUT:case 3:t=bizagi.localization.getResource("render-geolocation-timeout");break;default:t="WD: "+bizagi.localization.getResource("render-geolocation-permission-denied")}return t},performPrecision:function(e){var t=e.split(" ")||"";if(!t)return e;try{var i=parseFloat(t[0].trim()),r=parseFloat(t[1].trim());return i.toPrecision(10)+" "+r.toPrecision(10)}catch(t){return e}}}),$.Class.extend("bizagi.rendering.association",{},{initializeData:function(e){this._super(e);var t=this.properties;t.property="flipped",t.idRender=this.properties.id,t.allowFlip=void 0===t.allowFlip||bizagi.util.parseBoolean(t.allowFlip),t.flipped=void 0!==t.flipped&&bizagi.util.parseBoolean(t.flipped),t.flipstate=t.flipped,t.leftData=t.leftData||[],t.rightData=t.rightData||[],t.value&&this.processPropertyValue()},renderControl:function(){var e=this,t=e.renderFactory.getTemplate("association"),i=new $.Deferred;return e.properties.property="flipped",e.properties.idRender=e.properties.id,$.when(e.getFlipAssociation()).done((function(r){e.makeJsonBase(),e.properties.flipped=bizagi.util.parseBoolean(r)||!1;var a=$.fasttmpl(t,e.properties,{getColumnData:e.getColumnData,getRightAssociation:e.getRightAssociation});e.setValue(JSON.encode(e.properties.formatJson)),i.resolve(a)})),i.promise()},getFlipAssociation:function(){return"execution"==this.getMode()&&this.dataService.getFlipAssociation(this.properties)},getDisplayValue:function(){return this.getValue()},getTemplateName:function(){return"association"},getColumnData:function(){var e=this.data,t=[],i=e.flipped?e.rightData:e.leftData;return $.each(i,(function(e,i){t.push({id:i.id,value:i.value})})),t},getRightAssociation:function(e){var t=this.data,i=[],r=function(e,i){var r=!1;return $.each(t.formatJson.value,(function(t,a){!r&&a.id==e&&a.value.indexOf(i)>=0&&(r=!0)})),r};return t.flipped?$.each(t.leftData,(function(t,a){i.push({id:a.id,name:a.value,checked:r(a.id,e)})})):$.each(t.rightData,(function(t,a){i.push({id:a.id,name:a.value,checked:r(e,a.id)})})),i},removeElement:function(e,t){var i=this;$.each(i.properties.formatJson.value,(function(r,a){i.properties.flipped?a.id==t&&$.each(i.properties.formatJson.value[r].value,(function(t,a){e==a&&i.properties.formatJson.value[r].value.splice(t,1)})):a.id==e&&$.each(i.properties.formatJson.value[r].value,(function(e,a){t==a&&i.properties.formatJson.value[r].value.splice(e,1)}))})),i.setValue(JSON.encode(i.properties.formatJson))},addElement:function(e,t){var i=this;$.each(i.properties.formatJson.value,(function(r,a){i.properties.flipped?a.id==t&&i.properties.formatJson.value[r].value.push(e):a.id==e&&i.properties.formatJson.value[r].value.push(t)})),i.setValue(JSON.encode(i.properties.formatJson))},makeJsonBase:function(){this.properties.formatJson=this.properties.formatJson||{leftXpath:this.properties.leftXpath,rightXpath:this.properties.rightXpath,leftFactName:this.properties.leftFactName,rightFactName:this.properties.rightFactName,value:this.properties.value}},hasValue:function(){if(this.properties.formatJson)var e=this.properties.formatJson.value;else e=this.properties.value;for(var t=0,i=e.length;t<i;t++){var r=e[t];if(r&&r.value.length>0)return!0}return!1},processPropertyValue:function(){for(var e=this.properties,t=e.value,i=[],r=0,a=t.length;r<a;r++){var n=t[r];i.push({id:n[0],value:n[1]})}e.value=i}}),$.Class.extend("bizagi.rendering.upload",{},{initializeData:function(e){this._super(e);var t=this.getFormContainer(),i=this.properties,r=Number(i.maxSize)||0,a="undefined"!=typeof BIZAGI_SETTINGS&&void 0!==BIZAGI_SETTINGS.UploadMaxFileSize?Number(BIZAGI_SETTINGS.UploadMaxFileSize):4091904;if(i.maxSize=r||a,i.maxfiles=Number(i.maxfiles)||999,i.validExtensions=i.validExtensions||"",i.validExtensions.length>0&&i.validExtensions.indexOf(".")<0){for(var n=i.validExtensions.replace(/\ /gi,"").split(";"),o=[],s=0;s<n.length;s++)if(n[s].length>0)o.push("*."+n[s]);else{n.indexOf(n[s]);n.splice(s,1)}i.validExtensions=o.join(";")}i.addUrl=i.addUrl||this.dataService.getUploadAddUrl(),i.deleteUrl=i.deleteUrl||void 0,i.editable=bizagi.util.parseBoolean(i.editable)||!1,i.allowDelete=!(null===bizagi.util.parseBoolean(i.allowDelete)||!i.editable)&&bizagi.util.parseBoolean(i.allowDelete),i.contexttype=t.params&&t.params.data&&t.params.data.contextType?t.params.data.contextType:"",i.allowSendInMail=i.allowSendInMail||!1,this.files=i.value||[],this.filesCount=this.files.length},renderControl:function(){for(var e=this.properties,t=this.renderFactory.getTemplate("upload"),i=$.fasttmpl(t,{xpath:bizagi.util.encodeXpath(this.getUploadXpath()),editable:e.editable,haveFiles:0!==this.filesCount,noFiles:0===this.filesCount,allowSendInMail:e.allowSendInMail}),r="",a=0;a<this.filesCount;a++){var n={id:this.files[a][0],fileName:this.files[a][1]};r+=this.renderUploadItem(n)}return i=this.replaceFilesHtml(i,r)},renderReadOnly:function(){return this.renderControl()},renderUploadItem:function(e){var t=this.getMode(),i=this.getTemplateItemName(),r=this.renderFactory.getTemplate(i),a=this.getFormContainer(),n=a.params&&a.params.printversion,o=this.isExecutionMode()?this.buildItemUrl(e):"";return $.fasttmpl(r,{id:e.id,mode:t,url:o,allowDelete:this.properties.allowDelete,filename:bizagi.util.decodeURI(e.fileName),editable:this.properties.editable,printVersion:n||!1})},buildItemUrl:function(e){var t=this.properties,i=this.getFormContainer();return this.dataService.getUploadFileUrl({idRender:t.id,xpath:this.getUploadXpath(),xpathContext:t.xpathContext,idPageCache:t.idPageCache,fileId:e.id,sessionId:i.properties.sessionId,contexttype:t.contexttype})},replaceFilesHtml:function(e,t){return e.replace("{{files}}",t)},deleteUploadItem:function(e,t){var i=this,r=i.properties,a=i.getUploadXpath()+(bizagi.util.isNumeric(t)?"[id="+t+"]":"[id='"+t+"']");return i.dataService.deleteUploadFile({url:r.deleteUrl,idRender:r.id,xpath:a,xpathContext:r.xpathContext,idPageCache:r.idPageCache,contexttype:r.contexttype}).pipe((function(){i.filesCount=i.filesCount-1,i.files=$.grep(i.files,(function(e){return e[0]!=t}))}))},canBeSent:function(){return!1},setValue:function(e,t){this.files=e||[],this.filesCount=this.files.length,this._super(e,t)},getValue:function(){return this.files},isValid:function(e){var t,i=this.properties,r=!0;if(this.setValidationMessage(""),i.required&&i.editable){var a=this.grid&&this.grid.isFromCreatedRow.apply(this);if(this.filesCount<=0&&!a)(!this.grid||this.grid.properties.inlineEdit)&&(t=this.getResource("render-required-upload").replaceAll("#label#",i.displayName),e.push({xpath:i.xpath,message:t}),r=!1)}return r},buildAddParams:function(){var e=this.properties,t=this.getFormContainer(),i={},r=this.Class.BA_CONTEXT_PARAMETER_PREFIX;i[r+"xpath"]=this.getUploadXpath(),i[r+"idRender"]=e.id,i[r+"xpathContext"]=e.xpathContext,i[r+this.Class.BA_PAGE_CACHE]=e.idPageCache,i[this.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=t.properties.sessionId,i[r+"contexttype"]=e.contexttype;try{"undefined"!=typeof BIZAGI_SESSION_NAME?i[BIZAGI_SESSION_NAME]=t.properties.sessionId:i.JSESSIONID=t.properties.sessionId}catch(e){i.JSESSIONID=t.properties.sessionId}return i},getUploadXpath:function(){return this.properties.xpath},getUploadXpathContext:function(){return this.getXpathContext()||this.properties.xpathContext},checkRequired:function(e){var t=this.properties;if(bizagi.util.parseBoolean(t.required))if(this.grid&&!0===this.grid.properties.inlineAdd){if(!this.hasValue()&&!this.getControl().parents("tr").data("new-row"))return this.setRenderRequired(e,t),!1}else if(!this.hasValue())return this.setRenderRequired(e,t),!1;return!0},setRenderRequired:function(e,t){var i=this.getResource("render-required-text").replaceAll("#label#",t.displayName);e.push({xpath:t.xpath,message:i})},getTemplateItemName:function(){return"uploadItem"},formatValue:function(e){var t=function(e){return!(!e.uploadId||!e.fileName)},i=function(e){return!(!e[0]||!e[1])};return(e||[]).reduce((function(e,r){var a=!1,n=bizagi.util.bzValidator(r).add(t).validate((function(t){(a=t.errors&&!t.errors.length)&&e.push([r.uploadId,r.fileName])}));return a||n.add(i,"The value is not in a valid format").validate((function(t){t.errors&&t.errors.length>0?console.warn(t.errors):e.push([r])})),e}),[])}}),$.Class.extend("bizagi.rendering.ecm",{},{initializeData:function(e){this._super(e);var t=this.properties;if(t.maxSize=Number(t.maxSize)||("undefined"!=typeof BIZAGI_SETTINGS&&void 0!==BIZAGI_SETTINGS.UploadMaxFileSize?Number(BIZAGI_SETTINGS.UploadMaxFileSize):t.maxSize=Number(t.maxSize)||4091904),t.maxFiles=Number(t.maxfiles)||999,t.validExtensions=t.validExtensions||"",t.validExtensions.length>0&&t.validExtensions.indexOf(".")<0){for(var i=t.validExtensions.split(";"),r=0;r<i.length;r++)i[r]="*."+i[r];t.validExtensions=i.join(";")}t.addUrl=this.dataService.serviceLocator.getUrl("render-ecm-upload-url")+"?action=uploadECMFile",t.editUrl=this.dataService.serviceLocator.getUrl("render-ecm-upload-url")+"?action=updateECMFileContent",t.deleteUrl=t.deleteUrl||void 0,t.allowDelete=null===bizagi.util.parseBoolean(t.allowDelete)||bizagi.util.parseBoolean(t.allowDelete),t.q_xpath=bizagi.util.encodeXpath(t.xpath),t.showMetadata=void 0===t.showMetadata||null===t.showMetadata||bizagi.util.parseBoolean(t.showMetadata);var a=this.getResource("dateFormat"),n=this.getResource("timeFormat");t.displayValue="",t.showTime=void 0!==t.showTime&&bizagi.util.parseBoolean(t.showTime),t.dateFormat=t.dateFormat||a,t.timeFormat=t.timeFormat||n,t.fullFormat=t.dateFormat,this.files=t.value||[],this.filesCount=this.files.length,t.xpathContext=this.parent.properties.xpathContext||t.xpathContext||""},renderControl:function(e,t){var i=this,r=i.properties,a=i.renderFactory.getTemplate("ecm"),n=i.getMode(),o=new $.Deferred;r.value=t?[[t.idFileUpload,t.fileName]]:i.value;var s=$.fasttmpl(a,r,{getFileExtension:i.getFileExtension,isImage:i.isImage});if(null!=i.properties.value){var l=i.properties.value.length;0===l&&o.resolve(s),$.each(i.properties.value,(function(e,r){var a={};a.idFileUpload=r[0],a.fileName=r[1],a.idPageCache=i.properties.idPageCache,a.xpathContext=i.getXpathContext(),a.xPath=i.properties.xpath,a.editable=i.properties.editable,a.idAttrib=i.properties.idAttrib;var d=i.getFormContainer();d&&d.properties&&d.properties.sessionId&&(a.sessionId=d.properties.sessionId),"execution"===n&&$.when(i.renderFileLayout(a,t)).done((function(e){l--,bizagi.loader.productBuildToAbout&&0===bizagi.loader.productBuildToAbout.indexOf("10.4")&&(e=e.replaceAll("Handlers/MetadataFile","Handlers/Metadata")),s=i.replaceItemHtml(s,i.properties.id+"-"+a.idFileUpload,e),0===l&&o.resolve(s)}))}))}else o.resolve(s);return o.promise()},replaceItemHtml:function(e,t,i){return e.replace("{{"+t+"}}",i)},renderFileLayout:function(e,t){var i=this,r=i.getFormContainer(),a=i.renderFactory.getTemplate("ecm-metadata"),n=$.Deferred();return $.when(i.dataService.getECMMetadata(e),t?[t]:i.dataService.getFileProperties(e)).done((function(t,o){o[0].data=e,o[0].xpathContext=o[0].xpathContext||r.properties.xpathContext||"",o[0].xpath=i.properties.xpath,t[0].filename=e.fileName,t[0].url=i.buildItemUrl(o[0]),t[0].ecm_ecmStatus=o[0].ecmStatus,t[0].ecm_isVisible=o[0].isVisible,t[0].ecm_allowUpdateMetadata=o[0].allowUpdateMetadata,t[0].ecm_allowDelete=o[0].allowDelete,t[0].ecm_allowUpdateContent=o[0].allowUpdateContent,t[0].ecm_allowView=o[0].allowView,t[0].ecm_allowCheckOut=o[0].allowCheckOut,t[0].ecm_allowCancelCheckOut=o[0].allowCancelCheckOut,t[0].ecm_allowEdit=e.editable&&o[0].allowEdit,t[0].ecm_ecmStatus=o[0].ecmStatus,t[0].idFileUploads=o[0].idFileUpload,t[0].xpath=o[0].xpath,t[0].value=bizagi.util.parseBoolean(o[0].value),t[0].deviceType=bizagi.detectDevice();var s=$.fasttmpl(a,t[0]);n.resolve(s)})),n.promise()},isImage:function(e){var t=this.getFileExtension(e);return["JPG","JPEG","GIF","PNG","BMP"].indexOf(t.toUpperCase())>-1},replaceFilesHtml:function(e,t){return e.replace("{{files}}",t)},renderReadOnly:function(){return this.renderControl()},canBeSent:function(){return!1},buildItemUrl:function(e){var t=bizagi.cookie("JSESSIONID");return e.data||(e.data={fileName:e.fileName,idAttrib:e.idAttrib}),this.dataService.getECMFileUrl({idFileUpload:e.idFileUpload,xPath:e.xpath||e.xPath,xpathContext:e.xpathContext,idAttrib:e.data.idAttrib,idPageCache:this.properties.idPageCache,fileName:e.data.fileName.replace(/ /g,"_"),p_sessionId:t,sessionId:e.data.sessionId||""})},buildAddParams:function(){var e=this.properties,t={};return t.xPath=e.xpath,t.idAttrib=e.idAttrib,t.xpathContext=e.xpathContext,t.metaValues=[],t[this.Class.BA_CONTEXT_PARAMETER_PREFIX+this.Class.BA_PAGE_CACHE]=e.idPageCache,t},getFileExtension:function(e){return(e=e||"").split(".").pop()},setValue:function(e,t){var i=this.properties;this._super(e,t),this.files=i.value||[],this.filesCount=this.files.length?this.files.length:i.value},getXpathContext:function(){return this.properties.xpathContext||""},getUploadXpath:function(){return this.properties.xpath},deleteUploadItem:function(e,t){var i=this,r=i.properties,a={idFileUpload:t,xPath:r.xpath,idAttrib:r.idAttrib,idPageCache:r.idPageCache,xpathContext:i.getXpathContext()};return i.dataService.deleteECMFile(a).pipe((function(){i.filesCount=i.filesCount-1,i.files=$.grep(i.files,(function(e){return e[0]!=t}))}))},lockUploadItem:function(e){var t=this.properties,i={idFileUpload:e,xPath:t.xpath,idAttrib:t.idAttrib,idPageCache:t.idPageCache,xpathContext:this.getXpathContext()};return this.dataService.checkOutFile(i)},unlockUploadItem:function(e){var t=this.properties,i={idFileUpload:e,xPath:t.xpath,idAttrib:t.idAttrib,idPageCache:t.idPageCache,xpathContext:this.getXpathContext()};return this.dataService.cancelCheckOut(i)}}),$.Class.extend("bizagi.rendering.yesno",{},{initializeData:function(e){this._super(e);var t=this.properties;t.value=void 0!==t.value?bizagi.util.parseBoolean(t.value):null},renderControl:function(){var e=this.renderFactory.getTemplate("yesno"),t=bizagi.util.randomNumber(100,1e7);return $.fasttmpl(e,{id:t,editable:this.properties.editable})},getDisplayValue:function(){var e=this.getValue();return!0===bizagi.util.parseBoolean(e)?this.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e)?this.getResource("render-boolean-no"):""},hasValue:function(){var e=this.getValue();return!bizagi.util.isEmptyValue(e)&&null!==bizagi.util.parseBoolean(e)}}),$.Class.extend("bizagi.rendering.letter",{},{initializeData:function(e){this._super(e),this.letterOpened=!1},renderControl:function(){var e=this.renderFactory.getTemplate("letter");return $.fasttmpl(e)},renderReadOnly:function(){var e=this.renderFactory.getTemplate("letter.readonly");return $.fasttmpl(e)},getLetterContent:function(){return this.letterOpened=!0,this.dataService.getLetterContent({url:this.properties.getUrl,idRender:this.properties.id,xpath:this.getXpath(),xpathContext:this.getContextXpath(),idPageCache:this.properties.idPageCache})},saveLetterContent:function(e){return this.dataService.saveLetterContent({url:this.properties.saveUrl,idRender:this.properties.id,xpath:this.getXpath(),xpathContext:this.getContextXpath(),idPageCache:this.properties.idPageCache,content:e})},getCanGenerateLetter:function(){return this.dataService.getCanGenerateLetter({idRender:this.properties.id,xpath:this.getXpath(),xpathContext:this.getContextXpath(),idPageCache:this.properties.idPageCache})},saveForm:function(){return this.getFormContainer().saveForm()},isValid:function(e){var t,i=this.properties;return 0==bizagi.util.parseBoolean(i.visible)||(0==bizagi.util.parseBoolean(i.editable)||(this.setValidationMessage(""),!i.required||0!=this.letterOpened||(t=this.getResource("render-letter-required-text").replaceAll("#label#",i.displayName),e.push({xpath:i.xpath,message:t}),!1)))},getXpath:function(){return this.properties.xpath},getContextXpath:function(){return this.properties.xpathContext}}),$.Class.extend("bizagi.rendering.formLink",{},{initializeData:function(e){this._super(e);var t=this.properties;t.displayType="value",t.maximized=null!=bizagi.util.parseBoolean(this.properties.maximized)&&bizagi.util.parseBoolean(this.properties.maximized),this.calculateInitialLayoutProperties()},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("formLink");return $.fasttmpl(t,{id:e.id,align:e.valueAlign,displayName:e.displayName,value:e.value,editable:e.editable,likeButton:bizagi.util.parseBoolean(e.likeButton)||!1})},renderReadOnly:function(){return this.renderControl()},postRender:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},postRenderReadOnly:function(){this._super(),this.getLabel().addClass("bz-form-label--hidden")},submitEditRequest:function(){var e=this.properties;return e.editable||e.value?this.dataService.editLinkForm({url:e.editUrl,idRender:e.id,xpath:this.getFormLinkXpath(),xpathContext:e.xpathContext,idPageCache:e.idPageCache}):null},submitSaveRequest:function(e){var t=this,i=t.properties;if(!i.editable&&!i.value)return null;var r=t.getFormLinkXpath(),a=r;return void 0!==i.xpathContext&&""!==i.xpathContext&&(a=r?i.xpathContext+"."+r:i.xpathContext),t.dataService.saveLinkForm({url:i.saveUrl,idRender:i.id,xpathContext:a,submitData:e}).done((function(e){var i=!0;e&&"validationMessages"===e.type&&(i=!1),i&&t.submitOnChange({})}))},saveFormLinkData:function(e){var t=this.properties,i=this.getFormLinkXpath(),r=i;void 0!==t.xpathContext&&""!==t.xpathContext&&(r=i?t.xpathContext+"."+i:t.xpathContext);var a=$.extend({},e);return delete a.idPageCache,$.when(bizagi.util.isEmpty(a)?void 0:this.dataService.multiaction().submitData({action:"SAVE",data:a,idPageCache:e.idPageCache,xpathContext:r}))},submitRollbackRequest:function(e){var t=this,i=t.properties;return $.when(i.editable||i.value?t.dataService.rollbackLinkForm({url:i.rollbackUrl,idRender:i.id,xpath:t.getFormLinkXpath(),xpathContext:i.xpathContext,idPageCache:e?e.idPageCache:i.idPageCache}):null)},submitCommitRequest:function(){var e=this,t=e.properties;return $.when(t.editable||t.value?e.dataService.commitLinkForm({url:t.commitUrl,idRender:t.id,xpath:e.getFormLinkXpath(),xpathContext:t.xpathContext,idPageCache:t.idPageCache}):null)},submitCheckpointRequest:function(){var e=this,t=e.properties;return $.when(t.editable||t.value?e.dataService.sendCheckpoint({url:t.checkpointUrl,idRender:t.id,xpath:e.getFormLinkXpath(),xpathContext:t.xpathContext,idPageCache:t.idPageCache}):null)},submitDataRequest:function(){var e=this,t=e.properties;return $.when(t.editable||t.value?e.dataService.submitData({url:t.checkpointUrl,action:"SUBMITDATA",idRender:t.id,xpath:e.getFormLinkXpath(),xpathContext:t.xpathContext,idPageCache:t.idPageCache}):null)},isValid:function(e){},getFormLinkXpath:function(){return this.properties.xpath},canBeSent:function(){return!1},setDisplayValue:function(e){},cleanData:function(){}}),$.Class.extend("bizagi.rendering.cascadingCombo",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX},{init:function(e){this._super(e),this.dependants=[],this.isDependant=!1},initializeData:function(e){this._super(e);var t=this.properties;t.hasLocalData=!!bizagi.util.isEmpty(t.parentCombo)&&t.hasLocalData,t.value&&void 0===t.value.id&&(t.value=null),this.value=t.value,t.hasLocalData&&(t.data=this.complementData(t.data))},renderControl:function(){var e=this.getMode(),t=this.parentCombo=this.getParentCombo();if(null!=t){var i=bizagi.util.normalizeType(t.properties.type);/^cascadingcombo$/i.test(i)&&(this.isDependant=!0)}this.initializingCascadingCombo=!0;var r=this._super();return"execution"!==e&&(this.initializingCascadingCombo=!1),r},configureHandlers:function(){this.initializingCascadingCombo=!1,this.isDependant&&this.parentCombo.bindDependantCombo(this)},configureHandlersReadOnly:function(){this.initializingCascadingCombo=!1,this.isDependant&&this.parentCombo.bindDependantCombo(this)},refresh:function(e,t){var i=this;$.when(i.isRendered()).done((function(){var r=i.getControl(),a=i.getMode();r.empty(),$.when(i.renderCombo(e)).then((function(e){r.html(e),i.postRender(),"execution"==a&&i.configureHandlers(),void 0!==i.getValue()&&i.setDisplayValue(i.getValue()),i.deferredVisible&&i.deferredVisible.resolve(),i.trigger("select",[i.value,t])}))}))},getData:function(e){if("execution"!=this.getMode())return this.getDummyData();if(this.isDependant){this.parentCombo&&e&&(this.properties.remoteDataLoaded=!1);var t=this.parentCombo.selectedValue?this.parentCombo.selectedValue.id:"";return""!=t?((e=e||{})[this.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]||(e[this.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]=t),this._super(e)):[]}return this._super(e)},bindDependantCombo:function(e){var t=this,i=bizagi.util.normalizeType(e.properties.type);/^cascadingcombo$/i.test(i)&&(t.dependants.push(e),e.onChangeFunction=function(i,r,a){t.refreshDependantCombo(e,r.id,t.focusDependant,a),a||e.cleanInput()},t.isEventBinded("select")||t.bind("select",e.onChangeFunction),bizagi.util.isEmpty(t.getValue())||t.properties.hasLocalData&&t.refreshDependantCombo(e,t.getValue().id))},isEventBinded:function(e){return void 0!==$._data(this.observableElement.get(0),"events")&&void 0!==$._data(this.observableElement.get(0),"events")[e]},unbindDependantCombo:function(e){this.unbind("select",e.onChangeFunction)},refreshDependantCombo:function(e,t,i,r){var a={};a[this.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]=t,e.deferredVisible=$.Deferred(),r||e.setValue("",!1),e.refresh(a,r),i&&$.when(e.deferredVisible.promise()).done((function(){e.inputCombo.trigger("click")}))},emptyControlByChangeEditability:function(){this.getControl().empty()},cleanInput:function(){this.triggerHandler("select",{id:0})},getParentCombo:function(){var e=this.properties;if(void 0===e.parentCombo)return null;for(var t=this.getFormContainer(),i=bizagi.util.normalizeType(this.properties.type),r=/^cascadingcombo$/i.test(i)?t.getRenderByType(e.type):[],a=0,n=0,o=[],s=null;a<r.length;a++)e.parentCombo===r[a].properties.id&&o.push({control:r[a],index:a});if(o.length>1){for(var l,d;n<o.length;n++)if(l=(d=o[n].control.properties.xpath.split(".")).length,d.slice(0,l-1).join(".")===e.xpath){s=r[o[n].index];break}}else s=t.getRenderById(e.parentCombo);return s},canBeSent:function(){return this._super()&&bizagi.util.isMapEmpty(this.dependants)},showCurrentData:function(){return"execution"!=this.getMode()},configureSubmitOnChange:function(){this.configured||(this._super(),this.configured=!0)},internalSubmitOnChange:function(e,t){var i=new $.Deferred;return this.isDependant&&this.canBeSent()&&void 0!==this.itemSelected?this._super(e,t):i.resolve()},internalSetInitialValue:function(){this._super(),this.value&&0==this.isDependant&&(this.internalSetInitialValueFlag=!0,this.trigger("select",[this.value,!0])),this.internalSetInitialValueFlag=!1}}),$.Class.extend("bizagi.rendering.list",{},{initializeData:function(e){this._super(e);var t=this.properties;t.listSize=t.listSize||0},getTemplateName:function(){return"list"},showCurrentData:function(){return!1}}),$.Class.extend("bizagi.rendering.multiSelect",{},{initializeData:function(e){this._super(e),Array.isArray(this.value)&&(this.value=this.properties.value=JSON.encode({value:this.value}),this.properties.originalValue=this.properties.previousValue=this.value);var t=this.properties;t.editable=null===bizagi.util.parseBoolean(t.editable)||bizagi.util.parseBoolean(t.editable),t.enableTyping=null===bizagi.util.parseBoolean(t.enableTyping)||bizagi.util.parseBoolean(t.enableTyping),t.maxRecords=Number(t.maxRecords)||20},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("list-multiselect");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,editable:e.editable,align:e.valueAlign},{formatItem:this.formatItem})},renderReadOnly:function(){var e=this.properties,t=this.renderFactory.getTemplate("list-multiselect");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,editable:e.editable,align:e.valueAlign},{formatItem:this.formatItem})},getData:function(){var e=this,t=new $.Deferred,i=this.properties;return e.dataService.multiaction().getData({url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,contexttype:i.contexttype||null,idPageCache:i.idPageCache}).done((function(r){i.data=e.normalizeData(r),t.resolve(i.data)})).fail((function(i){var r=!0,a=e.getFormContainer();bizagi.util.isNativeMobileDevice()&&void 0!==a&&(r=a.allowOnlineActions()),"not-processed"===i.type&&r||t.reject(i)})),t.promise()},setValue:function(e,t){t=void 0===t||t,Array.isArray(e)&&(e=JSON.encode({value:e})),this._super(e,t)},setDisplayValue:function(e){this.setValue(e,!1)},canBeSent:function(){return!0},getValue:function(){return this.value||[]},getDataValue:function(){try{return JSON.parse(this.value).value||[]}catch(e){return[]}},hasValue:function(){var e=this.getDataValue();return e&&e.length>0},getElementsToStylize:function(e){return $(".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)",e)},addElement:function(e){var t=this.getDataValue();t.push(e),this.setValue(t)},removeElement:function(e){var t=e.id,i=this.getDataValue().filter((function(e){return e.id!==t}));this.setValue(i)},submitData:function(){var e={};e[this.properties.xpath]=this.getValue(),this.submitOnChange(e)},markAsChecked:function(e){var t=this;return t.selected.some((function(i,r){var a=i.id===e;return a&&t.selected.splice(r,1),a}))},isChecked:function(e,t){return e.some((function(e){return e.id==t}))},canAddMoreItems:function(e){var t=this;return parseInt(e.css("width"))>e.children().toArray().reduce((function(e,i){return e+=t.getElementWidth(i)}),0)+t.Class.MORE_OPTION_WIDTH},getElementWidth:function(e){var t=window.getComputedStyle(e);return $(e).outerWidth()+["padding-left","padding-right","margin-left","margin-right"].reduce((function(e,i){return e+=parseInt(t[i])}),0)},filterList:function(e,t){t.filter((function(){var t=$(this).text().toUpperCase(),i=e.toUpperCase();if(t.indexOf(i)>=0)return $(this);$(this).hide()})).show()},addSelectedElements:function(){},findItemById:function(e){return(this.properties.data||[]).find((function(t){return t.id==e}))},formatItem:function(e){return bizagi.util.formatItem(e)},normalizeData:function(e){return(e||[]).forEach((function(e){e.value=void 0!==e.value&&null!==e.value?e.value:""})),e}}),$.Class.extend("bizagi.rendering.searchList",{},{initializeData:function(e){this._super(e);var t=this.properties;t.maxRecords=Number(t.maxRecords)||20,t.editable=null===bizagi.util.parseBoolean(t.editable)||bizagi.util.parseBoolean(t.editable),this.setValue(t.value)},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("searchList");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,value:e.value,allowTyping:e.allowTyping,items:e.value,hasSearchForm:!!e.searchForms,editable:e.editable},{formatItem:this.formatItem})},renderReadOnly:function(){return this.renderControl()},setValue:function(e){this.value=JSON.encode({value:e}),this.triggerRenderChange()},addElement:function(e){var t=JSON.parse(this.value);t.value.push(e),this.setValue(t.value)},removeElement:function(e){var t=JSON.parse(this.value),i=[];$.each(t.value,(function(t,r){r.id!=e.id&&i.push({id:r.id,value:r.value})})),this.setValue(i)},removeLastElement:function(){var e=JSON.parse(this.value);e.value.length>0&&(e.value.pop(),this.setValue(e.value))},getData:function(e){var t=this,i=t.properties,r=new $.Deferred;return t.dataService.getSearchData({url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,term:i.term,extra:e}).done((function(e){i.data=e,r.resolve(i.data)})).fail((function(e){var i=e.hideStatus||!1;r.resolve({}),i||t.trigger("onSearchError",e)})),r.promise()},submitData:function(){var e={};e[this.properties.xpath]=this.getValue(),this.submitOnChange(e)},canBeSent:function(){return!0},hasValue:function(){return this.getListItems().length>0},getListItems:function(){var e=this.getValue();return("string"==typeof e?JSON.parse(e).value:e.value)||[]},formatItem:function(e){return bizagi.util.formatItem(e)}}),$.Class.extend("bizagi.rendering.handSignature",{},{BASE_IMAGE:"data:image/png;base64,",EMPTY_IMAGE:"R0lGODlhAQABAIAAAP7//wAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==",EMPTY_VALUE:"",DELAY_TO_SAVE:1e3,RESOURCES_FALLBACK:{DONE_BUTTON:"Done",EDIT_BUTTON:"Edit",CLEAR_BUTTON:"Clear",UPLOAD_SUCCESS:"Your signature have been uploaded successfully",UPLOAD_ERROR:"The signature have not been uploaded. Try again",TITLE_DONE:'Click "Done" to upload the signature',TITLE_DRAW:"Draw here your signature",TITLE_EDIT:'Click "Edit" to start drawing'},STATE_TYPE:{edit:1,draw:2,done:3,success:4,error:5},pluginInitialized:!1,saveDeferred:null,saveTimestamp:0,initializeData:function(e){this._super(e);var t=this.properties;t.editable=!0===bizagi.util.parseBoolean(t.editable),t.addUrl=t.addUrl||this.dataService.serviceLocator.getUrl("form-submit-data-upload"),t.deleteUrl=t.deleteUrl||this.dataService.serviceLocator.getUrl("render-upload-delete-url"),t.isChanged=!1,this.currentState=this.STATE_TYPE.edit},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate("hand-signature");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,editable:e.editable,isDesign:!this.isExecutionMode(),render_signature_action_edit:this.getResourceByKey("render-signature-action-edit",this.RESOURCES_FALLBACK.EDIT_BUTTON),render_signature_action_done:this.getResourceByKey("render-signature-action-done",this.RESOURCES_FALLBACK.DONE_BUTTON),render_signature_action_clear:this.getResourceByKey("render-signature-action-clear",this.RESOURCES_FALLBACK.CLEAR_BUTTON)})},postRender:function(){var e=this;if(this.isExecutionMode()){var t=e.getSignatureContainer();e.setResizeObserver(t,(function(i){e.renderSignature(),e.setState(e.currentState),[e.STATE_TYPE.draw,e.STATE_TYPE.done].includes(e.currentState)&&t.BzjSignature("enable")}))}},postRenderReadOnly:function(){var e=this;if(this.isExecutionMode()){var t=e.getSignatureContainer();e.setResizeObserver(t,(function(){e.renderSignature()}))}},renderReadOnly:function(){var e=this.properties,t=this.renderFactory.getTemplate("hand-signature-readonly");return $.fasttmpl(t,{id:e.id,xpath:e.xpath,editable:e.editable,isDesign:!this.isExecutionMode()})},setData:function(e){var t=this.getData();if(bizagi.util.isEmpty(e)?this.properties.binaryValue=null:e instanceof Blob?this.properties.binaryValue=e:this.properties.binaryValue=bizagi.util.b64toBlob(e,"image/png"),t!=this.properties.binaryValue){if(this.properties.required&&this.isExecutionMode()){var i=!this.checkRequired([]);this.changeRequiredLabel(i)}this.properties.isChanged&&(this.triggerRenderChange(),this.triggerRenderValidate())}},getData:function(){return this.properties.binaryValue||[]},getBase64:function(){return this.properties.base64||""},getValue:function(){return this.properties.value||[]},hasValue:function(){if(this.pluginInitialized){var e=this.getData();return!bizagi.util.isEmpty(e)}return!bizagi.util.isEmpty(this.properties.value)},isValid:function(e){if(!1===bizagi.util.parseBoolean(this.properties.visible))return!0;if(!1===bizagi.util.parseBoolean(this.properties.editable))return!0;if(this.setValidationMessage(""),this.properties.required&&!this.hasValue()){var t=this.getResource("render-required-text").replaceAll("#label#",this.properties.displayName);return e.push({xpath:this.properties.xpath,message:t}),!1}return!0},canBeSent:function(){return!this.getFormContainer().isOfflineForm||this.properties.isChanged},processUploadFile:function(e){var t={url:this.properties.addUrl,formData:this.buildAddFileParams(e)};return this.dataService.processUploadFile(t)},buildAddFileParams:function(e){var t=this.properties,i=this.Class.BA_CONTEXT_PARAMETER_PREFIX,r=new FormData,a=this.getFormContainer();r.append(i+"xpath",t.xpath),r.append(i+"idRender",t.id),r.append(i+"xpathContext",t.xpathContext),r.append(i+this.Class.BA_PAGE_CACHE,t.idPageCache),r.append(this.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId",a.properties.sessionId),r.append(i+"action","savefile");var n="signature_"+bizagi.util.randomNumber()+".png";r.append(this.properties.xpath,e,n),t.contexttype&&r.append(i+"contexttype",t.contexttype);try{"undefined"!=typeof BIZAGI_SESSION_NAME?r.append(BIZAGI_SESSION_NAME,a.properties.sessionId):r.append("JSESSIONID",a.properties.sessionId)}catch(e){r.append("JSESSIONID",a.properties.sessionId)}return r},buildItemUrl:function(){var e=this,t=e.getFormContainer(),i=e.properties,r=t.properties.compatibilityVersion>=2,a="";if(!this.isExecutionMode())return $.Deferred().resolve(a).promise();var n={url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,property:"fileFullContent",queue:"onlineimages",sessionId:t.properties.sessionId,contexttype:i.contexttype||void 0,dataType:"text"};return r?bizagi.util.isEmpty(e.properties.value)&&!e.hasValue()?$.Deferred().resolve("").promise():(n.property="fileBinaryContent",n.sessionId=t.properties.sessionId,e.dataService.downloadFile(n).then((function(t){return e.setData(t),null==t||window.Blob&&t instanceof Blob&&0===t.size?null:bizagi.util.blobTob64(t,!1)})).then((function(e){return bizagi.util.getDataUrl(e,i.url)}))):e.dataService.multiaction().getPropertyData(n,"text").then((function(t){return'"'===t.charAt(0)&&(t=t.slice(1,-1)),""!==t&&(a=e.BASE_IMAGE+t),e.setData(bizagi.util.b64toBlob(t)),a}))},executeFormFailHandler:function(e){var t=bizagi.util.getErrorFormatted(e),i=t;(void 0===t||t&&!t.message)&&(i=Object.assign({},"object"===_typeof(t)?t:{},{message:bizagi.localization.getResource("workportal-general-error")})),this.getFormContainer().failHandler(i)},saveSignature:function(e){var t=this,i=new $.Deferred,r=t.getFormContainer();return r.useOrSetLoaderDeferred(),r.appendWaitForLoader({promise:i.promise()}),$.when(t.postSignature(e)).then((function(e){t.setData(e),t.properties.url=bizagi.util.getDataUrl(e,t.EMPTY_VALUE),t.executePartialSaveForm(),i.resolve()})).fail((function(e){t.executeFormFailHandler(e),i.reject()}))},executePartialSaveForm:function(){var e={},t=this.getFormContainer();t.isOfflineForm&&(this.collectDataToSave(e),t.partialSubmitFormOffline(e).then((function(){})))},deleteImage:function(){return this.dataService.deleteImage({url:this.properties.deleteUrl,idRender:this.properties.id,xpath:this.properties.xpath,xpathContext:this.properties.xpathContext,idPageCache:this.properties.idPageCache,contexttype:this.properties.contexttype})},postSignature:function(e){var t=e.replace(/^data:image\/(png|jpg|jpeg);base64,/,"");return this.postSignatureOnline(t)},postSignatureOnline:function(e){var t=this,i=t.getDataFileFromSignature(e);return bizagi.util.isEmpty(i)?t.getData():t.processUploadFile(i).then((function(){return t.properties.isChanged=!0,e}))},emptyControlByAsyncRenderDeferred:function(){this.getControl().empty()},saveImageOffline:function(e){var t=this,i=t.buildOfflineImageId();return $.when(e).then((function(e){var r=t.getFormParams(),a={idCase:r.idCase,idWorkitem:r.idWorkitem,id:i,operationType:"edition",offlineType:r.offlineType};return t.dataService.saveOfflineImage(a,e)}))},collectDataToSave:function(e){if(this.isOfflineForm&&bizagi.util.isOfflineFormsV2Supported()){if(!this.properties.isChanged)return;e[this.properties.xpath]={offlineId:this.buildOfflineImageId(),name:this.dataService.fileService.getOfflineImageName(this.getValue()),isSignature:!0}}},collectData:function(e){var t=this;if(0!=t.saveTimestamp){var i=(new Date).getTime()-t.saveTimestamp;if(i<t.DELAY_TO_SAVE){var r=new $.Deferred;setTimeout((function(){$.when(t.saveDeferred).always((function(){r.resolve()}))}),t.DELAY_TO_SAVE+10-i),e.deferreds=e.deferreds||[],e.deferreds.push(r.promise())}else t.saveDeferred&&(e.deferreds=e.deferreds||[],e.deferreds.push(t.saveDeferred.promise()))}},buildItemUrlOffline:function(){var e=this,t=e.properties,i=e.getFormParams(),r=e.buildOfflineImageId(),a=!t.isChanged,n={idCase:i.idCase,idWorkitem:i.idWorkitem,id:r,offlineType:i.offlineType,loadImageFromForm:a};return $.when(e.dataService.getOfflineImage(n,bizagi.util.db.AttachmentType.Blob)).then((function(t){return e.setData(t),null==t||window.Blob&&t instanceof Blob&&0===t.size?null:bizagi.util.blobTob64(t,!1)})).then((function(e){return bizagi.util.getDataUrl(e,t.url)}))},setState:function(e){var t=$(".bz-actions",this.getControl()),i="";switch(this.currentState=e,e){case this.STATE_TYPE.edit:i=this.getResourceByKey("render-signature-title-edit",this.RESOURCES_FALLBACK.TITLE_EDIT);break;case this.STATE_TYPE.draw:i=this.getResourceByKey("render-signature-title-draw",this.RESOURCES_FALLBACK.TITLE_DRAW);break;case this.STATE_TYPE.done:i=this.getResourceByKey("render-signature-title-done",this.RESOURCES_FALLBACK.TITLE_DONE)}$(".bz-actions__status",t).text(i),this.setActions(e)},setActions:function(e){var t=$(".bz-actions",this.getControl());[this.STATE_TYPE.draw].includes(e)?(t.find("[data-action='edit']").addClass("bz-hidden"),t.find("[data-action='clear']").removeClass("bz-hidden"),t.find("[data-action='save']").removeClass("bz-hidden")):[this.STATE_TYPE.edit].includes(e)&&(t.find("[data-action='edit']").removeClass("bz-hidden"),t.find("[data-action='clear']").addClass("bz-hidden"),t.find("[data-action='save']").addClass("bz-hidden"))},buildOfflineImageId:function(){var e=this.getFormContainer(),t=e.properties.compatibilityVersion>=2,i=!e.properties.isTaskForm;return this.dataService.fileService.buildOfflineImageId(this.properties.value,this.properties.xpathContext,this.properties.xpath,t,i)},buildOfflineFileLoadingKey:function(){var e=this.getFormContainer(),t=e.getParams().idCase,i=e.getParams().idWorkitem,r=t;return bizagi.util.isEmpty(i)||(r+="-"+i),r+="-",bizagi.util.isEmpty(this.properties.xpathContext)||(r+="-"+this.properties.xpathContext),r+=this.properties.xpath},getDataFileFromSignature:function(e){try{var t=atob(e),i=bizagi.util.stringToByteArray(t);return new Blob([new Uint8Array(i)],{type:"image/png"})}catch(e){return""}},setSignature:function(e){var t=this.properties&&this.properties.url;try{bizagi.util.isEmpty(t)||(e.BzjSignature("reset"),e.BzjSignature("setData",t))}catch(e){}},setResizeObserver:function(e,t){var i=0;new ResizeObserver((function(e){var r=e[0];r.contentRect&&i!==r.contentRect.width&&0!==r.contentRect.width&&(i=r.contentRect.width,"function"==typeof t&&t())})).observe(e.get(0))},getSignatureContainer:function(e){var t=e||".bz-signature__container";return this.getSignatureContext(t)},getSignatureContext:function(e){var t=this.getControl();return $(e,t)},onSignatureClear:function(){},cleanData:function(){var e=this.getFormContainer(),t=this.onSignatureClear(this.getSignatureContainer());return e.useOrSetLoaderDeferred(),e.appendWaitForLoader({promise:t.promise()}),t}}),$.Class.extend("bizagi.rendering.money",{},{initializeData:function(e){this._super(e);var t=this.properties,i=this.getResource("numericFormat");if(t.showsymbol=void 0===t.showsymbol||t.showsymbol,t.showsymbol){var r="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:i.symbol;t.symbol=t.currencySymbol?t.currencySymbol:r}else t.symbol="";t.groupDigits=!0}}),$.Class.extend("bizagi.rendering.radio",{},{initializeData:function(e){this._super(e);var t=this.properties;t.horizontal=bizagi.util.parseBoolean(t.horizontal)||!1,t.unique=bizagi.util.randomNumber(1e3,1e6)},getTemplateName:function(){return"radio"},showEmpty:function(){return!1},showCurrentData:function(){return!1},getTemplateParams:function(){var e=this.properties;return{vertical:!e.horizontal,horizontal:e.horizontal}},cleanData:function(){var e={id:"",label:""};this.element.find(".ui-radio-state-checked").removeClass("ui-radio-state-checked"),this.setDisplayValue(e),this.setValue(e,!1),this.clearDisplayValue()},controlValueIsChanged:function(){var e=this.properties,t=this.getValue(),i=e.originalValue,r=e.defaultValue;return t&&void 0!==t.length&&(t=t[0]),i&&void 0!==i.length&&(i=i[0]),r&&void 0!==r.length&&(r=r[0]),t=t&&void 0!==t.id?t.id:t,i=i&&void 0!==i.id?i.id:i,void 0!==(r=r&&void 0!==r.id?r.id:r)?(r!=t||t!=i)&&((null!==t&&""!==t||null!==i&&""!==i)&&i!=t):(null!==t&&""!==t||null!==i&&""!==i)&&i!=t},emptyControlByAsyncRenderDeferred:function(){this.getControl().empty()}}),$.Class.extend("bizagi.rendering.image",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{BASE_IMAGE:"data:image/png;base64,",initializeData:function(e){this._super(e);var t=this.properties,i=4091904;if(t.maxSize?i=Number(t.maxSize):"undefined"!=typeof BIZAGI_SETTINGS&&void 0!==BIZAGI_SETTINGS.UploadMaxFileSize&&(i=Number(BIZAGI_SETTINGS.UploadMaxFileSize)),t.maxSize=i,t.editable=!0===bizagi.util.parseBoolean(t.editable),t.validExtensions=t.validExtensions||"",t.isChanged=!1,t.validExtensions.length>0&&t.validExtensions.indexOf(".")<0){for(var r=t.validExtensions.replace(/\ /gi,"").split(";"),a=0;a<r.length;a++)if(0!=r[a].length)r[a]="*."+r[a].replaceAll(" ","");else{r.indexOf(r[a]);r.splice(a,1)}t.validExtensions=r.join(";")}t.addUrl=t.addUrl||this.dataService.getUploadAddFileUrl(t.isUserPreference),t.allowDelete=null!==bizagi.util.parseBoolean(t.allowDelete),this.formCompatibilityVersion=this.getFormContainer().compatibilityVersion,this.initializeWidthAndHeight()},initializeWidthAndHeight:function(){var e=this.properties;e.isAutoWidth=!1,e.isAutoHeight=!1,-1===e.width?(e.width="100%",e.isAutoWidth=!0):e.width=e.width+"px",-1===e.height?(e.height="auto",e.isAutoHeight=!0):e.height=e.height+"px"},setData:function(e){var t=this.getData();if(bizagi.util.isEmpty(e)?this.properties.binaryValue=null:this.properties.binaryValue=e instanceof Blob?e:bizagi.util.b64toBlob(e,"image/png"),t!=this.properties.binaryValue){if(this.properties.required&&this.isExecutionMode()){var i=!this.checkRequired([]);this.changeRequiredLabel(i)}this.properties.isChanged&&(this.triggerRenderChange(),this.triggerRenderValidate())}},getData:function(){return this.properties.binaryValue||[]},renderControl:function(){var e=this,t=e.renderFactory.getTemplate("image");return e.buildItemUrl().then((function(i){if(!e.isDisposed())return e.properties.url=""!==i?i:"",bizagi.util.isEmpty(e.properties.url)?e.properties.value=[]:e.formCompatibilityVersion<2&&(e.properties.value=[[0,"uploaded"]]),e.setValue(e.properties.value),$.fasttmpl(t,{url:e.properties.url})}))},renderReadOnly:function(){var e=this.renderFactory.getTemplate("image-readonly");return $.fasttmpl(e)},getTemplateItem:function(){return this.renderFactory.getTemplate("image-item")},renderUploadItem:function(){var e=this,t=e.getMode(),i=e.getTemplateItem();return e.buildItemUrl().then((function(r){var a=r||"",n=$.fasttmpl(i,{url:a,allowDelete:e.properties.allowDelete,editable:e.properties.editable,mode:t});return e.properties.url=a,n}))},buildItemUrl:function(e){var t=this,i=t.getFormContainer(),r=t.properties,a=i.properties.compatibilityVersion>=2,n="";if(!this.isExecutionMode())return $.Deferred().resolve("").promise();var o={url:r.dataUrl,xpath:r.xpath,idRender:r.id,xpathContext:r.xpathContext,idPageCache:r.idPageCache,contexttype:r.contexttype,property:e&&e.property?e.property:"fileContent",dataType:"text"};if(r.isUserPreference&&(t.currentUser=bizagi.currentUser.idUser,o.xpathContext="@Context.Users[id == "+t.currentUser+"]",o.contexttype="entity",o.surrogatekey=t.currentUser),a){if(bizagi.util.isEmpty(t.properties.value)&&!t.hasValue())return $.Deferred().resolve("").promise();if(!t.properties.forceBase64)return o.sessionId=i.properties.sessionId,o.property="fileBinaryContent",t.dataService.downloadFile(o).then((function(e){return t.setData(e),null==e||window.Blob&&e instanceof Blob&&0===e.size?null:bizagi.util.blobTob64(e,!1)})).then((function(e){return bizagi.util.getDataUrl(e,r.url)}))}return t.dataService.multiaction().getPropertyData(o,"text").then((function(e){return'"'===e.charAt(0)&&(e=e.slice(1,-1)),""!==e&&(n=t.BASE_IMAGE+e),t.setData(bizagi.util.b64toBlob(e)),n}))},buildItemUrlOffline:function(){var e=this,t=e.properties,i=e.getFormParams(),r=!t.isChanged,a=e.buildOfflineImageId(),n={idCase:i.idCase,idWorkitem:i.idWorkitem,id:a,offlineType:i.offlineType,loadImageFromForm:r};return $.when(e.dataService.getOfflineImage(n,bizagi.util.db.AttachmentType.Blob)).then((function(t){return e.setData(t),null==t||window.Blob&&t instanceof Blob&&0===t.size?null:bizagi.util.blobTob64(t,!1)})).then((function(e){return bizagi.util.getDataUrl(e,t.url)}))},saveImageOffline:function(e){var t=this,i=t.buildOfflineImageId(),r=void 0!==t.fileProperties?t.fileProperties.name:e.name;return t.dataService.getFileService().resolveBlobFromPath(e,r).then((function(e){var r=t.getFormParams(),a={idCase:r.idCase,idWorkitem:r.idWorkitem,id:i,operationType:"edition",offlineType:r.offlineType};return t.dataService.saveOfflineImage(a,e)}))},buildFullItemUrl:function(){return this.buildItemUrl({property:"fileFullContent"})},canBeSent:function(){return this.properties.isChanged},getValue:function(){return this.properties.value||[]},isValid:function(e){if(!1===bizagi.util.parseBoolean(this.properties.visible))return!0;if(!1===bizagi.util.parseBoolean(this.properties.editable))return!0;if((this.setValidationMessage(""),this.properties.required)&&(!(this.grid&&this.grid.isFromCreatedRow.apply(this))&&!this.hasValue())){var t=this.getResource("render-required-text").replaceAll("#label#",this.properties.displayName);return e.push({xpath:this.properties.xpath,message:t}),!1}return!0},buildAddParams:function(){var e=this.properties,t=this.getFormContainer(),i={};i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=this.getUploadXpath(),i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=e.id,i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=e.xpathContext,i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+this.Class.BA_PAGE_CACHE]=e.idPageCache,i[this.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=t.properties.sessionId,i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="savefile",e.contexttype&&(i[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=e.contexttype);try{"undefined"!=typeof BIZAGI_SESSION_NAME?i[BIZAGI_SESSION_NAME]=t.properties.sessionId:i.JSESSIONID=t.properties.sessionId}catch(e){i.JSESSIONID=t.properties.sessionId}return i},getUploadXpath:function(){return this.properties.xpath},emptyControlByAsyncRenderDeferred:function(){this.getControl().empty()},buildOfflineImageId:function(){var e=this.getFormContainer().properties.compatibilityVersion>=2;return this.dataService.fileService.buildOfflineImageId(this.properties.value,this.properties.xpathContext,this.properties.xpath,e)}}),$.Class.extend("bizagi.rendering.userfieldDefinition",{},{getFileDependencies:function(){return null},postRender:function(){var e=this;e._super();var t=$.Deferred(),i=e.getFileDependencies();return i&&i.length>0?bizagi.loader.loadFile(i).then((function(){e.internalRenderControl(),t.resolve()})):$.when(e.renderUserfieldControl()).done((function(){t.resolve()})),t.promise()},renderUserfieldControl:function(){var e=this,t=e.getControl(),i=e.properties,r=new $.Deferred;i.extendedData&&i.extendedData.length>0?e.extendedData=bizagi.services.ajax.parseJSON(i.extendedData):e.extendedData={};var a;return(a=e.getEditableControl())&&(e.input=t.html(a)),e.renderComplex(),r.resolve(),r.promise()},postRenderReadOnly:function(){var e=this,t=e.getControl(),i=e.properties;i.extendedData&&i.extendedData.length>0?e.extendedData=bizagi.services.ajax.parseJSON(i.extendedData):e.extendedData={};var r=function(){try{var i=e.getReadonlyControl();i&&(e.input=t.html(i)),e.renderComplex()}catch(i){var r=e.properties.displayName||"Widget";t.html("<h6>"+r+"</h6>")}};e.ready?e.ready().done((function(){r()})):r()},getDisplayValue:function(){return this.getReadonlyValue()},setDisplayValue:function(e){this.setValue(e),this.setEditableValue(e)},getValue:function(){return this.getEditableValue()},getPropertyValue:function(e,t){var i=this,r=i.properties,a=new $.Deferred,n=i.getFormContainer();return n.useOrSetLoaderDeferred(),n.appendWaitForLoader({promise:a.promise()}),i.dataService.multiaction().getPropertyData({url:r.dataUrl,xpath:r.xpath,idRender:r.id,xpathContext:r.xpathContext,idPageCache:r.idPageCache,property:e,extra:t,dataType:t?t.dataType:null}).done((function(e){"error"==e.type?(i.getFormContainer().addErrorMessage(e.message),a.reject(e)):a.resolve(e)})).fail((function(e,t,i){a.reject(e,t,i)})),a.promise()},saveForm:function(){return this.getFormContainer().saveForm()},getRenderElements:function(e){var t=$(),i=this.getFormContainer().getRenders(e);return $.each(i,(function(e,i){t=t.add($(i.element))})),t},getServerResourceURL:function(e){var t="Rest/Userfields/{0}/resource/{1}/{2}";t=t.replace("{0}",this.properties.userfieldGuid),e=e.replace("\\","__").replace("/","__");var i=bizagi.util.detectDevice();return t=(t=t.replace("{1}",i)).replace("{2}",e)},getRenderValue:function(e){var t,i=this.getFormContainer().getRenders(e);return $.each(i,(function(e,i){t&&!i.properties.editable||(t=i)})),t?t.getValue():null},refreshForm:function(){var e=this.properties;this.getFormContainer().refreshForm(e.id)},showDialog:function(e,t){bizagi.util.mustImplement("Must implement the showDialog method")},showPopup:function(e,t){bizagi.util.mustImplement("Must implement the showPopup method")},updateOriginalValue:function(){this.properties.originalValue=this.value=this.properties.value}}),$.Class.extend("bizagi.rendering.basicUserField",{},{getEditableControl:function(){},renderComplex:function(){},getEditableValue:function(){return bizagi.rendering.render.prototype.getValue.apply(this,arguments)},setEditableValue:function(e){return bizagi.rendering.render.prototype.setValue.apply(this,arguments)},getReadonlyControl:function(){},getReadonlyValue:function(){return bizagi.rendering.render.prototype.getDisplayValue.apply(this,arguments)},dispose:function(){this._super()}}),$.Class.extend("bizagi.rendering.userfieldWrapper",{},{init:function(e){this._super(e),this.initialParams=e,this.userfieldGuid=this.properties.userfieldGuid,this.userfieldName=this.properties.control},startUserfieldLoading:function(){},endUserfieldLoading:function(){},internalPostRender:function(){var e=this;e.startUserfieldLoading(),$.when(e.getUserfieldControl()).done((function(t){return t.element=e.element,e.column&&(t.isColumn=!0,t.grid=e.grid,t.surrogateKey=e.surrogateKey,t.properties.xpathContext=e.getControlXpathContext(t),t.getControl=e.column.getControl),t.internalPostRender()})).always((function(){e.endUserfieldLoading()}))},getControlXpathContext:function(e){var t=e.properties;return e.isColumn?t.xpathContext.length>0?t.xpathContext+"."+e.grid.properties.xpath+"[id="+e.surrogateKey+"]":e.grid.properties.xpath+"[id="+e.surrogateKey+"]":t.xpathContext},getUserFieldInstance:function(e){console.log("not implemented")},replicateUserfieldMethods:function replicateUserfieldMethods(control){var self=this;for(var key in control.Class.prototype)"init"!=key&&"constructor"!=key&&"Class"!=key&&"subscribe"!=key&&"unsubscribe"!=key&&"publish"!=key&&"render"!=key&&"triggerHandler"!=key&&"dispose"!=key&&(self[key]=eval("var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance."+key+".apply(this.userfieldInstance, arguments); return null;};tmp"));control.properties=self.properties,control.value=self.value},dispose:function(){var e=this,t=setTimeout((function(){e.userfieldInstance&&(e.userfieldInstance.unbind("renderchange"),e.userfieldInstance.dispose()),clearTimeout(t)}),bizagi.override.disposeTime||50);e._super()}}),$.Class.extend("bizagi.rendering.document",{},{initializeData:function(e){this._super(e);var t=this.properties;t.validate=null!=bizagi.util.parseBoolean(t.validate)&&bizagi.util.parseBoolean(t.validate),t.downloadalldocuments=!!t.downloadalldocuments&&t.downloadalldocuments,t.allowGenerate=void 0===t.allowGenerate||t.allowGenerate,t.append=!!t.append&&t.append,t.caption?(t.caption=$.trim(t.caption),0===t.caption.length&&(t.caption=this.getResource("render-documentgenerator-button-label"))):t.caption=this.getResource("render-documentgenerator-button-label")},renderControl:function(){this.preRenderControl();var e=this.properties,t=this.getMode(),i=e.downloadalldocuments,r=e.allowGenerate,a=this.renderFactory.getTemplate(this.getTemplate()),n=e.value||[],o=!n||0===n.length,s=this.getControlHtml(a,t,i,r,e,o),l=this.renderDocumentsHtml(n);return l+=this.renderActionsHtml(n,o,i),s=this.replaceFilesHtml(s,l)},getControlHtml:function(e,t,i,r,a,n){return $.fasttmpl(e,{noActivateButton:!1,editable:"execution"!==t,mode:t,downloadalldocuments:i,required:a.required,allowgenerate:r,xpath:this.getXpath(a.xpath),append:a.append,caption:a.caption,noFiles:n,allowSendInMail:a.allowSendInMail})},getXpath:function(e){return e},preRenderControl:function(){},activateButton:function(){return!0},getDocumentXpath:function(e){return e},getContextXpath:function(){return this.properties.xpathContext},renderDocumentItem:function(e){var t=this.getMode(),i=this.renderFactory.getTemplate(this.getTemplateItem()),r=this.buildItemUrl(e);return"execution"!==t&&(r="javascript:void(0);"),$.fasttmpl(i,{url:r,allowDelete:this.properties.allowDelete,filename:e.fileName,id:e.id,mode:t,editable:this.properties.editable,joined:!1})},buildItemUrl:function(e){var t=this.properties;return this.dataService.getUploadFileUrl({idRender:t.id,xpath:this.getDocumentXpath(t.xpath),xpathContext:this.getContextXpath(),idPageCache:t.idPageCache,fileId:e.id,sessionId:this.getSessionId()})},buildAllDocumentsUrl:function(){var e=this.properties;return this.dataService.getAllDocumentsDownloadUrl({xpath:this.getDocumentXpath(e.xpath),xpathContext:this.getContextXpath(),idPageCache:e.idPageCache,idCase:e.caseId,idWorkItem:e.workitemId,sessionId:this.getSessionId()})},postRender:function(){return this._super(),"<div></div>"},postRenderReadOnly:function(){if("design"!==this.getMode()){var e=this.getControl(),t=this.renderControl();e.append(t),this.updateControlForPrintMode(e),this.postRender()}},validateContainer:function(){return this.getFormContainer().validateForm()},save:function(){return this.getFormContainer().saveForm()},replaceFilesHtml:function(e,t){return e.replace("{{files}}",t)},replaceActionsHtml:function(e,t){return e.replace("{{actions}}",t)},canBeSent:function(){return!1},isValid:function(e){var t,i=this.properties;return!1===bizagi.util.parseBoolean(i.visible)||(!1===bizagi.util.parseBoolean(i.editable)||(this.setValidationMessage(""),!(i.required&&!i.buttonExecuted&&this.value)||(this.value.length>0||(t=this.getResource("render-document-required-text"),e.push({xpath:i.xpath,message:t}),!1))))},configureHandlers:function(){var e=this;e._super();var t=$(".ui-bizagi-button-documentgenerator",e.getControl());e.isExecutionMode()&&(t.click((function(t){if(!t.isPropagationStopped()){if(t.stopPropagation(),e.properties.buttonExecuted=!0,e.properties.validate)e.validateContainer()&&e.documentTemplateGenerate();else e.documentTemplateGenerate();e.properties.buttonExecuted=!1}})),e.attachEvents())},configureHandlersReadOnly:function(){this.isExecutionMode()&&this.attachEvents()},attachEvents:function(){var e=this,t=e.getControl();$(".ui-bizagi-document-upload-item a > span",t).click((function(t){if(!t.isPropagationStopped()){t.stopPropagation();var i=$(this).closest(".ui-bizagi-document-upload-item").data();i.joined?e.downloadAllFiles({filename:"TemplatesConcatFilesToPDF.pdf"}):e.downloadFile(i)}})),$(".ui-bizagi-container-documents-item-delete",t).click((function(t){t.isPropagationStopped()||(t.stopPropagation(),e.deleteDocumentTemplate($(this).data("filename")))}))},deleteDocumentTemplate:function(e){var t=this,i={xpath:t.properties.xpath+"[fileName='"+e+"']",idRender:t.properties.id,xpathContext:t.getContextXpath(),idPageCache:t.properties.idPageCache};t.startLoading(),$.when(t.dataService.deleteUploadFile(i)).done((function(){$.when(t.dataService.multiaction().getPropertyData({xpath:t.properties.xpath,idRender:t.properties.id,xpathContext:t.getContextXpath(),idPageCache:t.properties.idPageCache,property:"value"})).done((function(e){t.resolveDeleteDocumentTemplate(e,!1,t.properties.downloadalldocuments),t.endLoading()}))}))},documentTemplateGenerate:function(){var e=this,t=e.properties;e.startLoading(),t.xpathcontext=e.getContextXpath(),t.xpath=e.getDocumentXpath(t.xpath),e.save().done((function(){bizagi.showErrorAlertDialog=!1,$.when(e.dataService.generateDocumentTemplate(t)).done((function(){$.when(e.dataService.multiaction().getPropertyData({xpath:t.xpath,idRender:t.id,xpathContext:e.getContextXpath(),idPageCache:t.idPageCache,property:"value"})).done((function(i){e.resolveDocumentTemplateGenerate(i,!1,t.downloadalldocuments),e.endLoading()}))})).fail((function(t){e.endLoading(),e.showErrorMessage(t)}))})).fail((function(t){e.endLoading(),e.showErrorMessage(t)}))},showErrorMessage:function(e){var t=this.getFormContainer(),i=this.resources.getResource("render-upload-alert-maxsize").replace("{0}",BIZAGI_SETTINGS.UploadMaxFileSize);try{i=e&&void 0!==e.responseText?JSON.parse(e.responseText.replace(/(\r\n|\n|\r)/gm,"")).message:e}catch(e){}t.addErrorMessage(i),t.endLoading()},autoOpenDocuments:function(){},showDocumentPreview:function(e,t){},returnCssTypeFile:function(e){if(null==e||0===e.lenght)return"ui-bizagi-document-upload-item-generic-file";switch(e.substr(e.lastIndexOf(".")+1)){case"docx":return"ui-bizagi-document-upload-item-doc";case"pdf":return"ui-bizagi-document-upload-item-pdf";case"xlsx":return"ui-bizagi-document-upload-item-xls";default:return"ui-bizagi-document-upload-item-generic-file"}},redrawDocuments:function(e,t,i){var r=this.getControl(),a="",n=$("[data-component='files']",r);n.empty(),a+=this.renderDocumentsHtml(e),a+=this.renderActionsHtml(e,t,i),n.append(a),this.setValue(e)},renderAllDocumentDownload:function(e){var t=this.properties,i=this.getMode(),r=this.renderFactory.getTemplate(this.getTemplateItem()),a=this.buildAllDocumentsUrl();"execution"!==i&&(a="javascript:void(0);");var n=$.fasttmpl(r,{url:a,allowDelete:t.allowDelete,filename:e.fileName,mode:i,joined:!0});return this.removeDeleteButton(n)},removeDeleteButton:function(e){var t=e.indexOf('<span class="ui-bizagi-container-documents-item-delete');if(t>0){var i=e.substring(t),r=i.indexOf("</span>")+7;return e.substring(0,t)+i.substring(r)}return e},resolveDocumentTemplateGenerate:function(e,t,i){this.redrawDocuments(e,t,i),this.value=e,this.autoOpenDocuments(),this.configureHandlers()},resolveDeleteDocumentTemplate:function(e,t,i){this.redrawDocuments(e,t,i),this.value=e,this.configureHandlers()},renderDocumentsHtml:function(e){for(var t="",i=0;i<e.length;i++){var r={id:e[i][0],fileName:e[i][1]};t+=this.renderDocumentItem(r)}return t},renderActionsHtml:function(e,t,i){var r="";if(i&&!t&&e.length>0){var a={fileName:this.getResource("render-document-downloadalldocuments")};r+=this.renderAllDocumentDownload(a)}return r},getTemplate:function(){return"document"},getTemplateItem:function(){return"document-item"},getErrorTemplate:function(){return"form-error"},getTemplateDownload:function(){return"document-download"},getTemplateReadonly:function(){return"document-readonly"},getDocumentFile:function(e){var t=this.properties;return this.dataService.getFile({idRender:t.id,xpath:this.getDocumentXpath(t.xpath),xpathContext:this.getContextXpath(),idPageCache:t.idPageCache,fileId:e.id,contexttype:t.contexttype}).then((function(e){return bizagi.util.handleJSONResponse(e)}))},getAllDocumentFiles:function(){return this.dataService.getAllDocuments({xpath:this.getDocumentXpath(this.properties.xpath),xpathContext:this.getContextXpath(),idPageCache:this.properties.idPageCache,idCase:this.properties.caseId,idWorkItem:this.properties.workitemId}).then((function(e){return bizagi.util.handleJSONResponse(e)}))},downloadFile:function(e){var t=this;this.getDocumentFile(e).then((function(t){bizagi.util.downloadBlobFile(t,e.filename)})).fail((function(e){var i=t.getFormContainer();i&&i.failHandler(e)}))},downloadAllFiles:function(e){var t=this;this.getAllDocumentFiles().then((function(t){bizagi.util.downloadBlobFile(t,e.filename)})).fail((function(e){var i=t.getFormContainer();i&&i.failHandler(e)}))}}),$.Class.extend("bizagi.rendering.range",{},{init:function(e){this._super(e)},initializeData:function(e){this._super(e)},renderControl:function(){var e;this.properties;return e=this.renderFactory.getTemplate("render-range"),$.fasttmpl(e,{})},setRanageControls:function(e,t){this.minControl=e||null,this.maxControl=t||null;var i=this.getControl(),r=$(".bz-range-maximum",i),a=$(".bz-range-minimum",i);this.renderRangeControl(a,e),this.renderRangeControl(r,t)},getValue:function(){return{min:this.minControl.getValue(),max:this.maxControl.getValue()}},renderRangeControl:function(e,t){$.when(t.render("render")).done((function(i){e.empty().append(i),t.postRenderElement(e)}))}}),$.Class.extend("bizagi.rendering.rangeDate",{},{defineRangeControl:function(e){var t=bizagi.rendering.date.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),i=bizagi.rendering.date.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),r=new t(this.getRenderProperties("min")),a=new i(this.getRenderProperties("max"));r.suscribe(a),a.suscribe(r),this.setRanageControls(r,a)},getRenderProperties:function(e){var t=this.getFormContainer(),i=this.properties,r={data:{properties:{id:i.id,xpath:i.xpath+"_"+e,displayType:"value"}},mode:"execute",parent:t,renderFactory:this.renderFactory,resources:bizagi.localization,dataService:this.dataService};return r.data.properties.displayName="min"===e?"From":"To",r}}),$.Class.extend("bizagi.rendering.rangeMoney",{},{defineRangeControl:function(){var e=bizagi.rendering.money.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),t=bizagi.rendering.money.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),i=new e(this.getRenderProperties("min")),r=new t(this.getRenderProperties("max"));i.suscribe(r),r.suscribe(i),this.setRanageControls(i,r)},getRenderProperties:function(e){var t=this.getFormContainer(),i=this.properties;return{data:{properties:{id:i.id,xpath:i.xpath+"_"+e,displayType:"value"}},mode:"execute",parent:t,renderFactory:this.renderFactory,resources:bizagi.localization,dataService:this.dataService}}}),$.Class.extend("bizagi.rendering.rangeNumber",{},{defineRangeControl:function(){var e=bizagi.rendering.number.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),t=bizagi.rendering.number.extend({suscribe:function(e){this.observer=this.observer||[],this.observer.push(e)},notify:function(e){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(e)},setValue:function(e){e=e||"",this._super(e),this.notify(e)}}),i=new e(this.getRenderProperties("min")),r=new t(this.getRenderProperties("max"));i.suscribe(r),r.suscribe(i),this.setRanageControls(i,r)},getRenderProperties:function(e){var t=this.getFormContainer(),i=this.properties;return{data:{properties:{id:i.id,xpath:i.xpath+"_"+e,displayType:"value"}},mode:"execute",parent:t,renderFactory:this.renderFactory,resources:bizagi.localization,dataService:this.dataService}}}),$.Class.extend("bizagi.rendering.checkList",{},{initializeData:function(e){this._super(e);var t=this.properties;t.horizontal=bizagi.util.parseBoolean(t.horizontal)||!1,this.setValue(t.items),this.updateOriginalValue()},postRender:function(){var e=this.getControl();this._super(),this.checkListGroup=$(".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item",e)},renderControl:function(){var e=this.properties,t=this.renderFactory.getTemplate(this.getTemplateName()),i=this.properties.items||[];return $.fasttmpl(t,$.extend(this.getTemplateParams(),{id:e.id,xpath:e.xpath,unique:bizagi.util.randomNumber(1e4,1e6),idPageCache:e.idPageCache,items:i}))},getTemplateName:function(){return"checkList"},showEmpty:function(){return!1},showCurrentData:function(){return!1},getTemplateParams:function(){return{vertical:!this.properties.horizontal}},cleanData:function(){},setValue:function(e){this.value=bizagi.clone(e)},getValue:function(e){return this.value||[]}}),$.Class.extend("bizagi.rendering.actionLauncher",{},{initializeData:function(e){this._super(e);var t=this.getFormContainer();this.typeForm=t.properties.typeForm||"";var i=this.getMode(),r=this.properties;this.deferredActions=new $.Deferred,this.deferredActions.promise(),"execution"==i&&(this.engine=new bizagi.templateEngine({renderFactory:this.renderFactory,cache:!0,autoGenerateData:!1,templateGuid:r.selecttemplate})),this.processPropertyValueArgs={pcaseId:this.getIdCase(),pguidEntity:this.properties.guidEntity,idRender:this.properties.id,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,property:"data",psurrogatedKey:this.properties.surrogatedKey,ptags:this.properties.tagslist||[],pmaxitems:this.properties.maxItems,pactionXpath:this.properties.xpathActions},this.processPropertyValueDataTmplArgs={pactionXpath:this.properties.xpathActions,idRender:this.properties.id,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,ptemplateGuid:r.selecttemplate,property:"dataTemplate",xpathActions:this.properties.xpathActions},this.properties.valueWidth=100,this.properties.displayType="value";var a="entityTemplate"!==e.properties.type;this.properties.allowactions=void 0===e.properties.allowactions?a:e.properties.allowactions,this.properties.isHorizontal=void 0===e.properties.isHorizontal||e.properties.isHorizontal,this.properties.allowSearch=void 0!==e.properties.allowSearch&&e.properties.allowSearch,this.properties.selecttemplate=void 0===e.properties.selecttemplate?"":e.properties.selecttemplate,this.properties.templatetype=void 0!==r.templatetype?r.templatetype:"none",this.properties.sessionId=t.params.data.sessionId,this.properties.value?"string"==typeof this.properties.value&&(this.properties.value=this.value=JSON.parse(this.properties.value)):(this.properties.value=this.value=[],this.properties.originalValue=[])},executeActionImmediately:function(e){var t=this,i=t.getFormContainer(),r={idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"executeAction",psurrogatedKey:t.properties.surrogatedKey,pguidAction:e.guidAction,pparameters:JSON.encode({idStartScope:e.idStartScope,pactionXpath:t.properties.xpathActions,idPageCache:e.idPageCache})};t.dataService.executeActions(r).done((function(i){t.notifyExecution(i,e)})).fail((function(i){t.notifyExecution("Error",e)}))},notifyExecution:function(e,t){},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this.properties.readOnly=!0,this.postRender()},renderControl:function(){var e,t=this.properties,i="";if("design"==this.getMode()){e=this.renderFactory.getTemplate("render-actionLauncher-design");var r={type:t.type,isHorizontal:t.isHorizontal,allowSearch:t.allowSearch,templateDefined:"none"!=t.templatetype,allowactions:t.allowactions};i=$.fasttmpl(e,r)}else t.surrogatedKey&&(e=this.renderFactory.getTemplate("render-actionLauncher"),i=$.fasttmpl(e,{allowactions:this.properties.allowactions}));return i},isValid:function(e){var t=this.properties;this.getValue();return 0==bizagi.util.parseBoolean(t.visible)||(0==bizagi.util.parseBoolean(t.editable)||!(!t.required||!this.value)&&(this.value.length>0||(message=this.getResource("render-required-register-action"),e.push({xpath:t.xpath,message:message}),!1)))},setDisplayValue:function(e){this.getControl();this.setValue(e,!1)},actionManager:function(e){var t=this,i=e.guidProcess||"",r=new $.Deferred;switch(e.recordXpath=t.getFormContainer().properties.recordXpath,e.actionType){case"Process":var a={guidWFClass:i};$.when(t.dataService.hasStartForm(a)).done((function(a){a.hasStartForm?$.when(t.processStartForm({guidprocess:i,title:e.displayName,recordXpath:e.recordXpath})).done((function(t){e.idStartScope=t,r.resolve(e)})):r.resolve(e)}));break;case"Rule":r.resolve(e);break;case"Form":e.xpathContext?$.when(t.processActionFormCollection(e)).done((function(t){e.idStartScope=t,r.resolve(e)})):("Form"===e.actionType&&(e.xpathContext=void 0,e.contextType="entitytemplate",e.guidEntity=e.guidEntity||t.properties.guidEntity),$.when(t.processActionForm(e)).done((function(t){e.idStartScope=t,r.resolve(e)})))}return r.promise()},addActionToQueue:function(e){var t=this.getValue(),i=this.getFormContainer().getParams();e.params=e.params||{};var r=this.properties.xpathContext;switch(e.actionType){case"Process":e.params={idStartScope:e.idStartScope,additionalXpaths:this.properties.additionalXpath.join(","),idParentWorkitem:i.idWorkitem||bizagi.context.idWorkItem,recordXpath:r};break;case"Form":e.params={idStartScope:e.idStartScope,additionalXpaths:this.properties.additionalXpath.join(","),entityXpath:this.properties.xpathActions,idParentWorkitem:i.idWorkitem||bizagi.context.idWorkItem,idEntity:e.idEntity};break;case"Rule":e.params={xpathActions:e.xpathActions||"",recordXpath:r}}var a=bizagi.clone(t);a.push(e),this.setValue(a),this.setDisplayValue(a)},removeActionToQueue:function(e){var t=bizagi.clone(this.getValue());t.splice(e,1),this.setValue(t),this.setDisplayValue(t)},collectData:function(e){if(this.controlValueIsChanged()){var t=this.properties.xpath,i=this.getValue(),r=[];$.each(i,(function(e,t){var i={};i.params=t.params||{},i.guidAction=t.guidAction,r.push(i)})),e[t]=0==r.length?"":JSON.encode(r)}},countSameActions:function(e){var t=this.getValue(),i=0;return $.each(t,(function(t,r){r.guidAction==e.guidAction&&i++})),i},getPropertiesActionLaucher:function(e){for(var t=this.getFormContainer(),i=0,r=e.length;i<r;i+=1)6===e[i].length&&(e[i].splice(5,0,""),"Process"==e[i][3]&&t.properties.xpathContext&&(e[i][5]=t.properties.xpathContext));return e}}),$.Class.extend("bizagi.rendering.entityTemplate",{},{init:function(e){this._super(e)},initializeData:function(e){this._super(e);var t=this.getFormContainer();this.deferredActions=new $.Deferred,this.deferredActions.promise(),this.processPropertyValueArgs={pcaseId:this.getIdCase(),pguidEntity:this.properties.guidEntity,idRender:this.properties.id,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,property:"data",psurrogatedKey:this.properties.surrogatedKey},this.properties.valueWidth=100,this.properties.displayType="value",this.properties.allowactions=void 0===e.properties.allowactions||e.properties.allowactions,this.properties.value?"string"==typeof this.properties.value&&(this.properties.value=this.value=JSON.parse(this.properties.value)):this.properties.value=this.value=[]},renderControl:function(){var e,t="";return"design"==this.getMode()?(e=this.renderFactory.getTemplate("render-entityTemplate-design"),t=$.fasttmpl(e,{})):this.properties.surrogatedKey&&(e=this.renderFactory.getTemplate("render-entityTemplate"),t=$.fasttmpl(e,{allowactions:this.properties.allowactions})),t},isValid:function(e){this.properties;var t=this._super(e);this.getValue();return t},setDisplayValue:function(e){this.getControl();this.setValue(e,!1)}}),$.Class.extend("bizagi.rendering.polymorphicLauncher",{},{init:function(e){this._super(e)},initializeData:function(e){this._super(e);var t=this.getFormContainer();this.typeForm=t.properties.typeForm||"";this.getMode();this.deferredActions=new $.Deferred,this.deferredActions.promise(),this.properties.valueWidth=100,this.properties.displayType="value",this.properties.allowSearch=void 0!==e.properties.allowSearch&&e.properties.allowSearch,this.properties.additionalXpath=this.properties.additionalXpath||[],this.properties.value?"string"==typeof this.properties.value&&(this.properties.value=this.value=JSON.parse(this.properties.value)):(this.properties.value=this.value=[],this.properties.originalValue=[]),this.processPropertyValueArgs={pcaseId:this.getIdCase(),pguidEntity:this.properties.guidEntity,idRender:this.properties.id,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,property:"data",ptags:this.getTagList(this.properties.tagslist),additionalXpaths:this.properties.additionalXpath}},executeActionImmediately:function(e){var t=this,i=t.getFormContainer(),r={idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"executeConstructor",psurrogatedKey:t.properties.surrogatedKey,pguidConstructor:e.guidConstructor,pparameters:JSON.encode({idStartScope:e.idStartScope,pactionXpath:t.properties.xpathActions,idPageCache:e.idPageCache})};t.dataService.executeActions(r).done((function(i){t.notifyExecution(i.response,e)})).fail((function(i){t.notifyExecution("Error",e)}))},notifyExecution:function(e,t){},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this.properties.readOnly=!0,this.postRender()},renderControl:function(){var e,t=this.properties,i="";if("design"==this.getMode()){e=this.renderFactory.getTemplate("render-polymorphicLauncher-design");var r={type:t.type,allowSearch:t.allowSearch};i=$.fasttmpl(e,r)}else t.surrogatedKey&&(e=this.renderFactory.getTemplate("render-polymorphicLauncher"),i=$.fasttmpl(e));return i},isValid:function(e){this.properties;var t=this._super(e);this.getValue();return t},setDisplayValue:function(e){this.setValue(e,!1)},actionManager:function(e){var t=this,i=e.guidObject||"",r=new $.Deferred;switch(e.recordXpath=t.getFormContainer().properties.recordXpath,e.actionType){case"Process":var a={guidWFClass:i};$.when(t.dataService.hasStartForm(a)).done((function(a){a.hasStartForm?$.when(t.processStartForm({guidprocess:i,title:e.displayNamee,recordXpath:e.recordXpath})).done((function(t){e.idStartScope=t,r.resolve(e)})):r.resolve(e)}));break;case"Rule":r.resolve(e);break;case"Form":$.when(t.processActionForm(e)).done((function(t){e.idStartScope=t,r.resolve(e)}))}return r.promise()},addActionToQueue:function(e){var t=this.getValue(),i=this.getFormContainer().getParams();e.params=e.params||{};var r=this.properties.xpathContext;switch(e.actionType){case"Process":e.params={additionalXpaths:this.properties.additionalXpath.join(","),idParentWorkitem:i.idWorkitem||bizagi.context.idWorkItem,recordXpath:r},void 0!==e.idStartScope&&(e.params.idStartScope=e.idStartScope);break;case"Form":e.params={idStartScope:e.idStartScope,additionalXpaths:this.properties.additionalXpath.join(","),entityXpath:this.properties.xpathActions,idParentWorkitem:i.idWorkitem||bizagi.context.idWorkItem,idEntity:e.idEntity,guidEntity:e.guidEntity}}t.push(e),this.setValue(t),this.setDisplayValue(t)},removeActionToQueue:function(e){var t=this.getValue();t.splice(e,1),this.setValue(t),this.setDisplayValue(t)},collectData:function(e){if(this.controlValueIsChanged()){var t=this.properties.xpath,i=this.getValue(),r=[];$.each(i,(function(e,t){var i={};i.params=t.params||{},i.guidAction=t.guidObject||t.guidAction,i.displayName=t.displayName,i.guidConstructor=t.guidConstructor,i.actionType=t.actionType,i.xpathContext=t.xpathContext,i.guidEntity=t.guidEntity,r.push(i)})),e[t]=0==r.length?"":JSON.encode(r)}},countSameActions:function(e){var t=this.getValue(),i=0;return $.each(t,(function(t,r){r.guidAction==e.guidAction&&i++})),i},getTagList:function(e){for(var t=[],i=(e=e||[]).length;i>0;i--)t.push(e[i-1].value);return t.length>0?t:""}}),bizagi.rendering.element.extend("bizagi.rendering.columns.column",{},{init:function(e){this._super(e),this.originalProperties=JSON.parse(JSON.encode(this.properties)),this.decoratedClass=e.decorated,this.data=e.data,e.singleInstance?(this.decorated=new this.decoratedClass({data:this.data,parent:this.parent,renderFactory:this.renderFactory,dataService:this.dataService}),this.decorated.getControl=this.getControl,e.decorated=this.decorated,this.decorated.properties.isColumn=!0):this.decorateRenders=[],this.grid=e.parent;var t=this.properties;t.columnVisible=null==bizagi.util.parseBoolean(t.columnVisible)||bizagi.util.parseBoolean(t.columnVisible),t.align=t.align||"center",t.textFormat=t.textFormat||{},t.submitOnChange=void 0!==t.submitOnChange&&bizagi.util.parseBoolean(t.submitOnChange),t.singleInstance=e.singleInstance,t.editable=void 0===t.editable||bizagi.util.parseBoolean(t.editable),t.visible=void 0===t.visible||bizagi.util.parseBoolean(t.visible),t.required=void 0!==t.required&&bizagi.util.parseBoolean(t.required),t.showColumn=void 0===t.showColumn||bizagi.util.parseBoolean(t.showColumn),t.isSortable=void 0===t.isSortable||bizagi.util.parseBoolean(t.isSortable);try{e.parent&&"boolean"==typeof e.parent.properties.editable&&!e.parent.properties.editable&&(t.editable=!1)}catch(e){}this.readonly=void 0!==t.readonly&&t.readonly,this.readonly&&(t.editable=required=!1)},isReadonly:function(){return!1},getControl:function(){return $(".ui-bizagi-render-control",this.element||this.observableElement)},getDecorated:function(e){if(this.properties.singleInstance)return this.decorated;var t=this.decorateRenders[e];if(null==t){"object"!=_typeof(this.decorateRenders)&&(this.decorateRenders=[]);var i=new this.decoratedClass({data:bizagi.clone(this.data),parent:this.parent,renderFactory:this.renderFactory,dataService:this.dataService});t=i,this.decorateRenders[e]=i,t.surrogateKey=e,this.applyOverrides(t);var r=bizagi.util.normalizeType(t.properties.type);"summary"!==e||/columnMoney/i.test(r)||/columnNumber/i.test(r)||(t.setDisplayValue=function(e){this.getControl().html(e)})}return t},ready:function(){return this.readyDeferred.promise()},initialize:function(){},canBeSent:function(e,t){var i=this.getDecorated(e);return t&&(i.properties.visible=t.visible,i.properties.editable=t.editable),i.canBeSent()||!this.properties.editable&&this.hasChanged()||!i.properties.editable&&this.hasChanged()},isValueValid:function(e,t,i,r){var a=this.getDecorated(e),n=[];return r.visible&&(this.setValue(e,t),a.properties=$.extend(a.properties,r),this.grid&&void 0===a.grid&&(a.grid=this.grid),a.isValid(n)),!(n.length>0)||($.each(n,(function(e,t){i.push(t.message)})),!1)},applyOverrides:function(e){},render:function(e,t){try{var i=this,r=i.properties,a=i.getDecorated(e);if(a.grid=i.grid,a.column=this,a.surrogateKey=e,i.setValue(e,t),i.overrideDecoratedRenderProperties(e),i.changed=!1,!r.editable&&"CALLER_RENDER_READ_ONLY_COLUMNSLINK"!==arguments[3])return i.renderReadOnly.apply(i,arguments);i.readyDeferred=new $.Deferred;var n=a.render("cell");return a.bind("renderchange",(function(){i.changed=!0})),i.bind("rendered",(function(){i.readyDeferred.resolve()})),n}catch(e){return console.log(e),""}},postRender:function(e,t){this.getDecorated(e).postRenderElement(t)},renderReadOnly:function(e,t){var i=this,r=i.getDecorated(e);r.grid=i.grid,r.column=this,r.surrogateKey=e,i.setValue(e,t),i.overrideDecoratedRenderProperties(e),r.properties.editable=!1,i.readyDeferred=new $.Deferred;var a=r.render("cell.readonly");return i.bind("rendered",(function(){i.readyDeferred.resolve()})),a},renderSummary:function(e,t){var i=this.renderFactory.getTemplate("cell.summary");return $.tmpl(i).html()},postRenderReadOnly:function(e,t){var i=this.getDecorated(e),r=this.properties.editable;i.properties.editable=!1,this.properties.singleInstance&&(i.element=t),i.postRenderElement(t),i.properties.editable=r},postRenderSummary:function(){return!1},getCell:function(){return this.decorated.getDisplayValue()},setSurrogateKey:function(e){this.surrogateKey=e},setValue:function(e,t){var i=this.getDecorated(e);"undefined"!=i&&null!=i&&(i.properties.originalValue=t,i.properties.previousValue=t,"summary"==e||null!=t||void 0===this.properties.defaultvalue&&void 0===this.properties.defaultValue||null==i.grid||(t=this.setDefaultValue(e,i)),i.properties.value=t,i.setValue(t,!1))},setDefaultValue:function(e,t){var i=void 0;return null!==this.properties.defaultvalue&&void 0!==this.properties.defaultvalue?i=this.properties.defaultvalue:null!==this.properties.defaultValue&&void 0!==this.properties.defaultValue&&(i=this.properties.defaultValue),t.grid.changes[e]=t.grid.changes[e]||{},t.grid.changes[e][this.properties.xpath]=i,i},getValue:function(e){return this.getDecorated(e).getValue()},getCompositeValue:function(e){return this.getValue(e)},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_COLUMN},hasChanged:function(){return this.changed},trigger:function(e,t){this.decorated&&this.decorated.trigger(e,t)},triggerHandler:function(e,t){this.decorated&&this.decorated.triggerHandler(e,t)},bind:function(e,t){this.decorated&&this.decorated.bind(e,t)},unbind:function(e,t){this.decorated&&this.decorated.unbind(e,t)},overrideDecoratedRenderProperties:function(e){var t=this.getDecorated(e);t.properties.editable=this.properties.editable,t.properties.visible=this.properties.visible,t.properties.required=this.properties.required},overrideProperties:function(e){this.properties.editable=e.editable||this.properties.editable,this.properties.visible=e.visible||this.properties.visible,this.properties.required=e.required||this.properties.required},getSortName:function(){var e=this.getAnyDecoratedInstance();return e&&e.getSortColumn?e.getSortColumn():this.properties.xpath},getAnyDecoratedInstance:function(){var e;for(e in this.decorateRenders)break;return e?this.decorateRenders[e]:null},dispose:function(){var e=this,t=setTimeout((function(){e.decorated&&(e.decorated.unbind("renderchange"),e.decorated.dispose()),e.decorateRenders&&bizagi.util.arrayEach(e.decorateRenders,(function(e,t){t&&(t.unbind("renderchange"),t.dispose())})),clearTimeout(t)}),bizagi.override.disposeTime||50);e._super()}}),$.Class.extend("bizagi.rendering.columns.readonly",{},{init:function(e){this._super(e),this.properties.editable=required=!1},isReadonly:function(){return!0},isValueValid:function(){return!0}}),$.Class.extend("bizagi.rendering.columns.combo",{},{init:function(e){this._super(e);var t=this.properties;t.recalculate=bizagi.util.parseBoolean(t.recalculate)||!1,bizagi.util.isOfflineForm({context:this})&&(t.recalculate=!1)},applyOverrides:function(e){var t=this.properties;this._super(e),t.recalculate||(e.originalGetData=e.getData,e.getData=this.getDataForAllCells,e.findDataById=this.findDataById)},findDataById:function(e){var t={};return this.column&&this.column.comboData&&$.each(this.column.comboData,(function(i,r){r.id==e&&(t=r)})),t},getDataForAllCells:function(e){var t=this.column;return t.comboData?t.comboData:t.fetchingData?t.dataPromise:(t.fetchingData=!0,t.dataPromise=$.when(this.originalGetData(e)).pipe((function(e){return t.comboData=e,t.fetchingData=!1,e})),t.dataPromise)},setValue:function(e,t){var i=this.getDecorated(e);if(null!==i){if("summary"==e)return this._super(e,t);if(t&&bizagi.util.isString(t))this._super(e,t);else if(t&&t.length>0){var r={id:t[0][0],value:t[0].length>2?$.grep(t[0],(function(e,t){return 0!=t})):t[0][1]};this._super(e,r),i.selectedValue=r.value}else t&&t.id&&t.value?(this._super(e,t),i.selectedValue=t.value):"columnRadio"==this.properties.type?(this._super(e,null),i.selectedValue=t):t&&"number"==typeof t?this._super(e,t):(this._super(e,null),i.selectedValue="")}},setDefaultValue:function(e,t){var i=this.properties.defaultValue[0];return t.grid.changes[e]=t.grid.changes[e]||{},t.grid.changes[e][this.properties.xpath]=i.id,i},getCompositeValue:function(e){var t=this.getDecorated(e),i=t.getValue(),r=t.getSelectedValue(),a=[];return i&&(i.id>0||bizagi.util.isString(i.id))?(a.push([]),a[0].push(i.id),a[0].push(r)):a.push([]),a},getValue:function(e){var t=this.getDecorated(e).getValue();return t?t.id:t},render:function(e,t,i){var r=this.getDecorated(e),a=this.properties;a.recalculate&&r.resetData();var n=a.xpathContext.length>0?a.xpathContext+"."+this.grid.properties.xpath+"[id="+e+"]":this.grid.properties.xpath+"[id="+e+"]";return r.properties.xpathContext=n,this._super(e,t,i)},renderReadOnly:function(e,t){var i=this.getDecorated(e),r=this.properties,a=r.xpathContext.length>0?r.xpathContext+"."+this.grid.properties.xpath+"[id="+e+"]":this.grid.properties.xpath+"[id="+e+"]";return i.properties.xpathContext=a,this._super(e,t)}}),$.Class.extend("bizagi.rendering.columns.date",{},{setValue:function(e,t){var i=this.getDecorated(e);if(null!==i){if(this._super(e,t),null==t&&void 0!==this.properties.defaultvalue&&(t=this.setDefaultValue(e,i)),"summary"===e)return this._super(e,t);null==t&&(i.setValue(t,!1),i.properties.displayValue="");var r=bizagi.util.dateFormatter.getDateFromInvariant(t,i.properties.showTime);if(0===r&&(r=bizagi.util.dateFormatter.getDateFromInvariant(t,!i.properties.showTime)),0!==r){var a=bizagi.localization.getResource("datePickerRegional"),n=bizagi.util.dateFormatter.formatDate(r,i.properties.fullFormat,a);i.properties.displayValue=n,i.setValue(t,!1)}}},setDefaultValue:function(e,t){var i=this.properties.defaultvalue;return t.grid.changes[e]=t.grid.changes[e]||{},i=bizagi.util.dateFormatter.getDateFromInvariant(i,t.properties.showTime||!1),i=bizagi.util.dateFormatter.formatInvariant(i,!0),t.grid.changes[e][this.properties.xpath]=i,i}}),$.Class.extend("bizagi.rendering.columns.search",{},{init:function(e){this._super(e)},applyOverrides:function(e){var t;this._super(e),t=this.properties.xpathContext.length>0?this.properties.xpathContext+"."+this.grid.properties.xpath+"[id="+e.surrogateKey+"]":this.grid.properties.xpath+"[id="+e.surrogateKey+"]",e.properties.xpathContext=t},render:function(e,t,i){var r=this.getDecorated(e);return this.properties.recalculate&&r.resetData(),this._super(e,t,i)},getValue:function(e){return this.getDecorated(e).getValue()},setValue:function(e,t){var i=this.getDecorated(e);if(null!==i){if("summary"==e)return this._super(e,t);var r=this.getCompositeValue(e);if(r&&void 0!==r.id&&r.id==t&&(t=r),t&&t.length>0){var a={id:t[0][0],value:t[0].length>2?$.grep(t[0],(function(e,t){return 0!=t})):t[0][1]};this._super(e,a),i.selectedValue=a.value}else t&&t.id&&t.value?(this._super(e,t),i.selectedValue=t.value):t&&t.id&&t.label?(this._super(e,t),i.selectedValue=t.label):(this._super(e,t),i.selectedValue="")}}}),$.Class.extend("bizagi.rendering.columns.hidden",{},{canBeSent:function(){return!0}}),$.Class.extend("bizagi.rendering.base.factory",{},{init:function(e){this.templates={},this.dataService=e},loadOverrides:function(){},initAsyncStuff:function(){return $.when.apply($,[this.loadOverrides(),this.loadTemplates()])},loadTemplates:function(){},loadTemplate:function(e,t){var i=this;return bizagi.templateService.getTemplate(t,e).done((function(t){i.templates[e]=t}))},getCommonTemplate:function(e){return this.templates[e]},getContainer:function(e){var t=e.type,i=e.data,r=$.extend(e,{renderFactory:this,dataService:e.dataService||this.dataService});return"form"==t?new bizagi.rendering.form(r):"mobileform"==t?new bizagi.rendering.mobileform(r):"template"==t?new bizagi.rendering.formTemplate(r):"queryForm"==t?new bizagi.rendering.queryForm(r):"layout"==t?new bizagi.rendering.layout(r):"usersForm"==t?new bizagi.rendering.usersForm(r):"panel"==t?new bizagi.rendering.panel(r):"section"==t?new bizagi.rendering.section(r):"contentPanel"==t||"contentpanel"==t?new bizagi.rendering.contentPanel(r):"nestedform"==t.toLowerCase()?new bizagi.rendering.nestedForm(r):"tab"==t?new bizagi.rendering.tab(r):"tabItem"==t||"tabitem"==t?new bizagi.rendering.tabItem(r):"horizontal"==t?new bizagi.rendering.horizontal(r):"accordion"==t?new bizagi.rendering.accordion(r):"accordionItem"==t?new bizagi.rendering.accordionItem(r):"group"==t?new bizagi.rendering.group(r):"mobilegroup"==t?new bizagi.rendering.mobilegroup(r):"searchForm"==t?(r.context="search",r.contexttype="metadata",new bizagi.rendering.searchForm(r)):(bizagi.log(t+" not supported in render factory",i,"error"),null)},getRender:function(e){var t=e.type,i=e.data,r=$.extend(e,{renderFactory:this,dataService:e.dataService||this.dataService});return t||(t="label"),"text"==t?bizagi.util.parseBoolean(i.properties.isExtended)||!1?new bizagi.rendering.extendedText(r):new bizagi.rendering.text(r):"mobiletext"==t?new bizagi.rendering.mobiletext(r):"association"==t?new bizagi.rendering.association(r):"label"==t?new bizagi.rendering.label(r):"hidden"==t?new bizagi.rendering.hidden(r):"number"==t?new bizagi.rendering.number(r):"money"==t?new bizagi.rendering.money(r):"date"==t?new bizagi.rendering.date(r):"boolean"==t?"check"==(i.properties.display||"option")?new bizagi.rendering.check(r):new bizagi.rendering.yesno(r):"combo"==t?new bizagi.rendering.combo(r):/^cascadingcombo$/i.test(t)?new bizagi.rendering.cascadingCombo(r):"list"==t?new bizagi.rendering.list(r):"multiSelect"==t?new bizagi.rendering.multiSelect(r):"radio"==t?new bizagi.rendering.radio(r):"image"==t?new bizagi.rendering.image(r):"uploadecm"==t?new bizagi.rendering.ecm(r):"upload"==t?new bizagi.rendering.upload(r):"grid"==t?new bizagi.rendering.grid(r):"groupedgrid"==t?new bizagi.rendering.grid(r):"search"==t?new bizagi.rendering.search(r):"suggest"==t?(r.data.properties.enableQuerySuggestBehavior=!0,new bizagi.rendering.search(r)):"searchList"==t?new bizagi.rendering.searchList(r):"letter"==t?new bizagi.rendering.letter(r):"button"==t?new bizagi.rendering.button(r):"formLink"==t?new bizagi.rendering.formLink(r):"link"==t?new bizagi.rendering.link(r):"layoutImage"==t?new bizagi.rendering.layoutImage(r):"layoutLink"==t?new bizagi.rendering.layoutLink(r):"layoutLabel"==t?new bizagi.rendering.layoutLabel(r):"layoutText"==t?new bizagi.rendering.layoutText(r):"layoutDateTime"==t?new bizagi.rendering.layoutDateTime(r):"layoutNumber"==t?new bizagi.rendering.layoutNumber(r):"layoutMoney"==t?new bizagi.rendering.layoutMoney(r):"layoutPlaceholder"==t?new bizagi.rendering.layoutPlaceholder(r):"actionLauncher"==t?new bizagi.rendering.actionLauncher(r):"layoutBoolean"==t?new bizagi.rendering.layoutBoolean(r):"layoutUpload"==t?new bizagi.rendering.layoutUpload(r):"entityTemplate"==t?new bizagi.rendering.entityTemplate(r):"polymorphicLauncher"==t?new bizagi.rendering.polymorphicLauncher(r):"userfield"==t?new bizagi.rendering.userfieldWrapper(r):0==t.indexOf("search")?this.getSearchRender(e):0==t.indexOf("query")?this.getQueryRender(e):"document"==t?new bizagi.rendering.document(r):"image"==t?new bizagi.rendering.image(r):"fileprint"==t?new bizagi.rendering.fileprint(r):"geolocation"==t?new bizagi.rendering.geolocation(r):"collectionnavigator"==t?new bizagi.rendering.collectionnavigator(r):"getUser"==t?new bizagi.rendering.getUser(r):"rangeDate"==t?new bizagi.rendering.rangeDate(r):"rangeMoney"==t?new bizagi.rendering.rangeMoney(r):"rangeNumber"==t?new bizagi.rendering.rangeNumber(r):"activityCheckList"==t?new bizagi.rendering.activityCheckList(r):(bizagi.log(t+" not supported in render factory",i,"error"),null)},getColumn:function(e){var t=e.type,i=e.data,r=$.extend(e,{renderFactory:this,dataService:e.dataService||this.dataService,singleInstance:!!bizagi.util.isEmpty(e.singleInstance)||e.singleInstance});if("columnText"==t){var a=bizagi.util.parseBoolean(i.properties.isExtended)||!1;return r.decorated=a?bizagi.rendering.extendedText:bizagi.rendering.text,new bizagi.rendering.columns.text(r)}if("columnSearchList"==t)return r.decorated=bizagi.rendering.searchList,new bizagi.rendering.columns.searchList(r);if("columnNumber"==t)return r.decorated=bizagi.rendering.number,new bizagi.rendering.columns.number(r);if("columnMoney"==t)return r.decorated=bizagi.rendering.money,new bizagi.rendering.columns.number(r);if("columnDate"==t)return r.decorated=bizagi.rendering.date,new bizagi.rendering.columns.date(r);if("columnBoolean"==t){if("check"==(i.properties.display||"option")){if(r.decorated=bizagi.rendering.check,e.data.properties.isExclusive)return new bizagi.rendering.columns.exclusiveCheck(r)}else r.decorated=bizagi.rendering.yesno;return new bizagi.rendering.columns.column(r)}return"columnCombo"==t?(r.decorated=bizagi.rendering.combo,new bizagi.rendering.columns.combo(r)):"columnRadio"==t?(r.decorated=bizagi.rendering.radio,new bizagi.rendering.columns.radio(r)):"columnList"==t?(r.decorated=bizagi.rendering.list,new bizagi.rendering.columns.list(r)):"columnHidden"==t?(r.decorated=bizagi.rendering.hidden,new bizagi.rendering.columns.column(r)):"columnUpload"==t?(r.decorated=bizagi.rendering.upload,new bizagi.rendering.columns.upload(r)):"columnImage"==t?(r.decorated=bizagi.rendering.image,new bizagi.rendering.columns.image(r)):"columnUploadEcm"==t?(r.decorated=bizagi.rendering.ecm,new bizagi.rendering.columns.uploadecm(r)):"columnLink"==t?(r.decorated=bizagi.rendering.link,new bizagi.rendering.columns.link(r)):"columnFormLink"==t?(r.decorated=bizagi.rendering.formLink,new bizagi.rendering.columns.link(r)):"columnUserfield"==t?(r.decorated=bizagi.rendering.userfieldWrapper,new bizagi.rendering.columns.column(r)):"columnSearch"==t?(r.decorated=bizagi.rendering.search,new bizagi.rendering.columns.search(r)):"columnLabel"==t?(r.decorated=bizagi.rendering.label,new bizagi.rendering.columns.column(r)):"columnReadonly"==t?(r.decorated=bizagi.rendering.label,new bizagi.rendering.columns.readonly(r)):"columnDocument"==t?(r.decorated=bizagi.rendering.document,new bizagi.rendering.columns.document(r)):"columnLetter"==t?(r.decorated=bizagi.rendering.letter,new bizagi.rendering.columns.letter(r)):"columnButton"==t?(r.decorated=bizagi.rendering.button,new bizagi.rendering.columns.button(r)):(bizagi.log(t+" not supported in render factory",i,"error"),null)},getSearchRender:function(e){var t=e.type,i=e.data,r=$.extend(e,{renderFactory:this,dataService:e.dataService||this.dataService});return"searchText"==t?bizagi.util.parseBoolean(i.properties.isExtended)||!1?new bizagi.rendering.extendedText(r):new bizagi.rendering.text(r):"searchBoolean"==t?"check"==(i.properties.display||"option")?new bizagi.rendering.check(r):new bizagi.rendering.yesno(r):"searchNumber"==t?29==i.properties.dataType?new bizagi.rendering.numberScientificNotation(r):new bizagi.rendering.number(r):"searchMoney"==t?new bizagi.rendering.money(r):"searchDate"==t?new bizagi.rendering.date(r):"searchCombo"==t?new bizagi.rendering.combo(r):"searchSuggest"==t?new bizagi.rendering.search(r):"searchLabel"==t?new bizagi.rendering.label(r):(bizagi.log(t+" not supported in render factory",i,"error"),null)},getQueryRender:function(e){var t=e.type,i=e.data,r=$.extend(e,{renderFactory:this,dataService:e.dataService||this.dataService});return"queryText"==t?bizagi.util.parseBoolean(i.properties.isExtended)||!1?new bizagi.rendering.queryExtendedText(r):new bizagi.rendering.queryText(r):"queryBoolean"==t?"check"==(i.properties.display||"option")?new bizagi.rendering.queryCheck(r):new bizagi.rendering.queryYesNo(r):"queryNumber"==t?new bizagi.rendering.queryNumber(r):"queryMoney"==t?new bizagi.rendering.queryMoney(r):"queryDate"==t?new bizagi.rendering.queryDate(r):"queryCombo"==t?new bizagi.rendering.queryCombo(r):"queryCascadingCombo"==t?new bizagi.rendering.queryCascadingCombo(r):"querySuggest"==t?new bizagi.rendering.querySuggest(r):"queryLabel"==t?new bizagi.rendering.queryLabel(r):"queryList"==t?new bizagi.rendering.queryList(r):"queryMultiSelect"==t?new bizagi.rendering.queryMultiSelect(r):"querySearch"==t?new bizagi.rendering.querySearch(r):"queryRadio"==t?new bizagi.rendering.queryRadio(r):"queryState"==t?new bizagi.rendering.queryState(r):"queryCaseState"==t?new bizagi.rendering.queryCaseState(r):"queryProcess"==t?new bizagi.rendering.queryProcess(r):"querySearchUser"==t?new bizagi.rendering.querySearchUser(r):"queryHidden"==t?new bizagi.rendering.hidden(r):(bizagi.log(t+" not supported in render factory",i,"error"),null)},getTemplate:function(e){return this.templates[e]}}),$.Class.extend("bizagi.rendering.device.factory",{},{init:function(e){this.execution_device=bizagi.util.detectDevice(),this.cachedFactory={}},getRenderFactory:function(e,t){var i=this;t=t||"desktop";var r=new $.Deferred;return void 0!==i.cachedFactory[t]?(i.cachedFactory[t].printVersion=!1,r.resolve(i.cachedFactory[t])):"print"===t?(i.cachedFactory[t]=new bizagi.rendering.print.factory(e),i.cachedFactory[t].initAsyncStuff().done((function(){r.resolve(i.cachedFactory[t])}))):"desktop"===t?(i.cachedFactory[t]=new bizagi.rendering.desktop.factory(e),i.cachedFactory[t].initAsyncStuff().done((function(){r.resolve(i.cachedFactory[t])}))):bizagi.util.isTabletDevice(t)?(i.cachedFactory[t]=new bizagi.rendering.tablet.factory(e),i.cachedFactory[t].initAsyncStuff().done((function(){r.resolve(i.cachedFactory[t])}))):bizagi.util.isSmartphoneDevice(t)?(i.cachedFactory[t]=new bizagi.rendering.smartphone.factory(e),i.cachedFactory[t].initAsyncStuff().done((function(){r.resolve(i.cachedFactory[t])}))):(bizagi.showMessageBox("Not supported device: "+t),r.reject("Not supported device: "+t)),r.promise()},getDataService:function(){return this.dataService}}),bizagi.rendering=bizagi.rendering||{},$.Class.extend("bizagi.rendering.facade",{form:void 0,executionDeferred:new $.Deferred},{init:function(e){e=e||{},this.observableElement=$({});var t=e.device||"";this.deviceFactory=new bizagi.rendering.device.factory,this.dataService=new bizagi.render.services.service(e),this.renderFactory=this.deviceFactory.getRenderFactory(this.dataService,t)},getFactory:function(){return{deviceFactory:this.deviceFactory,dataService:this.dataService,renderFactory:this.renderFactory}},subscribe:function(){this.observableElement.bind.apply(this.observableElement,arguments)},unsubscribe:function(){this.observableElement.unbind.apply(this.observableElement,arguments)},publish:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},update:function(e){return e.mode&&(this.mode=e.mode),this.execute($.extend({canvas:this.canvas,mode:this.mode},e))},execute:function(e){var t=this,i=this.ownerDocument,r=$("body",i);if(e=e||{},t.executionDeferred&&t.executionDeferred.state?"resolved"==t.executionDeferred.state()&&(t.executionDeferred=$.Deferred()):t.executionDeferred=$.Deferred(),bizagi.chrono.initAndStart("rendering+data",!0),bizagi.rendering.render.startOptimization(),void 0===e.mode&&!bizagi.util.isEmpty(window.location.search)){var a=bizagi.util.getQueryString();e.mode=a.mode}var n=t.canvas=e.canvas=e.canvas||$("<div />").appendTo(r);return t.mode=e.mode,t.sendExecutingPostMessageWebparts(),t.process(e).done((function(i){e.refreshing||n.empty(),n.append(i.container),$(i.pathProcess).insertBefore(i.container),t.form=i,t.form.setSize({width:t.lastWidth,height:t.lastHeight});var r=setTimeout((function(){t.lastWidth=$(window).width(),t.lastHeight=$(window).height(),window.self!==window.top&&t.resizeInPopUpHTML(),clearTimeout(r)}),2e3);i.triggerHandler("ondomincluded"),t.publish("rendering-formRendered",{form:i}),t.configureOpenForm(i),t.configureRefresh(i,n),t.configureRouting(i,n),t.configureRenderError(i,n),t.configureResize(i),t.configureGlobalHandlers(i),e.summaryForm&&i.container.addClass("ui-bizagi-summary-form"),bizagi.chrono.stopAndLog("rendering"),bizagi.chrono.stopAndLog("rendering+data"),bizagi.chrono.stopAndLog("submitForm"),bizagi.chrono.stopAndLog("submitForm-ajax"),bizagi.chrono.stopAndLog("waiting"),bizagi.rendering.render.stopOptimization(),bizagi.override.enableE2EInterface&&(t.Class.form=t.form,t.Class.executionDeferred.resolve(t.form)),t.executionDeferred.resolve(t.form)})).fail((function(e,i){$.when(t.renderFactory).done((function(i){void 0!==e&&""!==e||(e=bizagi.localization.getResource("render-error-unknown"));var r=i.getCommonTemplate("form-error");n.empty(),n.append($.tmpl(r,{message:e})),t.publish("rendering-formRenderedError",e),t.canvas.triggerHandler("errorform",e),bizagi.chrono.stopAndLog("rendering"),bizagi.chrono.stopAndLog("rendering+data"),t.executionDeferred.reject()}))})),t.executionDeferred.promise()},ready:function(){return this.executionDeferred.promise()},process:function(e){var t=this,i=new $.Deferred,r=t.dataService.getFormData(e),a=t.canvas||e.canvas;return bizagi.showErrorAlertDialog=!1,$.when(r,t.renderFactory).done((function(r,n){if(bizagi.showErrorAlertDialog=!0,bizagi.util.isEmpty(r))return t.publish("no-data-found"),void i.fail();if(r&&"reload"==r.type)(l=t.form)&&(l.endLoading(),l.dispose()),a.triggerHandler("routing",r);else if(r&&"suspended"==r.type){var o=n.getTemplate("info-message"),s=bizagi.localization.getResource("render-case-suspended");$.tmpl(o,{message:s}).appendTo(a),i.fail()}else if(r&&"error"!=r.type){e.hasOwnProperty("printversion")&&((r=t.transformGridControl(r)).form.properties.editable="False"),bizagi.chrono.initAndStart("rendering"),e.type=r.form&&r.form.properties.type||e.type;var l=t.processForm(r.form,n,e);i.resolve(l)}else t.getFailDeferred(r,i)})).fail((function(e){t.getFailDeferred(e,i)})),i.promise()},transformGridControl:function(e){var t=this;return null==e?e:(e.hasOwnProperty("type")&&"grid"==e.type?(e.id=e.id+"-print",e.allowAdd="False",e.allowDelete="False",e.allowEdit="False",e.allowGrouping="False",e.allowMore="False",e.allowSearch="False"):$.each(e,(function(i,r){"object"==_typeof(r)&&(e[i]=t.transformGridControl(e[i]))})),e)},getFailDeferred:function(e,t){var i="",r={};try{r=JSON.parse(e.responseText)}catch(t){r={message:e.responseText,errorType:"ERRORUNKNOWN"}}r.message?(i+="<br>Error Type: "+r.errorType,i+="<br>Error Message: "+r.message):"JSharpNotSupportedException"==r.errorType&&(i+="<br>Error Message: "+bizagi.localization.getResource("jsharp-required")),"ERRORUNKNOWN"==r.errorType?t.reject(i,r.errorType):t.reject(i)},processForm:function(e,t,i){var r=t.getContainer($.extend(i,{type:i.type||"form",data:e}));return r.render(),r},resize:function(e){this.form&&this.form.trigger("renderresize",e)},configureRefresh:function(e,t){var i=this;e.bind("refresh",(function(r,a){var n=e.container.parent(),o=(n=bizagi.util.scrollTop(n)).scrollTop();$(i.form).trigger("onRefreshStarted"),e.dispose(a),t.fastEmpty();var s=t.parent();s.find(".ui-bizagi-button-container").length>0&&s.find(".ui-bizagi-button-container").remove(),i.executionDeferred&&i.executionDeferred.state&&"resolved"==i.executionDeferred.state()&&(i.executionDeferred=$.Deferred());var l=i.form.getParams();return bizagi.util.isMobileDevice()&&!0===l.isOfflineForm&&($.extend(a,{isOfflineForm:!0,offlineType:l.offlineType,isOpen:l.isOpen}),a.online="debug"===(""+BIZAGI_ENVIRONMENT).toLowerCase()?e.online:bizagi.util.isConnected()),$.when(i.execute($.extend(a,{canvas:t,refreshing:!0,idCase:l.idCase,displayName:l.displayName}))).done((function(){var e=setTimeout((function(){n.scrollTop(o),$(i.form).trigger("onRefreshFinished"),clearTimeout(e)}),100)})),i.executionDeferred.promise()}))},configureResize:function(e){var t=this;e.bind("renderresize",(function(i,r){if(r=r||{},!t.resizeTimeout){t.resizeTimeout=setTimeout((function(){var i=$(window).width(),a=$(window).height();(r.forceResize||i!=t.lastWidth)&&(bizagi.chrono.initAndStart("resize"),e.resize({width:i,height:a}),t.lastWidth=i,t.lastHeight=a,bizagi.chrono.stopAndLog("resize"),bizagi.chrono.log("resize")),t.resizeTimeout=null,clearTimeout(t.resizeTimeout)}),0)}})),t.resize()},configureRouting:function(e,t){e.bind("routing",(function(i,r){e.dispose(),t.triggerHandler("routing",r)}))},configureGlobalHandlers:function(e){var t=this;e.bind("globalHandler",(function(e,i){return t.publish(i.eventType,i.data)}))},configureOpenForm:function(e){$(document).trigger("openForm",{form:e})},configureRenderError:function(e,t){var i=this;e.bind("formRenderingError",(function(e,r){$.when(i.renderFactory).done((function(e){var a="<br>Error: ";r=r.replace(/(\r\n|\n|\r)/gm,"");var n=JSON.parse(r);n.message&&(a+=n.message,a+="<br>Error Type: "+n.errorType);var o=e.getCommonTemplate("form-error");t.empty(),t.append($.tmpl(o,{message:a})),i.canvas.triggerHandler("errorform","renderItemError"),bizagi.chrono.stopAndLog("rendering+data"),bizagi.chrono.stopAndLog("rendering")}))}))},dispose:function(){this.form&&this.form.dispose(),bizagi.util.dispose(this)},resizeInPopUpHTML:function(){if($(".activitiFormContainer").length>0&&"cases"!=bizagi.util.getQueryString().type){var e=$(".activitiFormContainer").height()||0,t=$(".activitiFormContainer #ui-bizagi-webpart-render-container"),i=$(".ui-bizagi-button-container",".activitiFormContainer"),r=i.outerHeight()||0,a=bizagi.util.getQueryString().renderBehavior||"";if("PopUp"==(a=a.replace("#",""))){if(void 0===self.postMessageSocket){var n=$(".activitiFormContainer").height()-50||396;$("#render-canvas").height(n),$("#render-canvas").css("overflowY","scroll")}else $(".activitiFormContainer").height($(".activitiFormContainer").height()+$(".ui-bizagi-button-container").height()+30);$(".ui-bizagi-button-container").css("position","absolute"),$(".ui-bizagi-button-container").appendTo(".activitiFormContainer"),$(".ui-bizagi-button-container").length>1&&($(".ui-bizagi-button-container:first").hide(),t.css("marginTop","-17px"))}i.length>0&&t.height(e-97-r),0==$(".ui-bizagi-button-container").children().length?$("#render-canvas").height($("#render-canvas").height()+r):(i.width("100%"),i.css("marginLeft",0),i.css("bottom",0))}else"render"==bizagi.util.getQueryString().type&&($("html").css("overflowX","hidden"),$("#render").height()<=window.innerHeight+5?$("html").css("overflowY","hidden"):$("html").css("overflowY","scroll"),$(".ui-widget-overlay").height(650))},sendExecutingPostMessageWebparts:function(){bizagi&&bizagi.iframeCommunicator&&bizagi.iframeCommunicator.trigger("executing-rendering",{})}});
//# sourceMappingURL=../../../../Maps/tablet_android/forms_base.tablet.production.js.map
