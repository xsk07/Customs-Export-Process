var _bizagi$workportal$co;function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! jQuery Timepicker Addon - v1.4 - 2013-08-11
                                                                                                                                                                                                                                                                                                                                                                               * http://trentrichardson.com/examples/timepicker
                                                                                                                                                                                                                                                                                                                                                                               * Copyright (c) 2013 Trent Richardson; Licensed MIT */function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}$.bizagi||($.bizagi={ui:{}}),$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}},bizagi.workportal=bizagi.workportal||{},bizagi.workportal.currentInboxView||(bizagi.workportal.currentInboxView="inbox"),bizagi.workportal.state=bizagi.workportal.state||{},$.Class.extend("bizagi.workportal.facade",{},{init:function(e){this.deviceFactory=new bizagi.workportal.device.factory(this),this.dataService=new bizagi.workportal.services.service(e),this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService}),this.defaultParams=e||{},this.timeoutID},loadDefaultWidget:function(){var e=bizagi.cookie("bizagiDefaultWidget");if(!this.defaultWidget&&!bizagi.util.isEmpty(window.location.hash)){var t=bizagi.util.getHashParams();"/"!=t[0]&&(this.defaultWidget=t[0])}if(!this.defaultWidget&&!bizagi.util.isEmpty(window.location.search)){var i=bizagi.util.getQueryString();"activityform"!==i.widget&&"activityform"!==this.defaultParams.widget||bizagi.util.isMobileDevice()?"smartinbox"===i.widget?this.defaultWidget="smartinbox"===e?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:e:this.defaultWidget=i.widget:(this.defaultWidget="projectDashboard",this.defaultParams.caseLink=!0)}this.defaultWidget||bizagi.util.isEmpty(this.defaultParams.widget)||(this.defaultWidget=this.defaultParams.widget),this.defaultWidget||"undefined"==typeof BIZAGI_DEFAULT_WIDGET||bizagi.util.isEmpty(BIZAGI_DEFAULT_WIDGET)||(this.defaultWidget=BIZAGI_DEFAULT_WIDGET),!this.defaultWidget&&e&&(this.defaultWidget="smartinbox"===e?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:e),this.defaultWidget||(this.defaultWidget="smartphone_ios"==bizagi.util.detectDevice()||"smartphone_android"==bizagi.util.detectDevice()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID),"projectDashboard"!==this.defaultWidget&&"homeportal"!==this.defaultWidget&&bizagi.util.defaultWidget(this.defaultWidget),"homeportal"===this.defaultWidget&&bizagi.util.defaultWidget(bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID),this.dataService&&!this.dataService.online&&bizagi.util.isTabletDevice()&&bizagi.util.defaultWidget(bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX)},execute:function(e){var t=this,i=this.ownerDocument,n=$("body",i),a=new $.Deferred;return e=e||$("<div/>").appendTo(n),t.executionDeferred=new $.Deferred,$.when(t.dataService.getCurrentUser(),t.loadPreferences()).done((function(i,s){bizagi.currentUser=i[0],bizagi.services.preferences(s),bizagi.util.changeData(i[0]),bizagi.localization.overrideSpecificResource("dateFormat",i[0].shortDateFormat),bizagi.localization.overrideSpecificResource("timeFormat",i[0].timeFormat),t.loadDefaultWidget(),t.process().done((function(i){a.resolve(i),bizagi.util.replaceSelector(n,e,i),t.executionDeferred.resolve()}))})).fail((function(){t.dataService.logout()})),a},loadPreferences:function(){var e=new $.Deferred;return $.when(this.dataService.getPreferencesWorkportalCurrentUser()).done((function(t){e.resolve(t)})).fail((function(){e.resolve()})),e.promise()},createWebpart:function(e){return this.executeWebpart($.extend(e,{creating:!0}))},testWebpartConfiguration:function(e){var t=e.webpartConfiguration,i=this.ownerDocument,n=$("body",i);e.canvas||$("<div/>").appendTo(n);return!(!t.url||""==t.url)||(bizagi.webparts.addConfigurationMessage(e,"bizagi-sharepoint-configuration-error"),!1)},executeWebpart:function(e){var t=this.ownerDocument,i=$("body",t),n=e.canvas||$("<div/>").appendTo(i),a=!0;if(e.webpartConfiguration&&(a=this.testWebpartConfiguration(e)),a)return this.processWebpart(e).done((function(e){n.append(e.content)}))},ready:function(){return this.executionDeferred.promise()},process:function(){var e=this,t=new $.Deferred,i=this.deviceFactory.getWorkportalFacade(e.dataService);return e.processOfflineData(),$.when(i).pipe((function(t){return e.processWorkportal(t)})).done((function(e){t.resolve(e)})),t.promise()},processOfflineData:function(){var e=this;void 0!==e.dataService.fetchOfflineData&&1==e.dataService.online&&$.when(e.dataService.pushOfflineData()).always((function(){e.dataService.fetchOfflineData()}))},processWebpart:function(e){var t,i,n=new $.Deferred;bizagi.detectRealDevice();return t=this.deviceFactory.getWorkportalFacade(this.dataService,!1),$.extend(e,this.defaultParams),$.when(t).pipe((function(t){var i=new $.Deferred;return $.when(t.loadWebpart(e)).done((function(){i.resolve(t)})),i.promise()})).pipe((function(t){return(i=t.getWebpart(e.webpart,e)).render(e)})).done((function(e){n.resolve({webpart:i,content:e})})),n.promise()},processWorkportal:function(e){var t=this,i=this.mainController=e.getMainController();new $.Deferred;return i.render().then((function(e){return $.when(i.menu.isRendered()).then((function(){var e=t.getWidgetByDataUser(t.defaultParams);if("projectDashboard"===e&&t.defaultParams.caseLink){var n={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.util.getQueryString().idCase,guid:bizagi.util.getQueryString().guid,caseLink:!0};void 0!==bizagi.util.getQueryString().idWorkitem&&(n.idWorkItem=bizagi.util.getQueryString().idWorkitem),i.publish("executeAction",n)}else e===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SMARTINBOX&&void 0!==bizagi.util.getQueryString().action?i.setWidget($.extend(t.defaultParams,{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},bizagi.util.getQueryString())):i.setWidget($.extend(t.defaultParams,{widgetName:e},bizagi.util.getQueryString()));i.menu&&(i.menu.performResizeLayout(),e!==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&e!==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||t.mainController.publish("showMainMenu"))})),e}))},getWidgetByDataUser:function(){var e=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,t="projectDashboard"!==this.defaultWidget?bizagi.util.defaultWidget():"projectDashboard",i="",n=JSON.parse(bizagi.cookie("bizagiUserDisplayOptions"));if(n&&n.startPage)i={key:"userstartpage",value:n.startPage};else if(bizagi.currentUser.sUserProperties)for(var a=0,s=bizagi.currentUser.sUserProperties.length;a<s;a++)if("userstartpage"===bizagi.currentUser.sUserProperties[a].key){i=bizagi.currentUser.sUserProperties[a];break}return t!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&t!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID&&t!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL?e=t:void 0===i||""===i||""===i.value||"1"===i.value?e=this.getWidgetByCookieAndStakeholders():"2"===i.value&&this.currentUserHaveStakeholderAssociated()?e=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"2"!==i.value||this.currentUserHaveStakeholderAssociated()?"3"===i.value&&(e=this.getWidgetByCookie(!0)):e=this.getWidgetByCookie(!0),e},getWidgetByCookieAndStakeholders:function(){return this.getWidgetByCookie(!1)},currentUserHaveStakeholderAssociated:function(){return bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0},getWidgetByCookie:function(e){var t=bizagi.util.defaultWidget();return e?t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:this.currentUserHaveStakeholderAssociated()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:t&&t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},getMainController:function(){return this.mainController}}),$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(e,t){this.workportalFacade=e,this.dataService=t,this.resources=bizagi.localization,this.componentContainers={},this.subscribers=[],this.disposed=!1,this.tmpl={},this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(e,t){return this.disposed?null:$(document).triggerHandler(e,t)},subscribe:function(e,t){if(this.disposed)return null;$(document).bind(e,t),this.subscribers.push({event:e})},subscribeOneTime:function(e,t){if(this.disposed)return null;$(document).one(e,t),this.subscribers.push({event:e})},unsubscribe:function(e,t){if(this.disposed)return null;t?$(document).unbind(e,t):$(document).unbind(e)},render:function(){var e=this,t=new $.Deferred;return e.renderingDeferred=new $.Deferred,$.when(e.areTemplatedLoaded()).pipe((function(){return e.renderContent()})).done((function(){e.postRender(),t.resolve(e.getContent()),e.renderingDeferred.resolve()})),t.promise()},getContent:function(){return this.content},getResource:function(e,t){return this.resources.getResource(e,t)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(e){return"[data-bizagi-component="+e+"]"},getComponentContainer:function(e){var t=this.getContent();return t&&0!=t.length?$(this.getComponentSelector(e),t):null},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var e=this;null!=e.subscribers&&$.each(e.subscribers,(function(t,i){e.unsubscribe(i.event)})),setTimeout((function(){bizagi.util.dispose(e),e.disposed=!0}),bizagi.override.disposeTime||50)},loadTemplates:function(e){var t=this.templatesDeferred=new $.Deferred,i=[],n=null==e.useNewEngine||e.useNewEngine;for(var a in e)"useNewEngine"!=a&&i.push(this.loadTemplate({name:a,path:e[a],useNewEngine:n}));return $.when.apply($,i).done((function(){t.resolve()})),t.promise()},loadTemplate:function(e){var t=this;return t.tmpl[e.name]?t.tmpl[e.name]:e.useNewEngine?bizagi.templateService.getTemplateWidget(e.path).done((function(i){t.tmpl[e.name]=i})):bizagi.templateService.getTemplate(e.path).done((function(i){t.tmpl[e.name]=i}))},getTemplate:function(e){return this.tmpl.hasOwnProperty(e)?this.tmpl[e]:null},isRendered:function(){return!!this.renderingDeferred&&this.renderingDeferred.promise()},areTemplatedLoaded:function(){return this.templatesDeferred}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.widgets.widget",{BIZAGI_WORKPORTAL_WIDGET_INTEGRATION:"widgetIntegration",BIZAGI_WORKPORTAL_WIDGET_WEBPART:"webpart",BIZAGI_WORKPORTAL_WIDGET_INBOX:"inbox",BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH:"advanceSearch",BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"homeportal",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY:"project.activity",BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:"projectDashboard",BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:"inboxGrid",BIZAGI_WORKPORTAL_WIDGET_ROUTING:"routing",BIZAGI_WORKPORTAL_WIDGET_SEARCH:"search",BIZAGI_WORKPORTAL_WIDGET_RENDER:"activityform",BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm",BIZAGI_WORKPORTAL_WIDGET_RENDERFORM:"renderform",BIZAGI_WORKPORTAL_WIDGET_NEWCASE:"newCase",BIZAGI_WORKPORTAL_WIDGET_QUERIES:"queries",BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION:"queriesDefinition",BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT:"queriesShortcut",BIZAGI_WORKPORTAL_WIDGET_QUERYFORM:"queryform",BIZAGI_WORKPORTAL_WIDGET_LISTCASES:"listCases",BIZAGI_WORKPORTAL_WIDGET_ASYNC:"async",BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME:"genericiframe",BIZAGI_WORKPORTAL_WIDGET_SUBMENU:"subMenu",BIZAGI_WORKPORTAL_WIDGET_PRINT:"print",BIZAGI_WORKPORTAL_WIDGET_FONTSIZE:"fontsize",BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:"oldrenderintegration",BIZAGI_WORKPORTAL_WIDGET_PAGE:"page",BIZAGI_WORKPORTAL_WIDGET_ENTITIES:"entities",BIZAGI_WORKPORTAL_WIDGET_REPORTS:"reports",BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU:"reportsMenu",BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART:"reportsChart",BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS:"smartfolders",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES:"adminReassignCases",BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:"reassignCase",BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD:"asyncECMUpload",BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE:"processTree",BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE:"entitiesTree",BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE:"usersTable",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG:"activityLog",BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG:"authenticationLog",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES:"entityAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS:"encryptPasswords",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS:"userPendingRequests",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:"adminCaseSearch",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES:"asyncActivities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:"defaultsAssignUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS:"transferCaseSecurityPermissions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:"userProfiles",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS:"adminAlarms",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES:"userlicenses",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS:"dimensions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES:"documentTemplates",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES:"processes",BIZAGI_WORKPORTAL_WIDGET_START_PROCESS:"startProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES:"businessPolicies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE:"languageAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE:"businessPoliciesDecisionTable",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS:"businessPoliciesPolitics",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES:"businessPoliciesRules",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS:"businessPoliciesTabs",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES:"businessPoliciesVocabularies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES:"adminPreferences",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS:"adminDisplayOptions",BIZAGI_WORKPORTAL_WIDGET_TREE:"tree",BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY:"graphicquery",BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW:"processModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:"adminUsers",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION:"usersDelegation",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER:"usersDelegationSearchUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS:"adminStakeholders",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS:"events",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE:"release",BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER:"processDiagramHelper",BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP:"activityMapTooltip",BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY:"usersummary",BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST:"mySearchList",BIZAGI_WORKPORTAL_WIDGET_LOADFORM:"loadForm",BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE:"templates",BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV:"dialognav",BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS:"holidays",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME:"projectName",BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS:"oauth2Applications",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES:"adhocProcesses",BIZAGI_WORKPORTAL_WIDGET_TIMELINE:"timeline",BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER:"adhocProcessModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES:"adhocEntities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS:"adhocUserGroups",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS:"adhocCreateProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP:"adhocBooleanExp",BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS:"adhocCreateProcess",BIZAGI_WORKPORTAL_WIDGET_PROFLY:"adhocprofly",BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT:"sessionTimeOut",BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT_EXPIRED:"sessionTimeOutExpired",BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY:"userPrivacy",BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED:"accessDenied",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES:"adminBusinessPolices",BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL:"usersModal",BIZAGI_WORKPORTAL_WIDGET_QUERIES_MANAGEMENT:"queriesManagement",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PERMISSION_REPORT:"userPermissionReport",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_DESCRIPTION_CONTENT:"activityDescriptionContent",BIZAGI_WORKPORTAL_WIDGET_QUICKACTIONS_EXECUTE:"quickActionsExecute",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ERROR_LOGS:"errorLogs",BIZAGI_WORKPORTAL_WIDGET_SMARTINBOX:"smartinbox",BIZAGI_WORKPORTAL_WIDGET_ADMIN_SMARTINBOX:"smartinboxAdmin",BIZAGI_WORKPORTAL_WIDGET_CANCEL_CASE:"cancelCase"},(_bizagi$workportal$co={init:function(e,t,i){this._super(e,t),this.params=i,i&&i.menu&&(this.menu=i.menu),this.observableElement=$({}),this.widgetReadyDeferred=new $.Deferred,this.isBlocked=!1},publish:function(e,t){if(this.disposed)return null;$(document).triggerHandler(e,$.extend(t,{referrer:this.getWidgetName()}))},changeWidget:function(e,t){t=t||{};var i=$.extend(t,{widgetName:e});this.publish("changeWidget",i)},executeAction:function(e,t){t=t||{};var i=$.extend(t,{action:e});this.publish("executeAction",i)},showGraphicQuery:function(e){var t=this;!0===e.isAdhoc?bizagi.loader.start("processmodelerview").then((function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,data:e,modalParameters:{title:"Process viewer",refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})):bizagi.loader.start("processviewer").then((function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,data:e,modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}))},isProcessOnTheFlyCase:function(){return!0},showTimeLine:function(e){var t=this;bizagi.loader.startAndThen("timeline").then((function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TIMELINE,data:e,modalParameters:{title:t.getResource("workportal-project-casedashboard-timeline"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}))},showSelectUser:function(e){var t=this;bizagi.loader.startAndThen("admin").then((function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE,data:{},closeVisible:!1,maximize:!0,modalParameters:{title:bizagi.localization.getResource("workportal-widget-usertable-search-user"),width:"930px",id:"SelectUser"},userLinkLabel:[bizagi.localization.getResource("workportal-widget-admin-defaults-assignation-select-link")],parentDef:e,showBackButton:!1,onClose:function(){e.reject()}}),$.when(e).done((function(e,i,n){t.publish("closeCurrentDialog")}))}))}},_defineProperty(_bizagi$workportal$co,"showSelectUser",(function(e){var t=this;bizagi.loader.startAndThen("admin").then((function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE,data:{},closeVisible:!1,maximize:!0,modalParameters:{title:bizagi.localization.getResource("workportal-widget-usertable-search-user"),width:"930px",id:"SelectUser"},userLinkLabel:[bizagi.localization.getResource("workportal-widget-admin-defaults-assignation-select-link")],parentDef:e,showBackButton:!1,onClose:function(){e.reject()}}),$.when(e).done((function(e,i,n){t.publish("closeCurrentDialog")}))}))})),_defineProperty(_bizagi$workportal$co,"routingExecute",(function(e){if(null==e)return!1;var t=e.find("#idCase").val()||this.params.idCase,i=e.find("#idWorkflow").val()||this.params.idWorkflow,n=e.find("#idWorkItem").val()||e.parent().find("#idWorkItem").val(),a=e.find("#idTask").val(),s=e.find("#eventAsTasks").val()||!1;return this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkflow:i,idWorkItem:n,idTask:a,eventAsTasks:s}),!0})),_defineProperty(_bizagi$workportal$co,"getWidgetName",(function(){return this.Class.fullName})),_defineProperty(_bizagi$workportal$co,"sub",(function(e){this.observableElement.off.apply(this.observableElement,arguments),this.observableElement.on.apply(this.observableElement,arguments)})),_defineProperty(_bizagi$workportal$co,"unsub",(function(){this.observableElement.off.apply(this.observableElement,arguments)})),_defineProperty(_bizagi$workportal$co,"pub",(function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)})),_defineProperty(_bizagi$workportal$co,"pubDeadLockDetection",(function(){var e=new $.Deferred;if(self.isBlocked)e.reject();else{self.isBlocked=!0;var t=this.pub.apply(this,arguments),i=Array.isArray(t)?t:[t];$.when.apply($,i).done((function(t){self.isBlocked=!1,e.resolve()}))}return e.promise()})),_defineProperty(_bizagi$workportal$co,"clean",(function(){if(this.observableElement){var e=$._data(this.observableElement[0],"events");if(e)for(var t in e)"notify"!=t&&"showDialogWidget"!=t&&"showNotification"!=t&&this.unsub(t)}})),_defineProperty(_bizagi$workportal$co,"isReady",(function(){return this.widgetReadyDeferred.promise()})),_defineProperty(_bizagi$workportal$co,"setWidgetReady",(function(){this.widgetReadyDeferred.resolve()})),_defineProperty(_bizagi$workportal$co,"getDateWithTimezone",(function(e,t,i){var n=window.bizagi.moment;return i?new Date(n.tz(i,e,t).format()):new Date(n().tz(t).format())})),_bizagi$workportal$co)),
/***
@title:
Image Zoom

@version:
2.0

@author:
Andreas Lagerkvist

@date:
2008-08-31

@url:
http://andreaslagerkvist.com/jquery/image-zoom/

@license:
http://creativecommons.org/licenses/by/3.0/

@copyright:
2008 Andreas Lagerkvist (andreaslagerkvist.com)

@requires:
jquery, jquery.imageZoom.css, jquery.imageZoom.png

@does:
This plug-in makes links pointing to images open in the "Image Zoom". Clicking a link will zoom out the clicked image to its target-image. Click anywhere on the image or the close-button to zoom the image back in. Only ~3k minified.

@howto:
jQuery(document.body).imageZoom(); Would make every link pointing to an image in the document open in the zoom.

@exampleHTML:
<ul>
	<li><a href="http://exscale.se/__files/3d/bloodcells.jpg">Bloodcells</a></li>
	<li><a href="http://exscale.se/__files/3d/x-wing.jpg">X-Wing</a></li>
	<li><a href="http://exscale.se/__files/3d/weve-moved.jpg">We've moved</a></li>
</ul>

<ul>
	<li><a href="http://exscale.se/__files/3d/lamp-and-mates/lamp-and-mates-01.jpg"><img src="http://exscale.se/__files/3d/lamp-and-mates/lamp-and-mates-01_small.jpg" alt="Lamp and Mates" /></a></li>
	<li><a href="http://exscale.se/__files/3d/stugan-winter.jpg"><img src="http://exscale.se/__files/3d/stugan-winter_small.jpg" alt="The Cottage - Winter time" /></a></li>
	<li><a href="http://exscale.se/__files/3d/ps2.jpg"><img src="http://exscale.se/__files/3d/ps2_small.jpg" alt="PS2" /></a></li>
</ul>

@exampleJS:
// I don't run it because my site already uses imgZoom
// jQuery(document.body).imageZoom();
***/
jQuery.fn.imageZoom=function(e){var t=jQuery.extend({speed:200,dontFadeIn:1,hideClicked:1,imageMargin:30,className:"jquery-image-zoom",loading:"Loading..."},e);return t.doubleSpeed=t.speed/4,this.click((function(e){var i=jQuery(e.target),n=i.is("a")?i:i.parents("a");(n=!(!n||!n.is("a"))&&n)||(n=i||!1);var a=i;if(n){n.oldText=n.text(),n.setLoadingImg=function(){a?a.css({opacity:"0.5"}):n.text(t.loading)},n.setNotLoadingImg=function(){a?a.css({opacity:"1"}):n.text(n.oldText)};var s=n.attr("href")||n.attr("src");if(jQuery("div."+t.className+' img[src="'+s+'"]').length)return!1;var o=function(e){n.setNotLoadingImg();var i=a||n,o=a?t.hideClicked:0,r=i.offset(),l={width:i.outerWidth(),height:i.outerHeight(),left:r.left,top:r.top},u=jQuery('<div><img src="'+s+'" alt=""/></div>').css("position","absolute").appendTo(document.body),c={width:e.width,height:e.height},d=jQuery(window).width(),p=jQuery(window).height();if(c.width>d-2*t.imageMargin){var m=d-2*t.imageMargin;c.height=m/c.width*c.height,c.width=m}if(c.height>p-2*t.imageMargin){var h=p-2*t.imageMargin;c.width=h/c.height*c.width,c.height=h}c.left=(d-c.width)/2+jQuery(window).scrollLeft(),c.top=(p-c.height)/2+jQuery(window).scrollTop();var f=jQuery('<a href="#">Close</a>').appendTo(u).hide();o&&n.css("visibility","hidden"),u.addClass(t.className).css(l).animate(c,t.speed,(function(){f.fadeIn(t.doubleSpeed)})),"number"==typeof t.zIndex&&$(u).css("z-index",t.zIndex);var g=function(){return f.fadeOut(t.doubleSpeed,(function(){u.animate(l,t.speed,(function(){$("body",window.document).off("click"),n.css("visibility","visible"),u.remove()}))})),!1};u.click(g),f.click(g),$("body",window.document).on("click",g)},r=new Image;return r.src=s,r.complete?o(r):(n.setLoadingImg(),r.onload=function(){o(r)}),!1}}))},$(document).keydown((function(e){27==e.keyCode&&$("div.jquery-image-zoom a").click()})),function(e){e.widget("ui.check",{_create:function(){var t=this,i=(this.element,t.options,this.element),n=t.input=e("input[type=checkbox]",i);i.attr("for")==n.attr("id")?(n.detach(),i.wrap('<div class="ui-checkbox"></div>'),n.insertBefore(i),i.hover((function(){e(this).addClass("ui-checkbox-state-hover"),n.is(":checked")&&e(this).addClass("ui-checkbox-state-checked")}),(function(){e(this).removeClass("ui-checkbox-state-hover")})),n.bind("update",(function(e,a){var s=!a||void 0===a.triggerChange||a.triggerChange;n.is(":checked")?i.addClass("ui-checkbox-state-checked"):i.removeClass("ui-checkbox-state-highlight ui-checkbox-state-checked ui-checkbox-state-hover"),s&&t._trigger("change",window.event,{value:n.is(":checked")})})).trigger("update").click((function(){e(this).trigger("update")})).focus((function(){n.is(":checked")&&i.addClass("ui-checkbox-state-highlight")})).blur((function(){i.removeClass("ui-checkbox-state-highlight")}))):alert("label and input element are not related in label:"+i.attr("id"))},checkItem:function(e){this.input.attr("checked",!0),this.input.prop("checked",!0),this.input.trigger("update",{triggerChange:e})},uncheckItem:function(e){this.input.attr("checked",!1),this.input.prop("checked",!1),this.input.trigger("update",{triggerChange:e})}}),e.extend(e.ui.check,{version:"@VERSION",eventPrefix:"check"})}(jQuery),function(e){e.widget("ui.selectmenu",{getter:"value",version:"1.8",eventPrefix:"selectmenu",options:{transferClasses:!0,style:"popup",width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null},_create:function(){var t=this,i=this.options;this.ids=[this.element.attr("id")+"-button",this.element.attr("id")+"-menu"],this._safemouseup=!0,this.newelement=e('<a class="'+this.widgetFullName+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" aria-haspopup="true" aria-owns="'+this.ids[1]+'"></a>').insertAfter(this.element);var n=this.element.attr("tabindex");n&&this.newelement.attr("tabindex",n),this.newelement.data("selectelement",this.element),this.selectmenuIcon=e('<span class="'+this.widgetFullName+'-icon ui-icon"></span>').prependTo(this.newelement).addClass("popup"==i.style?"ui-icon-triangle-2-n-s":"ui-icon-triangle-1-s"),e("label[for="+this.element.attr("id")+"]").attr("for",this.ids[0]).bind("click",(function(){try{t.newelement[0].focus()}catch(e){}return!1})),this.newelement.bind("mousedown",(function(e){return t._toggle(e),"popup"==i.style&&(t._safemouseup=!1,setTimeout((function(){t._safemouseup=!0}),300)),!1})).bind("click",(function(){return!1})).keydown((function(i){var n=!0;switch(i.keyCode){case e.ui.keyCode.ENTER:n=!0;break;case e.ui.keyCode.SPACE:n=!1,t._toggle(i);break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,t.list.is(".ui-selectmenu-open")?(t._moveSelection(-1),t.open()):t._moveSelection(-1);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.RIGHT:n=!1,t.list.is(".ui-selectmenu-open")?(t._moveSelection(1),t.open()):t._moveSelection(1);break;case e.ui.keyCode.TAB:n=!0;break;default:n=!1,t._typeAhead(i.keyCode,"focus")}return n})).bind("mouseover focus",(function(){e(this).addClass(t.widgetFullName+"-focus ui-state-hover")})).bind("mouseout blur",(function(){e(this).removeClass(t.widgetFullName+"-focus ui-state-hover")})),e(document).mousedown((function(e){t.close(e)})),this.element.click((function(){this._refreshValue()})).focus((function(){this.newelement&&this.newelement[0].focus()}));var a="dropdown"==i.style?" ui-corner-bottom":" ui-corner-all";this.list=e('<ul class="'+t.widgetFullName+"-menu ui-widget ui-widget-content"+a+'" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"></ul>').appendTo("body");var s=[];this.element.find("option").each((function(){s.push({value:e(this).attr("value"),text:t._formatText(jQuery(this).text()),selected:e(this).attr("selected"),classes:e(this).attr("class"),parentOptGroup:e(this).parent("optgroup").attr("label")})}));for(var o="popup"==t.options.style?" ui-state-active":"",r=0;r<s.length;r++){var l=e('<li role="presentation"><a href="#" tabindex="-1" role="option" aria-selected="false">'+s[r].text+"</a></li>").data("index",r).addClass(s[r].classes).data("optionClasses",s[r].classes||"").mouseup((function(i){if(t._safemouseup){var n=e(this).data("index")!=t._selectedIndex();t.index(e(this).data("index")),t.select(i),n&&t.change(i),t.close(i,!0)}return!1})).click((function(){return!1})).bind("mouseover focus",(function(){t._selectedOptionLi().addClass(o),t._focusedOptionLi().removeClass(t.widgetFullName+"-item-focus ui-state-hover"),e(this).removeClass("ui-state-active").addClass(t.widgetFullName+"-item-focus ui-state-hover")})).bind("mouseout blur",(function(){e(this).is(t._selectedOptionLi())&&e(this).addClass(o),e.browser.msie||e(this).removeClass(t.widgetFullName+"-item-focus ui-state-hover")}));if(s[r].parentOptGroup){var u=t.widgetFullName+"-group-"+s[r].parentOptGroup.replace(/[^a-zA-Z0-9]/g,"");this.list.find("li."+u).size()?this.list.find("li."+u+":last ul").append(l):e('<li role="presentation" class="'+t.widgetFullName+"-group "+u+'"><span class="'+t.widgetFullName+'-group-label">'+s[r].parentOptGroup+"</span><ul></ul></li>").appendTo(this.list).find("ul").append(l)}else l.appendTo(this.list);if(this.list.bind("mousedown mouseup",(function(){return!1})),i.icons)for(var c in i.icons)if(l.is(i.icons[c].find)){l.data("optionClasses",s[r].classes+" "+t.widgetFullName+"-hasIcon").addClass(t.widgetFullName+"-hasIcon");var d=i.icons[c].icon||"";l.find("a:eq(0)").prepend('<span class="'+t.widgetFullName+"-item-icon ui-icon "+d+'"></span>')}}if(this.list.find("li:last").addClass("ui-corner-bottom"),"popup"==i.style&&this.list.find("li:first").addClass("ui-corner-top"),i.transferClasses){var p=this.element.attr("class")||"";this.newelement.add(this.list).addClass(p)}var m=this.element.clone().appendTo("body"),h=m.css({position:"absolute",visibility:"hidden",display:"block"}).width();m.remove(),this.newelement.width(i.width?i.width:h),"dropdown"==i.style?this.list.width(i.menuWidth?i.menuWidth:i.width?i.width:h):this.list.width(i.menuWidth?i.menuWidth:i.width?i.width-i.handleWidth:h-i.handleWidth),i.maxHeight&&i.maxHeight<this.list.height()&&this.list.height(i.maxHeight),this._optionLis=this.list.find("li:not(."+t.widgetFullName+"-group)"),this.list.keydown((function(i){var n=!0;switch(i.keyCode){case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,t._moveSelection(-1),t.open();break;case e.ui.keyCode.DOWN:case e.ui.keyCode.RIGHT:n=!1,t._moveSelection(1),t.open();break;case e.ui.keyCode.HOME:n=!1,t._moveFocus(":first");break;case e.ui.keyCode.PAGE_UP:n=!1,t._scrollPage("up");break;case e.ui.keyCode.PAGE_DOWN:n=!1,t._scrollPage("down");break;case e.ui.keyCode.END:n=!1,t._moveFocus(":last");break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:n=!1,t.close(i,!0),e(i.target).parents("li:eq(0)").trigger("mouseup");break;case e.ui.keyCode.TAB:n=!0,t.close(i,!0);break;case e.ui.keyCode.ESCAPE:n=!1,t.close(i,!0);break;default:n=!1,t._typeAhead(i.keyCode,"focus")}return n})),"dropdown"==i.style?(this.newelement.addClass(t.widgetFullName+"-dropdown"),this.list.addClass(t.widgetFullName+"-menu-dropdown")):(this.newelement.addClass(t.widgetFullName+"-popup"),this.list.addClass(t.widgetFullName+"-menu-popup")),this._selectedIndex()&&-1!=this._selectedIndex()?this.newelement.prepend('<span class="'+t.widgetFullName+'-status">'+s[this._selectedIndex()].text+"</span>"):this.newelement.prepend('<span class="'+t.widgetFullName+'-status"></span>'),this.element.hide(),1==this.element.attr("disabled")&&this.disable(),this.index(this._selectedIndex()),setTimeout((function(){t._refreshPosition()}),200),e(window).resize((function(){t._refreshPosition()}))},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled");var t=e("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id"));t&&t.unbind("click"),this.newelement.remove(),this.list.remove(),this.element.show()},_typeAhead:function(t,i){var n=this;n._prevChar||(n._prevChar=["",0]);var a=String.fromCharCode(t);c=a.toLowerCase();var s=!1;function o(t,a){s=!0,e(t).trigger(i),n._prevChar[1]=a}this.list.find("li a").each((function(t){if(!s){var i=e(this).text();0!=i.indexOf(a)&&0!=i.indexOf(c)||(n._prevChar[0]==a?n._prevChar[1]<t&&o(this,t):o(this,t))}})),this._prevChar[0]=a},_uiHash:function(){var t=this.index();return{index:t,option:e("option",this.element).get(t),value:this.element[0].value}},open:function(e){if("true"!=this.newelement.attr("aria-disabled")){this._refreshPosition(),this._closeOthers(e),this.newelement.addClass("ui-state-active"),this.list.appendTo("body").addClass(this.widgetFullName+"-open").attr("aria-hidden",!1),this._selectedIndex()>0&&this.list.find("li:not(."+this.widgetFullName+"-group):eq("+this._selectedIndex()+") a")[0].focus(),"dropdown"==this.options.style&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"),this._refreshPosition(),this._trigger("open",e,this._uiHash());var t=this.widgetFullName+"-item-"+Math.round(1e3*Math.random());this._optionLis.eq(this._selectedIndex()).find("a:eq(0)").attr("id",t).focus()}},close:function(e,t){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.list.attr("aria-hidden",!0).removeClass(this.widgetFullName+"-open"),"dropdown"==this.options.style&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),t&&this.newelement[0].focus(),this._trigger("close",e,this._uiHash()))},change:function(e){this.element.trigger("changeSelection"),this._trigger("changeSelection",e,this._uiHash())},select:function(e){this._trigger("select",e,this._uiHash())},_closeOthers:function(t){e("."+this.widgetFullName+".ui-state-active").not(this.newelement).each((function(){e(this).data("selectelement").selectmenu("close",t)})),e("."+this.widgetFullName+".ui-state-hover").trigger("mouseout")},_toggle:function(e,t){this.list.is("."+this.widgetFullName+"-open")?this.close(e,t):this.open(e)},_formatText:function(e){return this.options.format?this.options.format(e):e},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._selectedIndex()<0?e():this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetFullName+"-item-focus")},_moveSelection:function(e){var t=parseInt(this._selectedOptionLi().data("index"),10)+e;return this._optionLis.eq(t).trigger("mouseup")},_moveFocus:function(e){if(isNaN(e))t=parseInt(this._optionLis.filter(e).data("index"),10);else var t=parseInt(this._focusedOptionLi().data("index"),10)+e;t<0&&(t=0),t>this._optionLis.size()-1&&(t=this._optionLis.size()-1);var i=this.widgetFullName+"-item-"+Math.round(1e3*Math.random());this._focusedOptionLi().find("a:eq(0)").attr("id",""),this._optionLis.eq(t).find("a:eq(0)").attr("id",i)[0].focus(),this.list.attr("aria-activedescendant",i)},_scrollPage:function(e){var t=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());t="up"==e?-t:t,this._moveFocus(t)},_setData:function(e,t){this.options[e]=t,"disabled"==e&&(this.close(),this.element.add(this.newelement).add(this.list)[t?"addClass":"removeClass"](this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",t))},_scrollPageInternal:function(){},index:function(e){if(!arguments.length)return this._selectedIndex();this.element[0].selectedIndex=e,this._refreshValue()},value:function(e){if(!arguments.length)return this.element[0].value;this.element[0].value=e,this._refreshValue(),this.select()},_refreshValue:function(){var e="popup"==this.options.style?" ui-state-active":"",t=this.widgetFullName+"-item-"+Math.round(1e3*Math.random());this.list.find("."+this.widgetFullName+"-item-selected").removeClass(this.widgetFullName+"-item-selected"+e).find("a").attr("aria-selected","false").attr("id",""),this._selectedOptionLi().addClass(this.widgetFullName+"-item-selected"+e).find("a").attr("aria-selected","true").attr("id",t);var i=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",n=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(i).data("optionClasses",n).addClass(n).find("."+this.widgetFullName+"-status").html(this._selectedOptionLi().find("a:eq(0)").html()),this.list.attr("aria-activedescendant",t)},_refreshPosition:function(){this.list.css("left",this.newelement.offset().left);var t=this.newelement.offset().top,i=this.list[0].scrollTop;this.list.find("li:lt("+this._selectedIndex()+")").each((function(){i-=e(this).outerHeight()})),this.newelement.is("."+this.widgetFullName+"-popup")?(t+=i,this.list.css("top",t)):(t+=this.newelement.height(),this.list.css("top",t))}})}(jQuery),function(e){function t(){this._disabledInputs=[],this.regional=[],this.regional[""]={show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]},this._defaults={appendText:"",showSeconds:!1,showZeroInHour:!0,timeSteps:[1,1,1],initialField:0,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:!1,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null},e.extend(this._defaults,this.regional[""])}var i="timeEntry";function n(t,i){for(var n in e.extend(t,i),i)null==i[n]&&(t[n]=null);return t}e.extend(t.prototype,{markerClassName:"hasTimeEntry",setDefaults:function(e){return n(this._defaults,e||{}),this},_connectTimeEntry:function(t,n){var a=e(t);if(!a.hasClass(this.markerClassName)){var s={};s.options=e.extend({},n),s._selectedHour=0,s._selectedMinute=0,s._selectedSecond=0,s._field=0,s.input=e(t),e.data(t,i,s);var o=this._get(s,"spinnerImage"),r=(this._get(s,"spinnerText"),this._get(s,"spinnerSize")),l=this._get(s,"appendText"),u=o?e('<span class="timeEntry_control" style="display: table-cell; bottom: 25%;width: '+r[0]+"px; height: "+r[1]+"px;"+(e.browser.mozilla&&e.browser.version<"1.9"?" padding-left: "+r[0]+"px; padding-bottom: "+(r[1]-18)+"px;":"")+'"></span>'):null;a.wrap('<span class="timeEntry_wrap" style="display: table; position: relative"></span>').after(l?'<span class="timeEntry_append">'+l+"</span>":"").after(u||""),a.addClass(this.markerClassName).bind("focus.timeEntry",this._doFocus).bind("blur.timeEntry",this._doBlur).bind("click.timeEntry",this._doClick).bind("keydown.timeEntry",this._doKeyDown).bind("keypress.timeEntry",this._doKeyPress),e.browser.mozilla&&a.bind("input.timeEntry",(function(t){e.timeEntry._parseTime(s)})),e.browser.msie&&a.bind("paste.timeEntry",(function(t){setTimeout((function(){e.timeEntry._parseTime(s)}),1)})),this._get(s,"useMouseWheel")&&e.fn.mousewheel&&a.mousewheel(this._doMouseWheel),u&&u.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)}},_enableTimeEntry:function(e){this._enableDisable(e,!1)},_disableTimeEntry:function(e){this._enableDisable(e,!0)},_enableDisable:function(t,n){var a=e.data(t,i);a&&(t.disabled=n,t.nextSibling&&"span"==t.nextSibling.nodeName.toLowerCase()&&e.timeEntry._changeSpinner(a,t.nextSibling,n?5:-1),e.timeEntry._disabledInputs=e.map(e.timeEntry._disabledInputs,(function(e){return e==t?null:e})),n&&e.timeEntry._disabledInputs.push(t))},_isDisabledTimeEntry:function(t){return e.inArray(t,this._disabledInputs)>-1},_changeTimeEntry:function(t,a,s){var o=e.data(t,i);if(o){if("string"==typeof a){var r=a;(a={})[r]=s}var l=this._extractTime(o);n(o.options,a||{}),l&&this._setTime(o,new Date(0,0,0,l[0],l[1],l[2]))}e.data(t,i,o)},_destroyTimeEntry:function(t){$input=e(t),$input.hasClass(this.markerClassName)&&($input.removeClass(this.markerClassName).unbind(".timeEntry"),e.fn.mousewheel&&$input.unmousewheel(),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e==t?null:e})),$input.parent().replaceWith($input),e.removeData(t,i))},_setTimeTimeEntry:function(t,n){var a=e.data(t,i);a&&this._setTime(a,n?"object"==_typeof(n)?new Date(n.getTime()):n:null)},_getTimeTimeEntry:function(t){var n=e.data(t,i),a=n?this._extractTime(n):null;return a?new Date(0,0,0,a[0],a[1],a[2]):null},_getOffsetTimeEntry:function(t){var n=e.data(t,i),a=n?this._extractTime(n):null;return a?1e3*(3600*a[0]+60*a[1]+a[2]):0},_doFocus:function(t){var a=t.nodeName&&"input"==t.nodeName.toLowerCase()?t:this;if(e.timeEntry._lastInput==a||e.timeEntry._isDisabledTimeEntry(a))e.timeEntry._focussed=!1;else{var s=e.data(a,i);e.timeEntry._focussed=!0,e.timeEntry._lastInput=a,e.timeEntry._blurredInput=null;var o=e.timeEntry._get(s,"beforeShow");n(s.options,o?o.apply(a,[a]):{}),e.data(a,i,s),e.timeEntry._parseTime(s),setTimeout((function(){e.timeEntry._showField(s)}),10)}},_doBlur:function(t){e.timeEntry._blurredInput=e.timeEntry._lastInput,e.timeEntry._lastInput=null},_doClick:function(t){var n,a=t.target,s=e.data(a,i);if(!e.timeEntry._focussed){var o=e.timeEntry._get(s,"separator").length+2;if(s._field=0,null!=a.selectionStart)for(var r=0;r<=Math.max(1,s._secondField,s._ampmField);r++){var l=r!=s._ampmField?r*o+2:s._ampmField*o+e.timeEntry._get(s,"ampmPrefix").length+e.timeEntry._get(s,"ampmNames")[0].length;if(s._field=r,a.selectionStart<l)break}else if(a.createTextRange){var u=e(t.srcElement),c=a.createTextRange(),d=t.clientX+document.documentElement.scrollLeft-(u.offset().left+parseInt({thin:2,medium:4,thick:6}[n=u.css("border-left-width")]||n,10))-c.offsetLeft;for(r=0;r<=Math.max(1,s._secondField,s._ampmField);r++){l=r!=s._ampmField?r*o+2:s._ampmField*o+e.timeEntry._get(s,"ampmPrefix").length+e.timeEntry._get(s,"ampmNames")[0].length;if(c.collapse(),c.moveEnd("character",l),s._field=r,d<c.boundingWidth)break}}}e.data(a,i,s),e.timeEntry._showField(s),e.timeEntry._focussed=!1},_doKeyDown:function(t){if(t.keyCode>=48)return!0;var n=e.data(t.target,i);switch(t.keyCode){case 9:return t.shiftKey?e.timeEntry._changeField(n,-1,!0):e.timeEntry._changeField(n,1,!0);case 35:t.ctrlKey?e.timeEntry._setValue(n,""):(n._field=Math.max(1,n._secondField,n._ampmField),e.timeEntry._adjustField(n,0));break;case 36:t.ctrlKey?e.timeEntry._setTime(n):(n._field=0,e.timeEntry._adjustField(n,0));break;case 37:e.timeEntry._changeField(n,-1,!1);break;case 38:e.timeEntry._adjustField(n,1);break;case 39:e.timeEntry._changeField(n,1,!1);break;case 40:e.timeEntry._adjustField(n,-1);break;case 46:e.timeEntry._setValue(n,"")}return!1},_doKeyPress:function(t){var n=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode);if(n<" ")return!0;var a=e.data(t.target,i);return e.timeEntry._handleKeyPress(a,n),!1},_doMouseWheel:function(t,n){if(!e.timeEntry._isDisabledTimeEntry(t.target)){n=e.browser.opera?-n/Math.abs(n):e.browser.safari?n/Math.abs(n):n;var a=e.data(t.target,i);a.input.focus(),a.input.val()||e.timeEntry._parseTime(a),e.timeEntry._adjustField(a,n),t.preventDefault()}},_expandSpinner:function(t){var n=e.timeEntry._getSpinnerTarget(t),a=e.data(e.timeEntry._getInput(n),i),s=e.timeEntry._get(a,"spinnerBigImage");if(s){a._expanded=!0;var o=e(n).offset(),r=null;e(n).parents().each((function(){var t=e(this);return"relative"!=t.css("position")&&"absolute"!=t.css("position")||(r=t.offset()),!r}));var l=e.timeEntry._get(a,"spinnerSize"),u=e.timeEntry._get(a,"spinnerBigSize");e('<div class="timeEntry_expand" style="position: absolute; left: '+(o.left-(u[0]-l[0])/2-(r?r.left:0))+"px; top: "+(o.top-(u[1]-l[1])/2-(r?r.top:0))+"px; width: "+u[0]+"px; height: "+u[1]+"px; background: transparent url("+s+') no-repeat 0px 0px; z-index: 10;"></div>').mousedown(e.timeEntry._handleSpinner).mouseup(e.timeEntry._endSpinner).mouseout(e.timeEntry._endExpand).mousemove(e.timeEntry._describeSpinner).insertAfter(n)}},_getInput:function(t){return e(t).siblings("."+e.timeEntry.markerClassName)[0]},_describeSpinner:function(t){var n=e.timeEntry._getSpinnerTarget(t),a=e.data(e.timeEntry._getInput(n),i);n.title=e.timeEntry._get(a,"spinnerTexts")[e.timeEntry._getSpinnerRegion(a,t)]},_handleSpinner:function(t){var n=e.timeEntry._getSpinnerTarget(t),a=e.timeEntry._getInput(n);if(!e.timeEntry._isDisabledTimeEntry(a)){a==e.timeEntry._blurredInput&&(e.timeEntry._lastInput=a,e.timeEntry._blurredInput=null);var s=e.data(a,i);e.timeEntry._doFocus(a);var o=e.timeEntry._getSpinnerRegion(s,t);e.timeEntry._changeSpinner(s,n,o),e.timeEntry._actionSpinner(s,o),e.timeEntry._timer=null,e.timeEntry._handlingSpinner=!0;var r=e.timeEntry._get(s,"spinnerRepeat");o>=3&&r[0]&&(e.timeEntry._timer=setTimeout((function(){e.timeEntry._repeatSpinner(s,o)}),r[0]),e(n).one("mouseout",e.timeEntry._releaseSpinner).one("mouseup",e.timeEntry._releaseSpinner))}},_actionSpinner:function(t,i){switch(t.input.val()||e.timeEntry._parseTime(t),i){case 0:this._setTime(t,void 0,!0);break;case 1:this._changeField(t,-1,!1);break;case 2:this._changeField(t,1,!1);break;case 3:this._adjustField(t,1);break;case 4:this._adjustField(t,-1)}},_repeatSpinner:function(t,i){e.timeEntry._timer&&(e.timeEntry._lastInput=e.timeEntry._blurredInput,this._actionSpinner(t,i),this._timer=setTimeout((function(){e.timeEntry._repeatSpinner(t,i)}),this._get(t,"spinnerRepeat")[1]))},_releaseSpinner:function(t){clearTimeout(e.timeEntry._timer),e.timeEntry._timer=null},_endExpand:function(t){e.timeEntry._timer=null;var n=e.timeEntry._getSpinnerTarget(t),a=e.timeEntry._getInput(n),s=e.data(a,i);e(n).remove(),s._expanded=!1},_endSpinner:function(t){e.timeEntry._timer=null;var n=e.timeEntry._getSpinnerTarget(t),a=e.timeEntry._getInput(n),s=e.data(a,i);e.timeEntry._isDisabledTimeEntry(a)||e.timeEntry._changeSpinner(s,n,-1),e.timeEntry._handlingSpinner&&(e.timeEntry._lastInput=e.timeEntry._blurredInput),e.timeEntry._lastInput&&e.timeEntry._handlingSpinner&&e.timeEntry._showField(s),e.timeEntry._handlingSpinner=!1},_getSpinnerTarget:function(e){return e.target||e.srcElement},_getSpinnerRegion:function(t,i){var n=this._getSpinnerTarget(i),a=e.browser.opera||e.browser.safari?e.timeEntry._findPos(n):e(n).offset(),s=e.browser.safari?e.timeEntry._findScroll(n):[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop],o=this._get(t,"spinnerIncDecOnly"),r=o?99:i.clientX+s[0]-a.left-(e.browser.msie?2:0),l=i.clientY+s[1]-a.top-(e.browser.msie?2:0),u=this._get(t,t._expanded?"spinnerBigSize":"spinnerSize"),c=o?99:u[0]-1-r,d=u[1]-1-l;if(u[2]>0&&Math.abs(r-c)<=u[2]&&Math.abs(l-d)<=u[2])return 0;var p=Math.min(r,l,c,d);return p==r?1:p==c?2:p==l?3:4},_changeSpinner:function(t,i,n){e(i).css("background-position","-"+(n+1)*this._get(t,t._expanded?"spinnerBigSize":"spinnerSize")[0]+"px 0px")},_findPos:function(e){var t=curTop=0;if(e.offsetParent)for(t=e.offsetLeft,curTop=e.offsetTop;e=e.offsetParent;){var i=t;(t+=e.offsetLeft)<0&&(t=i),curTop+=e.offsetTop}return{left:t,top:curTop}},_findScroll:function(t){var i=!1;if(e(t).parents().each((function(){i|="fixed"==e(this).css("position")})),i)return[0,0];for(var n=t.scrollLeft,a=t.scrollTop;t=t.parentNode;)n+=t.scrollLeft||0,a+=t.scrollTop||0;return[n,a]},_get:function(t,i){return null!=t.options[i]?t.options[i]:e.timeEntry._defaults[i]},_parseTime:function(e){var t=this._extractTime(e),i=this._get(e,"showSeconds");if(t)e._selectedHour=t[0],e._selectedMinute=t[1],e._selectedSecond=t[2];else{var n=this._constrainTime(e);e._selectedHour=n[0],e._selectedMinute=n[1],e._selectedSecond=i?n[2]:0}e._secondField=i?2:-1,e._ampmField=this._get(e,"show24Hours")?-1:i?3:2,e._lastChr="",e._field=Math.max(0,Math.min(Math.max(1,e._secondField,e._ampmField),this._get(e,"initialField"))),""!=e.input.val()&&this._showTime(e)},_extractTime:function(e,t){t=t||e.input.val();var i=this._get(e,"separator"),n=t.split(i);""==i&&""!=t&&(n[0]=t.substring(0,2),n[1]=t.substring(2,4),n[2]=t.substring(4,6));var a=this._get(e,"ampmNames"),s=this._get(e,"show24Hours");if(n.length>=2){var o=!s&&t.indexOf(a[0])>-1,r=!s&&t.indexOf(a[1])>-1,l=parseInt(n[0],10);l=isNaN(l)?0:l,l=((o||r)&&12==l?0:l)+(r?12:0);var u=parseInt(n[1],10);u=isNaN(u)?0:u;var c=n.length>=3?parseInt(n[2],10):0;return c=isNaN(c)||!this._get(e,"showSeconds")?0:c,this._constrainTime(e,[l,u,c])}return null},_constrainTime:function(e,t){if(!(null!=t)){var i=this._determineTime(e,this._get(e,"defaultTime"))||new Date;t=[i.getHours(),i.getMinutes(),i.getSeconds()]}for(var n=!1,a=this._get(e,"timeSteps"),s=0;s<a.length;s++)n?t[s]=0:a[s]>1&&(t[s]=Math.round(t[s]/a[s])*a[s],n=!0);return t},_showTime:function(e,t){t=t||!1;var i=this._get(e,"show24Hours"),n=this._get(e,"separator"),a=this._formatNumber(e,i?e._selectedHour:(e._selectedHour+11)%12+1)+n+this._formatNumber(e,e._selectedMinute)+(this._get(e,"showSeconds")?n+this._formatNumber(e,e._selectedSecond):"")+(i?"":this._get(e,"ampmPrefix")+this._get(e,"ampmNames")[e._selectedHour<12?0:1]);this._setValue(e,a,t),this._showField(e)},_showField:function(t){var i=t.input[0];if(!t.input.is(":hidden")&&e.timeEntry._lastInput==i){var n=this._get(t,"separator"),a=n.length+2,s=t._field!=t._ampmField?t._field*a:t._ampmField*a-n.length+this._get(t,"ampmPrefix").length,o=s+(t._field!=t._ampmField?2:this._get(t,"ampmNames")[0].length);if(i.setSelectionRange)i.setSelectionRange(s,o);else if(i.createTextRange){var r=i.createTextRange();r.moveStart("character",s),r.moveEnd("character",o-t.input.val().length),r.select()}i.disabled||i.focus()}},_formatNumber:function(e,t){return(t<10&&this._get(e,"showZeroInHour")?"0":"")+t},_setValue:function(e,t,i){i=i||!1;(t!=e.input.val()||i)&&e.input.val(t).trigger("change",i)},_changeField:function(t,n,a){var s=""==t.input.val()||t._field==(-1==n?0:Math.max(1,t._secondField,t._ampmField));return s||(t._field+=n),this._showField(t),t._lastChr="",e.data(t.input[0],i,t),s&&a},_adjustField:function(e,t){""==e.input.val()&&(t=0);var i=this._get(e,"timeSteps");this._setTime(e,new Date(0,0,0,e._selectedHour+(0==e._field?t*i[0]:0)+(e._field==e._ampmField?12*t:0),e._selectedMinute+(1==e._field?t*i[1]:0),e._selectedSecond+(e._field==e._secondField?t*i[2]:0)))},_setTime:function(t,n,a){a=a||!1;n=this._determineTime(t,n);var s=this._constrainTime(t,n?[n.getHours(),n.getMinutes(),n.getSeconds()]:null);n=new Date(0,0,0,s[0],s[1],s[2]);n=this._normaliseTime(n);var o=this._normaliseTime(this._determineTime(t,this._get(t,"minTime"))),r=this._normaliseTime(this._determineTime(t,this._get(t,"maxTime")));n=o&&n<o?o:r&&n>r?r:n;var l=this._get(t,"beforeSetTime");l&&(n=l.apply(t.input[0],[this._getTimeTimeEntry(t.input[0]),n,o,r])),t._selectedHour=n.getHours(),t._selectedMinute=n.getMinutes(),t._selectedSecond=n.getSeconds(),this._showTime(t,a),e.data(t.input[0],i,t)},_normaliseTime:function(e){return e?(e.setFullYear(1900),e.setMonth(0),e.setDate(0),e):null},_determineTime:function(t,i){var n,a;return i?"string"==typeof i?function(i){var n=e.timeEntry._extractTime(t,i),a=new Date,s=n?n[0]:a.getHours(),o=n?n[1]:a.getMinutes(),r=n?n[2]:a.getSeconds();if(!n)for(var l=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,u=l.exec(i);u;){switch(u[2]||"s"){case"s":case"S":r+=parseInt(u[1],10);break;case"m":case"M":o+=parseInt(u[1],10);break;case"h":case"H":s+=parseInt(u[1],10)}u=l.exec(i)}return a=new Date(0,0,10,s,o,r,0),/^!/.test(i)&&(a.getDate()>10?a=new Date(0,0,10,23,59,59):a.getDate()<10&&(a=new Date(0,0,10,0,0,0))),a}(i):"number"==typeof i?(n=i,(a=new Date).setTime(a.getTime()+1e3*n),a):i:null},_handleKeyPress:function(e,t){if(t==this._get(e,"separator"))this._changeField(e,1,!1);else if(t>="0"&&t<="9"){var i=parseInt(t,10),n=parseInt(e._lastChr+t,10),a=this._get(e,"show24Hours"),s=0!=e._field?e._selectedHour:a?n<24?n:i:(n>=1&&n<=12?n:i>0?i:e._selectedHour)%12+(e._selectedHour>=12?12:0),o=1!=e._field?e._selectedMinute:n<60?n:i,r=e._field!=e._secondField?e._selectedSecond:n<60?n:i,l=this._constrainTime(e,[s,o,r]);this._setTime(e,new Date(0,0,0,l[0],l[1],l[2])),e._lastChr=t}else if(!this._get(e,"show24Hours")){t=t.toLowerCase();var u=this._get(e,"ampmNames");if(t==u[0].substring(0,1).toLowerCase()&&e._selectedHour>=12||t==u[1].substring(0,1).toLowerCase()&&e._selectedHour<12){var c=e._field;e._field=e._ampmField,this._adjustField(e,1),e._field=c,this._showField(e)}}}});var a=["getOffset","getTime","isDisabled"];e.fn.timeEntry=function(t){var i=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&e.inArray(t,a)>-1?e.timeEntry["_"+t+"TimeEntry"].apply(e.timeEntry,[this[0]].concat(i)):this.each((function(){if("input"==this.nodeName.toLowerCase())if("string"==typeof t)e.timeEntry["_"+t+"TimeEntry"].apply(e.timeEntry,[this].concat(i));else{var n=e.fn.metadata?e(this).metadata({single:"timePicker"}):{};e.timeEntry._connectTimeEntry(this,e.extend(n,t))}}))},e.timeEntry=new t}(jQuery),function(e){e.widget("ui.selectable2",e.ui.mouse,{options:{closest:!0,filter:"> *",keyboard:!0,multiple:!0,lasso:{cancel:":input,option",delay:0,distance:1,tolerance:"touch",appendTo:"body"}},_init:function(){var t=this;this.items=e(this.options.filter,this.element),this.element.addClass("ui-selectable ui-widget"),this.currentFocus=this.items.eq(0).attr("tabindex",0),this.refresh(1),this.element.disableSelection(),this.options.lasso&&(!0!==this.options.lasso&&e.extend(this.options,this.options.lasso),this._mouseInit()),this.element.bind("mousedown.selectable",(function(i){if(!t.options.disabled){var n=t._targetIsItem(i.target);if(n)return t._selection.length>1&&e(n).hasClass("ui-selected")?t._listenForMouseUp=1:!0===t._mouseSelect(i,n)||void 0}})).bind("mouseup.selectable",(function(e){if(t._listenForMouseUp){t._listenForMouseUp=0;var i=t._targetIsItem(e.target);if(i&&!0===t._mouseSelect(e,i))return!0}})).bind("focus.selectable",(function(){t.options.disabled||t.currentFocus.addClass("ui-state-focus")})).bind("blur.selectable",(function(){t.options.disabled||t.currentFocus.removeClass("ui-state-focus")})).bind("keydown.selectable",(function(i){if(!t.options.keyboard||t.options.disabled||!1===t._trigger("beforeselect",i))return!0;i.keyCode==e.ui.keyCode.DOWN&&(t.options.closest?t.selectClosest("down",i):t.next(i),i.preventDefault()),i.keyCode==e.ui.keyCode.RIGHT&&(t.options.closest?t.selectClosest("right",i):t.next(i),i.preventDefault()),i.keyCode==e.ui.keyCode.UP&&(t.options.closest?t.selectClosest("up",i):t.previous(i),i.preventDefault()),i.keyCode==e.ui.keyCode.LEFT&&(t.options.closest?t.selectClosest("left",i):t.previous(i),i.preventDefault()),(i.ctrlKey||i.metaKey)&&(i.keyCode==e.ui.keyCode.SPACE&&(t._toggleSelection(t.currentFocus,i),i.preventDefault()),65==i.keyCode&&(t.select("*"),i.preventDefault()))})),this.helper=e(document.createElement("div")).addClass("ui-selectable-lasso")},selectClosest:function(t,i){var n=[/(down|right)/.test(t)?1e4:-1e4,null],a=1e4,s=this.currentFocus.data("selectable-item");if(this.items.not(this.currentFocus).filter(":visible").each((function(){var i=e(this),o=i.data("selectable-item"),r={x:Math.abs(s.left-o.left)+Math.abs(o.left+this.offsetWidth-(s.left+this.offsetWidth)),y:Math.abs(s.top-o.top)+Math.abs(o.top+this.offsetHeight-(s.top+this.offsetHeight))};switch(t){case"up":s.top>o.top&&o.top>=n[0]&&(o.top!=n[0]||r.x<a)&&(n=[o.top,i],a=r.x);break;case"down":s.top<o.top&&o.top<=n[0]&&(o.top!=n[0]||r.x<a)&&(n=[o.top,i],a=r.x);break;case"left":s.left>o.left&&o.left>=n[0]&&(o.left!=n[0]||r.y<a)&&(n=[o.left,i],a=r.y);break;case"right":s.left<o.left&&o.left<=n[0]&&(o.left!=n[0]||r.y<a)&&(n=[o.left,i],a=r.y)}})),!n[1])return!1;var o=this.items.index(this.currentFocus[0]),r=this.items.index(n[1]);return this._selectAdjacent(i,r-o)},destroy:function(){this.items.removeClass("ui-selectable-item ui-selected ui-state-active"),this.element.removeClass("ui-selectable ui-selectable-disabled ui-widget").removeData("selectable").unbind(".selectable"),this._mouseDestroy(),this._selection=[],this._previousSelection=[]},_mouseCapture:function(e){return this.clickedOnItem=this._targetIsItem(e.target),!0},_mouseStart:function(t){var i=this.options;if(this.opos=[t.pageX,t.pageY],!i.disabled){this.refresh(1),this._trigger("start",t,this._uiHash()),this._previousSelection=this._selection.slice(),this.helper.appendTo("body").css({zIndex:100,position:"absolute",left:t.clientX,top:t.clientY,width:0,height:0});for(var n=this._selection.length-1;n>=0;n--)t.metaKey||t.ctrlKey?this!=this.clickedOnItem&&(e(this._selection[n]).data("selectable-item").startSelected=!0):i.multiple&&this._removeFromSelection(e(this._selection[n]),t)}},_mouseDrag:function(t){var i=this,n=this.options;if(!n.disabled&&n.multiple){var a=this.opos[0],s=this.opos[1],o=t.pageX,r=t.pageY;if(a>o){var l=o;o=a,a=l}if(s>r){l=r;r=s,s=l}return this.helper.css({left:a,top:s,width:o-a,height:r-s}),this.items.each((function(){var l=e.data(this,"selectable-item");if(l&&l.element!=i.element[0]){var u=!1;n.lasso&&"touch"==n.lasso.tolerance?u=!(l.left>o||l.right<a||l.top>r||l.bottom<s):n.lasso&&"fit"==n.lasso.tolerance&&(u=l.left>a&&l.right<o&&l.top>s&&l.bottom<r),u?l.startSelected?i._removeFromSelection(e(this),t):i._addToSelection(e(this),t):l.startSelected?i._addToSelection(e(this),t):i._removeFromSelection(e(this),t)}})),!1}},_mouseStop:function(t){for(var i=[],n=[],a=0;a<this._selection.length;a++){for(var s=!1,o=0;o<this._previousSelection.length;o++)this._selection[a][0]==this._previousSelection[o][0]&&(s=!0);s||i.push(this._selection[a])}for(a=this._previousSelection.length-1;a>=0;a--)this._previousSelection[a].data("selectable-item").selected||n.push(this._previousSelection[a]);i=e(e.map(i,(function(e){return e[0]}))),n=e(e.map(n,(function(e){return e[0]})));var r=e.extend(this._uiHash(),{added:i||[],removed:n||[]});return this._trigger("stop",t,r),(i&&i.length||n&&n.length)&&this._trigger("change",t,r),this.helper.remove(),!1},_mouseSelect:function(e,t){if(!1===this._trigger("beforeselect",e))return!0;this._select(e,t),this.element[0].focus(),e.preventDefault()},_targetIsItem:function(t){var i=e(t).parents().addBack().filter(":data(selectable-item)");return i.length&&i},_selection:[],_endSelection:function(t,i){var n=this._triggerDeselection(t);if(i&&i.length&&this._trigger("select",t,this._uiHash(i,"added")),i&&i.length||n&&n.length){var a=e.extend(this._uiHash(),{added:i||[],removed:n||[]});this._trigger("change",t,a)}},_triggerDeselection:function(t){for(var i=[],n=this._previousSelection.length-1;n>=0;n--){var a=this._previousSelection[n].data("selectable-item");a&&a.selected||i.push(this._previousSelection[n])}return this._previousSelection=[],(i=e(e.map(i,(function(e){return e[0]})))).length&&this._trigger("deselect",t,this._uiHash(i,"removed")),i},_clearSelection:function(t){for(var i=[],n=this._selection.length-1;n>=0;n--)t&&this._selection[n].data("selectable-item").selected&&i.push(this._selection[n]),this._selection[n].removeClass("ui-selected ui-state-active"),this._selection[n].data("selectable-item").selected=!1;this._previousSelection=this._selection.slice(),this._selection=[],t&&i.length&&this._trigger("deselect",t,this._uiHash(e(e.map(i,(function(e){return e[0]}))),"removed"))},_toggleSelection:function(e,t){var i=e.data("selectable-item").selected;return i?this._removeFromSelection(e,t):this._addToSelection(e),!i},_addToSelection:function(t,i){return!t.data("selectable-item")||t.data("selectable-item").selected?null:(this._selection.push(t),this.latestSelection=t,t.addClass("ui-selected ui-state-active"),t.data("selectable-item").selected=!0,i&&this._trigger("select",i,e.extend({lasso:!0},this._uiHash(t))),t)},_removeFromSelection:function(t,i){for(var n=0;n<this._selection.length;n++)if(this._selection[n][0]==t[0]){this._selection[n].removeClass("ui-selected ui-state-active"),this._selection[n].data("selectable-item").selected=!1,this._selection.splice(n,1),i&&this._trigger("deselect",i,this._uiHash(e(t),"removed"));break}},_updateSelectionMouse:function(t){var i=[];if(this.updateEvents(t),t&&t.shiftKey){this._clearSelection();for(var n=this.items.index(this.latestWithoutModifier[0])>this.items.index(this.currentFocus[0])?-1:1,a=this.latestWithoutModifier.data("selectable-item").selected?this.items.eq(this.items.index(this.latestWithoutModifier[0])+n):this.latestWithoutModifier;a.length&&a[0]!=this.currentFocus[0];)a[0]==this.previousFocus[0]?this._addToSelection(a):i.push(this._addToSelection(a)),a=this.items.eq(this.items.index(a[0])+n);i.push(this._addToSelection(this.currentFocus))}else{if(t&&(t.metaKey||t.ctrlKey))this._toggleSelection(this.currentFocus,t)&&i.push(this.currentFocus);else this._clearSelection(),i.push(this._addToSelection(this.currentFocus)),this.latestWithoutModifier=this.currentFocus}return e(e.map(i,(function(e){return e[0]})))},_updateSelection:function(t,i){var n=[];if(this.updateEvents(t),t&&t.shiftKey)if(this.currentFocus.data("selectable-item").selected)this._removeFromSelection(this.previousFocus,t);else{var a=this.items.index(this.latestSelection[0])>this.items.index(this.currentFocus[0])?1:-1;if(!this.previousFocus.data("selectable-item").selected)for(var s=i==a?this.items.eq(this.items.index(this.previousFocus[0])+a):this.previousFocus;s.length&&!s.data("selectable-item").selected;)n.push(this._addToSelection(s)),s=this.items.eq(this.items.index(s[0])+a);n.push(this._addToSelection(this.currentFocus))}else{if(t&&(t.metaKey||t.ctrlKey))return;this._clearSelection(t),n.push(this._addToSelection(this.currentFocus)),this.latestWithoutModifier=this.currentFocus}return e(e.map(n,(function(e){if(e)return e[0]})))},_select:function(t,i){this.previousFocus=this.currentFocus.attr("tabindex",-1),this.currentFocus=e(i).attr("tabindex",0),this.previousFocus.removeClass("ui-state-focus"),this.currentFocus.addClass("ui-state-focus");var n=this._updateSelectionMouse(t);this._endSelection(t,n)},_selectAdjacent:function(e,t){var i=this.items.eq(this.items.index(this.currentFocus[0])+t);if(i.length){this.previousFocus=this.currentFocus.attr("tabindex",-1),this.currentFocus=i.attr("tabindex",0),this.previousFocus.removeClass("ui-state-focus"),this.currentFocus.addClass("ui-state-focus"),this._previousSelection=this._selection.slice();var n=this._updateSelection(e,t);this._endSelection(e,n)}},previous:function(e){this._selectAdjacent(e,-1)},next:function(e){this._selectAdjacent(e,1)},refresh:function(t){var i=this.options,n=this;if(this.items=e(i.filter,this.element),this.items.addClass("ui-selectable-item"),this.items.each((function(){var t=e(this),i=t.offset();n.currentFocus&&n.currentFocus[0]!=this&&t.attr("tabindex",-1),e.data(this,"selectable-item",{left:i.left,top:i.top,right:i.left+t.width(),bottom:i.top+t.height(),startSelected:!1,selected:t.hasClass("ui-selected")})})),!t){this._previousSelection=this._selection.slice(),this._selection=[];for(var a=0;a<this._previousSelection.length;a++)this._previousSelection[a][0].parentNode&&this._selection.push(this._previousSelection[a]);this._endSelection()}},select:function(t){if((t=isNaN(parseInt(t))?e(t,this.element):this.items.eq(t)).length){this._clearSelection();var i=[],n=this;t.each((function(t){0==t&&(n.previousFocus=n.currentFocus.attr("tabindex",-1),n.currentFocus=e(this).attr("tabindex",0),n.previousFocus.removeClass("ui-state-focus"),n.currentFocus.addClass("ui-state-focus")),i.push(n._addToSelection(e(this)))})),this._endSelection(window.event,e(e.map(i,(function(e){return!!e&&e[0]}))))}},deselect:function(t){if(t||this._clearSelection(!0),(t=isNaN(parseInt(t))?e(t,this.element):this.items.eq(t)).length){this._previousSelection=this._selection.slice();var i=this;t.each((function(){i._removeFromSelection(e(this))})),this._endSelection(event)}},_uiHash:function(t,i){var n={previousFocus:this.previousFocus,currentFocus:this.currentFocus,selection:e(e.map(this._selection,(function(e){return e[0]})))};return i&&(n[i]=t),n},updateEvents:function(e){var t=this.options;e.shiftKey=!!t.multiple&&e.shiftKey,e.metaKey=!!t.multiple&&e.metaKey,e.ctrlKey=!!t.multiple&&e.ctrlKey}})}(jQuery),function(e){e.widget("ui.optiongroup",{_create:function(){var t=this,i=this.element,n=(t.options,e("input[type=radio]",i));e("label",i).each((function(i){var a=e(this),s=a.text(),o=e("input[type=radio]",a);a.attr("for")==o.attr("id")?(o.detach(),"rtl"==t.options.orientation?a.wrap('<div class="ui-radio ui-bizagi-rtl"></div>'):a.wrap('<div class="ui-radio"></div>'),"rtl"==t.options.orientation?o.insertAfter(a):o.insertBefore(a),a.text(s),a.hover((function(){e(this).addClass("ui-radio-state-hover")}),(function(){e(this).removeClass("ui-radio-state-hover")})).click((function(){var t=o.prop("checked");o.prop("checked",!t),t?o.removeAttr("checked"):o.attr("checked","checked"),bizagi.util.isIE()&&window.setTimeout((function(){a.css("display","inline-block"),e(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")}),0)})),o.bind("update",(function(){e(this).is(":checked")?(n.each((function(){("rtl"==t.options.orientation?e(this).prev():e(this).next()).removeClass("ui-radio-state-checked")})),a.addClass("ui-radio-state-checked")):a.removeClass("ui-radio-state-checked ui-radio-state-hover ui-radio-state-highlight"),e(this).is(":checked")&&t._trigger("change",window.event,{value:e(this).val(),text:a.text()})})).trigger("update").click((function(){e(this).trigger("update"),bizagi.util.isIE()&&window.setTimeout((function(){a.css("display","inline-block"),e(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")}),0)})).focus((function(){})).blur((function(){}))):alert("label and input element are not related in label:"+a.attr("id"))}))},setValue:function(t){var i=this.element,n=(this.options,e("input[type=radio]",i));e.each(n,(function(i){var n=e(this);n.val()==t&&(n.prop("checked",!0),n.attr("checked","checked"),n.trigger("update"))}))}}),e.extend(e.ui.optionGroup,{version:"@VERSION",eventPrefix:"optiongroup"})}(jQuery),function(e){e.fn.bizagiPagination=function(t){t=t||{};var i={limInf:0,totalPages:1,actualPage:1,listElement:e("ul"),first:"&lt;&lt;",firstClass:"first",prev:"&lt;",prevClass:"prev",next:"&gt;",nextClass:"next",last:"&gt;&gt;",lastClass:"last",liClass:"bz-page",arrowClass:"bz-pageArrow",selectedFocus:!0,clickCallBack:function(){}};t.actualPage>t.totalPages&&(t.actualPage=t.totalPages),e.extend(i,i,t);var n={previousPage:Math.max(1,parseInt(i.actualPage)-1),nextPage:parseInt(i.actualPage)+1};function a(t,n){var a;if(t=t||1,(n=n||0)>0)a=t;else{if(!(n<0))return;a=t-2}e.each(e("li."+i.liClass,i.listElement),(function(t,n){a++,e(this).data("page",a),e(this).find("span").html(a),e(this).attr("data-page",a),i.actualPage!=a||e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active")})),1==e(i.listElement).find(".active").length?e(i.listElement).parent().find("#tooltipPagination").css("visibility","hidden"):e(i.listElement).parent().find("#tooltipPagination").css("visibility","visible")}!function(){var t,s;if(i.totalElements=e("li."+i.liClass,i.listElement[0]).length,i.totalPages>i.totalElements&&i.totalElements>1&&(t=n.previousPage==i.actualPage,s=i.actualPage==i.totalPages,i.listElement.prepend("<li/>").find("li:first").addClass(i.prevClass).addClass(t?"pagination-disabled":"").data("page",n.previousPage).html(i.prev),i.listElement.prepend("<li/>").find("li:first").addClass(i.arrowClass+" "+i.firstClass).addClass(t?"pagination-disabled":"").data("page","1").html(i.first),i.listElement.append("<li/>").find("li:last").addClass(i.nextClass).addClass(s?"pagination-disabled":"").data("page",n.nextPage).html(i.next),i.listElement.append("<li/>").find("li:last").addClass(i.arrowClass+" "+i.lastClass).addClass(s?"pagination-disabled":"").data("page",i.totalPages).html(i.last)),function(){var t={};e("li:not(.pagination-disabled)",i.listElement).click((function(){t.page=e(this).hasClass(i.lastClass)?i.totalPages:e.trim(e(this).data("page")+" "),t.parent=e(this).parent(),t.self=e(this),i.clickCallBack(t)}))}(),i.selectedFocus&&i.actualPage>=i.totalElements&&i.totalPages>i.totalElements){var o,r=i.actualPage-Math.round(i.totalElements/2);o=r<1?1:r+i.totalElements>i.totalPages?(o=i.totalPages-i.totalElements)<1?1:o:r,0==i.listElement.find("li.active").length&&a(o,1)}}()}}(jQuery),function(e){e.fn.bizagiGridPagination=function(t){t=t||{};var i={limInf:0,totalPages:1,actualPage:1,listElement:e("ul"),first:"&lt;&lt;",firstClass:"first",prev:"&lt;",prevClass:"prev",next:"&gt;",nextClass:"next",last:"&gt;&gt;",lastClass:"last",liClass:"bz-page",arrowClass:"bz-pageArrow",selectedFocus:!0,scrolledHover:!1,clickCallBack:function(){}};t.actualPage>t.totalPages&&(t.actualPage=t.totalPages),e.extend(i,i,t);var n={previousPage:Math.max(1,parseInt(i.actualPage)-1),nextPage:parseInt(i.actualPage)+1};function a(t){t=t||1;var n=!1,a=e("li."+i.liClass+":first",i.listElement).data("page"),o=e("li."+i.liClass+":last",i.listElement).data("page");t<0&&a>1?n=!0:t>0&&o<i.totalPages&&(n=!0),n&&s(a,t)}function s(t,n){var a;if(t=t||1,(n=n||0)>0)a=t;else{if(!(n<0))return;a=t-2}e.each(e("li."+i.liClass,i.listElement),(function(t,n){a++,e(this).data("page",a),e(this).find("span").html(a),e(this).attr("data-page",a),i.actualPage!=a||e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active")})),1==e(i.listElement).find(".active").length?e(i.listElement).parent().find("#tooltipPagination").css("visibility","hidden"):e(i.listElement).parent().find("#tooltipPagination").css("visibility","visible")}!function(){var t,o;if(i.totalElements=e("li."+i.liClass,i.listElement[0]).length,i.totalPages>i.totalElements&&i.totalElements>1&&(t=n.previousPage==i.actualPage,o=i.actualPage==i.totalPages,i.listElement.prepend("<li/>").find("li:first").addClass(i.prevClass).addClass(t?"pagination-disabled":"").data("page",n.previousPage).html(i.prev),i.listElement.prepend("<li/>").find("li:first").addClass(i.arrowClass+" "+i.firstClass).addClass(t?"pagination-disabled":"").data("page","1").html(i.first),i.listElement.append("<li/>").find("li:last").addClass(i.nextClass).addClass(o?"pagination-disabled":"").data("page",n.nextPage).html(i.next),i.listElement.append("<li/>").find("li:last").addClass(i.arrowClass+" "+i.lastClass).addClass(o?"pagination-disabled":"").data("page",i.totalPages).html(i.last)),function(){var t={};e("li:not(.pagination-disabled)",i.listElement).click((function(){t.page=e(this).hasClass(i.lastClass)?i.totalPages:e.trim(e(this).data("page")+" "),t.parent=e(this).parent(),t.self=e(this),i.clickCallBack(t)})),i.scrolledHover&&(e("li."+i.nextClass,i.listElement).hover((function(){next=setInterval((function(){a(1)}),300)}),(function(){clearInterval(next)})),e("li."+i.prevClass,i.listElement).hover((function(){back=setInterval((function(){a(-1)}),300)}),(function(){clearInterval(back)})))}(),i.selectedFocus&&i.actualPage>=i.totalElements&&i.totalPages>i.totalElements){var r,l=i.actualPage-Math.round(i.totalElements/2);r=l<1?1:l+i.totalElements>i.totalPages?(r=i.totalPages-i.totalElements)<1?1:r:l,0==i.listElement.find("li.active").length&&s(r,1)}}()}}(jQuery),function(e){e.widget("ui.bizagi_grid",{options:{id:"no-id",columns:[],sortBy:"",sortType:"asc",showSummary:!1,collapse:!1,collapseState:!1,data:{},indexedData:{},maxColumns:0,buttonsPst:!1,title:"",tableCssClass:"",headerStyles:"",floatingHeader:!1,hasExclusiveCheck:!1,template:{grid:"",waiting:"",table:"",emptyTable:"",column:"",specialColumn:"",row:"",rowButtons:"",cell:"",specialCell:"",pager:"",buttons:"",dynamicPager:"",summary:"",summaryCell:""},actions:{add:!0,edit:!0,remove:!0,details:!0,allowMore:!1,enableXlsExport:!1,enablePdfExport:!1},mode:"execution"},_init:function(){var t=this,i=t.options,n=t.element;t.page=1,t.changes={},t.totalRows=0,t.totalPages=0,t.data=i.data,t.selectedRow=0,t.components={},t.buttons={},t.asyncCells={},t.scrollableArea=i.scrollableArea||t,t.columnByIndex={},t.columnByName={},t.columnKeyIndex=0,e.each(i.columns,(function(e,i){i.key=void 0!==i.key&&i.key,i.label=void 0!==i.label?i.label:i.name,i.sortType="asc",i.tooltip=void 0!==i.tooltip?i.tooltip:"",t.columnByIndex[i.index]=i,t.columnByName[i.name]=i,i.key&&(t.columnKeyIndex=i.index)})),i.sortBy=i.sortBy||t.columnByIndex[0].name,t.columnByName[i.sortBy]?t.columnByName[i.sortBy].sortType=i.sortType:t.columnByName[i.sortBy.split(".")[0]]&&(t.columnByName[i.sortBy.split(".")[0]].sortType=i.sortType),n.addClass("ui-bizagi-grid-wrapper"),n.attr("data-bizagi-id",i.id),t.calculateKeyIndex(),t.collapseState=i.collapseState,t.startLoading(!1)},startLoading:function(t){var i=this;if(t=void 0===t||t,"execution"===i.options.mode&&void 0!==i.options.sortBy){var n=function(){var t=i.element,n=i.options;i.waitingTimeout=null,t.append(e.fasttmpl(n.template.waiting))};t?i.waitingTimeout=setTimeout(n,250):n()}},endLoading:function(){var e=this.element;this.waitingTimeout&&(clearTimeout(this.waitingTimeout),this.waitingTimeout=null),e.empty()},setData:function(e){this.data=e,this.calculateKeyIndex(),this.refresh()},getData:function(){return this.data},calculateKeyIndex:function(){var t=this.options.columns,i=this.data;indexedData={},i.rows&&e.each(i.rows,(function(i,n){var a;e.each(t,(function(e,t){t.key&&(a=n[e])})),indexedData[a]=n})),this.indexedData=indexedData},getChanges:function(){},refresh:function(){this._cleanComponents(),this._cleanButtons(),this.components={},this.draw()},refreshSummary:function(e){var t=this.options,i=this._getComponent("summary");this.drawing||i&&t.showSummary&&(e?this.refreshSummaryCell(e):(i.empty(),i.append(this.drawSummary()),this.postRenderSummary(i)))},refreshSummaryCell:function(t){this.options;var i=this._getComponent("summary"),n=function(t,i){var n=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();return e(n[i])},a=n(i,t),s=this.columnByIndex[t];if(!s.key){var o=this.drawSummaryCell(s);a.replaceWith(o),a=n(i,t),this.onCellReady(s,"summary",a,!1)}},changeCellValue:function(e,t,i){this.indexedData[e]&&(this.indexedData[e][t]=i)},deleteCellExclusiveValues:function(t){var i=this;i.indexedData&&e.each(i.indexedData,(function(e){i.indexedData[e][t]=!1}))},draw:function(){var t=this.options,i=this.element;if(this.drawing=!0,this.endLoading(),"rtl"===t.orientation)var n=e.fasttmpl(t.template.gridRtl,{label:t.title,buttonsPst:t.buttonsPst,collapse:t.collapse,collapseState:this.collapseState,isDesign:"design"===t.mode});else n=e.fasttmpl(t.template.grid,{label:t.title,buttonsPst:t.buttonsPst,collapse:t.collapse,collapseState:this.collapseState,isDesign:"design"===t.mode});if(n=this.drawTable(n),this.grid=e(n).appendTo(i),this.postRender(this.grid),"design"!==t.mode&&(this.attachPaginator(),this.attachHandlers()),"execution"===t.mode&&t.floatingHeader){var a=this._getComponent("table"),s=e("table",a),o=parseInt(e(this.scrollableArea).css("padding-top").replace(/[^\d.]/g,""))||0;s.stickyTableHeaders({fixedOffset:o>0?o-1:o,scrollableArea:this.scrollableArea,zIndex:1e3,cacheHeaderHeight:!0}),a.bind("scroll",(function(){s.trigger("resize.stickyTableHeaders")}))}0===this.data.rows.length?(this._getComponent("table").hide(),this._getComponent("pager").hide(),this._getButton("remove").hide(),this._getButton("edit").hide(),this._getComponent("dynamicPager").hide(),this._getComponent("emptyTable").show()):(this._getComponent("table").show(),this._getButton("remove").show(),this._getButton("edit").show(),this._getComponent("emptyTable").hide(),t.actions.allowMore?(this._getComponent("dynamicPager").show(),this._getComponent("pager").hide()):(this._getComponent("pager").show(),this._getComponent("dynamicPager").hide()),t.actions.edit&&this._getButton("edit").show(),t.actions.enableXlsExport||t.actions.enablePdfExport?this._getButton("show-grid-export-options").show():this._getButton("show-grid-export-options").css("display","none")),this.drawing=!1},attachPaginator:function(){},drawTable:function(t){var i=this.options,n=e.fasttmpl(i.template.table,{showSummary:i.showSummary,tableCssClass:i.tableCssClass,orientation:i.orientation}),a=e.fasttmpl(i.template.emptyTable);return n=this._replaceElement(n,"columns",this.drawHeader()),n=this._replaceElement(n,"rows",this.drawBody()),i.showSummary&&(n=this._replaceElement(n,"summary",this.drawSummary())),t=this._replaceElement(t,"pager",this.drawPager()),t=this._replaceElement(t,"buttons",this.drawButtons()),t=this._replaceElement(t,"gridExportOptions",this.drawGridExportOptions()),t=this._replaceElement(t,"rowButtons",this.drawRowButtons()),t=this._replaceElement(t,"dynamicPager",this.drawDynamicPager()),t=this._replaceElement(t,"table",n),t=this._replaceElement(t,"emptyTable",a)},isExactMatch:function(){for(var e=this.options.columns,t=this.options.sortBy,i=0,n=e.length;i<n;)if(t==e[i++].name)return!0;return!1},drawHeader:function(){var t=this,i=t.options,n="";return t.exactMatch=t.isExactMatch(),e.each(i.columns,(function(e,i){t.options.maxColumns>0?e<=t.options.maxColumns&&(n+=t.drawColumn(i)):n+=t.drawColumn(i)})),t.options.maxColumns>0&&t._canShowButtons()&&(n+=t.drawSpecialColumn()),n},drawColumn:function(t){var i=this.options,n=t.bizAgiProperties||{},a=n.cssclass?n.cssclass:"",s=i.headerStyles?i.headerStyles.header:"";s+=(""!==s?"; text-align:":"text-align:")+(n.columntitlealign?n.columntitlealign:"center");var o=n.columntitlealign?n.columntitlealign:"center",r=i.isSortable&&n.isSortable&&void 0!==n.xpath,l=i.sortBy.split(".")[0],u=!1;r&&(t.name===i.sortBy||t.name===l&&!this.exactMatch)&&(u=!0);var c=bizagi.util.getColumnType(n.type),d="radio"===c&&n.horizontal;return e.fasttmpl(i.template.column,e.extend({},t,{isKey:t.key,sortActive:u,sortType:i.sortOrder,isSortable:r,tooltip:t.tooltip||"",columnCssClass:a,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:s,controlType:c,isHorizontalRadio:d,columnAlign:o,flexAlign:bizagi.util.mapAlignClassName(o)}))},drawSpecialColumn:function(){var t=this.options;return e.fasttmpl(t.template.specialColumn)},drawDynamicPager:function(){var t=this.options;return e.fasttmpl(t.template.dynamicPager)},drawBody:function(){var t=this,i="";return e.each(t.data.rows,(function(e,n){i+=t.drawRow(n)})),i},drawRow:function(t,i){var n=this,a=n.options,s=t[n.columnKeyIndex],o=i||!1,r=Math.floor(1e4*Math.random()),l=e.fasttmpl(a.template.row,{key:r,isNewRow:i,businessKey:s}),u="";return e.each(t,(function(e,t){n.options.maxColumns>0?e<n.options.maxColumns+1&&(u+=n.drawCell(e,s,t,o)):u+=n.drawCell(e,s,t,o)})),n.options.maxColumns>0&&n._canShowRowButtons()&&(u+=n.drawSpecialCell(n.options.maxColumns+1)),l=n._replaceElement(l,"cells",u)},drawSummary:function(){var t=this,i=t.options,n=e.fasttmpl(i.template.summary),a="";return e.each(i.columns,(function(e,i){t.options.maxColumns>0?e<=t.options.maxColumns&&(a+=t.drawSummaryCell(i)):a+=t.drawSummaryCell(i)})),n=t._replaceElement(n,"summary-cells",a)},drawSummaryCell:function(t){var i=this.options,n=t.bizAgiProperties||{},a=n.columnAlign?n.columnAlign:"center",s=e.fasttmpl(i.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy,cellAlign:a}),o=this.onDrawCell(t,"summary",this.calculateSummary(t),!1);return(o=null!=o&&"number"!=typeof o?o.replace("summaryValue",this.calculateSummary(t)):o)||(o=""),"object"===_typeof(o)&&o.done?"resolved"===o.state()?s=this._replaceElement(s,"cellContent",this.resolveResult(o)):(s=this._replaceElement(s,"cellContent",""),this.asyncCells[key+"-"+columnIndex]=o):s=this._replaceElement(s,"cellContent",o),s},drawCell:function(t,i,n,a){var s=this.options;a=a||!1;var o="";if(!this.columnByIndex[t])return"";t>0&&(o=this.columnByIndex[t].bizAgiProperties&&this.columnByIndex[t].bizAgiProperties.messageValidation);var r=this.columnByIndex[t].bizAgiProperties||{},l=r.cssclass?r.cssclass:"",u=r.columnAlign?r.columnAlign:"center",c=bizagi.util.getColumnType(r.type),d="radio"===c&&r.horizontal,p=e.fasttmpl(s.template.cell,{isKey:this.columnByIndex[t].key,hidden:s.columns[t].hidden||!1,isDesign:"design"===s.mode,messageValidation:o,columnCssClass:l,id:s.columns[t].bizAgiProperties?s.columns[t].bizAgiProperties.id:void 0,cellAlign:u,flexAlign:bizagi.util.mapAlignClassName(u),controlType:c,isHorizontalRadio:d}),m=this.onDrawCell(this.columnByIndex[t],i,n,a);return m||(m=""),"object"===_typeof(m)&&m.done?"resolved"===m.state()?p=this._replaceElement(p,"cellContent",this.resolveResult(m)):(p=this._replaceElement(p,"cellContent",""),this.asyncCells[i+"-"+t]=m):p=this._replaceElement(p,"cellContent",m),this.columnByIndex[t].cell=e(p),p},resolveResult:function(e){var t;return e.done((function(e){t=e})),t},drawSpecialCell:function(t){var i=this.options;return e.fasttmpl(i.template.specialCell)},drawGroupHeader:function(){},drawFooter:function(){},drawPager:function(){for(var t=this.options,i=[],n=1;n<=this.data.total;n++)i.push({number:n,active:n==this.data.page});return e.fasttmpl(t.template.pager,{page:this.data.page,pages:i,records:this.data.records})},drawButtons:function(){var t=this.options,i=t.tooltips||{},n=e.extend(t.actions,i);return this._canShowButtons()?"rtl"===t.orientation?e.fasttmpl(t.template.buttonsRtl,n):e.fasttmpl(t.template.buttons,n):""},drawGridExportOptions:function(){var t=this.options,i=t.actions,n=t.tooltips||{},a=e.extend({orientation:t.orientation,enableXlsExport:i.enableXlsExport,enablePdfExport:i.enablePdfExport},n);return e.fasttmpl(t.template.exportOptions,a)},drawRowButtons:function(){var t=this.options;return this._canShowRowButtons()?"rtl"===t.orientation?e.fasttmpl(t.template.rowButtons.rtl,t.actions):e.fasttmpl(t.template.rowButtons,t.actions):""},postRender:function(){var t=this,i=t.options,n=t._getComponent("cells");if(n&&e.each(n,(function(i,n){n=e(n),t.postRenderRow(n)})),i.showSummary){var a=t._getComponent("summary");t.postRenderSummary(a)}t._triggerHandler("gridControlReady")},postRenderRow:function(t){var i=this,n=t.attr("data-business-key"),a=t.attr("data-new-row"),s=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();e.each(s,(function(t,s){var o=i.columnByIndex[t];if(void 0!==o&&!o.key){var r=i.asyncCells[n+"-"+o.index];r?e.when(r).done((function(t){(s=e(s)).append(t),i.onCellReady(o,n,s,a)})):i.onCellReady(o,n,e(s),a)}}))},postRenderSummary:function(t){var i=this,n=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();e.each(n,(function(t,n){var a=i.columnByIndex[t];if(!a.key){var s=i.asyncCells[key+"-"+a.index];s?e.when(s).done((function(t){(n=e(n)).append(t),i.onCellReady(a,"summary",n,!1)})):i.onCellReady(a,"summary",e(n),!1)}}))},attachHandlers:function(){},selectDynamicPager:function(){this.onDynamicPager()},changePage:function(e){var t=Number(this.data.page),i=this.data.total,n=e;if("previous"===e){if(!(t>1))return;n=t-1}if("next"===e){if(!(t<i))return;n=t+1}this._cleanComponents(),this.page=Number(n),this.onPageRequested()},getCurrentPage:function(){return(this.data||{}).page||1},isValid:function(){return this._triggerHandler("isValid")},sortBy:function(e,t){var i=this.options,n=this.columnByIndex[e];if(void 0===i.sortBy)return!0;void 0===n.name&&(n.name=n.label),t=n.name==i.sortBy?t||("asc"==i.sortOrder?"desc":"asc"):n.name==i.sortBy.split(".")[0]?t||("asc"==i.sortType?"desc":"asc"):t||i.sortType,i.sortBy.split(".").length>1?(i.sortBy.split(".")[0],n.name,i.sortBy=n.name):i.sortBy=n.name,void 0!==n.bizAgiProperties.sortAttribute&&-1!==n.bizAgiProperties.type.indexOf("column")&&(i.sortBy=n.name+"."+n.bizAgiProperties.sortAttribute),i.sortColumn=n,i.sortType=t,i.sortOrder=t,this._cleanComponents(),this.onSortRequested()},selectRow:function(e,t){this.selectedRow==e?(this.onRowUnselected(),this.selectedRow=0,this.selectedBusinessKey=0):(0!=this.selectedRow&&this.onRowUnselected(),this.selectedRow=e,this.selectedBusinessKey=t,this.onRowSelected())},unselectRow:function(){0!=this.selectedRow&&(this.onRowUnselected(),this.selectedRow=0,this.selectedBusinessKey=0)},calculateSummary:function(t){var n=this,a=t.summarizeBy;e.each(n.data.rows,(function(e,i){void 0!==n.data.rows[e][t.index]&&null==n.data.rows[e][t.index]&&null!=t.bizAgiProperties.defaultvalue&&(n.data.rows[e][t.index]=t.bizAgiProperties.defaultvalue)}));var s,o=e.map(n.data.rows,(function(e,i){return e[t.index]}));if(0==o.length)return 0;if("sum"===a)s=0,e.each(o,(function(e,t){null!=t&&(s+=Number(t))}));else if("min"===a)s=o[0]||0,e.each(o,(function(e,t){"number"==typeof t&&null!=t&&t<s&&(s=Number(t))})),s===Math.max()&&(s=null);else if("max"===a)s=o[0]||0,e.each(o,(function(e,t){"number"==typeof t&&null!=t&&t>s&&(s=Number(t))})),s===Math.min()&&(s=null);else if("avg"===a)s=0,e.each(o,(function(e,t){null!=t&&(s+=Number(t))})),s/=o.length;else if("count"===a)for(s=0,o=n.data.rows,i=0;i<o.length;i++){var r=o[i][t.index];r instanceof Array&&r.length>0?s+=1:r instanceof Array||null===r||""===r||(s+=1)}return s},processAction:function(e,t){var i=t&&t.key?t.key:this.selectedBusinessKey;"edit"===e&&this.onEditRow(i),"remove"===e&&this.onDeleteRow(i),"more"===e&&this.onShowMore(i),"details"===e&&this.onShowDetails(i),"add"===e&&this.onAddRow(),"show-grid-export-options"===e&&this.onShowExportGridOptions()},onPageRequested:function(){return this.startLoading(),this._triggerHandler("pageRequested",this._buildRefreshParameters())},onSortRequested:function(){return this.startLoading(),this._triggerHandler("sortRequested",this._buildRefreshParameters())},onRowSelected:function(){return this._triggerHandler("rowSelected",{key:this.selectedBusinessKey})},onRowUnselected:function(){return this._triggerHandler("rowUnselected",{key:this.selectedBusinessKey})},onCollapseGrid:function(){return this._triggerHandler("performCollapseGrid")},onDynamicPager:function(){return this._triggerHandler("moreRows",{key:this.selectedBusinessKey})},onDrawCell:function(e,t,i,n){return this._triggerHandler("drawCell",{column:e,key:t,value:i,isNewRow:n})},onCellReady:function(e,t,i,n){return this._triggerHandler("cellReady",{column:e,key:t,cell:i,isNewRow:n})},onDrawControl:function(){},onDrawGroupHeader:function(){},onAddRow:function(){return this._triggerHandler("addRow")},onEditRow:function(e){return this._triggerHandler("editRow",{key:e})},onDeleteRow:function(e){return this._triggerHandler("deleteRow",{key:e})},onShowMore:function(e){return this._triggerHandler("showMore",{key:e})},onShowDetails:function(e){return this._triggerHandler("showFormDetails",{key:e})},onShowExportGridOptions:function(){return this._triggerHandler("showGridExportOptions")},_replaceElement:function(e,t,i){return e.replaceFirstWithoutPatterns("{{element "+t+"}}",i)},_buildRefreshParameters:function(){var e=this.options,t=null!=e.sortColumn?e.sortColumn.index:1;return{page:this.page,sortBy:e.sortBy,sortType:e.sortOrder,sortColumnIndex:t}},_triggerHandler:function(e,t){var i=this.options[e];return i?i.call(this.element[0],t):null},_getComponent:function(t){var i=this.element;if(!this.components[t]){var n=e("[data-bizagi-component="+t+"]",i);null!=n&&n.length>0&&(this.components[t]=n)}return this.components[t]},_getButton:function(t){var i=this.element;return this.buttons[t]||(this.buttons[t]=e("[data-action="+t+"]",i)),this.buttons[t]},_cleanComponents:function(){this.components={}},_cleanButtons:function(){this.buttons={}},_canShowButtons:function(){return!0},_canShowRowButtons:function(){return!0}})}(jQuery),function(e){e.widget("ui.bizagi_grid_desktop",e.ui.bizagi_grid,{options:e.extend(e.ui.bizagi_grid.prototype.options,{smartPagination:!1}),attachHandlers:function(){var t=this;if(t._getComponent("pager").find("ul li:not(.prev):not(.next)").bind("click",(function(i){if(!i.isPropagationStopped()){i.stopPropagation();var n=e(this).data("page");t.isValid()&&t.changePage(n)}})),t._getComponent("dynamicPager").find("input").bind("click",(function(){t.selectDynamicPager()})),t._getComponent("header").on("click",(function(){e(this).hasClass("bz-rn-grid-header-collapse")&&"execution"===t.options.mode&&t.onCollapseGrid()})),t._getComponent("columns").find(".ui-bizagi-grid-column.ui-bizagi-sortable-column").bind("click",(function(){var i,n=e(this).attr("data-column-index");try{i=!!(n>=0&&t.columnByIndex[n].bizAgiProperties.xpath)&&t.columnByIndex[n].bizAgiProperties.xpath}catch(e){return}(void 0===bizagi.context.isOfflineForm||!bizagi.context.isOfflineForm&&i)&&(t.onSaveAddedRows(),t.sortBy(n),e(this).unbind("click"),t.onCancelEdition())})),t._getComponent("rows").find("tr").bind("click",(function(){var i=e(this).attr("data-key"),n=e(this).attr("data-business-key");t.selectRow(i,n)})).bind("dblclick",(function(){var i=e(this).attr("data-key"),n=e(this).attr("data-business-key");t._triggerHandler("rowdblclick",{key:i,businessKey:n})})),t._getComponent("buttons").find("[data-action]").bind("click",(function(){t.processAction(e(this).attr("data-action")),t.unselectRow()})),t.options.actions.enableXlsExport||t.options.actions.enablePdfExport){var i="rtl"==t.options.orientation?".ui-bizagi-grid-export-options-content-rtl":".ui-bizagi-grid-export-options-content",n=t._getComponent("gridExportOptions").find(i);t._getComponent("gridExportOptions").find("[data-action]").bind("click",(function(){t.processAction(e(this).attr("data-action")),t.unselectRow()})),t._getComponent("gridExportOptions").mouseleave((function(){n.addClass("hidden")})),t.options.actions.enableXlsExport&&t._getComponent("gridExportOptions").find("#print-grid-xls").click((function(e){t._triggerHandler("performExportGrid",{disposition:"attachment",exportType:"xlsExport"}),n.hide()})),t.options.actions.enablePdfExport&&t._getComponent("gridExportOptions").find("#print-grid-pdf").click((function(e){t._triggerHandler("performExportGrid",{disposition:"inline",exportType:"pdfExport"}),n.hide()}))}t._getComponent("rows").on("delete-row","tr[data-new-row='true']",(function(i){var n=e(this).attr("data-key"),a=e(this).attr("data-business-key");t._deleteDraft(n,a)}));var a=t._getComponent("columns").find("th > div[title!='']");a&&a.length&&a.tooltip()},_canShowButtons:function(){var e=this.options.actions;return e.add||e.remove||e.edit||e.inlineAdd||e.details||e.enablePdfExport||e.enableXlsExport},processAction:function(t){e.ui.bizagi_grid.prototype.processAction.apply(this,arguments),"save"==t&&this.onSaveAddedRows(),"cancel"==t&&this.onCancelEdition()},attachPaginator:function(){if(this.options.smartPagination)if(this.data.total>1){var e=this._getComponent("pager").find("ul");e.bizagiGridPagination({maxElemShow:50,totalPages:this.data.total,actualPage:this.data.page,listElement:e,scrolledHover:!0})}else this._getComponent("pager").parent().hide();else this.data.total<=1&&this._getComponent("pager").parent().hide()},drawPager:function(){var t=this,i=t.options,n={};if(t.options.smartPagination){var a=10;if(n.pagination=t.data.total>1,n.page=t.data.page,"rtl"==t.options.orientation&&t.data.rows.length>0){n.pages={};for(var s=r=a>t.data.total?t.data.total:a,o=1;o<=r;o++)n.pages[o]={pageNumber:s},s--}else{n.pages={};var r=a>t.data.total?t.data.total:a;for(o=1;o<=r;o++)n.pages[o]={pageNumber:o}}return n.gridPagination="gridCasePagination",n.previousPage=t.data.page>1?t.data.page-1:1,n.nextPage=t.data.page<t.data.total?t.data.page+1:t.data.total,n.totalPages=t.data.total,e.fasttmpl(i.template.pager,n)}return e.ui.bizagi_grid.prototype.drawPager.apply(t,arguments)},addInlineRow:function(){this._triggerHandler("beforeInlineAdd");var t=this.drawRow(this.createAddRowData(),!0),i=e(t);this.postRenderRow(i),this._getComponent("rows").append(i);var n=this._getComponent("buttons");n.find("[data-action=save]").css("display","inline-block"),n.find("[data-action=cancel]").css("display","inline-block"),n.find("[data-action=remove]").css("display","none"),0==this.data.rows.length&&(this._getComponent("table").show(),this._getComponent("emptyTable").hide()),this._triggerHandler("afterInlineAdd")},createAddRowData:function(){var t=this,i=t.options,n=[];return e.each(i.columns,(function(e){if(e==t.columnKeyIndex){var i=Math.ceil(1e5*Math.random());n.push(i)}else n.push(null)})),n},onAddRow:function(){if(this.options.actions.add)return this.options.actions.inlineAdd?this.addInlineRow():(this.options.addFormDialog=this.options.addFormDialog||{},this._triggerHandler("addRow",this.options.addFormDialog))},onCancelEdition:function(){var e=this._getComponent("rows").find("[data-new-row]");e.detach();var t=this._getComponent("buttons");return t.find("[data-action=save]").hide(),t.find("[data-action=cancel]").hide(),0==this.data.rows.length?(this._getComponent("table").hide(),this._getComponent("emptyTable").show()):t.find("[data-action=remove]").css("display","inline-block"),this._triggerHandler("cancelEdition",{keys:this.getNewRowKeys(e)})},onSaveAddedRows:function(){var e=this.getNewRowKeys(),t=this._getComponent("buttons");return e.length>=1&&this.isValid()?(t.find("[data-action=save]").hide(),t.find("[data-action=cancel]").hide(),t.find("[data-action=remove]").css("display","inline-block"),!(void 0===bizagi.context.isOfflineForm||!bizagi.context.isOfflineForm)||(this._triggerHandler("saveAddedRows",{keys:e}),this._triggerHandler("removeNewRecords",{keys:e}))):void 0},onRowSelected:function(){e.ui.bizagi_grid.prototype.onRowSelected.apply(this,arguments);var t=this.element.find("[data-bizagi-component=rows] tr[data-key="+this.selectedRow+"]");t.addClass("ui-bizagi-state-selected")},onRowUnselected:function(){e.ui.bizagi_grid.prototype.onRowUnselected.apply(this,arguments);var t=this._getComponent("rows").find("tr[data-key="+this.selectedRow+"]");t.removeClass("ui-bizagi-state-selected")},getNewRowKeys:function(t){return t=t||this._getComponent("rows").find("[data-new-row=true]"),e.map(t,(function(t,i){return e(t).data("business-key")}))},onCollapseGrid:function(){e.ui.bizagi_grid.prototype.onCollapseGrid.apply(this,arguments)},getCell:function(t,i,n){var a=this._getComponent("rows").find("[data-business-key="+t+"]"),s=e("td:visible",e(a))[n];return e(s)},getCellHeader:function(t){var i=this._getComponent("columns"),n=e("td:visible",e(i))[t];return e(n)},isNewRecord:function(t){var i=this._getComponent("rows");if(i){t=i.find("[data-business-key='"+t+"']");if(e(t).data("new-row"))return!0}return!1},updateCollapseState:function(e){this.collapseState=e},_deleteDraft:function(e,t){this.getNewRowKeys().length>1?(this.getDraftRow(t).detach(),this.changes&&this.changes[e]&&delete this.changes[e],this.newRecords&&this.newRecords[e]&&delete this.newRecords[e],this._triggerHandler("removeNewRecords",{keys:[t]})):this.onCancelEdition()},getDraftRow:function(t){var i=this._getComponent("rows").find("[data-business-key="+t+"]");return e(i)}})}(jQuery),function(e){e.widget("ui.bizagi_grid_grouped_desktop",e.ui.bizagi_grid_desktop,{options:e.extend(e.ui.bizagi_grid.prototype.options,{smartPagination:!1}),drawBody:function(){var t=this;return t.groupByValues={},t.groupByPreviousValues={},t.rowsGroupData={},t.summaryGroup=0,t.rows="",e.each(t.data.rows,(function(e,i){t.isNewGroup(i)&&(t.isNewSummarygroup()&&t.drawSummaryRows(i),t.rows+=t.drawGroupingRows(i,!1)),t.addRowGroupData(i),t.rows+=t.drawRow(i)})),t.groupByValues={},e.each(t.data.rows,(function(e,i){t.drawGroupingRows(i,!0)})),t.rows},drawTable:function(t){var i=this.options,n=e.fasttmpl(i.template.table,{showSummary:i.showSummary,tableCssClass:i.tableCssClass,groupByColumns:i.groupByColumns||[]}),a=e.fasttmpl(i.template.emptyTable);return n=this._replaceElement(n,"columns",this.drawHeader()),n=this._replaceElement(n,"rows",this.drawBody()),i.showSummary&&(n=this._replaceElement(n,"summary",this.drawSummary())),t=this._replaceElement(t,"pager",this.drawPager()),t=this._replaceElement(t,"buttons",this.drawButtons()),t=this._replaceElement(t,"gridExportOptions",this.drawGridExportOptions()),t=this._replaceElement(t,"rowButtons",this.drawRowButtons()),t=this._replaceElement(t,"dynamicPager",this.drawDynamicPager()),t=this._replaceElement(t,"table",n),t=this._replaceElement(t,"emptyTable",a)},drawColumn:function(t){var i=this.options,n=t.bizAgiProperties||{},a=n.cssclass?n.cssclass:"",s=i.headerStyles?i.headerStyles.header:"";s+=(""!==s?"; text-align:":"text-align:")+(n.columntitlealign?n.columntitlealign:"center");var o=i.isSortable&&n.isSortable&&void 0!==n.xpath;return this.showColumn(t)?e.fasttmpl(i.template.column,e.extend({},t,{isKey:t.key,sortActive:t.name==i.sortBy?t.name==i.sortBy:t.name==i.sortBy.split(".")[0]&&!this.exactMatch&&t.name==i.sortBy.split(".")[0],sortType:i.sortOrder,columnCssClass:a,isSortable:o,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:s})):""},drawRow:function(t,i){var n=this,a=n.options,s=t[n.columnKeyIndex],o=a.groupByColumns?a.groupByColumns.length:0,r=i||!1,l=Math.floor(1e4*Math.random()),u=e.fasttmpl(a.template.row,{key:l,isNewRow:i,businessKey:s});u=n._replaceElement(u,"empty-cells",n.drawEmptyCells({cells:o,conectorV:!0}));var c="",d=!1;return e.each(t,(function(e,t){d||(n.options.maxColumns>0?e<n.options.maxColumns+1?c+=n.drawCell(e,s,t,r):(c+=n.drawSpecialCell(e,s,t),d=!0):c+=n.drawCell(e,s,t,r))})),u=n._replaceElement(u,"cells",c)},drawCell:function(e,t,i,n){return this.showColumn(this.columnByIndex[e])?this._super(e,t,i,n):""},drawGroupingRows:function(e,t){var i=this.getGroupLevels(e),n="";t&&this.setGroupByValues(e);for(var a=0,s=i.length;a<s;a++){var o=i[a];n+=this.drawGroupRow(o.deep,s-a,o.position,e,t)}return t||this.setGroupByValues(e),n},isNewGroup:function(e){return 0!=this.options.groupByColumns.length&&!this.areIdenticalValues(e)},isNewSummarygroup:function(){return!!this.options.showSummary&&!this.areIdenticalValues(this.groupByPreviousValues)},setGroupByValues:function(e){var t=this.options.groupByColumns;this.groupByPreviousValues=bizagi.clone(this.groupByValues);for(var i=0,n=t.length;i<n;i++){var a=t[i];this.groupByValues[a]=this.getColumnValue(e[a])}},areIdenticalValues:function(e){for(var t=!0,i=this.options.groupByColumns,n=0,a=i.length;n<a;n++){var s=i[n];t&=this.groupByValues[s]===this.getColumnValue(e[s])}return t},getGroupLevels:function(e){for(var t=[],i=!1,n=this.options.groupByColumns,a=0,s=n.length;a<s;a++){var o=n[a];(i||this.groupByValues[o]!=this.getColumnValue(e[o]))&&(t.push({deep:a,position:o}),i=!0)}return t},showColumn:function(e){return void 0===e.bizAgiProperties||e.bizAgiProperties.showColumn},getValidColumns:function(){var t=this,i=t.options;return t.validColumns=t.validColumns||[],0==t.validColumns.length&&(t.validColumns=e.grep(i.columns,(function(e){return t.showColumn(e)}))),t.validColumns},drawGroupRow:function(t,i,n,a,s){var o,r,l=this,u=l.options,c="";if(realColumnsData=l.options.columns.filter((function(e){var t=!!e.bizAgiProperties&&e.bizAgiProperties.showColumn;return 0!==e.index&&t})),s)r=l.getRowsGroupData(t),e.each(realColumnsData,(function(e,t){t.summarizeBy&&(c=l.calculateSummaryGroup(t,r),"count"!==t.summarizeBy&&(c=l.getFormatedValue(t,c)),l.rows=l._replaceElement(l.rows,"cellContent",c))}));else{var d=e.fasttmpl(u.template.headerRow,{columnTitle:l.getColumnTitle(a,n),colspan:i+1,columns:realColumnsData,level:t});o=l._replaceElement(d,"empty-cells",l.drawEmptyCells({cells:t,conectorV:!0}))}return o},drawEmptyCells:function(t){var i=this.options;(t=t||{}).cells=t.cells||0;for(var n="",a=0;a<t.cells;a++)n+=e.fasttmpl(i.template.emptyCell,{conectorV:i.showSummary&&t.conectorV,conectorCorner:i.showSummary&&t.conectorCorner,conectorH:i.showSummary&&t.conectorH});return n},getColumnTitle:function(e,t){var i=this.options,n=this.getFormatedValue(i.columns[t],this.getColumnValue(e[t])),a=this.getColumnName(t),s=i.columns[t]&&i.columns[t].bizAgiProperties.displayTypeHeader;return"label"==s?a:"value"==s?n:"reversed"==s?n+": "+a:a+": "+n},getFormatedValue:function(t,i){var n,a={};if(t)switch((n=t.bizAgiProperties).type){case"columnMoney":var s=bizagi.localization.getResource("numericFormat");n.allowDecimals=n.allowDecimals?n.numDecimals?n.numDecimals:"undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0,n.numDecimals=n.allowDecimals?n.numDecimals?n.numDecimals:"undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0,a.positiveFormat=s.positiveFormat,a.negativeFormat=s.negativeFormat,a.decimalSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:s.decimalSymbol,a.digitGroupSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:s.digitGroupSymbol,a.groupDigits=!0,a.colorize=!1,a.roundToDecimalPlace=n.numDecimals,a.symbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:s.symbol,(o=e("<label/>").html(i)).formatCurrency(a),i=o.text();break;case"columnBoolean":i=1==bizagi.util.parseBoolean(i)?bizagi.localization.getResource("render-boolean-yes"):0==bizagi.util.parseBoolean(i)?bizagi.localization.getResource("render-boolean-no"):"";break;case"columnSearch":i=i?i.value?i.value:i.label?i.label:"":"";break;case"columnNumber":s=bizagi.localization.getResource("numericFormat");n.allowDecimals=n.allowDecimals?n.numDecimals?n.numDecimals:"undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0,n.numDecimals=n.allowDecimals?n.numDecimals?n.numDecimals:"undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0,a.positiveFormat=s.positiveFormat,a.negativeFormat=s.negativeFormat,a.decimalSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:s.decimalSymbol,a.digitGroupSymbol="undefined"!=typeof BIZAGI_DEFAULT_CURRENCY_INFO?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:s.digitGroupSymbol,a.groupDigits=!0,a.colorize=!1,a.symbol="",a.roundToDecimalPlace=n.numDecimals;var o=e("<label/>").html(i);6!=n.dataType&&8!=n.dataType&&10!=n.dataType&&11!=n.dataType||o.formatCurrency(a),i=o.text(),t.bizAgiProperties.percentage&&(i+="%");break;case"columnDate":if(i){var r,l=bizagi.localization.getResource("dateFormat"),u=bizagi.localization.getResource("timeFormat");if(n.dateFormat=n.dateFormat||l,n.timeFormat=n.timeFormat||u,n.fullFormat=n.dateFormat,void 0!==n.timePickerFormat)r=bizagi.util.dateFormatter.getDateFromInvariant(i,!0);else if(n.showTime){-1===n.fullFormat.search(/[h|H]+/gi)&&(n.fullFormat=n.fullFormat+" "+n.timeFormat),"string"==typeof i?i.length=="MM/dd/yyyy H:mm:ss".length||i.length=="MM/dd/yyyy H:mm:ss".length+1?r=bizagi.util.dateFormatter.getDateFromInvariant(i,!0):(r=bizagi.util.dateFormatter.getDateFromInvariant(i)).setHours(0,0,0,0):r=bizagi.util.dateFormatter.getDateFromInvariant(i,!0)}else r=bizagi.util.dateFormatter.getDateFromInvariant(i);i=bizagi.util.dateFormatter.formatDate(r,n.fullFormat,self.i18n)}}return i},getColumnName:function(e){return this.options.columns[e].bizAgiProperties.displayName},getColumnValue:function(e){return"object"==_typeof(e)&&null!=e?0==e.length?"":2==e.length?this.getColumnValue(e[1]):"object"==_typeof(e[0])?this.getColumnValue(e[0]):e:e},getColSpan:function(e){for(var t=this.options,i=t.columns.length-1,n=0,a=t.columns.length;n<a;n++){var s=t.columns[n];this.showColumn(s)||(i-=1)}return i+e},addRowGroupData:function(e){var t=this.rowsGroupData,i=this.groupByValues;for(var n in i){var a=i[n];t[a]=t[a]||{},t=t[a]}t.data=t.data||[],t.data.push(e)},getRowsGroupData:function(e){var t=this.rowsGroupData,i=0,n=this.groupByValues;for(var a in n){if(t=t[n[a]],i==e)break;i++}return t.data?t.data:this.getNestedRows(t)},getNestedRows:function(e,t){for(var i in t=t||[],e)t=e[i].data?t.concat(e[i].data):this.getNestedRows(e[i],t);return t},drawSummaryRows:function(e){for(var t=this.getGroupLevels(e),i="",n=t.length;n>0;n--){var a=t[n-1];i+=this.drawSummaryRow(a.deep)}return i},drawSummaryRow:function(t){for(var i,n=this,a=n.options,s=a.groupByColumns?a.groupByColumns.length:0,o=n.getRowsGroupData(t),r=e.fasttmpl(a.template.summary,{level:t}),l="",u=!1,c=0;c<s;c++)i=c==t,l+=n.drawEmptyCells({cells:1,conectorCorner:i,conectorH:u,conectorV:!u&&!i}),c==t&&(u=!0);return r=n._replaceElement(r,"empty-cells",l),l="",e.each(a.columns,(function(e,t){l+=n.drawSummaryGroupCell(t,o)})),r=n._replaceElement(r,"summary-cells",l)},drawSummary:function(){var t=this,i=t.options,n=i.groupByColumns?i.groupByColumns.length:0,a=e.fasttmpl(i.template.summary);a=t._replaceElement(a,"empty-cells",t.drawEmptyCells({cells:n}));var s="";return e.each(i.columns,(function(e,i){t.options.maxColumns>0?e<=t.options.maxColumns&&(s+=t.drawSummaryCell(i)):s+=t.drawSummaryCell(i)})),a=t._replaceElement(a,"summary-cells",s)},drawSummaryCell:function(t){var i=this.options;if(!this.showColumn(t))return"";var n=e.fasttmpl(i.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy}),a=this.onDrawCell(t,"summary",this.calculateSummary(t),!1);return(a=null!=a&&"number"!=typeof a?a.replace("summaryValue",this.calculateSummary(t)):a)||(a=""),"object"===_typeof(a)&&a.done?"resolved"===a.state()?n=this._replaceElement(n,"cellContent",this.resolveResult(a)):(n=this._replaceElement(n,"cellContent",""),this.asyncCells[key+"-"+columnIndex]=a):n=this._replaceElement(n,"cellContent",a),n},drawSummaryGroupCell:function(t,i){var n=this.options,a="summary "+this.summaryGroup++;if(!this.showColumn(t))return"";var s=e.fasttmpl(n.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy,summary:a}),o=this.onDrawCell(t,a,this.calculateSummaryGroup(t,i),!1);return(o=null!=o&&"number"!=typeof o?o.replace("summaryValue",this.calculateSummaryGroup(t,i)):o)||(o=""),"object"===_typeof(o)&&o.done?"resolved"===o.state()?s=this._replaceElement(s,"cellContent",this.resolveResult(o)):(s=this._replaceElement(s,"cellContent",""),this.asyncCells[key+"-"+columnIndex]=o):s=this._replaceElement(s,"cellContent",o),s},calculateSummaryGroup:function(t,i){var n=t.summarizeBy;i=i||[],e.each(i,(function(e,n){void 0!==i[e][t.index]&&null==i[e][t.index]&&null!=t.bizAgiProperties.defaultvalue&&(i[e][t.index]=t.bizAgiProperties.defaultvalue)}));var a,s=e.map(i,(function(e,i){return e[t.index]}));if(0==s.length)return 0;if("sum"==n)a=0,e.each(s,(function(e,t){null!=t&&(a+=Number(t))}));else if("min"==n)a=s[0]||0,e.each(s,(function(e,t){"number"==typeof t&&null!=t&&t<a&&(a=Number(t))})),a===Math.max()&&(a=null);else if("max"==n)a=s[0]||0,e.each(s,(function(e,t){"number"==typeof t&&null!=t&&t>a&&(a=Number(t))})),a===Math.min()&&(a=null);else if("avg"==n)a=0,e.each(s,(function(e,t){null!=t&&(a+=Number(t))})),a/=s.length;else if("count"==n){a=0,s=i;for(var o=0;o<s.length;o++){var r=s[o][t.index];r instanceof Array&&r.length>0?a+=1:r instanceof Array||null==r||(a+=1)}}return a},postRenderRow:function(t){var i=this,n=i.getValidColumns(),a=t.attr("data-business-key"),s=t.attr("data-new-row"),o=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();o=o.not(".ui-bizagi-grid-ignore"),e.each(o,(function(t,o){var r=n[t];if(!r.key){var l=i.asyncCells[a+"-"+r.index];l?e.when(l).done((function(t){(o=e(o)).append(t),i.onCellReady(r,a,o,s)})):i.onCellReady(r,a,e(o),s)}}))},postRender:function(){var t=this,i=t.options;if(t._super(),i.showSummary){var n=t._getComponent("grouped-summary-cells");n&&e.each(n,(function(i,n){n=e(n),t.postRenderGroupedSummary(n)}))}},postRenderGroupedSummary:function(t){var i=this,n=i.getValidColumns(),a=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children().not(".ui-bizagi-grid-ignore"):[];e.each(a,(function(t,a){var s=n[t];if(!s.key){var o=e(a).attr("data-grouped-summary-key");if(o){var r=i.asyncCells[o+"-"+s.index];r?e.when(r).done((function(t){(a=e(a)).append(t),i.onCellReady(s,o,a,!1)})):i.onCellReady(s,o,e(a),!1)}}}))},postRenderSummary:function(t){var i=this,n=i.getValidColumns(),a=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children():t.find("[data-bizagi-component=grouped-summary-cells]").children();a=a.not(".ui-bizagi-grid-ignore"),e.each(a,(function(t,a){var s=n[t];if(!s.key){var o=i.asyncCells[key+"-"+s.index];o?e.when(o).done((function(t){(a=e(a)).append(t),i.onCellReady(s,"summary",a,!1)})):i.onCellReady(s,"summary",e(a),!1)}}))},attachHandlers:function(){this._super(),this._getComponent("rows").find(".ui-bizagi-grid-grouped-header").bind("click",(function(){var t=e(this).attr("data-grouped-level"),i=e(this).data("grouped-visibility"),n=e(this).nextUntil("[data-grouped-level = '"+t+"']").filter((function(){var i=!0,n=e(this).attr("data-grouped-level"),a=e(this).attr("data-summary-grouped-level");return n&&parseInt(n)<t&&(i=!1),a&&parseInt(a)<t&&(i=!1),i}));e(this).data("grouped-visibility",!i),i?(e(".ui-icon",this).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),e(".ui-icon",n).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),e(n).hide()):(e(".ui-icon",this).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),e(".ui-icon",n).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),e(n).show())}))}})}(jQuery),function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.4"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function _newInst($input,opts){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(e){inlineSettings[attrName]=attrValue}}for(i in overrides={beforeShow:function(e,t){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst)},onChangeMonthYear:function(e,t,i){tp_inst._updateDateTime(i),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,i,tp_inst)},onClose:function(e,t){!0===tp_inst.timeDefined&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}},overrides)overrides.hasOwnProperty(i)&&(fns[i]=opts[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,opts,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,(function(e){return e.toUpperCase()})),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,(function(e){return e.toUpperCase()})),tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:"")+(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:"")),"string"==typeof tp_inst._defaults.controlType?("slider"===tp_inst._defaults.controlType&&void 0===$.ui.slider&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;var timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];null!==tp_inst._defaults.timezoneList&&(timezoneList=tp_inst._defaults.timezoneList);var tzl=timezoneList.length,tzi=0,tzv=null;if(tzl>0&&"object"!==_typeof(timezoneList[0]))for(;tzi<tzl;tzi++)tzv=timezoneList[tzi],timezoneList[tzi]={value:tzv,label:$.timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)};return tp_inst._defaults.timezoneList=timezoneList,tp_inst.timezone=null!==tp_inst._defaults.timezone?$.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):-1*(new Date).getTimezoneOffset(),tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec,tp_inst.ampm="",tp_inst.$input=$input,tp_inst._defaults.altField&&(tp_inst.$altInput=$(tp_inst._defaults.altField).css({cursor:"pointer"}).focus((function(){$input.trigger("focus")}))),0!==tp_inst._defaults.minDate&&0!==tp_inst._defaults.minDateTime||(tp_inst._defaults.minDate=new Date),0!==tp_inst._defaults.maxDate&&0!==tp_inst._defaults.maxDateTime||(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",(function(){tp_inst._onFocus()})),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var i=$.datepicker._get(this.inst,"dateFormat");try{var n=parseDateTimeInternal(i,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!n.timeObj)return!1;$.extend(this,n.timeObj)}catch(t){return $.timepicker.log("Error parsing the date/time string: "+t+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+i),!1}return!0}var a=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return!!a&&($.extend(this,a),!0)},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,i=this,n="",a="",s=null,o={},r={},l=null,u=0,c=0;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){var d=' style="display:none;"',p='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(t.showTime?"":d)+">"+t.timeText+'</dt><dd class="ui_tpicker_time"'+(t.showTime?"":d)+"></dd>";for(u=0,c=this.units.length;u<c;u++){if(s=null!==t["show"+(a=(n=this.units[u]).substr(0,1).toUpperCase()+n.substr(1))]?t["show"+a]:this.support[n],o[n]=parseInt(t[n+"Max"]-(t[n+"Max"]-t[n+"Min"])%t["step"+a],10),r[n]=0,p+='<dt class="ui_tpicker_'+n+'_label"'+(s?"":d)+">"+t[n+"Text"]+'</dt><dd class="ui_tpicker_'+n+'"><div class="ui_tpicker_'+n+'_slider"'+(s?"":d)+"></div>",s&&t[n+"Grid"]>0){if(p+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"===n)for(var m=t[n+"Min"];m<=o[n];m+=parseInt(t[n+"Grid"],10)){r[n]++;var h=$.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:m},t);p+='<td data-for="'+n+'">'+h+"</td>"}else for(var f=t[n+"Min"];f<=o[n];f+=parseInt(t[n+"Grid"],10))r[n]++,p+='<td data-for="'+n+'">'+(f<10?"0":"")+f+"</td>";p+="</tr></table></div>"}p+="</dd>"}var g=null!==t.showTimezone?t.showTimezone:this.support.timezone;p+='<dt class="ui_tpicker_timezone_label"'+(g?"":d)+">"+t.timezoneText+"</dt>",p+='<dd class="ui_tpicker_timezone" '+(g?"":d)+"></dd>";var b=$(p+="</dl></div>");for(!0===t.timeOnly&&(b.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),u=0,c=i.units.length;u<c;u++)s=null!==t["show"+(a=(n=i.units[u]).substr(0,1).toUpperCase()+n.substr(1))]?t["show"+a]:this.support[n],i[n+"_slider"]=i.control.create(i,b.find(".ui_tpicker_"+n+"_slider"),n,i[n],t[n+"Min"],o[n],t["step"+a]),s&&t[n+"Grid"]>0&&(l=100*r[n]*t[n+"Grid"]/(o[n]-t[n+"Min"]),b.find(".ui_tpicker_"+n+" table").css({width:l+"%",marginLeft:t.isRTL?"0":l/(-2*r[n])+"%",marginRight:t.isRTL?l/(-2*r[n])+"%":"0",borderCollapse:"collapse"}).find("td").click((function(e){var t=$(this),a=t.html(),s=parseInt(a.replace(/[^0-9]/g),10),o=a.replace(/[^apm]/gi),r=t.data("for");"hour"===r&&(-1!==o.indexOf("p")&&s<12?s+=12:-1!==o.indexOf("a")&&12===s&&(s=0)),i.control.value(i,i[r+"_slider"],n,s),i._onTimeChange(),i._onSelectHandler()})).css({cursor:"pointer",width:100/r[n]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=b.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,(function(e,t){return $("<option />").val("object"===_typeof(e)?e.value:e).text("object"===_typeof(e)?e.label:e)}))),void 0!==this.timezone&&null!==this.timezone&&""!==this.timezone)-1*new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()===this.timezone?selectLocalTimezone(i):this.timezone_select.val(this.timezone);else void 0!==this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.timezone):selectLocalTimezone(i);this.timezone_select.change((function(){i._onTimeChange(),i._onSelectHandler()}));var v=e.find(".ui-datepicker-buttonpane");if(v.length?v.before(b):e.append(b),this.$timeObj=b.find(".ui_tpicker_time"),null!==this.inst){var _=this.timeDefined;this._onTimeChange(),this.timeDefined=_}if(this._defaults.addSliderAccess){var y=this._defaults.sliderAccessArgs,w=this._defaults.isRTL;y.isRTL=w,setTimeout((function(){if(0===b.find(".ui-slider-access").length){b.find(".ui-slider:visible").sliderAccess(y);var e=b.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&b.find("table:visible").each((function(){var t=$(this),i=t.outerWidth(),n=t.css(w?"marginRight":"marginLeft").toString().replace("%",""),a=i-e,s=n*a/i+"%",o={width:a,marginRight:0,marginLeft:0};o[w?"marginRight":"marginLeft"]=s,t.css(o)}))}}),10)}i._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(e,t){var i=this._defaults,n=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&n){var a=$.datepicker._get(e,"minDateTime"),s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);null!==this.hourMinOriginal&&null!==this.minuteMinOriginal&&null!==this.secondMinOriginal&&null!==this.millisecMinOriginal&&null!==this.microsecMinOriginal||(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin,this.microsecMinOriginal=i.microsecMin),e.settings.timeOnly||s.getTime()===n.getTime()?(this._defaults.hourMin=a.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=a.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=a.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=a.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=a.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&n){var o=$.datepicker._get(e,"maxDateTime"),r=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);null!==this.hourMaxOriginal&&null!==this.minuteMaxOriginal&&null!==this.secondMaxOriginal&&null!==this.millisecMaxOriginal||(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax,this.microsecMaxOriginal=i.microsecMax),e.settings.timeOnly||r.getTime()===n.getTime()?(this._defaults.hourMax=o.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=o.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=o.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=o.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=o.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)}if(void 0!==t&&!0===t){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),u=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),c=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),d=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),p=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:u}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:c}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:d}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec)),this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:p}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}}},_onTimeChange:function(){if(this._defaults.showTimepicker){var e=!!this.hour_slider&&this.control.value(this,this.hour_slider,"hour"),t=!!this.minute_slider&&this.control.value(this,this.minute_slider,"minute"),i=!!this.second_slider&&this.control.value(this,this.second_slider,"second"),n=!!this.millisec_slider&&this.control.value(this,this.millisec_slider,"millisec"),a=!!this.microsec_slider&&this.control.value(this,this.microsec_slider,"microsec"),s=!!this.timezone_select&&this.timezone_select.val(),o=this._defaults,r=o.pickerTimeFormat||o.timeFormat,l=o.pickerTimeSuffix||o.timeSuffix;"object"===_typeof(e)&&(e=!1),"object"===_typeof(t)&&(t=!1),"object"===_typeof(i)&&(i=!1),"object"===_typeof(n)&&(n=!1),"object"===_typeof(a)&&(a=!1),"object"===_typeof(s)&&(s=!1),!1!==e&&(e=parseInt(e,10)),!1!==t&&(t=parseInt(t,10)),!1!==i&&(i=parseInt(i,10)),!1!==n&&(n=parseInt(n,10)),!1!==a&&(a=parseInt(a,10));var u=o[e<12?"amNames":"pmNames"][0],c=e!==this.hour||t!==this.minute||i!==this.second||n!==this.millisec||a!==this.microsec||this.ampm.length>0&&e<12!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null!==this.timezone&&s!==this.timezone;c&&(!1!==e&&(this.hour=e),!1!==t&&(this.minute=t),!1!==i&&(this.second=i),!1!==n&&(this.millisec=n),!1!==a&&(this.microsec=a),!1!==s&&(this.timezone=s),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),this.support.ampm&&(this.ampm=u),this.formattedTime=$.datepicker.formatTime(o.timeFormat,this,o),this.$timeObj&&(r===o.timeFormat?this.$timeObj.text(this.formattedTime+l):this.$timeObj.text($.datepicker.formatTime(r,this,o)+l)),this.timeDefined=!0,c&&this._updateDateTime()}},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){var t=(e=this.inst||e).currentYear>0?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(e.selectedYear,e.selectedMonth,e.selectedDay),i=$.datepicker._daylightSavingAdjust(t),n=$.datepicker._get(e,"dateFormat"),a=$.datepicker._getFormatConfig(e),s=null!==i&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(n,null===i?new Date:i,a);var o=this.formattedDate;if(""===e.lastVa&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),!0===this._defaults.timeOnly?o=this.formattedTime:!0!==this._defaults.timeOnly&&(this._defaults.alwaysSetTime||s)&&(o+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=o,this._defaults.showTimepicker)if(this.$altInput&&!1===this._defaults.timeOnly&&!0===this._defaults.altFieldTimeOnly)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(o);var r="",l=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,u=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(r=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===i?new Date:i,a):this.formattedDate)&&(r+=l),this._defaults.altTimeFormat?r+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+u:r+=this.formattedTime+u,this.$altInput.val(r)}else this.$input.val(o);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!==e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(e){$.timepicker.log(e)}}},_controls:{slider:{create:function(e,t,i,n,a,s,o){var r=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:r?-1*n:n,min:r?-1*s:a,max:r?-1*a:s,step:o,slide:function(t,n){e.control.value(e,$(this),i,r?-1*n.value:n.value),e._onTimeChange()},stop:function(t,i){e._onSelectHandler()}})},options:function(e,t,i,n,a){if(e._defaults.isRTL){if("string"==typeof n)return"min"===n||"max"===n?void 0!==a?t.slider(n,-1*a):Math.abs(t.slider(n)):t.slider(n);var s=n.min,o=n.max;return n.min=n.max=null,void 0!==s&&(n.max=-1*s),void 0!==o&&(n.min=-1*o),t.slider(n)}return"string"==typeof n&&void 0!==a?t.slider(n,a):t.slider(n)},value:function(e,t,i,n){return e._defaults.isRTL?void 0!==n?t.slider("value",-1*n):Math.abs(t.slider("value")):void 0!==n?t.slider("value",n):t.slider("value")}},select:{create:function(e,t,i,n,a,s,o){for(var r='<select class="ui-timepicker-select" data-unit="'+i+'" data-min="'+a+'" data-max="'+s+'" data-step="'+o+'">',l=e._defaults.pickerTimeFormat||e._defaults.timeFormat,u=a;u<=s;u+=o)r+='<option value="'+u+'"'+(u===n?" selected":"")+">",r+="hour"===i?$.datepicker.formatTime($.trim(l.replace(/[^ht ]/gi,"")),{hour:u},e._defaults):"millisec"===i||"microsec"===i||u>=10?u:"0"+u.toString(),r+="</option>";return r+="</select>",t.children("select").remove(),$(r).appendTo(t).change((function(t){e._onTimeChange(),e._onSelectHandler()})),t},options:function(e,t,i,n,a){var s={},o=t.children("select");if("string"==typeof n){if(void 0===a)return o.data(n);s[n]=a}else s=n;return e.control.create(e,t,o.data("unit"),o.val(),s.min||o.data("min"),s.max||o.data("max"),s.step||o.data("step"))},value:function(e,t,i,n){var a=t.children("select");return void 0!==n?a.val(n):a.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"===_typeof(e)&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each((function(){$.fn.datetimepicker.apply($(this),t)}))},datetimepicker:function(e){var t=arguments;return"string"==typeof(e=e||{})?"getDate"===e?$.fn.datepicker.apply($(this[0]),t):this.each((function(){var e=$(this);e.datepicker.apply(e,t)})):this.each((function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)}))}}),$.datepicker.parseDateTime=function(e,t,i,n,a){var s=parseDateTimeInternal(e,t,i,n,a);if(s.timeObj){var o=s.timeObj;s.date.setHours(o.hour,o.minute,o.second,o.millisec),s.date.setMicroseconds(o.microsec)}return s.date},$.datepicker.parseTime=function(e,t,i){var n=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),a=(e.replace(/\'.*?\'/g,"").indexOf("Z"),function(e,t,i){var n,a="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,(function(e){var t,n,a,s=e.length;switch(e.charAt(0).toLowerCase()){case"h":case"m":case"s":return 1===s?"(\\d?\\d)":"(\\d{"+s+"})";case"l":case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return t=i.amNames,n=i.pmNames,a=[],t&&$.merge(a,t),n&&$.merge(a,n),"("+(a=$.map(a,(function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}))).join("|")+")?";default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,(function(e){return"\\"+e}))+")?"}})).replace(/\s/g,"\\s?")+i.timeSuffix+"$",s=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),i={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(t)for(var n=0;n<t.length;n++)-1===i[t[n].toString().charAt(0)]&&(i[t[n].toString().charAt(0)]=n+1);return i}(e),o="",r={hour:0,minute:0,second:0,millisec:0,microsec:0};return!!(n=t.match(new RegExp(a,"i")))&&(-1!==s.t&&(void 0===n[s.t]||0===n[s.t].length?(o="",r.ampm=""):(o=-1!==$.inArray(n[s.t].toUpperCase(),i.amNames)?"AM":"PM",r.ampm=i["AM"===o?"amNames":"pmNames"][0])),-1!==s.h&&("AM"===o&&"12"===n[s.h]?r.hour=0:"PM"===o&&"12"!==n[s.h]?r.hour=parseInt(n[s.h],10)+12:r.hour=Number(n[s.h])),-1!==s.m&&(r.minute=Number(n[s.m])),-1!==s.s&&(r.second=Number(n[s.s])),-1!==s.l&&(r.millisec=Number(n[s.l])),-1!==s.c&&(r.microsec=Number(n[s.c])),-1!==s.z&&void 0!==n[s.z]&&(r.timezone=$.timepicker.timezoneOffsetNumber(n[s.z])),r)});return"function"==typeof n.parse?n.parse(e,t,n):"loose"===n.parse?function(e,t,i){try{var n=new Date("2012-01-01 "+t);if(isNaN(n.getTime())&&(n=new Date("2012-01-01T"+t),isNaN(n.getTime())&&(n=new Date("01/01/2012 "+t),isNaN(n.getTime()))))throw"Unable to parse time with native Date: "+t;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisec:n.getMilliseconds(),microsec:n.getMicroseconds(),timezone:-1*n.getTimezoneOffset()}}catch(n){try{return a(e,t,i)}catch(i){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1}(e,t,n):a(e,t,n)},$.datepicker.formatTime=function(e,t,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},t);var n=e,a=i.amNames[0],s=parseInt(t.hour,10);return s>11&&(a=i.pmNames[0]),n=n.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,(function(e){switch(e){case"HH":return("0"+s).slice(-2);case"H":return s;case"hh":return("0"+convert24to12(s)).slice(-2);case"h":return convert24to12(s);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"c":return("00"+t.microsec).slice(-3);case"z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!1);case"Z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!0);case"T":return a.charAt(0).toUpperCase();case"TT":return a.toUpperCase();case"t":return a.charAt(0).toLowerCase();case"tt":return a.toLowerCase();default:return e.replace(/'/g,"")}}))},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var i=this._getInst($(e)[0]),n=this._get(i,"timepicker");n?(n._limitMinMaxDateTime(i,!0),i.inline=i.stay_open=!0,this._base_selectDate(e,t),i.inline=i.stay_open=!1,this._notifyChange(i),this._updateDatepicker(i)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!==e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!==t||"boolean"==typeof e.stay_open&&!1!==e.stay_open)){this._base_updateDatepicker(e);var i=this._get(e,"timepicker");i&&i._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&$.datepicker._get(t,"constrainInput")){var n=i.support.ampm,a=null!==i._defaults.showTimezone?i._defaults.showTimezone:i.support.timezone,s=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),o=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,n?"APM":"").replace(/Tt/g,n?"AaPpMm":"").replace(/tT/g,n?"AaPpMm":"").replace(/T/g,n?"AP":"").replace(/tt/g,n?"apm":"").replace(/t/g,n?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(a?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+s,r=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||r<" "||!s||o.indexOf(r)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var i=t._defaults.altField;if(i){t._defaults.altFormat||t._defaults.dateFormat;var n=this._getDate(e),a=$.datepicker._getFormatConfig(e),s="",o=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,r=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,l=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;s+=$.datepicker.formatTime(l,t,t._defaults)+r,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||null===n||(s=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,n,a)+o+s:t.formattedDate+o+s),$(i).val(s)}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!==t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(e){$.timepicker.log(e)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=t.dpDiv;this._base_gotoToday(e);var n=this._get(t,"timepicker");selectLocalTimezone(n);var a=new Date;this._setTime(t,a),$(".ui-datepicker-today",i).click()},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(t.settings.showTimepicker=!1,i._defaults.showTimepicker=!1,i._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(t.settings.showTimepicker=!0,i._defaults.showTimepicker=!0,i._addTimePicker(t),i._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var i=this._get(e,"timepicker");if(i){var n=i._defaults;i.hour=t?t.getHours():n.hour,i.minute=t?t.getMinutes():n.minute,i.second=t?t.getSeconds():n.second,i.millisec=t?t.getMilliseconds():n.millisec,i.microsec=t?t.getMicroseconds():n.microsec,i._limitMinMaxDateTime(e,!0),i._onTimeChange(),i._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,i){var n=this._getInst(e);if(n){var a,s=this._get(n,"timepicker");if(s)this._setDateFromField(n),t&&("string"==typeof t?(s._parseTime(t,i),(a=new Date).setHours(s.hour,s.minute,s.second,s.millisec),a.setMicroseconds(s.microsec)):(a=new Date(t.getTime())).setMicroseconds(t.getMicroseconds()),"Invalid Date"===a.toString()&&(a=void 0),this._setTime(n,a))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var i=this._getInst(e);if(i){"string"==typeof t&&((t=new Date(t)).getTime()||$.timepicker.log("Error creating Date object from string."));var n,a=this._get(i,"timepicker");t instanceof Date?(n=new Date(t.getTime())).setMicroseconds(t.getMicroseconds()):n=t,a&&(a.support.timezone||null!==a._defaults.timezone||(a.timezone=-1*n.getTimezoneOffset()),t=$.timepicker.timezoneAdjust(t,a.timezone),n=$.timepicker.timezoneAdjust(n,a.timezone)),this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,n,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var n=this._get(i,"timepicker");if(n){void 0===i.lastVal&&this._setDateFromField(i,t);var a=this._getDate(i);return a&&n._parseTime($(e).val(),n.timeOnly)&&(a.setHours(n.hour,n.minute,n.second,n.millisec),a.setMicroseconds(n.microsec),null!=n.timezone&&(n.support.timezone||null!==n._defaults.timezone||(n.timezone=-1*a.getTimezoneOffset()),a=$.timepicker.timezoneAdjust(a,n.timezone))),a}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){var n;try{n=this._base_parseDate(e,t,i)}catch(a){if(!(a.indexOf(":")>=0))throw a;n=this._base_parseDate(e,t.substring(0,t.length-(a.length-a.indexOf(":")-2)),i),$.timepicker.log("Error parsing the date string: "+a+"\ndate string = "+t+"\ndate format = "+e)}return n},$.datepicker._getFormatConfig=function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames"),date:{currentDay:e.currentDay,currentMonth:e.currentMonth,currentYear:e.currentYear}}},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,i,n){var a=this._get(e,"timepicker");return a?(a._updateDateTime(e),a.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,i){var n,a=this._getInst(e);if(!a)return null;var s=this._get(a,"timepicker");if(s){var o,r=null,l=null,u=null,c=s._defaults.evnts,d={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)r=i;else if("maxDate"===t||"maxDateTime"===t)l=i;else if("onSelect"===t)u=i;else if(c.hasOwnProperty(t)){if(void 0===i)return c[t];d[t]=i,n={}}}else if("object"===_typeof(t))for(o in t.minDate?r=t.minDate:t.minDateTime?r=t.minDateTime:t.maxDate?l=t.maxDate:t.maxDateTime&&(l=t.maxDateTime),c)c.hasOwnProperty(o)&&t[o]&&(d[o]=t[o]);for(o in d)d.hasOwnProperty(o)&&(c[o]=d[o],n||(n=$.extend({},t)),delete n[o]);if(n&&isEmptyObject(n))return;r?(r=0===r?new Date:new Date(r),s._defaults.minDate=r,s._defaults.minDateTime=r):l?(l=0===l?new Date:new Date(l),s._defaults.maxDate=l,s._defaults.maxDateTime=l):u&&(s._defaults.onSelect=u)}return void 0===i?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,n||t,i)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},extendRemove=function(e,t){for(var i in $.extend(e,t),t)null!==t[i]&&void 0!==t[i]||(e[i]=t[i]);return e},detectSupport=function(e){var t=e.replace(/'.*?'/g,"").toLowerCase(),i=function(e,t){return-1!==e.indexOf(t)};return{hour:i(t,"h"),minute:i(t,"m"),second:i(t,"s"),millisec:i(t,"l"),microsec:i(t,"c"),timezone:i(t,"z"),ampm:i(t,"t")&&i(e,"h"),iso8601:i(e,"Z")}},convert24to12=function(e){return 0===(e%=12)&&(e=12),String(e)},computeEffectiveSetting=function(e,t){return e&&e[t]?e[t]:$.timepicker._defaults[t]},splitDateTime=function(e,t){var i=computeEffectiveSetting(t,"separator"),n=computeEffectiveSetting(t,"timeFormat").split(i).length,a=e.split(i),s=a.length;return s>1?{dateString:a.splice(0,s-n).join(i),timeString:a.splice(0,n).join(i)}:{dateString:e,timeString:""}},parseDateTimeInternal=function(e,t,i,n,a){var s,o,r;if(o=splitDateTime(i,a),s=$.datepicker._base_parseDate(e,o.dateString,n),""===o.timeString)return{date:s};if(!(r=$.datepicker.parseTime(t,o.timeString,a)))throw"Wrong time format";return{date:s,timeObj:r}},selectLocalTimezone=function(e,t){if(e&&e.timezone_select){var i=t||new Date;e.timezone_select.val(-i.getTimezoneOffset())}};$.timepicker=new Timepicker,$.timepicker.timezoneOffsetString=function(e,t){if(isNaN(e)||e>840||e<-720)return e;var i=e%60,n=(e-i)/60,a=t?":":"",s=(e>=0?"+":"-")+("0"+Math.abs(n)).slice(-2)+a+("0"+Math.abs(i)).slice(-2);return"+00:00"===s?"Z":s},$.timepicker.timezoneOffsetNumber=function(e){var t=e.toString().replace(":","");return"Z"===t.toUpperCase()?0:/^(\-|\+)\d{4}$/.test(t)?("-"===t.substr(0,1)?-1:1)*(60*parseInt(t.substr(1,2),10)+parseInt(t.substr(3,2),10)):e},$.timepicker.timezoneAdjust=function(e,t){var i=$.timepicker.timezoneOffsetNumber(t);return isNaN(i)||e.setMinutes(e.getMinutes()+-e.getTimezoneOffset()-i),e},$.timepicker.timeRange=function(e,t,i){return $.timepicker.handleRange("timepicker",e,t,i)},$.timepicker.datetimeRange=function(e,t,i){$.timepicker.handleRange("datetimepicker",e,t,i)},$.timepicker.dateRange=function(e,t,i){$.timepicker.handleRange("datepicker",e,t,i)},$.timepicker.handleRange=function(e,t,i,n){function a(a,s){var o=t[e]("getDate"),r=i[e]("getDate"),l=a[e]("getDate");if(null!==o){var u=new Date(o.getTime()),c=new Date(o.getTime());u.setMilliseconds(u.getMilliseconds()+n.minInterval),c.setMilliseconds(c.getMilliseconds()+n.maxInterval),n.minInterval>0&&u>r?i[e]("setDate",u):n.maxInterval>0&&c<r?i[e]("setDate",c):o>r&&s[e]("setDate",l)}}function s(t,i,a){if(t.val()){var s=t[e].call(t,"getDate");null!==s&&n.minInterval>0&&("minDate"===a&&s.setMilliseconds(s.getMilliseconds()+n.minInterval),"maxDate"===a&&s.setMilliseconds(s.getMilliseconds()-n.minInterval)),s.getTime&&i[e].call(i,"option",a,s)}}return n=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},n),$.fn[e].call(t,$.extend({onClose:function(e,t){a($(this),i)},onSelect:function(e){s($(this),i,"minDate")}},n,n.start)),$.fn[e].call(i,$.extend({onClose:function(e,i){a($(this),t)},onSelect:function(e){s($(this),t,"maxDate")}},n,n.end)),a(t,i),s(t,i,"minDate"),s(i,t,"maxDate"),$([t.get(0),i.get(0)])},$.timepicker.log=function(e){window.console&&window.console.log(e)},$.timepicker._util={_extendRemove:extendRemove,_isEmptyObject:isEmptyObject,_convert24to12:convert24to12,_detectSupport:detectSupport,_selectLocalTimezone:selectLocalTimezone,_computeEffectiveSetting:computeEffectiveSetting,_splitDateTime:splitDateTime,_parseDateTimeInternal:parseDateTimeInternal},Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+Math.floor(e/1e3)),this.microseconds=e%1e3,this}),$.timepicker.version="1.4"}}(jQuery),function(e){e.fn.bizagiUpload=function(t){var i=this,n=this,a=["exe","bat","bash"];t=t||{};var s={renderReference:{},dialogTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onChangeFile:function(){},onCheckMaxSize:function(){var t=s.properties,i=s.renderReference.dialogBox,n=e("input[type=file]",i).get(0)||{};return null!=n.files?n.files.length>0?!(n.files[0].size>t.maxSize)||(l(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",t.maxSize)),!1):(l(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!bizagi.util.isIE()||(!(""===n.value||!n.value)||(l(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1))},onValidate:function(){return!0},dialogTitle:"",height:350,width:500,onUploadFileProcess:function(){},onUploadDialogReady:function(){}};function o(){var t=this,i=(window.document,t.dialogBox=e("<div class='ui-bizagi-component-loading'/>")),o=!1;s.renderReference.getFormContainer&&(o="rtl"==s.renderReference.getFormContainer().properties.orientation),t.isClicked=!1;var c=[];c[0]={text:bizagi.localization.getResource("render-upload-dialog-select"),click:function(o){var c=!1;if(!t.isClicked)if(t.isClicked=!0,s.onCheckMaxSize(s.renderReference)&&function(){var t=s.properties,i=this.dialogBox,n=e("input[type=file]",i).val();if(s.isECM){var o=n.substring(n.lastIndexOf("\\")+1,n.length),r=o.substring(o.lastIndexOf("."),o.length);if(r=r.toLowerCase().replaceAll(".",""),a.indexOf(r)>=0)return l(bizagi.localization.getResource("render-upload-error-extensions")),!1}if(t.validExtensions&&t.validExtensions.length>0){var u=t.validExtensions.replaceAll("*.","").split(";");if(!function(e,t,i){if(0==i&&0==e.length)return!0;for(var n=0;n<t.length;n++){if("*"==t[n].toLowerCase())return!0;if(e.toLowerCase().endsWith(t[n].toLowerCase()))return!0}return!1}(n,u,!0))return l(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1}return!0}()&&s.onValidate(s.renderReference)){if(c=!(s.uploadedFiles>0&&s.maxAllowedFiles>0)||!(s.uploadedFiles>=s.maxfiles),s.isECM){var d=e("input[type=file]",i).val();if(d=d.substring(d.lastIndexOf("\\")+1,d.length),e("[name=Filename]",t.dialobBox).val(d),s.isUpdatingECM){var p="*"+d.substring(d.lastIndexOf("."),d.length);e("[name=fileext]",t.dialobBox).val(p)}}c&&(s.onUploadFileProcess(),e.when(r.call(this)).done((function(e){if(s.isECM){var t=JSON.parse(e);if(s.isUpdatingECM){t.xpath&&(c.xPath=c.xpath),t.idPageCache||(t.idPageCache=s.properties.idPageCache),t.filename=t.fileName;e={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:s.properties.xPath,xpathContext:s.properties.xpathContext};s.onUploadFileCompletedCallback(s.renderReference,e,n,t)}else s.onUploadFileCompletedCallback(s.renderReference,t)}else s.onUploadFileCompletedCallback(s.renderReference,e);s.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(s.alertAfterUpload),"Bizagi","info"),u()})))}else t.isClicked=!1}},c[1]={text:bizagi.localization.getResource("text-cancel"),click:function(){u()}},o&&c.reverse(),s.renderReference.dialogBox=i.dialog({width:s.width,height:s.height,title:s.dialogTitle,modal:!0,draggable:!1,resizable:!1,maximize:!1,buttons:c,close:function(){u()}});var d=e.tmpl(s.dialogTemplate,s.properties,{isIE:s.isIE,timeout:getEstimatedTimeByNetworkSpeed});d.appendTo(i),e("input[type=file]",d).click((function(t){var i=e(this);""!==i.val()&&i.val("")})),e("input[type=file]",d).change((function(e){s.onChangeFile(e.target.files)})),e(".ui-bizagi-loading-message").remove(),s.onUploadDialogReady()}function r(){return!bizagi.util.isIE()||bizagi.util.isIE11()||bizagi.util.isIE10()?function(){var t=e("input[type=file]",dialogBox).get(0)||{},i=(e("form",dialogBox),new e.Deferred),n=e("#file-upload-status .file-upload-statusbar");n.show();var a=new XMLHttpRequest,o=new FormData;o.append(e("input[type=file]",dialogBox).prop("name"),t.files[0]),e("input[type='hidden']",dialogBox).each((function(){o.append(this.name,this.value)}));if(a.upload.addEventListener("progress",(function(t){var i=Math.round(100*t.loaded/t.total),a=i>=99?bizagi.localization.getResource("render-upload-status-waiting"):i+"%";e(".statusbar",n).css("width",i+"%"),e(".statuspercent",n).html(a)}),!1),a.addEventListener("load",(function(e){var t=e.target.responseText;503===e.target.status&&(bizagiConfig&&bizagiConfig.maintenanceWindows&&bizagiConfig.maintenanceWindows.startValidated(e.target,t),t=JSON.stringify({type:"error",message:e.target.statusText,isMaintenanceWindow:!0}));i.resolve(t)}),!1),a.open("POST",s.properties.url),a.setRequestHeader("X-BZXSRF-TOKEN",bizagi.getXSRFToken()),bizagi.util.isWebpartContext()){location.search.match(/sitesEl=([^&]*)/)&&a.setRequestHeader("Authorization",e.ajaxSetup().headers.Authorization)}return a.send(o),i.promise()}():function(){var t=this,i=new e.Deferred,n=s.renderReference.dialogBox,a=e("form",n),o=e("iframe",a),r=e("input[type=file]",n).get(0)||{};if(void 0!==r.files){var l=void 0!==s.properties.networkSpeed?s.properties.networkSpeed:networkSpeed(),c=getEstimatedTimeByNetworkSpeed(r.files?r.files[0].size:666,l),d=e("#estimatedtime",n),p=e("#file-upload-status",n);e("#file-upload-status .file-upload-latency").show(),clearInterval(t.interval),t.interval=window.setInterval((function(){d.html(--c+" s"),c<=0&&(p.html("Still working..."),clearInterval(t.interval))}),1e3)}var m=function t(){try{var n="";(o[0].contentWindow||windoFrameObj)&&(bizagi.util.isIE8()?(iframeContent=e(o[0].contentWindow.document.body),n=iframeContent.text()):(iframeContent=e(o[0].contentWindow.eval("document.body")),n=iframeContent.text())),n.length>0?i.resolve(n):setTimeout(t,50)}catch(e){u(),window.alert(e.toString())}};bizagi.util.isIE()||bizagi.util.isIE11()?(t.dataService||(t.dataService=new bizagi.workportal.services.service),e.when(t.dataService.getCurrentUser("")).done((function(e){m(),a.submit()})).fail((function(e){}))):(m(),a.submit());return i.promise()}()}function l(t){var i=e("#alert-file-upload",this.dialogBox);i.empty(),i.show(),i.html(t)}function u(){this.dialogBox.dialog("destroy"),this.dialogBox.detach(),this.isClicked=!1}return e.extend(s,s,t),i.opt=s,void 0===s.renderReference.enabled&&(s.renderReference.enabled=!0),s.isECM&&s.isUpdatingECM?e(".modal-ecm .ecm-options-upgrade",i).click((function(){s.renderReference.enabled&&(e(".modal-ecm",i).hide(),o())})):i.click((function(){s.renderReference.enabled&&o()})),function(){if(""!=s.properties.validExtensions){var e=s.properties.validExtensions.replaceAll("*","");e=e.replaceAll(";",","),s.properties.processedFileExtension=e}}(),i}}(jQuery),function(e){e.fn.bizagiFileUpload=function(t){var i,n=this,a=this;t=t||{};var s,o={renderReference:{},formTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onUploadFileFailCallback:function(){},onChangeFile:function(){},onCheckMaxSize:function(){var t=o.properties,n=e("input[type=file]",i).get(0)||{};return null!=n.files?n.files.length>0?!(n.files[0].size>t.maxSize)||(r(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",t.maxSize)),!1):(r(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!bizagi.util.isIE()||(!(""===n.value||!n.value)||(r(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1))},height:200,width:500,onUploadFileProcess:function(){},onUploadFormReady:function(){}};function r(t){var n=e("#alert-file-upload",i);n.empty(),n.show(),n.html(t)}return e.extend(o,o,t),n.opt=o,function(){if(""!==o.properties.validExtensions){var e=o.properties.validExtensions.replaceAll("*","");e=e.replaceAll(";",","),o.properties.processedFileExtension=e}}(),s=e.tmpl(o.formTemplate,o.properties,{isIE:o.isIE}),n.width("100%"),n.height("40px"),i=s,n.html(s),e("input[type=file]",s).change((function(e){o.onChangeFile(e.target.files)})),function(){window.document;var t=i;e("#upload-file",t).click((function(n){var s=!1;if(o.onCheckMaxSize(o.renderReference)&&function(){var t=o.properties,n=e("input[type=file]",i).val();if(t.validExtensions&&t.validExtensions.length>0){var a=t.validExtensions.replaceAll("*.","").split(";");if(!function(e,t,i){if(0==i&&0==e.length)return!0;for(var n=0;n<t.length;n++){if("*"==t[n].toLowerCase())return!0;if(e.toLowerCase().endsWith(t[n].toLowerCase()))return!0}return!1}(n,a,!0))return r(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1}return!0}()){if(o.onUploadFileProcess(),s=!(o.uploadedFiles>0&&o.maxAllowedFiles>0&&o.uploadedFiles>=o.maxfiles),o.isECM){var l=e("input[type=file]",t).val();if(l=l.substring(l.lastIndexOf("\\")+1,l.length),e("[name=Filename]",t).val(l),o.isUpdatingECM){var u="*"+l.substring(l.lastIndexOf("."),l.length);e("[name=fileext]",t).val(u)}}s&&e.when(function(){var t=new e.Deferred,n=e("form",i);if(window.FormData){var a=n[0],s=e(a),o=s.attr("action"),r=s.attr("method"),l=new FormData(a);e.ajax({url:o,data:l,type:r,timeout:144e4,contentType:!1,processData:!1,success:function(e){e.length>0?JSON.parse(e).result?t.resolve(e):t.reject(e):t.reject("{}")},error:function(e){t.reject("{}")}})}else{var u=e("iframe",n),c=bizagi.override.delayQuestionFileUpload||1e3;!function i(){try{var n="";u[0].contentWindow&&(n=(bizagi.util.isIE()?e(u[0].contentWindow.document.body):e(u[0].contentWindow.eval("document.body"))).text()),n.length>0?JSON.parse(n).result?t.resolve(n):t.reject(n):setTimeout(i,c)}catch(e){window.alert(e.toString())}}(),n.submit()}return t.promise()}()).done((function(e){if(o.isECM){var t=JSON.parse(e);o.isUpdatingECM?(t.xpath&&(s.xPath=s.xpath),t.idPageCache||(t.idPageCache=o.properties.idPageCache),t.filename=t.fileName,e={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:o.properties.xPath,xpathContext:o.properties.xpathContext},o.onUploadFileCompletedCallback(o.renderReference,e,a,t)):o.onUploadFileCompletedCallback(o.renderReference,t)}else o.onUploadFileCompletedCallback(o.renderReference,e);o.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(o.alertAfterUpload),"Bizagi","info")})).fail((function(e){o.onUploadFileFailCallback(e),o.alerFailtAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(o.alerFailtAfterUpload),"Bizagi","warning")}))}}))}(),e(".ui-bizagi-loading-message").remove(),o.onUploadFormReady(),n}}(jQuery),function($){$.widget("ui.bizagi_filters",{options:{type:1,parent:"",data:{},entity:!1,dataService:null,templates:{filterWrapper:"",filterString:"",filterNumber:"",filterDate:"",filterBoolean:""},operators:{equals:{label:"workportal-widget-filter-operators-equals-to",appliesTo:["Text","Number","Integer","DateTime","Boolean","RelatedEntity","Entity","Currency"],operator:"="},like:{label:"workportal-widget-filter-operators-like",appliesTo:["Text","TextExtended"],operator:"LIKE"},"is-null":{label:"workportal-widget-filter-operators-is-null",appliesTo:["Text","TextExtended","Number","Integer","DateTime","Boolean","Entity","Currency"],isUnary:!0,operator:"IS NULL"},"less-equals-than":{label:"workportal-widget-filter-operators-less-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:"<="},"greater-equals-than":{label:"workportal-widget-filter-operators-greater-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:">="}},change:null},MAX_ENTITY_DATA_LENGTH:1e3,CLASS_ENTITY_FILTER_LOADER:"biz-entity-filter",testPrivateFunction:function(e,t){return this[e].call(this,t)},_create:function(){var e=this;e._on(e.element,{click:function(){e.buildFilter()}})},buildFilter:function(){var e=this,t=e.options.templates;if(e.filterType=e.getFilterType(),$.isFunction(e["build"+e.filterType+"Filter"])){var i=e.$filter=$.tmpl(t.filterWrapper);i.appendTo("body",document),setTimeout((function(){i.click((function(e){e.stopPropagation()})),$(document).one("click",(function(t){0===$(t.target).closest("#ui-datepicker-div").length&&0===$(t.target).closest(".ui-datepicker-header").length&&(i.remove(),"DateTime"===e.filterType&&$("#ui-datepicker-div").remove())}))}),100),e.addOperators(i),e.configureHandlers(i),e["build"+e.filterType+"Filter"](i),i.css(e.getPosition())}},configureHandlers:function(e){var t=this;e.find("#biz-column-filter-buttons").on("click",".biz-column-filter-button",(function(i){var n=$(i.target).closest("button"),a=t.options.data,s=n.data("button");"apply"==s?t.applyFilter(a):"clear"==s&&(t.options.data={},t._trigger("change","",{})),e.remove(),"DateTime"===t.filterType&&$("#ui-datepicker-div").remove()}))},applyFilter:function(e){"is-null"===e.key&&(e.value=void 0),("is-null"===e.key||"is-null"!==e.key&&void 0!==e.value&&null!==e.value)&&this._trigger("change","",e)},addOperators:function(e){var t=this,i=e.find("#biz-column-filter-operators"),n=t.getOperators(),a=t.getInitialValue(n);i.uicombo({data:{combo:n},initValue:a,itemValue:function(e){return e.id},itemText:function(e){return e.displayName},onChange:function(e){if(t.setControlVisibility(e.ui.data("value")),t.update({operator:t.getOperator(e.ui.data("value"))}),t.update({key:e.ui.data("value")}),"is-null"===e.ui.data("value"))t.enableButton("filter");else{var i=t.$filter.find("#biz-column-filter-control input[type=text]");i.length>0&&0===i.val().length&&t.disableButton("filter")}}})},getInitialValue:function(e){var t=this.options.data;if(t)for(var i=0,n=e.length;i<n;i++){var a=e[i];if(a.id==t.key)return this.setControlVisibility(a.id),a}return this.setControlVisibility(e[0].id),this.update({operator:this.getOperator(e[0].id)}),this.update({key:e[0].id}),e[0]},getPosition:function(){var e=this.options.parent,t=e.offset();return{top:t.top+e.height(),left:t.left}},getFilterType:function(){var e=this.options.type;return this.options.entity?"RelatedEntity":15==e||14==e||16==e||21==e||22==e?"Text":23==e?"TextExtended":1==e||2==e||3==e||4==e?this.options.entity?"Entity":"Integer":6==e||7==e||10==e||11==e?"Number":12==e||13==e?"DateTime":5==e||26==e?"Boolean":8==e?"Currency":void 0},validateLimitsNumbersByType:function(e,t){var i,n,a={};switch(e){case 1:n=-1*(i=-9007199254740992);break;case 2:case 7:case 29:n=-1*(i=-2147483647);break;case 3:n=-1*(i=-32767);break;case 4:i=0,n=255;break;case 6:case 8:n=-1*(i=-922337203685477);break;case 10:n=-1*(i=-999999999999999);break;case 11:n=-1*(i=-9999999);break;default:n=-1*(i=-2147483647)}return void 0!==t&&(a.result=t>=i&&t<=n,a.maxValue=n,a.sign=Math.sign(t)),a.message=bizagi.localization.getResource("workportal-widget-filter-validator-between-values").replace("{0}",i).replace("{1}",n),a},buildCurrencyFilter:function buildCurrencyFilter($filter){var self=this,data=self.options.data||{},templates=self.options.templates,$control=$filter.find("#biz-column-filter-control");$control.append($.tmpl(templates.filterNumber,{value:data.value||null,title:self.validateLimitsNumbersByType(self.options.type).message}));var $input=$control.find("input");$input.numeric(bizagi.currentUser.decimalSeparator);var numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));void 0!==bizagi.currentUser.symbol&&(numericFormat.symbol=bizagi.currentUser.symbol),$input.formatCurrency(numericFormat);var collectDataValue=function collectDataValue($input){var value=$input.val(),regexString="/["+numericFormat.symbol+numericFormat.digitGroupSymbol+"]/g",regex=eval(regexString);value=value.replace(regex,"");var auxInput=$("<input>").attr({type:"text",value:value}),validationNumber=self.validateLimitsNumbersByType(self.options.type,auxInput.asNumber());return validationNumber.result||0===value||(value=validationNumber.maxValue*validationNumber.sign,$input.val(value),$input.formatCurrency(numericFormat)),0===value.length&&(value=null),value},updateValue=function(){var e=collectDataValue($input);null!==e&&self.update({value:parseFloat(e.toString().replace(",","."))})};updateValue(),$.proxy(self.configureHandlerInputTypeText($input,$filter,data,updateValue),self)},_entityRequestComboFilter:function(e,t,i,n,a){var s=this,o={idEntity:e,idAttribute:t,displayAttribFilter:a};i.addClass(s.CLASS_ENTITY_FILTER_LOADER).startLoading({delay:0,overlay:!0}),$.when(s.options.dataService.getAdminEntityData(o)).done((function(e){i.removeClass(s.CLASS_ENTITY_FILTER_LOADER).endLoading(),function(e){n.splice(0,n.length),e.map((function(e){n.push(e)}))}(e),i.methods.comboDropDown.call(i)}))},_onChangeBuildEntityFilter:function(e,t,i,n,a){var s=a.ui.data("value"),o=e?parseInt(s):s,r=a.ui.val();i&&!(t.filter((function(e){return e.displayAttrib===r&&e.id===o})).length>0)&&this._entityRequestComboFilter(this.options.entity,this.options.attribute,n,t,r),this.update({value:o})},buildEntityFilter:function(e){var t=this,i=t.options.data,n=t.options.dataService,a=e.find("#biz-column-filter-control");a.startLoading({delay:0,overlay:!0});var s=function(e){if(i&&i.value)for(var n=0,a=e.length;n<a;n++){var s=e[n];if(s.id==i.value)return t.update({value:s.id}),s}var o=e[0].id;return $.isNumeric(e[0].id)&&(o=parseInt(o)),t.update({value:o}),e[0]},o={idEntity:t.options.entity,idAttribute:t.options.attribute,displayAttribFilter:""};$.when(n.getAdminEntityData(o)).done((function(e){var i=e.length,n=t.MAX_ENTITY_DATA_LENGTH<i,o=n;if(e&&i>0){var r=s(e),l=$.isNumeric(e[0].id);a.uicombo({isEditable:o,data:{combo:e},initValue:r,itemValue:function(e){return e.id},itemText:function(e){return e.displayAttrib},onChange:t._onChangeBuildEntityFilter.bind(t,l,e,n,a)})}else a.text("No data"),t.disableButton("filter")})).always((function(){a.endLoading()}))},buildRelatedEntityFilter:function(e){this.buildEntityFilter(e)},buildDateTimeFilter:function(e){var t=this,i=t.options.data||{},n=t.options.templates,a=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase(),s=bizagi.localization.getResource("dateFormat").replace(/\b(y{2})\b/g,"yyyy"),o=e.find("#biz-column-filter-control"),r=bizagi.util.dateFormatter.formatDate(new Date(i.value),s);r=r||void 0,o.append($.tmpl(n.filterDate,{value:r}));if(i.value)try{new Date(i.value),t.enableButton("filter")}catch(e){null,t.disableButton("filter")}else t.disableButton("filter");o.find("input").datepicker({dateFormat:a,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",onSelect:function(e,i){if(e){var n=new Date(i.currentMonth+1+"/"+i.currentDay+"/"+i.currentYear+" 00:00"),a=bizagi.util.dateFormatter.formatDate(n,"MM/dd/yyyy HH:mm");t.update({value:a}),t.enableButton("filter")}}})},buildBooleanFilter:function(e){var t=this,i=t.options.data||{},n=t.options.templates,a=e.find("#biz-column-filter-control");a.append($.tmpl(n.filterBoolean,{value:i.value})),a.optiongroup(),i&&void 0!==i.value&&a.optiongroup("setValue",i.value.toString()),a.on("optiongroupchange",(function(e,i){var n=bizagi.util.parseBoolean(i.value);t.update({value:n})}))},buildIntegerFilter:function buildIntegerFilter($filter){var self=this,data=self.options.data||{},templates=self.options.templates,$control=$filter.find("#biz-column-filter-control");$control.append($.tmpl(templates.filterNumber,self.configureDataToAppend(data)));var $input=$control.find("input");$input.numeric();var numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));$input.formatCurrency($.extend(numericFormat,{symbol:"",decimalDigits:0,roundToDecimalPlace:-1}));var updateValue=function updateValue(){var value=$input.val(),regexString="/["+numericFormat.digitGroupSymbol+"]/g",regex=eval(regexString);value=value.replace(regex,"");var auxInput=$("<input>").attr({type:"text",value:value}),validationNumber=self.validateLimitsNumbersByType(self.options.type,auxInput.asNumber());validationNumber.result||0===value||(value=validationNumber.maxValue*validationNumber.sign,$input.val(value)),0===value.length&&(value=null),self.update({value:parseInt(value,10)})};$.proxy(self.configureHandlerInputTypeText($input,$filter,data,updateValue),self)},configureDataToAppend:function(e){return e={value:e.value||null,title:this.validateLimitsNumbersByType(this.options.type).message}},buildNumberFilter:function buildNumberFilter($filter){var self=this,data=self.options.data||{},templates=self.options.templates,$control=$filter.find("#biz-column-filter-control");$control.append($.tmpl(templates.filterNumber,self.configureDataToAppend(data)));var $input=$control.find("input");$input.numeric(bizagi.currentUser.decimalSeparator);var numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));$input.formatCurrency($.extend(numericFormat,{symbol:""}));var updateValue=function updateValue(){var value=$input.val(),regexString="/["+numericFormat.digitGroupSymbol+"]/g",regex=eval(regexString);value=value.replace(regex,"");var auxInput=$("<input>").attr({type:"text",value:value.replace(",",".")}),validationNumber=self.validateLimitsNumbersByType(self.options.type,auxInput.asNumber());validationNumber.result||0===value||(value=validationNumber.maxValue*validationNumber.sign,$input.val(value)),0===value.length&&(value=null),self.update({value:parseFloat(value.toString().replace(",","."))})};$.proxy(self.configureHandlerInputTypeText($input,$filter,data,updateValue),self)},buildTextFilter:function(e){var t=this,i=t.options.data||{},n=t.options.templates,a=e.find("#biz-column-filter-control");a.append($.tmpl(n.filterString,{value:i.value}));var s=a.find("input");t.configureHandlerInputTypeText(s,e,i,(function(){var e=s.val();0===e.length&&(e=null),t.update({value:e})}))},buildTextExtendedFilter:function(e){this.buildTextFilter(e)},update:function(e){var t=this.options.data;$.extend(t,e)},getOperators:function(){var e=this.options.operators,t=this.filterType,i=[];for(var n in e){var a=e[n];$.inArray(t,a.appliesTo)>=0&&i.push({displayName:bizagi.localization.getResource(a.label),id:n})}return i},getOperator:function(e){return this.options.operators[e].operator},configureHandlerInputTypeText:function(e,t,i,n){var a=this;e.focus(),e.keyup((function(s){e.val().trim().length>0?(a.enableButton("filter"),13==s.which&&(n(),a._trigger("change","",i),t.remove())):a.disableButton("filter")})),e.change((function(){e.val().length>0&&n()})),e.val().trim().length>0?a.enableButton("filter"):a.disableButton("filter")},setControlVisibility:function(e){var t=this.options.operators,i=this.$filter.find("#biz-column-filter-control");t[e]&&(void 0!==t[e].isUnary&&t[e].isUnary?i.hide():i.show())},disableButton:function(e){var t=this.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");"filter"==e?$(t[0]).attr("disabled","disabled").addClass("ui-state-disabled"):"clear"==e&&$(t[1]).attr("disabled","disabled").addClass("ui-state-disabled")},enableButton:function(e){var t=this.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");"filter"==e?$(t[0]).prop("disabled",!1).removeClass("ui-state-disabled"):"clear"==e&&$(t[1]).prop("disabled",!1).removeClass("ui-state-disabled")}})}(jQuery),function(e){var t=0,i=[],n='<div class="bz-overflow-menu-icon">   <div class="bz-overflow-menu-icon bz-btn-icn bz-btn-icn--24">       <svg class="bz-icn" width="16px" height="16px">           <use xlink:href="#{{icon}}"></use>       </svg>   </div>   <span class="bz-overflow-menu__item-text">{{name}}</span></div>';e.fn.overflowMenu=function(r){return this.each((function(){var l=this;l.id=t++;var u=(r=r||{}).items||[],c=null,d=!0===r.positionTop?-1:0;function p(t,i){var n=t.getAttribute("data-overflowmenuitem");u[n]&&u[n].fn(c),e(l.menu).remove(),i.preventDefault(),i.stopPropagation()}l.menu=document.createElement("ul"),l.menu.setAttribute("style","position: fixed; display: block;"),l.menu.className="bz-overflow-menu",l.menu.setAttribute("data-overflowmenu",l.id),u.forEach((function(e,t){var i=document.createElement("li");"name"in e?(i.className="bz-overflow-menu__item",e.icon?i.innerHTML=n.replace(/{{icon}}/g,e.icon).replace(/{{name}}/g,e.name):i.textContent=e.name,i.setAttribute("data-overflowmenuitem",t),i.setAttribute("tabindex",0),i.addEventListener("click",p.bind(this,i))):i.className="bz-overflow-menu__divider",l.menu.appendChild(i)})),e(l).bind("click",(function(t){var n=o(e(t.currentTarget));e(l.menu).css("z-index",n),function(t){c=t.delegateTarget;var n=t.originalEvent.clientX,o=t.originalEvent.clientY;setTimeout((function(){var t=e(l).parent(),r=d*(parseFloat(t.height(),0)/2)||0,u=o,c=n;document.body.appendChild(l.menu),a.H()-o<l.menu.offsetHeight&&(u=o-l.menu.offsetHeight),a.W()-n<l.menu.offsetWidth&&(c=n-l.menu.offsetWidth),l.menu.style.top=u+r+"px",l.menu.style.left=c+"px",e(l.menu).show(),e(l.menu).focus(),i.push(l.menu),e("#content-wrapper",document).on("scroll.overflow",(function(t){s(),e(this,document).off("scroll.overflow")}))}),100)}(t)}))}))};var a={W:function(){return document.documentElement.clientWidth},H:function(){return document.documentElement.clientHeight}},s=function(){i&&i.length>0&&i.forEach((function(t){e(t).remove()})),i=[]},o=function t(i){if(i.get(0)===e("body").get(0))return 2;var n=e(i).parent(),a=parseFloat(n.css("z-index"),-1);return a>-1?a:t(n)};e(document).on("click.overflow",(function(e){s()}))}(jQuery);var bkExtend=function(){var e=arguments;for(var t in 1==e.length&&(e=[this,e[0]]),e[1])e[0][t]=e[1][t];return e[0]};function bkClass(){}bkClass.prototype.construct=function(){},bkClass.extend=function(e){var t=function(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)},i=new this(bkClass);return bkExtend(i,e),t.prototype=i,t.extend=this.extend,t};var bkElement=bkClass.extend({construct:function(e,t){return"string"==typeof e&&(e=(t||document).createElement(e)),e=$BK(e)},appendTo:function(e){return e.appendChild(this),this},appendBefore:function(e){return e.parentNode.insertBefore(this,e),this},addEvent:function(e,t){return bkLib.addEvent(this,e,t),this},setContent:function(e){return this.innerHTML=e,this},pos:function(){var e=curtop=0;obj=this;if(obj.offsetParent)do{e+=obj.offsetLeft,curtop+=obj.offsetTop}while(obj=obj.offsetParent);var t=window.opera?0:parseInt(this.getStyle("border-width")||this.style.border)||0;return[e+t,curtop+t+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(e){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==e)return t;t=t.parentNode}while(t);return!1},hasClass:function(e){return this.className.match(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)"))},addClass:function(e){return this.hasClass(e)||(this.className+=" nicEdit-"+e),this},removeClass:function(e){return this.hasClass(e)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)")," ")),this},setStyle:function(e){var t=this.style;for(var i in e)switch(i){case"float":t.cssFloat=t.styleFloat=e[i];break;case"opacity":t.opacity=e[i],t.filter="alpha(opacity="+Math.round(100*e[i])+")";break;case"className":this.className=e[i];break;default:try{t[i]=e[i]}catch(e){}}return this},getStyle:function(e,t){var i=t||document.defaultView;if(1==this.nodeType)return i&&i.getComputedStyle?i.getComputedStyle(this,null).getPropertyValue(e):this.currentStyle[bkLib.camelize(e)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(e){for(var t in e)this[t]=e[t];return this}}),bkLib={isMSIE:-1!=navigator.appVersion.indexOf("MSIE"),addEvent:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},toArray:function(e){for(var t=e.length,i=new Array(t);t--;)i[t]=e[t];return i},noSelect:function(e){e.setAttribute&&"input"!=e.nodeName.toLowerCase()&&"textarea"!=e.nodeName.toLowerCase()&&e.setAttribute("unselectable","on");for(var t=0;t<e.childNodes.length;t++)bkLib.noSelect(e.childNodes[t])},camelize:function(e){return e.replace(/\-(.)/g,(function(e,t){return t.toUpperCase()}))},inArray:function(e,t){return null!=bkLib.search(e,t)},search:function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return null},cancelEvent:function(e){return(e=e||window.event).preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(e){this.domLoad.push(e),document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }</style><script id=__ie_onload defer "+("https:"==location.protocol?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&bkLib.domLoaded()}),window.onload=bkLib.domLoaded}};function $BK(e){return"string"==typeof e&&(e=document.getElementById(e)),e&&!e.appendTo?bkExtend(e,bkElement.prototype):e}var bkEvent={addEvent:function(e,t){return t&&(this.eventList=this.eventList||{},this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t)),this},fireEvent:function(){var e=bkLib.toArray(arguments),t=e.shift();if(this.eventList&&this.eventList[t])for(var i=0;i<this.eventList[t].length;i++)this.eventList[t][i].apply(this,e)}};function __(e){return e}Function.prototype.closure=function(){var e=this,t=bkLib.toArray(arguments),i=t.shift();return function(){if(void 0!==bkLib)return e.apply(i,t.concat(bkLib.toArray(arguments)))}},Function.prototype.closureListener=function(){var e=this,t=bkLib.toArray(arguments),i=t.shift();return function(n){if((n=n||window.event).target)var a=n.target;else a=n.srcElement;return e.apply(i,[n,a].concat(t))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b"},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i"},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u"},left:{name:__("Left Align"),command:"justifyleft",noActive:!0},center:{name:__("Center Align"),command:"justifycenter",noActive:!0},right:{name:__("Right Align"),command:"justifyright",noActive:!0},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"]},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"]},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"]},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"]},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"}},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},iconsPath:"../nicEditorIcons.gif",buttonList:["save","print","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","bgcolor","smile"],iconList:{bgcolor:1,forecolor:2,bold:3,center:4,hr:5,indent:6,italic:7,justify:8,left:9,ol:10,outdent:11,removeformat:12,right:13,save:24,strikethrough:15,subscript:16,superscript:17,ul:18,underline:19,image:20,link:21,unlink:22,close:23,arrow:25,smile:26,print:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(e,t){this.nicPlugins.push({p:e,o:t})},allTextAreas:function(e){for(var t=document.getElementsByTagName("textarea"),i=0;i<t.length;i++)nicEditors.editors.push(new nicEditor(e).panelInstance(t[i]));return nicEditors.editors},findEditor:function(e){for(var t=nicEditors.editors,i=0;i<t.length;i++)if(t[i].instanceById(e))return t[i].instanceById(e)},getFirstEditor:function(){var e=nicEditors.editors;if(e.length>=1)return e[0].instanceById[0]}},nicEditor=bkClass.extend({construct:function(e){this.options=new nicEditorConfig,bkExtend(this.options,e),this.nicInstances=new Array,this.loadedPlugins=new Array;for(var t=nicEditors.nicPlugins,i=0;i<t.length;i++)this.loadedPlugins.push(new t[i].p(this,t[i].o));nicEditors.editors.push(this),bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(e,t){e=this.checkReplace($BK(e));var i=new bkElement("DIV").setStyle({width:(parseInt(e.getStyle("width"))||e.clientWidth)+"px"}).appendBefore(e);return this.setPanel(i),this.addInstance(e,t)},checkReplace:function(e){var t=nicEditors.findEditor(e);return t&&(t.removeInstance(e),t.removePanel()),e},addInstance:function(e,t){if((e=this.checkReplace($BK(e))).contentEditable||window.opera)var i=new nicEditorInstance(e,t,this);else i=new nicEditorIFrameInstance(e,t,this);return this.nicInstances.push(i),this},removeInstance:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)t[i].e==e&&(t[i].remove(),this.nicInstances.splice(i,1))},removePanel:function(e){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)if(t[i].e==e)return t[i]},setPanel:function(e){return this.nicPanel=new nicEditorPanel($BK(e),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(e,t){this.selectedInstance&&this.selectedInstance.nicCommand(e,t)},getIcon:function(e,t){var i=this.options.iconList[e],n=t.iconFiles?t.iconFiles[e]:"";return{backgroundImage:"url('"+(i?this.options.iconsPath:n)+"')",backgroundPosition:(i?-18*(i-1):0)+"px 0px"}},selectCheck:function(e,t){do{if(t.className&&-1!=t.className.indexOf("nicEdit"))return!1}while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}});nicEditor=nicEditor.extend(bkEvent);var nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(e,t,i){this.ne=i,this.elm=this.e=e,this.options=t||{},newX=parseInt(e.getStyle("width"))||e.clientWidth,newY=parseInt(e.getStyle("height"))||e.clientHeight,this.initialHeight=newY-8;var n="textarea"==e.nodeName.toLowerCase();if(n||this.options.hasPanel){var a=bkLib.isMSIE&&!(void 0!==document.body.style.maxHeight&&"CSS1Compat"==document.compatMode),s={width:newX+"px",border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden",backgroundColor:"#ffffff"};s[a?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(s).appendBefore(e);var o=new bkElement("DIV").setStyle({width:newX-8+"px",margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain);if(e.setStyle({display:"none"}),o.innerHTML=e.innerHTML,n){o.setContent(e.value),this.copyElm=e;var r=e.parentTag("FORM");r&&bkLib.addEvent(r,"submit",this.saveContent.closure(this))}o.setStyle(a?{height:newY+"px"}:{overflow:"hidden"}),this.elm=o}this.ne.addEvent("blur",this.blur.closure(this)),this.init(),this.blur()},init:function(){this.elm.setAttribute("contentEditable","true"),""==this.getContent()&&this.setContent("<br />"),this.instanceDoc=document.defaultView,this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},remove:function(){this.saveContent(),(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel()),this.disable(),this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var e=this.getSel();return e?e.rangeCount>0?e.getRangeAt(0):e.createRange():null},selRng:function(e,t){window.getSelection?(t.removeAllRanges(),t.addRange(e)):e.select()},selElm:function(){var e=this.getRng();if(e.startContainer){var t=e.startContainer;if(1==e.cloneContents().childNodes.length)for(var i=0;i<t.childNodes.length;i++){var n=t.childNodes[i].ownerDocument.createRange();if(n.selectNode(t.childNodes[i]),1!=e.compareBoundaryPoints(Range.START_TO_START,n)&&-1!=e.compareBoundaryPoints(Range.END_TO_END,n))return $BK(t.childNodes[i])}return $BK(t)}return $BK("Control"==this.getSel().type?e.item(0):e.parentElement())},saveRng:function(){this.savedRange=this.getRng(),this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(e,t){e.ctrlKey&&this.ne.fireEvent("key",this,e)},selected:function(e,t){if(t||(t=this.selElm()),!e.ctrlKey){var i=this.ne.selectedInstance;i!=this&&(i&&this.ne.fireEvent("blur",i,t),this.ne.selectedInstance=this,this.ne.fireEvent("focus",i,t)),this.ne.fireEvent("selected",i,t),this.isFocused=!0,this.elm.addClass("selected")}return!1},blur:function(){this.isFocused=!1,this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.elm.innerHTML=this.content},nicCommand:function(e,t){document.execCommand(e,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var e=this.elm.innerHTML.replace(/^\s+|\s+$/g,"");this.elm.innerHTML="",e||(e="<br />"),this.initialContent=e,this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm),this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});for(itm in["font-size","font-family","font-weight","color"])this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var e=$BK(this.elmFrame.contentWindow.document);e.designMode="on",e.open();var t=this.ne.options.externalCSS;e.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'</head><body id="nicEditContent" style="margin: 0 !important; background-color: #ffffff !important;">'+this.initialContent+"</body></html>"),e.close(),this.frameDoc=e,this.frameWin=$BK(this.elmFrame.contentWindow),this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles),this.instanceDoc=this.frameWin.document.defaultView,this.heightUpdate(),this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.frameContent.innerHTML=this.content,this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(e,t){this.frameDoc.execCommand(e,!1,t),setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(e,t,i){this.elm=e,this.options=t,this.ne=i,this.panelButtons=new Array,this.buttonList=bkExtend([],this.ne.options.buttonList),this.panelContain=new bkElement("DIV").setStyle({overflow:"hidden",width:"100%",border:"1px solid #cccccc",backgroundColor:"#efefef"}).addClass("panelContain"),this.panelElm=new bkElement("DIV").setStyle({margin:"2px",marginTop:"0px",zoom:1,overflow:"hidden"}).addClass("panel").appendTo(this.panelContain),this.panelContain.appendTo(e);var n=this.ne.options,a=n.buttons;for(button in a)this.addButton(button,n,!0);this.reorder(),e.noSelect()},addButton:function addButton(buttonName,options,noOrder){var button=options.buttons[buttonName],type=button.type?eval("(typeof("+button.type+') == "undefined") ? null : '+button.type+";"):nicEditorButton,hasButton=bkLib.inArray(this.buttonList,buttonName);type&&(hasButton||this.ne.options.fullPanel)&&(this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne)),hasButton||this.buttonList.push(buttonName))},findButton:function(e){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==e)return this.panelButtons[t]},reorder:function(){for(var e=this.buttonList,t=0;t<e.length;t++){var i=this.findButton(e[t]);i&&this.panelElm.appendChild(i.margin)}},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(e,t,i,n){this.options=i.buttons[t],this.name=t,this.ne=n,this.elm=e,this.margin=new bkElement("DIV").setStyle({float:"left",marginTop:"2px"}).appendTo(e),this.contain=new bkElement("DIV").setStyle({width:"20px",height:"20px"}).addClass("buttonContain").appendTo(this.margin),this.border=new bkElement("DIV").setStyle({backgroundColor:"#efefef",border:"1px solid #efefef"}).appendTo(this.contain),this.button=new bkElement("DIV").setStyle({width:"18px",height:"18px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,i)).appendTo(this.border),this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect(),window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent),n.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this)),this.disable(),this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(e){switch(e){case"hover":var t={border:"1px solid #666",backgroundColor:"#ddd"};break;case"active":t={border:"1px solid #666",backgroundColor:"#ccc"};break;default:t={border:"1px solid #efefef",backgroundColor:"#efefef"}}this.border.setStyle(t).addClass("button-"+e)},checkNodes:function(e){var t=e;do{if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0}while(t=t.parentNode&&"nicEdit"!=t.className);for(t=$BK(e);3==t.nodeType;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1,this.updateState(),this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(e,t){this.isDisabled=!1,this.contain.setStyle({opacity:1}).addClass("buttonEnabled"),this.updateState(),this.checkNodes(t)},disable:function(e,t){this.isDisabled=!0,this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled"),this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1,this.updateState(),this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive()),this.ne.fireEvent("buttonClick",this)},key:function(e,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault&&t.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(e,t){this.options=t,this.ne=e,this.ne.addEvent("panel",this.loadPanel.closure(this)),this.init()},loadPanel:function(e){var t=this.options.buttons;for(var i in t)e.addButton(i,this.options);e.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(e,t,i,n){this.ne=t,this.elm=e,this.pos=e.pos(),this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"}),this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(i).appendTo(this.contain),n&&!n.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",n.removePane.closure(this)).appendTo(this.pane)),this.contain.noSelect().appendTo(document.body),this.position(),this.init()},init:function(){},position:function(){if(this.ne.nicPanel){var e=this.ne.nicPanel.elm,t=e.pos()[0]+parseInt(e.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8);t<this.pos[0]&&this.contain.setStyle({left:t+"px"})}},toggle:function(){this.isVisible=!this.isVisible,this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(e){e.appendTo(this.pane)},setContent:function(e){this.pane.setContent(e)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(e,t){for(itm in this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this)),this.pane.append(this.form),this.inputs={},e){var i=e[itm],n="";t&&(n=t.getAttribute(itm)),n||(n=i.value||"");var a=e[itm].type;if("title"==a)new bkElement("div").setContent(i.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{var s=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);switch(i.txt&&new bkElement("label").setAttributes({for:itm}).setContent(i.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(s),a){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:n,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"1px solid #ccc",overflow:"hidden"}).setStyle(i.style).appendTo(s);break;case"select":for(opt in this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left",margin:"2px 0"}).appendTo(s),i.options)new bkElement("option").setAttributes({value:opt,selected:opt==n?"selected":""}).setContent(i.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(i.style).appendTo(s),this.inputs[itm].value=n}}}new bkElement("input").setAttributes({type:"submit"}).setStyle({backgroundColor:"#efefef",border:"1px solid #ccc",margin:"3px 0",float:"left",clear:"both"}).appendTo(this.form),this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(e,t,i){for(var n=this.ne.selectedInstance.getElm().getElementsByTagName(e),a=0;a<n.length;a++)if(n[a].getAttribute(t)==i)return $BK(n[a])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(e){this.ne=e,e.addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(e){this.timer=setTimeout(this.create.closure(this,e),400)},create:function(e){this.timer=null,this.pane||(this.pane=new nicEditorPane(e.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(e.options.name))},hide:function(e){this.timer&&clearTimeout(this.timer),this.pane&&(this.pane=this.pane.remove())}});nicEditors.registerPlugin(nicButtonTips);var nicSelectOptions={buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}},nicEditorSelect=bkClass.extend({construct:function(e,t,i,n){this.options=i.buttons[t],this.elm=e,this.ne=n,this.name=t,this.selOptions=new Array,this.margin=new bkElement("div").setStyle({float:"left",margin:"2px 1px 0 1px"}).appendTo(this.elm),this.contain=new bkElement("div").setStyle({width:"90px",height:"20px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin),this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"1px solid #ccc",paddingLeft:"3px",backgroundColor:"#fff"}).appendTo(this.contain),this.control=new bkElement("div").setStyle({overflow:"hidden",float:"right",height:"18px",width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow",i)).appendTo(this.items),this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items),window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent),this.margin.noSelect(),this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)),this.disable(),this.init()},disable:function(){this.isDisabled=!0,this.close(),this.contain.setStyle({opacity:.6})},enable:function(e){this.isDisabled=!1,this.close(),this.contain.setStyle({opacity:1})},setDisplay:function(e){this.txt.setContent(e)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"});for(var e=0;e<this.selOptions.length;e++){var t,i=this.selOptions[e],n=new bkElement("div").setStyle((_defineProperty(t={overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left"},"overflow","hidden"),_defineProperty(t,"cursor","pointer"),t)),a=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(i[1]).appendTo(n).noSelect();a.addEvent("click",this.update.closure(this,i[0])).addEvent("mouseover",this.over.closure(this,a)).addEvent("mouseout",this.out.closure(this,a)).setAttributes("id",i[0]),this.pane.append(n),window.opera||(a.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(e){e.setStyle({backgroundColor:"#ccc"})},out:function(e){e.setStyle({backgroundColor:"#fff"})},add:function(e,t){this.selOptions.push(new Array(e,t))},update:function(e){this.ne.nicCommand(this.options.command,e),this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){for(itm in this.setDisplay("Font&nbsp;Size..."),this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){for(itm in this.setDisplay("Font&nbsp;Family..."),this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){for(itm in this.setDisplay("Font&nbsp;Format..."),this.sel){var e=itm.toUpperCase();this.add("<"+e+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"</"+e+">")}}});nicEditors.registerPlugin(nicPlugin,nicSelectOptions);var nicLinkOptions={buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"]},unlink:{name:"Remove Link",command:"unlink",noActive:!0}}},nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A"),this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(e){var t=this.inputs.href.value;if("http://"==t||""==t)return alert("You must enter a URL to Create a Link"),!1;if(this.removePane(),!this.ln){var i="javascript:nicTemp();";this.ne.nicCommand("createlink",i),this.ln=this.findElm("A","href",i)}this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}});nicEditors.registerPlugin(nicPlugin,nicLinkOptions);var nicColorOptions={buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0}}},nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var e={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},t=new bkElement("DIV").setStyle({width:"270px"});for(var i in e)for(var n in e)for(var a in e){var s="#"+e[i]+e[a]+e[n],o=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(t),r=new bkElement("DIV").setStyle({border:"2px solid "+s}).appendTo(o),l=new bkElement("DIV").setStyle({backgroundColor:s,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,s)).addEvent("mouseover",this.on.closure(this,r)).addEvent("mouseout",this.off.closure(this,r,s)).appendTo(r);window.opera||(o.onmousedown=l.onmousedown=bkLib.cancelEvent)}this.pane.append(t.noSelect())},colorSelect:function(e){this.ne.nicCommand("foreColor",e),this.removePane()},on:function(e){e.setStyle({border:"2px solid #000"})},off:function(e,t){e.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(e){this.ne.nicCommand("hiliteColor",e),this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicColorOptions);var nicImageOptions={buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"]}}},nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.addForm({"":{type:"title",txt:"Add/Edit Image"},src:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}}},this.im)},submit:function(e){var t=this.inputs.src.value;if(""==t||"http://"==t)return alert("You must enter a Image URL to insert"),!1;if(this.removePane(),!this.im){var i="javascript:nicImTemp();";this.ne.nicCommand("insertImage",i),this.im=this.findElm("IMG","src",i)}this.im&&this.im.setAttributes({src:this.inputs.src.value,alt:this.inputs.alt.value,align:this.inputs.align.value})}});nicEditors.registerPlugin(nicPlugin,nicImageOptions);var nicSaveOptions={buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}},nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var e=this.ne.options.onSave,t=this.ne.selectedInstance;e(t.getContent(),t.elm.id,t)}});nicEditors.registerPlugin(nicPlugin,nicSaveOptions);var smileOptions={buttons:{smile:{name:"Add Smile",type:"nicEditorSmileButton",noClose:!0,tags:["Sm"]}}},nicEditorSmileButton=nicEditorAdvancedButton.extend({addPane:function(){var e=[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],t=new bkElement("DIV").setStyle({width:"270px"});for(var i in e){var n="ui-smile ui-smile-"+e[i],a='<span class="'+n+'" ></span>',s=new bkElement("DIV").setStyle({cursor:"pointer",height:"17px",width:"17px",float:"left"}).appendTo(t),o=new bkElement("DIV").appendTo(s),r=new bkElement("DIV").setStyle({overflow:"hidden",width:"17px",height:"17px"}).addEvent("click",this.smileSelect.closure(this,n)).addEvent("mouseover",this.on.closure(this,o)).addEvent("mouseout",this.off.closure(this,o)).appendTo(o);r.innerHTML=a,window.opera||(s.onmousedown=r.onmousedown=bkLib.cancelEvent)}this.pane.append(t.noSelect())},smileSelect:function(e){var t,i;if(window.getSelection){if((t=window.getSelection()).getRangeAt&&t.rangeCount){i=t.getRangeAt(0);var n=document.createElement("span");n.setAttribute("class",e),i.insertNode(n)}}else document.selection&&document.selection.createRange&&(i=document.selection.createRange()).pasteHTML('<span class="'+e+'" />');this.removePane()},on:function(e){e.setStyle({border:"1px solid #000"})},off:function(e){e.setStyle({border:"none"})}});nicEditors.registerPlugin(nicPlugin,smileOptions);var nicPrintOptions={buttons:{print:{name:__("Some alt text for the button"),type:"nicEditorPrintButton"}}},nicEditorPrintButton=nicEditorButton.extend({mouseClick:function(){var e=$("<div>");e.append(nicEditors.findEditor("ui-bizagi-rtfeditor").getContent()),$.browser.msie?$(e).printElement({printMode:"popup"}):$(e).printElement()}});function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}nicEditors.registerPlugin(nicPlugin,nicPrintOptions),function(e){e.widget("ui.searchList",{options:{list:[],cases:[],SEARCH_MAX_LENGTH:1},_create:function(){var t=this,i=t.element,n=(t.options.cases,i.find("input[type=text]"));n.autocomplete({source:t._getLabels(),minLength:0,messages:{noResults:null},select:function(i,n){var a=e.map(t.options.list,(function(e){if(e.displayName==n.item.value)return e}));t._prependCases(a[0]),t._eventRemove()},close:function(){n.val("")}}),i.on("click",(function(e){n.focus()})),n.on("keydown",(function(t){if(8==t.keyCode||46==t.keyCode){var n=i.find("li").not(":last").last();if(0==e(this).val().length&&n.hasClass("selected"))n.find("a.closebutton").trigger("click"),e(this).blur().focus();else 0==e(this).val().length&&(e(n).addClass("selected"),e(this).blur().focus())}13==t.keyCode&&t.preventDefault()}))},_getLabels:function(){var t=[];return e.each(this.options.list,(function(e,i){t.push(i.displayName)})),t},_prependCases:function(t){var i=this.element,n=this.options.cases,a=i.find("input[type=text]");e.inArray(t.id,n)<0&&(n.push(t.id),a.parent().before('<li class="selected-case" data-case-value="'+t.id+'"><label>'+t.displayName+'</label><a class="closebutton"></a></li>'))},_eventRemove:function(){var t=this.element,i=this.options.cases;t.find("a.closebutton").off("click").on("click",(function(t){t.preventDefault();var n=e(this).parent().data("case-value");i.splice(e.inArray(n,i),1),e(this).parent().remove()}))}})}(jQuery),function(e){"use strict";e.fn.uitable=function(t,i){var n=this;if(n.config={namespace:e.bizagi.ui.controls.uitable.namespace,cssComponent:e.bizagi.ui.controls.uitable.css,availableComponents:e.bizagi.ui.controls.uitable.availableComponents},n.settings={data:{},asTable:!0,nameTemplate:e.bizagi.ui.controls.uitable.tmpl,rowTemplate:e.bizagi.ui.controls.uitable.tmpl2,cellValue:null,oddClass:null,css:"",getTemplate:function(e){return bizagi.getTemplate(e)},onComplete:function(){},headerClick:function(){}},n.util={clone:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}},n.methods={init:function(t){var i=e(this),a=t.getTemplate(t.nameTemplate),s=t.getTemplate(t.rowTemplate);i.attr("role",t.namespace),i.addClass(t.cssComponent),i.addClass(t.css),e.when(e.get(a),e.get(s)).done((function(a,s){var o=t.data;o=n.methods.recursiveRows.apply(this,[t]);var r=t.cellValue?t.cellValue:n.methods.cellValue,l=e.tmpl(a[0],o,{testValue:r});t.rowTemplate=s[0],i.data("cellValue",r),t.onComplete&&i.data("onComplete",t.onComplete),n.settings.oddClass&&l.find(".biz-wp-table-row:odd").addClass(n.settings.oddClass),i.append(l),n.methods.addHandlers.apply(i,[l])})).fail((function(){e.error("No se pudo cargar el template para generar las tablas")}))},addHandlers:function(t){var i=e(this);t.on("click.table","th",(function(t){n.settings.headerClick(),e.event.trigger({type:"headerClicked",message:"Header is Clicked",time:new Date,ui:e(t.target)})})),n.settings.onComplete.apply(i,[]),e.event.trigger({type:"tableCompleted",message:"Table is Completed",time:new Date,ui:i});var a=e('[role^="component:"]');a.length>0&&n.methods.createComponents.apply(i,[a]),i.data("plg",n)},createComponents:function(t){for(var i=e(this),a=0;a<t.length;a++){var s,o=e(t[a]),r=o.attr("role").toLowerCase().replace("component:","");n.methods.validateComponent(r)?(s=n.settings.data.datasource[o.data("position")]?n.settings.data.datasource[o.data("position")]:i.data().plg.settings.data.datasource[o.data("position")],o[r]({data:s})):e.error("No es un componente valido para tablas")}},recursiveRows:function(e){for(var t=0;t<e.data.rows.length;t++)for(var i=0;i<e.data.rows[t].length;i++)e.data.rows[t][i].indexCol=i,e.data.rows[t][i].indexRow=t;return e.data},cellValue:function(e){var t="";return this.data.datasource||(this.data.datasource=[]),e.cellValue?(t=e.cellValue(e),"object"===_typeof(t)&&t.jquery&&(t=t[0].outerHTML)):"string"==typeof e.value||"number"==typeof e.value?t=e.value:"object"===_typeof(e.value)&&e.value.hasOwnProperty("component")&&(t='<div role="component:'+e.value.component+'" data-position="'+e.indexCol+"-"+e.indexRow+'"></div>',e.value.data?this.data.datasource[e.indexCol+"-"+e.indexRow]=e.value.data:this.data.datasource[e.indexCol+"-"+e.indexRow]={}),t},validateComponent:function(e){for(var t=!1,i=0;i<n.config.availableComponents.length;i++)e===n.config.availableComponents[i]&&(t=!0);return t},addRow:function(t,i){var a=e(this),s=a.data("plg");if(a.attr("role")===s.settings.namespace){var o=parseFloat(i)-1,r=e(".biz-wp-table-body tr:eq( "+o+" )",a),l=i+e('[data-pos^="added-"]',a).length,u=a.data("plg").settings.rowTemplate,c=e("td",r).length;if(c<t.length)t=t.slice(0,c);else if(c>t.length)for(var d=c-t.length,p=0;p<d;p++)t.push({value:""});for(var m=0;m<t.length;m++)t[m].indexCol=m,t[m].indexRow="added-"+l;var h={cols:t,nPosRow:l},f=e.tmpl(u,h,{testValue:a.data("cellValue")?a.data("cellValue"):n.methods.cellValue});e(f).insertAfter(r);var g=a.data("onComplete");for(var b in g.apply(a,[]),h.datasource)s.settings.data.datasource[b+""]=h.datasource[b];var v=e('[role^="component:"]',a);v.length>0&&s.methods.createComponents.apply(a,[v])}},addColumn:function(){},destroy:function(t){var i=e(this);i.attr("role")===i.data().plg.settings.namespace?(i.attr("role",""),i.empty()):e.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},"object"!=_typeof(t)&&t){var a=e(this);if(a.attr("role")===e.bizagi.ui.controls.uitable.namespace){e.extend(n.settings,i,n.config);var s=n.util.clone(arguments);return s=s.slice(1,s.length),n.methods[arguments[0]].apply(this,s)}return!1}if("object"===_typeof(t)||!t||void 0===t)return e.extend(n.settings,t,n.config),this.each((function(){n.methods.init.apply(this,[n.settings])}));e.error("Method "+t+" does not exist on jQuery.table")},e.bizagi.ui.controls.uitable.plugin=e.fn.uitable}(jQuery),function(e){"use strict";e.fn.uicombo=function(t,i){var n=this;return n.config={namespace:e.bizagi.ui.controls.uicombo.namespace,cssComponent:e.bizagi.ui.controls.uicombo.css,internalData:{}},n.settings={data:{},ascombo:!0,disabled:!1,isSearchable:!1,isEditable:!1,nameTemplate:e.bizagi.ui.controls.uicombo.tmpl,nameSubTemplate:e.bizagi.ui.controls.uicombo.tmpl2,initValue:null,itemValue:null,itemText:null,css:"",orientation:"biz-o-left",getTemplate:function(e){return bizagi.getTemplate(e)},initializeTemplates:function(){e.Deferred();var t=this.nameTemplate,i=this.nameSubTemplate;return{combo:bizagi.getTemplate(t),list:bizagi.getTemplate(i)}},onComplete:function(){},onChange:function(){},onComboDropDown:function(){}},n.methods={init:function(t){var i,a=e(this);t.getTemplate(t.nameTemplate),t.getTemplate(t.nameSubTemplate);t.IE=navigator.appName.indexOf("Internet Explorer")>0||(!(!navigator.userAgent.match(/Trident\/7.0/)||navigator.userAgent.match(/MSIE/i))||void 0),a.attr("role",t.namespace),a.addClass(t.cssComponent),a.addClass(t.css),a.loader=new bizagi.ui.controls.tmplloader,e.when(a.loader.loadTemplates(t.initializeTemplates())).done((function(){var s=a.loader.getTemplate("combo"),o=a.loader.getTemplate("list");n.config.internalData=i=t.data,i.isEditable=t.isEditable,i.disabled=t.disabled,n.config.subTemplateHTML=o,t.data.id=Math.guid();var r=e.tmpl(s,t.data,{itemValue:t.itemValue?t.itemValue:n.methods.itemValue,itemText:t.itemText?t.itemText:n.methods.itemText});if(a.append(r),n.config.inputCombo=e(".biz-wp-combo-input",a),r.find(".biz-wp-combo-option").each((function(i,n){t.data.combo[i].data&&e.extend(e(n).data(),t.data.combo[i].data)})),n.settings.onComplete.apply(a,[]),a.methods=n.methods,a.config=n.config,a.settings=n.settings,a.methods.configureHandlers.apply(a,[]),e.event.trigger({type:"comboCompleted",message:"combo is Completed",time:new Date,ui:a}),n.settings.initValue){var l="",u="";u=n.settings.itemText?n.settings.itemText(n.settings.initValue):n.settings.initValue.text,l=n.settings.itemValue?n.settings.itemValue(n.settings.initValue):n.settings.initValue.value,""===u?a.config.inputCombo.val(""):a.config.inputCombo.val(u),n.config.inputCombo.data("value",l)}}))},getControl:function(){return e(".biz-wp-combo",this)},getData:function(){return n.config.internalData},findDataByValue:function(t){if(null!=t){var i="object"===_typeof(t)?t.join(" - "):"boolean"==typeof t?t.toString():t;e.trim(i).substring(0,i.length).toLowerCase(),this.getData()}return-1},configureHandlers:function(){var t=this,i=t.methods.getControl.apply(t,[]);t.config.inputCombo.focus((function(){})),t.config.inputCombo.blur((function(){t.settings.isSearchable&&t.methods.validateValueInDatasource()})),t.config.inputCombo.click((function(){var n="dd-"+t.config.inputCombo.attr("id");0===e("#"+n,i).length?t.methods.comboDropDown.apply(t,[]):t.methods.dropDownDestroy.apply(t,[e(n)]),t.config.inputCombo.select()})),e(".biz-wp-combo-btn",i).bind("click.combo",(function(){t.config.inputCombo.trigger("click").focus()})),t.config.inputCombo.keyup((function(e){t.methods.keyUpFunction.apply(t,[e])})),t.config.inputCombo.keydown((function(e){t.methods.keyDownFunction.apply(t,[e])}))},comboDropDown:function(){var t=this;e.when(t.methods.getData()).done((function(e){t.methods.internalComboDropDown.apply(t,[e]),n.settings.onComboDropDown()}))},internalComboDropDown:function(t){e(".ui-select-dropdown.open").detach();var i,a=this,s={},o=e("<div class='ui-select-dropdown open'></div>"),r=a.config.inputCombo.closest(".biz-wp-combo-data-container"),l=r.closest(".biz-wp-combo"),u="dd-"+a.config.inputCombo.attr("id"),c=a.methods.findDataByValue(a.config.inputCombo.val()),d=0;t=t||a.properties.data,a.repositionInterval;var p=l.css("height"),m=a.methods.getControl.apply(a,[]);l.addClass("ac-is-visible"),l.css("height",p),r.addClass("ac-is-visible ac-clear-floats"),o.attr("id",u),i=e.tmpl(n.config.subTemplateHTML,t,{itemValue:a.settings.itemValue?a.settings.itemValue:a.methods.itemValue,itemText:a.settings.itemText?a.settings.itemText:a.methods.itemText});var h=o.append(i);r.append(h),h.position({my:"left top",at:"left bottom",of:e(".biz-wp-combo-input",m),collision:"none"}).hide(),h.fadeIn(),h.width(m.width()),a.methods.recalculateComboOffset(h,m),h.data("formWidth",r.width()),h.data("parentCombo",m),h.addClass(a.settings.orientation),-1!==c&&((s=e("li[data-value='"+c.id+"']",h)).addClass("ui-selected"),s.addClass("active"),d=parseInt(s.position().top),h.scrollTop(d)),h.on("mouseup","li",(function(t){t.stopPropagation();var i={value:e(this).data("value").toString()?e(this).data("value"):"",text:e(this).text()};a.methods.onComboItemSelected.apply(a,[i]),a.config.inputCombo.focus(),h.fadeOut("slow",(function(){a.methods.dropDownDestroy.apply(a,[h])})),e(document).unbind("click.closecombo")})),e.makeArray(h,a.methods.getControl.apply(a,[])).bind("click",(function(e){return e.preventDefault(),!1})),h.bind("mousedown.closecombo",(function(){h.attr("md",!0)})),e(document).bind("mousedown.resizecombo",(function(t){e(t.target).hasClass("ui-resizable-handle")&&(a.repositionInterval&&clearInterval(a.repositionInterval),a.repositionInterval=setInterval((function(){a.methods.dropDownReposition.apply(a,[h,r])}),10))})),e(document).bind("mouseup.resizecombo",(function(t){clearInterval(a.repositionInterval);var i=e(t.target);h.attr("md")?h.removeAttr("md"):i.hasClass("ui-select-dropdown")||a.methods.dropDownValidClose.apply(a,[i,h])})),e(document).on("mouseup.closecombo",(function(t){var i;i=a.settings.IE&&t.currentTarget.activeElement?t.currentTarget.activeElement:t.target;var n=e(i);h.attr("md")?h.removeAttr("md"):n.hasClass("ui-select-dropdown")||a.methods.dropDownValidClose.apply(a,[n,h])})),e(window).bind("resize.resizecombo",(function(){a.repositionInterval&&clearInterval(a.repositionInterval),a.methods.dropDownReposition.apply(a,[h,r])})),e(document).one("click.closecombo",(function(t){var i=e(t.target);h.attr("md")?h.removeAttr("md"):a.methods.dropDownValidClose.apply(a,[i,h])}))},dropDownValidClose:function(t,i){var n=this;i.fadeOut("slow",(function(){n.methods.dropDownDestroy.apply(n,[i])})),e(document).unbind("click.closecombo")},dropDownReposition:function(t,i){var n=this.methods.getControl.apply(this,[]);i.width()!=t.data("formWidth")&&(t.width(n.width()<100?100:n.width()),t.position({my:"left top",at:"left bottom",of:e(".biz-wp-combo-input",n),collision:"none"}),t.data("formWidth",i.width()))},dropDownDestroy:function(t){var i=this.config.inputCombo.closest(".ui-bizagi-control"),n=i.closest(".ui-bizagi-render");i.hasClass("ac-is-visible")&&i.removeClass("ac-is-visible"),i.hasClass("ac-clear-floats")&&i.removeClass("ac-clear-floats"),n.css("height","auto"),n.hasClass("ac-is-visible")&&n.removeClass("ac-is-visible"),t.remove(),e(document).unbind("mousedown.closecombo"),e(document).unbind("mouseup.resizecombo"),e(window).unbind("resize.resizecombo"),e(window).unbind("mouseup.closecombo"),this.repositionInterval,clearInterval(this.repositionInterval)},validateValueInDatasource:function(){var e=n.config.inputCombo.val(),t=this.findDataByValue(e);this.value||(this.value={id:""}),t.id>0?(this.setValue({id:t.id},!1),this.setDisplayValue(t)):""==t.id?(this.value.id!=t.id&&this.setValue(t,!1),this.setDisplayValue(t)):this.setDisplayValue(this.selectedValue)},keyDownFunction:function(t){var i="dd-"+n.config.inputCombo.attr("id"),a=e("#"+i),s=e("li.active",a);return(t=t||window.event).altKey||t.ctrlKey||t.metaKey?1:(0===a.length&&(this.methods.comboDropDown.apply(this,[]),a=e("#"+i)),t.shiftKey&&t.keyCode?(a.remove(),0):(27==t.keyCode&&(this.methods.setDisplayValue.apply(this,[this.selectedValue]),a.remove()),9==t.keyCode||13==t.keyCode?(s.length>0&&this.config.inputCombo.val(s.text()),this.settings.isSearchable?this.methods.validateValueInDatasource():this.methods.setValue.apply(this,[s.data("value")]),a.remove(),1):"38"==t.keyCode||"37"==t.keyCode?(this.methods.selectPreviousElement.apply(this,[a]),0):"40"==t.keyCode||"39"==t.keyCode?(this.methods.selectNextElement.apply(this,[a]),0):36==t.keyCode?(this.methods.selectFirstElement.apply(this,[a]),0):35==t.keyCode?(this.methods.selectLastElement.apply(this,[a]),0):this.methods.selectFirstPossibleElement.apply(this,[a,n.config.inputCombo.val()+t.key])?0:1))},keyUpFunction:function(t){var i="dd-"+n.config.inputCombo.attr("id"),a=e("#"+i);return(t=t||window.event).altKey||t.ctrlKey||t.metaKey||50==t.keyCode||13==t.keyCode||9==t.keyCode||27==t.keyCode||"38"==t.keyCode||"40"==t.keyCode||t.shiftKey&&t.keyCode||36==t.keyCode||35==t.keyCode||33==t.keyCode||34==t.keyCode?0:(0===a.length&&(this.methods.comboDropDown.apply(this,[]),a=e("#"+i)),this.settings.isSearchable&&this.methods.selectItemByKeyUp.apply(this,[]),1)},selectItemByKeyUp:function(){var t,i="dd-"+n.config.inputCombo.attr("id"),a=e("#"+i);e(".active",a).removeClass("active");var s=this.settings.isSearchable?this.methods.findDataByValue(n.config.inputCombo.val()):-1;-1!==s?(t=e("li[data-value='"+s.id+"']",a)).addClass("active"):t=e("li.ui-selected",a),a.length>0&&t.length>0?(scrollPosition=parseInt(t.position().top),a.scrollTop(scrollPosition)):this.methods.setValue.apply(this,[this.selectedValue])},selectFirstElement:function(t){var i=e("li:first",t);e("li",t).removeClass("active"),i.addClass("active"),scrollPosition=i.position().top,t.scrollTop(scrollPosition),n.config.inputCombo.val(e(i).text())},selectLastElement:function(t){var i=e("li:last",t);e("li",t).removeClass("active"),i.addClass("active"),scrollPosition=i.position().top,t.scrollTop(scrollPosition),n.config.inputCombo.val(e(i).text())},selectFirstPossibleElement:function(t,i){var n=e("li",t),a=e.first(n,(function(t){return 0==e(t).text().toString().toLowerCase().indexOf(i.toLowerCase())}));if(a){e("li",t).removeClass("active"),e(a).addClass("active");var s=e(a).position().top;t.scrollTop(s)}},selectPreviousElement:function(t){var i=0,a=e("li.active",t);0===a.length&&(a=e("li:first",t));var s=a.prev();0!=s.length&&(a.removeClass("active"),e(s).addClass("active"),i=e(s).position().top,t.scrollTop(i),n.config.inputCombo.val(e(s).text()))},selectNextElement:function(t){var i=0,a=e("li.active",t);0===a.length&&(a=e("li:first",t));var s=a.next();0!=s.length&&(a.removeClass("active"),e(s).addClass("active"),i=e(s).position().top,t.scrollTop(i),n.config.inputCombo.val(e(s).text()))},onComboItemSelected:function(e){var t=e.value.toString(),i=e.text||"";this.config.inputCombo.val(i),this.methods.setValue.apply(this,[t,i])},setValue:function(t,i){this.config.inputCombo.data("value",t);var a=this.config.inputCombo,s={type:"comboChange",message:"combo change",time:new Date,ui:a,element:e(".biz-wp-combo",this),value:t,text:i};n.settings.onChange(s),e.event.trigger(s)},setDisplayValue:function(e){null!==(e=n.settings.itemValue?n.settings.itemValue:n.methods.itemValue)?n.config.inputCombo.val(""):null===e&&n.config.inputCombo.val("")},clearDisplayValue:function(){n.config.inputCombo.val(""),this.value=this.properties.value=this.selectedValue},getSelectedValue:function(){return this.selectedValue},recalculateComboOffset:function(e,t){if(bizagi.util.isIE()&&9==bizagi.util.getInternetExplorerVersion()&&e.width()!==t.width()){var i=t.width()-e.width();e.width(t.width()+i)}},itemValue:function(e){var t="";return e.itemValue?t=e.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},itemText:function(e){var t="";return e.itemValue?t=e.itemText(e):"string"==typeof e.text&&(t=e.text),t},destroy:function(t){var i=e(this);i.attr("role")===t.namespace?i.empty():e.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")},selectItem:function(t){var i=e(".biz-wp-combo-input",this);i.val(t.text),i.data("value",t.value)}},"object"!=_typeof(t)&&t?(e.extend(n.settings,i,n.config),n.methods[t].apply(this,[n.settings])):"object"!==_typeof(t)&&t&&void 0!==t?void e.error("Method "+t+" does not exist on jQuery.combo"):(e.extend(n.settings,t,n.config),this.each((function(){n.methods.init.apply(this,[n.settings])})))},e.bizagi.ui.controls.uicombo.plugin=e.fn.uicombo}(jQuery),function(e){e.fn.uitags=function(t,i){var n=this;function a(i,a){var s=new e.Deferred,o=bizagi.getTemplate(n.config.nameTemplate).concat(a);return e.when(t.loadTemplate(i,o)).done((function(){s.resolve(t.getTemplate(i))})),s.promise()}i=i||{},n.temporalElements={},n.config={nameTemplate:"bizagi.ui.controls.tags.template",cssComponent:"bizagi.ui.controls.tags"};var s={init:function(t,i){var n=this;n.input=t,n.tags=i.dataSource||[],n.placeholderText=i.placeholderText,n.titleText=i.titleText,n.hideSearchResult=i.hideSearchResult,n.isTextType=i.isTextType,n.isIntType=i.isIntType,n.isRealType=i.isRealType,n.isEntityType=i.isEntityType,n.onClose=i.onClose,n.onRemove=i.onRemove,n.entityMode=i.entityMode||!1,n.maxValues=i.maxValues,n.maxValuesErrorMessage=i.maxValuesErrorMessage,n.showMessageFunction=i.showMessageFunction,e.when(a("bizagi.inputTags.container","#ui-bz-mobile-uitags-control"),a("bizagi.inputTags.modalView","#ui-bz-wp-popup-uitags-control"),a("bizagi.inputTags.modalView.default","#ui-bz-wp-uitags-control-modalview-auxiliary-templates"),a("bizagi.imputTags.container.default","#ui-bz-wp-uitags-control-input-auxiliary-templates")).then((function(t,a,s,o){n.inputTags=t,n.modalViewTags=a,n.defaultModalViewTags=s,n.defaultInputTags=o,n.input.html(e.kendoTmpls(n.inputTags,{value:i.value||[],placeholderText:n.placeholderText})),n.configureInputHandlers(),n.configureModalView(".bz-rn-last-child")}))},configureModalView:function(t){var i=this;(""===t?i.input:e(t,i.input)).unbind().bind("click",(function(){var t=e("ul li.bz-rn-regular-element",i.input),n=[];i.temporalElements={};for(var a=0,s=t.length;a<s;a++){var o=e(t[a]).data("guid"),r=e("label",e(t[a])).text(),l={guid:o,tag:r};n.push(l),i.addTemporalElement(o,r,!1)}var u=i.modalViewTags,c=e.kendoTmpls(u,{items:n,orientation:"",title:i.titleText,placeholderText:i.placeholderText,isTextType:i.isTextType,isIntType:i.isIntType,isRealType:i.isRealType,isEntityType:i.isEntityType});c.kendoMobileModalView({close:function(){this.destroy(),this.element.remove()},useNativeScrolling:!0,modal:!1}),i.configureModalViewHandlers(c),c.kendoMobileModalView("open")}))},configureModalViewHandlers:function(t){var i=this,n=new e.Deferred;i.hideSearchResult&&t.find("#ui-bizagi-wp-filter-results-uitags-wrapper").hide(),i.entityMode&&(t.find(".bz-wp-uitagsplugin-cancel-icon-list").remove(),t.find(".bz-wp-uitagsplugin-add-icon-list").remove(),i.searchValue("",t)),t.find(".bz-wp-uitagsplugin-cancel-icon-list").hide(500),t.find(".bz-wp-uitagsplugin-add-icon-list").hide(500),t.find(".input-filter-results-on-uitagsplugin").bind("keypress keyup",(function(){""!==this.value?(t.find(".bz-wp-uitagsplugin-cancel-icon-list").show(500),t.find(".bz-wp-uitagsplugin-add-icon-list").show(500)):(t.find(".bz-wp-uitagsplugin-cancel-icon-list").hide(500),t.find(".bz-wp-uitagsplugin-add-icon-list").hide(500)),i.searchValue(this.value,t)})).focus((function(){t.find(".filter-searchlist-modal-view-tags").addClass("searching")})).blur((function(){t.find(".filter-searchlist-modal-view-tags").removeClass("searching")})),t.find(".bz-wp-uitagsplugin-cancel-icon-list").bind("click",(function(){i.showNoResultsMessage(t),t.find(".input-filter-results-on-uitagsplugin").val(""),e(this).hide(500),t.find(".bz-wp-uitagsplugin-add-icon-list").hide(500)})),t.find(".bz-wp-uitagsplugin-add-icon-list").bind("click",(function(){e(this).hide(500),t.find(".bz-wp-uitagsplugin-cancel-icon-list").hide(500);var n=t.find(".input-filter-results-on-uitagsplugin").val();i.appendFoundItem(n,e(".filter-uitags-modal-view-tags",t),!1),t.find(".input-filter-results-on-uitagsplugin").val("")})),t.delegate("#ui-bizagi-apply-button-uitags","click",(function(){n.resolve(),t.data("kendoMobileModalView").close()})),t.find(".bz-wp-search-on-uitags-back-icon-list").bind("click",(function(){n.reject(),t.data("kendoMobileModalView").close()})),t.find(".filter-uitags-modal-view-tags").on("click",".bz-rn-remove-tag-on-uitags",(function(){i.removeItem(e(this),!0);var n=t.find(".input-filter-results-on-uitagsplugin").val();i.searchValue(n,t)})),e.when(n).done((function(){i.addNewValuesToInput(),i.temporalElements={},void 0!==i.onClose&&i.onClose()})).fail((function(){i.temporalElements={}}))},searchValue:function(t,i){bizagi.loading.start({selector:".bz-rn-new-modalview-content-styles"}),e.when(this.showResults(t,i)).always((function(){bizagi.loading.stop({selector:".bz-rn-new-modalview-content-styles"})}))},showResults:function(t,i){var n=this,a=n.tags.filter((function(e){return n.entityMode?-1!==e.displayName.toLowerCase().indexOf(t.toLowerCase()):void 0!==e.displayName?-1!==e.tag.indexOf(t):void 0}));if(0===a.length)n.showNoResultsMessage(i);else{e("#ui-bizagi-wp-filter-results-uitags-wrapper ul li",i).remove();var s=e.kendoTmpls(n.defaultModalViewTags,{template:"sugestions",items:a,entityMode:n.entityMode});e("li",s).appendTo(e("#ui-bizagi-wp-filter-results-uitags-wrapper ul",i)),n.modalViewList=e(".ui-bizagi-render-list-elements",i),n.modalViewList.find("li").unbind().bind("click",(function(){n.appendFoundItem(this,e(".filter-uitags-modal-view-tags",i),!0),0===e(this).siblings().length&&n.showNoResultsMessage(i),e(this).remove(),n.entityMode&&(i.find(".input-filter-results-on-uitagsplugin").val(""),n.searchValue("",i))}))}},showNoResultsMessage:function(t){var i=bizagi.localization.getResource("workportal-widget-inboxcommon-no-results-found"),n=e.kendoTmpls(this.defaultModalViewTags,{template:"modalViewDefaultMessage",message:i}),a=e("li",n);e("#ui-bizagi-wp-filter-results-uitags-wrapper ul li",t).remove(),a.appendTo(e("#ui-bizagi-wp-filter-results-uitags-wrapper ul",t))},removeItem:function(t,i){var n=t.parent(),a=t.closest(".bz-rn-container-uitags");if(0===a.length&&(a=t.closest(".filter-uitags-modal-view-tags")),i&&delete this.temporalElements[n.data("guid")],n.remove(),a.find("li").length<=1&&!i)e(".bz-rn-click-to-add-span",a).removeClass("hidden"),this.configureModalView(".bz-rn-last-child");else if(0===a.find("li").length&&i){var s=e.kendoTmpls(this.defaultModalViewTags,{template:"modalViewDefaultValue"});e("li",s).appendTo(e("ul",a))}void 0!==this.onRemove&&this.onRemove()},appendFoundItem:function(t,i,n){var a="",s="";if(this.getTagsElements().length>=this.maxValues)this.showMessageFunction(this.maxValuesErrorMessage);else{var o=e.map(e("li",i),(function(t){return e(t).data("guid")})),r=[];if(n)a=e(t).data("guid"),s=e("label",t).text();else if(r=this.tags.filter((function(e){return e.tag==t}))[0]){a=r.guid,s=r.tag;var l=e("[data-guid='"+a+"']",this.modalViewList);if(0===l.siblings().length){var u=e("#ui-bizagi-wp-filter-results-uitags-wrapper ul li",this.modalViewList.parents());this.showNoResultsMessage(u)}l.remove()}else a=Math.guid(),s=t;if(-1==o.indexOf(a)){var c=e.kendoTmpls(this.defaultModalViewTags,{template:"fullElement",guid:a,tag:s}),d=e("li",c),p=e("li:last",i);p.hasClass("bz-rn-any-element")?(p.remove(),e("ul",i).prepend(d)):e("ul",i).prepend(d),this.addTemporalElement(a,s,!1)}}},getTagsElements:function(){for(var t=e("ul li.bz-rn-regular-element",n.selector),i=[],a=0;a<t.length;a++){var s={guid:e(t[a]).data("guid"),tag:e("label",e(t[a])).text()};i.push(s)}return Array.from(i.reduce((function(e,t){return e.set(t.guid,t)}),new Map).values())},addNewValuesToInput:function(){var t=[];e.each(this.temporalElements,(function(e,i){t.push(i.obj)})),e("ul li",this.input).remove();var i=e.kendoTmpls(this.defaultInputTags,{template:"inputContainer",value:t});e("li",i).appendTo(e("ul",this.input)),e("ul",this.input).unbind(),e(".bz-rn-last-child",this.input).unbind(),this.configureModalView(".bz-rn-last-child"),this.configureInputHandlers()},configureInputHandlers:function(){var t=this;t.input.on("click",".bz-rn-remove-tag-on-uitags",(function(){t.removeItem(e(this))}))},addTemporalElement:function(e,t,i){this.temporalElements[e]&&delete this.temporalElements[e],this.temporalElements[e]={obj:{guid:e,tag:t},remove:i}}};return s.init(n,i),s}}($),function(e){"use strict";var t={tagClass:function(e){return"label label-info"},itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},itemTitle:function(e){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!0,onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,isNumber:!1};function i(t,i){this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=i&&i.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput biz-wp-input-combo"></div>'),this.inputType=i.isNumber?"number":"text",this.$input=e('<input type="'+this.inputType+'" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(i)}function n(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(e){return e[i]}}}function a(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(){return i}}}i.prototype={constructor:i,add:function(t,i,n){var a=this;if(!(a.options.maxTags&&a.itemsArray.length>=a.options.maxTags)&&(!1===t||t)){if("string"==typeof t&&a.options.trimValue&&(t=e.trim(t)),"object"===_typeof(t)&&!a.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(a.isSelect&&!a.multiple&&a.itemsArray.length>0&&a.remove(a.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var s=a.options.delimiterRegex?a.options.delimiterRegex:a.options.delimiter,r=t.split(s);if(r.length>1){for(var l=0;l<r.length;l++)this.add(r[l],!0);return void(i||a.pushVal())}}var u=a.options.itemValue(t),c=a.options.itemText(t),d=a.options.tagClass(t),p=a.options.itemTitle(t),m=e.grep(a.itemsArray,(function(e){return a.options.itemValue(e)===u}))[0];if(!m||a.options.allowDuplicates){if(!(a.items().toString().length+t.length+1>a.options.maxInputLength)){var h=e.Event("beforeItemAdd",{item:t,cancel:!1,options:n});if(a.$element.trigger(h),!h.cancel){a.itemsArray.push(t);var f=e('<span class="tag '+o(d)+(null!==p?'" title="'+p:"")+'">'+o(c)+'<span data-role="remove"></span></span>');if(f.data("item",t),a.findInputWrapper().before(f),f.after(" "),a.isSelect&&!e('option[value="'+encodeURIComponent(u)+'"]',a.$element)[0]){var g=e("<option selected>"+o(c)+"</option>");g.data("item",t),g.attr("value",u),a.$element.append(g)}i||a.pushVal(),a.options.maxTags!==a.itemsArray.length&&a.items().toString().length!==a.options.maxInputLength||a.$container.addClass("bootstrap-tagsinput-max"),a.$element.trigger(e.Event("itemAdded",{item:t,options:n}))}}}else if(a.options.onTagExists){var b=e(".tag",a.$container).filter((function(){return e(this).data("item")===m}));a.options.onTagExists(t,b)}}}},remove:function(t,i,n){var a=this;if(a.objectItems&&(t=(t="object"===_typeof(t)?e.grep(a.itemsArray,(function(e){return a.options.itemValue(e)==a.options.itemValue(t)})):e.grep(a.itemsArray,(function(e){return a.options.itemValue(e)==t})))[t.length-1]),t){var s=e.Event("beforeItemRemove",{item:t,cancel:!1,options:n});if(a.$element.trigger(s),s.cancel)return;e(".tag",a.$container).filter((function(){return e(this).data("item")===t})).remove(),e("option",a.$element).filter((function(){return e(this).data("item")===t})).remove(),-1!==e.inArray(t,a.itemsArray)&&a.itemsArray.splice(e.inArray(t,a.itemsArray),1)}i||a.pushVal(),a.options.maxTags>a.itemsArray.length&&a.$container.removeClass("bootstrap-tagsinput-max"),a.$element.trigger(e.Event("itemRemoved",{item:t,options:n}))},removeAll:function(){for(e(".tag",this.$container).remove(),e("option",this.$element).remove();this.itemsArray.length>0;)this.itemsArray.pop();this.pushVal()},refresh:function(){var t=this;e(".tag",t.$container).each((function(){var i=e(this),n=i.data("item"),a=t.options.itemValue(n),s=t.options.itemText(n),r=t.options.tagClass(n);(i.attr("class",null),i.addClass("tag "+o(r)),i.contents().filter((function(){return 3==this.nodeType}))[0].nodeValue=o(s),t.isSelect)&&e("option",t.$element).filter((function(){return e(this).data("item")===n})).attr("value",a)}))},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=e.map(t.items(),(function(e){return t.options.itemValue(e).toString()}));t.$element.val(i,!0).trigger("change")},build:function(i){var s=this;if(s.options=e.extend({},t,i),s.objectItems&&(s.options.freeInput=!1),n(s.options,"itemValue"),n(s.options,"itemText"),a(s.options,"tagClass"),s.options.typeahead){var o=s.options.typeahead||{};a(o,"source"),s.$input.typeahead(e.extend({},o,{source:function(t,i){function n(e){for(var t=[],n=0;n<e.length;n++){var o=s.options.itemText(e[n]);a[o]=e[n],t.push(o)}i(t)}this.map={};var a=this.map,r=o.source(t);e.isFunction(r.success)?r.success(n):e.isFunction(r.then)?r.then(n):e.when(r).then(n)},updater:function(e){return s.add(this.map[e]),this.map[e]},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(s.options.typeaheadjs){var l=null,u={},c=s.options.typeaheadjs;e.isArray(c)?(l=c[0],u=c[1]):u=c,s.$input.typeahead(l,u).on("typeahead:selected",e.proxy((function(e,t){u.valueKey?s.add(t[u.valueKey]):s.add(t),s.$input.typeahead("val","")}),s))}s.$container.on("click",e.proxy((function(e){s.$element.attr("disabled")||s.$input.removeAttr("disabled"),s.$input.focus()}),s)),s.options.addOnBlur&&s.options.freeInput&&s.$input.on("focusout",e.proxy((function(t){0===e(".typeahead, .twitter-typeahead",s.$container).length&&(s.add(s.$input.val()),s.$input.val(""))}),s)),s.$container.on("keydown","input",e.proxy((function(t){var i=e(t.target),n=s.findInputWrapper();if(s.$element.attr("disabled"))s.$input.attr("disabled","disabled");else{switch(t.which){case 8:if(0===r(i[0])){var a=n.prev();a.length&&s.remove(a.data("item"))}break;case 46:if(0===r(i[0])){var o=n.next();o.length&&s.remove(o.data("item"))}break;case 37:var l=n.prev();0===i.val().length&&l[0]&&(l.before(n),i.focus());break;case 39:var u=n.next();0===i.val().length&&u[0]&&(u.after(n),i.focus())}var c=i.val().length;Math.ceil(c/5);i.attr("size",Math.max(this.inputSize,i.val().length))}}),s)),s.$container.on("keypress","input",e.proxy((function(t){var i=e(t.target);if(s.$element.attr("disabled"))s.$input.attr("disabled","disabled");else{var n,a,o,r=i.val(),l=s.options.maxChars&&r.length>=s.options.maxChars;s.options.freeInput&&(n=t,a=s.options.confirmKeys,o=!1,e.each(a,(function(e,t){if("number"==typeof t&&n.which===t)return o=!0,!1;if(n.which===t.which){var i=!t.hasOwnProperty("altKey")||n.altKey===t.altKey,a=!t.hasOwnProperty("shiftKey")||n.shiftKey===t.shiftKey,s=!t.hasOwnProperty("ctrlKey")||n.ctrlKey===t.ctrlKey;if(i&&a&&s)return o=!0,!1}})),o||l)&&(0!==r.length&&(s.add(l?r.substr(0,s.options.maxChars):r),i.val("")),!1===s.options.cancelConfirmKeysOnEmpty&&t.preventDefault());var u=i.val().length;Math.ceil(u/5);i.attr("size",Math.max(this.inputSize,i.val().length))}}),s)),s.$container.on("click","[data-role=remove]",e.proxy((function(t){s.$element.attr("disabled")||s.remove(e(t.target).closest(".tag").data("item"))}),s)),s.options.itemValue===t.itemValue&&("INPUT"===s.$element[0].tagName?s.add(s.$element.val()):e("option",s.$element).each((function(){s.add(e(this).attr("value"),!0)})))},destroy:function(){this.$container.off("keypress","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("tagsinput"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(t,n,a){var s=[];return this.each((function(){var o=e(this).data("tagsinput");if(o)if(t||n){if(void 0!==o[t]){if(3===o[t].length&&void 0!==a)var r=o[t](n,null,a);else r=o[t](n);void 0!==r&&s.push(r)}}else s.push(o);else o=new i(this,n),e(this).data("tagsinput",o),s.push(o),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())})),"string"==typeof t?s.length>1?s:s[0]:s},e.fn.tagsinput.Constructor=i;var s=e("<div />");function o(e){return e?s.text(e).html():""}function r(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}e((function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()}))}(window.jQuery),function(e){"use strict";e.fn.uicheckbox=function(t,i){var n=this;return n.config={namespace:e.bizagi.ui.controls.uicheckbox.namespace,cssComponent:e.bizagi.ui.controls.uicheckbox.css},n.settings={data:{},nameTemplate:e.bizagi.ui.controls.uicheckbox.tmpl,itemValue:null,itemText:null,css:"",itemChecked:0,getTemplate:function(e){return bizagi.getTemplate(e)},onComplete:function(){},onChange:function(){}},n.methods={init:function(t){var i=e(this),a=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace),i.addClass(t.cssComponent),i.addClass(t.css),e.when(e.get(a)).done((function(a){var s=t.data;t.data.checkboxGroup=t.checkboxGroup?t.checkboxGroup:n.methods.generateNamecheckboxGroup();for(var o=0;o<s.checkbox.length;o++)s.checkbox[o].isChecked=!1;s.checkbox[t.itemChecked].isChecked=!0;var r=e.tmpl(a,s,{itemValue:t.itemValue?t.itemValue:n.methods.itemValue,itemText:t.itemText?t.itemText:n.methods.itemText});i.append(r),r.find(".biz-wp-option-checkbox").each((function(i,n){t.data.checkbox[i].data&&e.extend(e(n).data(),t.data.checkbox[i].data)})),n.settings.onComplete.apply(i,[]),e('input[type="checkbox"]',r).on("change",(function(){var t=e(this);n.settings.onChange(t),e.event.trigger({type:"checkboxChange",message:"checkbox change",time:new Date,ui:t})})),e.event.trigger({type:"checkboxCompleted",message:"checkbox is Completed",time:new Date,ui:i})})).fail((function(){e.error("No se pudo cargar el template para generar las tablas")}))},generateNamecheckboxGroup:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)}))},itemValue:function(e){var t="";return e.itemValue?t=e.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},itemText:function(e){var t="";return e.itemValue?t=e.itemText(e):"string"==typeof e.text&&(t=e.text),t},destroy:function(t){var i=e(this);i.attr("role")===t.namespace?i.empty():e.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},"object"!=_typeof(t)&&t?(e.extend(n.settings,i,n.config),n.methods[t].apply(this,[n.settings])):"object"!==_typeof(t)&&t&&void 0!==t?void e.error("Method "+t+" does not exist on jQuery.checkbox"):(e.extend(n.settings,t,n.config),this.each((function(){n.methods.init.apply(this,[n.settings])})))},e.bizagi.ui.controls.uicheckbox.plugin=e.fn.uicheckbox}(jQuery),function(e){"use strict";e.fn.uiradio=function(t,i){var n=this;return n.config={namespace:e.bizagi.ui.controls.uiradio.namespace,cssComponent:e.bizagi.ui.controls.uiradio.css},n.settings={data:{},nameTemplate:e.bizagi.ui.controls.uiradio.tmpl,itemValue:null,itemText:null,css:"",getTemplate:function(e){return bizagi.getTemplate(e)},onComplete:function(){},onChange:function(){}},n.methods={init:function(t){var i=e(this),a=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace),i.addClass(t.cssComponent),i.addClass(t.css),e.when(e.get(a)).done((function(a){var s=t.data;t.data.radioGroup=t.radioGroup?t.radioGroup:n.methods.generateNameRadioGroup();var o=e.tmpl(a,s,{itemValue:t.itemValue?t.itemValue:n.methods.itemValue,itemText:t.itemText?t.itemText:n.methods.itemText});i.append(o),o.find(".biz-wp-option-radio").each((function(i,n){t.data.radio[i].data&&e.extend(e(n).data(),t.data.radio[i].data)})),n.settings.onComplete.apply(i,[]),e('input[type="radio"]',o).on("change",(function(){var t=e(this);n.settings.onChange(t),e.event.trigger({type:"radioChange",message:"radio change",time:new Date,ui:t})})),e.event.trigger({type:"radioCompleted",message:"radio is Completed",time:new Date,ui:i})})).fail((function(){e.error("No se pudo cargar el template para generar las tablas")}))},generateNameRadioGroup:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)}))},itemValue:function(e){var t="";return e.itemValue?t=e.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},itemText:function(e){var t="";return e.itemValue?t=e.itemText(e):"string"==typeof e.text&&(t=e.text),t},destroy:function(t){var i=e(this);i.attr("role")===t.namespace?i.empty():e.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},"object"!=_typeof(t)&&t?(e.extend(n.settings,i,n.config),n.methods[t].apply(this,[n.settings])):"object"!==_typeof(t)&&t&&void 0!==t?void e.error("Method "+t+" does not exist on jQuery.radio"):(e.extend(n.settings,t,n.config),this.each((function(){n.methods.init.apply(this,[n.settings])})))},e.bizagi.ui.controls.uiradio.plugin=e.fn.uiradio}(jQuery),function(e){e.widget("ui.treeview",{options:{list:[],defaults:[],_dataItems:[],_config:{_template:e.bizagi.ui.controls.uitreeview.tmpl,_cssClass:e.bizagi.ui.controls.uitreeview.css,_namespace:e.bizagi.ui.controls.uitreeview.namespace},SEARCH_MAX_LENGTH:1},_create:function(){var t=this,i=t.element,n=t.options._config._cssClass;t.options._dataItems=[],t.options.defaults.length&&t._setDefaults(),i.addClass(n),t.loader=new bizagi.ui.controls.tmplloader,e.when(t.loader.loadTemplates(t._initializeTemplates())).done((function(){i.append(t._renderContent()),t._eventHandlers()}))},_eventHandlers:function(){var t=this;e(".biz-ui-controls-tree-item",t.element).on("click",".biz-ui-controls-treeview-row:first-child",(function(i){var n=e(this),a=e(i.target);if(a.is("i.biz-ui-controls-treeview-subitems"))t._slideSubItems(n);else{if(!a.is("input[type=checkbox]")){var s=a.siblings("input[type=checkbox]");s.prop("checked")?s.prop("checked",!1):s.prop("checked",!0)}n.toggleClass("biz-ui-controls-uitreeview-items-active"),t._setValue(n)}i.stopPropagation()}))},_slideSubItems:function(e){e.siblings("ul").slideToggle(300)},_setValue:function(t){var i=this.options._dataItems,n=t.data("value"),a=t.data("text");if(t.hasClass("biz-ui-controls-uitreeview-items-active"))i.push({text:a,value:n});else{var s=e.map(i,(function(e,t){if(e.value==n)return t}));i.splice(s[0],1)}this._trigger("checkItem")},getDataItems:function(){return this.options._dataItems},setList:function(e){this.options.list=e,this.options._dataItems=[],this._refresh()},getList:function(){return this.options.list},_refresh:function(){this.element.empty().append(this._renderContent()),this._eventHandlers()},_renderContent:function(){var t=this.options.list,i=this.loader.getTemplate("items");return e.tmpl(i,{list:t},{itemValue:e.proxy(this._itemValue,this),itemText:e.proxy(this._itemText,this),renderSubItems:e.proxy(this._renderSubItems,this),setDefaults:e.proxy(this._setDefaults,this)})},_initializeTemplates:function(){var e=this.options._config._template;return{items:bizagi.getTemplate(e)+"#bizagi-ui-controls-uitreeview-items",subitems:bizagi.getTemplate(e)+"#bizagi-ui-controls-uitreeview-subitems"}},_renderSubItems:function(t){var i=this.loader.getTemplate("subitems");return e.tmpl(i,t,{itemValue:e.proxy(this._itemValue,this),itemText:e.proxy(this._itemText,this),renderSubItems:e.proxy(this._renderSubItems,this),setDefaults:e.proxy(this._setDefaults,this)}).html()},_destroy:function(){this.options._dataItems=[]},_itemValue:function(e){var t="";return this.options.itemValue?t=this.options.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},_itemText:function(e){var t="";return this.options.itemText?t=this.options.itemText(e):"string"==typeof e.text&&(t=e.text),t},_setDefaults:function(e){this.options.defaults,this.options.list;var t=this._itemText(e),i=this._itemValue(e);return this.options._dataItems.push({text:t,value:i}),""}})}(jQuery),function(e){e.widget("ui.autocomplete",e.ui.autocomplete,{_originalRenderItem:e.ui.autocomplete.prototype._renderItem,_renderItem:function(e,t){return void 0!==this.options.customRenderItem&&null!=this.options.customRenderItem&&"function"==typeof this.options.customRenderItem?this.options.customRenderItem(e,t):this._originalRenderItem.apply(this,arguments)},_renderMenu:function(t,i){var n=this;this.options&&this.options.classMenuList&&t.addClass(this.options.classMenuList),e.each(i,(function(e,i){n._renderItemData(t,i)})),bizagi.localization.isRTL&&t.addClass("ui-rtl")}}),e.widget("ui.bizagi_multiSelect",{options:{list:[],asyncList:void 0,label:"MyLabel",_dataItems:[],_config:{_template:e.bizagi.ui.controls.uimultiselect.tmpl,_cssClass:e.bizagi.ui.controls.uimultiselect.css,_namespace:e.bizagi.ui.controls.uimultiselect.namespace},SEARCH_MIN_LENGTH:3,iconClass:"",onChange:new Function,parentPositionElement:"",parentElementToFitWidth:"",parentElementToBorder:"",classOpenedList:"",classOpenedParent:"",classItem:"",openOnFocus:!1,customRenderItem:null,maxDataItems:void 0,errorMaxDataItems:void 0,notifierFunction:void 0,placeholder:void 0,classMenuList:""},_create:function(){var t=this,i=t.element;t.options._dataItems=[],e.when(t._renderContent()).done((function(n){i.append(n);var a,s=i.find("input[type=text]");t.options.placeholder&&s.attr("placeholder",t.options.placeholder),s.autocomplete({source:t._getDataSource(),minLength:t.options.SEARCH_MIN_LENGTH,classMenuList:t.options.classMenuList,messages:{noResults:null},select:function(i,n){var s=e.grep(t.options.list,(function(e){return t._itemValue(e)==n.item.id}));t._prependElements(s[0]),a=n.item.value},close:function(){a&&s.val()==a.toString()&&s.val(""),""!=t.options.parentElementToBorder&&""!=t.options.classOpenedList&&""!=t.options.classOpenedParent&&(e(".ui-menu").removeClass(t.options.classOpenedList),e(t.options.parentElementToBorder).removeClass(t.options.classOpenedParent))},open:function(){if(""!=t.options.parentElementToFitWidth&&e(".ui-menu").width(e(t.options.parentElementToFitWidth).width()-4),""!=t.options.parentElementToBorder&&""!=t.options.classOpenedList&&""!=t.options.classOpenedParent&&(e(".ui-menu").addClass(t.options.classOpenedList),e(t.options.parentElementToBorder).addClass(t.options.classOpenedParent)),bizagi.util.isIE()){var i=this;e(i).autocomplete("widget").css("z-index",""),setTimeout((function(){e(i).autocomplete("widget").css("z-index",100)}),100)}},position:""!=t.options.parentPositionElement?{of:e(t.options.parentPositionElement),my:"left+0 top-4"}:{my:"left top",at:"left bottom",collision:"none"},customRenderItem:t.options.customRenderItem}),t.options.openOnFocus&&s.bind("focus",(function(){e(this).autocomplete("search")})),""!=t.options.iconClass&&e("<i class='"+t.options.iconClass+"'></i>").insertBefore(s),t._eventHandlers()}))},getDataItems:function(){return this.options._dataItems},setDataItems:function(t){var i=this;setTimeout((function(){i._settingItems=!0,e.each(t,(function(e,t){i._prependElements(t)})),i._settingItems=!1}),100)},setList:function(e){this.options.list=e,this._refresh()},getList:function(){return this.options.list},_initializeTemplates:function(){var e=this.options._config._template;return{multiselect:bizagi.getTemplate(e)}},_renderContent:function(){var t=this,i=t.element,n=(t.options._config._template,t.options._config._cssClass),a=t.options.label;return i.addClass(n),t.loader=new bizagi.ui.controls.tmplloader,e.when(t.loader.loadTemplates(t._initializeTemplates())).pipe((function(){var i=t.loader.getTemplate("multiselect");return e.tmpl(i,{label:a})}))},_refresh:function(){var e=this.element.find("input[type=text]");e.parent("li").siblings("li").remove(),this.options._dataItems=[],this.options.onChange(this.options._dataItems),e.autocomplete("option","source",this._getDataSource())},_getDataSource:function(){var t=this,i=[];return e.each(t.options.list,(function(e,n){i.push({label:t._itemText(n),value:n,id:t._itemValue(n)})})),i},_prependElements:function(t){var i=this,n=i.element,a=i.options._dataItems,s=n.find("input[type=text]");if(!e.grep(a,(function(e){return e.value==i._itemValue(t)})).length){if(void 0!==i.options.maxDataItems&&a.length==i.options.maxDataItems)return void i.options.notifierFunction(i.options.errorMaxDataItems);a.push({text:i._itemText(t),value:i._itemValue(t)}),s.parent().before('<li class="selected-item '+i.options.classItem+'" data-value="'+i._itemValue(t)+'"><label>'+i._itemText(t)+'</label><a class="closebutton"></a></li>'),i._settingItems||(i.element.trigger("addItem"),i.options.onChange(i.options._dataItems))}},_itemValue:function(e){var t="";return this.options.itemValue?t=this.options.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},_itemText:function(e){var t="";return this.options.itemText?t=this.options.itemText(e):"string"==typeof e.text&&(t=e.text),t},_destroy:function(){this.options._dataItems=[],this.options.onChange(this.options._dataItems)},_eventHandlers:function(){var t=this,i=t.element,n=i.find("input[type=text]");e("ul",i).on("click","a.closebutton",(function(i){i.preventDefault();var n=e(i.target).closest("li").data("value"),a=e.map(t.options._dataItems,(function(e,t){if(e.value==n)return t}));return t.options._dataItems.splice(a[0],1),t.options.onChange(t.options._dataItems),e(this).parent().remove(),t.element.trigger("removeItem"),!1})),i.on("click",(function(e){n.focus()})),n.on("keydown",(function(e){13==e.keyCode&&e.preventDefault()}))}})}(jQuery),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{scope:void 0,appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null}}),$.widget("ui.bizagi_searchMultiSelect",$.ui.bizagi_multiSelect,{options:{asyncList:void 0,scope:void 0,label:"MyLabel",_dataItems:[],_config:{_template:$.bizagi.ui.controls.uimultiselect.tmpl,_cssClass:$.bizagi.ui.controls.uimultiselect.css,_namespace:$.bizagi.ui.controls.uimultiselect.namespace},SEARCH_MIN_LENGTH:3,iconClass:"",onChange:new Function,parentPositionElement:"",parentElementToFitWidth:"",parentElementToBorder:"",classOpenedList:"",classOpenedParent:"",classItem:"",openOnFocus:!1,customRenderItem:null,classMenuList:""},_search:function(e,t){this.options.scope.searchMultiSelectScope.options.asyncList(e,t,this.options.scope)},_create:function(){var e=this,t=e.element;e.options._dataItems=[],$.when(e._renderContent()).done((function(i){t.append(i);var n,a=t.find("input[type=text]");e.options.scope.searchMultiSelectScope=e,a.autocomplete({scope:e.options.scope,source:e._search,minLength:e.options.SEARCH_MIN_LENGTH,messages:{noResults:null},select:function(t,i){$.grep(e.options.list,(function(t){return e._itemValue(t)==i.item.id}));e._prependElements(i.item),n=i.item.value},close:function(){n&&a.val()==n.toString()&&a.val(""),""!=e.options.parentElementToBorder&&""!=e.options.classOpenedList&&""!=e.options.classOpenedParent&&($(".ui-menu").removeClass(e.options.classOpenedList),$(e.options.parentElementToBorder).removeClass(e.options.classOpenedParent))},open:function(){if(e.options&&e.options.classMenuList&&$(".ui-menu").addClass(e.options.classMenuList),""!=e.options.parentElementToFitWidth&&$(".ui-menu").width($(e.options.parentElementToFitWidth).width()-4),""!=e.options.parentElementToBorder&&""!=e.options.classOpenedList&&""!=e.options.classOpenedParent&&($(".ui-menu").addClass(e.options.classOpenedList),$(e.options.parentElementToBorder).addClass(e.options.classOpenedParent)),bizagi.util.isIE()){var t=this;$(t).autocomplete("widget").css("z-index",""),setTimeout((function(){$(t).autocomplete("widget").css("z-index",100)}),100)}},position:""!=e.options.parentPositionElement?{of:e.options.parentPositionElement,my:"left+0 top-4"}:{my:"left top",at:"left bottom",collision:"none"},customRenderItem:e.options.customRenderItem}),e.options.openOnFocus&&a.bind("focus",(function(){$(this).autocomplete("search")})),""!=e.options.iconClass&&$("<i class='"+e.options.iconClass+"'></i>").insertBefore(a),e._eventHandlers()}))},__getDataSource:function(){var e=this,t=[],i=new $.Deferred;return e.options.asyncList?$.when(e.options.asyncList()).done((function(n){$.each(n,(function(i,n){t.push({label:e._itemText(n),value:e._itemText(n),id:e._itemValue(n)})})),i.resolve(t)})):($.each(e.options.list,(function(i,n){t.push({label:e._itemText(n),value:e._itemText(n),id:e._itemValue(n)})})),i.resolve(t)),i.promise()},_prependElements:function(e){var t=this,i=t.element,n=t.options._dataItems,a=i.find("input[type=text]");$.grep(n,(function(i){return i.value==t._itemValue(e)})).length||(n.push({text:t._itemText(e),value:t._itemValue(e),raw:e}),a.parent().before('<li class="selected-item '+t.options.classItem+'" data-value="'+t._itemValue(e)+'"><label>'+t._itemText(e)+'</label><a class="closebutton"></a></li>'),t._settingItems||(t.element.trigger("addItem"),t.options.onChange(t.options._dataItems)))},_refresh:function(){this.element.find("input[type=text]").parent("li").siblings("li").remove(),this.options._dataItems=[],this.options.onChange(this.options._dataItems)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.async",{ASYNC_CHECK_TIMER:3e3},{init:function(e,t,i){this._super(e,t,i)},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC},renderContent:function(){var e=new $.Deferred;return this.checkAsycnExecutionState(e),e.promise()},checkAsycnExecutionState:function(e){var t=this;$.when(t.dataService.getAsynchExecutionState({idCase:t.params.idCase})).done((function(i){var n=t.getTemplate("async");"Error"==i.state&&null!=i.errorMessage&&(i.errorMessage=bizagi.localization.getResource("render-async-error")),t.content=$.tmpl(n,i),"Processing"==i.state?0==i.errorMessage.length&&setTimeout((function(){t.publish("changeWidget",t.params)}),t.Class.ASYNC_CHECK_TIMER):"Finished"==i.state&&t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase}),e.resolve(t.content)}))}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.asyncecm.upload",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD},renderContent:function(){var e=this.getTemplate("async.ecm.upload");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.asyncecm.upload.extend("bizagi.workportal.widgets.asyncecm.upload",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"async.ecm.upload":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload"),"async.ecm.pending.jobs":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload-table-pending-jobs"),useNewEngine:!1})},postRender:function(){this.enableUI=!0,this.renderAsyncECMUpload(),this.asyncECMUploadTypes={NOT_RUNNED:1,RUNNING:2,RUN_FINNISHED_OK:3,RUN_FINNISHED_WITH_ERROR:4}},updateEcmAllScheduledJobs:function(){var e=this,t=e.getContent();$("#async-emc-list-content",t).empty(),$("#async-emc-list-content",t).loadingMessage(),$.when(e.dataService.getEcmAllScheduledJobs()).done((function(t){e.renderAllScheduledJobs(t)})).fail((function(e){}))},renderAsyncECMUpload:function(){console.log("renderAsyncECMUpload ready");this.getContent();this.updateEcmAllScheduledJobs()},renderAllScheduledJobs:function(e){var t=this,i=t.getContent(),n=t.getTemplate("async.ecm.pending.jobs");$("#async-emc-list-content",i).empty(),t.enableUI=!0,$.tmpl(n,{jobs:e}).appendTo($("#async-emc-list-content",i)),$("#async-emc-list-content tbody tr",i).each((function(){$(this).index()%2<1&&$(this).addClass("biz-ui-even")})),$("#table-content .async-emc-item p",i).hover(t.failureMessageHoverIn),$(".async-ecm-refresh",i).click((function(){t.enableUI&&(t.enableUI=!1,t.updateEcmAllScheduledJobs())})),$("#table-content .async-emc-item .async-ecm-retry",i).click((function(e){e.preventDefault(),t.retryECMPendingScheduledJob($(this).parent().attr("data-idjob"))}))},retryECMPendingScheduledJob:function(e){var t=this,i=t.getContent();$("#async-emc-list-content",i).empty(),$("#async-emc-list-content",i).loadingMessage({customMessage:"Please wait"}),$.when(t.dataService.retryECMPendingScheduledJob(e)).done((function(){t.updateEcmAllScheduledJobs()})).fail((function(e){console.log("retryECMPendingScheduledJob error")}))},failureMessageHoverIn:function(e){$(e.currentTarget).text().length>0&&$(e.currentTarget).attr("title",$(e.currentTarget).text())}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.processtree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE},renderContent:function(){var e=this.getTemplate("processTree.links");return this.content=$.tmpl(e,{})},loadtemplates:function(){}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entitiestree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE},renderContent:function(){var e=this.getTemplate("EntitiesTree.wrapper");return this.content=$.tmpl(e,{})},loadtemplates:function(){}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.userstable",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE},renderContent:function(){var e=this.getTemplate("usersTable.wrapper");return this.content=$.tmpl(e,{})},loadtemplates:function(){}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.tree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TREE},renderContent:function(){},loadtemplates:function(){}}),bizagi.workportal.widgets.processtree.extend("bizagi.workportal.widgets.processtree",{},{init:function(e,t,i){this.showTitle=null==i.showTitle||i.showTitle,this.searchKeyResource=i.searchKeyResource||"workportal-widget-processTree-search-in",this.searchKeyResource=bizagi.localization.getResource(this.searchKeyResource),this.svgIconsMode=i.svgIconsMode||!1,this.processesTreeNew=i.newDesign,this._super(e,t,i),this.loadTemplates({"processTree.links":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-links"),"processTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-wrapper"),processTree:bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree"),"processTree.selected":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-selected"),useNewEngine:!1})},renderContent:function(){var e,t=this.getTemplate("processTree.links");return e=this.content=$.tmpl(t,{showTitle:this.showTitle}),this.params.canvas&&(e=this.content=this.params.canvas.html(e)),e},postRender:function(){this.loadtemplates(),this.setupData()},loadtemplates:function(){this.applicationTreeWrapperTmpl=this.getTemplate("processTree.wrapper"),this.applicationTreeTmpl=this.getTemplate("processTree"),this.applicationTreeSelectedTmpl=this.getTemplate("processTree.selected")},setupData:function(){var e=this;e.treeRouteSelected=[],e.treeRouteText="",$.when(e.setupInitialData()).done((function(){e.setupLinks()}))},setupInitialData:function(){var e=this.getContent(),t=$.Deferred();return this.treeRouteSelected=[],$.when($.tmpl(this.applicationTreeWrapperTmpl,{}),$.tmpl(this.applicationTreeSelectedTmpl,{searchKeyResource:this.searchKeyResource})).done((function(i,n){e.append(i),e.append(n),t.resolve()})),t.promise()},setupLinks:function(){var e=this,t=e.getContent(),i={action:"Applications"};e.params.userId&&(i.userId=e.params.userId),e.showSelectedProcessLabelWhenAllApplicationsSelected(),$("#allAppsLink",t).click((function(){e.showSelectedProcessLabelWhenAllApplicationsSelected(),e.selectAllApplications(t)})),$("#allAppsLinkSelected",t).click((function(){e.showSelectedProcessLabelWhenAllApplicationsSelected(),e.selectAllApplications(t)})),$("#selectAppLink",t).click((function(){e.hideSelectedProcessLabelWhenAllApplicationsNotSelected(),e.selectOneAplication(t,i)})),$("#selectAppLinkSelected",t).click((function(){e.hideSelectedProcessLabelWhenAllApplicationsNotSelected(),e.selectOneAplication(t,i)}))},showSelectedProcessLabelWhenAllApplicationsSelected:function(){var e=this.getContent();!0===this.processesTreeNew&&($("#allAppsLinkSelected",e).data("allAppSelected",!0),$("#searchInLabel",e).parent().parent().parent().show())},hideSelectedProcessLabelWhenAllApplicationsNotSelected:function(){var e=this.getContent();!0===this.processesTreeNew&&($("#allAppsLinkSelected",e).data("allAppSelected",!1),$("#searchInLabel",e).parent().parent().parent().hide())},changeRadioIcon:function(e,t){"all"==e?($("#allAppsLinkSelected",t).addClass("biz-wp-tree-selected-option"),$("#selectAppLinkSelected",t).removeClass("biz-wp-tree-selected-option"),$("#selectAppLinkSelected",t).addClass("biz-wp-tree-not-selected-option")):"one"==e&&($("#selectAppLinkSelected",t).addClass("biz-wp-tree-selected-option"),$("#allAppsLinkSelected",t).removeClass("biz-wp-tree-selected-option"),$("#allAppsLinkSelected",t).addClass("biz-wp-tree-not-selected-option"))},selectAllApplications:function(e){this.changeRadioIcon("all",e),$("#applicationsTree",e).removeClass("hidden"),$("#applicationsTree",e).css("display","none"),$("#searchInLabel",e).html(bizagi.localization.getResource("workportal-widget-processTree-all-applications")),this.treeRouteSelected=[]},selectOneAplication:function(e,t){var i=this;if($("#applicationsTree.hidden",e).length){var n=i.getTreeRouteSelected()[0];i.changeRadioIcon("one",e),$("#applicationsTree",e).removeClass("hidden");var a=$("a[data-id="+n+"]",e).closest("#applicationsTree > .case-search-app-ul > li.biz-wp-tree-node").siblings();return a.find("svg.bz-icon-arrow-down:not([style='display: none;'])").each((function(){i.expandOrCollapseArrows({expand:!1,itemSelected:$(this)[0]})})),a.find(".biz-wp-tree-list").empty(),!1}1!=i.params.byUser||i.params.userId&&""!=i.params.userId?$.when(i.dataService.getApplicationCategoriesList(t)).done((function(t){i.changeRadioIcon("one",e);var n=$.tmpl(i.applicationTreeTmpl,{type:t.type,items:t.items,svg:i.svgIconsMode});$("#applicationsTree",e).html(""),$("#applicationsTree",e).css("display","inline-block"),$("#applicationsTree",e).append(n),i.setTreeEvents(null,e)})).fail((function(e){bizagi.log(e)})):($("#applicationsTree",e).html(""),$("#applicationsTree",e).css("display","inline-block"),$("#applicationsTree",e).append("<strong>Debe Seleccionar un usuario</strong>"))},setTreeEvents:function(e,t){var i=this;$(".biz-wp-tree-process",t).click((function(){var e="",t=[],n="",a=this;for(i.treeRouteSelected=[],i.treeRouteSelected.push($(this)[0].getAttribute("data-id"));"app"!=e;)e=(a=$(a).closest(".biz-wp-tree-list").parent().find("label").first())[0].getAttribute("data-name"),t.push(a.html()),i.treeRouteSelected.push(a[0].getAttribute("data-id"));for(var s=t.length-1;s>=0;s--)n+=t[s]+" > ";n+=$(this).html(),i.treeRouteText=n,i.params.parentDef&&i.params.parentDef.resolve(),$(i.params.canvas).trigger("processSelected",1),$("#searchInLabel",i.params.canvas).html(n),!0===i.processesTreeNew&&$("#searchInLabel",i.params.canvas).parent().parent().parent().show(),$("#applicationsTree",i.params.canvas).addClass("hidden")})),$(".biz-wp-tree-expand-icon",t).click((function(){var t=this,n=Number(t.getAttribute("data-id")),a="";if($(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html(""),$("<b></b>").addClass($(t).attr("class")).hasClass("biz-wp-tree-expand-icon")){i.expandOrCollapseArrows({expand:!0,itemSelected:t}),null==e||"app"===t.getAttribute("name")?e=n:a=n;var s={action:"getCategories",idApp:e,idCategory:a,filterStartEvent:!1,authorizationContext:i.params.authorizationContext};i.params.userId&&(s.userId=i.params.userId),i.params.filterCaseSecurity&&(s.filterCaseSecurity=i.params.filterCaseSecurity),$.when(i.dataService.getApplicationCategoriesList(s)).done((function(n){var a=$.tmpl(i.applicationTreeTmpl,{type:n.type,items:n.processes,svg:i.svgIconsMode});$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(a),i.setTreeEvents(e,$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))})).fail((function(e){bizagi.log(e)}))}else i.expandOrCollapseArrows({expand:!1,itemSelected:t})}))},expandOrCollapseArrows:function(e){var t,i="";e.expand?((t=$(e.itemSelected)).attr("class",$("<b></b>").addClass(t.attr("class")).removeClass("biz-wp-tree-expand-icon").attr("class")),t.attr("class",$("<b></b>").addClass(t.attr("class")).addClass("biz-wp-tree-collapse-icon").attr("class")),this.svgIconsMode&&((i=$(e.itemSelected).parent().find(".bz-icon-arrow-down")).show(),i.attr("class",$("<b></b>").addClass(i.attr("class")).removeClass("biz-wp-tree-expand-icon").attr("class")),i.attr("class",$("<b></b>").addClass(i.attr("class")).addClass("biz-wp-tree-collapse-icon").attr("class")),t.hide())):((t=this.svgIconsMode?$(e.itemSelected).parent().find(".bz-icon-arrow-right"):$(e.itemSelected)).attr("class",$("<b></b>").addClass(t.attr("class")).removeClass("biz-wp-tree-collapse-icon").attr("class")),t.attr("class",$("<b></b>").addClass(t.attr("class")).addClass("biz-wp-tree-expand-icon").attr("class")),this.svgIconsMode&&(t.show(),(i=$(e.itemSelected)).hide(),i.attr("class",$("<b></b>").addClass(i.attr("class")).removeClass("biz-wp-tree-collapse-icon").attr("class")),i.attr("class",$("<b></b>").addClass(i.attr("class")).addClass("biz-wp-tree-expand-icon").attr("class"))))},getTreeRouteSelected:function(){return this.treeRouteSelected},getTreeRouteText:function(){return this.treeRouteText},setParamCanvas:function(e){this.params.canvas=e}}),bizagi.workportal.widgets.entitiestree.extend("bizagi.workportal.widgets.entitiestree",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"EntitiesTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree-wrapper"),"EntitiesTree.tree":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree"),useNewEngine:!1})},renderContent:function(){var e="";return this.params.canvas&&(e=this.content=$(this.params.canvas)),e},postRender:function(){this.loadtemplates(),this.setupData()},loadtemplates:function(){this.entitiesTreeTmpl=this.getTemplate("EntitiesTree.tree")},setupData:function(){this.treeRouteSelected=[],this.setupInitialData()},setupInitialData:function(){var e=this,t=e.getContent(),i={pathNodeType:"",idNode:"",nodeDisplayPath:"",nodePath:"",idWfClass:$("#processTypeList").val()};$.when(e.dataService.entityPathChildNodesAction(i)).done((function(i){var n=$.tmpl(e.entitiesTreeTmpl,{items:i.nodes});t.append(n),e.setTreeEvents(t)}))},setTreeEvents:function(e){var t=this;$(".selectable",e).click((function(){var e=!0,i=this;for(t.treeRouteSelected={},t.treeRouteSelected.name=$(i)[0].getAttribute("data-name-path"),t.treeRouteSelected.path=$(i)[0].getAttribute("data-path"),$(".selectable").removeClass("biz-wp-entities-tree-selected"),$(i).addClass("biz-wp-entities-tree-selected");e;)0==(i=$(i).closest(".biz-wp-tree-list").parent().find("a").first()).length?e=!1:(""!=i[0].getAttribute("data-name-path")&&(t.treeRouteSelected.name=i[0].getAttribute("data-name-path")+"."+t.treeRouteSelected.name),t.treeRouteSelected.path=i[0].getAttribute("data-path")+t.treeRouteSelected.path)})),$(".biz-wp-tree-expand-icon",e).click((function(e){var i=this,n=Number(i.getAttribute("data-id"));if($(i).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html(""),$(i).hasClass("biz-wp-tree-expand-icon")){$(i).removeClass("biz-wp-tree-expand-icon"),$(i).addClass("biz-wp-tree-collapse-icon");var a={nodeType:"",idNode:n,nodeDisplayPath:"",nodePath:"",idWfClass:$("#processTypeList").val()};$.when(t.dataService.entityPathChildNodesAction(a)).done((function(e){var n=$.tmpl(t.entitiesTreeTmpl,{items:e.nodes});$(i).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(n),t.setTreeEvents($(i).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))})).fail((function(e){bizagi.log(e)}))}else $(i).removeClass("biz-wp-tree-collapse-icon"),$(i).addClass("biz-wp-tree-expand-icon")}))},getTreeRouteSelected:function(){return this.treeRouteSelected}}),bizagi.workportal.widgets.userstable.extend("bizagi.workportal.widgets.userstable",{SELECTORS:{WRAPPER_LOADER:"#biz-wp-userstable-wrapperload",WRAPPER_LIST:"#biz-wp-userstable-wrapperlist"}},{init:function(e,t,i){this._super(e,t,i),this.filterData={},this.maxRows=8,this.maxPages=10,this.$canvas=i.canvas,this.showBackButton=i.showBackButton,this.users=[],this.totalPages=0,this.currentPage=1,this.orderType="ASC",this.orderField="",this.tableHeaders=[{displayName:this.getResource("workportal-widget-usertable-id"),fieldValue:"idUser"},{displayName:this.getResource("workportal-widget-usertable-user-name"),fieldValue:"userName"},{displayName:this.getResource("workportal-widget-usertable-full-name"),fieldValue:"fullName"},{displayName:this.getResource("workportal-widget-usertable-domain"),fieldValue:"domain"},{displayName:this.getResource("workportal-widget-usertable-email"),fieldValue:"contactEmail"},{displayName:this.getResource("workportal-widget-usertable-active-assign"),fieldValue:"enabledForAssignation"},{displayName:this.getResource("workportal-widget-usertable-active-column"),fieldValue:"enabled"}],this.loadTemplates({"usersTable.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-wrapper"),"usersTable.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-form"),"usersTable.table":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-table"),"usersTable.message":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-message"),useNewEngine:!1})},renderContent:function(){var e,t=this.getTemplate("usersTable.wrapper");return e=this.content=$.tmpl(t,{}),this.params.canvas&&(e=$(this.params.canvas).append(e)),e},postRender:function(){this.loadtemplates(),this.setupData()},loadtemplates:function(){this.usersTableFormTmpl=this.getTemplate("usersTable.form"),this.usersTableTmpl=this.getTemplate("usersTable.table"),this.usersTableMessage=this.getTemplate("usersTable.message")},_makeRequestOrganizationsList:function(){var e=this.params.widgetName===this.Class.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH,t=this.params.widgetName===this.Class.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE;return e||t?this.dataService.getOrganizationsForReassignCases():this.dataService.getOrganizationsList(!0)},setupData:function(){var e=this;$.when(e._makeRequestOrganizationsList()).done((function(t){var i=t.response,n=$.tmpl(e.usersTableFormTmpl,{orgList:i.length,showBackButton:e.showBackButton});$("#biz-wp-userstable-wrapperform",e.content).html(n),$("#btn-users-table-back",e.content).click((function(t){e.params.parentDef&&e.params.parentDef.resolve()})),i.length&&(i.unshift({displayName:"----------------",id:""}),e.setupOrgCombo(n,i)),e.setupEventsHandler(),void 0===e.$canvas&&(e.$canvas=e.content),e.$canvas.trigger("completeUserForm")})).fail((function(e){bizagi.log(e)}))},setupOrgCombo:function(e,t){e.find("#biz-wp-usertable-org").uicombo({data:{combo:t},initValue:t[0],itemValue:function(e){return e.id},itemText:function(e){return e.displayName}})},setupEventsHandler:function(){var e=this,t=e.getContent(),i=$("#biz-wp-userstable-wrapperform form",t);i.on("submit",(function(t){t.preventDefault(),void 0===e.afterSave?e.currentPage=1:(delete e.afterSave,e.currentPage=e.currentPage||1),e.orderType="ASC",e.orderField="",e.filterData={domain:this.elements[0].value,userName:this.elements[1].value,fullName:this.elements[2].value,organization:$(this.elements[3]).data("value"),pag:e.currentPage,pagSize:e.maxRows,orderField:e.orderField,orderType:e.orderType},e.getUsersTableData()})),i.on("reset",(function(e){e.preventDefault(),$(this.elements[3]).data("value","").val("----------------"),this.elements[0].value="",this.elements[1].value="",this.elements[2].value="",$("#biz-wp-userstable-wrapperlist",t).empty()}))},cleanForm:function(){var e=this.getContent();$("#biz-wp-userstable-wrapperform form",e).trigger("reset")},excecuteQuery:function(){content=this.getContent(),$("#biz-wp-userstable-wrapperform form",content).trigger("submit")},_loadingList:function(e){var t=this.Class.SELECTORS,i=$(t.WRAPPER_LIST,this.content),n=$(t.WRAPPER_LOADER,this.content);n.show(),i.hide(),e.always((function(){n.hide(),i.show()}))},_makeRequestGetUsers:function(e){var t=this;return function(){var e;switch(t.params.widgetName){case t.Class.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:case t.Class.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:e=t.dataService.getUsersForReassignCases;break;case t.Class.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:e=t.dataService.getUsersForAssignation;break;case t.Class.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:e=t.dataService.getUsersForDefaultAssignation;break;case t.Class.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:e=t.dataService.getUsersForUsersAdministration;break;case t.Class.BIZAGI_WORKPORTAL_WIDGET_QUERIES_MANAGEMENT:e=t.dataService.getUsersForQueriesPermissionManager;break;default:e=t.dataService.getUsersList}return e}().call(t.dataService,e)},getUsersTableData:function(e){var t=this;e=e||{};t.orderType=e.orderType||t.orderType,t.orderField=e.orderField||t.orderField;var i=t._makeRequestGetUsers($.extend(t.filterData,e));t._loadingList(i),$.when(i).done((function(e){t.fillUserInformation(e)})).fail((function(e){bizagi.log(e)}))},showUsersTable:function(){var e=$("#biz-wp-userstable-wrapperlist",this.content);if(e.empty(),this.users.length>0){var t=this.totalPages>1,i=this.getPagesArray(),n=this.params.userLinkLabel&&"[object Array]"===Object.prototype.toString.apply(this.params.userLinkLabel)?this.params.userLinkLabel:[this.params.userLinkLabel],a=$.tmpl(this.usersTableTmpl,{users:this.users,headers:this.tableHeaders,links:n,page:this.currentPage,pagination:t,pagesArray:i,orderField:this.orderField,orderType:this.orderType});e.html(a),this.setUpPagination(),this.setUpSortColumnLinks()}else{var s=bizagi.localization.getResource("workportal-widget-usertable-empty");e.html($.tmpl(this.usersTableMessage,{message:s}))}},getPagesArray:function(){for(var e=this.maxPages>this.totalPages?this.totalPages:this.maxPages,t=[],i=0;i<e;i++)t.push(i+1);return t},setUpPagination:function(){var e=this,t=$("#biz-wp-userstable-pager ul",e.content);t.bizagiPagination({maxElemShow:e.maxRows,totalPages:e.totalPages,actualPage:e.currentPage,listElement:t,clickCallBack:function(t){e.filterData.pag=e.currentPage=parseInt(t.page),e.getUsersTableData()}})},setUpSortColumnLinks:function(){var e=this;$(".biz-wp-table-head th",e.content).click((function(){var t=$(this).data("orderfield"),i=$(this).data("ordertype");e.getUsersTableData({orderType:i,orderField:t}),e.assignEventReassign()}))},assignEventReassign:function(){var e=this;$(".bizagi-wp-userstable-userlink",e.content).click((function(t){var i=this;if(e.params.parentDef){$.when(bizagi.util.autoSave()).done((function(){$(document).data("auto-save",""),e.params.parentDef.resolve(i.id,i.name,i.attributes.guid.value),e.params.widgetName==e.Class.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE&&bizagi.workportal.desktop.dialogStack.length>0&&bizagi.workportal.desktop.dialogStack[bizagi.workportal.desktop.dialogStack.length-1].dialogBox.on("dialogbeforeclose",(function(t,i){!0===e.resultStatus&&e.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}))})).fail((function(){e.params.data.closeDialogWidget()}))}else e.$canvas.trigger("clickUserLink",{id:this.id,name:this.name,fullName:this.getAttribute("fullname"),type:$(this).data("linkname")})}))},sortUsersTableByColumn:function(e,t,i){return bizagi.util.sortJSON(e,t,i)},fillUserInformation:function(e){this.users=e.users,this.totalPages=e.total,this.showUsersTable(),this.assignEventReassign()}}),bizagi.workportal.widgets.tree.extend("bizagi.workportal.widgets.tree",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"tree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-wrapper"),"tree.content":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-content"),useNewEngine:!1})},renderContent:function(){var e,t=this.getTemplate("tree.wrapper");return e=this.content=$.tmpl(t,{}),this.params.canvas&&(e=$(this.params.canvas).append(e)),e},postRender:function(){this.loadtemplates()},loadtemplates:function(){this.decisionTableContent=this.getTemplate("tree.content")}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entities",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES},init:function(e,t,i){this._super(e,t,i),this.loadTemplates({entities:bizagi.getTemplate("bizagi.workportal.desktop.widget.entities").concat("#ui-bizagi-workportal-widget-entities"),useNewEngine:!1})},renderContent:function(){var e=this,t=new $.Deferred,i=e.getTemplate("entities");return $.when(e.dataService.getAllAdministrableEntities()).done((function(n){var a=e.content=$.tmpl(i,n);$(".bz-wp-widget-entities li",a).click((function(){var t=$(this).data("entity-id"),i=$(this).data("entity-form");e.renderEntityData(a,t,i)})),t.resolve(a)})),t.promise()},renderStaticForm:function(e){var t=this,i=e.content,n=new bizagi.rendering.facade(e.context);e=e||{},$.extend(e,{canvas:i,customHandlers:{onGridAdd:function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:e.idForm,idEntity:e.idEntity,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(e){t.publish("closeCurrentDialog")}}})},onGridEdit:function(i){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:e.idForm,idEntity:e.idEntity,surrogateKey:i,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(i){t.publish("closeCurrentDialog"),t.renderEntityData(e.content,e.idEntity,e.idForm)}}})}}}),n.execute(e),i.bind("close",(function(){t.publish("closeCurrentDialog")}))},renderEntityData:function(e,t,i){var n=this;e.empty(),$.when(n.dataService.getEntitiesList({idEntity:t,page:1})).done((function(a){n.renderStaticForm({context:"entitymanagement",content:e,idEntity:t,idForm:i,data:a})}))}}),function($){$.widget("filter.bizagi_numberFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(e){},onClear:function(e){},setData:function(){}},_type:"number",_create:function(){this.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat")),this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var e="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";$(".wgd-my-search-filter-pluggin",this.element).append(e)}},_setReturnObject:function(){this.returnObject=[{properties:{xpath:this.options.properties.attribute+"@from",type:this._type,typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:this.options.properties.attribute+"@to",type:this._type,typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var e=this,t=e.options;$.contextMenu.types.contextMenuButtons=function(i,n,a){e.$menuContext=a.$menu;var s='<div class="ui-bizagi-filter-buttons">';s+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+t.getResource("workportal-general-button-label-cancel")+"</button>",s+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+t.getResource("workportal-general-button-label-apply")+"</button>",$(s+="<div>").appendTo(this).on("click","button",(function(){$(this).text()==t.getResource("workportal-general-button-label-apply")&&(e._setValue(),e._addFilterToDisplayName(),t.onApply(e.returnObject)),a.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var e=this,t=e.options,i=$(e.element),n="#"+$(".wgd-my-search-filter-pluggin",i).attr("id");i.on("click",(function(t){$(t.target).hasClass("remove-filter")&&$(".wgd-my-search-filter-pluggin .remove-filter",e.element).is(":visible")?e._removeFilter():$(n).contextMenu()}));var a={selector:n,trigger:"none",items:{key:{name:t.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return e._removeFilter(),!0}},min:{name:t.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-"+e._type+"-filter-min"},max:{name:t.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-"+e._type+"-filter-max"},notification:{name:t.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-"+e._type+"-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return $.when(e.options.setData()).done((function(i){var n=$('<input type="text">');e.options.data=void 0!==i?i:e.options.data,n.val(e.options.data.min),n.formatCurrency(e._getFormatOptions()),$(".ui-bizagi-"+e._type+"-filter-min span",e.$menuContext).html(t.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+n.val()+"</span>):"),n.val(e.options.data.max),n.formatCurrency(e._getFormatOptions()),$(".ui-bizagi-"+e._type+"-filter-max span",e.$menuContext).html(t.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+n.val()+"</span>):"),e._enableNotification(!1);var a=$(".ui-bizagi-"+e._type+"-filter-min .select-value",e.$menuContext),s=$(".ui-bizagi-"+e._type+"-filter-max .select-value",e.$menuContext);a.on("click",$.proxy(e._onClickMinValue,e)),s.on("click",$.proxy(e._onClickMaxValue,e))}))},hide:function(){e.removeHandlersValuesMinMax()}}};!0===e.options.showButtonClearFilter&&(a.items.key=void 0),i.contextMenu(a)},_bindTooltip:function(){var e=this;$(e.element).tooltip({items:"#"+$("div",e.element).attr("id"),content:function(){return e.filterValue}})},_setDisplayValue:function(){var e=void 0===this.returnObject[0].value?"":this.returnObject[0].value,t=void 0===this.returnObject[1].value?"":this.returnObject[1].value;$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(e),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(t),$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).formatCurrency(this._getFormatOptions()),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).formatCurrency(this._getFormatOptions())},_setFormatValue:function(e){var t=this._getObjectValueByString(e.val());0!==t&&(e.val(t),e.formatCurrency(this._getFormatOptions()))},_getObjectValueByString:function _getObjectValueByString(stringValue,asFloatType){var self=this,value=stringValue,regexString="/["+self.numericFormat.symbol+self.numericFormat.digitGroupSymbol+"]/g",regex=eval(regexString);return value=value.replace(regex,""),asFloatType&&(value=value.replace(",","."),value=parseFloat(value)),value},_addFilterToDisplayName:function(){var e=$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(),t=$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(),i=$(".wgd-my-search-filter-pluggin span",this.element),n=i.text().split(":");this.filterValue=e+" "+this.options.getResource("bz-rp-components-time-to-label")+" "+t,i.text(n[0]+": "+this.filterValue),$(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayNameToDefault:function(){var e=$(".wgd-my-search-filter-pluggin span",this.element),t=e.text().split(":");this.filterValue="",e.text(t[0])},_setValue:function(){var e=this._getObjectValueByString($(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(),!0),t=this._getObjectValueByString($(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(),!0);this.returnObject[0].value=""===e?t:e,this.returnObject[1].value=""===t?e:t},_resetValue:function(){this._setReturnObject(),$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(""),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val("")},_bindHandlers:function(){var e=this,t=e.options,i=$(".ui-bizagi-"+e._type+"-filter-min input",e.$menuContext),n=$(".ui-bizagi-"+e._type+"-filter-max input",e.$menuContext);i.keyup((function(){if($(this).val()){var i=e._getObjectValueByString($(".ui-bizagi-"+e._type+"-filter-max input",e.$menuContext).val(),!0),n=e._getObjectValueByString($(this).val(),!0),a=!!isNaN(n)||n<parseFloat(t.data.min),s=!!isNaN(i)||i>parseFloat(t.data.max),o=n>i;e._checkNotification(a,s,o),e._setFormatValue($(this))}})),n.keyup((function(){if($(this).val()){var i=e._getObjectValueByString($(this).val(),!0),n=e._getObjectValueByString($(".ui-bizagi-"+e._type+"-filter-min input",e.$menuContext).val(),!0),a=!!isNaN(n)||n<parseFloat(t.data.min),s=!!isNaN(i)||i>parseFloat(t.data.max),o=n>i;e._checkNotification(a,s,o),e._setFormatValue($(this))}}))},_onClickMinValue:function(e){var t=$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext);t.val($(e.target).text()),t.keyup()},_onClickMaxValue:function(e){var t=$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext);t.val($(e.target).text()),t.keyup()},_checkNotification:function(e,t,i){var n=this.options;if(i||e||t){var a=n.getResource("workportal-my-search-limit-notification");e?a=n.getResource("workportal-my-search-lower-limit-notification"):t?a=n.getResource("workportal-my-search-upper-limit-notification"):i&&(a=n.getResource("workportal-my-search-max-min-notification")),this._enableNotification(!0,a)}else this._disableNotification()},_enableNotification:function(e,t){e?($(".ui-bizagi-"+this._type+"-filter-notification span",this.$menuContext).text(t),$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).show()):$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).hide(),$("#ui-bizagi-apply-filter",this.$menuContext).attr("disabled","disabled"),$("#ui-bizagi-apply-filter",this.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).hide(),$("#ui-bizagi-apply-filter",this.$menuContext).removeAttr("disabled"),$("#ui-bizagi-apply-filter",this.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:this.numericFormat.digitGroupSymbol,decimalSymbol:this.numericFormat.decimalSymbol}},_removeFilter:function(){this._resetValue(),this._enableNotification(!1),this._setDisplayNameToDefault(),this.options.onClear([this.returnObject[0].properties.xpath,this.returnObject[1].properties.xpath]),$(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(e){this.options.data=0===Object.getOwnPropertyNames(e).length?this.options.data:e},removeHandlersValuesMinMax:function(){var e=$(".ui-bizagi-"+this._type+"-filter-min .select-value",this.$menuContext),t=$(".ui-bizagi-"+this._type+"-filter-max .select-value",this.$menuContext);e.off("click",$.proxy(this._onClickMinValue,this)),t.off("click",$.proxy(this._onClickMaxValue,this))},destroy:function(){this.removeHandlersValuesMinMax(),$(this.element).contextMenu("destroy"),$.Widget.prototype.destroy.call(this)}})}(jQuery),function(e){e.widget("filter.bizagi_moneyFilter",e.filter.bizagi_numberFilter,{_type:"money"})}(jQuery),function(e){e.widget("filter.bizagi_integerFilter",e.filter.bizagi_numberFilter,{_getFormatOptions:function(){return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:"",decimalSymbol:this.numericFormat.decimalSymbol}}})}(jQuery),function(e){e.widget("filter.bizagi_dateFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(e){},onClear:function(e){},setData:function(){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var t="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";e(".wgd-my-search-filter-pluggin",this.element).append(t)}},_setReturnObject:function(){var e=this.options.properties.attribute;this.returnObject=[{properties:{xpath:e+"@from",type:"date",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:e+"@to",type:"date",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;e.contextMenu.types.contextMenuButtons=function(n,a,s){t.$menuContext=s.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"</button>",e(o+="<div>").appendTo(this).on("click","button",(function(){e(this).text()==i.getResource("workportal-general-button-label-apply")&&(t._setValuesOfReturnObject(),t._setDisplayTitle(!1),i.onApply(t.returnObject,t.element)),s.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var t=this,i=t.options,n=e(t.element),a="#"+e(".wgd-my-search-filter-pluggin",n).attr("id");n.on("click",(function(i){e(i.target).hasClass("remove-filter")&&e(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():e(a).contextMenu()}));var s={selector:a,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},from:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-date-filter-from"},to:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-date-filter-to"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply(),t._setDisplayLabels()},hide:function(){t._getFromControl().datepicker("hide"),t._getToControl().datepicker("hide")}}};!0===t.options.showButtonClearFilter&&(s.items.key=void 0),n.contextMenu(s)},_bindTooltip:function(){var t=this;e(t.element).tooltip({items:"#"+e("div",t.element).attr("id"),content:function(){return t.filterValue}})},_bindHandlers:function(){var e=this,t=e._getFromControl(),i=e._getToControl(),n=new Date(e._getDateFromInvariant(e.options.properties.data.min)),a=new Date(e._getDateFromInvariant(e.options.properties.data.max)),s=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase();t.datepicker({defaultDate:n,dateFormat:s,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:n,maxDate:a,onClose:function(t){t?(i.datepicker("option","minDate",t),i.datepicker("getDate")&&e._enableApply()):e._disableApply()}}),i.datepicker({defaultDate:a,dateFormat:s,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:n,maxDate:a,onSelect:function(i){i?(t.datepicker("option","maxDate",i),t.datepicker("getDate")&&e._enableApply()):e._disableApply()}})},_resetValues:function(){this._getFromControl().datepicker("setDate",null),this._getToControl().datepicker("setDate",null),this._setReturnObject(),this._disableApply()},_setValuesOfReturnObject:function(){var e=this._getFromControl().datepicker("getDate"),t=this._getToControl().datepicker("getDate"),i=bizagi.util.dateFormatter;this.returnObject[0].value=null!==e?i.formatInvariant(e,!1):i.formatInvariant(t,!1),this.returnObject[1].value=null!==t?i.formatInvariant(t,!1):i.formatInvariant(e,!1)},_setDisplayTitle:function(t){var i=e(".wgd-my-search-filter-pluggin span",this.element),n=i.text().split(":");if(t)this.filterValue="",i.text(n[0]);else{var a=this.options,s=this._getDateFromInvariant(this.returnObject[0].value),o=this._getDateFromInvariant(this.returnObject[1].value);this.filterValue=this._formatDate(s,a.getResource("dateFormat"))+" "+a.getResource("bz-rp-components-time-to-label")+" "+this._formatDate(o,a.getResource("dateFormat")),i.text(n[0]+": "+this.filterValue)}e(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayLabels:function(){var t=this.options,i=this._getDateFromInvariant(this.options.properties.data.min),n=this._getDateFromInvariant(this.options.properties.data.max);e(".ui-bizagi-date-filter-from span",this.$menuContext).text(t.getResource("bz-rp-components-time-from-label")+" ("+this._formatDate(i,t.getResource("dateFormat"))+"):"),e(".ui-bizagi-date-filter-to span",this.$menuContext).text(t.getResource("bz-rp-components-time-to-label")+" ("+this._formatDate(n,t.getResource("dateFormat"))+"):")},_enableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.removeAttr("disabled"),t.removeClass("ui-state-disabled")},_disableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.attr("disabled","disabled"),t.addClass("ui-state-disabled")},_formatDate:function(e,t){return bizagi.util.dateFormatter.formatDate(e,t)},_getFromControl:function(){return e(".ui-bizagi-date-filter-from input",this.$menuContext)},_getToControl:function(){return e(".ui-bizagi-date-filter-to input",this.$menuContext)},_getDateFromInvariant:function(e){return bizagi.util.dateFormatter.getDateFromInvariant(e)},_removeFilter:function(){this.options.onClear([this.returnObject[0].properties.xpath,this.returnObject[1].properties.xpath]),this._setDisplayTitle(!0),this._resetValues(),e(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(e){this.options.properties.data=0===Object.getOwnPropertyNames(e).length?this.options.properties.data:e;var t=this._getFromControl(),i=this._getToControl(),n=new Date(this._getDateFromInvariant(this.options.properties.data.min)),a=new Date(this._getDateFromInvariant(this.options.properties.data.max));t.datepicker("option","minDate",n),t.datepicker("option","maxDate",a),i.datepicker("option","minDate",n),i.datepicker("option","maxDate",a)},destroy:function(){e(this.element).contextMenu("destroy"),e.Widget.prototype.destroy.call(this)}})}(jQuery),function(e){e.widget("filter.bizagi_textFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(e){},onClear:function(e){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var t="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";e(".wgd-my-search-filter-pluggin",this.element).append(t)}},_bindContextMenuButtons:function(){var t=this,i=t.options;e.contextMenu.types.contextMenuButtons=function(n,a,s){t.$menuContext=s.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"</button>",e(o+="<div>").appendTo(this).on("click","button",(function(){e(this).text()==i.getResource("workportal-general-button-label-apply")&&(t._setValue(),t._setFilterToDisplayName(),i.onApply(t.returnObject,t.element)),s.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var t=this,i=t.options,n=e(".wgd-my-search-filter-pluggin",t.element),a="#"+n.attr("id");n.on("click",(function(i){e(i.target).hasClass("remove-filter")&&e(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():e(a).contextMenu()}));var s={selector:a,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:i.getResource("workportal-my-search-text"),type:"text",className:"ui-bizagi-text-filter"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply()},hide:function(){}}};!0===t.options.showButtonClearFilter&&(s.items.key=void 0),e(t.element).contextMenu(s)},_getTextControl:function(){return e(".ui-bizagi-text-filter input",this.$menuContext)},_bindHandlers:function(){var t=this;t._getTextControl().keyup((function(){e(this).val()&&0!=e(this).val().indexOf(" ")?t._enableApply():t._disableApply()}))},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"text",typeSearch:"approx"}}},_resetValue:function(){this._setReturnObject(),this._disableApply(),this._getTextControl().val("")},_setValue:function(){var e=this._getTextControl().val();e&&(this.returnObject.value=e)},_enableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.removeAttr("disabled"),t.removeClass("ui-state-disabled")},_disableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.attr("disabled","disabled"),t.addClass("ui-state-disabled")},_setFilterToDisplayName:function(){var t=e(".wgd-my-search-filter-pluggin span",this.element),i=t.text().split(":");t.text(i[0]+": "+this.returnObject.value),e(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayNameToDefault:function(){var t=e(".wgd-my-search-filter-pluggin span",this.element),i=t.text().split(":");t.text(i[0])},_removeFilter:function(){this._resetValue();var t=[this.returnObject.properties.xpath];this._setDisplayNameToDefault(),this.options.onClear(t),e(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(e){console.log(e)},destroy:function(){e(this.element).contextMenu("destroy"),e.Widget.prototype.destroy.call(this)}})}(jQuery),function(e){e.widget("filter.bizagi_multipleFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(e){},onClear:function(e){},setData:function(){}},_create:function(){this.isDefaultFilter=!1,this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindDefaultFilter()},_bindDefaultFilter:function(){for(var t,i=this.options.data||[],n=": ",a=-1;t=i.defaultValues[++a];)t.applied&&(this.isDefaultFilter=!0,this.returnObject.value.push({id:t.id}),n+=t.displayName);if(this.isDefaultFilter){var s=e(".wgd-my-search-filter-pluggin span",this.element),o=s.text().split(":");s.text(o[0]+n)}},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var t="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";e(".wgd-my-search-filter-pluggin",this.element).append(t)}},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"entity",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;e.contextMenu.types.container=function(t,i,n){e('<div id="'+t.id+'" class="menu-container"></div>').appendTo(this)},e.contextMenu.types.contextMenuButtons=function(n,a,s){t.$menuContext=s.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"</button>",e(o+="<div>").appendTo(this).on("click","button",(function(){e(this).text()==i.getResource("workportal-general-button-label-apply")&&(t._addFilterToDisplayName(),i.onApply([t.returnObject])),s.$menu.trigger("contextmenu:hide")}))}},_buildContextMenuItems:function(){var e=this,t=e.options,i={};return!0!==e.options.showButtonClearFilter&&(i.key={name:t.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return e._removeFilter(),!0}}),i.container={id:"checks_container_"+t.properties.attribute.replaceAll(".","_"),type:"container"},i.buttons={type:"contextMenuButtons"},i},_bindContextMenu:function(){var t=this,i=t.options,n=e(t.element),a="#"+e(".wgd-my-search-filter-pluggin",n).attr("id"),s=t._buildContextMenuItems();n.click((function(i){e(i.target).hasClass("remove-filter")&&e(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():e(a).contextMenu()})),n.contextMenu({selector:a,className:"context-menu-list-checks-container",trigger:"none",items:s,events:{show:function(){var n=e("#checks_container_"+i.properties.attribute.replaceAll(".","_"),t.$menuContext);return t._disableApply(),n.empty(),n.addClass("checks_container_overflow"),e.when(i.setData()).done((function(e){e=void 0!==e?e.defaultValues:i.data.defaultValues;for(var a,s=-1;a=e[++s];){var o=t.returnObject.value.find((function(e){return e.id==a.id}))||a.applied?"checked":"";if(""!=a.id&&""!=a.displayName&&(!t.isDefaultFilter||t.isDefaultFilter&&"checked"===o)){var r="<li class='checks_container_children'>";r+="<input data-displayname='"+a.displayName+"' type='checkbox' value='"+a.id+"' "+o+">",r+="<span class='context-menu-item-label-check'>"+a.displayName+"</span>",r+="</li>",n.append(r)}}t._bindHandlers()}))},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[],e(t.element).tooltip({items:"#"+e("div",t.element).attr("id"),content:function(){if(0!==t.filterValue.length){var i=e("<div>");return e.each(t.filterValue,(function(t,n){i.append(e("<div><label>"+n+"</label></div>"))})),i}return""}})},_bindHandlers:function(){var t=this;e("input:checkbox",t.$menuContext).on("click",(function(i){i.stopImmediatePropagation();var n=e(i.target),a=n.attr("value");if(n.is(":checked"))t.returnObject.value.push({id:a}),t._enableApply();else{var s=t.returnObject.value.find((function(e){return e.id==a}));s&&t.returnObject.value.splice(t.returnObject.value.indexOf(s),1),0===t.returnObject.value.length?t._disableApply():t._enableApply()}}))},_resetValue:function(){this.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,i=e(".wgd-my-search-filter-pluggin span",t.element),n=i.text().split(":")[0]+": ",a=t.returnObject.value.length;t.filterValue=[],e("input:checked",t.$menuContext).each((function(){a--,t.filterValue.push(e(this).data("displayname")),n=n+e(this).data("displayname")+(0==a?"":", ")})),i.text(n),e(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=e(".wgd-my-search-filter-pluggin span",this.element),i=t.text().split(":");this.isDefaultFilter=!1,this.filterValue=[],t.text(i[0])},_enableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.removeAttr("disabled"),t.removeClass("ui-state-disabled")},_disableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.attr("disabled","disabled"),t.addClass("ui-state-disabled")},_removeFilter:function(){this.options.onClear([this.returnObject.properties.xpath]),this._setDisplayNameToDefault(),this._resetValue(),e(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(e){this.options.data=0===Object.getOwnPropertyNames(e).length?this.options.data:e},destroy:function(){e(this.element).contextMenu("destroy"),e.Widget.prototype.destroy.call(this)}})}(jQuery),function(e){e.widget("filter.bizagi_booleanFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(e){},onClear:function(e){},setData:function(){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var t="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";e(".wgd-my-search-filter-pluggin",this.element).append(t)}},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"boolean",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;e.contextMenu.types.container=function(t,i,n){e('<div id="'+t.id+'" class="menu-container"></div>').appendTo(this)},e.contextMenu.types.contextMenuButtons=function(n,a,s){t.$menuContext=s.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"</button>",e(o+="<div>").appendTo(this).on("click","button",(function(){e(this).text()==i.getResource("workportal-general-button-label-apply")&&(t._addFilterToDisplayName(),i.onApply([t.returnObject],t.element)),s.$menu.trigger("contextmenu:hide")}))}},_buildContextMenuItems:function(){var e=this,t=e.options,i={};return!0!==e.options.showButtonClearFilter&&(i.key={name:t.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return e._removeFilter(),!0}}),i.container={id:"checks_container",type:"container"},i.buttons={type:"contextMenuButtons"},i},_bindContextMenu:function(){var t=this,i=e(t.element),n="#"+e(".wgd-my-search-filter-pluggin",i).attr("id"),a=t._buildContextMenuItems();i.on("click",(function(i){e(i.target).hasClass("remove-filter")&&e(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():e(n).contextMenu()})),i.contextMenu({selector:n,trigger:"none",items:a,events:{show:function(){t._disableApply();var i=e("#checks_container",t.$menuContext);return i.empty(),e.when(t.options.setData()).done((function(e){e=void 0!==e?e.defaultValues:t.options.data.defaultValues;for(var n,a=-1;n=e[++a];){var s=t.returnObject.value===n.id;""!=n.id&&""!=n.displayName&&i.append('<li><input data-displayname="'+n.displayName+'" type="radio" name="boolFilter" value="'+n.id+'" '+(s?"checked":"")+'><span class="context-menu-item-label-check">'+t.parseBoolean(n.displayName)+"</span></li>")}t._bindHandlers()}))},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[],e(t.element).tooltip({items:"#"+e("div",t.element).attr("id"),content:function(){if(0!==t.filterValue.length){var i=e("<div>");return e.each(t.filterValue,(function(n,a){i.append(e("<div><label>"+t.parseBoolean(a)+"</label></div>"))})),i}return""}})},parseBoolean:function(e){var t=bizagi.clone(e);switch(0===t&&(t="0"),1===t&&(t="1"),t.toLowerCase||(t=t.toString()),t.toLowerCase()){case"not specified":t=bizagi.localization.getResource("workportal-general-value-undefined");break;default:t=bizagi.util.formatBoolean(t)}return t},_bindHandlers:function(){var t=this;e("input:radio",t.$menuContext).on("click",(function(i){i.stopImmediatePropagation();var n=e(i.target);t.returnObject.value=n.attr("value"),t._enableApply()}))},_resetValue:function(){this.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,i=e(".wgd-my-search-filter-pluggin span",t.element),n=i.text().split(":")[0]+": ";t.filterValue=[],e("input:checked",t.$menuContext).each((function(){t.filterValue.push(e(this).data("displayname")),n+=t.parseBoolean(e(this).data("displayname"))})),i.text(n),e(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=e(".wgd-my-search-filter-pluggin span",this.element),i=t.text().split(":");this.filterValue=[],t.text(i[0])},_enableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.removeAttr("disabled"),t.removeClass("ui-state-disabled")},_disableApply:function(){var t=e("#ui-bizagi-apply-filter",this.$menuContext);t.attr("disabled","disabled"),t.addClass("ui-state-disabled")},_removeFilter:function(){var t=this.returnObject.properties.xpath;this.options.onClear([t]),this._setDisplayNameToDefault(),this._resetValue(),e(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(e){this.options.data=0===Object.getOwnPropertyNames(e).length?this.options.data:e},destroy:function(){e(this.element).contextMenu("destroy"),e.Widget.prototype.destroy.call(this)}})}(jQuery),bizagi.workportal.widgets.async.extend("bizagi.workportal.widgets.async",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({async:bizagi.getTemplate("bizagi.workportal.desktop.widget.async"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent();$(".ui-bizagi-wp-async-goToInbox a",t).click((function(){e.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}))}});
//# sourceMappingURL=../../../../Maps/desktop/bizagicontrols.desktop.production.js.map
