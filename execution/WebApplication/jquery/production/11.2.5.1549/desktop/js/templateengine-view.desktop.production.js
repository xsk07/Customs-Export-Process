!function(t){t.widget("filter.bizagi_multipleFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(t){},onClear:function(t){},setData:function(){}},_create:function(){this.isDefaultFilter=!1,this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindDefaultFilter()},_bindDefaultFilter:function(){for(var e,i=this.options.data||[],n=": ",a=-1;e=i.defaultValues[++a];)e.applied&&(this.isDefaultFilter=!0,this.returnObject.value.push({id:e.id}),n+=e.displayName);if(this.isDefaultFilter){var r=t(".wgd-my-search-filter-pluggin span",this.element),o=r.text().split(":");r.text(o[0]+n)}},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var e="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";t(".wgd-my-search-filter-pluggin",this.element).append(e)}},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"entity",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var e=this,i=e.options;t.contextMenu.types.container=function(e,i,n){t('<div id="'+e.id+'" class="menu-container"></div>').appendTo(this)},t.contextMenu.types.contextMenuButtons=function(n,a,r){e.$menuContext=r.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"</button>",t(o+="<div>").appendTo(this).on("click","button",(function(){t(this).text()==i.getResource("workportal-general-button-label-apply")&&(e._addFilterToDisplayName(),i.onApply([e.returnObject])),r.$menu.trigger("contextmenu:hide")}))}},_buildContextMenuItems:function(){var t=this,e=t.options,i={};return!0!==t.options.showButtonClearFilter&&(i.key={name:e.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),i.container={id:"checks_container_"+e.properties.attribute.replaceAll(".","_"),type:"container"},i.buttons={type:"contextMenuButtons"},i},_bindContextMenu:function(){var e=this,i=e.options,n=t(e.element),a="#"+t(".wgd-my-search-filter-pluggin",n).attr("id"),r=e._buildContextMenuItems();n.click((function(i){t(i.target).hasClass("remove-filter")&&t(".wgd-my-search-filter-pluggin .remove-filter",e.element).is(":visible")?e._removeFilter():t(a).contextMenu()})),n.contextMenu({selector:a,className:"context-menu-list-checks-container",trigger:"none",items:r,events:{show:function(){var n=t("#checks_container_"+i.properties.attribute.replaceAll(".","_"),e.$menuContext);return e._disableApply(),n.empty(),n.addClass("checks_container_overflow"),t.when(i.setData()).done((function(t){t=void 0!==t?t.defaultValues:i.data.defaultValues;for(var a,r=-1;a=t[++r];){var o=e.returnObject.value.find((function(t){return t.id==a.id}))||a.applied?"checked":"";if(""!=a.id&&""!=a.displayName&&(!e.isDefaultFilter||e.isDefaultFilter&&"checked"===o)){var s="<li class='checks_container_children'>";s+="<input data-displayname='"+a.displayName+"' type='checkbox' value='"+a.id+"' "+o+">",s+="<span class='context-menu-item-label-check'>"+a.displayName+"</span>",s+="</li>",n.append(s)}}e._bindHandlers()}))},hide:function(){}}})},_bindTooltip:function(){var e=this;e.filterValue=e.filterValue||[],t(e.element).tooltip({items:"#"+t("div",e.element).attr("id"),content:function(){if(0!==e.filterValue.length){var i=t("<div>");return t.each(e.filterValue,(function(e,n){i.append(t("<div><label>"+n+"</label></div>"))})),i}return""}})},_bindHandlers:function(){var e=this;t("input:checkbox",e.$menuContext).on("click",(function(i){i.stopImmediatePropagation();var n=t(i.target),a=n.attr("value");if(n.is(":checked"))e.returnObject.value.push({id:a}),e._enableApply();else{var r=e.returnObject.value.find((function(t){return t.id==a}));r&&e.returnObject.value.splice(e.returnObject.value.indexOf(r),1),0===e.returnObject.value.length?e._disableApply():e._enableApply()}}))},_resetValue:function(){this.returnObject.value=[]},_addFilterToDisplayName:function(){var e=this,i=t(".wgd-my-search-filter-pluggin span",e.element),n=i.text().split(":")[0]+": ",a=e.returnObject.value.length;e.filterValue=[],t("input:checked",e.$menuContext).each((function(){a--,e.filterValue.push(t(this).data("displayname")),n=n+t(this).data("displayname")+(0==a?"":", ")})),i.text(n),t(".wgd-my-search-filter-pluggin .remove-filter",e.element).show()},_setDisplayNameToDefault:function(){var e=t(".wgd-my-search-filter-pluggin span",this.element),i=e.text().split(":");this.isDefaultFilter=!1,this.filterValue=[],e.text(i[0])},_enableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.removeAttr("disabled"),e.removeClass("ui-state-disabled")},_disableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.attr("disabled","disabled"),e.addClass("ui-state-disabled")},_removeFilter:function(){this.options.onClear([this.returnObject.properties.xpath]),this._setDisplayNameToDefault(),this._resetValue(),t(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(t){this.options.data=0===Object.getOwnPropertyNames(t).length?this.options.data:t},destroy:function(){t(this.element).contextMenu("destroy"),t.Widget.prototype.destroy.call(this)}})}(jQuery),function($){$.widget("filter.bizagi_numberFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(t){},onClear:function(t){},setData:function(){}},_type:"number",_create:function(){this.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat")),this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var t="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";$(".wgd-my-search-filter-pluggin",this.element).append(t)}},_setReturnObject:function(){this.returnObject=[{properties:{xpath:this.options.properties.attribute+"@from",type:this._type,typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:this.options.properties.attribute+"@to",type:this._type,typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,e=t.options;$.contextMenu.types.contextMenuButtons=function(i,n,a){t.$menuContext=a.$menu;var r='<div class="ui-bizagi-filter-buttons">';r+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+e.getResource("workportal-general-button-label-cancel")+"</button>",r+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+e.getResource("workportal-general-button-label-apply")+"</button>",$(r+="<div>").appendTo(this).on("click","button",(function(){$(this).text()==e.getResource("workportal-general-button-label-apply")&&(t._setValue(),t._addFilterToDisplayName(),e.onApply(t.returnObject)),a.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var t=this,e=t.options,i=$(t.element),n="#"+$(".wgd-my-search-filter-pluggin",i).attr("id");i.on("click",(function(e){$(e.target).hasClass("remove-filter")&&$(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():$(n).contextMenu()}));var a={selector:n,trigger:"none",items:{key:{name:e.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:e.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-"+t._type+"-filter-min"},max:{name:e.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-"+t._type+"-filter-max"},notification:{name:e.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-"+t._type+"-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return $.when(t.options.setData()).done((function(i){var n=$('<input type="text">');t.options.data=void 0!==i?i:t.options.data,n.val(t.options.data.min),n.formatCurrency(t._getFormatOptions()),$(".ui-bizagi-"+t._type+"-filter-min span",t.$menuContext).html(e.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+n.val()+"</span>):"),n.val(t.options.data.max),n.formatCurrency(t._getFormatOptions()),$(".ui-bizagi-"+t._type+"-filter-max span",t.$menuContext).html(e.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+n.val()+"</span>):"),t._enableNotification(!1);var a=$(".ui-bizagi-"+t._type+"-filter-min .select-value",t.$menuContext),r=$(".ui-bizagi-"+t._type+"-filter-max .select-value",t.$menuContext);a.on("click",$.proxy(t._onClickMinValue,t)),r.on("click",$.proxy(t._onClickMaxValue,t))}))},hide:function(){t.removeHandlersValuesMinMax()}}};!0===t.options.showButtonClearFilter&&(a.items.key=void 0),i.contextMenu(a)},_bindTooltip:function(){var t=this;$(t.element).tooltip({items:"#"+$("div",t.element).attr("id"),content:function(){return t.filterValue}})},_setDisplayValue:function(){var t=void 0===this.returnObject[0].value?"":this.returnObject[0].value,e=void 0===this.returnObject[1].value?"":this.returnObject[1].value;$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(t),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(e),$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).formatCurrency(this._getFormatOptions()),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).formatCurrency(this._getFormatOptions())},_setFormatValue:function(t){var e=this._getObjectValueByString(t.val());0!==e&&(t.val(e),t.formatCurrency(this._getFormatOptions()))},_getObjectValueByString:function _getObjectValueByString(stringValue,asFloatType){var self=this,value=stringValue,regexString="/["+self.numericFormat.symbol+self.numericFormat.digitGroupSymbol+"]/g",regex=eval(regexString);return value=value.replace(regex,""),asFloatType&&(value=value.replace(",","."),value=parseFloat(value)),value},_addFilterToDisplayName:function(){var t=$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(),e=$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(),i=$(".wgd-my-search-filter-pluggin span",this.element),n=i.text().split(":");this.filterValue=t+" "+this.options.getResource("bz-rp-components-time-to-label")+" "+e,i.text(n[0]+": "+this.filterValue),$(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayNameToDefault:function(){var t=$(".wgd-my-search-filter-pluggin span",this.element),e=t.text().split(":");this.filterValue="",t.text(e[0])},_setValue:function(){var t=this._getObjectValueByString($(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(),!0),e=this._getObjectValueByString($(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val(),!0);this.returnObject[0].value=""===t?e:t,this.returnObject[1].value=""===e?t:e},_resetValue:function(){this._setReturnObject(),$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext).val(""),$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext).val("")},_bindHandlers:function(){var t=this,e=t.options,i=$(".ui-bizagi-"+t._type+"-filter-min input",t.$menuContext),n=$(".ui-bizagi-"+t._type+"-filter-max input",t.$menuContext);i.keyup((function(){if($(this).val()){var i=t._getObjectValueByString($(".ui-bizagi-"+t._type+"-filter-max input",t.$menuContext).val(),!0),n=t._getObjectValueByString($(this).val(),!0),a=!!isNaN(n)||n<parseFloat(e.data.min),r=!!isNaN(i)||i>parseFloat(e.data.max),o=n>i;t._checkNotification(a,r,o),t._setFormatValue($(this))}})),n.keyup((function(){if($(this).val()){var i=t._getObjectValueByString($(this).val(),!0),n=t._getObjectValueByString($(".ui-bizagi-"+t._type+"-filter-min input",t.$menuContext).val(),!0),a=!!isNaN(n)||n<parseFloat(e.data.min),r=!!isNaN(i)||i>parseFloat(e.data.max),o=n>i;t._checkNotification(a,r,o),t._setFormatValue($(this))}}))},_onClickMinValue:function(t){var e=$(".ui-bizagi-"+this._type+"-filter-min input",this.$menuContext);e.val($(t.target).text()),e.keyup()},_onClickMaxValue:function(t){var e=$(".ui-bizagi-"+this._type+"-filter-max input",this.$menuContext);e.val($(t.target).text()),e.keyup()},_checkNotification:function(t,e,i){var n=this.options;if(i||t||e){var a=n.getResource("workportal-my-search-limit-notification");t?a=n.getResource("workportal-my-search-lower-limit-notification"):e?a=n.getResource("workportal-my-search-upper-limit-notification"):i&&(a=n.getResource("workportal-my-search-max-min-notification")),this._enableNotification(!0,a)}else this._disableNotification()},_enableNotification:function(t,e){t?($(".ui-bizagi-"+this._type+"-filter-notification span",this.$menuContext).text(e),$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).show()):$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).hide(),$("#ui-bizagi-apply-filter",this.$menuContext).attr("disabled","disabled"),$("#ui-bizagi-apply-filter",this.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){$(".ui-bizagi-"+this._type+"-filter-notification",this.$menuContext).hide(),$("#ui-bizagi-apply-filter",this.$menuContext).removeAttr("disabled"),$("#ui-bizagi-apply-filter",this.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:this.numericFormat.digitGroupSymbol,decimalSymbol:this.numericFormat.decimalSymbol}},_removeFilter:function(){this._resetValue(),this._enableNotification(!1),this._setDisplayNameToDefault(),this.options.onClear([this.returnObject[0].properties.xpath,this.returnObject[1].properties.xpath]),$(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(t){this.options.data=0===Object.getOwnPropertyNames(t).length?this.options.data:t},removeHandlersValuesMinMax:function(){var t=$(".ui-bizagi-"+this._type+"-filter-min .select-value",this.$menuContext),e=$(".ui-bizagi-"+this._type+"-filter-max .select-value",this.$menuContext);t.off("click",$.proxy(this._onClickMinValue,this)),e.off("click",$.proxy(this._onClickMaxValue,this))},destroy:function(){this.removeHandlersValuesMinMax(),$(this.element).contextMenu("destroy"),$.Widget.prototype.destroy.call(this)}})}(jQuery),function(t){t.widget("filter.bizagi_moneyFilter",t.filter.bizagi_numberFilter,{_type:"money"})}(jQuery),function(t){t.widget("filter.bizagi_integerFilter",t.filter.bizagi_numberFilter,{_getFormatOptions:function(){return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:"",decimalSymbol:this.numericFormat.decimalSymbol}}})}(jQuery),function(t){t.widget("filter.bizagi_dateFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(t){},onClear:function(t){},setData:function(){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var e="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";t(".wgd-my-search-filter-pluggin",this.element).append(e)}},_setReturnObject:function(){var t=this.options.properties.attribute;this.returnObject=[{properties:{xpath:t+"@from",type:"date",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:t+"@to",type:"date",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var e=this,i=e.options;t.contextMenu.types.contextMenuButtons=function(n,a,r){e.$menuContext=r.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"</button>",t(o+="<div>").appendTo(this).on("click","button",(function(){t(this).text()==i.getResource("workportal-general-button-label-apply")&&(e._setValuesOfReturnObject(),e._setDisplayTitle(!1),i.onApply(e.returnObject,e.element)),r.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var e=this,i=e.options,n=t(e.element),a="#"+t(".wgd-my-search-filter-pluggin",n).attr("id");n.on("click",(function(i){t(i.target).hasClass("remove-filter")&&t(".wgd-my-search-filter-pluggin .remove-filter",e.element).is(":visible")?e._removeFilter():t(a).contextMenu()}));var r={selector:a,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return e._removeFilter(),!0}},from:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-date-filter-from"},to:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-date-filter-to"},buttons:{type:"contextMenuButtons"}},events:{show:function(){e._disableApply(),e._setDisplayLabels()},hide:function(){e._getFromControl().datepicker("hide"),e._getToControl().datepicker("hide")}}};!0===e.options.showButtonClearFilter&&(r.items.key=void 0),n.contextMenu(r)},_bindTooltip:function(){var e=this;t(e.element).tooltip({items:"#"+t("div",e.element).attr("id"),content:function(){return e.filterValue}})},_bindHandlers:function(){var t=this,e=t._getFromControl(),i=t._getToControl(),n=new Date(t._getDateFromInvariant(t.options.properties.data.min)),a=new Date(t._getDateFromInvariant(t.options.properties.data.max)),r=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase();e.datepicker({defaultDate:n,dateFormat:r,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:n,maxDate:a,onClose:function(e){e?(i.datepicker("option","minDate",e),i.datepicker("getDate")&&t._enableApply()):t._disableApply()}}),i.datepicker({defaultDate:a,dateFormat:r,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:n,maxDate:a,onSelect:function(i){i?(e.datepicker("option","maxDate",i),e.datepicker("getDate")&&t._enableApply()):t._disableApply()}})},_resetValues:function(){this._getFromControl().datepicker("setDate",null),this._getToControl().datepicker("setDate",null),this._setReturnObject(),this._disableApply()},_setValuesOfReturnObject:function(){var t=this._getFromControl().datepicker("getDate"),e=this._getToControl().datepicker("getDate"),i=bizagi.util.dateFormatter;this.returnObject[0].value=null!==t?i.formatInvariant(t,!1):i.formatInvariant(e,!1),this.returnObject[1].value=null!==e?i.formatInvariant(e,!1):i.formatInvariant(t,!1)},_setDisplayTitle:function(e){var i=t(".wgd-my-search-filter-pluggin span",this.element),n=i.text().split(":");if(e)this.filterValue="",i.text(n[0]);else{var a=this.options,r=this._getDateFromInvariant(this.returnObject[0].value),o=this._getDateFromInvariant(this.returnObject[1].value);this.filterValue=this._formatDate(r,a.getResource("dateFormat"))+" "+a.getResource("bz-rp-components-time-to-label")+" "+this._formatDate(o,a.getResource("dateFormat")),i.text(n[0]+": "+this.filterValue)}t(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayLabels:function(){var e=this.options,i=this._getDateFromInvariant(this.options.properties.data.min),n=this._getDateFromInvariant(this.options.properties.data.max);t(".ui-bizagi-date-filter-from span",this.$menuContext).text(e.getResource("bz-rp-components-time-from-label")+" ("+this._formatDate(i,e.getResource("dateFormat"))+"):"),t(".ui-bizagi-date-filter-to span",this.$menuContext).text(e.getResource("bz-rp-components-time-to-label")+" ("+this._formatDate(n,e.getResource("dateFormat"))+"):")},_enableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.removeAttr("disabled"),e.removeClass("ui-state-disabled")},_disableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.attr("disabled","disabled"),e.addClass("ui-state-disabled")},_formatDate:function(t,e){return bizagi.util.dateFormatter.formatDate(t,e)},_getFromControl:function(){return t(".ui-bizagi-date-filter-from input",this.$menuContext)},_getToControl:function(){return t(".ui-bizagi-date-filter-to input",this.$menuContext)},_getDateFromInvariant:function(t){return bizagi.util.dateFormatter.getDateFromInvariant(t)},_removeFilter:function(){this.options.onClear([this.returnObject[0].properties.xpath,this.returnObject[1].properties.xpath]),this._setDisplayTitle(!0),this._resetValues(),t(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(t){this.options.properties.data=0===Object.getOwnPropertyNames(t).length?this.options.properties.data:t;var e=this._getFromControl(),i=this._getToControl(),n=new Date(this._getDateFromInvariant(this.options.properties.data.min)),a=new Date(this._getDateFromInvariant(this.options.properties.data.max));e.datepicker("option","minDate",n),e.datepicker("option","maxDate",a),i.datepicker("option","minDate",n),i.datepicker("option","maxDate",a)},destroy:function(){t(this.element).contextMenu("destroy"),t.Widget.prototype.destroy.call(this)}})}(jQuery),function(t){t.widget("filter.bizagi_textFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(t){},onClear:function(t){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindHandlers()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var e="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";t(".wgd-my-search-filter-pluggin",this.element).append(e)}},_bindContextMenuButtons:function(){var e=this,i=e.options;t.contextMenu.types.contextMenuButtons=function(n,a,r){e.$menuContext=r.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"</button>",t(o+="<div>").appendTo(this).on("click","button",(function(){t(this).text()==i.getResource("workportal-general-button-label-apply")&&(e._setValue(),e._setFilterToDisplayName(),i.onApply(e.returnObject,e.element)),r.$menu.trigger("contextmenu:hide")}))}},_bindContextMenu:function(){var e=this,i=e.options,n=t(".wgd-my-search-filter-pluggin",e.element),a="#"+n.attr("id");n.on("click",(function(i){t(i.target).hasClass("remove-filter")&&t(".wgd-my-search-filter-pluggin .remove-filter",e.element).is(":visible")?e._removeFilter():t(a).contextMenu()}));var r={selector:a,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return e._removeFilter(),!0}},min:{name:i.getResource("workportal-my-search-text"),type:"text",className:"ui-bizagi-text-filter"},buttons:{type:"contextMenuButtons"}},events:{show:function(){e._disableApply()},hide:function(){}}};!0===e.options.showButtonClearFilter&&(r.items.key=void 0),t(e.element).contextMenu(r)},_getTextControl:function(){return t(".ui-bizagi-text-filter input",this.$menuContext)},_bindHandlers:function(){var e=this;e._getTextControl().keyup((function(){t(this).val()&&0!=t(this).val().indexOf(" ")?e._enableApply():e._disableApply()}))},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"text",typeSearch:"approx"}}},_resetValue:function(){this._setReturnObject(),this._disableApply(),this._getTextControl().val("")},_setValue:function(){var t=this._getTextControl().val();t&&(this.returnObject.value=t)},_enableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.removeAttr("disabled"),e.removeClass("ui-state-disabled")},_disableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.attr("disabled","disabled"),e.addClass("ui-state-disabled")},_setFilterToDisplayName:function(){var e=t(".wgd-my-search-filter-pluggin span",this.element),i=e.text().split(":");e.text(i[0]+": "+this.returnObject.value),t(".wgd-my-search-filter-pluggin .remove-filter",this.element).show()},_setDisplayNameToDefault:function(){var e=t(".wgd-my-search-filter-pluggin span",this.element),i=e.text().split(":");e.text(i[0])},_removeFilter:function(){this._resetValue();var e=[this.returnObject.properties.xpath];this._setDisplayNameToDefault(),this.options.onClear(e),t(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(t){console.log(t)},destroy:function(){t(this.element).contextMenu("destroy"),t.Widget.prototype.destroy.call(this)}})}(jQuery),function(t){t.widget("filter.bizagi_booleanFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(t){},onClear:function(t){},setData:function(){}},_create:function(){this._addButtonClearFilter(),this._setReturnObject(),this._bindContextMenuButtons(),this._bindContextMenu(),this._bindTooltip()},_addButtonClearFilter:function(){if(this.options.showButtonClearFilter){var e="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'></i>";t(".wgd-my-search-filter-pluggin",this.element).append(e)}},_setReturnObject:function(){this.returnObject={properties:{xpath:this.options.properties.attribute,type:"boolean",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var e=this,i=e.options;t.contextMenu.types.container=function(e,i,n){t('<div id="'+e.id+'" class="menu-container"></div>').appendTo(this)},t.contextMenu.types.contextMenuButtons=function(n,a,r){e.$menuContext=r.$menu;var o='<div class="ui-bizagi-filter-buttons">';o+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"</button>",o+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"</button>",t(o+="<div>").appendTo(this).on("click","button",(function(){t(this).text()==i.getResource("workportal-general-button-label-apply")&&(e._addFilterToDisplayName(),i.onApply([e.returnObject],e.element)),r.$menu.trigger("contextmenu:hide")}))}},_buildContextMenuItems:function(){var t=this,e=t.options,i={};return!0!==t.options.showButtonClearFilter&&(i.key={name:e.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),i.container={id:"checks_container",type:"container"},i.buttons={type:"contextMenuButtons"},i},_bindContextMenu:function(){var e=this,i=t(e.element),n="#"+t(".wgd-my-search-filter-pluggin",i).attr("id"),a=e._buildContextMenuItems();i.on("click",(function(i){t(i.target).hasClass("remove-filter")&&t(".wgd-my-search-filter-pluggin .remove-filter",e.element).is(":visible")?e._removeFilter():t(n).contextMenu()})),i.contextMenu({selector:n,trigger:"none",items:a,events:{show:function(){e._disableApply();var i=t("#checks_container",e.$menuContext);return i.empty(),t.when(e.options.setData()).done((function(t){t=void 0!==t?t.defaultValues:e.options.data.defaultValues;for(var n,a=-1;n=t[++a];){var r=e.returnObject.value===n.id;""!=n.id&&""!=n.displayName&&i.append('<li><input data-displayname="'+n.displayName+'" type="radio" name="boolFilter" value="'+n.id+'" '+(r?"checked":"")+'><span class="context-menu-item-label-check">'+e.parseBoolean(n.displayName)+"</span></li>")}e._bindHandlers()}))},hide:function(){}}})},_bindTooltip:function(){var e=this;e.filterValue=e.filterValue||[],t(e.element).tooltip({items:"#"+t("div",e.element).attr("id"),content:function(){if(0!==e.filterValue.length){var i=t("<div>");return t.each(e.filterValue,(function(n,a){i.append(t("<div><label>"+e.parseBoolean(a)+"</label></div>"))})),i}return""}})},parseBoolean:function(t){var e=bizagi.clone(t);switch(0===e&&(e="0"),1===e&&(e="1"),e.toLowerCase||(e=e.toString()),e.toLowerCase()){case"not specified":e=bizagi.localization.getResource("workportal-general-value-undefined");break;default:e=bizagi.util.formatBoolean(e)}return e},_bindHandlers:function(){var e=this;t("input:radio",e.$menuContext).on("click",(function(i){i.stopImmediatePropagation();var n=t(i.target);e.returnObject.value=n.attr("value"),e._enableApply()}))},_resetValue:function(){this.returnObject.value=[]},_addFilterToDisplayName:function(){var e=this,i=t(".wgd-my-search-filter-pluggin span",e.element),n=i.text().split(":")[0]+": ";e.filterValue=[],t("input:checked",e.$menuContext).each((function(){e.filterValue.push(t(this).data("displayname")),n+=e.parseBoolean(t(this).data("displayname"))})),i.text(n),t(".wgd-my-search-filter-pluggin .remove-filter",e.element).show()},_setDisplayNameToDefault:function(){var e=t(".wgd-my-search-filter-pluggin span",this.element),i=e.text().split(":");this.filterValue=[],e.text(i[0])},_enableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.removeAttr("disabled"),e.removeClass("ui-state-disabled")},_disableApply:function(){var e=t("#ui-bizagi-apply-filter",this.$menuContext);e.attr("disabled","disabled"),e.addClass("ui-state-disabled")},_removeFilter:function(){var e=this.returnObject.properties.xpath;this.options.onClear([e]),this._setDisplayNameToDefault(),this._resetValue(),t(".wgd-my-search-filter-pluggin .remove-filter",this.element).hide()},setData:function(t){this.options.data=0===Object.getOwnPropertyNames(t).length?this.options.data:t},destroy:function(){t(this.element).contextMenu("destroy"),t.Widget.prototype.destroy.call(this)}})}(jQuery),function(t){t.fn.bizagiSearchUser=function(e){var i=this,n={},a=[],r=1,o=0,s={},l=(e=e||{}).editingUser;if(void 0===e.renderFactoryReference)throw"The renderFactoryReference property is required";if(void 0===e.getResourceReference)throw"The getResourceReference property is required";var c={init:function(){c.bindElements()},bindElements:function(){i.click((function(){c.openUploadDialog()}))},openUploadDialog:function(){window.document;var i=this.dialogBox=t("<div class='ui-bizagi-component-search-user'/>");s=i.dialog({width:950,maximize:!1,resize:!1,draggable:!1,height:650,title:e.title,modal:!0}),c.showFilters(),c.showButtons(),c.addHandlers();var n=c.setDefaultParams();c._loadResultsTemplate(n.usersResults,n.currentPage,n.pagination,n.pagesArray)},setDefaultParams:function(){return{usersResults:[],currentPage:-1,pagination:!1,pagesArray:[]}},showFilters:function(){var i=t("<div id='filtersContainer' class='filters-container clearfix'></div>");t.each(e.filters,(function(n,a){t(i,s).append("<div class='filters-row clearfix'><div class='filters-cell'><span>"+e.displayNames[n]+"</span></div><div class='filters-cell'><input id="+a+" type='text'> </input></div></div>")})),i.appendTo(s)},showButtons:function(){var i=t("<div id='buttonsContainer'class='biz-wp-buttonset'></div>");if(t(i,s).append("<button id='btnSearchUsers' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+e.searchButtonName+"</span></button>"),t(i,s).append("<button id='btnClear' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+e.clearButtonName+"</span></button>"),e.allowAddUser){var n="<button id='btnNew' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+bizagi.localization.getResource("workportal-widget-admin-user-profiles-button-label-newUserProfiles")+"</span></button>";t(i,s).append(n),i.appendTo(s),t("#btnNew",s).bizagiCreateUser(e.dataService,e.renderFactory,{canvas:t(s),onCreate:e.selectItem(),onCancel:function(){t(s).dialog("option","title",e.title),t(s).empty(),c.showFilters(),c.showButtons(),c.addHandlers()}})}else i.appendTo(s)},addHandlers:function(){return t("#btnSearchUsers",s).click((function(){c.getUsersTableData()})),t("#btnClear",s).click((function(){c.clickClearPluginValues()})),this},clickClearPluginValues:function(){t.each(e.filters,(function(e,i){t("#"+i,s).val("")})),t("#searchResults",s).remove()},getUsersTableData:function(){c.updateFiltersInformation();var i=e.searchUsers(n);this._loadingList(i),t.when(i).done((function(t){Array.isArray(t.users)?(a=t.users,o=t.total,c.showUsersTable()):bizagi.showMessageBox(t.message,t.status,"","warning")})).fail((function(t){e.showError(t)}))},updateFiltersInformation:function(){t.each(e.filters,(function(e,i){n[i]=t("#"+i,s).val()})),n.pag=r,n.pagSize=9,void 0!==l&&""!==l&&(n.editingUser=l)},showUsersTable:function(){if(a.length>0){var i=o>1,n=c.getPagesArray();t("#biz-wp-wrapperload",s).remove(),t("#searchResults",s).remove();var l=c._loadResultsTemplate(a,r,i,n);t(s).append(l),c.addTableHandlers(),c.setUpPagination()}else e.showMessageBox("workportal-widget-usertable-empty"),t("#searchResults",s).hide()},_loadResultsTemplate:function(i,n,a,r){var o=e.renderFactoryReference.getTemplate("bizagi.plugin.search.user"),l=t.tmpl(o,{users:i,links:[e.getResourceReference("render-plugin-search-users-select-link")],page:n,pagination:a,pagesArray:this.getPagesArray});return t(s).append(l),0===i.length&&t("#searchResults",s).hide(),l},addTableHandlers:function(){t("table :button",s).click((function(){var i=t(this),n={};t.each(e.valuesToSelect,(function(t,e){n[e]=i.data(e)})),e.selectItem().resolve(n),s.remove()}))},getPagesArray:function(){for(var t=10>o?o:10,e=[],i=0;i<t;i++)e.push(i+1);return e},setUpPagination:function(){var e=this,i=t("#biz-wp-userstable-pager ul",s);i.bizagiPagination({maxElemShow:9,totalPages:o,actualPage:r,listElement:i,clickCallBack:function(t){n.pag=r=parseInt(t.page),e.getUsersTableData()}})},_loadingList:function(e){var i=t("#biz-wp-wrapperload",s),n=t("#searchResults",s);i.show(),n.hide(),e.always((function(){i.hide(),n.show()}))}};return c.init(),c}}(jQuery),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.paginator",{},{init:function(t,e,i){this._super(t,e,i),this.loadTemplates({paginator:bizagi.getTemplate("bizagi.workportal.desktop.widget.paginator").concat("#paginator-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.paginator").concat("#paginator-content")})},renderContent:function(){var t="ENTITY"===this.params.referenceType,e=this.getTemplate("paginator"+this.getSuffixWidget());return this.content=e.render({hide:t}),this.content},postRender:function(){this.sub("PAGINATOR-UPDATE",$.proxy(this.updateView,this)),this.configureHandlers()},getSuffixWidget:function(){return""},updateView:function(t,e){var i=this,n=e.args,a="ENTITY"===n.referenceType,r=i.getContent();function o(){i.getTemplate("content"+i.getSuffixWidget()).render({totalRecords:i.totalRecords,totalPages:i.totalPages,displayName:i.displayName,currentPage:i.currentPage,hide:a}).appendTo(r)}i.setModel(n),r.empty(),n.fromActionLauncher?i.totalRecords>1?o():i.clean():o()},setModel:function(t){this.totalRecords=void 0===t.totalRecords?this.totalRecords:t.totalRecords,this.totalPages=t.totalPages||this.totalPages,this.displayName=t.histName||this.displayName,this.currentPage=t.currentPage||this.currentPage,this.action=t.action,this.reference=t.reference||this.reference,this.surrogateKey=t.surrogateKey||this.surrogateKey,this.referenceType=t.referenceType,this.event=t.event,this.guidSearch=t.guidSearch},getModel:function(){return{page:this.currentPage,totalRecords:this.totalRecords,action:this.action,reference:this.reference,surrogateKey:this.surrogateKey,referenceType:this.referenceType,stopNavigation:!0,guidSearch:this.guidSearch}},configureHandlers:function(){this.getContent().on("click",$.proxy(this.onPageBreak,this))},onPageBreak:function(t){var e=$(t.target),i=this.getContent();if(e.hasClass("control-icon")&&!e.hasClass("ui-state-disabled")){var n=e.data("type");"forward"==n?this.currentPage+=1:"rewind"==n?this.currentPage-=1:this.currentPage="fastrewind"==n?1:this.totalPages,this.disabledPaginatorButtonsByLimits(),i.find(".paginator-controls__currentPage").text(this.currentPage),this.pub("notify",{type:"UPDATE-DATATEMPLATE-VIEW",args:this.getModel()})}},disabledPaginatorButtonsByLimits:function(){var t=$("[data-type='fastrewind']",this.content),e=$("[data-type='rewind']",this.content),i=$("[data-type='forward']",this.content),n=$("[data-type='fastforward']",this.content);1===this.totalPages?(t.addClass("ui-state-disabled"),e.addClass("ui-state-disabled"),i.addClass("ui-state-disabled"),n.addClass("ui-state-disabled")):1===this.currentPage?(t.addClass("ui-state-disabled"),e.addClass("ui-state-disabled"),i.removeClass("ui-state-disabled"),n.removeClass("ui-state-disabled")):this.currentPage===this.totalPages?(t.removeClass("ui-state-disabled"),e.removeClass("ui-state-disabled"),i.addClass("ui-state-disabled"),n.addClass("ui-state-disabled")):(t.removeClass("ui-state-disabled"),e.removeClass("ui-state-disabled"),i.removeClass("ui-state-disabled"),n.removeClass("ui-state-disabled"))},calculateNewPage:function(t,e,i){var n=(e=e||10)*i-e+1,a=Math.ceil(n/t);return a||1},clean:function(){var t=this.getContent();t&&t.empty()}}),bizagi.injector.register("bizagi.workportal.widgets.paginator",["workportalFacade","dataService",bizagi.workportal.widgets.paginator]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sortbar",{},{init:function(t,e,i,n,a){this._super(t,e,a),this.loadTemplates({sortbar:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content"),"right-content":bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-right"),addButton:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content-add-button"),sortMenu:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-sort-menu"),actions:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content-actions"),recordsPerPage:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-records-per-page"),recordsMenu:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-records-menu")}),this.processActionService=i,this.accumulatedcontext=n},renderContent:function(){var t=this.getTemplate("sortbar");return this.content=t.render({enableFilter:!0}),this.$checkAll=this.content.find(".sortbar-left-check-uncheck input"),this.content},postRender:function(){var t=this.getTemplate("right-content");this.setVisibleSortbar(!0),this.configureHandlers(),$(".sortbar-right",this.content).append(t.render()),this.configureAfterPaintHandlers()},configureHandlers:function(){var t=this,e=t.getContent();t.sub("TEMPLATEENGINE-VIEW",$.proxy(t.initializeAndProcessFilterButton,t)),t.sub("SEARCH-ENGINE-VIEW",$.proxy(t.initializeAndProcessFilterButton,t)),t.sub("SET-FILTERS-DATA",$.proxy(t.setFiltersSortData,t)),t.sub("HIDE-FILTER-BUTTONANDBAR",$.proxy(t.hideFilterButtonAndBar,t)),t.sub("HIDE-SORT-BUTTONS",$.proxy(t.hideSortButtons,t)),t.sub("ENABLE-BATCHS-ACTIONS",(function(e,i){return t.enableBatchActions(i)})),t.sub("UPDATE-COUNTER-FILTERS-APPLIED",(function(e,i){return t.updateCounterByFilterApplied(i)})),t.sub("CASES-TEMPLATE-VIEW",(function(e,i){t.showingFiltering=!1,t.setVisibleCheckAll(!1)})),t.sub("SOME-ITEM-ALLOW-SELECT",(function(e,i){t.setVisibleCheckAll(!0)})),t.sub("HIDE-CHECK-ALL",(function(e,i){t.setVisibleCheckAll(!1)})),t.sub("BATCH-ACTIONS",(function(e,i){return t.validActions(i.args.actionsData)})),e.find(".wgd-sortbar-add-button").tooltip(),t.$checkAll.on("click",$.proxy(t.onCheckUncheck,t))},configureAfterPaintHandlers:function(){var t=this,e=t.getContent();e.find(".right-menu").on("click",(function(e){t.showSortMenu(e,$(this))})),e.find(".records-menu").on("click",(function(e){t.showRecordsMenu(e,$(this))})),e.find(".sortbar-az").on("click",(function(){t.sortSelection.attribute&&(t.setIconSortType($(this),t._sortType),t.pub("notify",{type:"SET-ORDERBY",args:{properties:{xpath:t.sortSelection.attribute,orderType:t._sortType,typeSearch:"none"}}}))})),e.find(".filter-icon").on("click",(function(){t.pub("notify",{type:"OPENCLOSE-MYSEARCHFILTER",args:{guidSearch:t.params.guidSearch,target:$(this)}})})),$(".remove-selected-items-collections",e).on("click",$.proxy(t.onRemoveSelectedItemsCollections,t))},setVisibleSortbar:function(t){var e=this.getContent();t?e.show():e.hide()},setVisibleCheckAll:function(t){t?(this.$checkAll.closest(".border-check-uncheck").show(),this.showingCheckAll=!0):(this.$checkAll.closest(".border-check-uncheck").hide(),this.showingCheckAll=!1)},showSelectedItems:function(t){if(t&&t>0){this.content.addClass("there-are-actions");var e=this.getResource("workportal-general-word-selected-singular");t>1&&(e=this.getResource("workportal-general-word-selected-plural")),$(".actions-count-selected",this.content).text(t+" "+e+" ")}else this.content.removeClass("there-are-actions")},setIconSortType:function(t,e){"asc"===e?(this._sortType="desc",t.removeClass("bz-icon-order-ascendant-outline").addClass("bz-icon-order-descendant-outline")):(this._sortType="asc",t.removeClass("bz-icon-order-descendant-outline").addClass("bz-icon-order-ascendant-outline"))},onClickBatchAction:function(t){var e=this,i=$(t.target).closest("li"),n=i.data("guid"),a=e.getAction(n);e.requestsInProgressActionGuid[n]||(e.requestsInProgressActionGuid[n]=!0,e.addLoadingButtonAction(i),$.when(e.processActionService.executeBatchAction({action:a,commonActionsmodel:e.commonActionsmodel})).always((function(){e.quitLoadingButtonAction(i),e.requestsInProgressActionGuid[n]=void 0})))},addLoadingButtonAction:function(t){t.find(".wdg-tple-button").addClass("state-loading"),t.find(".wdg-tple-button").prepend('<div class="ui-bizagi-loading-icon ui-bizagi-loading-button"></div>').find("i").hide()},quitLoadingButtonAction:function(t){t.find(".wdg-tple-button").removeClass("state-loading"),t.find(".ui-bizagi-loading-button").remove(),t.find("i").show()},onRemoveSelectedItemsCollections:function(){var t=this.pub("notify",{type:"SET-VALUES",args:{value:!1}})[0];this.enableBatchActions({args:{commonActions:t}})},showSortMenu:function(t,e){var i=this,n=i.getContent(),a=i.getTemplate("sortMenu").render({filters:i._filters},{displayValue:function(t){return t}});$(".sortbar-box-menu",e).length&&$(".sortbar-box-menu",e).remove(),e.append(a),a.show("fast",(function(){a.click((function(t){t.stopPropagation()})),$(document).one("click",(function(){a.hide("fast"),a.remove()}))})),n.find(".sortbar-option").on("click",(function(t){var r=$(t.currentTarget).data(),o=i._filters[r.index];n.find(".sortbar-az").removeClass("disabled"),i.sortSelection!=o&&(i.sortSelection=o,$(".sortbar-selected",e).text(i.sortSelection.display.split(".").pop()),i.pub("notify",{type:"SET-ORDERBY",args:{properties:{xpath:o.attribute,orderType:i._sortType,typeSearch:"none"}}})),a.hide("fast")}))},showRecordsMenu:function(t,e){var i=this,n=i.getContent(),a=i.getTemplate("recordsMenu").render({});$(".sortbar-records-box-menu",e).length&&$(".sortbar-records-box-menu",e).remove(),e.append(a),a.show("fast",(function(){a.click((function(t){t.stopPropagation()})),$(document).one("click",(function(){a.hide("fast"),a.remove()}))})),n.find(".sortbar-records-option").on("click",(function(t){i.oldPageSize=i.oldPageSize?i.oldPageSize:10;var n=Number(bizagi.util.trim(this.textContent)),r=bizagi.injector.get("bizagi.workportal.widgets.paginator"),o=r.currentPage?r.currentPage:1,s=r.calculateNewPage(n,i.oldPageSize,o);$(".sortbar-records-selected",e).text(n),i.pub("notify",{type:"SET-RECORDS",args:{pageSize:n,page:s}}),i.oldPageSize=n,a.hide("fast")}))},initializeAndProcessFilterButton:function(t,e){this.showingFiltering=!1,this.setVisibleCheckAll(!1),this.restoreOrderSelected(),this.setIconSortType($(".sortbar-az",this.content),"desc"),this.params=e.args,this.sortSelection={},this.processAddButton(t,e)},processAddButton:function(t,e){var i=this,n=i.getContent(),a=e.args,r=a.action,o=n.find(".sortbar-left .add-button");i._lastReferenceEntity=a.reference,o.children().remove(),$(".wrapper-sortbar-actions",n).remove(),i._haveAddButton=!1,a.reference&&"ENTITY"!==a.referenceType?(o.startLoading({delay:0,overlay:!0}),i.dataService.getProcessAddAction(e).done((function(t){i._lastReferenceEntity===t.referenceEntity&&void 0!==t&&Object.getOwnPropertyNames(t).length>1&&t.guidEntity&&t.id&&i.renderButton(o,t)})).always((function(){o.endLoading()}))):r&&i.renderButton(o,r)},renderButton:function(t,e){var i=this,n=i.getTemplate("addButton").render({action:e});t.empty(),n.appendTo(t),i._haveAddButton=!0,n.on("click",(function(){i.clickAddButton(e)}))},clickAddButton:function(t){var e=this;$.when(e.dataService.getMapping({guidEntity:t.guidEntity,accumulatedContext:e.accumulatedcontext.getContext({}),xpathContext:"Process"===t.type?t.xpathContext:"",collectionId:t.referenceEntity,collectionType:t.referenceType})).done((function(i){"Process"===t.type?e.onExecuteProcess(t,i):e.onExecuteForm(t,i)}))},onCheckUncheck:function(t){var e=$(t.target).is(":checked"),i=this.pub("notify",{type:"SET-VALUES",args:{value:e}})[0];this.enableBatchActions({args:{commonActions:i}})},enableBatchActions:function(t){var e=t.args,i=this.commonActionsmodel=e.commonActions,n=this.validActions(i.actions);(n.length>0||this._haveAddButton)&&$(this.getContent()).show(),this.showBatchActions(n,i,"batchAction"),void 0!==i.checkAll&&this.$checkAll.prop("checked",i.checkAll)},showBatchActions:function(t,e,i){var n=this,a=n.getContent(),r=n.getTemplate("actions");n.showSelectedItems(Object.keys(e.itemsSelected).length);var o=t.slice(3,9999),s=r.render({actions:t.slice(0,3),moreActions:o,typeActions:i});$(".wdg-tple-button.batchAction",n.content).off("click",$.proxy(n.onClickBatchAction,n)),$(".wrapper-sortbar-actions",a).remove(),$(".sortbar-left .sortbar-menu",a).append(s),$(".wdg-tple-button.batchAction",n.content).on("click",$.proxy(n.onClickBatchAction,n)),o.length>0&&(n.content.data("ui-tooltip")&&$(n.content).tooltip("destroy"),$(n.content).tooltip({tooltipClass:"sortbar-tooltip-more-actions",items:".bz-actions-showmore",content:$(".template-box-tooltip",n.content).html(),open:function(t,e){$(".wdg-tple-button.batchAction",e.tooltip).on("click",$.proxy(n.onClickBatchAction,n));var i=$("div.ui-tooltip");if(void 0===t.originalEvent)return i.remove(),!1;var a=$(e.tooltip).attr("id");for(var r in i.not("#"+a).remove(),n.requestsInProgressActionGuid)if(n.requestsInProgressActionGuid[r]){var o=$("li[data-guid='"+r+"']",e.tooltip);n.addLoadingButtonAction(o)}$("li[id='emptyLi0']").focus((function(){$("div.bz-actions-showmore.ellipsis-icon")[0].focus(),$("ul[class='actions-container'] li:nth-child(3")[0].focus()})),$("li[id='emptyLi1']").focus((function(){$("div.bz-actions-showmore.ellipsis-icon")[0].focus(),$("a.remove-selected-items-collections")[0].focus()})),$("li",e.tooltip)[1].focus()},close:function(t,e){e.tooltip.hover((function(){$(this).stop(!0).fadeTo(400,1)}),(function(){$(this).fadeOut("400",(function(){$(".wdg-tple-button.batchAction",this).off("click",$.proxy(n.onClickBatchAction,n)),$(this).remove()}))}))}}))},setFiltersSortData:function(t,e){var i=e.args.filtersAppliedCounter,n=e.args.totalRecords;if(this._filters=e.args.calculateFilters?e.args.filters:this._filters,e.args.calculateFilters){for(var a,r=-1,o=0,s=0;a=this._filters[++r];)"Text"!=a.type&&"Link"!==a.type&&a.data&&(a.data.defaultValues&&a.data.defaultValues.length>0||a.data.min&&a.data.max)&&o++,""!==a.display&&s++;n>0?(o>0?this.showFilterButton():this.hideFilterButton(),s>0?this.showSortButtons():this.hideSortButtons()):0===i&&(this.hideFilterButton(),this.hideSortButtons())}this.updateCounter(i)},showFilterButton:function(){$(".filter-icon",this.getContent()).show()},hideFilterButton:function(){$(".filter-icon",this.getContent()).hide(),this.showingFiltering=!1},showSortButtons:function(){$(".sortbar-text",this.getContent()).show(),$(".sortbar-icon",this.getContent()).show(),$(".sortbar-az",this.getContent()).show(),this.showingSorting=!0,this.showingFiltering=!0},hideSortButtons:function(){var t=$(".sortbar-az",this.getContent());$(".sortbar-text",this.getContent()).hide(),t.addClass("disabled"),t.removeClass("bz-icon-order-ascendant-outline"),t.removeClass("bz-icon-order-descendant-outline"),t.addClass("bz-icon-order-ascendant-outline"),t.hide(),this.showingSorting=!1},restoreOrderSelected:function(){$(".sortbar-selected",this.getContent()).text(this.getResource("workportal-my-search-order-by"))},updateCounterByFilterApplied:function(t){t.args.filtersApplied&&this.updateCounter(t.args.filtersApplied.length)},updateCounter:function(t){var e=this.getContent(),i=$(".counter-filters-applied",e);t>0?(i.html(t),i.show()):i.hide()},hideFilterButtonAndBar:function(){this.showingFilter=!1,$(".filter-icon",this.getContent()).hide(),this.pub("notify",{type:"CLOSE-MYSEARCHFILTER",args:{show:!1,$target:null}})},onExecuteProcess:function(t,e){var i=this;t.startForm&&(t.hasStartForm=t.startForm),$.when(i.processActionService.executeProcessAction({action:t,mappingData:e})).done((function(e){(e=e||{})&&!1!==e.refreshTemplateData&&i.loadTemplateData(t)}))},loadTemplateData:function(t){this.pub("notify",{type:"TEMPLATEENGINE-VIEW",args:{action:t,isRefresh:!0}})},onExecuteForm:function(t,e){var i=this;$.when(i.processActionService.executeFormAction({action:t,mappingData:e})).done((function(e){e.refresh&&i.pub("notify",{type:"UPDATE-DATATEMPLATE-VIEW",args:{action:t,isRefresh:!0,calculateFilters:!0}})}))},getAction:function(t){return this.commonActionsmodel.actions.filter((function(e){return e.id==t}))[0]},validActions:function(t){return $.grep(t,(function(t){return 2==t.multiplicity||"Collection"!=t.mode&&("Form"!=t.type&&(!t.isEvent&&("Process"!=t.type||!t.hasStartForm)))}))},clean:function(){var t=this.getContent();this.requestsInProgressActionGuid={},t&&(this.unsub("TEMPLATEENGINE-VIEW"),this.unsub("ENABLE-BATCHS-ACTIONS"),this.unsub("SEARCH-ENGINE-VIEW"),this.unsub("SET-FILTERS-DATA"),this.unsub("HIDE-FILTER-BUTTONANDBAR"),this.unsub("HIDE-SORT-BUTTONS"),this.$checkAll.off("click"),t.find(".right-menu").off("click"),t.find(".sortbar-az").off("click"),t.find(".filter-icon").off("click"),t.find(".sortbar-action").off("click"),$(".wdg-tple-button.batchAction",t).off("click",$.proxy(this.onClickBatchAction,this)),$(".remove-selected-items-collections",t).off("click",$.proxy(this.onRemoveSelectedItemsCollections,this)))}}),bizagi.injector.register("bizagi.workportal.widgets.sortbar",["workportalFacade","dataService","processActionService","accumulatedcontext",bizagi.workportal.widgets.sortbar]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.mysearchfilter",{init:function(t,e,i,n){var a=this;a.params={},a._super(t,e,n),a.loadTemplates({mysearchfilter:bizagi.getTemplate("bizagi.workportal.desktop.widget.mysearchfilter").concat("#mysearchfilter-wrapper"),"mysearchfilter-item":bizagi.getTemplate("bizagi.workportal.desktop.widget.mysearchfilter").concat("#mysearchfilter-item")}).done((function(){a.filterItem=a.getTemplate("mysearchfilter-item")})),a.processActionService=i,a.filtersApplied=[],a.filters=[]},renderContent:function(){return this.content=this.getTemplate("mysearchfilter").render({}),this.content.hide(),this.content},postRender:function(){this.configureHandlers()},initializeMySearchFilter:function(t,e){var i=this.getContent();this.criteriaSearchApplied=e.args.filters?bizagi.clone(e.args.filters):[],this.filtersApplied=[],this.filterControlArray=[],this.orderBy={},$(".mysearchfilter-list",i).empty()},configureHandlers:function(){this.sub("TEMPLATEENGINE-VIEW",$.proxy(this.initializeMySearchFilter,this)),this.sub("SEARCH-ENGINE-VIEW",$.proxy(this.initializeMySearchFilter,this)),this.sub("OPENCLOSE-MYSEARCHFILTER",$.proxy(this.toggleWidget,this)),this.sub("CLOSE-MYSEARCHFILTER",$.proxy(this.openCloseWidget,this)),this.sub("SET-FILTERS-DATA",$.proxy(this.setFiltersData,this)),this.sub("SET-ORDERBY",$.proxy(this.setOrderBy,this)),this.sub("SET-RECORDS",$.proxy(this.setRecordsPerPage,this))},setFiltersData:function(t,e){if(e.args.defaultFilterApplied){e.args.filtersApplied=e.args.filtersApplied||[];var i=e.args.filtersApplied.filter((function(t){return void 0!==t.properties}));this.filtersApplied=i}if(e.args.calculateFilters){for(var n=this.getContent(),a=$(".mysearchfilter-list",n),r=e.args.filters,o=e.args.filtersAppliedCounter,s=-1,l=0;u=r[++s];)if("Text"!=u.type&&"Link"!==u.type&&u.data&&(u.data.defaultValues&&u.data.defaultValues.length>0||u.data.min&&u.data.max)){l++;break}if(0===e.args.totalRecords&&0===o?this.openCloseWidget({show:!1}):0===l?this.openCloseWidget({show:!1}):this.openCloseWidget({show:!0}),this.filterControlArray&&0===this.filterControlArray.length)for(s=-1;u=r[++s];){u.tmplid=u.attribute.replaceAll(".","-"),this.filtersApplied.filter((function(t){return t.properties.type===u.type.toLowerCase()&&t.properties.xpath===u.tmplid})).length>0?u.filterApplied="filter-applied":u.filterApplied="";var c=this.filterItem.render(u);"Text"!==u.type&&"Link"!==u.type&&u.data&&(u.data.defaultValues&&u.data.defaultValues.length>0||u.data.min&&u.data.max)&&(a.append(c),this.buildFilter(c,u),"filter-applied"===u.filterApplied&&$(".remove-filter",c).show())}else if(this.filterControlArray&&this.filterControlArray.length>0){var u;for(s=-1;u=this.filterControlArray[++s];){var p=r.find((function(t){return t.attribute===u.xpath}));p&&this.setFilterData(u,p)}}}$(".filters-loading",this.content).hide()},toggleWidget:function(t,e){var i=this.getContent().is(":visible");this.openCloseWidget({show:!i,$target:e.args.target})},openCloseWidget:function(t){var e=this.getContent(),i=t.$target||$("<div>");t.show?(i.addClass("opened"),e.show()):(i.removeClass("opened"),e.hide(),$("button#ui-bizagi-cancel-filter").click())},buildFilter:function(t,e){switch(e.type){case"Entity":this.buildFilterMultiple(t,e);break;case"Number":this.buildFilterNumber(t,e);break;case"Money":this.buildFilterMoney(t,e);break;case"Datetime":this.buildFilterDate(t,e);break;case"Boolean":this.buildFilterBoolean(t,e)}},setFilterData:function(t,e){var i="Int"===e.subType;switch(t.type){case"Entity":t.widget.bizagi_multipleFilter("setData",e.data);break;case"Number":i?t.widget.bizagi_integerFilter("setData",e.data):t.widget.bizagi_numberFilter("setData",e.data);break;case"Money":t.widget.bizagi_moneyFilter("setData",e.data);break;case"Datetime":t.widget.bizagi_dateFilter("setData",e.data);break;case"Boolean":t.widget.bizagi_booleanFilter("setData",e.data)}},buildFilterMoney:function(t,e){var i=this,n=t.bizagi_moneyFilter({showButtonClearFilter:!0,numericFormat:i.getResource("numericFormat"),properties:e,data:e.data,onApply:function(t,e){i.addFilterSelection(t),i.triggerFilter({calculateFilters:!0})},onClear:function(t){i.removeFilterApplied(t),i.triggerFilter({calculateFilters:!0})},getResource:function(t){return bizagi.localization.getResource(t)}});i.filterControlArray.push({type:e.type,xpath:e.attribute,widget:n})},buildFilterNumber:function(t,e){var i=this,n="Int"===e.subType,a={showButtonClearFilter:!0,numericFormat:i.getResource("numericFormat"),properties:e,data:e.data,onApply:function(t,e){0!==t.length&&(i.addFilterSelection(t),i.triggerFilter({calculateFilters:!0}))},onClear:function(t){i.removeFilterApplied(t),i.triggerFilter({calculateFilters:!0})},getResource:function(t){return bizagi.localization.getResource(t)}},r=n?t.bizagi_integerFilter(a):t.bizagi_numberFilter(a);i.filterControlArray.push({type:e.type,xpath:e.attribute,widget:r})},buildFilterDate:function(t,e){var i=this,n=t.bizagi_dateFilter({showButtonClearFilter:!0,properties:e,onApply:function(t,e){i.addFilterSelection(t),i.triggerFilter({calculateFilters:!0})},onClear:function(t){i.removeFilterApplied(t),i.triggerFilter({calculateFilters:!0})},getResource:function(t){return i.getResource(t)}});i.filterControlArray.push({type:e.type,xpath:e.attribute,widget:n})},buildFilterMultiple:function(t,e){var i=this,n=t.bizagi_multipleFilter({showButtonClearFilter:!0,properties:e,data:e.data,onApply:function(t,e){i.addFilterSelection(t),i.triggerFilter({calculateFilters:!0})},onClear:function(t){i.removeFilterApplied(t),i.triggerFilter({calculateFilters:!0})},getResource:function(t){return bizagi.localization.getResource(t)}});i.filterControlArray.push({type:e.type,xpath:e.attribute,widget:n})},buildFilterBoolean:function(t,e){var i=this,n=t.bizagi_booleanFilter({showButtonClearFilter:!0,properties:e,data:e.data,onApply:function(t,e){i.addFilterSelection(t),i.triggerFilter({calculateFilters:!0})},onClear:function(t){i.removeFilterApplied(t),i.triggerFilter({calculateFilters:!0})},getResource:function(t){return bizagi.localization.getResource(t)}});i.filterControlArray.push({type:e.type,xpath:e.attribute,widget:n})},addFilterSelection:function(t){$(".filters-loading",this.content).show();for(var e=0,i=t.length;e<i;e++)this.removeFilterApplied([t[e].properties.xpath]),this.filtersApplied.push(t[e])},removeFilterApplied:function(t){$(".filters-loading",this.content).show();for(var e,i=-1;e=t[++i];){var n=this.filtersApplied.find((function(t){return t.properties.xpath===e}));n&&this.filtersApplied.splice(this.filtersApplied.indexOf(n),1)}},setOrderBy:function(t,e){this.orderBy=e.args,this.triggerFilter({calculateFilters:!1})},setRecordsPerPage:function(t,e){this.triggerFilter({calculateFilters:!1,page:e.args.page,pageSize:e.args&&e.args.pageSize})},triggerFilter:function(t){for(var e,i=this.criteriaSearchApplied?bizagi.clone(this.criteriaSearchApplied):[],n=this.filtersApplied.slice(),a=[],r=-1;e=n[++r];)this.dataService.defineFilterObject(e,i),this.dataService.defineFilterObject(e,a);var o=a.length;this.orderBy.properties&&this.dataService.defineFilterObject(this.orderBy,i),t.pageSize&&this._setPageSize(t.pageSize);var s={type:"UPDATE-DATATEMPLATE-VIEW",args:{filters:i,page:t.page,level:1,calculateFilters:t.calculateFilters||!1,defaultFilterApplied:!1,typeSearch:"filter",filtersAppliedCounter:o,pageSize:this._getPageSize()||10}};this.pub("notify",s)},_setPageSize:function(t){this.dataService.pageSize=t},_getPageSize:function(){return this.dataService.pageSize}}),bizagi.injector.register("bizagi.workportal.widgets.mysearchfilter",["workportalFacade","dataService","processActionService",bizagi.workportal.widgets.mysearchfilter],!1);
//# sourceMappingURL=../../../../Maps/desktop/templateengine-view.desktop.production.js.map
