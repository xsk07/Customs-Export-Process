function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.plan.activities.sidebar",{},{init:function(e,t,a){this._super(e,t,a),a=a||{},this.loadTemplates({"project-plan-activities-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.project.plan.activities.sidebar").concat("#project-plan-activities-sidebar")})},renderContent:function(){var e=this.getTemplate("project-plan-activities-sidebar");return this.content=e.render({}),this.content}}),bizagi.injector.register("bizagi.workportal.widgets.project.plan.activities.sidebar",["workportalFacade","dataService",bizagi.workportal.widgets.project.plan.activities.sidebar],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.plan.create",{},{init:function(e,t,a,i){this.params=i,this.contextualized,this._super(e,t,i),this.notifier=a,this.loadTemplates({"plan-create":bizagi.getTemplate("bizagi.workportal.desktop.widgets.project.plan.create").concat("#plan-create")}),this.dialogBox={}},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){this.initPlugins()},initPlugins:function(){var e=this.getTemplate("plan-create");this.dialogBox.formContent=e.render({}),this.dialogBox.elements={inputName:$("#input-name-plan",this.dialogBox.formContent),inputTemplate:$("#templates-plan",this.dialogBox.formContent),buttonSave:$("#button-accept-create-plan",this.dialogBox.formContent),buttonCancel:$("#button-cancel-create-plan",this.dialogBox.formContent)},this.dialogBox.elements.buttonSave.on("click",$.proxy(this.onClickSavePlan,this)),this.dialogBox.elements.buttonCancel.on("click",$.proxy(this.closeDialogBox,this)),this.notifier=bizagi.injector.get("notifier")},closeDialogBox:function(){this.dialogBox.formContent.dialog("destroy"),this.dialogBox.formContent.detach(),this.dialogBox.templateGuid=""},showPopupAddPlan:function(e,t,a){var i=this;i.params=e,i.dataService=t,i.contextualized=a,i.content=$("<div></div>"),i.initPlugins(),i.dialogBox.elements.inputTemplate.html(""),i.dataService.getTemplatesByParentWorkItem({parentWorkItem:e.guidWorkItem}).done((function(e){var t={combo:[],id:"templates"};t.combo=e,i.dialogBox.elements.inputTemplate.uicombo({isEditable:!1,data:t,itemValue:function(e){return e.id},itemText:function(e){return e.name},onChange:function(e){var t=e.ui.data("value");i.dialogBox.elements.inputTemplate.val(t),i.dialogBox.templateGuid=t},css:"display: none"}),i.dialogBox.elements.inputTemplate.keydown((function(){8!=event.keyCode&&46!=event.keyCode||(event.preventDefault(),i.dialogBox.templateGuid="",i.dialogBox.elements.inputTemplate.val(""),$("input",i.dialogBox.elements.inputTemplate).val(""))})),e.length>0?$(".field-template",i.dialogBox.formContent).show():$(".field-template",i.dialogBox.formContent).hide()})).fail((function(){$(".field-template",i.dialogBox.formContent).hide()})),i.dialogBox.formContent.dialog({resizable:!1,draggable:!1,height:"auto",width:"600px",modal:!0,title:bizagi.localization.getResource("workportal-project-plan-popup-title-add-plan"),maximize:!1,close:function(){i.dialogBox.formContent.dialog("destroy"),i.dialogBox.formContent.detach()}})},onClickSavePlan:function(e){e.preventDefault();this.validateParams()&&this.createNewPlan()},createNewPlan:function(){var e=this,t=e.params.guidWorkItem||null,a={idUserCreator:bizagi.currentUser.idUser,id:void 0,startDate:null,creationDate:null,parentWorkItem:t,description:null,currentState:"PENDING",name:e.dialogBox.elements.inputName.val(),waitForCompletion:!0,dueDate:null,contextualized:e.contextualized,idTemplate:e.dialogBox.templateGuid};$.when(e.sendDataInsertPlan(a)).then((function(t){(a=$.extend(a,{id:t.id})).activities=[],a.users=[];var i=new bizagi.workportal.services.behaviors.projectDashboard(e.dataService);e.params.menuPlanDashboard={},e.params.menuPlanDashboard.showCommentsOptionMenu=i.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonComments,e.params.menuPlanDashboard.showFilesOptionMenu=i.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonFiles,e.params.menuPlanDashboard.showTimeLineOptionMenu=i.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonTimeLine,a.name=bizagi.util.encodeHtml(a.name),$.when(i.getFirstParentInfo(a.id,a.contextualized)).done((function(t){var i={paramsNewPlan:a,radNumber:t.id,hasDiscussionsOrComment:t.hasDiscussionsOrComment};e.pub("planCreated",i),e.closeDialogBox(),e.notifier.showSucessMessage(printf(bizagi.localization.getResource("workportal-project-plan-created"),""))}))}))},validateParams:function(){var e=this.dialogBox.elements.inputName;if(e.val()&&""!==e.val())return!0;var t=bizagi.localization.getResource("workportal-project-plan-popup-field-name-required");return e.next().find("span").html(t),!1},sendDataInsertPlan:function(e){var t=$.Deferred();return $.when(this.dataService.postPlan(e)).always((function(e,a,i){201===i.status?t.resolve(e):t.reject()})),t.promise()}}),bizagi.injector.register("bizagi.workportal.widgets.project.plan.create",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.project.plan.create]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.plan.edit",{},{init:function(e,t,a,i){this.params=i,this.planToEdit,this._super(e,t,i),this.notifier=a,this.loadTemplates({"plans.manager.popup.edit.plan":bizagi.getTemplate("bizagi.workportal.desktop.widgets.project.plan.edit").concat("#plans-manager-popup-edit-plan")}),this.editDialogBox={}},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){},closeEditDialogBox:function(){this.editDialogBox.elements.inputDueDate.datepicker("destroy"),this.editDialogBox.formContent.dialog("destroy"),this.editDialogBox.formContent.detach()},showPopup:function(e,t,a){var i=this,s=$.Deferred();return i.planToEdit=a,i.initEditDialogBox(a),i.editDialogBox.elements.inputName.val(bizagi.util.decodeHtmlEntities(a.name)),i.editDialogBox.elements.inputDesc.val(bizagi.util.decodeHtmlEntities(a.description)),i.editDialogBox.elements.inputWaitForCompletion.prop("checked",a.waitForCompletion),i.editDialogBox.elements.inputDueDate.datepicker(),i.editDialogBox.elements.inputDueDate.datepicker("option","dateFormat",bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI()),a.dueDate&&i.editDialogBox.elements.inputDueDate.datepicker("setDate",new Date(a.dueDate)),i.editDialogBox.formContent.dialog({resizable:!1,draggable:!1,height:"auto",width:"600px",modal:!0,title:bizagi.localization.getResource("workportal-project-plan-editplan"),maximize:!0,close:function(e,t){i.editDialogBox.elements.inputDueDate.datepicker("destroy"),i.editDialogBox.formContent.dialog("destroy"),i.editDialogBox.formContent.detach(),s.resolve()}}),s.promise()},initEditDialogBox:function(e){var t=this.getTemplate("plans.manager.popup.edit.plan");this.editDialogBox.formContent=t.render(e),this.editDialogBox.elements={inputName:$("#input-name-plan",this.editDialogBox.formContent),inputDesc:$("#input-desc-plan",this.editDialogBox.formContent),inputDueDate:$("#input-dueDate-plan",this.editDialogBox.formContent),inputWaitForCompletion:$("#input-waitForCompletion",this.editDialogBox.formContent),buttonSave:$("#button-accept-edit-plan",this.editDialogBox.formContent),buttonCancel:$("#button-cancel-edit-plan",this.editDialogBox.formContent)},this.editDialogBox.elements.buttonSave.on("click",$.proxy(this.saveEditedPlan,this)),this.editDialogBox.elements.buttonCancel.on("click",$.proxy(this.closeEditDialogBox,this))},saveEditedPlan:function(e){e.preventDefault();var t=this;t.validateEditDialogBoxParams()&&$.when(t.getParamsUpdatePlan()).done((function(e){$.when(t.dataService.updatePlan(e)).done((function(){t.closeEditDialogBox(),t.pub("planEditedSuccess",{paramsEditPlan:e})})).fail((function(){t.pub("planEditedFailed")}))}))},getParamsUpdatePlan:function(){var e=$.Deferred(),t={};(t=this.planToEdit).name=this.editDialogBox.elements.inputName.val(),t.description=this.editDialogBox.elements.inputDesc.val(),0!==this.editDialogBox.elements.inputWaitForCompletion.length&&(t.waitForCompletion=this.editDialogBox.elements.inputWaitForCompletion.prop("checked"));var a=this.editDialogBox.elements.inputDueDate.datepicker("getDate");if(a){var i={idUser:bizagi.currentUser.idUser,date:a.getTime()};$.when(this.dataService.getEndHourWorkingByDate(i)).done((function(a){t.dueDate=a.dateTime,e.resolve(t)}))}else e.resolve(t);return e.promise()},validateEditDialogBoxParams:function(){var e=this.editDialogBox.elements.inputName;if(e.val()&&""!==e.val())return!0;var t=bizagi.localization.getResource("workportal-project-plan-popup-field-name-required");return e.next().find("span").html(t),!1}}),bizagi.injector.register("bizagi.workportal.widgets.project.plan.edit",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.project.plan.edit],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.plan.template.create",{},{init:function(e,t,a){this.params=a,this.contextualized,this.idPlanSelected,this._super(e,t,a),this.loadTemplates({"plan-template-create":bizagi.getTemplate("bizagi.workportal.desktop.widgets.project.plan.template.create").concat("#plan-template-create")}),this.dialogBox={}},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){this.initPlugins()},initPlugins:function(){var e=this.getTemplate("plan-template-create");this.dialogBox.formContent=e.render({}),this.dialogBox.elements={inputName:$("#input-name-template",this.dialogBox.formContent),buttonSave:$("#button-accept-create-template",this.dialogBox.formContent),buttonCancel:$("#button-cancel-create-template",this.dialogBox.formContent)},this.dialogBox.elements.buttonSave.on("click",$.proxy(this.onClickSaveTemplate,this)),this.dialogBox.elements.buttonCancel.on("click",$.proxy(this.closeDialogBox,this))},closeDialogBox:function(){this.dialogBox.formContent.dialog("destroy"),this.dialogBox.formContent.detach()},showPopupAddTemplatePlan:function(e,t,a,i){var s=this;s.params=e,s.dataService=t,s.contextualized=a,s.idPlanSelected=i,s.content=$("<div></div>"),s.initPlugins(),s.dialogBox.formContent.dialog({resizable:!1,draggable:!1,height:"auto",width:"600px",modal:!0,title:bizagi.localization.getResource("workportal-project-plan-action-popup-save-as-template"),maximize:!1,close:function(e,t){s.dialogBox.formContent.dialog("destroy"),s.dialogBox.formContent.detach()}})},onClickSaveTemplate:function(e){e.preventDefault();var t=this;if(t.validateSaveDialogBoxParams()){var a={idPlan:t.idPlanSelected,name:t.dialogBox.elements.inputName.val()};$.when(t.dataService.createTemplateByPlan(a)).done((function(){t.closeDialogBox(),t.pub("planTemplateCreatedSuccess",{})})).fail((function(){t.pub("planTemplateCreatedFailed",{})}))}},validateSaveDialogBoxParams:function(){var e=this.dialogBox.elements.inputName;if(e.val()&&""!==e.val())return!0;var t=bizagi.localization.getResource("workportal-project-plan-popup-field-name-required");return e.next().find("span").html(t),!1}}),bizagi.injector.register("bizagi.workportal.widgets.project.plan.template.create",["workportalFacade","dataService",bizagi.workportal.widgets.project.plan.template.create]),bizagi.workportal.widgets.admin.caseSearch.extend("bizagi.workportal.widgets.reassigncase",{},{init:function(e,t,a){this._super(e,t,a),this.loadTemplates({"admin.case.search":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search"),"admin.case.search.fields":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-fields"),"admin.case.search.button":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-buttons"),"admin.case.search.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-result"),"admin.case.search.pagination":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-pagination"),"admin.case.search.invalidate":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-invalidate"),"admin.case.search.reassign":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign"),"admin.case.search.reassign.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign-form"),"admin.case.search.action.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-action-result"),useNewEngine:!1})},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE},renderContent:function(){var e,t=this.getTemplate("admin.case.search");return e=this.content=$.tmpl(t,{}),this.loadtemplates(),e},loadtemplates:function(){this.generalContentTmpl=this.getTemplate("admin.case.search"),this.fieldsContentTmpl=this.getTemplate("admin.case.search.fields"),this.buttonContentTmpl=this.getTemplate("admin.case.search.button"),this.resultContentTmpl=this.getTemplate("admin.case.search.result"),this.paginationTmpl=this.getTemplate("admin.case.search.pagination"),this.invalidateContentTmpl=this.getTemplate("admin.case.search.invalidate"),this.reassignContentTmpl=this.getTemplate("admin.case.search.reassign"),this.reassignFormTmpl=this.getTemplate("admin.case.search.reassign.form"),this.actionResultContentTmpl=this.getTemplate("admin.case.search.action.result")},postRender:function(){this.maxElemShow=10,this.maxPageToShow=5,this.processNavigation=[],this.setupData()},setupData:function(){var e={cases:[]},t=[];this.setupInitialData(),this.setupDatePicker(),this.setupProcessTree(),this.setupMainButtons(),e.cases.push({idCase:this.params.data.idCase,idWorkItem:this.params.data.idWorkItem}),t.push({taskItem:this.params.data.idCase+": "+this.params.data.idtask,idWorkItem:this.params.data.idWorkItem}),this.selectedTasks=e,this.selectedTasksToShow=t,this.showReassignForm(this.content,this.selectedTasksToShow)},setupInitialData:function(){var e,t=this.getContent();this.buttonBackAction="backToMainForm",this.selectedUserId="",this.selectedUserName="",this.selectedTasks="",this.selectedTasksToShow="",this.searchParams="",this.processTree="",$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle")),$("#mainForm",t).remove(),$("#dinamicContent",t).remove(),$("#case-search-log-data-buttonset",t).remove(),e=$.tmpl(this.reassignFormTmpl,{}),t.append(e)},setupDatePicker:function(){var e=this.getContent();$(".biz-wp-form-datepicker",e).datepicker({controlType:"select",dateFormat:"dd/mm/yy"})},setupProcessTree:function(){var e=this.getContent();bizagi.treeRoutSelected=[],$("#treeLinksId").remove(),this.processTree=new bizagi.workportal.widgets.processtree(this.workportalFacade,this.dataService,$.extend(this.params,{canvas:$("#processTree",e)})),this.processTree.render()},setupUsersSearchForm:function(){var e=this,t=e.getContent(),a=$.Deferred();$("#biz-wp-users-table-form").html(""),e.usersTable=new bizagi.workportal.widgets.userstable(e.workportalFacade,e.dataService,$.extend(e.params,{canvas:$("#biz-wp-users-table-form",t),userLinkLabel:[bizagi.localization.getResource("workportal-widget-admincasesearch-reassign")],parentDef:a})),e.usersTable.render(),$.when(a).done((function(t,a){e.assignEventReassignLinks(t,a)}))},findResults:function(e,t,a){var i=this;t.Page=a||1,$.when(i.dataService.getAdminCasesList(t)).done((function(a){if($(".biz-wp-table").remove(),$(".case-search-action-wrapper").remove(),$("#biz-wp-table-summary-wrapper").remove(),i.totalRecords=a.records,i.totalPages=a.total,a.rows.length>0){i.showCasesSearchResultFrame(e,a),i.setupActionsButton(e);var s,o=i.maxPageToShow>i.totalPages?i.totalPages:i.maxPageToShow,r=$("#biz-wp-table-pager-wrapper"),n={};n.pagination=i.totalPages>1,n.page=a.page,n.pages={};for(var c=1;c<=o;c++)n.pages[c]={pageNumber:c};s=$.tmpl(i.paginationTmpl,n).html(),r.append(s),$("ul").bizagiPagination({maxElemShow:i.maxElemShow,totalPages:i.totalPages,actualPage:a.page,listElement:$("#biz-wp-table-pager-wrapper"),clickCallBack:function(a){i.findResults(e,t,a.page)}})}else bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-authentication-log-none"),"Bizagi","warning")})).fail((function(e){bizagi.log(e)}))},showCasesSearchResultFrame:function(e,t){var a=this.preprocessResultList(t.headers,t),i=$.tmpl(this.resultContentTmpl,{headers:t.headers,rows:a}),s=$.tmpl(this.invalidateContentTmpl,{}),o=$.tmpl(this.reassignContentTmpl,{});$("#mainForm",e).hide(),$("#dinamicContent",e).html(i),$(".case-search-action-wrapper",e).append(s),$(".case-search-action-wrapper",e).append(o),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title")),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide(),$("#btn-admin-case-back",e).css("display","inline"),this.setupActivitiesLink(e),this.setupGraphicQueryEvent(e)},preprocessResultList:function(e,t){for(var a=[],i=t.rows.length,s=0;s<i;s++)a.push(this.processResultItem(e,t.rows[s]));return a},processResultItem:function(e,t){var a,i,s,o,r=t.data,n=t.idCase,c=t.idWorkFlow,l=[],p=[],d=[],u=-1,g=0,h=!1;for(p.push({id:"checkCaseAdmin",value:n});u++<e.length-1;)switch(e[u].fieldName){case this.columnsID.caseNumber:p.push({id:"caseNumber",value:{idCase:n,caseNumber:r[g]}}),g++;break;case this.columnsID.process:p.push({id:"idWorkItem",value:r[g]}),g++;break;case this.columnsID.userName:case this.columnsID.task:case this.columnsID.taskDueDate:if(void 0===a){for(var m=r.length;m-- >0;)if(Array.isArray(r[m])){a=r[m],h=!0;break}g++}h?(e[u].fieldName==this.columnsID.taskDueDate&&r.splice(u,1),s=a[0],this.columnsID.userName==e[u].fieldName?(p=p.concat(this.processTaskObjectUser(s)),-1==d.indexOf(this.columnsID.userName)&&d.push(this.columnsID.userName)):this.columnsID.task==e[u].fieldName?(p=p.concat(this.processTaskObject(s,n)),-1==d.indexOf(this.columnsID.task)&&d.push(this.columnsID.task)):this.columnsID.taskDueDate==e[u].fieldName&&(p=p.concat(this.processTaskObjectDate(s)),-1==d.indexOf(this.columnsID.taskDueDate)&&d.push(this.columnsID.taskDueDate))):e[u].fieldName==this.columnsID.taskDueDate&&(p=p.concat({estimatedSolutionDate:r[u]}),-1==d.indexOf(this.columnsID.taskDueDate)&&d.push(this.columnsID.taskDueDate));break;case this.columnsID.processCreationDate:p.push({id:"processCreationDate",value:r[g]}),g++;break;case this.columnsID.processDueDate:p.push({id:"processDueDate",value:r[g]}),g++;break;default:p.push({id:"customField",value:r[g]}),g++}if(p.push({id:"viewProcess",value:{idCase:n,idworkflow:c}}),l.push({attr:"first_row",data:p}),(i=a?a.length:0)>1){o=d.length;for(var b=1;b<i;b++){var w=[];for(m=-1;m++<o-1;)d[m]==this.columnsID.task?w.push(this.processTaskObject(a[b],n)):d[m]==this.columnsID.taskDueDate?w.push(this.processTaskObjectDate(a[b])):d[m]==this.columnsID.userName&&w.push(this.processTaskObjectUser(a[b]));l.push({attr:"next_row",data:w})}}return{data:l,totalTask:i}},processTaskObject:function(e,t){return{taskName:e.taskName,colorState:e.colorState,idCase:t,idWorkItem:e.idWorkItem,idTask:e.idTask}},processTaskObjectDate:function(e){var t={};return e.estimatedSolutionDate?t.estimatedSolutionDate=e.estimatedSolutionDate:t.estimatedSolutionDate="",t},processTaskObjectUser:function(e){var t={};return e.assignee?t.userName=e.assignee:t.userName="",t},invalidateCases:function(e){var t=this,a={cases:[]};$("input:checkbox[name=CaseAdmin]:checked",e).each((function(){var e=$(this).val();a.cases.push({idCase:e})})),0==a.cases.length?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-empty-msg"),"Bizagi","warning"):$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-confirm-msg"),"Bizagi","warning")).done((function(){var i=$("#txtReason",e).val(),s={action:"abort",cases:JSON.stringify(a),reason:i};$.when(t.dataService.abortReassignItems(s)).done((function(a){t.showActionResultFrame(e,a.response,"invalidate")})).fail((function(e){bizagi.log(e)}))}))},showReassignTasksFrame:function(e){var t={cases:[]},a=[];$("input:checkbox[name=workItemAdmin]:checked",e).each((function(){var e=$(this).val();e=e.split("|"),t.cases.push({idCase:e[0],idWorkItem:e[1]}),a.push({taskItem:e[0]+": "+e[2],idWorkItem:e[1]})})),0==a.length?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-empty-msg"),"Bizagi","warning"):(this.selectedTasks=t,this.selectedTasksToShow=a,this.showReassignForm(e,a))},showReassignForm:function(e,t){this.buttonBackAction="backToCases";var a=$.tmpl(this.reassignFormTmpl,{tasks:t});$("#dinamicContent",e).hide(),$("#dinamicContent2",e).html(a),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide(),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-title")),this.setupUsersSearchForm()},reassignTasks:function(){var e=this,t=e.getContent(),a={action:"reassignItems",cases:JSON.stringify(e.selectedTasks),idNewUser:e.selectedUserId};$.when(e.dataService.reassignCurrent(a)).done((function(a){e.showActionResultFrame(t,a.response,"reassign")})).fail((function(e){bizagi.log(e)}))},showActionResultFrame:function(e,t,a){var i=t.length>1?"-several":"",s="",o="",r=[];if("invalidate"==(i=a+i))for(var n=0;n<t.length;n++)1==t[n].deleted?(s=t[n].idCase,s+=n+1<t.length?", ":"",r[0]=!0):(o=t[n].idCase,o+=n+1<t.length?", ":"",r[1]=!1);else if("invalidate-several"==i)for(n=0;n<t.length;n++)1==t[n].deleted?(s+=t[n].idCase,s+=n+1<t.length?", ":"",r[0]=!0):(o+=t[n].idCase,o+=n+1<t.length?", ":"",r[1]=!1);else if("reassign"==i)for(n=0;n<t.length;n++)1==t[n].reassigned?(s+=t[n].idCase,s+=n+1<t.length?", ":"",r[0]=!0):(o=t[n].idCase,o+=n+1<t.length?", ":"",r[1]=!1);else if("reassign-several"==i){s+="<br/><br/>",o+="<br/><br/>";for(n=0;n<t.length;n++)1==t[n].reassigned?(s+=t[n].idCase+"<br/>",r[0]=!0):(o+=t[n].idCase+"<br/>",r[1]=!1);s+="<br/>",o+="<br/>"}var c=$.tmpl(this.actionResultContentTmpl,{action:i,resultStatus:r});c=(c=(c=(c=c[0].innerHTML.replace("{0}","<strong>"+s+"</strong>")).replace("{3}","<strong>"+o+"</strong>")).replace("{1}",this.selectedUserName)).replace("{1}",this.selectedUserName),"invalidate"==a&&$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-result-title")),$("#mainForm",e).html(""),$("#dinamicContent",e).css("display","inline"),$("#dinamicContent",e).html(c),$("#dinamicContent2",e).remove(),$("#usersTable",e).remove(),$("#btn-admin-case-back",e).css("display","none"),$("#btn-admin-case-search-clear",e).css("display","none"),$("#btn-admin-case-search",e).css("display","none"),$("#btn-admin-case-finish",e).css("display","inline"),$("#biz-wp-userstable-wrapperform").hide(),$("#biz-wp-userstable-wrapperlist").hide(),this.usersTable.resultStatus=-1==r.indexOf(!1)},setupMainButtons:function(){var e=this,t=e.getContent(),a=$.tmpl(e.buttonContentTmpl,{});t.append(a);var i=$("#case-search-log-data-buttonset",t);$("#btn-admin-case-search-clear",i).click((function(a){$(".biz-wp-input-text",t).val(""),$(".biz-wp-form-datepicker",t).val(""),e.setupProcessTree()})),$("#btn-admin-case-search",i).click((function(a){var i="",s="",o="",r="",n="",c=e.processTree.getTreeRouteSelected();c.length>0&&(2==c.length?(i=c[1],o=c[0],s=""):(i=c[c.length-1],s=c[1],o=c[0]));var l={h_action:"getCases",I_ProcessState:"Running",h_idApp:"",I_Users:"ALL",eventAsTask:!0,orderType:1,order:"",orderField:"",I_radNumber:$("#caseInput").val(),I_idWFClass:o,I_USERFULLNAME:$("#userNameInput").val(),I_USERPOSITION:$("#userPositionInput").val(),I_From__CreationDate:$("#sinceDate").val(),I_To__CreationDate:$("#toDate").val(),h_idWFClassAuth:"",I_idCategory:s,I_idApplication:i,PageSize:e.maxElemShow};""==$("#sinceDate").val()||bizagi.util.isDate($("#sinceDate").val())?""==$("#toDate").val()||bizagi.util.isDate($("#toDate").val())?(e.searchParams=l,e.findResults(t,l)):(r=bizagi.localization.getResource("workportal-general-invalid-date"),n=bizagi.localization.getResource("workportal-widget-admincasesearch-to-date"),r=r.replace("{0}",n),bizagi.showMessageBox(r,"Bizagi","warning")):(r=bizagi.localization.getResource("workportal-general-invalid-date"),n=bizagi.localization.getResource("workportal-widget-admincasesearch-date-since"),r=r.replace("{0}",n),bizagi.showMessageBox(r,"Bizagi","warning"))})),$("#btn-admin-case-back",i).click((function(t){"backToMainForm"==e.buttonBackAction?e.backToMainForm():"backToCases"==e.buttonBackAction&&e.backToCases()})),$("#btn-admin-case-finish",i).click((function(t){e.publish("closeCurrentDialog")}))},backToCases:function(){var e=this.getContent();this.buttonBackAction="backToMainForm",$("#dinamicContent",e).show(),$("#dinamicContent2",e).html(""),$("#usersTable").remove(),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title")),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide()},backToMainForm:function(){var e=this.getContent();$("#mainForm",e).show(),$("#dinamicContent",e).html(""),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle")),$("#btn-admin-case-search-clear",e).show(),$("#btn-admin-case-search",e).show(),$("#btn-admin-case-back",e).css("display","none")},assignEventReassignLinks:function(e,t){this.selectedUserId=e,this.selectedUserName=t,this.reassignTasks()},setupActionsButton:function(e){var t=this;$("#btn-admin-case-invalidate",e).click((function(a){t.invalidateCases(e)})),$("#btn-admin-case-reassign",e).click((function(a){t.showReassignTasksFrame(e)}))},setupActivitiesLink:function(e){var t=this;$(".activityClicked",e).click((function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:$(this)[0].getAttribute("data-idworkItem"),idTask:$(this)[0].getAttribute("data-idTask")}),t.publish("closeCurrentDialog")})),$(".caseClicked",e).click((function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:"",idTask:""}),t.publish("closeCurrentDialog")})),$(".cases-column-header",e).click((function(){var a=$(this)[0].getAttribute("data-columnorder"),i=$(this)[0].getAttribute("data-ordertype"),s=$(this)[0].getAttribute("data-columnOrderName");i="1"==i?0:1,t.searchParams.order=a,t.searchParams.orderType=i,t.searchParams.orderField=s,t.findResults(e,t.searchParams,t.searchParams.Page)}))},setupGraphicQueryEvent:function(e){var t=this;$(".biz-wp-diagram-view-icon",e).click((function(){var e=$(this).data("idcase"),a=$(this).data("idworkflow");t.showGraphicQuery({idCase:e,idWorkflow:a})}))}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.content.dashboard",{},{init:function(e,t,a){this._super(e,t,a),this.loadTemplates({"project-content-dashboard":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.content.dashboard").concat("#project-plan-content-dashboard")})},renderContent:function(){var e=this.getTemplate("project-content-dashboard");return this.content=e.render({}),this.content},postRender:function(){setTimeout((function(){$(window).trigger("resize")}),1e3)}}),bizagi.injector.register("bizagi.workportal.widgets.project.content.dashboard",["workportalFacade","dataService",bizagi.workportal.widgets.project.content.dashboard],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.dashboard.menu",{},{onDiscussionsMenuStatusChange:function(e,t){this.updateDiscussionsIcons(t.hasDiscussionsOrComment)},updateDiscussionsIcons:function(e){this.sub("UPDATE_DISCUSSIONS_MENU_STATUS",$.proxy(this.onDiscussionsMenuStatusChange,this)),$(".bz-icon-discussion-comment").toggle(e),$(".bz-icon-discussion-no-comment").toggle(!e),this.params.hasDiscussionsOrComment=e},clean:function(){this.unsub("UPDATE_DISCUSSIONS_MENU_STATUS",$.proxy(this.onDiscussionsMenuStatusChange,this))}}),bizagi.injector.register("bizagi.workportal.widgets.project.dashboard.menu",["workportalFacade","dataService",bizagi.workportal.widgets.project.dashboard.menu],!0),bizagi.workportal.widgets.project.dashboard.menu.extend("bizagi.workportal.widgets.project.dashboard.menu.activity",{},{init:function(e,t,a){this.params=a||{},this._super(e,t,a),this.loadTemplates({"project-dashboard-menu":bizagi.getTemplate("bizagi.workportal.desktop.widgets.project.dashboard.menu.activity").concat("#project-dashboard-menu1")})},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){var e=this;e._super(),e.params.contextsLeftSidebarCaseDashboard.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){this.params=$.extend(this.params,t.args),this.params.plan.idActivitySelected=void 0,this.clean();var a=this.getContent().empty();void 0!==e.type&&(this.params.showContextByMenuDashboard=e.type);var i={showFormOverview:this.params.menuDashboard.showFormOverview,showFormActivity:this.params.menuDashboard.showFormActivity,showCommentsOptionMenu:this.params.menuDashboard.showCommentsOptionMenu,showFilesOptionMenu:this.params.menuDashboard.showFilesOptionMenu,showTimeLineOptionMenu:this.params.menuDashboard.showTimeLineOptionMenu&&(!this.params.isAdhocProcess||this.params.isAdhocProcess&&bizagi.util.isEnableFeature("enableTimelineOnLiveProcesses")),showPlanOptionMenu:this.params.menuDashboard.showPlanOptionMenu,contextPlanOptionMenu:this.params.menuDashboard.contextPlanOptionMenu,contextFormActivityOptionMenu:this.params.menuDashboard.contextFormActivityOptionMenu};this.getTemplate("project-dashboard-menu").render(i).appendTo(a),this.params.showContextByMenuDashboard&&$("li[data-context='"+this.params.showContextByMenuDashboard.toUpperCase()+"']",this.content).addClass("active").siblings().removeClass("active"),this.updateDiscussionsIcons(this.params.hasDiscussionsOrComment),this.handlerEvents()},loadContentById:function(e){e.preventDefault();var t=$(e.target).closest("li");if(!t.hasClass("active")){var a=t.data("context");if(a){var i=this.pub("notify",{type:"NAVIGATOR_GETLEVEL"}),s=parseInt(i[0],10),o="",r=s;"PLANACTIVITIES"==a&&(r=s+1,o=bizagi.localization.getResource("workportal-project-casedashboard-plan")),this.params.refreshLastItemBreadcrumb=!1,this.pub("notify",{type:a.toUpperCase(),args:$.extend(this.params,{showContextByMenuDashboard:a,histName:o,level:r})}),$("li[data-context='"+this.params.showContextByMenuDashboard.toUpperCase()+"']",this.content).addClass("active").siblings().removeClass("active")}}},subMenuHandler:function(){var e=this.getContent(),t=$("[data-context='COMMENTS']",e),a=$("[data-context='FILES']",e),i=$("[data-context='TIMELINE']",e);$(".ui-bizagi-wp-project-tab-submenu a",e).on("click",(function(){t.toggle(),a.toggle(),i.toggle()}))},handlerEvents:function(){var e=this,t=e.getContent();e.subMenuHandler(),$(".ui-bizagi-wp-project-tab-links a",t).on("click",$.proxy(e.loadContentById,e)),$(".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form",t).on("click",(function(){var t={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.params.idCase,idTask:e.params.idTask,idWorkflow:e.params.idWorkflow,idWorkItem:e.params.idWorkitem,referrer:e.params.referrer||"inboxGrid"};e.publish("executeAction",t)}))},clean:function(){var e=this,t=e.getContent();e._super(),e.params&&e.params.contextsLeftSidebarCaseDashboard&&e.params.contextsLeftSidebarCaseDashboard.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))})),$(".ui-bizagi-wp-project-tab-links a",t).off(),$(".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form",t).off()}}),bizagi.injector.register("bizagi.workportal.widgets.project.dashboard.menu.activity",["workportalFacade","dataService",bizagi.workportal.widgets.project.dashboard.menu.activity],!0),bizagi.workportal.widgets.project.base.extend("bizagi.workportal.widgets.project.activity",{},{init:function(e,t,a){this._super(e,t,a),this.loadTemplates({"project-activity":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.activity").concat("#project-activity-wrapper")})},renderContent:function(){var e=this.getTemplate("project-activity");return this.content=e.render({}),this.content},postRender:function(){this.renderForm({idCase:this.params.idCase,idWorkitem:this.params.idWorkitem,idTask:this.params.idTask,radNumber:this.params.radNumber,withOutGlobalForm:this.params.withOutGlobalForm||!1,isClosed:this.params.isClosed,belongCurrentUser:this.params.belongCurrentUser,hasGlobalForm:bizagi.util.parseBoolean(this.params.hasGlobalForm),showForm:bizagi.util.parseBoolean(this.params.showForm),isOfflineForm:this.params.isOfflineForm||!1,messageForm:this.params.messageForm||"",where:this.params.where})},renderForm:function(e){var t=this,a=t.getContent();if(!e.isClosed&&!e.belongCurrentUser&&!e.hasGlobalForm&&(e.withOutGlobalForm=!0),e.withOutGlobalForm){var i=t.workportalFacade.getTemplate("info-message"),s=""!==e.messageForm?e.messageForm:t.resources.getResource("render-without-globalform"),o=t._textActionNoActivitiesButton(e.where);void 0!==t.params&&void 0!==t.params.isOfflineForm&&1==t.params.isOfflineForm&&(s=bizagi.util.getMessageFromNetworkState(t.dataService.online));var r=$.tmpl(i,{message:s,textButton:o.text});r.appendTo(a),$("#ui-bizagi-btn-go-to-inbox",r).click(t.onClickButtonNoActivities.bind(t,o.actionGoBack)),$.Deferred().fail()}else{var n=null!=_typeof(t.dataService.serviceLocator.proxyPrefix)?t.dataService.serviceLocator.proxyPrefix:"",c=null!=_typeof(t.dataService.database)?t.dataService.database:"",l=t.rendering=new bizagi.rendering.facade({proxyPrefix:n,database:c});bizagi.util.setContext(e),t.rendering.subscribe("onLoadDataItemsFromFormActivityPlan",(function(e,a){t.pub("notify",{type:"UPDATE_ITEMS_FROM_FORMRENDER",args:a})})),t.rendering.subscribe("rendering-formRendered",(function(e,a){t.pub("notify",{type:"ON_RENDER_FINISH",args:a})}));l.execute($.extend(e,{canvas:a,menu:t.menu}));a.bind("routing",(function(e,a){var i={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase,fromTask:t.params.fromTask||t.params.idTask,fromWorkItemId:t.params.fromWorkItemId||t.params.idWorkitem,isOfflineForm:t.params.isOfflineForm,formsRenderVersion:t.params.formsRenderVersion,onClose:function(){t.publish("changeWidget",{widgetName:bizagi.util.defaultWidget()})}};i=$.extend(i,a),t.publish("executeAction",i)}))}t.renderingFacade=l,t.resizeLayout()},onClickButtonNoActivities:function(e){var t=this;e?bizagi.injector.get("backNavigator").goToBack.call(t):t.publish("changeWidget",{widgetName:t.workportalFacade.workportal.getWidgetByCookie(!0)})},_textActionNoActivitiesButton:function(e){var t,a=bizagi.workportal.actions.routing.RETURN_TO,i=!0;switch(e){case a.BAM:case a.QUERIES:t="workportal-without-globalform-button-to-results";break;case a.INBOX:t="workportal-without-globalform-button-to-inbox";break;default:t="render-without-globalform-button",i=!1}return{text:this.resources.getResource(t),actionGoBack:i}},clean:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.project.activity",["workportalFacade","dataService",bizagi.workportal.widgets.project.activity],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.activity.plan.sidebar",{},{init:function(e,t,a){this._super(e,t,a),(a=a||{}).supportNav=!1,this.loadTemplates({"project-activity-plan-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.activity.plan.sidebar").concat("#project-activity-plan-sidebar")})},renderContent:function(){var e=!1,t=this.getTemplate("project-activity-plan-sidebar");return e=!(!this.params.isAdhocProcess||void 0===this.params.isAdhocProcess)&&this.params.isAdhocProcess,this.content=t.render({hasRelatedPlan:this.params.planChild,showPlanAction:this.params.menuDashboard.showPlanOptionMenu,isAdhocProcess:e}),this.content},postRender:function(){var e=this.getContent();$(".ui-bizagi-wp-project-activity-plan-sidebar-action-add > a",e).on("click",$.proxy(this.loadPlanForm,this))},loadPlanForm:function(){if(this.params.planChild){var e=new bizagi.workportal.services.behaviors.plan(this.dataService).getPlanAsParent(this.params.plan);this.params.planParent=this.getPlanParent(e)}var t=!this.params.planChild||"EXECUTING"!==this.params.planChild.currentState&&"CLOSED"!==this.params.planChild.currentState&&"PENDING"!==this.params.planChild.currentState?this.params.menuDashboard.contextPlanOptionMenu:"PLANACTIVITIES",a=this.pub("notify",{type:"NAVIGATOR_GETLEVEL"}),i=parseInt(a[0]),s="",o=i;"PLANOVERVIEW"!==t&&"PLANACTIVITIES"!==t||(o=i+1,s=bizagi.localization.getResource("workportal-project-casedashboard-plan")),this.params.refreshLastItemBreadcrumb=!1,this.pub("notify",{type:t.toUpperCase(),args:$.extend(this.params,{showContextByMenuDashboard:t,histName:s,level:o})})},getPlanParent:function(e){var t=this;return bizagi.util.tryCatch((function(){return e.id===t.params.planChild.id}),!1)?void 0:e},clean:function(){$(".ui-bizagi-wp-project-activity-plan-sidebar-action-add > a",this.getContent()).off("click",$.proxy(this.loadPlanForm,this))}}),bizagi.injector.register("bizagi.workportal.widgets.project.activity.plan.sidebar",["workportalFacade","dataService",bizagi.workportal.widgets.project.activity.plan.sidebar],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.caseState",{},{init:function(e,t,a){this._super(e,t,a),this.contextsSidebarActivity=a.contextsSidebarActivity,this.datePickerRegional=bizagi.localization.getResource("datePickerRegional"),this.loadTemplates({"project-caseState":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.caseState").concat("#project-caseState-wrapper"),"project-caseState-remaining":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.caseState").concat("#project-caseState-remaining"),"project-cancel-case-button":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.caseState").concat("#project-caseState-cancel-case-button")})},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){var e=this;(e.contextsSidebarActivity||[]).forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){var a=this;$.extend(a.params,t.args);var i=t.args;a.getContent().empty();var s={isFavoriteCase:"off"};if(i.isFavorite&&JSON.parse(i.isFavorite)?s.isFavoriteCase="bz-icon-star":s.isFavoriteCase="bz-icon-star-outline",a.showCaseNumber(i,s),i.creationDate){var o=bizagi.currentUser.timeZoneName,r=i.creationDate,n=a.getDateWithTimezone("MM/DD/yyyy H:mm",o,r);s.creationDateFormat=a.getFormattedDate(n);var c=a.getDateWithTimezone("MM/DD/yyyy H:mm",o,i.solutionDate);s.solutionDateFormat=a.getFormattedDate(c);var l=a.getDateWithTimezone("MM/DD/yyyy H:mm",o);a.calculateDataForTemplate(s,n,l,c,i)}$(a.getContent()).on("click",".show-diagram-case",(function(){!(!a.params.isAdhocProcess||void 0===a.params.isAdhocProcess)?a.showGraphicQuery({idCase:a.params.idCaseForGraphicQuery||a.params.idCase,idWorkflow:a.params.idWorkFlow,isAdhoc:!0,idProcess:a.params.idAdhocProcess}):a.showGraphicQuery({idCase:a.params.idCaseForGraphicQuery||a.params.idCase,idWorkflow:a.params.idWorkflow})})),$(a.getContent()).on("click",".show-process-help",(function(){a.showHelpUrl(a.params.helpUrl)}))},calculateDataForTemplate:function(e,t,a,i,s){var o=this.getContent(),r=bizagi.currentUser.timeZoneName,n={};n.idUser=bizagi.currentUser.idUser,bizagi.util.parseBoolean(s.isOpen)?(n.fromDate=t.getTime(),n.toDate=a.getTime()):(n.fromDate=i.getTime(),n.toDate=a.getTime());var c=n.toDate-n.fromDate,l=this.getDateWithTimezone("MM/DD/yyyy H:mm",r),p=bizagi.util.dateFormatter.getRelativeTime(new Date(l.getTime()-c),null,!1,r);bizagi.util.parseBoolean(s.isOpen)?(e.relativeTimeState=bizagi.localization.getResource("workportal-project-case-state-opened").replace("%s",p),e.colorStateCase="Opened"):(e.relativeTimeState=bizagi.localization.getResource("workportal-project-case-state-closed").replace("%s",p),e.colorStateCase="Closed"),e.percentCompleteBar=100,e.isOpen=bizagi.util.parseBoolean(s.isOpen),this.getTemplate("project-caseState-remaining").render($.extend(s,e)).appendTo($("#ui-bizagi-remaining",o))},showCancelCase:function(e,t,a){var i=this,s=i.getContent(),o=i.getTemplate("project-cancel-case-button");t.buttonCancelCase=a,o.render($.extend(e,t)).appendTo($("#ui-bizagi-cancel-case",s)),$("#ui-bizagi-wp-project-activity-cancel-case-button > a",i.content).click((function(){var e={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_CANCEL_CASE,maximize:!1,dialogClass:"bz-cancel-case-widget",idWorkitem:i.params.idWorkitem,idCase:i.params.idCase,modalParameters:{refreshInbox:!1,title:bizagi.localization.getResource("workportal-widget-cancel-case-title"),width:420,height:400},closeVisible:!1};i.publish("showDialogWidget",e)}))},showCaseNumber:function(e,t){var a=this.getContent(),i=this.getTemplate("project-caseState"),s=!1;s=!(!this.params.isAdhocProcess||void 0===this.params.isAdhocProcess)&&this.params.isAdhocProcess,this.params.helpUrl=bizagi.util.validateUrlWellFormed(this.params.helpUrl),i.render($.extend(e,t,{security:bizagi.menuSecurity,isAdhocProcess:s,urlHelp:!bizagi.util.isEmpty(this.params.helpUrl)})).appendTo(a),this._startShowCancelCase(e,t),$(".case-summary-favorite",a).on("click",$.proxy(this.onClickFavorite,this)),$(".case-summary-back",this.content).on("click",$.proxy(this.goToCase,this,"back")),$(".case-summary-next",this.content).on("click",$.proxy(this.goToCase,this,"next")),this.showBackNextNavigation()},_startShowCancelCase:function(e,t){var a=bizagi.injector.get("bizagi.workportal.widgets.navigator"),i=this.showCancelCase.bind(this,e,t);a.getShowCancelCase().done(i)},getFormattedDate:function(e){var t=this.datePickerRegional.monthNames,a=e.getMonth(),i=BIZAGI_LANGUAGE;return null!=i&&null!=i&&i.length>0&&"fr"==i.substring(0,2)?$.datepicker.formatDate("dd",e)+" "+t[a]:t[a]+" "+$.datepicker.formatDate("dd",e)},onClickFavorite:function(e){e.preventDefault();var t=this,a={};$(e.target).hasClass("bz-icon-star-outline")?(a={idObject:t.params.idCase,favoriteType:"CASES"},$.when(t.dataService.addFavorite(a)).done((function(a){t.params.guidFavorite=a.idFavorites,$(e.target).removeClass("bz-icon-star-outline"),$(e.target).addClass("bz-icon-star")}))):(a={idObject:t.params.guidFavorite,favoriteType:"CASES"},$.when(t.dataService.delFavorite(a)).done((function(){$(e.target).addClass("bz-icon-star-outline"),$(e.target).removeClass("bz-icon-star")})))},showHelpUrl:function(e){window.open(e)},callGetEffectiveDuration:function(e){var t=$.Deferred();return e.fromDate?$.when(this.dataService.getEffectiveDuration(e)).done((function(e){t.resolve(e)})):t.resolve(null),t.promise()},clean:function(){var e=this;$(".show-diagram-case",e.getContent()).off();var t=e.contextsSidebarActivity||[];this.params={},t.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))},goToCase:function(e){var t="back"==e?this.getBackCase():this.getNextCase();t>0&&this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})},getListKey:function(){if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(var e=0;e<bizagi.lstIdCases.length;e++)if(this.params.idCase==bizagi.lstIdCases[e])return e;return-1},getNextCase:function(){var e=this.getListKey();return bizagi.lstIdCases.length==e+1||1==bizagi.lstIdCases.length?-1:bizagi.lstIdCases[e+1]},getBackCase:function(){var e=this.getListKey();return 0==e?-1:bizagi.lstIdCases[e-1]||-1},showBackNextNavigation:function(){var e=this.getNextCase(),t=this.getBackCase();e<=0?$(".case-summary-next",this.content).hide():$(".case-summary-next",this.content).show(),t<=0?$(".case-summary-back",this.content).hide():$(".case-summary-back",this.content).show(),e<=0&&t<=0?($(".content-right-sidebar").removeClass("bz-state-number--active-case"),$(".bz-case-navigation").hide()):($(".content-right-sidebar").addClass("bz-state-number--active-case"),$(".bz-case-navigation").show())}}),bizagi.injector.register("bizagi.workportal.widgets.project.caseState",["workportalFacade","dataService",bizagi.workportal.widgets.project.caseState]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.desktop.widgets.project.cancelCase",{},{init:function(e,t,a){this._super(e,t,a),this.notifier=bizagi.injector.get("notifier"),a=a||{},this.loadTemplates({"project-cancel-case-wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.cancelCase").concat("#project-caseState-cancel-case-wrapper"),"project-cancel-case-wrapper-error":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.cancelCase").concat("#project-caseState-cancel-case-wrapper-error")})},renderContent:function(){var e=this.getTemplate("project-cancel-case-wrapper");return this.content=e.render({}),this.defineButtons(),this.content},defineButtons:function(){var e=this;e.params.buttons=[{text:bizagi.localization.getResource("workportal-general-word-no"),class:"bz-cancel-case__btn biz-wp-button-secondary",click:function(){$(this).dialog("close")}},{text:bizagi.localization.getResource("workportal-general-word-yes"),class:"bz-cancel-case__btn",click:function(){e.cancelCaseRequest()}}]},cancelCaseRequest:function(){var e,t=this,a=$("#bz-wp-cancelcase-wrapperload",t.content);e=$("textarea#cancel-case-reason").val();var i={idWorkitem:t.params.idWorkitem,action:"abort",cases:JSON.stringify({cases:[{idCase:t.params.idCase}]}),reason:e};bizagi.showErrorAlertDialog=!1,""!=e?(a.show(),$.when(t.dataService.cancelCase(i)).done((function(e){e.response[0].deleted?(a.hide(),t.notifier.showSucessMessage(bizagi.localization.getResource("workportal-widget-cancel-case-the-case-was-cancelled-successfully")),$(".ui-dialog-content").dialog("close"),bizagi.injector.get("bizagi.workportal.widgets.navigator",{}).goToBack()):(a.hide(),bizagi.showToastError(bizagiConfig.environment,e.response[0].idCase))})).fail((function(e){var t=e.status+" - "+e.statusText;bizagi.showToastError(bizagiConfig.environment,t),a.hide(),bizagi.log(e)}))):($("textarea#cancel-case-reason").css("border-color","#F50E0E"),$(".bz-cancel-case__help-text").text(bizagi.localization.getResource("workportal-widget-cancel-case-the-cancellation-reason-is-mandatory")).css("color","#F50E0E"),t.showTextIsRequired())},showTextIsRequired:function(){$("textarea#cancel-case-reason").bind("input propertychange",(function(){$("textarea#cancel-case-reason").css("border-color","#F50E0E"),$(".bz-cancel-case__help-text").text(bizagi.localization.getResource("workportal-widget-cancel-case-the-cancellation-reason-is-mandatory")).css("color","#F50E0E"),this.value.length&&($("textarea#cancel-case-reason").css("border-color","#"),$(".bz-cancel-case__help-text").text(bizagi.localization.getResource("workportal-widget-cancel-case-max-characters")).css("color","##757575"))}))}}),bizagi.injector.register("bizagi.workportal.desktop.widgets.project.cancelCase",["workportalFacade","dataService",bizagi.workportal.desktop.widgets.project.cancelCase],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.activityState",{},{init:function(e,t,a){this._super(e,t,a),this.contextsSidebarActivity=a.contextsSidebarActivity,this.datePickerRegional=bizagi.localization.getResource("datePickerRegional"),this.loadTemplates({"project-activityState-wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.activityState").concat("#project-activityState-wrapper")})},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){var e=this;e.contextsSidebarActivity.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){var a=t.args;this.params=a,this.getContent();var i=bizagi.currentUser.timeZoneName,s={},o=a.currentState||[],r=o.filter((function(e){return e.idWorkItem==a.idWorkitem}))[0];if(r){s.activityName=r.state,s.activityIsEvent=bizagi.util.parseBoolean(r.isEvent);var n=this.getDateWithTimezone("MM/DD/yyyy H:mm",i,r.entryDateWorkItem);n.getTime&&(s.initDateFormat=this.getFormattedDate(n));var c=this.getDateWithTimezone("MM/DD/yyyy H:mm",i),l=this.getDateWithTimezone("MM/DD/yyyy H:mm",i,r.estimatedSolutionDate);s.estimatedSolutionDateFormat="",n.getTime&&l.getTime&&r?this.calculateDataForTemplate(r,s,n,c,l,o):this.updateTemplateWidget(s,o)}},initilizeActionMenu:function(e){var t=this,a=!1;if(e&&e.length>0)for(j=0;j<e.length;++j)e[j]&&t.params&&e[j].idWorkItem==t.params.idWorkitem&&(a=bizagi.util.parseBoolean(e[j].allowsReassign)||!1);var i=$("#bt-case-action-reassing",t.content),s=$("#ui-bizagi-wp-project-activity-button:not(.ui-bizagi-wp-project-activity-shared)",t.content);a&&i.show(),i.on("click",(function(){t.onClickMenuReasign()})),s.on("click",(function(){t.onClickShareActivity()}))},onClickMenuReasign:function(){var e=this,t=e.params.idCase,a=e.params.idWorkitem,i=function(){e.publish("closeCurrentDialog")};bizagi.loader.startAndThen("admin").then((function(){$.when(e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,data:{idCase:t,idWorkItem:a,closeDialogWidget:i},closeVisible:!1,maximize:!0,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign"),width:"910px",id:"CaseAdmin"}}))}))},onClickShareActivity:function(){var e={idWorkItem:this.params.idWorkitem},t=$("#ui-bizagi-wp-project-activity-button",this.content);t.attr("disabled",!0),$.when(this.dataService.getShareActivity(e)).done((function(e){var a=window.parent.bizagi.injector.get("notifier");!0===e.value?(t.addClass("ui-bizagi-wp-project-activity-shared").unbind("click"),a.showSucessMessage(bizagi.localization.getResource("workportal-project-activity-success-message"),"")):a.showErrorMessage(bizagi.localization.getResource("workportal-project-activity-error-message"),"")})).always((function(){t.attr("disabled",!1)}))},calculateDataForTemplate:function(e,t,a,i,s,o){var r=bizagi.currentUser.timeZoneName,n=i.getTime()-s.getTime(),c=a.getTime()-s.getTime(),l=(bizagi.currentUser.idUser,a.getTime()),p=this.getDateWithTimezone("MM/DD/yyyy H:mm",r).getTime(),d=!1,u={idUser:bizagi.currentUser.idUser,fromDate:i.getTime(),toDate:s.getTime()},g={};n>0?(u.fromDate=s.getTime(),u.toDate=i.getTime(),d=!0):(g.idUser=bizagi.currentUser.idUser,g.fromDate=a.getTime(),g.toDate=s.getTime());var h=p-l,m=u.toDate-u.fromDate,b=n>0?0:g.toDate-g.fromDate,w=this.getDateWithTimezone("MM/DD/yyyy H:mm",r),v=bizagi.util.dateFormatter.getRelativeTime(new Date(w.getTime()-h),null,!1,r);if(t.colorState=e.colorState,t.relativeTimeState=bizagi.localization.getResource("workportal-project-activity-state-opened").replace("%s",v),t.percentCompleteBar=100,0===c)t.showEstimatedSolutionDate=!1;else if(t.showEstimatedSolutionDate=!0,!1===d){var f=this.getPercentBar(b/1e3/60,m/1e3/60);t.percentCompleteBar=f.percent}e&&(t.isEvent=bizagi.util.parseBoolean(e.isEvent),t.canShareActivity=e.canShareActivity,t.isShared=e.isShared),t.estimatedSolutionDateFormat=this.getFormattedDate(s),this.updateTemplateWidget(t,o)},getPercentBar:function(e,t){var a={};return a.percent=Math.round(100*(1-t/e)),a},updateTemplateWidget:function(e,t){var a=this.getContent().empty();!1===bizagi.override.enableShareActivity&&(e.canShareActivity=!1,e.isShared=!1),this.getTemplate("project-activityState-wrapper").render(e).appendTo(a),t.length>0&&this.initilizeActionMenu(t),this.shareActivityTooltip()},shareActivityTooltip:function(){var e=$("#ui-bizagi-wp-project-activity-button",this.content);e.on("mouseenter",(function(){var t=e.hasClass("ui-bizagi-wp-project-activity-shared")?"workportal-project-activity-shared":"workportal-project-activity-share";e.attr("title",bizagi.localization.getResource(t))})),e.tooltip({tooltipClass:"custom-tooltip-styling-bottom-bar",position:{my:"right top",at:"left top",of:e,collision:"flip"}})},getFormattedDate:function(e){var t=this.datePickerRegional.monthNames,a=e.getMonth(),i=BIZAGI_LANGUAGE;return null!=i&&null!=i&&i.length>0&&"fr"==i.substring(0,2)?$.datepicker.formatDate("dd",e)+" "+t[a]:t[a]+" "+$.datepicker.formatDate("dd",e)},clean:function(){var e=this,t=e.contextsSidebarActivity||[];this.params={},t.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))},callGetEffectiveDuration:function(e){var t=this,a=$.Deferred();return setTimeout((function(){e.fromDate?$.when(t.dataService.getEffectiveDuration(e)).done((function(e){a.resolve(e)})):a.resolve(null)}),200),a.promise()}}),bizagi.injector.register("bizagi.workportal.widgets.project.activityState",["workportalFacade","dataService",bizagi.workportal.widgets.project.activityState]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.processState",{},{init:function(e,t,a){this._super(e,t,a),this.contextsSidebarActivity=a.contextsSidebarActivity,this.loadTemplates({"project-process-state":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.processState").concat("#project-process-state")})},renderContent:function(){var e=this.getTemplate("project-process-state");return this.content=e.render({}),this.content},postRender:function(){var e=this;e.contextsSidebarActivity.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){var a=t.args,i=this.getContent().empty();this.params=a;var s={};s.showParentProcess=a.idParentCase>=1,s.parentProcess={displayName:a.parentDisplayName,idCase:a.idParentCase,idWorkItem:a.idWorkItem,idTask:"0"==a.idTask?"":a.idTask,idWorkflow:a.idWorkflowParentCase},this.getTemplate("project-process-state").render($.extend(a,s)).appendTo(i),$("#go-to-parent-case",i).on("click",$.proxy(this.onClickGoToParentCase,this))},onClickGoToParentCase:function(e){e.preventDefault();this.routingExecute($(e.target).closest("#go-to-parent-case"))},clean:function(){var e=this;e.params={},e.contextsSidebarActivity.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))}}),bizagi.injector.register("bizagi.workportal.widgets.project.processState",["workportalFacade","dataService",bizagi.workportal.widgets.project.processState]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.users",{},{init:function(e,t,a,i){this.relatedusers=a,this._super(e,t,i),this.contextsSidebarActivity=i.contextsSidebarActivity,this.plugins={},this.users=[],this.loadedUsers=!1,this.loadTemplates({"project-users":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.users").concat("#project-users-main")})},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){var e=this;e.contextsSidebarActivity.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))})),e.sub("ON_RENDER_FINISH",$.proxy(e.onRenderFinish,e))},updateView:function(e,t){var a=this;a.params=t,setTimeout((function(){!1===a.loadedUsers&&a.onRenderFinish()}),500)},onRenderFinish:function(){var e=this.params.args,t=this.getContent().empty();this.loadedUsers=!0,this.getTemplate("project-users").render().appendTo(t),this.showCreatorInformation(t);var a=[{id:e.createdBy.userId,typeName:"owner"}];e.idCase>0&&this.relatedusers.render(this.content,".relatedusers-wrapper",e.idCase,a)},showCreatorInformation:function(e){var t=this,a={userIds:t.params.args.createdBy.userId,width:50,height:50};t.dataService.getUsersData(a).done((function(a){var i=usersAdapter.createJsonUserInfo(a[0].id,a[0].name,a[0].username,a[0].picture?"data:image/png;base64,"+a[0].picture:void 0,a[0].email,a[0].name.getInitials(),!1,!0,[],[]);e.find("#ui-bizagi-wp-project-users-wrapper .ui-bizagi-wp-project-users-creator-info").userinformation(t,{user:i})}))},clean:function(){var e=this;e.loadedUsers=!1,e.contextsSidebarActivity.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))}}),bizagi.injector.register("bizagi.workportal.widgets.project.users",["workportalFacade","dataService","relatedusers",bizagi.workportal.widgets.project.users]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.subprocesses.data",{responseSubprocessState:{},responseSubprocess:function(e){return e&&(responseSubprocessState=e),responseSubprocessState},auxArrayListSubprocessesState:[],auxArrayListSubprocesses:function(e){return e?jQuery.isArray(e)&&0===e.length?void(this.auxArrayListSubprocessesState.length=0):this.auxArrayListSubprocessesState.push(e):this.auxArrayListSubprocessesState}},{init:function(e,t,a){this._super(e,t,a),this.Class.auxArrayListSubprocesses([]),this.loadTemplates({"project-subprocesses-tootip-custom-properties":bizagi.getTemplate("bizagi.workportal.desktop.widgets.project.subprocesses.data").concat("#project-subprocesses-tooltip-custom-properties-wrapper")})},initializeTooltip:function(e){var t=this,a=t.getContent();$(e,a).tooltip({position:{collision:"flipfit",my:"right center",at:"left-10 center"},show:null,content:function(){var e,a,i,s=$(this).closest("li").find("#idCase").val(),o=t.Class.auxArrayListSubprocesses().filter((function(e){return e.idCase==s}));if(o.length>0)return e=o[0].indexSubprocess,a=o[0].idCustData,i=$(this).text(),t.getContentTooltip(e,a,i,t.getTemplate("project-subprocesses-tootip-custom-properties"))},open:function(e,t){if(void 0===e.originalEvent)return!1;var a=$(t.tooltip).attr("id");$("div.ui-tooltip").not("#"+a).remove()},close:function(e,t){t.tooltip.hover((function(){$(this).stop(!0).fadeTo(400,1)}),(function(){$(this).fadeOut("400",(function(){$(this).remove()}))}))}})},getContentTooltip:function(e,t,a,i){"-1"==t&&(t="0");var s=function(e,t){return{nameProperty:e,valueProperty:t}},o=[],r="",n=this.getSubprocessData(e,t),c=n.custData,l=n.custDataTypes,p=n.custFields,d=n.displayName;if(o.push(new s(bizagi.localization.getResource("workportal-widget-inboxcommon-subprocess"),d)),c.length)for(var u=0;u<c.length;u+=1)r=c[u],l&&("Money"==l[u]?r=bizagi.util.formatMonetaryCell(r):"Boolean"==l[u]?r=bizagi.util.formatBoolean(r):"Float"==l[u]||"Real"==l[u]?r=bizagi.util.formatDecimalCell(r):"function"==typeof r&&(r="")),o.push(new s(p[u],r));var g={};g.arrayCustomsProperties=o,g.nameSubprocess=a;var h=i,m=$('<div class="bizagi-custom-tooltip-subprocesses"></div>');return h.render(g).appendTo(m),m.html()},getSubprocessData:function(e,t){var a={},i=this.Class.responseSubprocess().subProcesses,s=this.Class.responseSubprocess().subProcPersonalized;if(i&&i.length>0){a.custData=i[e].custData,a.custDataTypes=i[e].custDataTypes;var o=this.Class.responseSubprocess().CustFields[t];a.custFields=o[Object.keys(o)[0]],a.displayName=i[e].displayName}else s&&Object.keys(s).length>0&&(a.custData=s[0].subProcesses[e].custData,a.custDataTypes=s[0].subProcesses[e].custDataTypes,a.custFields=s[0].CustFields[0],a.displayName=s[0].subProcesses[e].displayName);return a},clean:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.project.subprocesses.data",["workportalFacade","dataService",bizagi.workportal.widgets.project.subprocesses.data]),bizagi.workportal.widgets.project.subprocesses.data.extend("bizagi.workportal.widgets.project.events",{},{init:function(e,t,a){this._super(e,t,a),this.contextsSidebarActivity=a.contextsSidebarActivity,this.loadTemplates({"project-events":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.events").concat("#project-events-wrapper")})},renderContent:function(){var e=this.getTemplate("project-events");return this.content=e.render({}),this.content},postRender:function(){var e=this;e.contextsSidebarActivity.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){var a=this,i=t.args,s=a.getContent().empty();a.params=i,$.when(a.getArgsTemplate(i)).done((function(e){a.getTemplate("project-events").render($.extend(i,e)).appendTo(s),$(".list-events li.event a",s).on("click",$.proxy(a.onClickGoEvent,a)),a.initializeTooltip(".list-events li")}))},getArgsTemplate:function(e){var t=$.Deferred(),a={};if(e.countEvents>=1)for(var i=0;i<e.currentState.length;i++)"true"==e.currentState[i].isEvent&&e.currentState[i].idWorkItem==e.idWorkitem&&(e.countEvents=e.countEvents-1);return a.showEvents=e.countEvents>=1,a.showEvents?$.when(this.callSummaryCaseEvents(e.idCase)).done((function(i){e.showEvents=i.events.length>=1,e.showEvents&&(a.events=[],i.events.forEach((function(e){a.events.push($.extend(e[Object.keys(e)[0]],{idWorkFlow:i.idWorkFlow}))}))),t.resolve(a)})):t.resolve(a),t.promise()},onClickGoEvent:function(e){e.preventDefault();var t=this;$.when(bizagi.util.autoSave()).done((function(){t.routingExecute($(e.target).closest("li"))}))},callSummaryCaseEvents:function(e){var t=$.Deferred();return $.when(this.dataService.summaryCaseEvents({idCase:e})).done((function(e){t.resolve(e)})),t.promise()},clean:function(){var e=this;this.params={},e.contextsSidebarActivity.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))}}),bizagi.injector.register("bizagi.workportal.widgets.project.events",["workportalFacade","dataService",bizagi.workportal.widgets.project.events],!0),bizagi.workportal.widgets.project.subprocesses.data.extend("bizagi.workportal.widgets.project.subprocesses",{responseSubprocess:function(e){return this._super(e)},auxArrayListSubprocesses:function(e){return this._super(e)}},{init:function(e,t,a){this._super(e,t,a),this.contextsSidebarActivity=a.contextsSidebarActivity,this.loadTemplates({"project-subprocesses":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.subprocesses").concat("#project-subprocesses-wrapper")})},renderContent:function(){return this.content=$("<div></div>"),this.content},postRender:function(){var e=this;e.contextsSidebarActivity.forEach((function(t){e.sub(t,$.proxy(e.updateView,e))}))},updateView:function(e,t){var a=this,i=t.args;a.getContent().empty();a.params=i,a.params.idCase>0&&$.when(a.dataService.summarySubProcess({idCase:a.params.idCase})).done((function(e){a.Class.responseSubprocess(e),a.organizeDataForSubprocesses(a.params)}))},organizeDataForSubprocesses:function(e){var t=this;if(t.Class.responseSubprocess().showSubProcess){$.each(t.Class.responseSubprocess().subProcesses,(function(e){var a=t.Class.responseSubprocess().subProcesses[e].custData;if(a&&a.length)for(var i=0;i<a.length;i+=1)null===a[i]&&(a[i]="")}));var a=t.Class.responseSubprocess().subProcesses||t.Class.responseSubprocess().subProcPersonalized;t.Class.auxArrayListSubprocesses([]);for(var i=0;i<Object.keys(a).length;i+=1){var s=a[i];t.Class.auxArrayListSubprocesses({isOpen:s.isOpen,radNumber:s.radNumber,displayName:s.displayName,idCase:s.idCase,indexSubprocess:i,idCustData:s.idCustData}),s.subProcesses&&Object.keys(s).forEach((function(e){t.Class.auxArrayListSubprocesses({isOpen:s[e].isOpen,radNumber:s[e].radNumber,displayName:s[e].displayName,idCase:s[e].idCase,indexSubprocess:i,idCustData:s[e].idCustData})}))}t.renderWidget()}},renderWidget:function(){var e=this.getContent();this.getTemplate("project-subprocesses").render({auxArrayListSubprocesses:this.Class.auxArrayListSubprocesses()}).appendTo(e),$(".list-subprocesses a",e).on("click",$.proxy(this.onClickGoSubprocess,this)),this.initializeTooltip(".list-subprocesses li")},onClickGoSubprocess:function(e){e.preventDefault();this.routingExecute($(e.target).closest("li"))},clean:function(){var e=this;e.params={},e.pluginTooltip=null,e.contextsSidebarActivity.forEach((function(t){e.unsub(t,$.proxy(e.updateView,e))}))}}),bizagi.injector.register("bizagi.workportal.widgets.project.subprocesses",["workportalFacade","dataService",bizagi.workportal.widgets.project.subprocesses]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.activity.description",{},{init:function(e,t,a){this._super(e,t,a),a=a||{},this.loadTemplates({"project-activity-description":bizagi.getTemplate("bizagi.workportal.desktop.widget.project.activity.description").concat("#project-activity-description")})},renderContent:function(){var e=this.getTemplate("project-activity-description");return this.content=e.render(),this.content},postRender:function(){this.description=this.getWorkitemDescription(),this.description?this.callTaskDescription():this.content=$("<div />")},callTaskDescription:function(){var e={container:$("#ui-bizagi-wp-project-activity-task_description_container",this.content),description:this.description,width:310};this.taskDescriptionWidget=new bizagi.workportal.widgets.task.description(this.workportalFacade,this.dataService,e),this.taskDescriptionWidget.render()},getWorkitemDescription:function(){for(var e=this.params||{},t=e.idWorkitem||0,a=e.currentState||[],i="",s=0;s<a.length;s++)if(t==a[s].idWorkItem){i=a[s].tskDescription;break}return i},clean:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.project.activity.description",["workportalFacade","dataService",bizagi.workportal.widgets.project.activity.description],!0);
//# sourceMappingURL=../../../../Maps/desktop/activity.desktop.production.js.map
