function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}$.Class.extend("bizagi.kendo.templates.services.service",{customTemplateFile:bizagi.loader.getResource("tmpl","bizagi.overrides."+bizagi.detectDevice()+".custom.templates"),cachedFiles:{},cachedTemplates:{},customTemplates:{}},{init:function(e){this.localization=e,this.cssRegex=/{{css "(.+)"}}/g,this.loadingFileDeferred={}},loadCustomTemplates:function(){var e=this,t=new $.Deferred;return $.when(this.getTemplateFile(this.Class.customTemplateFile)).done((function(i){var r=$("<div />").html(i),a=$("script",r);$.each(a,(function(t,i){i=$(i),e.Class.customTemplates[i.attr("id")]=i.html()})),t.resolve()})),t.promise()},getTemplate:function(e,t){var i=!1;if(e=(e=e.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3")).replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.-]*)/g,"$1?$3#$2"),bizagi.enableCustomizations){var r=this.getHash(e);this.Class.customTemplates[r]&&(i=!0)}return i||"release"!==bizagi.loader.environment?this.internalGetTemplate(e,t).pipe((function(e){return e})):this.getTemplateForRelease(e,t).pipe((function(e){return e}))},getTemplateWidget:function(e,t){var i=!1;if(e=(e=e.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3")).replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.-]*)/g,"$1?$3#$2"),bizagi.enableCustomizations){var r=this.getHash(e);this.Class.customTemplates[r]&&(i=!0)}return i||"release"!==bizagi.loader.environment?this.internalGetTemplate(e,t).pipe((function(e){return e})):this.getTemplateForRelease(e,t).then((function(e){return e}))},getTemplateWebpart:function(e,t){return e=(e=e.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3")).replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.-]*)/g,"$1?$3#$2"),this.internalGetTemplate(e,t).pipe((function(e){return e}))},getTemplateForRelease:function(e,t){var i,r,a=this,n=$.Deferred();return a.containsHash(e)?(i=a.getUrlWithoutHashes(e),r=a.getHash(e)):(i=e,r=""),a.Class.cachedTemplates[i]?n.resolve(a.processAndReturnTemplate(i,r,t)):$.when(a.loadTemplateFileForRelease(i)).done((function(){n.resolve(a.processAndReturnTemplate(i,r,t))})),n.promise()},loadTemplateFileForRelease:function(e){var t=this,i=$.Deferred();return t.Class.cachedTemplates[e]?t.Class.cachedTemplates[e]:t.loadingFileDeferred[e]?($.when(t.loadingFileDeferred[e]).done((function(){i.resolve(t.Class.cachedTemplates[e])})),i.promise()):(t.loadingFileDeferred[e]=$.Deferred(),$.when($.ajax({url:e,dataType:"text"}),t.localization.ready()).done((function(r){var a,n,o;for(a in r||i.reject(""),"string"!=typeof r&&(r=JSON.parse(r[0])),t.Class.cachedTemplates[e]=r,r)r.hasOwnProperty(a)&&(n=r[a],o=(o=t.localization.translate(n)).replace(t.cssRegex,""),t.Class.cachedTemplates[e][a]=o);t.loadingFileDeferred[e].resolve(),i.resolve(r)})),i.promise())},processAndReturnTemplate:function(e,t,i){var r=this.Class.cachedTemplates[i];if(!r){if(!(r=this.Class.cachedTemplates[e][t]))throw"template "+r+"doesn't exist";this.Class.cachedTemplates[i]=r}return r},internalGetTemplate:function(e,t){var i=this,r=new $.Deferred,a=this.Class.cachedTemplates[t];if(a)r.resolve(a);else if(i.containsHash(e)){var n=i.getUrlWithoutHashes(e),o=i.getHash(e);if(i.Class.customTemplates[n]&&i.Class.customTemplates[n][t])return r.resolve(i.Class.customTemplates[o]),r.promise();$.when(i.getTemplatePart(n,o,t)).done((function(e){i.Class.cachedTemplates[t]=e,r.resolve(e)}))}else $.when(i.getTemplateFile(e)).done((function(e){i.Class.cachedTemplates[t]=e,r.resolve(e)}));return r.promise()},getTemplatePart:function(e,t){var i=this,r=new $.Deferred;return $.when(i.loadingTemplatePartExecution).done((function(){i.loadingTemplatePart=!0,i.loadingTemplatePartExecution=new $.Deferred,$.when(i.getTemplateFile(e)).done((function(a){var n=$("<div />").html(a),o=$("#"+t,n);"debug"===BIZAGI_ENVIRONMENT&&0===o.length&&console.warn("No template part ("+t+") found in content for:"+e),a=o.html(),i.loadingTemplatePartExecution.resolve(),i.loadingTemplatePart=!0,r.resolve(a)}))})),r.promise()},getTemplateFile:function(e){var t=this,i=this.Class.cachedFiles[e];return i||$.when($.ajax({url:e,dataType:"text"}),t.localization.ready()).pipe((function(i){if(!i)return"";"string"!=typeof i&&(i=i[0]);var r=t.localization.translate(i),a=r.match(t.cssRegex);return a&&$.each(a,(function(e,i){var r=i.replace(t.cssRegex,"$1");bizagi.loader.loadFile({src:r,type:"css",environment:"debug"})})),r=r.replace(t.cssRegex,""),t.Class.cachedFiles[e]="string"==typeof r?r:r[0].outerHTML,r}))},containsHash:function(e){return-1!==e.indexOf("#")},getHash:function(e){return e.substring(e.indexOf("#")+1,e.length)},getUrlWithoutHashes:function(e){return e.substring(0,e.indexOf("#"))}}),bizagi.override.enableMSF||(jQuery.fn.fastEmpty=function(){$(this).kendoTmplEmpty()},jQuery.fasttmpl=function(e,t){return jQuery.kendoTmpl(e,t)},jQuery.cacheTemplate=function(e,t){jQuery.cacheKendoTemplate(e,t)}),jQuery.fn.kendoTmplEmpty=function(){this.children().remove();var e=$(this);e.hasClass("ui-bizagi-component-loading")&&e.loadingMessage()},jQuery.kendoTmpl=function(e,t){if(void 0===e)return"";e=(e=e.replace(/(\n*)|(\r*)|(\t*)/g,"")).replace(/\s+/g," ");var i=kendo.template(e,{useWithBlock:!1})(t);return $.trim(i.replace(/>\s*</g,"><"))},jQuery.kendoTmpls=function(e,t){return $(jQuery.kendoTmpl(e,t))},jQuery.cacheKendoTemplate=function(e,t){var i=bizagi.kendo.templates.services.service.cachedTemplates[e];return jQuery.kendoTmpl(i,t)},bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.util=void 0!==bizagi.util?bizagi.util:{},bizagi.context=void 0!==bizagi.context?bizagi.context:{},bizagi.util.smartphone=void 0!==bizagi.util.smartphone?bizagi.util.smartphone:{},bizagi.util.tablet=void 0!==bizagi.util.tablet?bizagi.util.tablet:{};var DEVICES={};function printf(e){var t,i=Array.prototype.slice.call(arguments,1);return e.replace(/(%[disv])/g,(function(e,r){if(void 0!==(t=i.shift()))switch(r.charCodeAt(1)){case 100:return+t;case 105:return Math.round(+t);case 115:return String(t);case 118:return t}return r}))}function bizagiQueue(){var e,t,i=[];this.length=function(){return i.length},this.add=function(r){if(!t)return t=!0,e=void 0,i.push({callbacks:[r]});i[i.length-1].callbacks.push(r)},this.addParallel=function(r){if(!e)return e=!0,t=void 0,i.push({callbacks:[r]});i[i.length-1].callbacks.push(r)},this.execute=function(){for(var e=new $.Deferred,t=e.promise(),r=i.length,a=0;a<r;a++)t=t.pipe((function(){var e=i.shift();return $.when.apply($,$.map(e.callbacks,(function(e){if("function"==typeof e){var t=$.Deferred();return $.when(e()).done((function(){t.resolve()})).fail((function(){t.reject()})),t.promise()}return e})))}));return e.resolve(),t=t.done((function(){i=[]}))}}DEVICES[DEVICES.desktop=0]="desktop",DEVICES[DEVICES.smartphone=1]="smartphone",DEVICES[DEVICES.tablet=2]="tablet",bizagi.deviceEnum=DEVICES,function(e){e.fn.callInside=function(t,i){if("iframe"!=e(this)[0].tagName.toLowerCase())return null;if(null==e(this)[0].contentWindow)return null;try{e(this)[0].contentWindow.args=i}catch(e){return null}return e.browser.msie?e(this)[0].contentWindow.execScript("args = (this.window.args)?this.window.args:{}; insideFunction = "+t.toString()+"; insideFunction(args)"):e.browser.webkit||e.browser.mozilla?e(this)[0].contentWindow.eval("args = window.args;insideFunction = "+t.toString()+"; insideFunction(args)"):void 0}}(jQuery),function(e){e.fn.callInsidePopup=function(t,i){var r=this;e(document).ready((function(){try{e(r)[0].args=i}catch(e){return null}return e.browser.msie?e(r)[0].execScript("args = (this.window.args)?this.window.args:{}; insideFunction = "+t.toString()+"; insideFunction(args)"):e.browser.webkit||e.browser.mozilla?e(r)[0].eval("args = window.args;insideFunction = "+t.toString()+"; insideFunction(args)"):void 0}))}}(jQuery),jQuery,!!CSSStyleDeclaration.prototype.getPropertyValue||(CSSStyleDeclaration.prototype.getPropertyValue=function(e){return this.getAttribute(e)},CSSStyleDeclaration.prototype.setProperty=function(e,t,i){if(this.setAttribute(e,t),""!=(i=void 0!==i?i:"")){var r=new RegExp(RegExp.escape(e)+"\\s*:\\s*"+RegExp.escape(t)+"(\\s*;)?","gmi");this.cssText=this.cssText.replace(r,e+": "+t+" !"+i+";")}},CSSStyleDeclaration.prototype.removeProperty=function(e){return this.removeAttribute(e)},CSSStyleDeclaration.prototype.getPropertyPriority=function(e){return new RegExp(RegExp.escape(e)+"\\s*:\\s*[^\\s]*\\s*!important(\\s*;)?","gmi").test(this.cssText)?"important":""}),RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},jQuery.fn.style=function(e,t,i){if(void 0!==this.get(0)){var r=this.get(0).style;if(void 0===e)return r;if(void 0===t)return r.getPropertyValue(e);i=void 0!==i?i:"",r.setProperty?r.setProperty(e,t,i):r.setAttribute(e,t,i)}},jQuery,jQuery.nl2br=function(e){return e.replace(/(\r\n|\n\r|\r|\n|\\r\\n|\\n\\r|\\r|\\n)/g,"<br>")},jQuery,jQuery.br2nl=function(e){return e.replace(/\r\n|\r|\n/g,"\r")},function(e){jQuery.controlValueIsChanged=function(t){var i=t,r=i.properties,a=i.getValue(),n=r.originalValue,o=!0;return!!e.forceCollectData||("grid"!=t.properties.type||"pending"!=t.ready().state())&&(["combo","queryCombo","list","queryList","radio","queryRadio","queryState"].includes(r.type)||/^cascadingcombo$/i.test(r.type)?(a&&void 0!==a.length&&(a=a[0]),n&&void 0!==n.length&&(n=n[0]),a=a&&a.id?a.id:a,o=(n=n&&n.id?n.id:n)!=a):o="boolean"==r.type||"queryBoolean"==r.type||"queryCheck"==r.type?bizagi.util.parseBoolean(n)!=bizagi.util.parseBoolean(a):"searchNumber"==r.type?!!a:"date"===r.type?new Date(n).getTime()!==new Date(a).getTime():n!==a,o)}}(jQuery),function(e){jQuery.getMaxZindex=function(){var t=e("*"),i=1;return e.each(t,(function(t,r){var a=parseInt(e(r).css("z-index"));a>i&&(i=a+1)})),i}}(jQuery),function(e){jQuery.equalizeHeights=function(t){var i=new Array;e(t).each((function(){e(this).css("min-height","0"),e(this).css("max-height","none"),e(this).css("height","auto"),i.push(e(this).outerHeight())}));var r=Math.max.apply(Math,i);e(t).each((function(){e(this).css("height",r+"px")}))}}(jQuery),bizagi.util.autoSave=function(){var e=$.Deferred();return"desktop"!==bizagi.util.detectDevice()?$(document).data("auto-save")?$(document).trigger("save-form",[e]):e.resolve():$._data($(document)[0],"events")["save-form"]&&$._data($(document)[0],"events")["save-form"].length>0?$(document).trigger("save-form",[e]):e.resolve(),e.promise()},bizagi.util.anonymizedUserInformation={id:"00000000-0000-0000-0000-000000000000",name:"",username:"",email:"",domain:"",picture:"",isAnonymized:!0},bizagi.util.datepickerResource=[],bizagi.util.datepickerResource.en={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.es={closeText:"Cerrar",prevText:"&#x3C;Ant",nextText:"Sig&#x3E;",currentText:"Hoy",monthNames:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],monthNamesShort:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],dayNames:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],dayNamesShort:["dom","lun","mar","mié","jue","vie","sáb"],dayNamesMin:["D","L","M","X","J","V","S"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.ar={closeText:"إغلاق",prevText:"&#x3C;السابق",nextText:"التالي&#x3E;",currentText:"اليوم",monthNames:["يناير","ٝبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوٝمبر","ديسمبر"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],dayNamesShort:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],dayNamesMin:["ح","ن","ث","ر","خ","ج","س"],weekHeader:"أسبوع",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.cs={closeText:"Zavřít",prevText:"&#x3C;Dříve",nextText:"Později&#x3E;",currentText:"Nyní",monthNames:["leden","únor","březen","duben","květen","ĝerven","ĝervenec","srpen","září","říjen","listopad","prosinec"],monthNamesShort:["led","úno","bře","dub","kvě","ĝer","ĝvc","srp","zář","říj","lis","pro"],dayNames:["neděle","pondělí","úterý","středa","ĝtvrtek","pátek","sobota"],dayNamesShort:["ne","po","út","st","ĝt","pá","so"],dayNamesMin:["ne","po","út","st","ĝt","pá","so"],weekHeader:"Týd",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.de={closeText:"Schließen",prevText:"&#x3C;Zurück",nextText:"Vor&#x3E;",currentText:"Heute",monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],weekHeader:"KW",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.fr={closeText:"Fermer",prevText:"Précédent",nextText:"Suivant",currentText:"Aujourd'hui",monthNames:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],monthNamesShort:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dayNames:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],dayNamesShort:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],dayNamesMin:["D","L","M","M","J","V","S"],weekHeader:"Sem.",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.it={closeText:"Chiudi",prevText:"&#x3C;Prec",nextText:"Succ&#x3E;",currentText:"Oggi",monthNames:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthNamesShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],dayNames:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],dayNamesShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayNamesMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.ja={closeText:"閉㝘る",prevText:"&#x3C;剝",nextText:"次&#x3E;",currentText:"今日",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayNames:["日曜日","月曜日","睫曜日","水曜日","木曜日","金曜日","土曜日"],dayNamesShort:["日","月","睫","水","木","金","土"],dayNamesMin:["日","月","睫","水","木","金","土"],weekHeader:"週",dateFormat:"yy/mm/dd",firstDay:0,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},bizagi.util.datepickerResource.nl={closeText:"Sluiten",prevText:"←",nextText:"→",currentText:"Vandaag",monthNames:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthNamesShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],dayNames:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],dayNamesShort:["zon","maa","din","woe","don","vri","zat"],dayNamesMin:["zo","ma","di","wo","do","vr","za"],weekHeader:"Wk",dateFormat:"dd-mm-yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.pt={closeText:"Fechar",prevText:"Anterior",nextText:"Seguinte",currentText:"Hoje",monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],weekHeader:"Sem",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.ru={closeText:"Закрыть",prevText:"&#x3C;Пред",nextText:"След&#x3E;",currentText:"Сегоднѝ",monthNames:["Январь","Февраль","Март","Нпрель","Май","Июнь","Июль","Нвгуѝт","Сентѝбрь","Октѝбрь","Ноѝбрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Нпр","Май","Июн","Июл","Нвг","Сен","Окт","Ноѝ","Дек"],dayNames:["воѝкреѝенье","понедельник","вторник","ѝреда","четверг","пѝтница","ѝуббота"],dayNamesShort:["вѝк","пнд","втр","ѝрд","чтв","птн","ѝбт"],dayNamesMin:["Вѝ","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},bizagi.util.datepickerResource.zh={closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","坝月","坝一月","坝二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","坝月","坝一月","坝二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},bizagi.util.liveProcessesEvents=bizagi.util.liveProcessesEvents||{},bizagi.util.liveProcessesEvents.newLiveProcess=document.createEvent("Event"),bizagi.util.liveProcessesEvents.newLiveProcess.initEvent("new-live-process",!0,!0),bizagi.util.liveProcessesEvents.routeEvents=document.createEvent("Event"),bizagi.util.liveProcessesEvents.routeEvents.initEvent("parent-route-events",!0,!0),bizagi.util.liveProcessesEvents.routeEvents.route="/",bizagi.util.liveProcessesEvents.saveEvent=document.createEvent("Event"),bizagi.util.liveProcessesEvents.saveEvent.initEvent("save-live",!0,!0),bizagi.util.liveProcessesEvents.saveEvent.lastWidget="",bizagi.util.liveProcessesEvents.saveEvent.nextWidget="",bizagi.util.liveSave=function(e){bizagi.util.liveProcessesEvents.saveEvent.nextWidget=e;var t=$.Deferred(),i=0;try{i=$(document).find("iframe")[0].contentWindow.location.href.indexOf("quickprocess")}catch(e){i=-1}return(e!==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY||e===bizagi.util.liveProcessesEvents.saveEvent.lastWidget)&&$(document).find("iframe").length>0&&i>0?(bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise=t,document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent)):t.resolve(),$.when(t).done((function(){bizagi.util.liveProcessesEvents.saveEvent.lastWidget=e})),t.promise()},bizagi.util.md5=function(e){var t=t||function(e,t){var i={},r=i.lib={},a=function(){},n=r.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var a=0;a<e;a++)t[r+a>>>2]|=(i[a>>>2]>>>24-a%4*8&255)<<24-(r+a)%4*8;else if(65535<i.length)for(a=0;a<e;a+=4)t[r+a>>>2]=i[a>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],r=0;r<t;r+=4)i.push(4294967296*e.random()|0);return new o.init(i,t)}}),s=i.enc={},l=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],r=0;r<e;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],r=0;r<t;r+=2)i[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(i,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],r=0;r<e;r++)i.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],r=0;r<t;r++)i[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(i,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,r=i.words,a=i.sigBytes,n=this.blockSize,s=a/(4*n);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*n,a=e.min(4*t,a),t){for(var l=0;l<t;l+=n)this._doProcessBlock(r,l);l=r.splice(0,t),i.sigBytes-=a}return new o.init(l,a)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new g.HMAC.init(e,i).finalize(t)}}});var g=i.algo={};return i}(Math);return function(e){function i(e,t,i,r,a,n,o){return((e=e+(t&i|~t&r)+a+o)<<n|e>>>32-n)+t}function r(e,t,i,r,a,n,o){return((e=e+(t&r|i&~r)+a+o)<<n|e>>>32-n)+t}function a(e,t,i,r,a,n,o){return((e=e+(t^i^r)+a+o)<<n|e>>>32-n)+t}function n(e,t,i,r,a,n,o){return((e=e+(i^(t|~r))+a+o)<<n|e>>>32-n)+t}for(var o=t,s=(c=o.lib).WordArray,l=c.Hasher,c=o.algo,u=[],d=0;64>d;d++)u[d]=4294967296*e.abs(e.sin(d+1))|0;c=c.MD5=l.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var o=0;16>o;o++){var s=e[l=t+o];e[l]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}o=this._hash.words;var l=e[t+0],c=(s=e[t+1],e[t+2]),d=e[t+3],g=e[t+4],p=e[t+5],m=e[t+6],f=e[t+7],h=e[t+8],v=e[t+9],b=e[t+10],y=e[t+11],z=e[t+12],x=e[t+13],w=e[t+14],C=e[t+15],S=i(S=o[0],T=o[1],P=o[2],A=o[3],l,7,u[0]),A=i(A,S,T,P,s,12,u[1]),P=i(P,A,S,T,c,17,u[2]),T=i(T,P,A,S,d,22,u[3]);S=i(S,T,P,A,g,7,u[4]),A=i(A,S,T,P,p,12,u[5]),P=i(P,A,S,T,m,17,u[6]),T=i(T,P,A,S,f,22,u[7]),S=i(S,T,P,A,h,7,u[8]),A=i(A,S,T,P,v,12,u[9]),P=i(P,A,S,T,b,17,u[10]),T=i(T,P,A,S,y,22,u[11]),S=i(S,T,P,A,z,7,u[12]),A=i(A,S,T,P,x,12,u[13]),P=i(P,A,S,T,w,17,u[14]),S=r(S,T=i(T,P,A,S,C,22,u[15]),P,A,s,5,u[16]),A=r(A,S,T,P,m,9,u[17]),P=r(P,A,S,T,y,14,u[18]),T=r(T,P,A,S,l,20,u[19]),S=r(S,T,P,A,p,5,u[20]),A=r(A,S,T,P,b,9,u[21]),P=r(P,A,S,T,C,14,u[22]),T=r(T,P,A,S,g,20,u[23]),S=r(S,T,P,A,v,5,u[24]),A=r(A,S,T,P,w,9,u[25]),P=r(P,A,S,T,d,14,u[26]),T=r(T,P,A,S,h,20,u[27]),S=r(S,T,P,A,x,5,u[28]),A=r(A,S,T,P,c,9,u[29]),P=r(P,A,S,T,f,14,u[30]),S=a(S,T=r(T,P,A,S,z,20,u[31]),P,A,p,4,u[32]),A=a(A,S,T,P,h,11,u[33]),P=a(P,A,S,T,y,16,u[34]),T=a(T,P,A,S,w,23,u[35]),S=a(S,T,P,A,s,4,u[36]),A=a(A,S,T,P,g,11,u[37]),P=a(P,A,S,T,f,16,u[38]),T=a(T,P,A,S,b,23,u[39]),S=a(S,T,P,A,x,4,u[40]),A=a(A,S,T,P,l,11,u[41]),P=a(P,A,S,T,d,16,u[42]),T=a(T,P,A,S,m,23,u[43]),S=a(S,T,P,A,v,4,u[44]),A=a(A,S,T,P,z,11,u[45]),P=a(P,A,S,T,C,16,u[46]),S=n(S,T=a(T,P,A,S,c,23,u[47]),P,A,l,6,u[48]),A=n(A,S,T,P,f,10,u[49]),P=n(P,A,S,T,w,15,u[50]),T=n(T,P,A,S,p,21,u[51]),S=n(S,T,P,A,z,6,u[52]),A=n(A,S,T,P,d,10,u[53]),P=n(P,A,S,T,b,15,u[54]),T=n(T,P,A,S,s,21,u[55]),S=n(S,T,P,A,h,6,u[56]),A=n(A,S,T,P,C,10,u[57]),P=n(P,A,S,T,m,15,u[58]),T=n(T,P,A,S,x,21,u[59]),S=n(S,T,P,A,g,6,u[60]),A=n(A,S,T,P,y,10,u[61]),P=n(P,A,S,T,c,15,u[62]),T=n(T,P,A,S,v,21,u[63]);o[0]=o[0]+S|0,o[1]=o[1]+T|0,o[2]=o[2]+P|0,o[3]=o[3]+A|0},_doFinalize:function(){var t=this._data,i=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;i[a>>>5]|=128<<24-a%32;var n=e.floor(r/4294967296);for(i[15+(a+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),i[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(i.length+1),this._process(),i=(t=this._hash).words,r=0;4>r;r++)a=i[r],i[r]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return t},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=l._createHelper(c),o.HmacMD5=l._createHmacHelper(c)}(Math),t.MD5(e).toString()},bizagi.util.multiReplace=function(e,t){for(var i in t=t||{}){var r=new RegExp(i,"g");e=e.replace(r,t[i])}return e},bizagi.util.replaceAll=function(e,t,i){return bizagi.replaceAll(e,t,i)},bizagi.util.replaceAllGlobalRegExp=function(e,t,i){var r=e,a=new RegExp(t,"g");return(r=r.replace(a,i)).toString()},String.prototype.replaceAll=function(e,t){return bizagi.util.replaceAll(this,e,t)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.startsWith=function(e){return this.slice(0,e.length)==e},String.prototype.getInitials=function(){var e="";if(0===this.length)e='<svg  class="bz-icon bz-icon-24 bz-icon-svg"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-user-deactivated"></use></svg>';else{try{for(var t=this.replace(/  +/g," ").split(" "),i=0;i<t.length&&2!=(e+=t[i][0]||"").length;i+=1);}catch(e){}e=e.toUpperCase()}return e},Math.sign=Math.sign||function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1},bizagi.clone=function(e){if(null!=e)return null==e?null:JSON.parse(JSON.encode(e))},bizagi.measureString=function(e,t){var i=$("<span/>").appendTo("body");i.text(e),t&&i.css("font-size",t);var r=i.width();return i.detach(),r},bizagi.util.trim=function(e){return void 0===e||null==e?e:e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)},String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)},bizagi.util.isIE7=function(){return bizagi.util.isIE()&&7==document.documentMode},bizagi.util.isIE8=function(){return bizagi.util.isIE()&&8==document.documentMode},bizagi.util.isIE9=function(){return bizagi.util.isIE()&&9==document.documentMode},bizagi.util.isIE10=function(){return bizagi.util.isIE()&&10==document.documentMode},bizagi.util.isIE11=function(){return!!navigator.userAgent.match(/Trident\/7.0/)&&!navigator.userAgent.match(/MSIE/i)},bizagi.util.isIE11OrLower=function(){return bizagi.util.isIE11()||bizagi.util.isIE10()||bizagi.util.isIE9()||bizagi.util.isIE8()||bizagi.util.isIE7()},bizagi.util.isIE10OrLower=function(){return bizagi.util.isIE10()||bizagi.util.isIE9()||bizagi.util.isIE8()||bizagi.util.isIE7()},bizagi.util.isEdge=function(){return!!/Edge\/*./i.test(navigator.userAgent)},bizagi.util.isIE=function(){return navigator.appName.indexOf("Internet Explorer")>0||!!navigator.userAgent.match(/Trident/)},bizagi.util.objectValues=function(e){return bizagi.util.isIE()?Object.keys(e).map((function(t){return e[t]})):Object.values(e)},bizagi.util.getIEVersion=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE"),i=0;return t>0?i=parseInt(e.substring(t+5,e.indexOf(".",t))):(navigator.userAgent.match(/Trident/)||window.navigator.userAgent.indexOf("Edge")>-1)&&(i=11),i},bizagi.util.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},bizagi.util.isFirefox=function(e){return/Firefox/.test(navigator.userAgent)&&(void 0===e||e<=(i=navigator.userAgent,r=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(r[1])?{name:"IE",version:(t=/\brv[ :]+(\d+)/g.exec(i)||[])[1]||""}:"Chrome"===r[1]&&null!=(t=i.match(/\bOPR|Edge\/(\d+)/))?{name:"Opera",version:t[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=i.match(/version\/(\d+)/i))&&r.splice(1,1,t[1]),{name:r[0],version:r[1]})).version);var t,i,r},bizagi.util.getBrowser=function(){var e="undetected";return bizagi.util.isChrome()?e="chrome":bizagi.util.isFirefox()?e="firefox":bizagi.util.isEdge()?e="edge":bizagi.util.isIE11()?e="ie11":bizagi.util.isIE10()&&(e="ie10"),e},bizagi.util.emptyNavigatorInfo=function(){bizagi.navigator&&bizagi.navigator.info&&(bizagi.navigator.info={})},$(document).ready((function(){if($("html").addClass("browser-"+bizagi.util.getBrowser()).addClass("device-"+bizagi.detectDevice()),bizagi.language){var e=bizagi.language.split("-");e&&e.length>0&&$("html").addClass("language-"+e[0])}})),bizagi.util.setIphoneXOverrides=function(){bizagi.util.isNativePluginSupported()&&void 0!==bizagiapp.isIphoneX&&bizagiapp.isIphoneX((function(e){if("true"===e)$("head").append('<style type="text/css" id="iphoneXStyle"></style>'),$("#iphoneXStyle").text(".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}");else if(bizagi.util.isiOSDevice()){$("head").append('<style type="text/css" id="iphoneStyle"></style>');$("#iphoneStyle").text("#homePortal .bz-home-header > div{padding-top:.8em}")}}))},bizagi.util.isString=function(e){return"[object String]"===Object.prototype.toString.apply(e)},bizagi.util.isObject=function(e){return"[object Object]"===Object.prototype.toString.apply(e)},bizagi.util.isArray=function(e){return Array.isArray(e)},bizagi.util.isNull=function(e){return"[object Null]"===Object.prototype.toString.apply(e)},bizagi.util.isBoolean=function(e){return"[object Boolean]"===Object.prototype.toString.apply(e)},bizagi.util.getInternetExplorerVersion=function(){return bizagi.util.isIE()?Number(document.documentMode):-1},bizagi.util.detectDevice=function(){return bizagi.detectDevice()},bizagi.util.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},bizagi.util.isGUID=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},bizagi.util.mustImplement=function(e){try{console.log("Not implemented exception: "+e)}catch(e){}},bizagi.util.encodeXpath=function(e){return bizagi.util.isEmpty(e)||void 0===e.replaceAll?"":e.replaceAll(".","_").replaceAll("=","_").replaceAll("[","_").replaceAll("]","_")},bizagi.util.parseBoolean=function(e){return void 0===e?null:null===e?null:""===e?null:!0===e||1===e||"true"===e.toString()||"1"===e||("true"===e.toString().toLowerCase()||(null===e||!1!==e)&&0!==e&&"false"!==e.toString()&&"0"!==e&&("false"!==e.toString().toLowerCase()&&null))},bizagi.util.isEmpty=function(e){return 0!==e&&(null==e||""===e||("Array"==typeof e?0==e.length:"[object Array]"===Object.prototype.toString.apply(e)?0===e.length:"[object Object]"===Object.prototype.toString.apply(e)&&(!!$.isEmptyObject(e)||bizagi.util.isEmptyCombo(e))))},bizagi.util.isEmptyCombo=function(e){if("[object Object]"===Object.prototype.toString.apply(e)){var t,i=!1,r=!1;for(t in e)if(e.hasOwnProperty(t)&&("id"===t?i=!0:"value"===t?!0:r=!0,r))return!1;if(i)return""===e.id}},bizagi.util.decodeURI=function(e){for(var t,i=!1,r=e=e||"";!i;)try{if(t=decodeURI(r),bizagi.util.hasNonVisibleChars(t)){r=e;break}t==r?i=!0:r=t}catch(e){i=!0}return r},bizagi.util.hasNonVisibleChars=function(e){for(var t,i=(e=e||"").length,r=0,a=!1;r<i;)if((t=e.charCodeAt(r++))<32||t>126){a=!0;break}return a},bizagi.util.percent2Number=function(e){return Number(String(e).replace("%",""))},bizagi.util.isObjectEmpty=function(e){return!(e.length>0)},bizagi.util.isMapEmpty=function(e){if(1==e.length&&0==e[0].length)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},bizagi.util.replaceSelector=function(e,t,i){var r=$(t,e);r.length>0&&(r.append(i),r.children().unwrap())},bizagi.util.hasScroll=function(e,t){e.length&&(e=e[0]);var i=!!e[t="vertical"===t?"scrollTop":"scrollLeft"];return i||(e[t]=1,i=!!e[t],e[t]=0),i},bizagi.util.identicalObjects=function(e,t){if(_typeof(e)!==_typeof(t))return!1;if("function"==typeof e)return e.toString()===t.toString();if(e instanceof Object&&t instanceof Object){if(bizagi.util.countProps(e)!==bizagi.util.countProps(t))return!1;for(k in e)if(!bizagi.util.identicalObjects(e[k],t[k]))return!1;return!0}return e===t},bizagi.util.countProps=function(e){var t=0;for(k in e)e.hasOwnProperty(k)&&t++;return t},bizagi.util.isScrolledIntoView=function(e,t){if(null==e)return!1;var i=(t=t||$(window)).scrollTop(),r=$(e).offset().top;return r+$(e).height()<=i+$(t).height()&&r>=i},bizagi.util.centerElementIntoScroll=function(e,t){if(null==e)return!1;var i=(t=t||$(window)).scrollTop(),r=$(e).offset().top,a=$(e).height(),n=i+(r>0?r+a:r-a);t.scrollTop(n)},bizagi.util.encodeHtml=function(e){return null==e?"":"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):e},bizagi.util.decodeHtmlEntities=function(e){return null==e?"":"string"==typeof e?e.replace(/&apos;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,"'"):e},bizagi.util.getHashParams=function(){return window.location.hash.substring(1).split("#")},bizagi.util.loadFile=function(e){var t=new $.Deferred,i=e&&e.src?e.src:e,r=e&&e.type?e.type:null;return bizagi.loader.loadFile({src:i,type:r}).then((function(){t.resolve()})),t.promise()},bizagi.util.initWebpart=function(e,t){var i=new $.Deferred;return t=t||bizagi.detectDevice(),e.initialized?i.resolve():e.initializing?$.when(e.loadingDeferred.promise()).done((function(){i.resolve()})):(e.loadingDeferred=new $.Deferred,e.initializing=!0,bizagi.loader.initWebpart(e,t,(function(){e.loadingDeferred.resolve(),e.initializing=!1,i.resolve()}))),i.promise()},bizagi.util.getQueryString=function(e){for(var t={},i=((e=e||window.location.href).indexOf("?")>0?e.substring(e.indexOf("?")+1):"").split("&"),r=i.length-1;r>=0;r--){var a=i[r].indexOf("=");if(-1!=a){var n=i[r].substring(0,a),o=i[r].substring(a+1);t[n]=unescape(o)}}return t},bizagi.util.extendQueryString=function(e,t){var i=e.indexOf("?")>0?e.substring(0,e.indexOf("?")):e,r=bizagi.util.getQueryString(e),a=$.extend({},r,t);return i+"?"+$.param(a)},bizagi.util.getStackTrace=function(){var e=[],t=!1;try{i.dont.exist+=0}catch(o){if(o.stack){for(var i=0,r=(a=o.stack.split("\n")).length;i<r;i++)a[i].match(/^\s*[A-Za-z0-9\-_\$]+\(/)&&e.push(a[i]);e.shift(),t=!0}else if(window.opera&&o.message){var a;for(i=0,r=(a=o.message.split("\n")).length;i<r;i++)if(a[i].match(/^\s*[A-Za-z0-9\-_\$]+\(/)){var n=a[i];a[i+1]&&(n+=" at "+a[i+1],i++),e.push(n)}e.shift(),t=!0}}if(!t)for(var o=arguments.callee.caller;o;){var s=o.toString(),l=s.substring(s.indexOf("function")+8,s.indexOf(""))||"anonymous";e.push(l),o=o.caller}return e},bizagi.util.highLightElement=function(e){e.addClass("ui-highlight-control"),$.when(setTimeout((function(){e.addClass("ui-highlight-off-control")}),450)).done(setTimeout((function(){e.removeClass("ui-highlight-control ui-highlight-off-control")}),800))},bizagi.util.autoScrollBottom=function(e){try{var t;t=e[0].scrollHeight,e.scrollTop(t)}catch(e){}},bizagi.util.autoScrollInterval={init:!1},bizagi.util.autoScroll=function(e,t,i,r){var a=!1;clearInterval(bizagi.util.autoScrollInterval[r]),bizagi.util.autoScrollInterval[r]=0,bizagi.util.autoScrollInterval.init=!0,$("body").addClass("autoscroll"),$("body.autoscroll").mousemove((function(n){n.pageY<t?a||(a=!0,bizagi.util.autoScrollTopInterval(e,"autoscroll",r)):n.pageY>i?a||(a=!0,bizagi.util.autoScrollBottomInterval(e,"autoscroll",r)):(clearInterval(bizagi.util.autoScrollInterval[r]),a=!1)}))},bizagi.util.autoScrollTopInterval=function(e,t,i){clearInterval(bizagi.util.autoScrollInterval[i]),t&&$("body").addClass(t),0==e.scrollTop()?clearInterval(bizagi.util.autoScrollInterval[i]):(clearInterval(bizagi.util.autoScrollInterval[i]),bizagi.util.autoScrollInterval[i]=setInterval((function(){e.scrollTop()>0?e.scrollTop(e.scrollTop()-40):clearInterval(bizagi.util.autoScrollInterval[i])}),100))},bizagi.util.autoScrollBottomInterval=function(e,t,i){clearInterval(bizagi.util.autoScrollInterval[i]),t&&$("body").addClass(t);var r=$(e)[0].scrollHeight-$(e).innerHeight();e.scrollTop()>=r?clearInterval(bizagi.util.autoScrollInterval[i]):(clearInterval(bizagi.util.autoScrollInterval[i]),bizagi.util.autoScrollInterval[i]=setInterval((function(){bizagi.util.autoScrollBottom($("html")),e.scrollTop()<r?e.scrollTop(e.scrollTop()+40):clearInterval(bizagi.util.autoScrollInterval[i])}),100))},bizagi.util.removeAutoScroll=function(e,t){$("body."+e).unbind("mousemove").removeClass(e),clearInterval(bizagi.util.autoScrollInterval[t]),bizagi.util.autoScrollInterval.init=!1},bizagi.util.getMaxZIndex=function(e){return e=e||$("div,span"),Math.max.apply(null,$(e).map((function(){var e;return isNaN(e=parseInt($(this).css("z-index"),10))?0:e})))},bizagi.showPopup=function(e,t,i){var r=t.width||1024,a=t.height||768,n=$(window).height()/2-a/2,o=$(window).width()/2-r/2,s=window.open(e,"","width="+r+",height="+a+", top="+n+", left="+o+", Menubar=NO, Location=NO, Status=NO, scrollbars=YES");window.BAPopupWindow=s,window.BAPopupCallback=i,window.BACloseWindow=function(e,t){window.BAPopupWindow.close(),window.BAPopupCallback(e,t)}},bizagi.showQuirksModePopup=function(e,t){var i=window.BIZAGI_PATH_TO_BASE+"quirks.html",r=t.width||1024,a=t.height||768,n=$(window).height()/2-a/2,o=$(window).width()/2-r/2,s=window.open(i,"bizagiPopup","width="+r+",height="+a+", top="+n+", left="+o+", Menubar=NO, Location=NO, Status=NO, scrollbars=YES");window.BAQuirksPopupWindow=s,setTimeout((function(){try{s.document.title=t.title}catch(e){}}),50),$(s).callInsidePopup((function(e){var t=e.jQuery,i=e.popupWindow;i.quirksOnLoad=function(){var r=t("body",i.document),a=t("iframe",r);r.removeClass("ui-bizagi-loading-message"),a.show();var n=e.userParams.afterLoad;if(n&&null!=n){var o=t.extend(e.userParams,{popupWindow:i});a.callInside(n,o)}};!function r(){var a=t("body",i.document);a.length>0?a.append("<iframe scrolling='yes' id='innerFrameContent' src='"+e.url+"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>"):setTimeout((function(){r()}),50)}()}),{jQuery:$,userParams:t,popupWindow:s,url:e})},bizagi.resolveResult=function(e){var t;return e.done((function(e){t=e})),t},bizagi.createPopup=function(e){var t=e.name,i=e.onClose,r=e.title?e.title:"",a="boolean"!=typeof e.handleClose||e.handleClose,n=$('<div class="ui-widget-overlay '+t+'-overlay" />'),o=$('<div class="'+t+'-popup  ui-popup-modal"/>').appendTo(n),s=$('<div class="'+t+'-btn-close biz-btn-close"><i class="biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black"></i></div>').appendTo(o);e.title&&$('<div class="'+t+'-popup-header ui-popup-header" ><h3>'+r+"</h3></div>").appendTo(o);var l=$('<div class="'+t+'-popup-content" />').appendTo(o);o.hide(),e.additionalClass&&o.addClass(e.additionalClass);var c=e.container||"body";n.appendTo($(c,document)),e.center&&(o.css("top",(n.height()-o.height())/2),o.css("left",(n.width()-o.width())/2)),o.show();var u=function(e){n.detach(),i&&i(e)};return a&&s.click(u),{fullPopup:o,overlay:n,content:l,close:function(e){u(e)}}},bizagi.createOkCancelPopup=function(e){e.name="popup-ok-cancel";var t=e.onOk,i=e.onCancel,r=bizagi.createPopup(e),a=$("<div></div>").addClass("container-okcancel-popup"),n=$("<div></div>").addClass("message-okcancel-popup ui-light-bevel-border biz-gradient-v"),o=$("<div></div>").addClass("buttonsContainer-okcancel-popup biz-actions-bar");n.text(e.message),n.appendTo(a);var s=$("<span></span>").addClass("ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn"),l=$("<span></span>").addClass("cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn");s.text(bizagi.localization.getResource("bizagi-editor-okcancel-ok")),l.text(bizagi.localization.getResource("bizagi-editor-okcancel-cancel")),s.appendTo(o),l.appendTo(o),o.appendTo(a),a.appendTo(r.content);var c=function(){r.close(),"function"==typeof t&&t()};s.click(c);var u=function(){r.close(),"function"==typeof i&&i()};return l.click(u),{close:function(){r.close()},ok:function(){c()},cancel:function(){u()}}},bizagi.dialog=function(e){var t=$("<div></div>").addClass("biz-dialog"),i=$("<p></p>");i.text(e.message||""),i.appendTo(t),t.appendTo($("body",document)),t.dialog({title:e.title,modal:!0,buttons:e.buttons,close:function(){t.dialog("destroy")}})},bizagi.closeQuirksModePopup=function(){var e=window.BAQuirksPopupWindow;window.BAQuirksPopupWindow=null;try{e&&e.close()}catch(e){}},bizagi.getStyle=function(e){var t,i=location.href.replace("/default.aspx",""),r=!!e.match(/@/),a=!!e.match(/\*/),n=new RegExp(e.replace("*",""),"g"),o="";if(""==e)return"";var s=function(e){for(var i=0;i<document.styleSheets.length;i++)if(null!=(t=document.styleSheets[i].rules||document.styleSheets[i].cssRules))for(var s=0;s<t.length;s++)if(null!=document.styleSheets[i].href&&(null==document.styleSheets[i].href.match(/less.css/g)||"release"==BIZAGI_ENVIRONMENT)){var l=t[s].cssText?t[s].cssText:"";a?null!=t[s].selectorText&&null!=t[s].selectorText.match(n)&&($.browser.webkit?o+=t[s].cssText.replace(/\(path\)/g,""):$.browser.msie&&"8.0"==$.browser.version?o+=t[s].style.cssText:o+=t[s].cssText.replace(/\(path\)/g,"../../jquery/workportal/css/desktop")):null!=t[s].selectorText&&t[s].selectorText==e&&(o+=t[s].cssText),r&&null!=t[s]&&null!=l&&-1!=l.indexOf("@font-face")&&($.browser.webkit?o+=l.replace(/jquery\/workportal\/css\/desktop\//g,"").replace(/\(path\)/g,""):o+=l.replace(/\(path\)/g,"../../"))}return o};return $.browser.msie?function(e){if("8.0"==$.browser.version)return s(e);for(var r,l=0;l<document.styleSheets.length;l++)if(null!=(t=document.styleSheets[l].cssRules||document.styleSheets[l].rules))for(var c=0;c<t.length;c++)if("release"==BIZAGI_ENVIRONMENT)a&&(null!=t[c].selectorText&&null!=t[c].selectorText.match(n)?o+=t[c].cssText.replace(/\(path\)/g,i+"/jquery/workportal/css/desktop"):null!=t[c].selectorText&&t[c].selectorText==e&&(o+=t[c].cssText.replace(/\(path\)/g,i+"/jquery/workportal/css/desktop")));else if(null!=t[c].href&&null!=t[c].href&&null==t[c].href.match(/less.css/g)){r=t[c].styleSheet.cssRules||[];for(var u=0;u<r.length;u++)a?null==r[u].selectorText&&null==r[u].selectorText||null==r[u].selectorText.match(n)||(o+=r[u].cssText.replace(/\(path\)/g,i+"/jquery/workportal/css/desktop")):null!=r[u].selectorText&&r[u].selectorText==e&&(o+=r[u].cssText.replace(/\(path\)/g,i+"/jquery/workportal/css/desktop"))}return o}(e):s(e)},bizagi.cookie=function(e,t,i){if(arguments.length>1&&"[object Object]"!==String(t)){if(i=$.extend({},i),null==t&&(i.expires=-1),"number"==typeof i.expires){var r=i.expires,a=i.expires=new Date;a.setDate(a.getDate()+r)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}var n,o=(i=t||{}).raw?function(e){return e}:decodeURIComponent;return(n=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?o(n[1]):null},bizagi.util.randomNumber=function(e,t){return e=e||1,t=t||1e7,Math.floor(Math.random()*(t-e+1))+e},bizagi.util.setContext=function(e,t){e=e||{},(t=t||!1)&&(bizagi.context={}),$.each(e,(function(e,t){bizagi.context[e]=t})),bizagi.context.idWorkItem=bizagi.context.idWorkitem},bizagi.util.reloadCSS=function(){var e="?reload="+(new Date).getTime();$('link[rel="stylesheet"]').each((function(){this.href=this.href.replace(/\?.*|$/,e)}))},bizagi.util.setInterval=function(params){var _name=params.name||"default",_call=params.call||function(){},_params=params.params||{},_singleton=params.singleton||!1,_timeOut=params.timeout||5e3,_maxIterations=params.iterations||1e3,_context=params.context||"true;",_killWhenExitContext=!params.hasOwnProperty("killWhenExitContext")||params.killWhenExitContext;bizagi.timeOut=bizagi.timeOut||{},null==bizagi.timeOut[_name]&&(bizagi.timeOut[_name]=[]),_singleton&&null!=bizagi.timeOut[_name]&&(bizagi.timeOut[_name]=[]),bizagi.timeOut[_name].push({name:_name,params:_params,call:_call,singleton:_singleton,timeOut:_timeOut,iterations:0,maxIterations:_maxIterations,context:_context,killWhenExitContext:_killWhenExitContext,itsRunning:!1,timeInit:Math.round((new Date).getTime())});var executeTimeOut=function executeTimeOut(){$.each(bizagi.timeOut,(function(k,v){$.each(v,(function(key,value){var now=Math.round((new Date).getTime()),actualIterations=Math.round((now-value.timeInit)/value.timeOut);if(bizagi.timeOut[value.name][key].iterations=actualIterations,actualIterations<value.maxIterations)if(eval(value.context)){if(!value.itsRunning){if(value.params&&$.browser.msie)var ieFunction=function(){return value.call(value.params)};bizagi.timeOut[value.name][key].pointer=$.browser.msie?setInterval(ieFunction,value.timeOut,"JavaScript"):setInterval(value.call,value.timeOut,value.params),bizagi.timeOut[value.name][key].itsRunning=!0}}else value.killWhenExitContext?(bizagi.timeOut[value.name].splice(key,1),clearTimeout(value.pointer)):(bizagi.timeOut[value.name][key].itsRunning=!1,clearTimeout(value.pointer));else clearTimeout(value.pointer),bizagi.timeOut[value.name].splice(key,1)}))}))};bizagi.timeOutRunning||(bizagi.timeOutRunning=!0,setInterval(executeTimeOut,1e3))},bizagi.util.isDate=function(e){var t,i,r=!1,a=!1,n=!1,o=(e=e||"").toString().split(" ");return t=o[0],(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(t)||/^\d{4}\/\d{1,2}\/\d{1,2}$/.test(t)||/^\d{1,2}\/\d{1,2}\/\d{1,2}$/.test(t))&&(r=!0),o.length>1&&(i=o[1],a=!0,3==o.length&&(i=i+" "+o[2]),/^\d{1,2}:\d{2}(:\d{2})?(\s[aApP][mM])?$/.test(i)&&(n=!0)),a?r&&n:r},bizagi.util.unicode2htmlencode=function(e){var t,i=(e=e.replace(/\r\n/g,"\n")).length,r="";for(t=0;t<i;t++)r+="&#x"+e.charCodeAt(t).toString(16)+";";return r},bizagi.util.getHeadElement=function(){var e=document.getElementsByTagName("head")[0],t=document&&document.documentElement;return e||(e=document.createElement("head"),t.insertBefore(e,t.firstChild)),bizagi.util.getHeadElement=function(){return e},e},bizagi.util.loadStyle=function(e,t){var i,r=document.getElementById(t);if(e&&!r){var a=document.createElement("style");a.type="text/css",a.id=t,a.styleSheet?a.styleSheet.cssText=e:(i=document.createTextNode(e),a.childNodes.length?a.firstChild.nodeValue!==i.nodeValue&&a.replaceChild(i,a.firstChild):a.appendChild(i)),bizagi.util.getHeadElement().appendChild(a)}},bizagi.util.loadIconStyle=function(e,t){bizagi.log("bizagi.util.loadIconStyle");var i=document.createElement("style");i.type="text/css";var r=".mtool-item-image-"+t+" { background:url(data:image/png;base64,"+e+"); }";i.innerHTML=r,bizagi.util.getHeadElement().appendChild(i)},bizagi.util.formatDecimalAndMoneyCell=function(e,t){var i,r,a,n,o={decimalSymbol:t.decimalSeparator,digitGroupSymbol:t.groupSeparator,roundToDecimalPlace:t.decimalDigits};for(i=$.extend({symbol:"€",decimalSeparator:",",groupSeparator:".",decimalDigits:"2"},t),r=$.extend({colorize:!1,decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0,negativeFormat:"(%s%n)",positiveFormat:"%s%n",roundToDecimalPlace:"2",symbol:""},o),a=0;a<e.columnTitle.length;a++){if("MONEY"==e.columnTitle[a].type.toUpperCase())for(n=0;n<e.rows.length;n++)e.rows[n].fields[a]=bizagi.util.formatMoney(e.rows[n].fields[a],i);if("FLOAT"==e.columnTitle[a].type.toUpperCase()||"REAL"==e.columnTitle[a].type.toUpperCase())for(n=0;n<e.rows.length;n++){var s=bizagi.util.formatDecimal(e.rows[n].fields[a],r);if(!0===bizagi.override.removeTrailingZeros){var l=!0;-1!=s.toString().indexOf(")")&&(l=!1,s=s.replace("(","").replace(")",""));var c=new RegExp("("+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"\\d*?[1-9])0+$","g");s=s.replace(c,"$1"),c=new RegExp("\\"+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"0+$","g"),s=s.replace(c,""),l||(s="("+s+")")}e.rows[n].fields[a]=s}}return e},bizagi.util.formatBoolean=function(e){return 1==bizagi.util.parseBoolean(e)?bizagi.localization.getResource("render-boolean-yes"):0==bizagi.util.parseBoolean(e)?bizagi.localization.getResource("render-boolean-no"):""},bizagi.util.formatInvariantBoolean=function(e){e=e||"",$(".formatBoolean",e).not(".formatted").each((function(e,t){var i=$(t),r=i.html();i.addClass("formatted");try{var a=bizagi.util.formatBoolean(r);i.html(a)}catch(e){i.html(r)}}))},bizagi.util.formatDecimal=function(e,t){var i=$("<i/>").text(e);return i.formatCurrency&&i.formatCurrency(t),i.text()},bizagi.util.formatMonetaryCells=function(e,t){t=t||{symbol:"€",decimalSeparator:",",groupSeparator:".",decimalDigits:"2"};for(var i=0;i<e.columnTitle.length;i++)if("MONEY"==e.columnTitle[i].type.toUpperCase())for(var r=0;r<e.rows.length;r++)e.rows[r].fields[i]=bizagi.util.formatMoney(e.rows[r].fields[i],t);return e},bizagi.util.formatMoney=function(e,t){var i="",r="",a="",n="",o="",s=e<0;if(null==e&&(e=""),(e=e.toString()).length>=1){var l=e.indexOf(".");if(l>0)a=(e=bizagi.util.fixDecimalDigits(e,t.decimalDigits)).substring(0,l).replace(/\D/g,"");else{for(var c=0;c<t.decimalDigits;c++)o+="0";a=e.replace(/\D/g,"")}if(e=e.replace(/\D/g,""),n=t.decimalDigits>0?l>0?t.decimalSeparator+e.substring(e.length-t.decimalDigits,e.length):t.decimalSeparator+o:"",a.length>3){var u=0;for(c=a.length-1;c>=0;c--)3==u&&(r+=".",u=0),r+=a[c],u+=1;for(c=r.length-1;c>=0;c--)i+=r[c]}else i=a;if(i=i.replaceAll(".",t.groupSeparator),s)i=bizagi.localization.getResource("numericFormat").negativeFormat.replace("%s",t.symbol).replace("%n",i+n);else i=t.symbol+i+n;return i}return e},bizagi.util.getOnlyNumbersByString=function(e){return e.replace(/\D/g,"")},bizagi.util.fixDecimalDigits=function(e,t){var i,r;if(i=e.indexOf("."),e.substring(0,i),t>(r=e.substring(i+1,e.length)).length)for(var a=r.length;a<t;a++)e+="0";else e=parseFloat(e).toFixed(t);return e},bizagi.util.numberToFixedString=function(e){var t;e&&(Math.abs(e)<1?(t=parseInt(e.toString().split("e-")[1]))&&(e>=0?(e*=Math.pow(10,t-1),e="0."+new Array(t).join("0")+e.toString().substring(2)):(e=Math.abs(e)*Math.pow(10,t-1),e="-"+(e="0."+new Array(t).join("0")+e.toString().substring(2)))):(t=parseInt(e.toString().split("+")[1]))>20&&(t-=20,e/=Math.pow(10,t),e+=new Array(t+1).join("0")));return e},bizagi.util.formatInvariantMoney=function(e,t){e=e||"";var i={symbol:t.symbol,decimalSeparator:t.decimalSeparator||",",groupSeparator:t.groupSeparator||".",decimalDigits:t.decimalDigits||"2"};!1===t.allowDecimals&&(i.decimalDigits="0"),$(".formatMoney",e).not(".formated").each((function(e,t){var r=$(t).html();$(t).addClass("formated");try{var a=parseFloat(r);if(!isNaN(a)){var n=bizagi.util.formatMoney(a,i);$(t).html(n)}}catch(e){$(t).html(r)}}))},bizagi.util.formatInvariantNumber=function(e,t){e=e||"";var i="2";i="0"==t.decimalDigits?"0":t.decimalDigits||"2";var r=bizagi.util.isString(t.groupSeparator)&&t.groupSeparator?t.groupSeparator:".",a={symbol:"",decimalSeparator:t.decimalSeparator||",",groupSeparator:t.groupSeparator||t.thousands?r:"",decimalDigits:i};$(".formatMoney",e).not(".formated").each((function(e,i){var r=$(i).html();$(i).addClass("formated");try{var n=r.match(/[a-zA-Z]/),o=null!=n&&n.length>0?NaN:parseFloat(r);if(!isNaN(o)){var s=bizagi.util.formatMoney(o,a);t.percentage&&(s=s.toString()+"%"),$(i).html(s)}}catch(e){$(i).html(r)}}))},bizagi.util.formatInvariantDate=function(e,t){e=e||"",t=t||"MM/dd/yyyy hh:mm:ss",$(".formatDate",e).not(".formated").each((function(e,i){var r=$(i).html();$(i).addClass("formated");try{var a=new Date(r),n=t;bizagi.util.isValidDate(a)&&(n=bizagi.util.getFormatDate(a,n));var o=bizagi.util.dateFormatter.formatDate(a,n);$(i).html(o)}catch(e){$(i).html(r)}}))},bizagi.util.formatDateFromInvariantStringDate=function(e){if(bizagi.util.isValidDate(e)){var t=bizagi.localization.getResource("dateFormat")+" "+bizagi.localization.getResource("timeFormat"),i=new Date(e);return t=bizagi.util.getFormatDate(i,t),bizagi.util.dateFormatter.formatDate(i,t)}return e||""},bizagi.util.getFormatDate=function(e,t){var i=t,r=e.getHours(),a=e.getMinutes(),n=e.getSeconds(),o=e.getMilliseconds(),s=bizagi.override.hideTimeWhenHourMinutesSecondsAreZero;return 0===r&&0===a&&0===n&&0===o&&s&&(i=bizagi.localization.getResource("dateFormat")),i},bizagi.util.formatValueByDataType=function(e,t){var i=e;switch(t){case"NText":case 23:case"Char":case 14:case"VarChar":case 15:case"Text":case 16:e&&e.length>30&&(i=bizagi.util.replaceLineBreak(e));break;case"Boolean":case 5:case"Binary":case 17:i=bizagi.util.formatBoolean(e);break;case"Int":case 2:case"BigInt":case 1:case"SmallInt":case 3:case"TinyInt":case 4:case"Numeric":case 7:i=null==e?"":e;break;case"Money":case 8:i=bizagi.util.formatMonetaryCell(e);break;case"Float":case 10:case"Real":case 11:case"Decimal":case 6:i=bizagi.util.formatDecimalCell(e);break;case"DateTime":case 12:case"SmallDateTime":case 13:i=bizagi.util.formatDateFromInvariantStringDate(e)}return null==i&&(i=""),i},bizagi.util.isValidDate=function(e){if(void 0!==e&&null!=e){var t=new Date(e);return!isNaN(t.valueOf())}return!1},bizagi.util.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),bizagi.util.dayNames=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"),bizagi.util.dateFormatter=new function(){this.LZ=function(e){return(e<0||e>9?"":"0")+e},this.isDate=function(e,t){return 0!=this.getDateFromFormat(e,t)},this.getRelativeTime=function(e,t,i,r){var a=r?new Date(bizagi.moment().tz(bizagi.currentUser.timeZoneName).format()):new Date,n=e instanceof Date?e:kendo.parseDate(e,t),o=a.getTime()-n.getTime(),s=l(o,"year",31536e6,i);return s||(s=l(o,"month",2628e6,i))||(s=l(o,"week",6048e5,i))||(s=l(o,"day",864e5,i))||(s=l(o,"hour",36e5,i))||(s=l(o,"minute",6e4,i))||(i?s=l(0===o?o+1:o,"minute",1,i):(s=l(o,"second",2e3,i))||(s=bizagi.localization.getResource("workportal-relativetime-momentago"))),s;function l(e,t,i,r){var a=(e/i).toFixed(0);if(a>0){if(r)return 1==a?bizagi.localization.getResource("workportal-relativetime-"+t).replace("%s",a):bizagi.localization.getResource("workportal-relativetime-"+t+"s").replace("%s",a);var n=bizagi.localization.getResource("workportal-relativetime-ago");return 1==a?n.replace("%s",bizagi.localization.getResource("workportal-relativetime-"+t).replace("%s",a)):n.replace("%s",bizagi.localization.getResource("workportal-relativetime-"+t+"s").replace("%s",a))}return null}},this.compareDates=function(e,t,i,r){var a=getDateFromFormat(e,t),n=getDateFromFormat(i,r);return 0==a||0==n?-1:a>n?1:0},this.getDifferenceBetweenDates=function(e,t,i){if(!(e instanceof Date&&e instanceof Date))return"one param not is Date";switch(i){case"seconds":return(t.getTime()-e.getTime())/1e3;case"milliseconds":return t.getTime()-e.getTime();default:return"unit is not Defined"}},this.formatDate=function(e,t,i){if(!bizagi.util.isValidDate(e)||0==e)return"";var r=bizagi.util.monthNames,a=bizagi.util.dayNames;t+="";var n,o,s="",l=0,c=e.getFullYear()+"",u=e.getMonth()+1,d=e.getDate(),g=e.getDay(),p=e.getHours(),m=e.getMinutes(),f=e.getSeconds(),h=e.getMilliseconds(),v=new Object;if(bizagi.util.isValidResource("datePickerRegional")&&(i=bizagi.localization.getResource("datePickerRegional")),i){var b=i.monthNames.concat(i.monthNamesShort),y=i.dayNames.concat(i.dayNamesShort);r=r.toString()===b.toString()?r:b,a=a.toString()===y.toString()?a:y}for((c.length<4||"-"===c.charAt(0)&&c.length<5)&&(c=""+(c-0+1900)),v.y=""+c,v.yyyy=c,v.yy=c.substring(2,4),v.M=u,v.MM=this.LZ(u),v.MMM=r[u+11],v.MMMM=r[u-1],v.NNN=r[u+11],v.d=d,v.dd=this.LZ(d),v.ddd=a[g+7],v.dddd=a[g],v.E=a[g+7],v.EE=a[g],v.H=p,v.HH=this.LZ(p),v.tt=p<12?"am":"pm",v.TT=p<12?"AM":"PM",v.h=0==p?12:p>12?p-12:p,v.hh=this.LZ(v.h),v.K=p>11?p-12:p,v.k=p+1,v.KK=this.LZ(v.K),v.kk=this.LZ(v.k),v.a=p>11?"PM":"AM",v.m=m,v.mm=this.LZ(m),v.s=f,v.ss=this.LZ(f),v.FFF=h;l<t.length;){for(n=t.charAt(l),o="";t.charAt(l)==n&&l<t.length;)o+=t.charAt(l++);null!=v[o]?s+=v[o]:s+=o}return s},this.getDateFromFormat=function(e,t,i){var r=bizagi.util.monthNames,a=bizagi.util.dayNames;e+="",t+="";var n,o,s=0,l=0,c=0,u=0,d=new Date,g=d.getYear(),p=d.getMonth()+1,m=1,f=d.getHours(),h=d.getMinutes(),v=d.getSeconds(),b=(d.getMilliseconds(),"");if(bizagi.util.isValidResource("datePickerRegional")&&(i=bizagi.localization.getResource("datePickerRegional")),i){var y=i.monthNames.concat(i.monthNamesShort),z=i.dayNames.concat(i.dayNamesShort);r=r.toString()===y.toString()?r:y,a=a.toString()===z.toString()?a:z}for(;l<t.length;){for(n=t.charAt(l),o="";t.charAt(l)==n&&l<t.length;)o+=t.charAt(l++);if("yyyy"==o||"yy"==o||"y"==o){if("yyyy"==o&&(c=4,u=4),"yy"==o&&(c=2,u=2),"y"==o&&(c=2,u=4),null==(g=P(e,s,c,u)))return 0;s+=g.length,2==g.length&&(g=g>70?g-0+1900:g-0+2e3)}else if("MMMM"==o||"MMM"==o||"NNN"==o){p=0;for(var x=0;x<r.length;x++){var w=r[x];if(e.substring(s,s+w.length).toLowerCase()==w.toLowerCase()&&("MMMM"==o||"MMM"==o||"NNN"==o&&x>11)){(p=x+1)>12&&(p-=12),s+=w.length;break}}if(0==p){if(null==(p=P(e,s,1,2))||p<1||p>12)return 0;s+=p.length}if(p<1||p>12)return 0}else if("dddd"==o||"EE"==o||"E"==o)for(var C=0;C<a.length;C++){var S=a[C];if(e.substring(s,s+S.length).toLowerCase()==S.toLowerCase()){s+=S.length;break}}else if("MM"==o||"M"==o){if(null==(p=P(e,s,1,2))||p<1||p>12)return 0;s+=p.length}else if("dd"==o||"d"==o){if(null==(m=P(e,s,1,2))||m<1||m>31)return 0;s+=m.length}else if("hh"==o||"h"==o){if(null==(f=P(e,s,o.length,2))||f<1||f>12)return 0;s+=f.length}else if("HH"==o||"H"==o){if(null==(f=P(e,s,o.length,2))||f<0||f>23)return 0;s+=f.length}else if("KK"==o||"K"==o){if(null==(f=P(e,s,o.length,2))||f<0||f>11)return 0;s+=f.length}else if("kk"==o||"k"==o){if(null==(f=P(e,s,o.length,2))||f<1||f>24)return 0;s+=f.length,f--}else if("mm"==o||"m"==o){if(null==(h=P(e,s,o.length,2))||h<0||h>59)return 0;s+=h.length}else if("ss"==o||"s"==o){if(null==(v=P(e,s,o.length,2))||v<0||v>59)return 0;s+=v.length}else if("FFF"==o){if(ff=P(e,s,o.length,3),null==ff||ff<0||ff>999)return 0;s+=ff.length}else if("a"==o||"tt"==o){if("am"==e.substring(s,s+2).toLowerCase())b="AM";else{if("pm"!=e.substring(s,s+2).toLowerCase())return 0;b="PM"}s+=2}else{if(e.substring(s,s+o.length)!=o)return 0;s+=o.length}}if(2==p)if(g%4==0&&g%100!=0||g%400==0){if(m>29)return 0}else if(m>28)return 0;return(4==p||6==p||9==p||11==p)&&m>30?0:(f<12&&"PM"==b?f=f-0+12:f>11&&"AM"==b&&(f-=12),new Date(g,p-1,m,f,h,v));function A(e){for(var t=0;t<e.length;t++)if(-1=="1234567890".indexOf(e.charAt(t)))return!1;return!0}function P(e,t,i,r){for(var a=r;a>=i;a--){var n=e.substring(t,t+a);if(n.length<i)return null;if(A(n))return n}return null}},this.parseDate=function(e){for(var t,i=2==arguments.length&&arguments[1],r=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"),a=new Array("M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"),n=new Array("d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"),o=new Array(r,i?n:a,i?a:n),s=0;s<o.length;s++)for(var l=window[o[s]],c=0;c<l.length;c++)if(0!=(t=getDateFromFormat(e,l[c])))return new Date(t);return null},this.analyzeTimeFormat=function(e){for(var t,i,r=0,a={show24Hours:!1,showSeconds:!1,separator:":"},n="";r<e.length;){for(t=e.charAt(r),i="";e.charAt(r)==t&&r<e.length;)i+=e.charAt(r++);"hh"==i||"h"==i?(n=i,a.show24Hours=!1):"HH"==i||"H"==i?(n=i,a.show24Hours=!0):"mm"==i||"m"==i?n=i:"ss"==i||"s"==i?(n=i,a.showSeconds=!0):"a"==i?n=i:"H"!=n.toUpperCase()&&"HH"!=n.toUpperCase()||(a.separator=i)}return a},this.getDateFromInvariant=function(e,t){e="string"!=typeof(e=null==e?"":e)?e.toString():e;var i="MM/dd/yyyy"+(t?" H:mm:ss":"");t&&e&&(e.toLowerCase().indexOf("am")>0||e.toLowerCase().indexOf("pm")>0)&&(i="MM/dd/yyyy h:mm:ss a");var r=bizagi.util.dateFormatter.getDateFromFormat(e,i);return 0!=r||t?0==r&&t&&null!=e&&""!=e&&(i="MM/dd/yyyy",(r=bizagi.util.dateFormatter.getDateFromFormat(e,i)).setHours(0,0,0,0)):(i="MM/dd/yyyy H:mm:ss",r=bizagi.util.dateFormatter.getDateFromFormat(e,i)),r},this.formatInvariant=function(e,t){var i="MM/dd/yyyy"+(t?" HH:mm:ss":"");return bizagi.util.dateFormatter.formatDate(e,i)},this.getDateFromISO=function(e,t){var i="yyyy-MM-dd"+(t?" HH:mm":""),r=bizagi.util.dateFormatter.getDateFromFormat(e,i);return 0==r&&t&&(i="yyyy-MM-dd"+(t?" HH:mm:ss":""),r=bizagi.util.dateFormatter.getDateFromFormat(e,i)),0!=r||t||(i="yyyy-MM-dd HH:mm",0==(r=bizagi.util.dateFormatter.getDateFromFormat(e,i))&&(i="yyyy-MM-dd HH:mm:ss",r=bizagi.util.dateFormatter.getDateFromFormat(e,i))),r},this.formatISO=function(e,t){var i="yyyy-MM-dd"+(t?" HH:mm":"");return bizagi.util.dateFormatter.formatDate(e,i)},this.formatISO8601=function(e,t){return(t=t||!1)&&e.setHours(0,0,0,0),bizagi.util.dateFormatter.formatDate(e,"yyyy-MM-ddTHH:mm:ss")},this.isFormatISO8601=function(e){return/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(([+-]\d\d:\d\d)|Z)?$/i.test(e)},this.sleep=function(e){for(var t=(new Date).getTime();(new Date).getTime()<t+e;);},this.getDateFormatByDatePickerJqueryUI=function(){return bizagi.localization.getResource("dateFormat").replace("yyyy","yy")}},bizagi.util.sleepUntil=function(e,t){t=t||200;var i=new $.Deferred;return function r(){var a=setTimeout((function(){if("pending"===i.state()){if(!!e())return i.resolve(),void clearTimeout(a);r(name)}}),t)}(),i.promise()},bizagi.util.sleepFor=function(e){e=e||200;var t,i=new $.Deferred;return t=setTimeout((function(){"pending"===i.state()&&(i.resolve(),clearTimeout(t))}),e),i.promise()},bizagi.util.browserSupportLocalStorage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},bizagi.util.setItemLocalStorage=function(e,t){return!!bizagi.util.browserSupportLocalStorage()&&(localStorage.setItem(e,t),!0)},bizagi.util.getItemLocalStorage=function(e){return localStorage.getItem(e)},bizagi.util.removeItemLocalStorage=function(e){localStorage.removeItem(e)},bizagi.util.clearLocalStorage=function(){bizagi.util.browserSupportLocalStorage()&&localStorage.clear()},"debug"==("undefined"!=typeof BIZAGI_ENVIRONMENT?BIZAGI_ENVIRONMENT:"release")?"object"!=_typeof(window.console)&&(window.console={log:function(e){}}):"object"!=("undefined"==typeof console?"undefined":_typeof(console))?window.console={log:function(e){}}:bizagiConfig&&!bizagiConfig.showConsoleLog&&(console.log=function(e){}),bizagi.util.startLoading=function(e){(e||$("body")).append('<div class="ui-widget-overlay ui-front" style="z-index: 1001;"><div class="ui-bizagi-loading-message-center" style="position: absolute; top: 48%; left: 48%; display: ;"><div class="ui-bizagi-loading-icon"></div></div></div>')},bizagi.util.stopLoading=function(e){var t=e||$("body");$(".ui-widget-overlay:first",t).remove()},bizagi.util.smartphone.startLoading=function(e){(e||$("body")).append('<div class="bz-util-loading-container"> <div class="ui-bizagi-loading-icon bz-util-loading"></div>  </div>')},bizagi.util.smartphone.stopLoading=function(e){var t=e||$("body");$(".bz-util-loading-container",t).remove()},bizagi.util.isEventSupported=function(e,t){var i,r=!("onblur"in document.documentElement);return!!e&&(t&&"string"!=typeof t||(t=document.createElement(t||"div")),!(i=(e="on"+e)in t)&&r&&(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(e,""),i="function"==typeof t[e],void 0!==t[e]&&(t[e]=void 0),t.removeAttribute(e))),i)},bizagi.circularDependencies=function(){var e=(new Function).prototype;e.list=[],e.lastNodeAdded,e.addNode=function(t,i){var n=JSON.encode(i),o=r(t,n);if(!o){var s=new a(t,n);return e.list.push({name:t,obj:n,nodeObj:s,timeStamp:(new Date).getTime()}),s}(e.lastNodeAdded||e.list[e.list.length-1]).nodeObj.addChild(o.nodeObj),e.lastNodeAdded=o},e.resolve=function(t,r,a){return t=t||i()||e.list[0].nodeObj,new n(t,r,a)};var t=function(){e.list=[]},i=function(){for(var t=0;t<e.list.length;t++)if(e.list[t].nodeObj.childs.length>0)return e.list[t].nodeObj;return e.list.length>0?e.list[0].nodeObj:{}},r=function(t,i){for(var r=0;r<e.list.length;r++)if(e.list[r].name==t){var a=(new Date).getTime();if(e.list[r].timeStamp+1e3<a)e.list.splice(r,1);else if(e.list[r].obj==i)return e.list[r]}return!1},a=function(e,t){e=e||"",t=t||{};var i=function(e,t){this.name=e,this.obj=t,this.childs=[]};return i.prototype.addChild=function(e){this.childs.push(e)},i}(),n=function(e,i,r){var a=function e(i,r,a){this.node=i||{},this.node.childs=this.node.childs||[],this.resolved=r||[],this.seen=a||[],this.seen.push(this.node);for(var o=0;o<this.node.childs.length;o++)if(!n.hasObject(this.node.childs[o],this.resolved)){if(n.hasObject(this.node.childs[o],this.seen)){t();var s={dependencyFrom:this.node.name,dependencyFromObj:this.node.obj,dependencyTo:this.node.childs[o].name,dependencyToObj:this.node.childs[o].obj,path:this.seen};return{error:$.extend({standardError:{status:"error",responseText:JSON.encode({message:n.makeErrorMessage(s),type:"alert"})},multiactionError:{message:n.makeErrorMessage(s),type:"alert"}},s)}}return e(this.node.childs[o],this.resolved,this.seen)}this.resolved&&this.resolved.push(this.node)},n=a.prototype;return n.hasObject=function(e,t){for(var i=0;i<t.length;i++)if(t[i].name==e.name)return!0;return!1},n.makeErrorMessage=function(e){return printf(bizagi.localization.getResource("render-actions-loop-validation"),e.dependencyFrom,e.dependencyTo)},a}();return e},bizagi.util.cssExtended=function(e,t){var r=t.split(";");for(i=0;i<r.length;i++)""!=r[i]&&bizagi.util.cssExtendedApplyChanges(e,r[i])},bizagi.util.cssExtendedApplyChanges=function(e,t){for(var i=0;i<e.length;i++){var r=$(e[i]),a=t.split(":")[0];if(r.attr("style")){var n=r.attr("style").split(";"),o=[],s="";for(j=0;j<n.length;j++){var l=n[j].split(":");$.trim(l[0])!=a&&""!=$.trim(l[0])&&o.push(l[0]+":"+l[1]+";"),s=JSON.stringify(o).replace(/\","/g," ").replace(/\["/g," ").replace(/\"]/g," ")}s="[]"==s?"":s,r.attr("style",s+t+";")}else if(r.css(a)){n=r.css(a),s="";(o=[]).push(t+";"),s="[]"==s?"":s,r.attr("style",s+t+";")}}},bizagi.util.scrollTop=function(e){if(e&&e[0])for(;"HTML"!==e[0].tagName&&"scroll"!=e.css("overflow-y")&&"auto"!=e.css("overflow-y")&&e.parent().length>0;)e=e.parent();return e},bizagi.util.sortJSON=function(e,t,i){return e.sort((function(e,r){var a=e[t],n=r[t];return"asc"===i?a<n?-1:a>n?1:0:"desc"===i?a>n?-1:a<n?1:0:void 0}))},bizagi.util.shortNumber=function(e){var t=e.toString(),i=t.length;return i>=4&&i<7?t="+"+t.charAt(0)+"K":i>=7&&i<10?t="+"+t.charAt(0)+"M":i>=10&&(t="+"+t.charAt(0)+"B"),"&nbsp;&nbsp;&nbsp;"+t},bizagi.util.replaceLineBreak=function(e){return"string"==typeof e?e.replace(/\r\n|\r|\n|<br>|<br\/>/g,"<br/>"):e},bizagi.util.escapeHtml=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},bizagi.util.formatMonetaryCell=function(e){return bizagi.util.formatMonetaryValue(e)},bizagi.util.formatDecimalCell=function(e){return bizagi.util.formatDecimalValue(e)},bizagi.util.formatDateValue=function(e){return bizagi.util.formatDateFromInvariantStringDate(e)},bizagi.util.formatMonetaryValue=function(e){return bizagi.util.formatMoney(e,BIZAGI_DEFAULT_CURRENCY_INFO)},bizagi.util.formatDecimalValue=function(e){var t,i={decimalSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,digitGroupSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,roundToDecimalPlace:BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits};t=$.extend({colorize:!1,decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0,negativeFormat:"(%s%n)",positiveFormat:"%s%n",roundToDecimalPlace:"2",symbol:""},i);var r=bizagi.util.formatDecimal(e,t);if(!0===bizagi.override.removeTrailingZeros){var a=!0;-1!=r.toString().indexOf(")")&&(a=!1,r=r.replace("(","").replace(")",""));var n=new RegExp("("+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"\\d*?[1-9])0+$","g");r=r.replace(n,"$1"),n=new RegExp("\\"+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"0+$","g"),r=r.replace(n,""),a||(r="("+r+")")}return r},bizagi.util.showNotification=function(e){e=e||{};var t=$('<div id="sync-notification" class="bz-cm-icon"></div>').text(e.text||"");t.appendTo($("body")),t.fadeIn(1500,(function(){t.stop()})),t.fadeOut(2e3,(function(){t.remove()}))},bizagi.util.isModeOnline=function(){return void 0!==bizagi.context.isOfflineForm&&!bizagi.context.isOfflineForm},bizagi.util.dispose=function(e){for(key in e)"object"==_typeof(e[key])&&delete e[key],"function"==typeof e[key]&&(e[key]=null,delete e[key])},bizagi.util.arrayEach=function(e,t){var i;if(e)if("[object Array]"===Object.prototype.toString.apply(e)&&"[object Function]"===Object.prototype.toString.apply(t)){for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(e[i],i,e[i]))return}else $.each(e,t)},bizagi.util.getStandardNotation=function(e,t){t=t||".";var i="",r=!1,a=!1;e=(e.length>0?e.toString().toLowerCase():"").replace(/ /g,"");for(var n=0;n<e.length;n++)("+"!==e[n]&&"-"!==e[n]||0!==n&&"e"!=e[n-1])&&isNaN(Number(e[n]))?e[n]!==t||r?"e"!==e[n]||a||(i+=e[n],a=!0):(i+=e[n],r=!0):i+=e[n];return i},bizagi.util.scientificNotationFormat=function(e,t,i,r,a){t=t||".",e=bizagi.util.getStandardNotation(e,t),i=i>0?i:38,r=r>0?r:-125,a=a>0?a:125;var n=new RegExp("[0-9]+("+t+"[0-9]+)?(e[+-]?[0-9]+)?"),o=e.match(n),s=0,l="-"===e[0]?e[0]:"",c=0;if(e=e.replace(l,""),o&&o[0]&&o[2]){var u=o[0]?o[0].replace(o[2],"").split(t):"",d="",g="";return u[0]=u[0].replace(/^0+/g,""),u[0].length>1?(c=(d=u[0].slice(1)).length,g=u[0][0]||"",d=d.concat(o[1]||"")):1===u[0].length?(g=u[0][0]||"",d=d.concat(u[1]||"")):(c=u[1].length,u[1]=u[1].replace(/^0+/g,""),c=u[1].length-1-c,g=u[1][0],d=u[1].slice(1)),(d=d.replace(t,"").replace(/0+$/g,"")).length>=i&&(d=d.slice(0,i-1)),l+g+(d?t+d:"")+"e"+((s=(s=Number(o[2].replace("e",""))+c)>a?a:s<r?r:s)>0?"+"+s:s)}if(e){c=e.indexOf(t);var p=0,m=e.length-1;e=e.replace(t,"");for(var f=p;!h;)"0"!==e[f]&&e[f]!==t?(h=!0,p=f):f++;for(var h=!1,v=m;!h;)"0"!==e[v]&&e[v]!==t?(h=!0,m=v+1):v--;if(m=m>i+p?i+p:m,-1!==c){h=!1;return s=c-(p+1),(d=e.slice(p,m)).length>0&&!isNaN(Number(d[0]))?l+d[0]+(d.length>1?t+d.slice(1):"")+"e"+(s>0?"+"+s:s):"0"}var b=e.slice(p,p+1),y=e.slice(p+1,e.length);return s=y.length,(y=y.replace(/0+$/g,"")).length>i&&(y=e.slice(p+1,i+p)),Number(b)?l+b+(y.length>0?t+y:"")+"e"+(s>0?"+"+s:s):"0"}return""},bizagi.util.stripslashes=function(e){return e.replace(/\\'/g,"'").replace(/\"/g,'"').replace(/\\\\/g,"\\").replace(/\\0/g,"\0")},bizagi.util.isHTMLValidText=function(e){return new RegExp(/<(.|\n)*?>/g).test(e)},bizagi.util.resetData=function(){var e=JSON.parse(sessionStorage.getItem("bizagiAuthentication"));sessionStorage.removeItem("bizagiAuthentication"),$.extend(e,{isAuthenticate:"false"}),sessionStorage.setItem("bizagiAuthentication",JSON.encode(e))},bizagi.util.changeData=function(e){var t=JSON.parse(sessionStorage.getItem("bizagiAuthentication"));sessionStorage.removeItem("bizagiAuthentication"),$.extend(t,e),sessionStorage.setItem("bizagiAuthentication",JSON.encode(t))},bizagi.util.isMobileDevice=function(e){return e=e||bizagi.detectDevice(),["smartphone_ios","smartphone_ios_native","smartphone_android","smartphone_android_native","tablet","tablet_ios","tablet_ios_native","tablet_android","tablet_android_native"].indexOf(e)>-1},bizagi.util.isNativeMobileDevice=function(e){return bizagi.util.isMobileDevice(e)&&bizagi.util.isNativePluginSupported()},bizagi.util.isTabletDevice=function(e){return e=e||bizagi.util.detectDevice(),["tablet","tablet_ios","tablet_ios_native","tablet_android","tablet_android_native"].indexOf(e)>-1},bizagi.util.isAndroidTabletDevice=function(e){return e=e||bizagi.util.detectDevice(),bizagi.util.isTabletDevice()&&-1!==e.indexOf("android")},bizagi.util.isiOSTabletDevice=function(e){return e=e||bizagi.util.detectDevice(),bizagi.util.isTabletDevice()&&!(-1===e.indexOf("android"))},bizagi.util.isSmartphoneDevice=function(e){return e=e||bizagi.util.detectDevice(),["smartphone_ios","smartphone_ios_native","smartphone_android","smartphone_android_native"].indexOf(e)>-1},bizagi.util.isAndroidSmartphoneDevice=function(e){return e=e||bizagi.util.detectDevice(),bizagi.util.isSmartphoneDevice()&&-1!==e.indexOf("android")},bizagi.util.isiOSSmartphoneDevice=function(e){return e=e||bizagi.util.detectDevice(),bizagi.util.isSmartphoneDevice()&&-1!==e.indexOf("ios")},bizagi.util.isOfflineForm=function(e){if(!bizagi.util.isMobileDevice()||void 0===e)return!1;var t=e.context||null,i=e.container||null,r=null!==i?i:null!==t?t.getFormContainer():null;if(null===r)return!1;var a=r.getParams()||{};return void 0!==a.isOfflineForm&&bizagi.util.parseBoolean(a.isOfflineForm)},bizagi.util.detectAndroidVersion=function(){var e=navigator.userAgent.toLowerCase().indexOf("android"),t=navigator.userAgent.toLowerCase().substring(e+8,e+13);return t=t.replaceAll(".",""),Number(t)},bizagi.util.getPathUrl=function(e){var t="",i=location.pathname.split("/"),r=location.protocol+"//"+location.host;if("/"==BIZAGI_PATH_TO_BASE[0])t=r+BIZAGI_PATH_TO_BASE+e;else{for(var a=BIZAGI_PATH_TO_BASE.split("../").length,n=0,o=i.length;n<o-a;n++)r+=i[n]+"/";t=(r="/"===r[r.length-1]?r:r+"/")+e}return t},bizagi.util.getAndroidVersion=function(){var e=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/);return!!e&&parseFloat(e[1])},bizagi.util.mobileImagePath=function(e){var t=e,i=bizagi.util.getAndroidVersion();if(!i)return t;if("content://com.android"===t.substring(0,21)&&i<=4.4){var r=t.split("%3A");r.length>1?t="content://media/external/images/media/"+r[1]:(r=t.split("/"),t="content://media/external/images/media/"+r[r.length-1])}return t},bizagi.util.isValidResource=function(e){return!!bizagi.localization&&bizagi.localization.getResource(e)!==e},bizagi.util.b64toBlob=function(e,t,i){t=t||"",i=i||512;for(var r=atob(e),a=[],n=0;n<r.length;n+=i){for(var o=r.slice(n,n+i),s=new Array(o.length),l=0;l<o.length;l++)s[l]=o.charCodeAt(l);var c=new Uint8Array(s);a.push(c)}return new Blob(a,{type:t})},bizagi.util.stringToByteArray=function(e){for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=255&e.charCodeAt(i);return t},bizagi.util.hasOfflineFormsEnabled=function(){return"undefined"!=typeof BIZAGI_ENABLE_OFFLINE_FORMS&&!0===bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS)},bizagi.util.isFlatDesignEnabled=function(){return"undefined"!=typeof BIZAGI_ENABLE_FLAT&&!0===bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT)},bizagi.util.isMobileGridEnabled=function(){return"undefined"!=typeof BIZAGI_ENABLE_MOBILE_GRID&&!0===bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID)},bizagi.util.isNativeHeaderEnabled=function(){return"undefined"!=typeof NATIVE_HEADER_ENABLE&&!0===bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE)},bizagi.util.isQuickSearchEnabled=function(){return"undefined"!=typeof BIZAGI_ENABLE_QUICK_SEARCH&&!0===bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH)},bizagi.util.isOAuth2Enabled=function(){return"undefined"!=typeof BIZAGI_AUTH_TYPE&&"OAuth"===BIZAGI_AUTH_TYPE},bizagi.util.getNativeComponent=function(){return"undefined"!=typeof BIZAGI_NATIVE_COMPONENT?BIZAGI_NATIVE_COMPONENT:""},bizagi.util.isVersionSupported=function(){var e=!0;if("undefined"!=typeof BIZAGI_SERVER_VERSION&&!bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)){var t=BIZAGI_SERVER_VERSION.match(/\d+\.\d+/);e=!t||parseFloat(t.shift())>=11}return e},bizagi.util.isCordovaSupported=function(){return"undefined"!=typeof cordova},bizagi.util.isNativePluginSupported=function(){return"undefined"!=typeof bizagiapp},bizagi.util.isTabletNativeSupported=function(){return"undefined"!=typeof bizagiapp&&bizagi.util.isTabletDevice()},bizagi.util.isSmartphoneNativeSupported=function(){return"undefined"!=typeof bizagiapp&&bizagi.util.isSmartphoneDevice()},bizagi.util.isNativePluginSupported()&&window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),bizagi.util.detectRealDevice=function(){var e="undefined"==typeof BIZAGI_DEFAULT_DEVICE||bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE)?null:BIZAGI_DEFAULT_DEVICE;BIZAGI_DEFAULT_DEVICE="";var t=bizagi.detectDevice();return BIZAGI_DEFAULT_DEVICE=e,t},bizagi.util.isAndroid=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},bizagi.util.isAndroidDevice=function(){return bizagi.util.detectDevice().indexOf("android")>-1},bizagi.util.isiOSDevice=function(){return-1===bizagi.util.detectDevice().indexOf("android")},bizagi.util.getChannelType=function(){return"undefined"==typeof BIZAGI_SERVER_CHANNEL||bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)?bizagi.loader.channel||"":BIZAGI_SERVER_CHANNEL},bizagi.util.isDataUrl=function(e){try{return!!e.toString().match(/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i)}catch(e){}return!1},bizagi.util.getDataUrl=function(e){var t;try{if(void 0===e.value||bizagi.util.isEmpty(e.value))t=e.url||"";else{var i=e.value,r=i.value||i;if(Array.isArray(r)){var a=r.shift();t=Array.isArray(a)?a.join(""):a}else t=r}(t=bizagi.util.isEmpty(t)?"":"data:image/png;base64,"+t.replace(/^data:.*;base64,/,""))&&-1!==t.indexOf("Invalid case id")&&(t="")}catch(e){t=""}return t},bizagi.util.processFailMessage=function(e){var t=e||{};try{t=(t="string"==typeof t?JSON.parse(t):t).responseText||t.message||t}catch(i){t=e}return t},bizagi.util.getErrorFormatted=function(e){var t=e;if(!t)return e;if("string"==typeof t)try{t=JSON.parse(t)}catch(i){t={type:"error",code:"code",message:e}}return"object"==_typeof(t)&&(t.message||t.statusText)?{type:t.type||"error",code:t.code||t.errorCode||t.errorType||t.statusText||"code",message:t.message}:(t&&t.length&&t.length>=1&&(t=t[0]),t.responseText&&(t=t.responseText),t.error&&(t=t.error),bizagi.util.getErrorFormatted(t))};var tmp_block_header="<div class='blockHeaderByLiveProcess'></div>";bizagi.util.disableWorkPortalMenu=function(){var e=$("body").find("#ui-bizagi-wp-menu").height();$(tmp_block_header).prependTo("body"),$("body").find(".blockHeaderByLiveProcess").css({position:"absolute",width:"100%",height:e+"px",background:"gray",opacity:"0.9","z-index":"101"})},bizagi.util.enableWorkPortalMenu=function(){$("body").find(".blockHeaderByLiveProcess").detach()},bizagi.util.enableMenuSection=function(e){(new bizagi.workportal.controllers.menu).setActiveSection.apply($("#main_menu li#"+e)[0])},bizagi.util.getURLWithASlashAtTheEnd=function(e){var t;return"/"===(t=e).substr(t.length-1)?e:e+"/"},bizagi.util.downloadFile=function(e,t,i){var r,a=new $.Deferred,n=void 0===i||i,o=(t?"":bizagi.util.getURLWithASlashAtTheEnd(bizagiConfig.applicationUrl))+e,s=0!==$("#iframe-download").length,l=function(){var e=$(this)[0],t=bizagi.localization.getResource("workportal-general-error-message-contact-administrator"),i=bizagi.util.tryCatch((function(){return $(e.contentDocument).text()}),t),r=-1!==i.indexOf("HTTP Error 503"),o=bizagi.util.tryCatch((function(){return JSON.parse(i)}),{code:"error",status:"error",message:""===i?t:i}),s=n&&!r;r&&bizagiConfig.maintenanceWindows.start(),function(e,t){t&&bizagi.modalError.show(e.message,void 0,!1),a.reject(e)}(o,s)};return s||((r=$("<iframe/>")).attr({style:"visibility:hidden;display:none",id:"iframe-download"}).appendTo("body"),r[0].onload=l),$("#iframe-download").attr("src",o),a},bizagi.util.downloadFileByPOST=function(e,t){0!==$("#iframe-download").length&&$("#iframe-download").remove(),$("<iframe/>").attr({style:"visibility:hidden;display:none",id:"iframe-download"}).appendTo("body");for(var i="",r=0;r<t.length;r++)i=i+"<input type='text' name='"+t[r].name+"' value='"+t[r].value+"'>";var a="<form id='formPOST' action='"+e+"' method='POST'>"+i+"</form>";$("#iframe-download").contents().find("body").append(a),bizagi.util.isIE11()?(bizagi.showErrorAlertDialog=!1,$.ajax({type:"POST",url:e,data:t,dataType:"text"}).then((function(){$("#formPOST",$("#iframe-download").contents()).submit()}))):$("#formPOST",$("#iframe-download").contents()).submit()},bizagi.util.executeActionRoutingFromWorkportal=function(e,t){bizagi.workportal.controllers.menu.prototype.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e,idWorkItem:t})},bizagi.util.getMessageFromNetworkState=function(e){return e?bizagi.localization.getResource("render-without-globalform-offline-userOnline","The case has been created successfully, please wait until the server synchronizes"):bizagi.localization.getResource("render-without-globalform-offline","Your offline case has been created successfully. It will synchronized as soon as you go online.")},bizagi.util.sanitizeHTML=function(e){var t=null!=e?e.toString():e,i=DOMPurify.sanitize(t),r=document.createElement("div");return r.innerHTML=i,0===r.childNodes.length?"":String(r.childNodes[0].nodeValue)},bizagi.util.arrayUnique=function(e){for(var t=e.concat(),i=0,r=t.length;i<r;++i)for(var a=i+1;a<r;++a)t[i]===t[a]&&t.splice(a-=1,1);return t},bizagi.util.debounce=function(e,t,i){var r;return function(){var a=this,n=arguments,o=function(){if(r=null,!i)return e.apply(a,n)},s=i&&!r;if(clearTimeout(r),r=setTimeout(o,t||200),s)return e.apply(a,n)}},bizagi.util.debounce2=function(e,t,i){var r,a=this,n=function(){var a=this,n=arguments,o=function(){if(r=null,!i)return e.apply(a,n)},s=i&&!r;if(clearTimeout(r),r=setTimeout(o,t||200),s)return e.apply(a,n)};return{timeout:r,cancel:function(){clearTimeout(r)},fire:function(){n.call(a,arguments)}}},bizagi.util.isNativeImageEditorSupported=function(){return bizagi.util.isNativePluginSupported()&&bizagi.util.isiOSDevice()&&bizagi.override.enableImageEditor},bizagi.util.errorMessage=function(e){return'<div class="admin-stakeholder-message"> <i class="bz-wp-empty__img"></i> <p class="bz-wp-empty__info bz-wp-empty__info--first"> '+e+"</p></div>"},bizagi.util.validateUrlWellFormed=function(e){var t=/^((http|https|ftp):\/\/)/.test(e)?e:"http://"+e,i=document.createElement("a");i.setAttribute("href",t);var r=DOMPurify.sanitize(i,{IN_PLACE:!0}),a=e?e.replace(/ /g,""):"";return bizagi.util.isEmpty(a)?null:r.href},bizagi.util.encodeHtmlText=function(e){var t=e||"",i="";if("string"==typeof t){var r=bizagi.util.decodeURI(t);i=bizagi.util.encodeString(r)}return i},bizagi.util.encodeString=function(e){var t=e||"";return t=(t=(t=(t=(t=t.replaceAll("&","&amp;")).replaceAll("$","&#36;")).replaceAll("<","&lt;").replaceAll(">","&gt;")).replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;")).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},bizagi.util.setCaretPosition=function(e,t){if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",e),i.select()}},bizagi.util.getCaretPosition=function(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},bizagi.util.escapeRegex=function(e){return(e=e||"").replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},bizagi.util.getFeatureObject=function(e){var t=e.split(".");return this.featureObjectCache=this.featureObjectCache||{},e in this.featureObjectCache?this.featureObjectCache[e]:this.featureObjectCache[e]=function(t){var i=bizagi.util.getConfigFeatures();if("string"==typeof e&&void 0!==i){for(var r=i,a=0,n=t.length;a<n;a++)if(void 0===(r=r[t[a]]))return;return r}}(t)},bizagi.util.getConfigFeatures=function(){var e=window.bizagiConfig||bizagiConfig||{};return bizagi.util.isMobileDevice()&&"undefined"!=typeof BIZAGI_MOBILE_FEATURES&&!bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)&&(e.features=JSON.parse(BIZAGI_MOBILE_FEATURES||"{}")),e.features},bizagi.util.resetConfigFeatures=function(){bizagi.util.featureObjectCache=void 0},bizagi.util.isFailResponse=function(e){return e&&(e.type&&"error"===e.type||e.status&&"error"===e.status||e.code&&"UNKNOWN_ERROR"===e.code)},bizagi.util.formatItem=function(e){if(null!=e){if($.isArray(e)){for(var t=0,i=e.length;t<i;t++)null!=e[t]&&"boolean"==typeof e[t]&&(!0===bizagi.util.parseBoolean(e[t])?e[t]=bizagi.localization.getResource("render-boolean-yes"):!1===bizagi.util.parseBoolean(e[t])&&(e[t]=bizagi.localization.getResource("render-boolean-no"))),e[t]=bizagi.util.sanitizeHTML(e[t]);return e.join(" - ")}return bizagi.util.sanitizeHTML(e)}return""},bizagi.util.performTermMatches=function(e,t,i){return"object"===_typeof(e)?bizagi.util.formatItem(e):"string"==typeof e?i?bizagi.util.sanitizeHTML(e):bizagi.util.highlightMatches(e,t):e},bizagi.util.highlightMatches=function(e,t){var i=bizagi.util.escapeRegex(t).replaceAll("%",""),r=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+i+")(?![^<>]*>)(?![^&;]+;)","gi");return bizagi.util.sanitizeHTML(e).replace(r,"<strong>$1</strong>")},bizagi.util.getDesktopResolution=function(){var e="",t=1,i=window.screen.width,r=window.screen.height;return"deviceXDPI"in screen?t=screen.deviceXDPI/screen.logicalXDPI:"devicePixelRatio"in window&&(t=window.devicePixelRatio),t=Number(t.toFixed(3)),i&&i>0&&r&&r>0&&(e=i*t+"x"+r*t),e},bizagi.util.getDeviceCode=function(){return bizagi.util.isMobileDevice()?"undefined"==typeof BIZAGI_DEVICE_MARKET_NAME||bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME)?"":BIZAGI_DEVICE_MARKET_NAME:bizagi.util.getDesktopResolution()},bizagi.util.normalizeType=function(e){return void 0===e?e:e.replace(/smartphone/,"").replace(/tablet/,"").replace(/offline/,"")},bizagi.util.normalizeQueryType=function(e){return void 0===e?e:e.replace(/query/,"").toLowerCase()},bizagi.util.hideOrShowXToCloseDialog=function(e,t){var i=".ui-dialog-titlebar-close";t?$(i,e).show():$(i,e).hide()},bizagi.util.isEnableFeature=function(e){return void 0===bizagi.features&&(bizagi.features=[]),!1!==bizagi.features[e]},bizagi.util.isHtml=function(e){return/<[a-z][\s\S]*>/i.test(e)},bizagi.util.tryCatch=function(e,t){try{return e()}catch(e){return"function"==typeof t?t():t}},bizagi.util.pipe=function(e,t){var i=void 0===t?[]:t;return i.push(e),{next:function(e){return bizagi.util.pipe(e,i)},end:function(e){return i.reduce((function(e,t){return t(e)}),e)}}},function(e){var t=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},i=function(e){return/(auto|scroll)/.test(function(e){return t(e,"overflow")+t(e,"overflow-y")+t(e,"overflow-x")}(e))};e.scrollerParent=function(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=function e(t,i){return null===t.parentNode?i:e(t.parentNode,i.concat([t]))}(e.parentNode,[]),r=0;r<t.length;r+=1)if(i(t[r]))return t[r];return document.scrollingElement||document.documentElement}}}(jQuery),bizagi.util.startkendo=function(e){void 0===bizagi.kendoMobileApplication?(bizagi.kendoMobileApplication=new kendo.mobile.Application($("body"),{skin:"flat",browserHistory:!1,init:function(t){kendo.ui.progress($(".km-flat"),!0),e.started&&e.started()}}),bizagi.kendoMobileApplication.bizagiNavigate=function(e,t){this.navigate(e,t)}):e.started&&e.started()},bizagi.util.isMashupContext=function(){return"undefined"!=typeof BIZAGI_MASHUP_CONTEXT&&!0===bizagi.util.parseBoolean(BIZAGI_MASHUP_CONTEXT)},bizagi.util.isSharepointContext=function(){return"undefined"!=typeof BIZAGI_SHAREPOINT_CONTEXT&&!0===bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT)},bizagi.util.isWebpartContext=function(){return"undefined"!=typeof isWebpart&&!0===bizagi.util.parseBoolean(isWebpart)},bizagi.util.startTimeline=function(e){(new bizagi.workportal.widgets.widget).showTimeLine(e)},bizagi.util.startGraphicquery=function(e){(new bizagi.workportal.widgets.widget).showGraphicQuery(e)},bizagi.util.startSelectUser=function(){return function(e,t){var i=$.Deferred();(new bizagi.workportal.widgets.widget).showSelectUser(i),i.done((function(t,i,r){e({userId:t,userName:i,guid:r})})).fail((function(){e({})}))}},bizagi.util.isEmptyValue=function(e){if(0===e)return!1;if(null==e||""===e)return!0;if("Array"==typeof e)return 0===e.length;if("[object Array]"===Object.prototype.toString.apply(e))return 0===e.length;if("[object Object]"===Object.prototype.toString.apply(e)){for(var t in e)if(e.hasOwnProperty(t)&&!bizagi.util.isEmptyValue(e[t]))return!1;return!0}return!1},bizagi.util.initializeReferrerParams=function(){bizagi.referrerParams||(bizagi.referrerParams={})},bizagi.util.getLPQueriesParameters=function(){return bizagi.util.initializeReferrerParams(),bizagi.referrerParams.sidebarData},bizagi.util.getLPQueriesSelectedItemFromTree=function(){return bizagi.util.initializeReferrerParams(),bizagi.referrerParams.selectedTreeItem},bizagi.util.setLPQueriesParameters=function(e,t){bizagi.util.initializeReferrerParams(),bizagi.referrerParams.sidebarData=e,bizagi.referrerParams.selectedTreeItem=t},bizagi.util.cleanLPQueriesParameters=function(){bizagi.referrerParams&&(bizagi.referrerParams.sidebarData=null,bizagi.referrerParams.selectedTreeItem=null)},bizagi.util.setLPQueriesReferrer=function(){bizagi.referrerParams.referrer="LPQueries"},bizagi.util.isConnected=function(){return bizagi.util.isNativeMobileDevice()?!navigator||void 0===navigator.connection||"undefined"==typeof Connection||!(navigator.connection.type==Connection.NONE||"unknown"==navigator.connection.type):!bizagi.util.isMobileDevice()||"debug"!==(""+BIZAGI_ENVIRONMENT).toLowerCase()||(!window.navigator||window.navigator.onLine)},bizagi.util.isRenderingUrlAllowed=function(e){for(var t,i=["Rest/(Handlers|Userfields|DocumentTemplates|(Processes(?!/(RecentProcesses|OfflineProcessTree)))|Cases|Authentication|Users)","Api/(Authentication|Entities|Users)"],r=(e||"").replaceAll("../","").replaceAll("./","");t=i.shift();){var a=new RegExp(t,"i");if(null!==r.match(a))return!0}return!1},bizagi.util.applyEyeFunction=function(e){function t(t){$(t,e).parent().find("svg").remove(),$(t,e).after('<svg  class=\'eye_show_icon\'  xmlns="http://www.w3.org/2000/svg" width="16" height="16">\n<path d="M15 7.8C14.9 7.6 12.7 3 8 3S1.1 7.6 1 7.8v.4c.1.2 2.3 4.8 7 4.8s6.9-4.6 7-4.8v-.4zM8 12c-3.5 0-5.5-3.1-5.9-4 .4-.9 2.4-4 5.9-4 3.5 0 5.5 3.1 5.9 4-.4.9-2.4 4-5.9 4z"/>\n<path d="M8 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 3c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.4 1-1 1z"/></svg>'),$(t,e).parent().find("input[type='text']").attr("type","password"),$(t,e).parent().find("svg").click(r(!0))}function i(t){$(t,e).parent().find("svg").remove(),$(t,e).after('<svg class=\'eye_hide_icon\' xmlns="http://www.w3.org/2000/svg" width="16" height="16">\n<path d="M3.6 10.5l.7-.7a12.1 12.1 0 0 1-2-1.6C3.1 7.3 5.4 5 8 5h1l.8-.8A6 6 0 0 0 8 4C4.3 4 1.4 7.8 1.2 7.9l-.2.3.3.3a12.3 12.3 0 0 0 2.3 2zm8.7-4.9l-.7.7a12.4 12.4 0 0 1 2.1 1.9C12.9 9 10.6 11 8 11H7l-.8.8L8 12c3.7 0 6.6-3.3 6.7-3.5l.3-.3-.2-.3a12.8 12.8 0 0 0-2.5-2.3zM1.5 15h-.4a.5.5 0 0 1 0-.7l13-13a.5.5 0 1 1 .7.7l-13 13h-.3z"/><path d="M6.3 7.8a1.7 1.7 0 0 1 1.5-1.5l.9-.9H8A2.7 2.7 0 0 0 5.3 8a2.7 2.7 0 0 0 .1.7l.9-.9zm3.4.4a1.7 1.7 0 0 1-1.5 1.5l-.9.9H8A2.7 2.7 0 0 0 10.7 8a2.7 2.7 0 0 0-.1-.7l-.9.9z"/></svg>'),$(t,e).parent().find("input[type='password']").attr("type","text"),$(t,e).parent().find("svg").click(r(!0))}function r(r){return function(a){if(r){var n=$(this).attr("class")||"",o=$(this).parent().find("input");"eye_show_icon"===n?i(o):t(o)}else $($(a,e).parent().find("svg")[0]).click((function(e){var r=$(this).attr("class")||"",a=$(this).parent().find("input");"eye_show_icon"===r?i(a):t(a)}))}}$(e).find("input[type='password']").map((function(e,i){e>0&&(t(i),r(!1)(i))}))},bizagi.util.accessibilityEnter=function(e,t,i){if("function"!=typeof t)throw new Error('Error in "accessibilityEnter" function: You must provide a valid callback');-1!==(i=$.isArray(i)?i:[]).indexOf("click")||i.push("click"),e.bind("keypress",(function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),13!==e.which&&32!==e.which||t(e)})),e.bind(i.join(", "),(function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),t(e)}))},bizagi.util.recreateNativeButtons=function(e){var t=e.getFormContainer().getParams();if(bizagi.util.isNativePluginSupported()&&bizagi.util.isiOSSmartphoneDevice()){var i=t.navigation;void 0!==i&&i.setNavigationButtons(e)}},bizagi.util.isOverrideFeatureEnabled=function(e){var t=bizagi.override&&bizagi.override[e]||null;return!0===bizagi.util.parseBoolean(t)},bizagi.util.createDynamicClass=function(nameClass,renderParams){if(nameClass)try{var dynamicFunction="var dynamicFn = function(renderParams){ \r\n";return dynamicFunction+="return new "+nameClass+"(renderParams);\r\n",dynamicFunction+="}\r\n",dynamicFunction+="dynamicFn",dynamicFunction=eval(dynamicFunction),dynamicFunction(renderParams)}catch(e){console.log(e)}return null},bizagi.util.languages={es:"es","es-ES":"es","es-AR":"es","es-BO":"es","es-Cl":"es","es-CO":"es","es-CR":"es","es-DO":"es","es-EC":"es","es-SV":"es","es-GT":"es","es-HN":"es","es-MX":"es","es-NI":"es","es-PA":"es","es-PY":"es","es-PR":"es","es-PE":"es","es-US":"es","es-UY":"es","es-VE":"es",en:"en-US","en-AU":"en-US","en-BZ":"en-US","en-CA":"en-US","en-029":"en-US","en-IN":"en-US","en-IE":"en-US","en-JM":"en-US","en-MY":"en-US","en-NZ":"en-US","en-PH":"en-US","en-SG":"en-US","en-ZA":"en-US","en-TT":"en-US","en-GB":"en-US","en-US":"en-US","en-ZW":"en-US",de:"de","de-AT":"de","de-DE":"de","de-LI":"de","de-LU":"de","de-CH":"de",fr:"fr","fr-BE":"fr","fr-CA":"fr","fr-LU":"fr","fr-MC":"fr","fr-CH":"fr","fr-FR":"fr",it:"it","it-IT":"it","it-CH":"it",ja:"ja","ja-JA":"ja","ja-JP":"ja",nl:"nl","nl-NL":"nl","nl-BE":"nl",pt:"pt-PT","pt-BR":"pt-PT","pt-PT":"pt-PT",ru:"ru","ru-RU":"ru",cs:"cs","cs-CZ":"cs",ar:"ar","ar-DZ":"ar","ar-BH":"ar","ar-EG":"ar","ar-IQ":"ar","ar-JO":"ar","ar-KW":"ar","ar-LB":"ar","ar-LY":"ar","ar-MA":"ar","ar-OM":"ar","ar-QA":"ar","ar-SA":"ar","ar-SY":"ar","ar-TN":"ar","ar-AE":"ar","ar-YE":"ar",zh:"zh","zh-HK":"zh","zh-MO":"zh","zh-CN":"zh","zh-Hans":"zh","zh-SG":"zh","zh-TW":"zh","zh-Hant":"zh"},bizagi.util.getNormalizedDate=function(e,t,i){var r=e;try{e&&"string"==typeof e&&(r=bizagi.util.dateFormatter.getDateFromInvariant(e,i)),r&&0!==r&&null!=r&&(i?r.setMilliseconds(0):r.setHours(0,0,0,0),r=bizagi.util.dateFormatter.formatDate(r,t))}catch(e){}return r},bizagi.util.isFeatureEnabled=function(e){var t=bizagi.override&&bizagi.override[e];return bizagi.util.parseBoolean(t)},bizagi.util.getLastProcessInboxKey=function(){var e="lastProcessInbox";return e=e.concat("_",bizagi.util.getUserHash())},bizagi.util.lastProcessInboxInit=function(){bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(bizagi.util.getLastProcessInboxCreate()))},bizagi.util.getLastProcessInboxCreate=function(){return{processInfo:bizagi.util.createLastProcessInboxProcess(),sortInfo:bizagi.util.createLastProcessInboxSort(),filterInfo:bizagi.util.createLastProcessInboxFilter(),processColumnsInfo:bizagi.util.createLastProcessInboxColumns(),inputTrayInfo:bizagi.util.createLastProcessInboxInputTray()}},bizagi.util.createLastProcessInboxProcess=function(){return{processInfoName:null,idWorkflow:-1}},bizagi.util.createLastProcessInboxSort=function(){return{sortDirection:"asc",sortFieldName:null,sortOrder:null}},bizagi.util.createLastProcessInboxFilter=function(){return{filterValue:null,filterFieldName:null,filterType:"equal"}},bizagi.util.createLastProcessInboxColumns=function(){return{processColumns:[]}},bizagi.util.createLastProcessInboxInputTray=function(){return"inbox"},bizagi.util.getLastProcessInbox=function(){var e=bizagi.util.getItemLocalStorage(bizagi.util.getLastProcessInboxKey());return e||(bizagi.util.lastProcessInboxInit(),e=bizagi.util.getItemLocalStorage(bizagi.util.getLastProcessInboxKey())),JSON.parse(e)},bizagi.util.setLastProcessInbox=function(e,t,i){var r=bizagi.util.getLastProcessInbox();r.processInfo&&(r.processInfo.idWorkflow!=t?r.processColumnsInfo=null:bizagi.util.isEmpty(i)||r.processInfo.smartInboxId==i||(r.processColumnsInfo=null)),r.processInfo.processInfoName=e,r.processInfo.idWorkflow=parseInt(t||-1),r.processInfo.smartInboxId=void 0!==i?i:null,r.filterInfo&&(r.filterInfo=bizagi.util.createLastProcessInboxFilter()),bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(r))},bizagi.util.setLastProcessInboxProcessColumns=function(e){var t=bizagi.util.getLastProcessInbox();t.processColumnsInfo=t.processColumnsInfo||{},t.processColumnsInfo.processColumns=e||[],bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(t))},bizagi.util.getLiveFiltersFromStorage=function(e){var t=[],i=bizagi.util.getItemLocalStorage("livefilters");try{var r=JSON.parse(i);t=void 0!==r[e]?JSON.parse(r[e]):t}catch(e){t=[]}return t},bizagi.util.setLiveFiltersToStorage=function(e,t){var i=bizagi.util.getItemLocalStorage("livefilters")||"[]",r=JSON.parse(i);r[e]=JSON.stringify(t),bizagi.util.setItemLocalStorage("livefilters",JSON.encode(Object.assign({},r)))},bizagi.util.setLastProcessInboxLiveFilter=function(e){var t=bizagi.util.getLastProcessInbox();t.liveFilters=e||[],bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(t))},bizagi.util.setLastProcessInboxSort=function(e,t,i){var r=bizagi.util.getLastProcessInbox();r.sortInfo.sortFieldName=e||null,r.sortInfo.sortDirection=t||"asc",r.sortInfo.sortOrder=i||null,bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(r))},bizagi.util.setLastProcessInboxFilter=function(e,t,i){var r=bizagi.util.getLastProcessInbox();r.filterInfo.filterValue=e||null,r.filterInfo.filterFieldName=t||null,r.filterInfo.filterType=i||"equal",bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(r))},bizagi.util.setLastProcessInboxInputTray=function(e){var t=bizagi.util.getLastProcessInbox();t.inputTrayInfo=e||"",bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(t))},bizagi.util.getLastProcessInboxProcessInfo=function(){var e=bizagi.util.getLastProcessInbox();return bizagi.localization&&null==e.processInfo.processInfoName&&(e.processInfo.processInfoName=bizagi.localization.getResource("workportal-widget-inbox-all-processes")),e.processInfo.allProcesses=-1===e.processInfo.idWorkflow,e.processInfo},bizagi.util.getLastProcessInboxSmartInboxId=function(){return bizagi.util.getLastProcessInbox().processInfo.smartInboxId},bizagi.util.getLastProcessInboxSort=function(){return bizagi.util.getLastProcessInbox().sortInfo},bizagi.util.getLastProcessInboxFilter=function(){return bizagi.util.getLastProcessInbox().filterInfo},bizagi.util.getLastProcessInboxLiveFilter=function(){return bizagi.util.getLastProcessInbox().liveFilters},bizagi.util.getLastProcessInboxProcessColumns=function(){return bizagi.util.getLastProcessInbox().processColumnsInfo},bizagi.util.getLastProcessInboxInputTray=function(){return bizagi.util.getLastProcessInbox().inputTrayInfo},bizagi.util.removeLastProcessInbox=function(){bizagi.util.removeItemLocalStorage(bizagi.util.getLastProcessInboxKey())},bizagi.util.removeLastProcessInboxSort=function(){var e=bizagi.util.getLastProcessInbox();e&&e.sortInfo&&(e.sortInfo=bizagi.util.createLastProcessInboxSort(),bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(e)))},bizagi.util.removeLastProcessLiveFilters=function(){var e=bizagi.util.getLastProcessInbox();e&&e.liveFilters&&(e.liveFilters=[],bizagi.util.setItemLocalStorage(bizagi.util.getLastProcessInboxKey(),JSON.stringify(e)))},bizagi.util.getSyncTimeStampKey=function(){var e="syncTimeStamp";return e=e.concat("_",bizagi.util.getUserHash())},bizagi.util.storeSyncTimeStamp=function(e){bizagi.util.setItemLocalStorage(bizagi.util.getSyncTimeStampKey(),e.toString())},bizagi.util.getSyncTimeStamp=function(){var e=bizagi.util.getItemLocalStorage(bizagi.util.getSyncTimeStampKey());return e?new Date(e):void 0},bizagi.util.getUserHash=function(){return("undefined"!=typeof BIZAGI_USER?(BIZAGI_USER+"-"+BIZAGI_PROXY_PREFIX+"-"+BIZAGI_DOMAIN).toLowerCase():"admon-http://localhost/bizagiR100x-domain").hashCode()},bizagi.util.defaultWidget=function(e){var t=bizagi.services.preferences(),i=bizagi.workportal.widgets.widget,r={set:function(e){bizagi.cookie("bizagiDefaultWidget",e,{expires:30})},get:function(){return bizagi.cookie("bizagiDefaultWidget")}},a={set:function(e){var i="inbox"===e?"DETAIL":"TABLE";t.changePreference(t.name.INBOX_VIEW_TYPE,i)},get:function(){var e=t.getPreference(t.name.INBOX_VIEW_TYPE);return"DETAIL"===e?i.BIZAGI_WORKPORTAL_WIDGET_INBOX:i.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID}},n=bizagi.util.isMobile?r:a;return void 0!==e&&n.set(e),n.get()},bizagi.util.getMobileFeaturesKey=function(){var e="undefined"!=typeof BIZAGI_USER?(BIZAGI_USER+"-"+BIZAGI_PROXY_PREFIX+"-"+BIZAGI_DOMAIN).toLowerCase():"admon-http://localhost/bizagiR100x-domain",t="mobileFeatures";return t=t.concat("_",e)},bizagi.util.getMobileFeatures=function(){var e=bizagi.util.getItemLocalStorage(bizagi.util.getMobileFeaturesKey());return $.extend(bizagi.util.isEmpty(e)?{}:JSON.parse(e),bizagiConfig.features)},bizagi.util.storeMobileFeatures=function(e){var t=bizagi.util.getMobileFeatures(),i=$.extend(t,e);bizagi.util.setItemLocalStorage(bizagi.util.getMobileFeaturesKey(),JSON.stringify(i))},bizagi.util.getCardviewMaxColumsAllowed=function(){var e=100,t=bizagi.util.getMobileFeatures();return t&&t.maxColumnsEnabled&&!0===t.maxColumnsEnabled.enabled&&(e=t.maxColumnsEnabled.value),e},bizagi.util.blobTob64=function(e,t){var i=new $.Deferred,r=new FileReader;return r.readAsDataURL(e),r.onloadend=function(){base64data=r.result,t&&(base64data=base64data.split(",")[1]),i.resolve(base64data)},i},bizagi.util.blobToText=function(e){var t=new $.Deferred,i=new FileReader;return i.readAsText(e),i.onloadend=function(){t.resolve(i.result)},t.promise()},bizagi.util.getDataUrl=function(e){var t;try{if(void 0===e.value||bizagi.util.isEmpty(e.value))t=e.url||"";else{var i=e.value,r=i.value||i;if(Array.isArray(r)){var a=r.shift();t=Array.isArray(a)?a.join(""):a}else t=r}(t=bizagi.util.isEmpty(t)?"":"data:image/png;base64,"+t.replace(/^data:.*;base64,/,""))&&-1!==t.indexOf("Invalid case id")&&(t="")}catch(e){t=""}return t},bizagi.util.getDataUrl=function(e,t){var i;try{if(void 0===e||bizagi.util.isEmpty(e))i=t||"";else{var r=e,a=r.value||r;if(Array.isArray(a)){var n=a.shift();i=Array.isArray(n)?n.join(""):n}else i=a}(i=bizagi.util.isEmpty(i)?"":"data:image/png;base64,"+i.replace(/^data:.*;base64,/,""))&&-1!==i.indexOf("Invalid case id")&&(i="")}catch(e){i=""}return i},bizagi.util.console={},bizagi.util.console.log=function(){if("Bugsee"in window||bizagi.util.isCordovaSupported()){var e=Array.prototype.slice.call(arguments),t=e[0],i=e.length>1?e.slice(1):null;if(i)try{return void console.log("BUGSEE: "+t+" \r\n"+JSON.encode(i))}catch(e){}}console.log.apply(this,arguments)},bizagi.util.console.error=function(){if("Bugsee"in window||bizagi.util.isCordovaSupported()){var e=Array.prototype.slice.call(arguments),t=e[0],i=e.length>1?e.slice(1):null;if(i)try{return void console.error("BUGSEE: "+t+" \r\n"+JSON.encode(i))}catch(e){}}console.error.apply(this,arguments)},bizagi.util.deepExtend=function(e){e=e||{};for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i)for(var r in i)i.hasOwnProperty(r)&&("object"===_typeof(i[r])?i[r]instanceof Array==1?e[r]=i[r].slice(0):e[r]=deepExtend(e[r],i[r]):e[r]=i[r])}return e},bizagi.util.extend=function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var i in arguments[t])arguments[t].hasOwnProperty(i)&&(e[i]=arguments[t][i]);return e},bizagi.util.getColumnType=function(e){if(void 0===e)return"default";var t=e.replace("column","").toLowerCase();return bizagi.util.normalizeType(t)},bizagi.util.mapAlignClassName=function(e){return{rigth:"flex-end",left:"flex-start",justify:"flex-start",default:"center",center:"center"}[e]||"center"},bizagi.util.isMobileErrorTracesEnabled=function(){var e=!1,t=bizagi.util.getMobileFeatures();return t&&t.mobileErrorTraces&&!0===t.mobileErrorTraces.enabled&&(e=!0),e&&bizagi.util.isTabletDevice()},bizagi.util.isMobileSmartInboxEnabled=function(){var e=!1,t=bizagi.util.getMobileFeatures();return t&&t.mobileSmartInbox&&!0===t.mobileSmartInbox.enabled&&(e=!0),e&&bizagi.util.isTabletDevice()},bizagi.util.isMobileLiveFiltersEnabled=function(){var e=!1,t=bizagi.util.getMobileFeatures();return t&&t.mobileLiveFilters&&!0===t.mobileLiveFilters.enabled&&(e=!0),e&&bizagi.util.isTabletDevice()},bizagi.util.getColumnType=function(e){if(void 0===e)return"default";var t=e.replace("column","").toLowerCase();return bizagi.util.normalizeType(t)},$.any=function(e,t){if(void 0===e||null==e||0==e.length)return!1;var i=$.grep(e,t);return null!=i&&void 0!==i&&i.length>0},$.first=function(e,t){if(void 0===e||null==e||0==e.length)return null;var i=$.grep(e,t);return null==i||void 0===i||0==i.length?null:i[0]},$.groupBy=function(e,t){if(void 0===e||null==e||0==e.length)return{};var i={};return $.each(e,(function(e,r){void 0!==r&&(void 0===i[r[t]]&&(i[r[t]]=[]),i[r[t]].push(r))})),i},bizagi.util.downloadBlobFile=function(e,t){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var i=window.URL.createObjectURL(e),r=document.createElement("a");r.style="display: none",document.body.appendChild(r),r.href=i,r.download=t,r.click(),window.URL.revokeObjectURL(i),r.parentNode.removeChild(r)}},bizagi.util.handleJSONResponse=function(e){var t=new $.Deferred;return e&&/application\/json/i.test(e.type)?bizagi.util.blobToText(e).then((function(i){"error"===JSON.parse(i).type?t.reject(i):t.resolve(e)})).fail((function(e){t.reject(e)})):t.resolve(e),t.promise()},bizagi.util.bzValidator=function(e){var t=[],i=[];return{add:function(e,i){return"function"==typeof e?t.push({callback:e,message:i}):console.warn("Callback is not a function"),this},validate:function(r){i=[];try{t&&t.length>0?t.forEach((function(t){var r=t.callback(e);bizagi.util.isBoolean(r)?r||i.push(t.message||"Validation error"):i.push("Callback evaluation is not a function: "+t.message)})):i.push("There are not validators added")}catch(e){console.warn(e)}return r({errors:i}),t=[],this},isValid:function(){return i&&!i.length}}},bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.services=void 0!==bizagi.services?bizagi.services:{},bizagi.services.ajax=void 0!==bizagi.services.ajax?bizagi.services.ajax:{},bizagi.log=bizagi.log||function(){},bizagi.assert=bizagi.assert||function(){},bizagi.services.ajax.useAbsolutePath="undefined"!=typeof BIZAGI_USE_ABSOLUTE_PATH&&BIZAGI_USE_ABSOLUTE_PATH,bizagi.services.ajax.pathToBase=bizagi.services.ajax.useAbsolutePath?bizagi.loader.getLocationPrefix():"undefined"!=typeof BIZAGI_PATH_TO_BASE?BIZAGI_PATH_TO_BASE:"",bizagi.services.ajax.loginPage=bizagi.services.ajax.pathToBase||"default.htm",bizagi.services.ajax.errorPage=bizagi.services.ajax.pathToBase+"error.html",bizagi.services.ajax.rpcEnabled=!1,bizagi.services.ajax.rpcHandler="RestServices/JsonRpcHandler.ashx",bizagi.services.ajax.logEnabled=!0,bizagi.services.ajax.logSuccess=!0,bizagi.services.ajax.logSubmits=!0,bizagi.services.ajax.logFail=!0,bizagi.services.ajax.batch={},bizagi.services.ajax.batchCount=0,bizagi.services.ajax.batchTimer=100,bizagi.services.ajax.batchTimeoutInstance=null,bizagi.services.ajax.parseJSON=function(e){var t={};e=e.replace(/(\r\n|\n|\r)/gm,"");try{t=$.parseJSON(e)}catch(i){try{t=$.parseJSON(e.replace(/\x1d/g,"."))}catch(r){t.type="error",t.code=i.errorCode,t.message=e}}if(t.type&&"error"==t.type||t.status&&"error"==t.status){"AUTH_ERROR"==t.code||"AUTHENTICATION_ERROR"==t.code||t.code,"licenseError"==t.code&&(window.location=bizagi.services.ajax.errorPage+"?message="+t.message+"&type="+t.type);var i=(t.code?t.code:"")+(t.message?""+t.message:"");jQuery.error(i)}return localStorage.setItem("clientLog","false"),t},$.ajaxSetup({converters:{"text json":bizagi.services.ajax.parseJSON},beforeSend:function(e,t){"json"!=t.dataType||t.batchRequest||(e._loading=!0,bizagi&&bizagi.loading&&bizagi.loading.start())},complete:function(e){if(e._loading&&bizagi&&bizagi.loading&&bizagi.loading.stop(),401===e.status){if(e.responseJSON&&"implicitPrincipalInjection"===e.responseJSON.validationMethod)return;bizagi.services.redirectToLoginPage()}else 503===e.status&&"undefined"==typeof cordova&&bizagi.loader.startPageMaintenance()}});var jqAutoLogin=function(e){this.options={},this.user={},this.intercept=!1,this.refreshing=!1,this.buffer=[],this.currentRequests=[],this._resetOptions(),this._setupInterceptor(),$.extend(this.options,e),this._resetData()};jqAutoLogin.prototype.logout=function(){this._resetData(),this._deactivateInterceptor(),this._fireEvent("logout")},jqAutoLogin.prototype.login=function(e){this.setUserData(e),this._activateInterceptor(),this._fireEvent("login")},jqAutoLogin.prototype.setUserData=function(e){this.user={user:e.user||null,password:e.password||null,domain:e.domain||null}},jqAutoLogin.prototype._activateInterceptor=function(){this.intercept=!0},jqAutoLogin.prototype._addToBuffer=function(e,t){this.buffer.push({deferred:t,settings:e})},jqAutoLogin.prototype._clearBuffer=function(){this.buffer=[]},jqAutoLogin.prototype._deactivateInterceptor=function(){this.intercept=!1},jqAutoLogin.prototype._fireBuffer=function(){var e,t=this,i=[];for(var r in this.buffer)e=this.buffer[r].deferred,this.buffer[r].settings.refreshRetry=!0,i.push($.ajax(this.buffer[r].settings).then(e.resolve,e.reject));this._clearBuffer(),$.when.apply($,i).done((function(){t._setRefreshingFlag(!1)})).fail((function(){t._setRefreshingFlag(!1),t.logout()}))},jqAutoLogin.prototype._fireEvent=function(e){if(this._hasEvent(e))return this.options.events[e]()},jqAutoLogin.prototype._hasEvent=function(e){return void 0!==this.options.events[e]&&"function"==typeof this.options.events[e]},jqAutoLogin.prototype._resetData=function(){this.user={user:null,password:null,domain:null}},jqAutoLogin.prototype._resetOptions=function(){this.options={bufferInterval:25,bufferWaitLimit:500,events:{}}},jqAutoLogin.prototype._setRefreshingFlag=function(e){this.refreshing=e},jqAutoLogin.prototype._setupInterceptor=function(){var e=this;$.ajaxPrefilter((function(t,i,r){if(!0!==t.refreshRetry){var a=$.Deferred();return e.currentRequests.push(t.url),r.always((function(){e.currentRequests.splice($.inArray(t.url,e.currentRequests),1)})),r.done(a.resolve),r.fail((function(){var i=Array.prototype.slice.call(arguments);e.intercept&&401===r.status&&e._hasEvent("sessionExpiration")?(e._addToBuffer(t,a),e.refreshing||(e._setRefreshingFlag(!0),e._fireEvent("sessionExpiration").done((function(){var t=0;e.interval=setInterval((function(){t+=e.options.bufferInterval,(0===e.currentRequests.length||t>=e.options.bufferWaitLimit)&&(clearInterval(e.interval),e._fireBuffer())}),e.options.bufferInterval)})).fail((function(){e.logout()})))):a.rejectWith(r,i)})),a.promise(r)}}))};var jqAutoLogin=function(e){this.options={},this.user={},this.intercept=!1,this.refreshing=!1,this.buffer=[],this.currentRequests=[],this._resetOptions(),this._setupInterceptor(),$.extend(this.options,e),this._resetData()};function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}if(jqAutoLogin.prototype.logout=function(){this._resetData(),this._deactivateInterceptor(),this._fireEvent("logout")},jqAutoLogin.prototype.login=function(e){this.setUserData(e),this._activateInterceptor(),this._fireEvent("login")},jqAutoLogin.prototype.setUserData=function(e){this.user={user:e.user||null,password:e.password||null,domain:e.domain||null}},jqAutoLogin.prototype._activateInterceptor=function(){this.intercept=!0},jqAutoLogin.prototype._addToBuffer=function(e,t){this.buffer.push({deferred:t,settings:e})},jqAutoLogin.prototype._clearBuffer=function(){this.buffer=[]},jqAutoLogin.prototype._deactivateInterceptor=function(){this.intercept=!1},jqAutoLogin.prototype._fireBuffer=function(){var e,t=this,i=[];for(var r in this.buffer)e=this.buffer[r].deferred,this.buffer[r].settings.refreshRetry=!0,i.push($.ajax(this.buffer[r].settings).then(e.resolve,e.reject));this._clearBuffer(),$.when.apply($,i).done((function(){t._setRefreshingFlag(!1)})).fail((function(){t._setRefreshingFlag(!1),t.logout()}))},jqAutoLogin.prototype._fireEvent=function(e){if(this._hasEvent(e))return this.options.events[e]()},jqAutoLogin.prototype._hasEvent=function(e){return void 0!==this.options.events[e]&&"function"==typeof this.options.events[e]},jqAutoLogin.prototype._resetData=function(){this.user={user:null,password:null,domain:null}},jqAutoLogin.prototype._resetOptions=function(){this.options={bufferInterval:25,bufferWaitLimit:500,events:{}}},jqAutoLogin.prototype._setRefreshingFlag=function(e){this.refreshing=e},jqAutoLogin.prototype._setupInterceptor=function(){var e=this;$.ajaxPrefilter((function(t,i,r){if(!0!==t.refreshRetry){var a=$.Deferred();return e.currentRequests.push(t.url),r.always((function(){e.currentRequests.splice($.inArray(t.url,e.currentRequests),1)})),r.done(a.resolve),r.fail((function(){var i=Array.prototype.slice.call(arguments),n="OLD_SUPPORT";try{var o=JSON.parse(r.responseText);n=o.code}catch(e){}e.intercept&&(401===r.status||"AUTHENTICATION_ERROR"===n)&&e._hasEvent("sessionExpiration")?(e._addToBuffer(t,a),e.refreshing||(e._setRefreshingFlag(!0),e._fireEvent("sessionExpiration").done((function(){var t=0;e.interval=setInterval((function(){t+=e.options.bufferInterval,(0===e.currentRequests.length||t>=e.options.bufferWaitLimit)&&(clearInterval(e.interval),e._fireBuffer())}),e.options.bufferInterval)})).fail((function(){e.logout()})))):a.rejectWith(r,i)})),a.promise(r)}}))},bizagi.workportal=void 0!==bizagi.workportal?bizagi.workportal:{},bizagi.workportal.services=void 0!==bizagi.workportal.services?bizagi.workportal.services:{},bizagi.workportal.services.endPoints=[],bizagi.workportal.services.getEndPoints=function(e){if("workportal"==e.context){var t,i=(t={"user-handler":e.proxyPrefix+"RestServices/UserHandler.ashx","process-handler":e.proxyPrefix+"RestServices/ProcessHandler.ashx","query-handler":e.proxyPrefix+"Rest/Handlers/Query","case-handler":e.proxyPrefix+"RestServices/CaseHandler.ashx","query-form":e.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-edit":e.proxyPrefix+"App/ListaDetalle/SaveQuery.aspx","query-form-delete":e.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-delete-cube":e.proxyPrefix+"Rest/Queries/Cubes/{idCube}","favorites-handler":e.proxyPrefix+"RestServices/FavoritesHandler.ashx","file-handler":e.proxyPrefix+"RestServices/EntityHandler.ashx","login-handler":e.proxyPrefix+"Rest/Users/UserAuthentication","login-handlerv10":e.proxyPrefix+"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}","logoff-handler":e.proxyPrefix+"RestServices/UserHandler.ashx?action=logOff","logoff-handlerv1":e.proxyPrefix+"Rest/Users/LogOff","authorization-handler-getMenuAuthorization":e.proxyPrefix+"Rest/Authorization/MenuAuthorization","authorization-handler-isCaseCreationAuthorized":e.proxyPrefix+"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized","case-handler-getCaseSummary":e.proxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-releaseActivity":e.proxyPrefix+"Rest/Cases/{idCase}/ReleaseActivity","case-handler-getCasesList":e.proxyPrefix+"Rest/Processes/SearchCases","case-handler-getActivityList":e.proxyPrefix+"Api/Cases/Activities","offline-getProcessTree":e.proxyPrefix+"Rest/Processes/OfflineProcessTree","offline-tasks":e.proxyPrefix+"Api/Cases/GetOfflineTasks","offline-getForms":e.proxyPrefix+"Rest/RenderForm/offlineForms","offline-sendForm":e.proxyPrefix+"Rest/Cases/SaveAsynchWorkItemOffLine","case-handler-getCaseTasks":e.proxyPrefix+"Rest/Cases/{idCase}/Tasks","case-handler-getCaseEvents":e.proxyPrefix+"Rest/Cases/{idCase}/Events","case-handler-getCaseSubprocesses":e.proxyPrefix+"Rest/Cases/{idCase}/Subprocesses","case-handler-getTaskAssignees":e.proxyPrefix+"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees","case-handler-getCaseAssignees":e.proxyPrefix+"Rest/Cases/{idCase}/Assignees","case-handler-getWorkItems":e.proxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getAsynchExecutionState":e.proxyPrefix+"Rest/Cases/{idCase}/AsynchExecutionState","case-handler-addNewCase":e.proxyPrefix+"Rest/Cases","case-handler-startProcess":e.proxyPrefix+"Rest/Processes/StartProcess/{idProcess}","handler-execute-action-start":e.proxyPrefix+"Api/Cases/{processId}/Start","case-handler-supportedLogTypes":e.proxyPrefix+"Rest/Cases/SupportedLogsTypes","case-handler-getActivityLog":e.proxyPrefix+"Rest/Cases/{idCase}/ActivityLog","case-handler-getActivityDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog","case-handler-getEntityLog":e.proxyPrefix+"Rest/Cases/{idCase}/EntityLog","case-handler-getEntityDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/EntityDetailLog","case-handler-getUserLog":e.proxyPrefix+"Rest/Cases/{idCase}/UserLog","case-handler-getUserDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/{idUser}/UserDetailLog","case-handler-getAdminLog":e.proxyPrefix+"Rest/Cases/{idCase}/AdminLog","case-handler-getCaseFormsRenderVersion":e.proxyPrefix+"Rest/Cases/{idCase}/FormsRenderVersion","case-handler-validateHasStartForm":e.proxyPrefix+"Api/Processes/{processId}/StartContext","favorites-handler-saveFavorite":e.proxyPrefix+"Rest/Favorites","favorites-handler-deleteFavorite":e.proxyPrefix+"Rest/Favorites/{guidFavorite}","process-getIcon":e.proxyPrefix+"Api/Processes/{processId}/Icon","collections-getIcon":e.proxyPrefix+"Api/CurrentUser/Collections/{collectionId}/Icon","bamAnalytics-handler-getAnalisysQueries":e.proxyPrefix+"Rest/BAMAnalytics/AnalisysQueries","bamAnalytics-handler-updateQuery":e.proxyPrefix+"Rest/BAMAnalytics/Reports/Ids/{idQuery}","inbox-handler-getInboxSummary":e.proxyPrefix+"Rest/Inbox/Summary","inbox-handler-getFullInboxSummary":e.proxyPrefix+"Rest/Inbox/FullSummary","MessageHandler-NewComment":e.proxyPrefix+"Rest/Cases/Comments","MessageHandler-GetComments":e.proxyPrefix+"Rest/Cases/Comments","MessageHandler-SetCategoryToComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-RemoveComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-ReplyComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies","MessageHandler-RemoveReply":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies/{idReply}","MessageHandler-GetCategoryColors":e.proxyPrefix+"Rest/Cases/Comments/CategoryColors","MessageHandler-RenameCategoryColor":e.proxyPrefix+"Rest/Cases/Comments/CategoryColors/{idColorCategory}","MessageHandler-CountNewComments":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/NewComments/Count","process-handler-getAllProcesses":e.proxyPrefix+"Rest/Processes","process-handler-getFavourites":e.proxyPrefix+"Rest/Home/MyFavorites/Count","process-handler-getFavouriteCases":e.proxyPrefix+"Rest/Home/MyFavorites","process-handler-getCustomizedColumnsData":e.proxyPrefix+"Rest/Processes/CustomizedColumnsData","process-handler-getCategory":e.proxyPrefix+"Rest/Processes/Categories","process-handler-getRecentProcesses":e.proxyPrefix+"Rest/Processes/RecentProcesses","process-handler-getCustomizedColumnsDataInfo":e.proxyPrefix+"Rest/Processes/CustomizedColumnsDataInfo","process-handler-getOrganizations":e.proxyPrefix+"Rest/Profile/Organizations","process-handler-getOrganizationsByUser":e.proxyPrefix+"Rest/Profile/OrganizationsByUser","smartinbox-entity-values":e.proxyPrefix+"api/SmartInbox/Detail/EntityValues/{entityGuid}","smartinbox-getAllInbox":e.proxyPrefix+"api/SmartInbox/All","smartinbox-user-tasks":e.proxyPrefix+"api/SmartInbox/Detail/UserTasks/{smartInboxId}","smartinbox-user-tasks-process":e.proxyPrefix+"api/SmartInbox/Detail/UserTasks/ByProcess/{workflowId}","process-handler-getMyStuff":e.proxyPrefix+"Api/CurrentUser/Collections","process-handler-getIdCasesOfProcessEntities":e.proxyPrefix+"Api/Entities/Cases","templates-handler-getCollectionData":e.proxyPrefix+"Api/Collection/{idFact}/Data","data-navigation-handler-collection":e.proxyPrefix+"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}","data-navigation-handler-entity":e.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}","data-navigation-handler-entity-filters":e.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}","action-handler-getProcessAddAction":e.proxyPrefix+"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions","my-search-getSearchLists":e.proxyPrefix+"Api/CurrentUser/Searches","my-search-getFilters":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Filters","my-search-getFiltersData":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/FilterData","my-search-getData":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Data","templates-handler-getVirtualCollectionData":e.proxyPrefix+"Api/Collection/{guidVirtualCollection}/VirtualData","templates-handler-getMultipleActions":e.proxyPrefix+"Rest/Entities/multipleInstancesActions","process-handler-getMapping":e.proxyPrefix+"Rest/Entities/Mapping","process-handler-getForm":e.proxyPrefix+"Rest/Handlers/Render","process-handler-startform":e.proxyPrefix+"Rest/Processes/HasStartForm","process-handler-rule":e.proxyPrefix+"Api/Rules/{ruleId}/Execute","process-action-execute":e.proxyPrefix+"Api/Rules/{ruleId}/ExecuteMultiple","process-handler-getActivitiesData":e.proxyPrefix+"Api/Processes/CasesData/MyActivities","process-handler-getPendingsData":e.proxyPrefix+"Api/Processes/CasesData/MyPendings","entities-handler-getActions":e.proxyPrefix+"Api/Entities/{guidEntity}/{surrogateKey}/actions","entities-handler-getUsersAndEvents":e.proxyPrefix+"Rest/Processes/CasesData/UsersAndEvents","entities-handler-getUsers":e.proxyPrefix+"Api/Cases/{caseId}/Users","entities-handler-getEvents":e.proxyPrefix+"Api/Cases/{caseId}/CurrentEvents","entities-handler-getUsersImages":e.proxyPrefix+"Rest/Users/UserPictures","entities-handler-getShotCuts":e.proxyPrefix+"Api/CurrentUser/Shortcuts","query-handler-getqueries":e.proxyPrefix+"Rest/Queries","query-handler-getQueryForm":e.proxyPrefix+"Rest/Handlers/Render","user-handler-getCurrentUser":e.proxyPrefix+"Rest/Users/CurrentUser","old-render":e.proxyPrefix+"App/ListaDetalle/Detalle.aspx",Reports:e.proxyPrefix+"RestServices/BAMAnalyticsHandler.ashx","reports-handler-deleteQueries":e.proxyPrefix+"Rest/BAMAnalytics/Reports/{QueryId}","folders-handler-getUserQueries":e.proxyPrefix+"Rest/SmartFolders","folders-associate-deleteSmartFolder":e.proxyPrefix+"Rest/SmartFolders/{idSmartFolder}","folders-handler":e.proxyPrefix+"RestServices/SmartFoldersHandler.ashx","folders-associate":e.proxyPrefix+"App/Ajax/AJAXGateway.aspx","smartfolders-integration":e.proxyPrefix+"App/WorkPortal/ConfigureFilteredFolder.aspx",AlarmAdmin:e.proxyPrefix+"App/Admin/AlarmsAdmin.aspx",AnalyticsProcess:e.proxyPrefix+"App/Cockpit/AnalyticsProcess.aspx",AnalyticsSensor:e.proxyPrefix+"App/Cockpit/AnalyticsSensor.aspx",AnalyticsTask:e.proxyPrefix+"App/Cockpit/AnalyticsTask.aspx",AsynchronousWorkitemRetries:e.proxyPrefix+"App/Admin/AsynchDisabledWorkitems.aspx",AuthenticationLogQuery:e.proxyPrefix+"App/Admin/AuthLogQuery.aspx",BAMProcess:e.proxyPrefix+"App/Cockpit/BAMProcess.aspx",BAMTask:e.proxyPrefix+"App/Cockpit/BAMTask.aspx",BusinessPolicies:e.proxyPrefix+"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx",CaseAdmin:e.proxyPrefix+"App/Admin/CaseSearch.aspx",adminReassignCases:"CaseAdmin",asyncECMUpload:"asyncECMUpload",CasesMonitor:e.proxyPrefix+"App/Admin/CasesMonitor.aspx",Closed:e.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed",CurrentUser:e.proxyPrefix+"App/Admin/CurrentUser.aspx",EncryptionAdmin:e.proxyPrefix+"App/Admin/Encrypt.aspx",MobileUpdatesAdmin:e.proxyPrefix+"App/MobileUpdates/default.aspx",EntityAdmin:e.proxyPrefix+"App/Admin/Entity.aspx",LocationResources:e.proxyPrefix+"App/Admin/AdminLocResources.aspx",NewCase:e.proxyPrefix+"App/Radicar/application.aspx",Pending:e.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running",Profiles:e.proxyPrefix+"App/Admin/ProfilesAdminSearch.aspx",Search:e.proxyPrefix+"App/ListaDetalle/Search.aspx",UserAdmin:e.proxyPrefix+"App/Admin/ListUsers.aspx",UserDefaultAssignation:e.proxyPrefix+"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1",UserPendingRequests:e.proxyPrefix+"App/Admin/UserPendingRequests.aspx",ListPreferences:""!==bizagi.UserPreferencesUrl?e.proxyPrefix+bizagi.UserPreferencesUrl:e.proxyPrefix+"App/Admin/CurrentUser.aspx",GRDimensionAdmin:e.proxyPrefix+"App/Cockpit/DimensionEdit.aspx",Licenses:e.proxyPrefix+"App/Admin/Licenses.aspx",AnalysisQueries:e.proxyPrefix+"App/Inicio/WPAnalysisQuery.aspx",DocumentTemplates:e.proxyPrefix+"App/Admin/AdminDocumentTemplates.aspx",ProcessAdmin:e.proxyPrefix+"App/Admin/AdminProcess.aspx",ResourceBAM:e.proxyPrefix+"App/Cockpit/BAMResourceMonitor.aspx",WorkPortalVersion:e.proxyPrefix+"Rest/Util/Version","entities-administration":"RestServices/EntityHandler.ashx","theme-handler-getLogoImagePath":e.proxyPrefix+"Rest/Theme/LogoImage",logout:e.proxyPrefix+"Rest/Authentication/logout",logoutDotNet:e.proxyPrefix+"App/Inicio/LogOff.aspx",authenticationConfig:e.proxyPrefix+"Api/Authentication/BizagiConfig","logout-oauth2":e.proxyPrefix+"Api/Authentication/OAuth2/IdentityProvider/Server/Logout",FederateLogoffUrl:e.proxyPrefix+"Api/Authentication/FederateLogoffUrl",oauth2AuthenticationConfig:e.proxyPrefix+"Api/Authentication/OAuth2/OAuth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo":e.proxyPrefix+"Rest/Users/OrganizationInfo","massive-activity-assignments-getCasesByOrganization":e.proxyPrefix+"Rest/Queries/GetCasesByOrganization","massive-activity-assignments-reassignCases":e.proxyPrefix+"Rest/Cases/ReassignCases","massive-activity-assignments-searchUsers":e.proxyPrefix+"Rest/Users/","async-ecm-upload-baseService":e.proxyPrefix+"Rest/Handlers/Metadata",domains:e.proxyPrefix+"Rest/Authentication/Domains",getCurrentTheme:e.proxyPrefix+"Api/Theme/Current","admin-getAuthenticationLog":e.proxyPrefix+"Rest/Users/AuthLog","admin-getAuthenticationDomains":e.proxyPrefix+"Rest/Users/Domains","admin-getAuthenticationEventsTypes":e.proxyPrefix+"Rest/Users/EventTypes","admin-getAuthenticationEventSubTypes":e.proxyPrefix+"Rest/Users/EventSubTypes","admin-EncryptString":e.proxyPrefix+"Rest/Util/EncryptString","admin-UserPendingRequests":e.proxyPrefix+"Rest/Users/UserPendingRequests","admin-UserAuthenticationInfo":e.proxyPrefix+"Rest/Users/UserAuthenticationInfo","admin-updateUserAuthenticationInfo":e.proxyPrefix+"Rest/Users/UpdateUserAuthenticationInfo","admin-generateRandomPassword":e.proxyPrefix+"Rest/Util/GenerateRandomPassword","admin-GenerateDataToSendByEmail":e.proxyPrefix+"Rest/Users/GenerateDataToSendByEmail","admin-sendEmail":e.proxyPrefix+"Rest/Util/SendEmail/","admin-getApplicationList":e.proxyPrefix+"Rest/Application","admin-getApplicationProcesses":e.proxyPrefix+"Rest/Application/{idApp}/Process","admin-getProcessVersion":e.proxyPrefix+"Rest/Processes/Version","admin-getProcessTasks":e.proxyPrefix+"Rest/Processes/Version/{version}/Tasks","admin-getTaskAlarms":e.proxyPrefix+"Rest/Alarm/TaskAlarms","admin-getLapseMode":e.proxyPrefix+"Rest/Alarm/LapseMode","admin-getRecurrMode":e.proxyPrefix+"Rest/Alarm/RecurrMode","admin-getScheduleType":e.proxyPrefix+"Rest/Alarm/ScheduleType","admin-getBossList":e.proxyPrefix+"Rest/Alarm/Boss","admin-addAlarm":e.proxyPrefix+"Rest/Alarm","admin-editAlarm":e.proxyPrefix+"Rest/Alarm/{idAlarm}","admin-deleteAlarm":e.proxyPrefix+"Rest/Alarm","admin-alarmRecipients":e.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient","admin-deleteAlarmRecipients":e.proxyPrefix+"Rest/Alarm/Recipient","admin-recipientToAlarm":e.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}","admin-enableAlarm":e.proxyPrefix+"Rest/Alarm/Task/{idTask}/ToggleAlarm","admin-getCategoriesList":e.proxyPrefix+"Rest/Application/Category","admin-getCasesList":e.proxyPrefix+"Rest/Queries/SearchCases","admin-abortItems":e.proxyPrefix+"Rest/Cases/Abort","admin-reassignItems":e.proxyPrefix+"Rest/Cases/Reassign","admin-getDefaultAssignationUserToAllProcess":e.proxyPrefix+"Rest/Users/{serviceAction}/","admin-getDefaultAssignationUserToProcess":e.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-setDefaultAssignationUserToProcess":e.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-getProfilesTypes":e.proxyPrefix+"Rest/Profile/Types","admin-searchProfiles":e.proxyPrefix+"Rest/Profile","admin-getUsersByProfile":e.proxyPrefix+"Rest/Users/Profile/{type}/{id}","admin-removeUserFromProfile":e.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-addUserToProfile":e.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-async-activities-get-activities":e.proxyPrefix+"Rest/Cases/Asynchronous/Activities","admin-async-activities-get-retry-now":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow","admin-async-activities-get-activities-by-task":e.proxyPrefix+"Rest/Cases/Asynchronous/Activities/Task","admin-async-activities-enable-execution":e.proxyPrefix+"Rest/Cases/Asynchronous/Enable","admin-async-activities-enable-multiple":e.proxyPrefix+"Rest/Cases/Asynchronous/EnableMultiple","admin-async-activities-async-execution":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution","admin-async-activities-async-execution-log":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog","admin-Licenses":e.proxyPrefix+"Rest/Licenses","admin-GetDimensions":e.proxyPrefix+"Rest/Dimensions","admin-EditDimension":e.proxyPrefix+"Rest/Dimensions/{id}","admin-CreateAdministrableDimension":e.proxyPrefix+"Rest/Dimensions/Administrable","admin-DeleteDimension":e.proxyPrefix+"Rest/Dimensions/{id}?isAdministrable={administrable}","admin-EntityPathChildNodesAction":e.proxyPrefix+"Rest/Dimensions/EntityChildNodes","admin-GetActiveWFClasses":e.proxyPrefix+"Rest/Dimensions/ActiveProcess","admin-document-templates-storeDocumentTemplates":e.proxyPrefix+"Rest/DocumentTemplates/StoreDocumentTemplates","admin-document-templates-restoreDocumentTemplates":e.proxyPrefix+"Rest/DocumentTemplates/RestoreDocumentTemplate","admin-document-templates-uploadDocumentTemplate":e.proxyPrefix+"Rest/DocumentTemplates/UploadDocumentTemplate","admin-processes-workflowClasses":e.proxyPrefix+"Rest/Processes/WorkflowClasses","admin-processes-tasksByWorkflow":e.proxyPrefix+"Rest/Processes/TasksByWorkflow","admin-processes-modifyProcessDuration":e.proxyPrefix+"Rest/Processes/{idWorkflow}/Duration/","admin-processes-modifyTaskDuration":e.proxyPrefix+"Rest/Processes/Task/{idTask}/Duration/","admin-language-resource":e.proxyPrefix+"Rest/Multilanguage/Resource","admin-language-languages":e.proxyPrefix+"Rest/Multilanguage/Languages","bam-resourcemonitor-myteam":e.proxyPrefix+"Rest/Reports/BAM/Resources/MyTeam","reports-analysisquery":e.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-update":e.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-delete":e.proxyPrefix+"Rest/Reports/AnalysisQueries","processviewer-processdefinition":e.proxyPrefix+"Rest/Reports/Components/ProcessDefinition","processviewer-processgraphicinfo":e.proxyPrefix+"Rest/Reports/Components/ProcessGraphicInfo","mobile-getLastUpdate":e.proxyPrefix+"Rest/Util/mobileUpdates","discussion-case":e.proxyPrefix+"Api/CaseResource/Discussion?globalParent={globalParent}","discussion-case-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/Discussion","get-users":e.proxyPrefix+"Rest/Users/UserPictures","new-discussion":e.proxyPrefix+"Api/CaseResource/Discussion","count-comments":e.proxyPrefix+"Api/CaseResource/{idParent}/Comment/Count","comment-case":e.proxyPrefix+"Api/CaseResource/{idParent}/Comment","new-comment":e.proxyPrefix+"Api/CaseResource/Comment","new-comment-attach":e.proxyPrefix+"Api/CaseResource/Attachment","get-list-files":e.proxyPrefix+"Api/CaseResource/File?globalParent={globalParent}","get-list-files-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/File","project-resource-action":e.proxyPrefix+"Api/CaseResource/{typeResource}","thumbnail-file":e.proxyPrefix+"Api/CaseResource/File/Thumbnails?globalParent={globalParent}","get-attachment":e.proxyPrefix+"Api/CaseResource/Attachment/{idAttachment}","get-mobile-attachment":e.proxyPrefix+"Api/CaseResource/Mobile/Attachment/{idAttachment}","project-files-upload":e.proxyPrefix+"Api/CaseResource/File","count-files":e.proxyPrefix+"Api/CaseResource/File/Count?globalParent={globalParent}","count-files-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/File/Count","remove-comment":e.proxyPrefix+"Api/CaseResource/Comment","time-schemas-effectiveduration":e.proxyPrefix+"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}"},_defineProperty(t,"case-handler-getCaseAssignees",e.proxyPrefix+"Rest/Cases/{idCase}/Assignees"),_defineProperty(t,"project-users-get",e.proxyPrefix+"Rest/Users/UserPictures"),_defineProperty(t,"case-summary-task-options",e.proxyPrefix+"Rest/Cases/WorkItems/{idWorkitem}/TaskOptions?idCase={idCase}"),_defineProperty(t,"project-plan-get",e.proxyPrefix+"Api/Plans/{idPlan}"),_defineProperty(t,"project-plan-activities",e.proxyPrefix+"Api/Plans/{idPlan}/Activities"),_defineProperty(t,"project-plan-workitems",e.proxyPrefix+"Api/Plans/{idPlan}/WorkItems"),_defineProperty(t,"project-plan-transitions-get",e.proxyPrefix+"Api/Plans/{idPlan}/Activities/Transitions"),_defineProperty(t,"project-plan-activity-edit",e.proxyPrefix+"Api/Plans/{idPlan}/Activities/{id}"),_defineProperty(t,"project-plan-get-by-parent",e.proxyPrefix+"Api/Plans?parentWorkItem={parentWorkItem}"),_defineProperty(t,"project-plan-parent",e.proxyPrefix+"Api/Plans/{idPlan}/ParentCase"),_defineProperty(t,"project-plan-update",e.proxyPrefix+"Api/Plans/{idPlan}"),_defineProperty(t,"project-plan-execute",e.proxyPrefix+"Api/Plans/Execute"),_defineProperty(t,"project-plan-close",e.proxyPrefix+"Api/Plans/Close"),_defineProperty(t,"project-plan-delete",e.proxyPrefix+"Api/Plans/{idPlan}"),_defineProperty(t,"project-plan-first-parent-plan",e.proxyPrefix+"Api/Plans/{idPlan}/FirstParentPlan"),_defineProperty(t,"PreferencesWorkportalCurrentUser",e.proxyPrefix+"Api/Users/Data/WindowPreferences"),_defineProperty(t,"diagnostics-sync-system-error",e.proxyPrefix+"api/ErrorLogs/Import"),t);return bizagi.util.getFeatureObject("userService.v1.enabled")&&(i["user-handler-getCurrentUser"]=e.proxyPrefix+"Rest/Users/CurrentUserGuid",i["get-users"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",i["entities-handler-getUsersImages"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",i["project-users-get"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",i["entities-handler-getUsers"]=e.proxyPrefix+"Api/Cases/{caseId}/UsersGuid",i["case-handler-getCaseSummary"]=e.proxyPrefix+"Rest/Cases/{idCase}/SummaryGuid",i["case-handler-getCaseAssignees"]=e.proxyPrefix+"Rest/Cases/{idCase}/AssigneesGuid",i["discussion-case"]=e.proxyPrefix+"Api/CaseResource/DiscussionGuid?globalParent={globalParent}",i["new-discussion"]=e.proxyPrefix+"Api/CaseResource/DiscussionGuid",i["comment-case"]=e.proxyPrefix+"Api/CaseResource/{idParent}/CommentGuid",i["new-comment"]=e.proxyPrefix+"Api/CaseResource/CommentGuid",i["project-files-upload"]=e.proxyPrefix+"Api/CaseResource/FileGuid",i["get-list-files"]=e.proxyPrefix+"Api/CaseResource/FileGuid?globalParent={globalParent}",i["time-schemas-effectiveduration"]=e.proxyPrefix+"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}",i["project-plan-get"]=e.proxyPrefix+"Api/Plans/Guid/{idPlan}",i["project-plan-update"]=e.proxyPrefix+"Api/Plans/Guid/{idPlan}",i["project-plan-activities"]=e.proxyPrefix+"Api/Plans/{idPlan}/ActivitiesGuid",i["project-plan-workitems"]=e.proxyPrefix+"Api/Plans/{idPlan}/WorkItemsGuid",i["project-plan-first-parent-plan"]=e.proxyPrefix+"Api/Plans/{idPlan}/FirstParentPlanGuid",i["project-plan-activity-edit"]=e.proxyPrefix+"Api/Plans/{idPlan}/ActivitiesGuid/{id}"),i}return{}},$.Class.extend("bizagi.workportal.services.context",{},{init:function(e){this.context=e.context,this.endPoints=bizagi.workportal.services.getEndPoints(e),this.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix},getUrl:function(e){return void 0===this.endPoints[e]&&bizagi.log("Url not found","No endpoint defined for: "+e),this.endPoints[e]},setProxyPrefix:function(e){this.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix,this.endPoints=bizagi.workportal.services.getEndPoints(e)}}),$.Class.extend("bizagi.workportal.services.service",{BA_CONTEXT_PARAMETER_PREFIX:"h_",ENTITIES_QUERY_PAGE_SIZE:10},{init:function(e){(e="object"==_typeof(e)?e:{}).context=bizagi.util.isEmpty(e.context)?"workportal":e.context,e.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix,e.proxyPrefix=this.normalizeUrl(e.proxyPrefix),bizagi.RPproxyPrefix=e.proxyPrefix,e.sharepointProxyPrefix=bizagi.util.isEmpty(e.sharepointProxyPrefix)?"":e.sharepointProxyPrefix,e.sharepointProxyPrefix=this.normalizeUrl(e.sharepointProxyPrefix),this.serviceLocator=new bizagi.workportal.services.context(e),this.pageSize=10,this.deviceType=e.deviceType||(bizagi.util.isSmartphoneDevice()?bizagi.deviceEnum.smartphone:bizagi.util.isTabletDevice()?bizagi.deviceEnum.tablet:bizagi.deviceEnum.desktop),this.deviceCode=bizagi.util.getDeviceCode(),"undefined"!=typeof BIZAGI_INBOX_ROWS_PER_PAGE&&(this.pageSize=$.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE)?BIZAGI_INBOX_ROWS_PER_PAGE:this.pageSize),this.activeForm=void 0,this.configureGlobalHandlers()},getUrl:function(e){return this.serviceLocator.getUrl(e.endPoint)},normalizeUrl:function(e){return""!==e&&("/"!=e[e.length-1]&&(e=e.concat("/")),-1==e.indexOf("http://")&&-1==e.indexOf("https://")&&(e="http://"+e)),e},getOverrides:function(){return $.ajax({url:this.serviceLocator.getUrl("overrides")}).pipe((function(e){return e=e||{},$.each(e,(function(t,i){var r=i.toUpperCase();"TRUE"!=r&&"FALSE"!=r||(e[t]=bizagi.util.parseBoolean(i))})),e}))},getCurrentTheme:function(){var e=this.serviceLocator.getUrl("getCurrentTheme");return $.read(e)},authenticatedUser:function(e){var t=this,i=t.serviceLocator.getUrl("login-handler");return $.read({url:i,data:{userName:BIZAGI_USER,password:BIZAGI_PASSWORD,domain:BIZAGI_DOMAIN}}).pipe((function(e){return e}),(function(e){return i=(i=(i=(i=t.serviceLocator.getUrl("login-handlerv10")).replace("{0}",BIZAGI_USER||"")).replace("{1}",BIZAGI_PASSWORD||"")).replace("{2}",BIZAGI_DOMAIN||""),$.ajax({url:i,type:"GET",dataType:"json"})}))},logoutUser:function(e){var t=this.serviceLocator.getUrl("logoff-handlerv1");return $.read({url:t})},logOffUser:function(e){var t=this.serviceLocator.getUrl("logoff-handler");return $.read({url:t})},getCurrentUser:function(e){return $.read(this.serviceLocator.getUrl("user-handler-getCurrentUser"))},getInboxSummary:function(e){return $.read(this.serviceLocator.getUrl("inbox-handler-getInboxSummary")).pipe((function(e){return e.inboxSummary}))},getAllProcesses:function(e){var t=this;e=e||{};var i={},r=t.serviceLocator.getUrl("process-handler-getAllProcesses");return null!=e.taskState&&(i.taskState=e.taskState),null!=e.onlyFavorites&&""!=e.onlyFavorites&&(i.onlyFavorites=e.onlyFavorites),null!=e.myActivities&&""!=e.myActivities&&(i.myActivities=e.myActivities),null!=e.myPendings&&""!=e.myPendings&&(i.myPendings=e.myPendings),e.smartfoldersParameters&&(r=r+"?"+e.smartfoldersParameters),bizagi.isMobile()&&(i.mobileDevice=!0),$.read(r,i).pipe((function(i){if(e.skipAggrupate)return t.includeAllProcessesItem(i),i;var r={},a={},n=bizagi.localization.getResource("workportal-widget-inbox-all-processes"),o={name:bizagi.localization.getResource("workportal-widget-inbox-all-cases"),path:"",category:n,isFavorite:e.onlyFavorites||!1,guidFavorite:"",idworkflow:"",guidWFClass:"",count:0};for(key in a[n]=[],a[n].workflows=[],a[n].workflows.push(o),i.workflows&&$.each(i.workflows.workflow,(function(e,t){a[t.category]||(a[t.category]=[],a[t.category].workflows=[]),a[t.category].workflows.push(t),o.count+=Number(t.count)})),r.categories=[],a)r.categories.push({name:key,workflows:a[key].workflows});return r}))},getUserWorkportalPreferences:function(){var e=this,t=new $.Deferred;return void 0!==e._userPreferences?t.resolve(e._userPreferences):e.getPreferencesWorkportalCurrentUser().done((function(i){e._userPreferences=bizagi.util.tryCatch((function(){return i.workportal}),{}),bizagi.util.storeMobileFeatures({userPreferences:e._userPreferences}),t.resolve(e._userPreferences)})).fail((function(e){console.error(e),t.resolve({})})),t},getUserPreferences:function(e){var t=bizagi.util.getMobileFeatures(),i=t||{},r=i.userPreferences?i.userPreferences:{},a=this._userPreferences||r;return void 0===e?a:a[e]},getLastProcessInboxWorkflow:function(){var e=new $.Deferred,t=bizagi.util.getLastProcessInboxProcessInfo();return 0==bizagi.util.validateFeatureSupport("defaultInboxEnabled")||0==bizagi.util.isMobileInboxByProcessSupported()?(-1!=t.idWorkflow&&bizagi.util.setLastProcessInbox(t.processInfoName,t.idWorkflow),e.resolve(t)):$.when(this.getUserWorkportalPreferences(),this.getAllProcesses({taskState:"all",onlyFavorites:!1,inputtray:"inbox",skipAggrupate:!0,mobileDevice:!0}),this.getAllSmartInbox()).then((function(i,r,a){var n=t.idWorkflow,o=t.smartInboxId,s=parseInt(i.defaultOpenInboxWorkflowId),l=i.defaultOpenInboxSmartInboxId,c=s>0,u=!bizagi.util.isEmpty(l);if(-1==n&&c&&bizagi.util.isEmpty(o)?(n=s,o=null):bizagi.util.isEmpty(o)&&u&&-1==n&&(o=l,n=-1),r&&r.workflows&&-1!=n){var d=$.first(r.workflows.workflow,(function(e){return e.idworkflow==n}));d?bizagi.util.setLastProcessInbox(d.name,n):bizagi.util.setLastProcessInbox(null,-1)}else if(a&&a.length>0&&!bizagi.util.isEmpty(o)){var g=$.first(a,(function(e){return e.id==o}));g?bizagi.util.setLastProcessInbox(g.name,-1,o):bizagi.util.setLastProcessInbox(null,-1)}e.resolve(bizagi.util.getLastProcessInboxProcessInfo())})).fail((function(){e.reject("Error in bizagi.workportal.services.service.getLastProcessInboxWorkflow")})),e.promise()},getFavourites:function(){var e=this.serviceLocator.getUrl("process-handler-getFavourites");return $.read(e,{}).pipe((function(e){return e}))},getMyStuff:function(e){var t={},i=this.serviceLocator.getUrl("process-handler-getMyStuff");return void 0!==e.icon&&e.icon&&(t.icon=!0),$.read(i,t)},getFavouriteCases:function(e){var t={},i=this.serviceLocator.getUrl("process-handler-getFavouriteCases");return t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),$.read(i,t).pipe((function(e){return e}))},getCasesList:function(e){var t={},i=this.serviceLocator.getUrl("case-handler-getCasesList");return e=e||{},t.pageSize=e.pageSize||10,t.page=e.page||1,t.numberOfFields=e.numberOfFields||"-1",t.idWfClass=e.idWfClass||"-1",$.read(i,t).pipe((function(e){for(var t={overdue:[],today:[],tomorrow:[],upcoming:[],page:e.page,totalPages:e.totalPages},i=new Date,r=i.getMonth(),a=i.getDate(),n=i.getYear(),o=void 0!==e.elements?e.elements.length:0,s=0;o>s;s++){var l=e.elements[s],c=new Date(l[3]),u=c.getDate(),d=c.getMonth(),g=c.getYear();a>u||r>d||n>g?(l[3]=bizagi.util.dateFormatter.formatDate(new Date(l[3]),"dd MMM yyyy"),t.overdue.push(l)):a==u?(l[3]=bizagi.util.dateFormatter.formatDate(new Date(l[3]),"hh:mm"),t.today.push(l)):a+1==u?(l[3]=bizagi.util.dateFormatter.formatDate(new Date(l[3]),"hh:mm"),t.tomorrow.push(l)):(l[3]=bizagi.util.dateFormatter.formatDate(new Date(l[3]),"dd MMM yyyy"),t.upcoming.push(l))}return t}))},getCasesListBeta:function(e){var t=this;return t.getMobileCasesList(e).then((function(e){return t.adapterDataOfActivitiesToTemplate(e)}))},getMobileCasesList:function(e){var t=this,i={};if(e=e||{},bizagi.util.validateFeatureSupport("advancedSearch"))return $.when(t.getMobileActivities(e)).then((function(e){for(var i,r={elements:[],rows:[]},a=-1;i=e.rows[++a];){for(var n,o={},s=["","","","","","",[],"","","","","",""],l=-1;n=e.headers[++l];)o[n.fieldName.toLowerCase()]={displayName:n.displayName,value:i[l]},t.serializeActivity(s,n.fieldName.toLowerCase(),o[n.fieldName.toLowerCase()]);e.syncErrors&&(t.appendActivityElementSyncError(s,e.syncErrors),t.appendActivityRowsSyncError(o,e.syncErrors)),r.elements.push(s),r.rows.push(o)}return{page:e.page||e.currentPage,totalPages:e.totalPages,elements:r.elements,rows:r.rows,advanceSearch:!0}}));var r=t.serviceLocator.getUrl("case-handler-getCasesList");return void 0!==e.radNumber&&(i.radNumber=e.radNumber),i.pageSize=e.pageSize||10,i.page=e.page||1,i.numberOfFields=e.numberOfFields||"-1",i.idWfClass=e.idWfClass||"-1",$.read(r,i)},adapterDataOfActivitiesToTemplate:function(e){for(var t={elements:[],page:e.page,totalPages:e.totalPages,advanceSearch:e.advanceSearch||!1,headers:e.headers,rows:e.rows},i=new Date,r=e.advanceSearch?this.defineActivityStateByTaskState:this.defineActivityStateByDate,a=0;e.elements.length>a;a++){var n=e.elements[a],o={};if(o=r(n[3],n.taskstate),n.length>=10&&parseInt(n[11],10)>0){var s=new Date(n[3]);i.getTime()>s.getTime()?o.state="red":i.getTime()>s.getTime()-6e4*parseInt(n[11],10)?o.state="yellow":o.state="green"}t.elements.push($.extend({},n,o,{endDate:n[3],idworkitem:n[1],idwfclass:bizagi.util.validateFeatureSupport("advancedSearch")?n[10]:n[7]}))}return t},adapterServerResponseTemplateBindingObject:function(e){for(var t,i={elements:[],rows:[]},r=-1;t=e.rows[++r];){for(var a,n={},o=["","","","","","",[],"","","","","",""],s=-1;a=e.headers[++s];)n[a.fieldName.toLowerCase()]={displayName:a.displayName,value:t[s]},this.serializeActivity(o,a.fieldName.toLowerCase(),n[a.fieldName.toLowerCase()]);e.syncErrors&&(this.appendActivityElementSyncError(o,e.syncErrors),this.appendActivityRowsSyncError(n,e.syncErrors)),i.elements.push(o),i.rows.push(n)}return{page:e.page||e.currentPage,totalPages:e.totalPages,elements:i.elements,rows:i.rows,advanceSearch:!0,headers:e.headers}},defineActivityStateByDate:function(e){var t={};if(e){var i=new Date(e),r=new Date,a=new Date(r.getFullYear(),r.getMonth(),r.getDate());t=i.getTime()<a.getTime()?{group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:"red",type:"overdue",icon:"overdue",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))}:i.getTime()<r.getTime()+6e4?{group:"2|"+bizagi.localization.getResource("workportal-taskfeed-today"),state:"red",type:"today",icon:"overdue",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))}:i.getTime()<a.getTime()+864e5?{group:"2|"+bizagi.localization.getResource("workportal-taskfeed-today"),state:"yellow",type:"today",icon:"ontime",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))}:i.getTime()<a.getTime()+1728e5?{group:"3|"+bizagi.localization.getResource("workportal-taskfeed-tomorrow"),state:"green",type:"tomorrow",icon:"upcoming",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))}:{group:"4|"+bizagi.localization.getResource("workportal-taskfeed-upcomming"),state:"green",type:"upcoming",icon:"upcoming",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))}}else t={group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:"red",type:"overdue",shortEndDate:"--",icon:"overdue"};return t},defineActivityStateByTaskState:function(e,t){var i={group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:t,type:"overdue",shortEndDate:"--",icon:"overdue"};if(e&&t){var r=new Date(e),a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate());switch(i={group:"",state:t,type:"",icon:"",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" | "+bizagi.localization.getResource("timeFormat"))},r.getTime()<n.getTime()?(i.group="1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),i.type="overdue"):r.getTime()<n.getTime()+864e5?(i.group="2|"+bizagi.localization.getResource("workportal-taskfeed-today"),i.type="today"):r.getTime()<n.getTime()+1728e5?(i.group="3|"+bizagi.localization.getResource("workportal-taskfeed-tomorrow"),i.type="tomorrow"):(i.group="4|"+bizagi.localization.getResource("workportal-taskfeed-upcomming"),i.type="upcoming"),t){case"green":i.icon="upcoming";break;case"yellow":i.icon="ontime";break;case"red":default:i.icon="overdue"}}return i},serializeActivity:function(e,t,i){switch(t){case"radnumber":e[6].push([i.displayName,i.value]),e.radNumber=i.value;break;case"wfclsdisplayname":e[4]=null!=i.value?i.value.toString():bizagi.localization.getResource("workportal-project-activity-plan");break;case"currenttask":e[5]=null!=i.value?i.value.toString():bizagi.localization.getResource("workportal-project-casedashboard-activity");break;case"cascreationdate":e[12]=i.value;break;case"wiestimatedsolutiondate":e[3]=i.value;break;case"cassolutiondate":break;case"idcase":e[0]=i.value;break;case"idworkitem":e[1]=i.value.toString();break;case"wientrydate":break;case"taskid":e[2]=i.value;break;case"taskstate":e.taskstate=i.value?(""+i.value).toLowerCase():"";break;case"idwfclass":e[10]=e.idwfclass=i.value;break;case"isfavorite":e[9]=i.value;break;case"atrisktime":e[11]=i.value;break;case"guidfavorite":e[8]=i.value;break;case"isevent":e.isEvent=i.value;break;case"datachangesetversion":e.dataChangeset=i.value;break;case"creatorfullname":e.creatorFullName=i.value}},appendActivityElementSyncError:function(e,t){var i=t[e[0]+"-"+e[1]];i&&(e.syncError=i,e.hasSyncError=!0)},appendActivityRowsSyncError:function(e,t){var i=t[e.idcase.value+"-"+e.idworkitem.value];i&&(e.syncerror={displayName:"syncError",value:i},e.hassyncerror={displayName:"hasSyncError",value:!0})},getCurrentActivities:function(e){var t=this,i={};e=e||{},i.page=e.page||1,i.pageSize=e.pageSize||10,void 0!==e.radNumber&&(i.radNumber=e.radNumber);var r=t.serviceLocator.getUrl("case-handler-getActivityList");return $.read(r,i).then((function(e){return t.processActivitiesResponse(e)}))},processActivitiesResponse:function(e,t,i){var r,a=-1;for(e.elements=[],e.processes=[];r=e.rows[++a];){for(var n,o={},s=-1;n=e.headers[++s];)o["o_"+n.fieldName.toLowerCase()]={displayName:n.displayName,value:r[s]},o[n.fieldName.toLowerCase()]=r[s];$.extend(o,this.defineActivityStateByDate(o.wiestimatedsolutiondate),{highlightedNumber:this.highlightsString(o.radnumber,t)}),e.elements.push(o),void 0===e.processes.find((function(e){return e.processname==o.wfclsdisplayname}))&&e.processes.push({processname:o.wfclsdisplayname,idwfclass:o.idwfclass,active:i?"active":""})}return e},highlightsString:function(e,t){if("string"!=typeof e||"string"!=typeof t)return e;var i=new RegExp(t,"gi");return e.replace(i,(function(e,t){return"<strong>"+e+"</strong>"}))},getDiscussionCase:function(e){var t=t||{};t.globalParent=e.globalParent;var i=bizagi.util.validateFeatureSupport("discussionCase")?this.serviceLocator.getUrl("discussion-case"):this.serviceLocator.getUrl("discussion-case-v1");return $.read({url:i,data:t,contentType:"application/json"}).pipe((function(e){return e}))},editDiscussion:function(e){var t=this.serviceLocator.getUrl("new-discussion");return $.update({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getUsersDiscussion:function(e){var t=t||{};t.userIds=e,t.width=50,t.height=50;var i=this.serviceLocator.getUrl("get-users");return bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:i,data:t,type:"POST",dataType:"json"}):$.read(i,t).pipe((function(e){return e}))},getEffectiveDuration:function(e){var t=this.serviceLocator.getUrl("time-schemas-effectiveduration");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getUsersData:function(e){var t=this.serviceLocator.getUrl("project-users-get");return bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:t,data:e,type:"POST",dataType:"json"}):$.read({url:t,data:e,dataType:"json"})},getSummaryCaseTaskOptions:function(e){var t=this.serviceLocator.getUrl("case-summary-task-options");return e=e||{},$.read(t,{idWorkitem:e.idWorkitem,idCase:e.idCase})},createNewDiscussion:function(e){var t=this.serviceLocator.getUrl("new-discussion");return e=e||{},$.create({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},createNewComment:function(e){var t=(e=e||{}).data||{},i=this.serviceLocator.getUrl("new-comment");return $.create({url:i.replace("{typeResource}","Comment"),data:JSON.stringify(t),dataType:"json",contentType:"application/json"})},updateProjectFile:function(e){var t=this.serviceLocator.getUrl("project-files-upload");return $.update({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},createProjectFile:function(e){var t=this.serviceLocator.getUrl("project-files-upload");return $.create({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getFilesCount:function(e){e=e||{};var t=bizagi.util.validateFeatureSupport("filesCount")?this.serviceLocator.getUrl("count-files"):this.serviceLocator.getUrl("count-files-v1");return $.read({url:t,data:e,contentType:"application/json"}).pipe((function(e){return e}))},getCommentCase:function(e){e=e||{};var t=this.serviceLocator.getUrl("comment-case");return $.read({url:t,data:e,contentType:"application/json"}).pipe((function(e){return e}))},getCommentsByParent:function(e){e=e||{};var t=this.serviceLocator.getUrl("count-comments");return $.read({url:t,data:e,contentType:"application/json"}).pipe((function(e){return e}))},getFilesList:function(e){var t=bizagi.util.validateFeatureSupport("filesList")?this.serviceLocator.getUrl("get-list-files"):this.serviceLocator.getUrl("get-list-files-v1");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"}).pipe((function(e){return e}))},deleteFile:function(e){var t=this.serviceLocator.getUrl("project-resource-action");return $.destroy({url:t.replace("{typeResource}","Attachment"),data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getFilesThumbnail:function(e){e=e||{};var t=this.serviceLocator.getUrl("thumbnail-file");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"}).pipe((function(e){return e}))},getAttachment:function(e){var t=this.serviceLocator.getUrl("get-attachment");return t=t.replace("{idAttachment}",e.idAttachment)},getMobileAttachment:function(e){var t=this.serviceLocator.getUrl("get-mobile-attachment");return(t=t.replace("{idAttachment}",e.idAttachment))+"?sessionId="},getAllAdministrableEntities:function(e){e=e||{};var t={action:"entitiesList",kind:"administrable"};return $.ajax({url:this.serviceLocator.getUrl("entities-administration"),data:t,type:"POST",dataType:"json"}).pipe((function(e){var t={entities:[]};return $.each(e,(function(e,i){t.entities.push(i)})),t}))},getEntitiesList:function(e){return(e=e||{}).action="entitiesList",e.kind="entitiesData",$.ajax({url:this.serviceLocator.getUrl("entities-administration"),data:e,type:"POST",dataType:"json"})},getCasesByWorkflow:function(e){e=e||{};var t={},i=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsDataInfo");if(bizagi.util.isEmpty(e.taskState)||(t.taskState=e.taskState),bizagi.util.isEmpty(e.smartInboxId)?bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow):t.smartInboxGuid=e.smartInboxId,1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),e.smartfoldersParameters){var r=e.smartfoldersParameters.split("&");$.each(r,(function(e,i){var r=i.split("=");t[r[0]]=r[1]}))}return(e.radnumber||e.radNumber)&&(t.radNumber=e.radNumber?e.radNumber:e.radnumber),(e.idcase||e.idCase)&&bizagi.util.isNumeric(e.idcase||e.idCase)&&(t.idCase=e.idCase?e.idCase:e.idcase),$.read(i,t).pipe((function(e){return $.each(e.cases.rows,(function(t,i){var r=[];e.cases.rows[t].radnumber=i.id,$.each(i.fields,(function(i,a){if(null!=a)try{null!=a.isRadNumber&&"true"==a.isRadNumber?(e.cases.rows[t].radnumber=a.Value,e.cases.rows[t].casenumberdisplayname=a.DisplayName):null!=a.workitems?e.cases.rows[t].workitems=a.workitems:r.push(a)}catch(e){}})),e.cases.rows[t].fields=r})),e.cases}))},getOrganizationsList:function(){var e=this.serviceLocator.getUrl("process-handler-getOrganizations"),t={type:12,name:""};return $.read(e,t)},getOrganizationsByUserList:function(){var e=this.serviceLocator.getUrl("process-handler-getOrganizationsByUser");return $.read(e,{})},getCustomizedColumnsData:function(e){e=e||{};var t={},i=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsData");if(t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"0",t.order=e.order||"",bizagi.isMobile()&&(t.mobileDevice=!0),e.taskState=e.taskState||"all",""===e.taskState.toString().toLowerCase()&&(e.taskState="all"),"red"===e.taskState.toString().toLowerCase()&&(e.taskState="Red"),"yellow"===e.taskState.toString().toLowerCase()&&(e.taskState="Yellow"),"green"===e.taskState.toString().toLowerCase()&&(e.taskState="Green"),t.taskState=e.taskState,bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow),bizagi.util.isEmpty(e.idTask)||(t.idTask=e.idTask),bizagi.util.isEmpty(e.radNumber)||(t.radNumber=e.radNumber),1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),e.smartfoldersParameters){var r=e.smartfoldersParameters.split("&");$.each(r,(function(e,i){var r=i.split("=");t[r[0]]=r[1]}))}return $.read(i,t)},getCustomizedColumnsDataBeta:function(e){e=e||{};var t={},i=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsData");if(t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"0",t.order=e.order||"",t.mobileDevice=!!bizagi.isMobile(),e.taskState=e.taskState||"all",""===e.taskState.toString().toLowerCase()&&(e.taskState="all"),"red"===e.taskState.toString().toLowerCase()&&(e.taskState="Red"),"yellow"===e.taskState.toString().toLowerCase()&&(e.taskState="Yellow"),"green"===e.taskState.toString().toLowerCase()&&(e.taskState="Green"),t.taskState=e.taskState,bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow),bizagi.util.isEmpty(e.idTask)||(t.idTask=e.idTask),bizagi.util.isEmpty(e.radNumber)||(t.radNumber=e.radNumber),1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),e.smartfoldersParameters){var r=e.smartfoldersParameters.split("&");$.each(r,(function(e,i){var r=i.split("=");t[r[0]]=r[1]}))}return $.read(i,t).pipe((function(e){var t={columnTitle:[],lstIdCases:[],elements:[],page:e.page,totalPages:e.totalPages},i=new Date,r=i.getMonth(),a=i.getDate(),n=i.getYear();t.columnTitle=e.cases.columnTitle,t.lstIdCases=e.cases.lstIdCases,t.page=e.cases.page,t.totalPages=e.cases.totalPages;for(var o=0,s=e.cases.rows.length;o<s;o++){var l=e.cases.rows[o],c=new Date(l.fields[3]),u=c.getDate(),d=c.getMonth(),g=c.getYear();a>u||r>d||n>g?(l.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(l.fields[3]),"dd MMM"),t.elements.push($.extend({},l,{group:"overdue"}))):a==u?(l.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(l.fields[3]),"hh:mm"),t.elements.push($.extend({},l,{group:"today"}))):a+1==u?(l.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(l.fields[3]),"hh:mm"),t.elements.push($.extend({},l,{group:"tomorrow"}))):(l.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(l.fields[3]),"dd MMM"),t.elements.push($.extend({},l,{group:"upcoming"})))}return(void 0===t.elements||void 0!==t.elements&&0===t.elements.length)&&t.elements.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")}),t}))},getCategories:function(e){var t={};return(e=e||{}).idCategory&&(t.idCategory=e.idCategory),e.idApp&&(t.idApp=e.idApp),bizagi.isMobile()&&(t.mobileDevice=!0),t.groupByApp=e.groupByApp||!1,$.read(this.serviceLocator.getUrl("process-handler-getCategory"),t)},getRecentProcesses:function(e){return(e=e||{}).mobileDevice=bizagi.isMobile()||"false",$.read(this.serviceLocator.getUrl("process-handler-getRecentProcesses"),e)},getCaseSummary:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseSummary"),data:{idCase:e.idCase,eventAsTasks:e.eventAsTasks||"false",onlyUserWorkItems:e.onlyUserWorkItems||"true",mobileDevice:bizagi.isMobile()||"false"},serviceType:"GETSUMMARY"}).pipe((function(e){return e}))},getCaseAssignees:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseAssignees"),{idCase:e.idCase}).pipe((function(e){return e}))},getCaseTasks:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseTasks"),{idCase:e.idCase})},getCaseEvents:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseEvents"),data:{idCase:e.idCase},serviceType:"GETEVENTS"}).pipe((function(e){return e}))},getCaseSubprocesses:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseSubprocesses"),data:{idCase:e.idCase},serviceType:"GETSUBPROCESSES"}).pipe((function(e){return e}))},getCaseFormsRenderVersion:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseFormsRenderVersion"),{idCase:e.idCase})},getCaseFormsRenderVersionDataContent:function(e){var t=new $.Deferred;return $.when(this.getCaseFormsRenderVersion(e)).done((function(e){t.resolve(e)})),t.promise()},getTaskAssignees:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getTaskAssignees"),{idCase:e.idCase,idTask:e.idTask})},getWorkitems:function(e){var t={};return e=e||{},t.idCase=e.idCase,t.fromTask=e.fromTask,t.fromWorkItemId=e.fromWorkItemId,t.mobileDevice=bizagi.isMobile(),e.eventAsTasks&&(t.eventAsTasks=e.eventAsTasks),void 0!==e.onlyUserWorkItems&&(t.onlyUserWorkItems=e.onlyUserWorkItems),$.read({url:this.serviceLocator.getUrl("case-handler-getWorkItems"),data:t,serviceType:"GETWORKITEMS"})},getQueries:function(e){var t=this;if(t.hashQueries&&e.idElement)return t.hashQueries[e.idElement];var i=new $.Deferred;return $.read(t.serviceLocator.getUrl("query-handler-getqueries")).done((function(e){t.hashQueries={},t.hashQueries[0]={},t.processQueries(e.query),i.resolve(t.hashQueries[-1])})),i.promise()},processQueries:function(e){var t=this;$.each(e,(function(e,i){t.hashQueries[i.idParent]||(t.hashQueries[i.idParent]=[]),t.hashQueries[i.idParent].push(i),i.nodes?t.processQueries(i.nodes):i.nodes={}}))},createNewCase:function(e){return e=e||{},$.create({url:this.serviceLocator.getUrl("case-handler-addNewCase"),data:{idWfClass:e.idWfClass,caseData:e.caseData?JSON.stringify(e.caseData):null,idOrganization:e.idOrganization?e.idOrganization:null},serviceType:"NEWCASE"})},validateHasStartForm:function(e){var t={processId:e.processId};return $.read({url:this.serviceLocator.getUrl("case-handler-validateHasStartForm"),data:t,batchRequest:!0})},startProcess:function(e){var t=this,i={idProcess:(e=e||{}).idProcess,entityMapping:e.mapping?JSON.stringify(e.mapping):{}};void 0!==e.idParentCase&&(i.idParentCase=e.idParentCase);var r=$.Deferred();return $.create({url:t.serviceLocator.getUrl("case-handler-startProcess"),data:i,serviceType:"STARTPROCESS"}).fail((function(i){if("error"!==$.parseJSON(i.responseText).status||bizagi.util.isVersionSupported())r.reject(i);else{var a={idWfClass:e.idProcess||e.idWfClass,idOrganization:e.idOrganization||null};t.createNewCase(a).then((function(e){e.oldVersion=!0,r.resolve(e)})).fail((function(e){r.reject(e)}))}})).done((function(e){r.resolve(e)})),r.promise()},actionCreateCase:function(e){var t={processId:void 0!==e.idProcess?e.idProcess:e.guidProcess};return void 0!==e.parentCaseId&&(t.parentCaseId=e.parentCaseId),void 0!==e.mapping&&(t.entityMapping=e.mapping?JSON.stringify(e.mapping):{}),$.create({url:this.serviceLocator.getUrl("handler-execute-action-start"),data:t,serviceType:"STARTPROCESS"})},getFirstParentPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-first-parent-plan"),i=$.Deferred();return $.when($.read({url:t,data:e,dataType:"json"})).done((function(e){i.resolve(e)})).fail((function(){i.resolve(null)})),i.promise()},searchCases:function(e){e=e||{};var t={h_action:"SEARCHCASES",onlyUserCases:!1,active:!1};return t.page=e.page||1,e.radNumber&&(t.radNumber=$.trim(e.radNumber)),t.pageSize=e.pageSize||this.pageSize,$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryCases:function(e){e=e||{};var t={h_action:"QUERYCASES"};return t.onlyUserCases=e.onlyUserCases||!1,t.active=e.active&&!0,t.page=e.page||1,e.radNumber&&(t.radNumber=$.trim(e.radNumber)),t.pageSize=e.pageSize||this.pageSize,t.filter=e.filter,t.outputxpath=e.outputxpath,t.orderFieldName=e.orderFieldName||"",t.orderType="asc"==e.orderType||1==e.orderType?1:0,t.order=e.order||"",$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryEntities:function(e){e=e||{};var t={h_action:"QUERYENTITIES"};return t.page=e.page||1,t.pageSize=this.Class.ENTITIES_QUERY_PAGE_SIZE,t[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"idEnt"]=e.idEntity,t.filter=e.filter,t.outputxpath=e.outputxpath,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"",t.order=e.order||"",$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},getMenuAuthorization:function(){return $.read(this.serviceLocator.getUrl("authorization-handler-getMenuAuthorization"))},isCaseCreationAuthorized:function(e){var t=this.serviceLocator.getUrl("authorization-handler-isCaseCreationAuthorized");return t=t.replace("{0}",e.idWfClass||""),$.read({url:t})},getAsynchExecutionState:function(e){return(e=e||{}).idCase,$.read({url:this.serviceLocator.getUrl("case-handler-getAsynchExecutionState"),data:{idCase:e.idCase,idAsynchWorkitem:e.idAsynchWorkitem},serviceType:"ASYNCHEXECUTION"})},supportedLogTypes:function(){return $.read(this.serviceLocator.getUrl("case-handler-supportedLogTypes"))},getActivityLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getActivityLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getActivityDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getActivityDetailLog"),{idCase:e.idCase,idWorkItemFrom:e.idWorkItemFrom,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getEntityLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getEntityLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getEntityDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getEntityDetailLog"),{idCase:e.idCase,idEntity:e.idEntity||-1,userFullName:e.userFullName||"",attribDisplayName:e.attribDisplayName||"",idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getUserLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getUserLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getUserDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getUserDetailLog"),{idCase:e.idCase,idUser:e.idUser,entDisplayName:e.entDisplayName||"",attribDisplayName:e.attribDisplayName||"",idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},getAdminLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getAdminLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe((function(e){return e}))},addFavorite:function(e){return e=e||{},$.create(this.serviceLocator.getUrl("favorites-handler-saveFavorite"),{idObject:e.idObject,favoriteType:e.favoriteType}).pipe((function(e){return e}))},delFavorite:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("favorites-handler-deleteFavorite"),{guidFavorite:e.idObject}).pipe((function(e){return e}))},summaryAssigness:function(e){var t=new $.Deferred,i=e.idCase||"";return $.when(this.getCaseAssignees({idCase:i})).done((function(e){for(var i=e.assignees||[],r=i.length,a={showAssignees:!!(bizagi.override.showAssignees&&i.length>0),assignees:{},events:"",activities:""},n="",o="",s=[],l=[],c=0;c<r;c++)bizagi.util.parseBoolean(i[c].isEvent)?-1==s.indexOf(i[c].idUser)&&(s.push(i[c].idUser),n+=i[c].Name+", "):-1==l.indexOf(i[c].idUser)&&(l.push(i[c].idUser),o+=i[c].Name+", ");a.events=n.substring(0,n.length-2),a.activities=o.substring(0,o.length-2),t.resolve(a)})),t.promise()},summarySubProcess:function(e){var t=$.Deferred(),i=e.idCase||"";return $.when(this.getCaseSubprocesses({idCase:i})).done((function(e){if(e.showSubProcess=e.subProcesses.length>=1,e.showSubProcesColumns=void 0!==e.CustFields[0]&&e.CustFields[0][0].length>=1,e.showSubProcesColumns){var i;e.subProcPersonalized={};for(var r=0;r<e.CustFields.length;r++){i=0;for(var a=0;a<e.subProcesses.length;a++)e.subProcesses[a].idCustData==r&&(e.subProcPersonalized[r]=e.subProcPersonalized[r]||{},e.subProcPersonalized[r].subProcesses=e.subProcPersonalized[r].subProcesses||{},e.subProcPersonalized[r].subProcesses[i++]=e.subProcesses[a]);-1!=e.subProcesses[r].idCustData&&null!=e.subProcPersonalized[r]&&(e.subProcPersonalized[r].CustFields=e.CustFields[r],e.subProcPersonalized[r].idCase=e.idCase)}}t.resolve(e)})),t.promise()},summaryCaseEvents:function(e){var t=$.Deferred(),i=e.idCase||"";return $.when(this.getCaseEvents({idCase:i})).done((function(e){e.showEvents=e.events.length>=1,t.resolve(e)})).fail((function(e){t.reject()})),t.promise()},summaryCaseDetails:function(e){var t=new $.Deferred,r=e.idWorkitem||0;return $.when(this.getCaseSummaryDataContent(e)).done((function(e){e.currentState=e.currentState||[];var a=e.currentState.length;for(e.showEvents=e.countEvents>=1,e.showParentProcess=e.idParentCase>=1,e.parentProcess={displayName:e.parentDisplayName,idCase:e.idParentCase},e.isClosedForAllUsers=bizagi.util.parseBoolean(e.isClosed),e.isClosed=!bizagi.util.parseBoolean(e.isOpen),e.showAssignees=!!(bizagi.override.showAssignees&&e.countAssigness>0),e.showSubProcess=e.countSubProcesses>0,e.showForm=!!bizagi.util.parseBoolean(e.hasGlobalForm),e.allowsReassign="false",i=0;i<a;i++)e.currentState[i].idWorkItem==r&&(e.allowsReassign=e.currentState[i].allowsReassign);var n=[],o=0;for(i=0;i<a;i++)!bizagi.util.parseBoolean(e.currentState[i].isEvent)&&bizagi.util.parseBoolean(e.currentState[i].assignToCurrentUser)&&e.currentState[i].idWorkItem!=r&&(n[o++]=e.currentState[i]);e.currentStateTypes=n,e.showActivities=n.length>0,t.resolve(e)})),t.promise()},releaseActivity:function(e){var t=this.serviceLocator.getUrl("case-handler-releaseActivity");t=t.replace("{idCase}",e.idCase);var i={};return e&&(i.idCase=e.idCase,i.idWorkItem=e.idWorkItem),$.ajax({url:t,data:i,type:"POST",dataType:"json"})},summaryActivities:function(e){var t={},i=e.data||{},r=r||e.idWorkitem||0;try{t.showActivities=i.currentStateTypes.length>=1,t.currentState=i.currentStateTypes,t.globalIdWorkitem=r,t.creationDate=i.creationDate}catch(e){}return t},getCaseSummaryDataContent:function(e){var t=this,i=new $.Deferred;return $.when(t.getCaseSummary(e)).done((function(e){e.taskState=t.icoTaskState,e.process=e.process?e.process:"",e.createdBy&&(e.createdByName=e.createdBy.Name,e.createdByUserName=e.createdBy.userName,e.caseDescription=""==e.caseDescription?"":e.caseDescription,e.processPath=e.processPath.replace(/\//g," > ")+e.process,e.showWorkOnIt=!0),i.resolve(e)})),i.promise()},getSmartFolders:function(e){var t=this,i={};return i.idFolder=e||"",$.read(t.serviceLocator.getUrl("folders-handler-getUserQueries"),i).pipe((function(i){return-1==e||""==e?i:t.searchFolders(e,i)||[]}))},deleteSmartFolder:function(e){var t={action:"6"};return e=e||{},t.idSmartFolder=e.idSmartFolder||"",t.idUser=e.idUser||"",$.destroy(this.serviceLocator.getUrl("folders-associate-deleteSmartFolder"),t)},getFolders:function(e){var t=this,i={action:"getUserFolder"};return i.idFolder=e||"",$.ajax({url:t.serviceLocator.getUrl("folders-handler"),type:"POST",data:i,dataType:"json"}).pipe((function(i){return""==e?{folders:[{name:bizagi.localization.getResource("workportal-widget-folders"),id:"-1",idParent:0,childs:i}]}:-1==e?i:t.searchFolders(e,i)||[]}))},searchFolders:function(e,t){for(var i=0;i<t.folders.length;i++){if(t.folders[i].id==e)return t.folders[i].childs}},getCasesByFolder:function(e){return e=e||"",$.ajax({cache:!0,url:"RestServices/"+e,type:"GET",dataType:"json"})},makeFolder:function(e){var t={action:"CreateUpdateFolder"};return t.folderName=e.folderName||"No Name",null!=e.idParentFolder&&e.idParentFolder>1&&(t.idParentFolder=e.idParentFolder),$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},updateFolder:function(e){var t={};return e=e||{},t.action="CreateUpdateFolder",t.idFolder=e.idFolder||"",e.folderName&&(t.folderName=e.folderName),e.idParentFolder&&(t.idParentFolder=e.idParentFolder),$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},associateCaseToFolder:function(e){var t={action:"4"};return e=e||{},t.idCase=e.idCase||"",t.idCustomFolder=e.idCustomFolder,$.ajax({url:this.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},dissasociateCaseFromFolder:function(e){var t={action:"DeleteCaseFromFolder"};return e=e||{},t.idFolder=e.idFolder,t.idCase=e.idCase,$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},deleteFolder:function(e){var t={action:"5"};return e=e||{},t.idCustomFolder=e.idCustomFolder||"",$.ajax({url:this.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},getFile:function(e){var t={},i=this.serviceLocator.getUrl("file-handler");return e=e||{},t.action="getFileContent",t.uploadId=e.uploadId||"",t.entityId=e.entityId||"",t.entityKey=e.entityKey||"",bizagi.services.ajax.pathToBase+i+"?"+jQuery.param(t)},getComments:function(e){var t=this;return e=e||{},$.read(encodeURI(t.serviceLocator.getUrl("MessageHandler-GetComments")),{idCase:e.idCase||"",idColorCategory:"number"==typeof e.idColorCategory?e.idColorCategory:"",pag:e.pag||1,pagSize:e.pagSize||10}).pipe((function(e){var i=new $.Deferred,r="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";return e.comments?$.each(e.comments,(function(t,i){e.comments[t].hasOwnProperty("CategoryColor")||(e.comments[t].CategoryColor="")})):e.comments=[],e.users?$.each(e.users,(function(t,i){e.users[t].Picture=""===e.users[t].Picture?r:e.users[t].Picture})):$.when(t.getCurrentUser()).done((function(t){e.users=[],e.users.push({Id:t.idUser,Name:t.user,DisplayName:t.userName,Picture:r})})),i.resolve(e),i.promise()}))},makeNewComment:function(e){return $.create(this.serviceLocator.getUrl("MessageHandler-NewComment"),{idCase:e.idCase||"",comment:e.comment.replace(/\n/g,"<br>")||""}).pipe((function(e){if(e.comments){var t=[e.comments];$.each(t,(function(e,i){t[e].CategoryColor=""})),e.comments=t}if(e.users){var i=[e.users];$.each(i,(function(e,t){i[e].Picture=""==i[e].Picture?"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC":i[e].Picture})),e.users=i}return e}))},makeNewReply:function(e){return e=e||{},$.create(this.serviceLocator.getUrl("MessageHandler-ReplyComment"),{idCase:e.idCase||"",idComment:e.idComment||"",comment:e.comment.replace(/\n/g,"<br>")||""}).pipe((function(e){if(e.comments&&(e.Replies=[e.comments]),e.users){var t=[e.users];$.each(t,(function(e,i){t[e].Picture=""==t[e].Picture?"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":t[e].Picture})),e.users=t}return e}))},removeMobileComment:function(e){var t=this.serviceLocator.getUrl("remove-comment");return e=e||{},$.destroy({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"}).pipe((function(e){return e}))},removeComment:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("MessageHandler-RemoveComment"),{idCase:e.idCase||"",idComment:e.idComment||""})},removeReply:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("MessageHandler-RemoveReply"),{idCase:e.idCase||"",idComment:e.idComment||"",idReply:e.idReply||""})},renameCommentCategory:function(e){return e=e||{},$.update(this.serviceLocator.getUrl("MessageHandler-RenameCategoryColor"),{idColorCategory:e.idColorCategory>=0?e.idColorCategory:"",colorName:e.colorName||""})},setCommentCategory:function(e){return e=e||{},$.update(this.serviceLocator.getUrl("MessageHandler-SetCategoryToComment"),{idCase:e.idCase||"",idComment:e.idComment||"",idColorCategory:"number"==typeof e.idColorCategory?e.idColorCategory:""})},getCommentsCategories:function(){return $.read(this.serviceLocator.getUrl("MessageHandler-GetCategoryColors")).pipe((function(e){return e.length>1&&e[0].categories?e[0]:e}))},getNewComments:function(e){return e=e||{},$.read(encodeURI(this.serviceLocator.getUrl("MessageHandler-CountNewComments")),{idCase:e.idCase||0,idComment:e.idComment||0})},getAnalisysQueries:function(){return $.read(this.serviceLocator.getUrl("bamAnalytics-handler-getAnalisysQueries"))},updateQueries:function(e){return $.update(this.serviceLocator.getUrl("bamAnalytics-handler-updateQuery"),{idQuery:e.idQuery>=0?e.idQuery:"",queryName:e.queryName||"",queryDescription:e.queryDescription||""})},deleteQueries:function(e){var t={action:"1612"};return t.QueryId=e||"",$.destroy(this.serviceLocator.getUrl("reports-handler-deleteQueries"),t)},getConfiguration:function(){var e=this.serviceLocator.getUrl("authenticationConfig");return $.read(e)},logout:function(){sessionStorage.removeItem("bizagiAuthentication");try{var e=$.create(this.serviceLocator.getUrl("logout"));$.when(e).done((function(){location.reload()})).fail((function(){bizagi.log("Error logging out")}))}catch(e){}},logoutMobile:function(){var e=this,t={sourceLogout:"user"};if(sessionStorage.removeItem("bizagiAuthentication"),bizagi.util.removeLastProcessInbox(),bizagi.util.isCordovaSupported()){var i=e.serviceLocator.getUrl("logout");return $.create(i)}try{$.when(e.getConfiguration()).done((function(i){if(i.redirectErrorPage)window.location.href=i.redirectErrorPage;else switch(i.authenticationType){case"Federate":var r=i.logOffURL,a=i.federationLogoutBindingProtocol,n=i.authenticationSubType;if("WSFederated"===n)$.when($.create(e.serviceLocator.getUrl("logout"),t)).done((function(){location.href=r})).fail((function(){bizagi.log("Error logging out")})).always((function(){location.href=i.logOffURL}));else if("Saml"===n){$.when($.read(e.serviceLocator.getUrl("FederateLogoffUrl"),{})).done((function(i){i.federateLogoffUrl&&(r=i.federateLogoffUrl),$.when($.create(e.serviceLocator.getUrl("logout"),t)).done((function(){"POST"===a?(window.document.open("text/html"),window.document.write(r),window.document.close()):window.location.href=r})).fail((function(){bizagi.log("Error logging out")})).always((function(){}))})).fail((function(){bizagi.log("Error logging out")})).always((function(){}))}break;case"SAML":loader.nativeAjax(loader.getPathUrl(e.serviceLocator.getUrl("logout"),t),(function(e){var t=JSON.parse(e.responseText);if(!0===t.logout)if(void 0!==t.samlUrlRedirect){var i=decodeURI(t.samlUrlRedirect),r=document.createElement("iframe");document.getElementsByTagName("body")[0].appendChild(r),$(r).on("load",(function(){(bizagi.util.isIE8()?$(this.contentWindow.document.body):$(this.contentWindow.eval("document.body"))).text();location.reload()})),r.src=i}else location.reload();else bizagi.log("Error logging out")}));break;case"OAuth2":$.when($.create(e.serviceLocator.getUrl("logout"),t)).done((function(){$.when($.read(e.serviceLocator.getUrl("oauth2AuthenticationConfig"))).done((function(e){if(e.logoutUrl&&""!=e.logoutUrl){var t=e.logoutUrl,i=e.homeUrl;t=t.replace(/post_logout_redirect_uri=[^&]*/,"post_logout_redirect_uri="+i),location.href=t}else location.reload()})).fail((function(){bizagi.log("Error logging out")}))})).fail((function(){bizagi.log("Error logging out")}));break;default:$.when($.create(e.serviceLocator.getUrl("logout"),t)).done((function(){window.location=bizagi.services.ajax.loginPage})).fail((function(){bizagi.log("Error logging out")}))}})).fail((function(e){bizagi.log(e)}))}catch(e){bizagi.log(e)}},getOrganizationInfo:function(e){var t={};return t.objectType=e,$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-getOrganizationInfo"),data:t,type:"GET",dataType:"json"})},getCasesByOrganization:function(e){var t={};return t.roles=e.roles?"["+e.roles.toString()+"]":"[]",t.skills=e.skills?"["+e.skills.toString()+"]":"[]",t.locations=e.locations?"["+e.locations.toString()+"]":"[]",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-getCasesByOrganization"),data:t,type:"GET",dataType:"json"})},reassignCases:function(e){var t={};return t.users=e.user?"["+e.user.toString()+"]":"[]",t.roles=e.roles?"["+e.roles.toString()+"]":"[]",t.skills=e.skills?"["+e.skills.toString()+"]":"[]",t.locations=e.locations?"["+e.locations.toString()+"]":"[]",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-reassignCases"),data:t,type:"POST",dataType:"json"})},searchUsers:function(e){var t={};return t.userName=e.userName||"",t.fullName=e.fullName||"",t.domain=e.domain||"",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-searchUsers"),data:t,type:"GET",dataType:"json"})},getDomainList:function(){var e=this.serviceLocator.getUrl("domains");return $.read(e)},getEcmAllScheduledJobs:function(){var e={action:"getEcmAllScheduledJobs"};return $.read(this.serviceLocator.getUrl("async-ecm-upload-baseService"),e)},retryECMPendingScheduledJob:function(e){var t={action:"retryECMPendingScheduledJob"};return t.idJob=e,$.read(this.serviceLocator.getUrl("async-ecm-upload-baseService"),t)},getWorkPortalVersion:function(){return $.ajax({url:this.serviceLocator.getUrl("WorkPortalVersion"),type:"GET",dataType:"json"}).always((function(e){return""==(e=e||{}).version&&(e.version=bizagi.loader.productBuild||""),e}))},getAuthenticationLogData:function(e){var t="";return t="domains"==e.dataType?"admin-getAuthenticationDomains":"events"==e.dataType?"admin-getAuthenticationEventsTypes":"admin-getAuthenticationEventSubTypes",$.ajax({url:this.serviceLocator.getUrl(t),data:{},type:"GET",dataType:"json"})},getAuthenticationLogResult:function(e){var t={};return t.action=e.action,t.domain=e.domain,t.userName=e.userName,t.dtFrom=e.dtFrom,t.dtTo=e.dtTo,t.eventSubType=e.eventSubType,t.eventType=e.eventType,t.pag=e.pag,t.pagSize=e.pagSize,$.ajax({url:this.serviceLocator.getUrl("admin-getAuthenticationLog"),data:t,type:"GET",dataType:"json"})},encryptString:function(e){var t={};return e=e||{},t.entry=e.entry,$.ajax({url:this.serviceLocator.getUrl("admin-EncryptString"),data:t,type:"POST",dataType:"json"})},userPendingRequests:function(e){var t={pag:e.pag,pagSize:e.pagSize};return $.read(this.serviceLocator.getUrl("admin-UserPendingRequests"),t)},userAuthenticationInfo:function(e){return $.read(this.serviceLocator.getUrl("admin-UserAuthenticationInfo"),{idUser:e.idUser})},updateUserAuthenticationInfo:function(e){return $.create(this.serviceLocator.getUrl("admin-updateUserAuthenticationInfo"),{idUser:e.idUser,password:e.password,enable:e.enable,expired:e.expired,locked:e.locked})},generateRandomPassword:function(e){return(e=e||{}).action="generateRandomPassword",$.ajax({url:this.serviceLocator.getUrl("admin-generateRandomPassword"),data:e,type:"POST",dataType:"json"})},generateDataToSendByEmail:function(e){e=e||{};var t={action:"GenerateDataToSendByEmail"};return t.idUser=e.idUser,t.password=e.password,$.ajax({url:this.serviceLocator.getUrl("admin-GenerateDataToSendByEmail"),data:e,type:"POST",dataType:"json"})},sendEmail:function(e){e=e||{};var t={action:"sendEmail"};return t.emailTo=e.emailTo,t.subject=e.subject,t.body=e.body,$.ajax({url:this.serviceLocator.getUrl("admin-sendEmail"),data:e,type:"POST",dataType:"json"})},getApplicationCategoriesList:function(e){var t={},i="";return"Applications"==e.action?(i="admin-getApplicationList",$.ajax({url:this.serviceLocator.getUrl(i),type:"GET",dataType:"json"})):(i="admin-getCategoriesList",t.idApp=e.idApp,t.idCategory=e.idCategory,""==t.idCategory&&(t.idCategory=-1),void 0!==e.filterStartEvent&&(t.filterStartEvent=e.filterStartEvent),$.ajax({url:this.serviceLocator.getUrl(i),data:t,type:"GET",dataType:"json"}))},getAdminCasesList:function(e){var t=e||{};return $.ajax({cache:!0,url:this.serviceLocator.getUrl("admin-getCasesList"),data:t,type:"GET",dataType:"json"})},getApplicationProcesses:function(e){var t=this.serviceLocator.getUrl("admin-getApplicationProcesses"),i={};return i.idApp=e.idApp?e.idApp:-1,$.read(t,i)},getProcessVersion:function(e){var t=this.serviceLocator.getUrl("admin-getProcessVersion"),i={};return i.idWfClass=e.idWFClass,$.read(t,i)},getProcessTasks:function(e){var t=this.serviceLocator.getUrl("admin-getProcessTasks"),i={};return i.idWfClass=e.idWFClass,i.version=e.version?e.version:void 0,$.read(t,i)},getTaskAlarms:function(e){var t=this.serviceLocator.getUrl("admin-getTaskAlarms"),i={};return i.idTask=e.idTask,$.read(t,i)},getLapseMode:function(){var e=this.serviceLocator.getUrl("admin-getLapseMode");return $.read(e)},getRecurrMode:function(){var e=this.serviceLocator.getUrl("admin-getRecurrMode");return $.read(e)},getScheduleType:function(){var e=this.serviceLocator.getUrl("admin-getScheduleType");return $.read(e)},getBossList:function(e){var t=this.serviceLocator.getUrl("admin-getBossList");return $.read(t)},addAlarm:function(e){var t=this.serviceLocator.getUrl("admin-addAlarm"),i={};return i.idTask=e.idTask,i.idRecurrMode=e.idRecurrMode,i.idLapseMode=e.idLapseMode,i.scheduleType=e.scheduleType,i.alarmTime=e.alarmTime,i.alarmRecurrTime=e.alarmRecurrTime,i.sendToCurrentAssignee=e.sendToCurrentAssignee,$.update(t,i)},editAlarm:function(e){var t=this.serviceLocator.getUrl("admin-editAlarm"),i={};return i.idTask=e.idTask,i.idAlarm=e.idAlarm,i.idRecurrMode=e.idRecurrMode,i.idLapseMode=e.idLapseMode,i.scheduleType=e.scheduleType,i.alarmTime=e.alarmTime,i.alarmRecurrTime=e.alarmRecurrTime,i.sendToCurrentAssignee=e.sendToCurrentAssignee,$.update(t,i)},deleteAlarm:function(e){var t=this.serviceLocator.getUrl("admin-deleteAlarm");return e.idAlarm,$.destroy(t,e)},getAlarmRecipients:function(e){var t=this.serviceLocator.getUrl("admin-alarmRecipients"),i={};return i.idAlarm=e.idAlarm,$.read(t,i)},addRecipientToAlarm:function(e){var t=this.serviceLocator.getUrl("admin-recipientToAlarm"),i={};return i.idAlarm=e.idAlarm,i.idRecipient=e.idRecipient,$.update(t,i)},deleteRecipientsFromAlarm:function(e){var t=this.serviceLocator.getUrl("admin-deleteAlarmRecipients"),i={};return i.idRecipients=e.idRecipients,$.destroy(t,i)},enableAlarm:function(e){var t=this.serviceLocator.getUrl("admin-enableAlarm"),i={};return i.idTask=e.idTask,$.create(t,i)},abortReassignItems:function(e){var t=e||{},i="abort"==e.action?"admin-abortItems":"admin-reassignItems";return $.ajax({url:this.serviceLocator.getUrl(i),data:t,type:"POST",dataType:"json"})},asyncActivitiesServices:function(e){var t=e,i="",r="GET";return"getActivities"==e.action?i=this.serviceLocator.getUrl("admin-async-activities-get-activities"):"retryNow"==e.action?(r="POST",i=(i=(i=(i=this.serviceLocator.getUrl("admin-async-activities-get-retry-now")).replace("{idCase}",e.idCase)).replace("{idworkItem}",e.idWorkitem)).replace("{idAsynchWorkitem}",e.idAsynchWorkitem)):"getActivitiesByTask"==e.action?i=this.serviceLocator.getUrl("admin-async-activities-get-activities-by-task"):"enableExecution"==e.action?(r="POST",i=this.serviceLocator.getUrl("admin-async-activities-enable-execution")):"enableMultiple"==e.action?(i=this.serviceLocator.getUrl("admin-async-activities-enable-multiple"),r="POST"):"asyncExecution"==e.action?i=this.serviceLocator.getUrl("admin-async-activities-async-execution"):"asyncExecutionLog"==e.action?i=(i=(i=(i=this.serviceLocator.getUrl("admin-async-activities-async-execution-log")).replace("{idCase}",e.idCase)).replace("{idworkItem}",e.idWorkItem)).replace("{idAsynchWorkitem}",e.idAsynchWorkitem):"getAsyncExecution"==e.action&&(i=this.serviceLocator.getUrl("admin-async-activities-async-get-current-execution-log")),$.ajax({url:i,data:t,type:r,dataType:"json"})},getDefaultAssignationUserToAllProcess:function(e){return $.read(this.serviceLocator.getUrl("admin-getDefaultAssignationUserToAllProcess"),{serviceAction:"getDefaultAssignationUserToAllProcess"})},getDefaultAssignationUserToProcess:function(e){var t;return t=""==e.idWFClass?-1:e.idWfClass,$.read(this.serviceLocator.getUrl("admin-getDefaultAssignationUserToProcess"),{serviceAction:"getDefaultAssignationUserToProcess",process:t})},setDefaultAssignationUserToProcess:function(e){return""==e.idWFClass?process=-1:process=e.idWfClass,$.create(this.serviceLocator.getUrl("admin-setDefaultAssignationUserToProcess"),{serviceAction:"setDefaultAssignationUserToProcess",process:process,idUser:e.idUser})},getProcessIcon:function(e){var t={processId:e.processId};return $.read({url:this.serviceLocator.getUrl("process-getIcon"),data:t,batchRequest:!0})},getCollectionIcon:function(e){var t={collectionId:e.collectionId};return $.read({url:this.serviceLocator.getUrl("collections-getIcon"),data:t,batchRequest:!0})},getProfilesTypes:function(e){return $.read(this.serviceLocator.getUrl("admin-getProfilesTypes"))},searchProfiles:function(e){var t=this.serviceLocator.getUrl("admin-searchProfiles"),i={};return i.type=e.profileType,i.name=e.profileName,i.orgId=e.orgId?e.orgId:null,$.read(t,i)},getUsersByProfile:function(e){var t=this.serviceLocator.getUrl("admin-getUsersByProfile"),i={};return i.type=e.profileType,i.id=e.idProfile,$.read(t,i)},removeUserFromProfile:function(e){var t=this.serviceLocator.getUrl("admin-removeUserFromProfile"),i={};return i.type=e.profileType,i.id=e.idProfile,i.idUser=e.idUser,$.destroy(t,i)},addUserToProfile:function(e){var t=this.serviceLocator.getUrl("admin-addUserToProfile"),i={};return i.type=e.profileType,i.id=e.idProfile,i.idUser=e.idUser,$.update(t,i)},licenses:function(){var e=this.serviceLocator.getUrl("admin-Licenses");return $.read(e)},getDimensions:function(){var e=this.serviceLocator.getUrl("admin-GetDimensions");return $.read(e)},editDimension:function(e){e=e||{};var t={};t.id=e.id,t.displayName=e.displayName,t.name=e.name,t.idWfClass=e.idWfClass,t.entityPath=e.entityPath,t.description=e.description;var i=this.serviceLocator.getUrl("admin-EditDimension");return $.create(i,t)},createAdministrableDimension:function(e){e=e||{};var t={};return t.displayName=e.displayName,t.name=e.name,t.idWfClass=e.idWfClass,t.entityPath=e.entityPath,t.Description=e.description,$.ajax({url:this.serviceLocator.getUrl("admin-CreateAdministrableDimension"),data:e,type:"PUT",dataType:"json"})},deleteDimension:function(e){var t=this.serviceLocator.getUrl("admin-DeleteDimension");e=e||{};var i={};return i.id=e.id,i.idDimension=e.id,i.administrable=e.administrable,$.destroy(t,i)},entityPathChildNodesAction:function(e){e=e||{};var t={};return t.pathNodeType=e.nodeType,t.idNode=e.idNode,t.nodeDisplayPath=e.nodeDisplayPath,t.nodePath=e.nodePath,t.idWfClass=e.idWfClass,$.ajax({url:this.serviceLocator.getUrl("admin-EntityPathChildNodesAction"),data:e,type:"GET",dataType:"json"})},getActiveWFClasses:function(e){var t=e||{};return $.ajax({cache:!0,url:this.serviceLocator.getUrl("admin-GetActiveWFClasses"),data:t,type:"GET",dataType:"json"})},storeDocumentTemplates:function(){var e=this.serviceLocator.getUrl("admin-document-templates-storeDocumentTemplates");return $.read(e)},restoreDocumentTemplates:function(e){var t=this.serviceLocator.getUrl("admin-document-templates-restoreDocumentTemplates");return t+="?Guid="+e.Guid,$.read(t)},getWorkFlowClasses:function(){var e=this.serviceLocator.getUrl("admin-processes-workflowClasses");return $.read(e)},getTaskByWorkFlow:function(e){var t=this.serviceLocator.getUrl("admin-processes-tasksByWorkflow"),i={};return i.idWorkflow=e.idWorkflow,$.read(t,i)},modifyProcessDuration:function(e){var t=this.serviceLocator.getUrl("admin-processes-modifyProcessDuration"),i={};return i.idWorkflow=e.idWorkflow,i.duration=e.duration,$.create(t,i)},modifyTaskDuration:function(e){var t=this.serviceLocator.getUrl("admin-processes-modifyTaskDuration"),i={};return i.idTask=e.idTask,i.duration=e.duration,$.create(t,i)},getDataForMyTeam:function(){return $.ajax({url:this.serviceLocator.getUrl("bam-resourcemonitor-myteam"),type:"GET",dataType:"json"})},getReporstAnalysisQuery:function(){return $.read(this.serviceLocator.getUrl("reports-analysisquery"))},updateReportData:function(e){return $.update(this.serviceLocator.getUrl("reports-analysisquery-update"),e)},deleteReportData:function(e){return $.destroy(this.serviceLocator.getUrl("reports-analysisquery-delete")+"?"+e)},getStoreLanguageTemplates:function(){var e=this.serviceLocator.getUrl("admin-language-languages");return $.read(e,{justActives:!1})},getLanguageTemplate:function(e){var t=$.Deferred(),i=this.serviceLocator.getUrl("admin-language-resource")+"?cultureName="+e.cultureName;return t.resolve("OK"),window.location.href=i,t.promise()},processDefinition:function(e){return $.read(this.serviceLocator.getUrl("processviewer-processdefinition"),e)},graphicInfo:function(e){return $.read(this.serviceLocator.getUrl("processviewer-processgraphicinfo"),e)},getLastUpdateByMobile:function(){return $.read({url:this.serviceLocator.getUrl("mobile-getLastUpdate")})},getCollectionData:function(e){var t={},i=this.serviceLocator.getUrl("templates-handler-getCollectionData");return t.idFact=e.idFact,t.pag=e.page||1,t.pagSize=e.pageSize||10,t.filters=e.filters?Array.isArray(e.filters)?void 0:JSON.stringify(e.filters):void 0,$.read(i,t).pipe((function(e){return e}))},getVirtualCollectionData:function(e){var t={},i=this.serviceLocator.getUrl("templates-handler-getVirtualCollectionData");return t.guidVirtualCollection=e.guidVirtualCollection,t.pag=e.page||1,t.pagSize=e.pageSize||10,t.filters=e.filters?Array.isArray(e.filters)?void 0:JSON.stringify(e.filters):void 0,$.read(i,t).pipe((function(e){return e}))},getSearchData:function(e){var t=this,i=t.serviceLocator.getUrl("my-search-getData");i=i.replace("{guidSearch}",e.guidSearch);var r=e.filters||[],a={filters:JSON.stringify(r),pag:e.page||1,calculateFilters:e.calculateFilters||!1,pagSize:e.pageSize||10};return $.read(i,a).then((function(e){return t.serializeEntityData(e)}))},getCollectionEntityData:function(e){var t,i=this,r={templateType:"VIRTUAL"===(e=e||{}).referenceType||"FACT"===e.referenceType?"List":"Content",surrogateKey:e.surrogateKey,pag:e.page||1,pagSize:e.pageSize||10,defaultFilterApplied:e.defaultFilterApplied,filters:JSON.stringify(e.filters)};return"VIRTUAL"===e.referenceType?(t=i.serviceLocator.getUrl("data-navigation-handler-collection"),r.reference=e.reference):(t=i.serviceLocator.getUrl("data-navigation-handler-entity"),r.reference=e.guidEntityCurrent,r.xpath=e.xpath,r.collectionId=e.reference),$.read(t,r).then((function(e){return i.serializeEntityData(e)}))},getFiltersEntityData:function(e){var t={reference:(e=e||{}).guidEntityCurrent,collectionId:e.reference,surrogateKey:e.surrogateKey,xpath:e.xpath,templateType:"List",defaultFilterApplied:e.defaultFilterApplied,filters:JSON.stringify(e.filters)};return $.read({url:this.serviceLocator.getUrl("data-navigation-handler-entity-filters"),data:t})},getProcessAddAction:function(e){var t=this.serviceLocator.getUrl("action-handler-getProcessAddAction");return $.read(t,e).pipe((function(e){return e}))},getMultipleActions:function(e){var t=this.serviceLocator.getUrl("templates-handler-getMultipleActions");return $.read(t,e).pipe((function(e){return e}))},getMapping:function(e){return $.ajax({url:this.serviceLocator.getUrl("process-handler-getMapping"),data:e,type:"POST",dataType:"json"})},getForm:function(e){return e[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"devicetype"]=this.deviceType,e[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"devicecode"]=this.deviceCode,$.ajax({url:this.serviceLocator.getUrl("process-handler-getForm"),data:e,type:"POST",dataType:"json"})},hasStartForm:function(e){var t={};return e.guid&&(t.guidWFClass=e.guid),$.read(this.serviceLocator.getUrl("process-handler-startform"),t)},executeAction:function(e){var t={surrogateKey:JSON.stringify(e.surrogatedKey),entityId:e.entityId,ruleId:e.processId};return $.create({url:this.serviceLocator.getUrl("process-action-execute"),data:t})},actionRule:function(e){var t={surrogateKey:e.surrogateKey,entityId:e.entityId,ruleId:e.processId};return $.create({url:this.serviceLocator.getUrl("process-handler-rule"),data:t,batchRequest:!1})},getActivitiesData:function(e){var t=this,i=t.serviceLocator.getUrl("process-handler-getActivitiesData"),r={page:(e=e||{}).page||1,pagsize:e.pageSize||10};return(void 0!==e.idworkflow&&e.idworkflow||void 0!==e.idWorkflow&&e.idWorkflow)&&(r.idWorkflow=e.idworkflow||e.idWorkflow),void 0!==e.idCase&&e.idCase&&(r.idCase=e.idCase),$.read(i,r).then((function(e){return t.serializeEntityData(e)}))},getPendingsData:function(e){var t=this,i=t.serviceLocator.getUrl("process-handler-getPendingsData"),r={page:(e=e||{}).page||1,pagsize:e.pageSize||10};return(void 0!==e.idworkflow&&e.idworkflow||void 0!==e.idWorkflow&&e.idWorkflow)&&(r.idWorkflow=e.idworkflow||e.idWorkflow),void 0!==e.idCase&&e.idCase&&(r.idCase=e.idCase),void 0!==e.taskState&&e.taskState&&(r.taskState=e.taskState),$.read(i,r).then((function(e){return t.serializeEntityData(e)}))},getActionsData:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("entities-handler-getActions"),data:e,batchRequest:!0}).pipe((function(e){return e}))},getUsersAndEvents:function(e){var t={};return e.idCases&&e.idCases.length>0&&(t.idCases=e.idCases.toString()),$.read(this.serviceLocator.getUrl("entities-handler-getUsersAndEvents"),t)},getUsers:function(e){e.caseId;return $.read({url:this.serviceLocator.getUrl("entities-handler-getUsers"),data:e,batchRequest:!0})},getEvents:function(e){e.caseId;return $.read({url:this.serviceLocator.getUrl("entities-handler-getEvents"),data:e,batchRequest:!0})},getUsersImages:function(e,t){var i={},r=this.serviceLocator.getUrl("entities-handler-getUsersImages");return t&&t.length>0&&(i.userIds=t.toString()),i.width=e.width,i.height=e.height,i.square=e.square,bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:r,data:i,type:"POST",dataType:"json"}):$.read({url:r,data:i,dataType:"json"})},getPreferencesCurrentUser:function(){var e=this.serviceLocator.getUrl("currentUser");return $.ajax({url:e,type:"GET"})},getPreferencesWorkportalCurrentUser:function(){return $.read(this.serviceLocator.getUrl("PreferencesWorkportalCurrentUser"))},getShortCuts:function(e){var t={},i=this.serviceLocator.getUrl("entities-handler-getShotCuts");return void 0!==e.icon&&e.icon&&(t.icon=!0),$.read(i,t)},getSearchLists:function(){return $.read(this.serviceLocator.getUrl("my-search-getSearchLists"),{})},getIdCasesOfProcessEntities:function(e){e=e||{};var t={ids:JSON.stringify(e)};return bizagi.version.server.lessThanOrEqualsTo("11.0.0.2608")?$.read({url:this.serviceLocator.getUrl("process-handler-getIdCasesOfProcessEntities"),data:t}):$.ajax({url:this.serviceLocator.getUrl("process-handler-getIdCasesOfProcessEntities"),data:t,type:"POST"})},getQueryForm:function(e){return e=e||{},$.ajax({url:this.serviceLocator.getUrl("query-handler-getQueryForm"),data:e,type:"POST",dataType:e.dataType||"json"})},defineFilterObject:function(e,t,i){var r=e.properties,a=r.xpath.split("@")[0],n=t.find((function(e){return e.xpath==a}));if(n){if("from"==r.rangeQuery)n.value=n.value||{},n.searchType="range",n.value.min=e.value;else if("to"==r.rangeQuery)n.value=n.value||{},n.searchType="range",n.value.max=e.value;else{e.properties.typeSearch=n.searchType;var o=l(e);$.extend(n,o)}r.orderType&&(n.orderType=r.orderType),i&&i(bizagi.clone(n))}else{var s=r.defaultFilter||!1;n=l(e),r.orderType&&(n.orderType=r.orderType),(void 0!==n.value||n.orderType||s)&&(t.push(n),i&&i(bizagi.clone(n)))}function l(e){var t=e.properties,i=t.typeSearch,r=e.value;if("boolean"==t.type&&("null"===r.toLowerCase()?(r=null,i="Nullable"):(r=bizagi.util.parseBoolean(r),i="exact")),"number"!=t.type&&"money"!=t.type&&"date"!=t.type||(i="exact"),"object"==_typeof(e.value)){if(r=[],Array.isArray(e.value))for(var n=0,o=e.value.length;n<o;n++){var s=parseInt(e.value[n].id);isNaN(s)||r.push(s)}else{s=parseInt(e.value.id);isNaN(s)||r.push(s)}i="exact",r=r.length>0?r:void 0}t.rangeQuery&&"none"!==t.rangeQuery&&(r={min:e.value,max:e.value},i="range");var l={xpath:a,searchType:i=i||"approx"};return void 0!==r&&(l.value=r),l}},getPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getActivities:function(e){var t=this.serviceLocator.getUrl("project-plan-activities");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},updatePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-update");return $.update({url:t.replace("{idPlan}",e.id),data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},putExecutePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-execute");return $.create({url:t,data:e,contentType:"application/x-www-form-urlencoded"})},deletePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-delete");return $.destroy({url:t.replace("{idPlan}",e.id),data:e,contentType:"application/x-www-form-urlencoded"})},closePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-close");return $.create({url:t,data:e,contentType:"application/x-www-form-urlencoded"})},getWorkitemsPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-workitems");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getTransitionsByPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-transitions-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},editActivityPlan:function(e){var t={};e.activity?(t=e.activity).items=e.items:t=e;var i=this.serviceLocator.getUrl("project-plan-activity-edit").replace("{idPlan}",t.idPlan).replace("{id}",t.id);return $.update({url:i,data:JSON.stringify(t),dataType:"json",contentType:"application/json"})},getPlanByParent:function(e){var t=this.serviceLocator.getUrl("project-plan-get-by-parent"),i=$.Deferred();return $.when($.read({url:t,data:e,dataType:"json",contentType:"application/json"})).done((function(e){i.resolve(e)})),i.promise()},getItemsByActivity:function(e){var t=this.serviceLocator.getUrl("project-plan-activity-tasks-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getPlanParent:function(e){var t=this.serviceLocator.getUrl("project-plan-parent");return $.read({url:t,data:e,dataType:"json"})},serializeEntityData:function(e){var t=e;function i(e,t){var i={data:{},guid:t.guidEntity,timestamp:e.timestamp},r=e.columns,a=t.row;for(name in t)t.hasOwnProperty(name)&&"row"!==name.toString()&&"id"!==name.toString()&&(i[name]=t[name]);for(var n=0,o=r.length;n<o;n+=1)i.data[r[n]]=a[n];return i}t.entities=[];for(var r,a=-1;r=e.rows[++a];)for(var n,o=-1;n=e.cells[++o];)if(n.id===r.id){var s=i(n,r);t.entities.push(s);break}return t},getCardViewCustomizedColumns:function(e){return(e=e||{}).sortData=bizagi.util.getLastProcessInboxSort(),this.getMobileActivities(e)},getMobileActivities:function(e){var t=this,i=t.serviceLocator.getUrl("case-handler-getActivityList"),r=e||{},a=e.sortData;a&&(bizagi.util.isMobileInboxByProcessSupported()&&a.sortOrder&&a.sortDirection&&a.sortFieldName?(r.orderFieldName=a.sortFieldName,r.orderType="asc"==a.sortDirection?0:1,r.order=a.sortOrder):delete r.sortData),void 0!==e.radNumber&&(r.radNumber=e.radNumber),-1!=e.idWfClass&&(r.idWfClass=e.idWfClass),r.mobileDevice=bizagi.util.isMobileDevice(),r.page=r.page||1,r.pageSize=r.pageSize||10,null!=r.idWfClass&&r.idWfClass<0&&delete r.idWfClass,e.smartInboxId&&(r.smartInboxGuid=e.smartInboxId),e.liveFilterData&&(r.smartInboxFilter=t.encodeLiveFilter(e.liveFilterData),delete e.liveFilterData);var n,o={url:i,data:r,type:"GET",dataType:"json"};return e.avoidLoader&&(o.avoidLoader=!0,delete r.avoidLoader),$.ajax(o).then((function(i){return bizagi.util.setLastProcessInboxProcessColumns(i.headers),n=i,e.includeSyncErrors&&"inbox"==e.inputtray?t.getInboxSyncErrors():void 0})).then((function(e){return null!=e&&(n.syncErrors=e),n}))},encodeLiveFilter:function(e){var t,i,r="",a=a||function(e,t){var i={},r=i.lib={},a=function(){},n=r.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var a=0;a<e;a++)t[r+a>>>2]|=(i[a>>>2]>>>24-a%4*8&255)<<24-(r+a)%4*8;else if(65535<i.length)for(a=0;a<e;a+=4)t[r+a>>>2]=i[a>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],r=0;r<t;r+=4)i.push(4294967296*e.random()|0);return new o.init(i,t)}}),s=i.enc={},l=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],r=0;r<e;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],r=0;r<t;r+=2)i[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(i,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],r=0;r<e;r++)i.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],r=0;r<t;r++)i[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(i,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,r=i.words,a=i.sigBytes,n=this.blockSize,s=a/(4*n);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*n,a=e.min(4*t,a),t){for(var l=0;l<t;l+=n)this._doProcessBlock(r,l);l=r.splice(0,t),i.sigBytes-=a}return new o.init(l,a)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new g.HMAC.init(e,i).finalize(t)}}});var g=i.algo={};return i}(Math);i=(t=a).lib.WordArray,t.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,r=this._map;e.clamp(),e=[];for(var a=0;a<i;a+=3)for(var n=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;4>o&&a+.75*o<i;o++)e.push(r.charAt(n>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(a=r.charAt(64))&&-1!=(a=e.indexOf(a))&&(t=a);for(var a=[],n=0,o=0;o<t;o++)if(o%4){var s=r.indexOf(e.charAt(o-1))<<o%4*2,l=r.indexOf(e.charAt(o))>>>6-o%4*2;a[n>>>2]|=(s|l)<<24-n%4*8,n++}return i.create(a,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){function t(e,t,i,r,a,n,o){return((e=e+(t&i|~t&r)+a+o)<<n|e>>>32-n)+t}function i(e,t,i,r,a,n,o){return((e=e+(t&r|i&~r)+a+o)<<n|e>>>32-n)+t}function r(e,t,i,r,a,n,o){return((e=e+(t^i^r)+a+o)<<n|e>>>32-n)+t}function n(e,t,i,r,a,n,o){return((e=e+(i^(t|~r))+a+o)<<n|e>>>32-n)+t}for(var o=a,s=(c=o.lib).WordArray,l=c.Hasher,c=o.algo,u=[],d=0;64>d;d++)u[d]=4294967296*e.abs(e.sin(d+1))|0;c=c.MD5=l.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,a){for(var o=0;16>o;o++){var s=e[l=a+o];e[l]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}o=this._hash.words;var l=e[a+0],c=(s=e[a+1],e[a+2]),d=e[a+3],g=e[a+4],p=e[a+5],m=e[a+6],f=e[a+7],h=e[a+8],v=e[a+9],b=e[a+10],y=e[a+11],z=e[a+12],x=e[a+13],w=e[a+14],C=e[a+15],S=t(S=o[0],T=o[1],P=o[2],A=o[3],l,7,u[0]),A=t(A,S,T,P,s,12,u[1]),P=t(P,A,S,T,c,17,u[2]),T=t(T,P,A,S,d,22,u[3]);S=t(S,T,P,A,g,7,u[4]),A=t(A,S,T,P,p,12,u[5]),P=t(P,A,S,T,m,17,u[6]),T=t(T,P,A,S,f,22,u[7]),S=t(S,T,P,A,h,7,u[8]),A=t(A,S,T,P,v,12,u[9]),P=t(P,A,S,T,b,17,u[10]),T=t(T,P,A,S,y,22,u[11]),S=t(S,T,P,A,z,7,u[12]),A=t(A,S,T,P,x,12,u[13]),P=t(P,A,S,T,w,17,u[14]),S=i(S,T=t(T,P,A,S,C,22,u[15]),P,A,s,5,u[16]),A=i(A,S,T,P,m,9,u[17]),P=i(P,A,S,T,y,14,u[18]),T=i(T,P,A,S,l,20,u[19]),S=i(S,T,P,A,p,5,u[20]),A=i(A,S,T,P,b,9,u[21]),P=i(P,A,S,T,C,14,u[22]),T=i(T,P,A,S,g,20,u[23]),S=i(S,T,P,A,v,5,u[24]),A=i(A,S,T,P,w,9,u[25]),P=i(P,A,S,T,d,14,u[26]),T=i(T,P,A,S,h,20,u[27]),S=i(S,T,P,A,x,5,u[28]),A=i(A,S,T,P,c,9,u[29]),P=i(P,A,S,T,f,14,u[30]),S=r(S,T=i(T,P,A,S,z,20,u[31]),P,A,p,4,u[32]),A=r(A,S,T,P,h,11,u[33]),P=r(P,A,S,T,y,16,u[34]),T=r(T,P,A,S,w,23,u[35]),S=r(S,T,P,A,s,4,u[36]),A=r(A,S,T,P,g,11,u[37]),P=r(P,A,S,T,f,16,u[38]),T=r(T,P,A,S,b,23,u[39]),S=r(S,T,P,A,x,4,u[40]),A=r(A,S,T,P,l,11,u[41]),P=r(P,A,S,T,d,16,u[42]),T=r(T,P,A,S,m,23,u[43]),S=r(S,T,P,A,v,4,u[44]),A=r(A,S,T,P,z,11,u[45]),P=r(P,A,S,T,C,16,u[46]),S=n(S,T=r(T,P,A,S,c,23,u[47]),P,A,l,6,u[48]),A=n(A,S,T,P,f,10,u[49]),P=n(P,A,S,T,w,15,u[50]),T=n(T,P,A,S,p,21,u[51]),S=n(S,T,P,A,z,6,u[52]),A=n(A,S,T,P,d,10,u[53]),P=n(P,A,S,T,b,15,u[54]),T=n(T,P,A,S,s,21,u[55]),S=n(S,T,P,A,h,6,u[56]),A=n(A,S,T,P,C,10,u[57]),P=n(P,A,S,T,m,15,u[58]),T=n(T,P,A,S,x,21,u[59]),S=n(S,T,P,A,g,6,u[60]),A=n(A,S,T,P,y,10,u[61]),P=n(P,A,S,T,c,15,u[62]),T=n(T,P,A,S,v,21,u[63]),o[0]=o[0]+S|0,o[1]=o[1]+T|0,o[2]=o[2]+P|0,o[3]=o[3]+A|0},_doFinalize:function(){var t=this._data,i=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;i[a>>>5]|=128<<24-a%32;var n=e.floor(r/4294967296);for(i[15+(a+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),i[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(i.length+1),this._process(),i=(t=this._hash).words,r=0;4>r;r++)a=i[r],i[r]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return t},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=l._createHelper(c),o.HmacMD5=l._createHmacHelper(c)}(Math),function(){var e,t=a,i=(e=t.lib).Base,r=e.WordArray,n=(e=t.algo).EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=(s=this.cfg).hasher.create(),a=r.create(),n=a.words,o=s.keySize,s=s.iterations;n.length<o;){l&&i.update(l);var l=i.update(e).finalize(t);i.reset();for(var c=1;c<s;c++)l=i.finalize(l),i.reset();a.concat(l)}return a.sigBytes=4*o,a}});t.EvpKDF=function(e,t,i){return n.create(i).compute(e,t)}}(),a.lib.Cipher||function(e){var t=(m=a).lib,i=t.Base,r=t.WordArray,n=t.BufferedBlockAlgorithm,o=m.enc.Base64,s=m.algo.EvpKDF,l=t.Cipher=n.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,i,r){return("string"==typeof i?f:p).encrypt(e,t,i,r)},decrypt:function(t,i,r){return("string"==typeof i?f:p).decrypt(e,t,i,r)}}}});t.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=m.mode={},u=function(e,t,i){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var a=0;a<i;a++)e[t+a]^=r[a]},d=(t.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();d.Encryptor=d.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize;u.call(this,e,t,r),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),d.Decryptor=d.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize,a=e.slice(t,t+r);i.decryptBlock(e,t),u.call(this,e,t,r),this._prevBlock=a}}),c=c.CBC=d,d=(m.pad={}).Pkcs7={pad:function(e,t){for(var i,a=(i=(i=4*t)-e.sigBytes%i)<<24|i<<16|i<<8|i,n=[],o=0;o<i;o+=4)n.push(a);i=r.create(n,i),e.concat(i)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=l.extend({cfg:l.cfg.extend({mode:c,padding:d}),reset:function(){l.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var g=t.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),p=(c=(m.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(o)},parse:function(e){var t=(e=o.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var i=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return g.create({ciphertext:e,salt:i})}},t.SerializableCipher=i.extend({cfg:i.extend({format:c}),encrypt:function(e,t,i,r){r=this.cfg.extend(r);var a=e.createEncryptor(i,r);return t=a.finalize(t),a=a.cfg,g.create({ciphertext:t,key:i,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(i,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),m=(m.kdf={}).OpenSSL={execute:function(e,t,i,a){return a||(a=r.random(8)),e=s.create({keySize:t+i}).compute(e,a),i=r.create(e.words.slice(t),4*i),e.sigBytes=4*t,g.create({key:e,iv:i,salt:a})}},f=t.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:m}),encrypt:function(e,t,i,r){return i=(r=this.cfg.extend(r)).kdf.execute(i,e.keySize,e.ivSize),r.iv=i.iv,(e=p.encrypt.call(this,e,t,i.key,r)).mixIn(i),e},decrypt:function(e,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),i=r.kdf.execute(i,e.keySize,e.ivSize,t.salt),r.iv=i.iv,p.decrypt.call(this,e,t,i.key,r)}})}(),function(){for(var e=a,t=e.lib.BlockCipher,i=e.algo,r=[],n=[],o=[],s=[],l=[],c=[],u=[],d=[],g=[],p=[],m=[],f=0;256>f;f++)m[f]=128>f?f<<1:f<<1^283;var h=0,v=0;for(f=0;256>f;f++){var b=(b=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&b^99;r[h]=b,n[b]=h;var y=m[h],z=m[y],x=m[z],w=257*m[b]^16843008*b;o[h]=w<<24|w>>>8,s[h]=w<<16|w>>>16,l[h]=w<<8|w>>>24,c[h]=w,w=16843009*x^65537*z^257*y^16843008*h,u[b]=w<<24|w>>>8,d[b]=w<<16|w>>>16,g[b]=w<<8|w>>>24,p[b]=w,h?(h=y^m[m[m[x^y]]],v^=m[m[v]]):h=v=1}var C=[0,1,2,4,8,16,32,64,128,27,54];i=i.AES=t.extend({_doReset:function(){for(var e=(i=this._key).words,t=i.sigBytes/4,i=4*((this._nRounds=t+6)+1),a=this._keySchedule=[],n=0;n<i;n++)if(n<t)a[n]=e[n];else{var o=a[n-1];n%t?6<t&&4==n%t&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o]):(o=r[(o=o<<8|o>>>24)>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o],o^=C[n/t|0]<<24),a[n]=a[n-t]^o}for(e=this._invKeySchedule=[],t=0;t<i;t++)n=i-t,o=t%4?a[n]:a[n-4],e[t]=4>t||4>=n?o:u[r[o>>>24]]^d[r[o>>>16&255]]^g[r[o>>>8&255]]^p[r[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,l,c,r)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,u,d,g,p,n),i=e[t+1],e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,r,a,n,o,s){for(var l=this._nRounds,c=e[t]^i[0],u=e[t+1]^i[1],d=e[t+2]^i[2],g=e[t+3]^i[3],p=4,m=1;m<l;m++){var f=r[c>>>24]^a[u>>>16&255]^n[d>>>8&255]^o[255&g]^i[p++],h=r[u>>>24]^a[d>>>16&255]^n[g>>>8&255]^o[255&c]^i[p++],v=r[d>>>24]^a[g>>>16&255]^n[c>>>8&255]^o[255&u]^i[p++];g=r[g>>>24]^a[c>>>16&255]^n[u>>>8&255]^o[255&d]^i[p++],c=f,u=h,d=v}f=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&g])^i[p++],h=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[g>>>8&255]<<8|s[255&c])^i[p++],v=(s[d>>>24]<<24|s[g>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^i[p++],g=(s[g>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^i[p++],e[t]=f,e[t+1]=h,e[t+2]=v,e[t+3]=g},keySize:8}),e.AES=t._createHelper(i)}();try{r=JSON.encode(e)}catch(i){r=JSON.encode("[]")}var n=a.enc.Utf8.parse(r);return a.enc.Base64.stringify(n)},includeAllProcessesItem:function(e){var t={idworkflow:"-1",guidWFClass:"-1",name:bizagi.localization.getResource("workportal-widget-inbox-all-processes"),path:"App/",count:0,isFavorite:"false",icon:"",category:"Processes",guidFavorite:"",orderValue:String.fromCharCode(0)};e.workflows&&($.each(e.workflows.workflow,(function(i,r){e.workflows.workflow[i].orderValue=e.workflows.workflow[i].name,t.count+=Number(r.count)})),e.workflows.workflow.unshift(t))},isInboxSystemHeaderSortable:function(e,t,i){var r=!1,a={};if("detailView"===i?a={radnumber:!0,wiestimatedsolutiondate:!0,isfavorite:!0,currenttask:!0,wfclsdisplayname:!0}:"cardView"===i&&(a={radnumber:!0,wiestimatedsolutiondate:!0,isfavorite:!0,currenttask:!0,wfclsdisplayname:!0,taskstate:!0}),a.wfclsdisplayname){var n=null!=t.smartInboxId&&null!=t.smartInboxId&&"wfclsdisplayname"==e.fieldName&&!e.isSmartInbox;(-1!=t.idWorkflow||n)&&(a.wfclsdisplayname=!1)}e&&e.fieldName&&(a[e.fieldName.toLowerCase()]&&(e.order||e.fieldFilterName)&&(r=!0));return r},isInboxHeaderASystemColumn:function(e){return{taskstate:!0,taskstateColor:!0,radnumber:!0,wfclsdisplayname:!0,currenttask:!0,cascreationdate:!0,wiestimatedsolutiondate:!0,cassolutiondate:!0,idcase:!0,idworkitem:!0,taskid:!0,atrisktime:!0,currentuser:!0,currentfullname:!0,fieldName:!0,idwfclass:!0,isfavorite:!0,guidfavorite:!0,creatorfullname:!0}[e.toLowerCase()]||!1},validateCustomColumn:function(e,t,i){var r={isValid:!1,selectedColumnsCount:i};return i<t&&(e.isSmartInbox||e.isCustomColumn)&&(r.isValid=!0,r.selectedColumnsCount=i+1),r},configureGlobalHandlers:function(){var e=this;$(document).off("openForm.services"),$(document).on("openForm.services",(function(t,i){e.activeForm=i.form})),$(document).off("disposeForm.services"),$(document).on("disposeForm.services",(function(t,i){e.activeForm=void 0}))},getAllSmartInbox:function(){return $.read({url:this.serviceLocator.getUrl("smartinbox-getAllInbox"),data:{}})},getSpecificSmartInbox:function(e){var t=this.serviceLocator.getUrl("smartinbox-specific-inbox").replace("{settingName}",e.settingName);return t=(t=t.replace("{owner}",e.owner)).replace("{smartInboxId}",e.smartInboxId),$.read({url:t,data:{}})},getAllProcessesSmartInbox:function(e){return $.read({url:this.serviceLocator.getUrl("smartinbox-processes"),data:{}})},getAllCustomizedColumnsSmartInbox:function(e){var t=JSON.stringify(e);return $.ajax({url:this.serviceLocator.getUrl("smartinbox-customized-columns"),data:t,type:"POST",dataType:"json",contentType:"application/json"})},createSmartInbox:function(e){var t=JSON.stringify(e);return $.ajax({url:this.serviceLocator.getUrl("smartinbox-createinbox"),data:t,type:"POST",dataType:"json",contentType:"application/json"})},updateSmartInbox:function(e,t){var i=JSON.stringify(t),r=this.serviceLocator.getUrl("smartinbox-specific-inbox").replace("{settingName}",e.settingName);return r=(r=r.replace("{owner}",e.owner)).replace("{smartInboxId}",e.smartInboxId),$.ajax({url:r,data:i,type:"PUT",dataType:"json",contentType:"application/json"})},deleteSmartInbox:function(e){var t=this.serviceLocator.getUrl("smartinbox-specific-inbox").replace("{settingName}",e.settingName);return t=(t=t.replace("{owner}",e.owner)).replace("{smartInboxId}",e.smartInboxId),$.ajax({url:t,type:"DELETE",dataType:"json",contentType:"application/json"})},shareSmartInbox:function(e,t){var i=JSON.stringify(t),r=this.serviceLocator.getUrl("smartinbox-share").replace("{smartInboxId}",e.smartInboxId);return $.ajax({url:r,data:i,type:"POST",dataType:"json",contentType:"application/json"})},getEntityValuesForInboxFilter:function(e){var t=this.serviceLocator.getUrl("smartinbox-entity-values");return t=t.replace("{entityGuid}",e.entityGuid),$.ajax({url:t,type:"GET",dataType:"json",contentType:"application/json"})},getUserTasksForInboxFilter:function(e){var t="";return t=e.isSmartInbox?(t=this.serviceLocator.getUrl("smartinbox-user-tasks")).replace("{smartInboxId}",e.id):(t=this.serviceLocator.getUrl("smartinbox-user-tasks-process")).replace("{workflowId}",e.id),$.ajax({url:t,type:"GET",dataType:"json",contentType:"application/json"})},callServiceWithNetworkRetries:function(e,t,i,r,a,n,o){var s=this;o=o||$.Deferred();return n=isNaN(n)?0:n,r=isNaN(r)?1:r,a=isNaN(a)?100:a,n>=r?(console.error("Max retries reached"),void o.reject("Max retries reached")):($.when(t.apply(e,i)).then((function(e){o.resolve(e)})).fail((function(l){0===l.status?setTimeout((function(){s.callServiceWithNetworkRetries(e,t,i,r,a,n+1,o)}),a):o.reject(l)})),o.promise())},getAndSaveMobileFeaturesFromBizagiConfig:function(){bizagi.util.validateIfSaveMobileFeaturesIsEnabled()&&$.when(this.getConfiguration()).then((function(e){e&&e.features&&bizagi.util.storeMobileFeatures(e.features)}))}}),$.Class.extend("bizagi.workportal.services.routing",{BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm"},{init:function(e){e=e||{},this.params=e.params||{},this.dataService=e.dataService||{},this.modules={render:"activityform",oldRender:"oldrenderintegration",async:"async",activitySelector:"routing"},this.renderVersion=2,this.resetRouteInformation()},resetRouteInformation:function(){this.route={module:"",moduleParams:{}}},setRenderParams:function(e){this.params=this.getRenderParams(e)},getRenderParams:function(e){var t,i=(t={idCase:parseInt(e.idCase||0),idWorkflow:parseInt(e.idWorkflow||0),idWorkitem:e.idWorkitem||e.idWorkItem||0,idTask:parseInt(e.idTask||0),eventAsTasks:e.eventAsTasks||!1,onlyUserWorkItems:e.onlyUserWorkItems||"true",formsRenderVersion:e.formsRenderVersion||0,referrer:e.referrer||"",isComplex:void 0!==e.isComplex},_defineProperty(t,"formsRenderVersion",2),_defineProperty(t,"onClose",e.onClose||""),_defineProperty(t,"isOfflineForm",e.isOfflineForm||!1),_defineProperty(t,"radNumber",e.radNumber||null),_defineProperty(t,"offlineType",e.offlineType||null),t),r=!0;try{r=BIZAGI_SETTINGS.skipSubprocessGlobalForm||!0}catch(e){}return this.skipSubprocessGlobalForm="true"==r,i},getRoute:function(e){var t=this,i=new $.Deferred;t.params=e||t.params;var r=e.fromTask||e.idTask||"",a=e.fromWorkItemId||e.idWorkitem||e.idWorkItem||"";return $.when(t.getRenderVersion(t.params)).done((function(n){t.renderVersion=n,t.route.moduleParams=t.getRenderParams(t.params),$.when(t.dataService.getWorkitems({idCase:t.params.idCase,onlyUserWorkItems:t.params.onlyUserWorkItems,isOfflineForm:t.params.isOfflineForm,fromTask:r,fromWorkItemId:a})).done((function(r){var a=r.workItems.length;if(t.route.moduleParams.hasWorkItems=!!a,t.route.moduleParams.isEvent=t.params.isEvent||!1,t.route.moduleParams.hasGlobalForm=bizagi.util.parseBoolean(r.hasGlobalForm),bizagi.util.isEmpty(r.idWfClass)||(t.route.moduleParams.idWfClass=r.idWfClass),!0===t.params.hasSyncError&&null!=t.params.syncError&&t.includeSyncErrorIntoModuleparams(t.params.syncError),t.route.moduleParams.idWorkitem>0){t.setRenderModuleName(t.getRenderModuleName(n)),0===t.route.moduleParams.idTask&&(t.route.moduleParams.idTask=t.searchIdTask(t.route.moduleParams.idWorkitem)),t.route.moduleParams.radNumber=bizagi.util.isEmpty(e.radNumber)?r.radNumber||"":e.radNumber,t.route.moduleParams.idWorkflow=r.idWorkFlow||"";var o=r.workItems.find((function(e){return Number(e.idWorkItem)===Number(t.route.moduleParams.idWorkitem)}));null!=o&&(null!=o.displayName&&(t.route.moduleParams.displayName=o.displayName),t.route.moduleParams.mobileAccess=!(!1===o.mobileAccess),t.route.moduleParams.forceOffline=!0===o.forceOffline,t.route.moduleParams.workitemstate=e.workitemstate),t.getSyncError(t.route.moduleParams).then((function(e){null!=e&&t.includeSyncErrorIntoModuleparams(e)})).always((function(){i.resolve(t.route),t.resetRouteInformation()}))}else{var s=t.checkAsyncWorkItems(r);if(0===a)t.route.moduleParams.idWorkflow=r.idWorkFlow||"",t.route.moduleParams.radNumber=r.radNumber||"",""!==$.trim(r.msgTask)?i.resolve(t.routeToMessageForm(r.msgTask)):bizagi.util.parseBoolean(r.hasGlobalForm)?(t.route.moduleParams.displayName=null,i.resolve(t.routeToGlobalForm(r))):i.resolve(t.routeToGlobalFormWithoutData());else if(1===a||s.length>0){var l=0;if(s.length>0)for(var c=0;c<a;c++)if("true"==r.workItems[c].isAsynch){l=c;break}t.route.moduleParams.idCase=r.workItems[l].idCase,t.route.moduleParams.idTask=r.workItems[l].idTask,t.route.moduleParams.fromTask=r.workItems[l].idTask,t.route.moduleParams.idWorkitem=r.workItems[l].idWorkItem,t.route.moduleParams.idWorkflow=r.workItems[l].idWorkFlow,t.route.moduleParams.displayName=r.workItems[l].displayName?r.workItems[l].displayName:"",t.route.moduleParams.radNumber=r.radNumber||"",t.route.moduleParams.mobileAccess=!(!1===r.workItems[l].mobileAccess),t.route.moduleParams.forceOffline=!0===r.workItems[l].forceOffline,s.length>0?t.setRenderModuleName(t.modules.async):t.setRenderModuleName(t.getRenderModuleName(n)),t.getSyncError(t.route.moduleParams).then((function(e){null!=e&&t.includeSyncErrorIntoModuleparams(e)})).always((function(){i.resolve(t.route),t.resetRouteInformation()}))}else r.checkProcess=!!(r.subProcesses.length>0&&t.skipSubprocessGlobalForm),r.checkWorkItems=a>1,r.fromSearchWidget="search"==t.params.referrer,t.setRenderModuleName(t.modules.activitySelector),t.route.moduleParams.data=r,i.resolve(t.route),t.resetRouteInformation()}})).fail((function(e){var r=bizagi.localization.getResource("workportal-menu-search-found-no-cases");i.resolve(t.routeToMessageForm(r))}))})).fail((function(e,t,r){i.reject()})),i.promise()},setRenderModuleName:function(e){this.route.module=e,this.route.moduleParams.widgetName=e},getRenderModuleName:function(e){return 1==e?this.modules.oldRender:this.modules.render},searchIdTask:function(e,t){for(var i=0,r=0,a=(e=e||[]).length;r<a;r++)if(parseInt(e[r].idWorkItem)==parseInt(t)){i=parseInt(e[r].idTask);break}return i},checkAsyncWorkItems:function(e){var t=[];return $.each(e.workItems,(function(i){"true"==e.workItems[i].isAsynch&&t.push({idCase:e.idCase,idWorkitem:e.workItems[i].idWorkItem,idTask:e.workItems[i].idTask})})),t},routeToGlobalForm:function(e){if(this.route.moduleParams.idCase=$.isNumeric(e.idCaseForGlobalForm)&&e.idCaseForGlobalForm>0?e.idCaseForGlobalForm:this.route.moduleParams.idCase,this.route.moduleParams.idWorkflow=parseInt(e.idWorkFlow||0),1==this.renderVersion){var t=printf(this.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s",this.route.moduleParams.idCase||"",this.route.moduleParams.idWorkitem||"",this.route.moduleParams.idTask||"");this.route.moduleParams.onlyUserWorkItems=this.route.moduleParams.idCase||"",this.setRenderModuleName(this.modules.oldRender),this.route.moduleParams.url=t}else this.setRenderModuleName(this.modules.render);return this.route},routeToGlobalFormWithoutData:function(){return this.setRenderModuleName(this.modules.render),this.route.moduleParams.withOutGlobalForm=!0,this.route},routeToMessageForm:function(e){return e=e||"",this.setRenderModuleName(this.modules.render),this.route.moduleParams.withOutGlobalForm=!0,this.route.moduleParams.messageForm=e,this.route},getRenderVersion:function(e){var t=new $.Deferred,i=e.formsRenderVersion||0;return 0!=i?t.resolve(i):$.when(this.dataService.getCaseFormsRenderVersion({idCase:e.idCase})).done((function(e){i=parseInt(e.formsRenderVersion),t.resolve(i)})).fail((function(e,i,r){t.reject()})),t.promise()},getSyncError:function(e){return bizagi.util.isOfflineErrorsViewSupported()&&"start"!=e.offlineType&&null==this.route.moduleParams.syncError?this.dataService.getTaskSyncError(e):$.Deferred().resolve(void 0).promise()},includeSyncErrorIntoModuleparams:function(e){if(bizagi.util.isOfflineErrorsViewSupported()){this.route.moduleParams.hasSyncError=!0,this.route.moduleParams.syncError=e,this.route.moduleParams.offlineType="start"==this.params.offlineType?"start":"task",this.route.moduleParams.idEdited=!0,this.route.moduleParams.isOfflineForm=!0,this.route.moduleParams.isOfflineErrorMode=!0}}}),$.Class.extend("bizagi.mashup.facade",{},{init:function(e){switch(bizagi.loading.start(),this.initialized=!1,this.defaultParams=e||{},this.defaultParams.authentication=this.defaultParams.authentication||{},this.defaultParams.authentication.type=this.defaultParams.authentication.type||"OAuth",this.deviceFactory=new bizagi.mashup.device.factory(this,e),this.dataService=new bizagi.workportal.services.service(e),this.defaultParams.authentication.type){case"OAuth":this.authenticator=new bizagi.mashup.authentication.oauth(this,this.defaultParams.authentication);break;case"Basic":this.authenticator=new bizagi.mashup.authentication.basic(this,this.defaultParams.authentication);break;default:this.authenticator=new bizagi.mashup.authentication.bizagi(this,this.defaultParams.authentication)}this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService}),this.execute().then((function(){bizagi.loading.stop()})),$.when(this.dataService.getCurrentUser()).done((function(e){bizagi.currentUser=e}))},execute:function(){var e=this,t=e.defaultParams.canvas||$("body");return e.initialized?e.ready():(e.executionDeferred=new $.Deferred,this.deviceFacade=e.deviceFactory.getMashupFacade(e.dataService),this.deviceFacade.then((function(i){return e.mashupFacade=i,e.controller=i.getMainController({canvas:t,layoutHeader:e.defaultParams.showHeader||!1}),e.controller.render().then((function(){e.initialized=!0,e.executionDeferred.resolve()}))})))},ready:function(){return this.executionDeferred.promise()},navigate:function(e,t){var i=this;$.when(i.executionDeferred).then((function(){i.mashupFacade.navigate(e,t,!0)}))},renderCase:function(e){var t=this;t.ready().then((function(){void 0!==t.controller?(t.controller.publish("renderCase",e),t.navigate("#render"),"function"==typeof t.defaultParams.onRender&&t.defaultParams.onRender.apply(this,arguments)):bizagi.log("Sorry we're not ready yet, please try again")}))},hideInternalHeader:function(){var e=this;e.ready().then((function(){void 0!==e.controller?e.controller.publish("toggleHeader",{showHeader:!1}):bizagi.log("Sorry we're not ready yet, please try again")}))},logoutUser:function(){void 0!==this.authenticator.getUser()?this.authenticator.logout():console.log("there's not a user authenticated")},showInternalHeader:function(){var e=this;e.ready().then((function(){void 0!==e.controller?e.controller.publish("toggleHeader",{showHeader:!0}):bizagi.log("Sorry we're not ready yet, please try again")}))},authenticateUser:function(e){return this.authenticator.authenticateUser(e)},setAccessToken:function(e){"OAuth"==this.defaultParams.authentication.type?this.authenticator.setAccessToken({accessToken:e}):console.log("this call will not have any effect")},showSummaryCase:function(e){var t=this;e=e||{},void 0!==t.authenticator.getUser()?t.ready().then((function(){void 0!==t.controller?t.controller.publish("showSummary",e):bizagi.log("No se ha ejecutado el mashup facade.")})):"function"==typeof t.defaultParams.onError&&t.defaultParams.onError("You must login to complete the action.")},createNewCase:function(e){var t=this;t.ready().then((function(){t.controller?t.controller.publish("createNewCase",e):bizagi.log("No se ha ejecutado el mashup facade.")}))},renderCaseSummary:function(e){var t=this;e=e||{},t.ready().then((function(){void 0!==t.controller?t.controller.publish("renderSummaryCase",e):bizagi.log("No se ha ejecutado el mashup facade")}))}}),$.Class.extend("bizagi.mashup.authentication",{},{init:function(e,t){this.facade=e,this.dataService=e.dataService,this.creationParams=t},authenticateUser:function(){},logout:function(){},getCurrentUser:function(){var e=this;return e.dataService.getCurrentUser().then((function(t){var i;t.userProperties={};for(var r=-1;i=t.sUserProperties[++r];)t.userProperties[i.key]=i.value;return e.currentUser=bizagi.currentUser=t,t}))},getUser:function(){return this.currentUser}}),bizagi.mashup.authentication.extend("bizagi.mashup.authentication.basic",{},{init:function(e,t){this._super(e,t)},authenticateUser:function(){}}),bizagi.mashup.authentication.extend("bizagi.mashup.authentication.bizagi",{},{init:function(e,t){var i=this;i._super(e,t),i.autologin=new jqAutoLogin({events:{logout:function(){},login:function(){},sessionExpiration:function(){return $.ajax({url:bizagiConfig.proxyPrefix+"Api/Authentication/User",crossDomain:!0,type:"POST",dataType:"json",data:i.data}).fail((function(e){i.facade.defaultParams.onError&&i.facade.defaultParams.onError(e)}))}}})},authenticateUser:function(e){var t=this;return t.data={user:e.user,password:e.password,domain:e.domain,loginOption:"AlwaysAsk"},$.ajax({url:bizagiConfig.proxyPrefix+"Api/Authentication/User",crossDomain:!0,type:"POST",dataType:"json",data:t.data}).then((function(e){if("true"===e.isAuthenticate)return t.autologin.login(t.data),t.getCurrentUser();throw"Authentication error"}))},logout:function(){var e=this;return $.ajax({url:bizagiConfig.proxyPrefix+"Rest/Authentication/logout",crossDomain:!0,type:"POST",dataType:"json"}).then((function(t){return e.autologin.logout(),delete e.currentUser,"Success logout"}))}}),bizagi.mashup.authentication.extend("bizagi.mashup.authentication.oauth",{},{init:function(e,t){var i=this;i._super(e,t),void 0!==t.refreshTokenCallback?(i.refreshTokenCallback=t.refreshTokenCallback,i.oauth2=new jqOAuth({tokenName:"bizagi.mashup.token",events:{logout:function(){},login:function(){},tokenExpiration:function(){var e=new $.Deferred;return i.refreshTokenCallback((function(t){i.oauth2.setAccessToken(t,""),e.resolve(t)}),(function(t){i.facade.defaultParams.onError&&i.facade.defaultParams.onError(t),e.reject(t)})),e.promise()}}})):i.facade.defaultParams.onError&&i.facade.defaultParams.onError("you should define a refresh callback to oauth authentication")},authenticateUser:function(e){return(e=e||{}).refreshToken=e.refreshToken||"",e.accessToken=e.accessToken||"",this.oauth2.login(e.accessToken,e.refreshToken),this.getCurrentUser()},setAccessToken:function(e){(e=e||{}).refreshToken=e.refreshToken||"",e.accessToken=e.accessToken||"",this.oauth2.hasAccessToken()?this.oauth2.setAccessToken(e.accessToken,e.refreshToken):console.log("It's necessary call the authenticateUser method before set a new Access Token")},logout:function(){this.oauth2.logout(),delete this.currentUser}}),$.Class.extend("bizagi.mashup.device.factory",{},{init:function(e,t){this.device=t.device||bizagi.detectDevice(),this.mashup=e,this.cachedFacade=null},getMashupFacade:function(e,t){var i=this,r=new $.Deferred;if(t=void 0===t||t,null!=i.cachedFacade)r.resolve(i.cachedFacade);else{if(bizagi.util.isTabletDevice())return i.cachedFacade=new bizagi.mashup.tablet.facade(this.mashup,e),$.when(i.cachedFacade.initAsyncStuff({device:this.device})).done((function(){r.resolve(i.cachedFacade)})),r.promise();if(bizagi.util.isSmartphoneDevice())return i.cachedFacade=new bizagi.mashup.smartphone.facade(this.mashup,e),$.when(i.cachedFacade.initAsyncStuff({device:this.device})).done((function(){r.resolve(i.cachedFacade)})),r.promise();alert("Not supported device: "+this.device),r.resolve("")}return r.promise()},getDataService:function(){return this.dataService}}),$.Class.extend("bizagi.mashup.smartphone.facade",{},{init:function(e,t){this.mashup=e,this.templates={},this.dataService=t,this.device=bizagi.detectDevice(),this.setMobileMetaTags(),bizagi.override.enableAutoSave=!0,bizagi.override.enableMSF?bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization):this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization)},setMobileMetaTags:function(){$("<meta>",{name:"apple-mobile-web-app-capable",content:"yes"}).appendTo("head"),$("<meta>",{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"}).appendTo("head"),$("<link>",{rel:"apple-touch-icon-precomposed",href:"jquery/common/base/css/smartphone/images/BizAgi_logo.png"}).appendTo("head"),$("<link>",{rel:"apple-touch-startup-image",href:"jquery/common/base/css/smartphone/images/splash.png"}).appendTo("head")},initAsyncStuff:function(){var e=this;return bizagi.enableCustomizations?$.when(bizagi.templateService.loadCustomTemplates().then((function(){return e.loadTemplates()})),bizagi.util.loadFile({src:bizagi.getStyleSheet("bizagi.overrides."+bizagi.detectDevice()+".custom.styles"),type:"css"}),bizagi.util.loadFile({src:bizagi.getJavaScript("bizagi.mashup."+bizagi.detectDevice()+".overrides"),type:"js"})):e.loadTemplates()},loadTemplates:function(){var e=this;return $.when(e.loadTemplate("home",bizagi.getTemplate("bizagi.mashup.common.home"))).then((function(){var t=new $.Deferred;return $("body").append(e.getTemplate("home")),bizagi.util.startkendo({started:function(){e.configureHomeHandlers(),t.resolve()}}),t.promise()}))},configureHomeHandlers:function(){var e=this;$(".bz-home-back","#home").click((function(t){e.close()}))},navigate:function(e,t,i){void 0!==i&&i?bizagi.kendoMobileApplication.replace(e,t):bizagi.kendoMobileApplication.bizagiNavigate(e,t)},close:function(){void 0!==this.mashup.defaultParams.onClose&&this.mashup.defaultParams.onClose()},loadTemplate:function(e,t){var i=this;return i.templateService.getTemplate(t,e).done((function(t){"string"==typeof t&&(i.templates[e]=$.trim(t.replace(/\n/g,"")))}))},getAction:function(e,t){return"routing"==e?new bizagi.mashup.actions.routing(this,this.dataService,t):(bizagi.log(e+" action not supported",t,"error"),null)},getTemplate:function(e){return this.templates[e]},getMainController:function(e){return new bizagi.mashup.controllers.main(this,this.dataService,e)},loadTemplateWebpart:function(e,t){var i=this;return i.templateService.getTemplateWebpart(t,e).done((function(t){i.templates[e]=$.trim(t.replace(/\n/g,""))}))}}),$.Class.extend("bizagi.mashup.controllers.controller",{},{init:function(e,t,i){this.mashupFacade=e,this.dataService=t,this.resources=bizagi.localization,this.componentContainers={},this.tmpl={},this.subscribers=[],this.disposed=!1,this.creationParams=i||{},this.canvas=this.creationParams.canvas||$("<div />")},navigate:function(e,t,i){this.mashupFacade.navigate(e,t,i)},publish:function(e,t){return this.disposed?null:$(document).triggerHandler(e,t)},subscribe:function(e,t){if(this.disposed)return null;var i=jQuery._data(document,"events")[e];if(i)for(var r=0,a=i.length;r<a;r++)if(i[r].handler.toString()===t.toString())return;$(document).bind(e,t),this.subscribers.push({event:e})},subscribeOneTime:function(e,t){if(this.disposed)return null;$(document).one(e,t),this.subscribers.push({event:e})},unsubscribe:function(e,t){if(this.disposed)return null;t?$(document).unbind(e,t):$(document).unbind(e)},render:function(e){var t=this,i=new $.Deferred;return void 0!==t.templatesDeferred?t.templatesDeferred.then((function(){t.internalRender(e).done((function(e){i.resolve(e)}))})):t.internalRender(e).done((function(e){i.resolve(e)})),i.promise()},configureHandlers:function(e){},internalRender:function(e){var t=this;return $.when(t.renderContent(e)).then((function(e){return t.content=e||"",t.canvas.append(e),t.postRender(),t.content}))},loadTemplates:function(e){var t=this.templatesDeferred=new $.Deferred,i=[],r=null==e.useNewEngine||e.useNewEngine;for(var a in e)"useNewEngine"!=a&&i.push(this.loadTemplate({name:a,path:e[a],useNewEngine:r}));return $.when.apply($,i).done((function(){t.resolve()})),t.promise()},loadTemplate:function(e){var t=this;return t.tmpl[e.name]?t.tmpl[e.name]:e.useNewEngine?bizagi.templateService.getTemplateWidget(e.path,e.name).done((function(i){t.tmpl[e.name]=i})):t.templateService.getTemplate(e.path,e.name).done((function(i){t.tmpl[e.name]=i}))},getTemplate:function(e){return this.tmpl.hasOwnProperty(e)?this.tmpl[e]:null},getContent:function(){return this.content},getResource:function(e){return this.resources.getResource(e)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(e){return"[data-bizagi-component="+e+"]"},getComponentContainer:function(e){var t=this.getContent();if(!t||0==t.length)return null;var i=this.componentContainers[e];return null==i&&(0==(i=$(this.getComponentSelector(e),t)).length&&t.is(this.getComponentSelector(e))&&(i=t),this.componentContainers[e]=i),this.componentContainers[e]},executeAction:function(e,t){t=t||{};var i=$.extend(t,{action:e});this.mashupFacade.getAction(i.action).execute(i)},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},resizeParent:function(e){var t=this;this.sendDimensionsToParent(e);var i=e[0];i.attachEvent?i.onresize=function(){t.sendDimensionsToParent(e)}:bizagi.addResizeListener(i,(function(i){t.sendDimensionsToParent(e)}))},sendDimensionsToParent:function(e){this.publish("mashup-resize-content",{height:e.outerHeight()})},dispose:function(){var e=this;e.disposed=!0,setTimeout((function(){null!=e.subscribers&&$.each(e.subscribers,(function(t,i){e.unsubscribe(i.event)})),bizagi.util.dispose(e)}),bizagi.override.disposeTime||50)}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.actions.routing",{},{execute:function(e){var t=this;t.params=e||{},$.when(t.dataService.routing.getRoute(e)).done((function(e){e=e||{};var i=!1;switch(void 0!==t.params&&(i=void 0!==t.params.isOfflineForm&&bizagi.util.parseBoolean(t.params.isOfflineForm)),e.moduleParams=i?$.extend(e.moduleParams,{formsRenderVersion:t.params.formsRenderVersion,isOfflineForm:i,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem})||{}:e.moduleParams||{},e.module){case"activityform":case"oldrenderintegration":t.publish("renderCase",e.moduleParams);break;case"async":t.publish("render-async",e.moduleParams);break;case"routing":var r={title:t.getResource("workportal-widget-routing-window-selector"),onClose:e.moduleParams.onClose};t.isThereAsync(e.moduleParams.data)?t.asyncWidget(e.moduleParams):t.publish("showDialog",{widgetName:"routing",data:e.moduleParams.data,modalParameters:r,onClose:r.onClose})}})).fail((function(e){t.publish("error",e)}))},isThereAsync:function(e){var t,i=e.workItems,r=0,a=i.length,n=!1;if(a>0)for(;r<a;)"true"===(t=i[r++]).isAsynch&&(n=n||[]).push(t);return n},asyncWidget:function(e){e.widgetName="async",this.publish("changeWidget",e)}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.main",{},{init:function(e,t,i){var r=this;r.componentRegex=/{{component (\w+)}}/g,this._super(e,t,i),this.subscribe("changeWidget",(function(e,t){$.when(bizagi.util.autoSave()).done((function(){$(document).data("auto-save",""),t.widgetName!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&t.widgetName!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||bizagi.cookie("bizagiDefaultWidget",t.widgetName,{expires:30}),bizagi.util.setContext({widget:t.widgetName},!0),r.setWidget(t)}))})),this.subscribe("showDialog",(function(e,t){switch(t.widgetName){case"routing":r.renderController.renderRoutingDialog(t)}})),this.subscribe("pushWidget",(function(e,t){r.pushWidget(t)})),this.subscribe("executeAction",(function(e,t){r.executeAction(t)})),this.subscribe("renderActionButton",(function(e,t){void 0!==r.mashupFacade.mashup.defaultParams.onRenderAction&&r.mashupFacade.mashup.defaultParams.onRenderAction(t)})),this.subscribe("error",(function(e,t){if(void 0!==r.mashupFacade.mashup.defaultParams.onError){var i={};try{i=$.parseJSON(t.responseText)}catch(e){try{i=$.parseJSON(data.replace(/\x1d/g,"."))}catch(r){i.type="error",i.code=e.errorCode,i.message=t?t.responseText:""}}r.mashupFacade.mashup.defaultParams.onError(i)}})),this.subscribe("mashup-resize-content",(function(e,t){r.mashupFacade.mashup.defaultParams.onMashupResize(t)}))},renderContent:function(){return this.renderWorkarea()},renderWorkarea:function(){return this.renderController=new bizagi.mashup.controllers.render(this.mashupFacade,this.dataService,{canvas:this.canvas,layoutHeader:this.creationParams.layoutHeader||!1}),this.caseSummaryController=new bizagi.mashup.controllers.caseSummary(this.mashupFacade,this.dataService,{canvas:this.canvas}),this.startFormController=new bizagi.mashup.controllers.startForm(this.mashupFacade,this.dataService,{canvas:this.canvas}),this.entityTemplatesController=new bizagi.mashup.controllers.entityTemplates(this.mashupFacade,this.dataService,{canvas:this.canvas,layoutHeader:this.creationParams.layoutHeader||!1}),this.newCaseController=new bizagi.mashup.controllers.newCase(this.mashupFacade,this.dataService,{canvas:this.canvas,layoutHeader:this.creationParams.layoutHeader||!1}),$.when(this.renderController.render(),this.caseSummaryController.render(),this.newCaseController.render(),this.startFormController.render(),this.entityTemplatesController.render())}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.dialog",{},{init:function(e,t,i){this._super(e,t,i),bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization),this.loadTemplates({"mashup-dialog":bizagi.getTemplate("bizagi.mashup.common.dialog").concat("#mashup-dialog"),useNewEngine:!1})},renderContent:function(e){var t=this.getTemplate("mashup-dialog"),i=$.now();this.id="modal-"+i;var r=$.kendoTmpls(bizagi.util.trim(t),{id:this.id}).clone();return r.html(e.content),r},postRender:function(){this.content.kendoMobileModalView({close:function(){this.destroy(),this.element.remove()},useNativeScrolling:!0,modal:this.creationParams.modal||!0}),this.modalView=this.content.data("kendoMobileModalView"),this.modalView.open()},close:function(){void 0!==this.modalView&&this.modalView.close()}}),$.Class.extend("bizagi.mashup.controller.navigation",{PRIORITY_UNDEFINED:-1,PRIORITY_PRIMARY:1,PRIORITY_SECONDARY:2,PRIORITY_LIST:["next","save","validate","nextWithoutValidations","createnewcase","search","select","add",""]},{init:function(e){this.controller=e,this.view=this.controller.view,this.$pane=this.view.wrapper.closest("[data-role='pane']"),this.pane=this.$pane.data("kendoMobilePane"),this.navBar=$(".km-navbar",this.view.header).data("kendoMobileNavBar"),this.containersQueue=[]},resetParams:function(){void 0!==this.navBar&&(this.navBar.title(""),$(".bz-render-dynamic",this.navBar.element).hide())},createRenderContainer:function(e){var t=this;(e=e||{}).view=e.view||{};var i="render-edition-"+$.now(),r=void 0!==e.view.zoom&&Boolean(e.view.zoom),a=void 0===e.view.useNativeScrolling||Boolean(e.view.useNativeScrolling),n=$.kendoTmpls(t.controller.getTemplate("mashup-render-edition-view"),{viewId:i,title:e.title||""});t.setContainerParams(e),t.$pane.append(n);var o=new kendo.mobile.ui.View(n,{zoom:r,useNativeScrolling:a,destroy:function(){var e=this,i=t.containersQueue.find((function(t){return"#".concat(t.id)===e.id})),r=t.containersQueue.indexOf(i);t.containersQueue.splice(r,1),t.controller.navigate(i.previousViewId,"",!0),this.element.remove();var a=t.pane.view().scroller.scrollElement;if(a){var n=a.scrollTop();$(a).scrollTop(n-1).scrollTop(n+1)}}}),s={id:i,element:o.contentElement(),destroy:function(){o.destroy()},setNavigationButtons:function(e){t.setNavigationButtons(e,this.id)}};return $(".bz-render-back",o.header).bind("click",(function(){s.element.trigger("close",{}),o.destroy()})),t.containersQueue.push($.extend(s,{view:o})),s},navigate:function(e){var t=this.containersQueue.find((function(t){return t.id===e}));void 0!==t&&(t.previousViewId=bizagi.kendoMobileApplication.view().id,this.controller.navigate(t.id,"",!0))},setNavigationButtons:function(e){var t,i=!1,r={};if(e&&e.buttons&&e.buttons.length>0&&(t=e.buttons,i=!0,r=e.properties),this.changeButtonVisibilityByContainer(e),i&&void 0!==this.navBar){var a=r.buttons||t;this.initFormButton(e,a)}},modalViewDidAppear:function(){},modalViewDidDisappear:function(){},setContainerParams:function(e){},initFormButton:function(e,t){var i=this,r=t.filter((function(e){return!["back","cancel"].includes(e.action)&&!1!==bizagi.util.parseBoolean(e.visible)})).map((function(e){return{id:e.id,action:e.action,additional:!1,label:e.caption,ordinal:e.ordinal,priority:i.Class.PRIORITY_SECONDARY,visible:!1!==bizagi.util.parseBoolean(e.visible),ranked:!1}}));r.length>0&&$(e.container).formButtons({buttons:i.getListWithPriority(r),click:function(t,r){i.processButton(r.ordinal,e)}})},changeButtonVisibilityByContainer:function(e){e&&e.container&&($(".ui-bizagi-container-children-form",e.container).addClass("ui-bizagi-form-no-buttons"),$(".ui-bizagi-button-container, .ui-bizagi-container-button-edit",e.container).hide())},getListWithPriority:function(e){var t=bizagi.clone(e),i=0,r=this.findPriorityAction(t,0);if(r!==this.Class.PRIORITY_UNDEFINED&&(t[r].priority=this.Class.PRIORITY_PRIMARY,t[r].ranked=!0,i++),1===t.length)return t;var a=this.findPriorityAction(t,0);return a!==this.Class.PRIORITY_UNDEFINED&&(t[a].priority=this.Class.PRIORITY_SECONDARY,t[a].ranked=!0,i++),t.forEach((function(e){e.ranked||(e.priority=i++,e.ranked=!0,e.additional=!0)})),bizagi.util.sortJSON(t,"priority","desc"),t},findPriorityAction:function(e,t){var i=this.Class.PRIORITY_LIST,r=e.findIndex((function(e){return e.action===i[t]&&!e.ranked}));return r!==this.Class.PRIORITY_UNDEFINED?r:this.findPriorityAction(e,++t)},processButton:function(e,t){var i=t.buttons.find((function(t){return t.ordinal===e}));i.callback?i.callback():t.processButton(i)}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.routing",{},{renderContent:function(e){var t=this.creationParams.routingTmpl||"";return $.kendoTmpls(t,e)},postRender:function(){var e=this,t=new bizagi.mashup.controllers.dialog(e.dataService,e.mashupFacade);t.render({content:e.content}).done((function(){$("tr:nth-child(even)",e.content).addClass("event"),$("#ui-bizagi-wp-app-routing-activity-wf .bz-wp-routing-action",e.content).on("click",(function(){var i=$(this).closest(".bz-wp-routing-item").data("item");e.showWorkitem({idCase:i.idCase||0,idWorkitem:i.idWorkItem||0,idTask:i.idTask||0,taskName:i.displayName||"",radNumber:i.radNumber||0}),t.close()}))}))},showWorkitem:function(e){this.publish("renderCase",{idCase:e.idCase,idWorkitem:e.idWorkitem,idTask:e.idTask,taskName:e.taskName,radNumber:e.radNumber})}}),$.Class.extend("bizagi.mashup.controllers.async",{ASYNC_CHECK_TIMER:3e3},{init:function(e){this.renderController=e,this.configureHandlers()},configureHandlers:function(){var e=this;e.renderController.subscribe("render-async",(function(t,i){e.executeAsync(i).done((function(){e.renderController.publish("renderCase",{action:"routing",idCase:i.idCase})}))}))},executeAsync:function(e){var t=this,i=new $.Deferred,r=$.tmpl(t.renderController.getTemplate("mashup-async"),e);return t.modal=new kendo.mobile.ui.ModalView(r,{close:function(){this.destroy(),this.element.remove()},modal:!0}),$(".render-async-close",t.modal.element).bind("click",(function(){t.modal.close()})),t.modal.open(),t.checkAsycnExecutionState(i,e),i.promise()},checkAsycnExecutionState:function(e,t){var i=this.renderController,r=this;$.when(i.dataService.getAsynchExecutionState({idCase:t.idCase})).done((function(a){"Error"==a.state&&void 0!==a.errorMessage&&($("#modalview-async-message",i.modal.element).height(130),$(".ui-bizagi-wp-async-error",i.modal.element).show(),$(".ui-bizagi-wp-waiting-message",i.modal.element).hide(),$(".ui-bizagi-wp-async-error-txt",i.modal.element).html(a.errorMessage||bizagi.localization.getResource("render-async-error"))),"Processing"==a.state?0===a.errorMessage.length&&setTimeout((function(){r.checkAsycnExecutionState(e,t)}),bizagi.mashup.controllers.async.ASYNC_CHECK_TIMER):"Finished"==a.state&&(r.modal.close(),e.resolve())}))}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.render",{},{init:function(e,t,i){this._super(e,t,i),bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization)},renderContent:function(){var e=this.getTemplate("mashup-render-view");return $.kendoTmpls(e,{})},postRender:function(){var e=this.getTemplate("mashup-render-layout");this.content.prepend($.kendoTmpls(e,{})),this.view=new kendo.mobile.ui.View(this.content,{useNativeScrolling:!0}),this.creationParams.layoutHeader||this.view.header.hide(),this.navigation=new bizagi.mashup.controller.navigation(this),this.async=new bizagi.mashup.controllers.async(this),this.configureHandlers()},configureHandlers:function(){var e=this;e.subscribe("renderCase",(function(t,i){if(e.navigation.resetParams(),bizagi.util.isEmpty(i.idCase))return bizagi.log("Se requiere el id del caso 'idCase' para poder renderizar la forma"),null;if(!bizagi.util.isEmpty(i.summaryForm))return e.renderForm(i),null;if(bizagi.util.isEmpty(i.idWorkitem)){var r={};return r.idCase=i.idCase,i.summaryForm&&(r.summaryForm=!0),e.executeAction("routing",r),null}e.renderForm(i)})),e.subscribe("refreshProxyPrefix",(function(t,i){void 0!==e.rendering&&e.rendering.dataService.serviceLocator.setProxyPrefix(i)})),$(".bz-render-back",e.view.header).bind("click",(function(){e.view.contentElement().empty(),e.mashupFacade.close()})),e.subscribe("toggleHeader",(function(t,i){void 0!==i.showHeader?i.showHeader?e.view.header.show():e.view.header.hide():e.view.header.toggle()}))},renderRoutingDialog:function(e){new bizagi.mashup.controllers.routing(this.dataService,this.mashupFacade,{routingTmpl:this.getTemplate("mashup-routing")}).render(e.data).done((function(){}))},renderForm:function(e){var t=this,i=e,r=t.view.contentElement();if(r.empty(),e.withOutGlobalForm){var a=t.getTemplate("mashup-info-message"),n=e.messageForm||t.resources.getResource("render-without-globalform"),o=!1;void 0!==t.params&&(o=void 0!==t.params.isOfflineForm&&bizagi.util.parseBoolean(t.params.isOfflineForm)),o&&(n=bizagi.util.getMessageFromNetworkState(t.dataService.online)),$.kendoTmpls(a,{message:n}).appendTo(r),$(".ui-bizagi-info-message-button",r).click((function(){t.view.contentElement().empty(),t.mashupFacade.close()}))}else{if(void 0===t.rendering){var s={proxyPrefix:void 0!==t.dataService.serviceLocator.proxyPrefix?t.dataService.serviceLocator.proxyPrefix:"",device:bizagi.util.detectDevice()};t.rendering=new bizagi.rendering.facade(s),r.bind("routing",(function(e,r){var a={idCase:i.idCase,fromTask:i.fromTask||i.idTask,fromWorkItemId:i.fromWorkItemId||i.idWorkitem,isOfflineForm:i.isOfflineForm||!1,formsRenderVersion:i.formsRenderVersion};a=$.extend(a,r),t.executeAction("routing",a)})),r.bind("errorform",(function(e){t.publish("error",e)})),t.rendering.subscribe("renderActionButton",(function(e,r){t.publish("renderActionButton",{actions:r.actions,data:{idCase:i.idCase,idWorkitem:i.idWorkitem,idTask:i.idTask,idWorkflow:i.idWorkflow}})})),this.rendering.subscribe("dataNavigation",(function(e,i){t.publish("dataNavigation",i)}))}bizagi.loading.start(),$.when(t.rendering.execute($.extend(e,{canvas:r,navigation:t.navigation}))).then((function(){t.resizeParent($("#render .bz-form"))})).fail((function(e){})).always((function(){bizagi.loading.stop()}))}var l=$(".km-navbar",t.view.header).data("kendoMobileNavBar");if(void 0!==l){var c=void 0!==e.displayName?e.displayName:e.radNumber||e.idCase;l.title(c)}t.publish("renderSummaryCase",e)}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.caseSummary",{},{init:function(e,t,i){this._super(e,t,i),bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization),this.initialized=!1},renderContent:function(){var e=this.getTemplate("mashup-summary-view");return $.kendoTmpls(e)},postRender:function(){this.drawer=new kendo.mobile.ui.Drawer(this.content,{swipeToOpen:!1,position:"rigth"})},configureHandlers:function(){var e=this;e._super(),e.subscribe("showSummary",(function(){void 0!==e.drawer&&e.initialized?e.drawer.show():bizagi.log("The summary case controller has not been initialized")})),e.drawer.bind("show",(function(){$(".bz-header_select",e.canvas).trigger("resizeHeader")})),$("#case-summary",e.canvas).delegate(".summaryLink","click",(function(t){t.preventDefault(),e.routingExecute($(this)),$($(this),e.canvas).remove(),e.cache={}}))},renderCurrentTab:function(e){var t=this,i="",r=new $.Deferred,a=e.params||t.params||{};switch(t.cache=t.cache||{},t.data=t.data||{},e.currentTab){case"#ui-bizagi-tab-assignees":void 0===t.cache.assignees?$.when(t.dataService.summaryAssigness({idCase:a.idCase})).done((function(a){i=$.kendoTmpls(bizagi.util.trim(t.getTemplate("mashup-summary-assigness")),a),t.cache.assignees=!0,$(e.currentTab,t.content).empty(),$(e.currentTab,t.canvas).html(i),bizagi.loading.stop(),r.resolve()})):(bizagi.loading.stop(),r.resolve());break;case"#ui-bizagi-tab-comments":void 0===t.cache.comments?$.when(t.dataService.getComments({idCase:a.radNumber||a.idCase,idLastComment:t.Class.COMMENT_SIZE})).done((function(a){a.showComments=a.totalRecords>0,a.timeAgo=bizagi.getTimeAgo,a.getUserName=function(e){var t=a.users||[],i="";return $.each(t,(function(r,a){t[r].Id==e&&(i=a.DisplayName)})),i},i=$.kendoTmpls(bizagi.util.trim(t.getTemplate("mashup-summary-comments")),a),t.cache.comments=!0,$(e.currentTab,t.content).empty(),$(e.currentTab,t.canvas).html(i),bizagi.loading.stop(),r.resolve()})):(bizagi.loading.stop(),r.resolve());break;case"#ui-bizagi-tab-subprocess":void 0===t.cache.subprocess?$.when(t.dataService.summarySubProcess({idCase:a.idCase})).done((function(a){i=$.kendoTmpls(bizagi.util.trim(t.getTemplate("mashup-summary-subprocess")),a),t.cache.subprocess=!0,$(e.currentTab,t.content).empty(),$(e.currentTab,t.canvas).html(i),bizagi.loading.stop(),r.resolve()})):(bizagi.loading.stop(),r.resolve());break;case"#ui-bizagi-tab-events":void 0===t.cache.events?$.when(t.dataService.summaryCaseEvents({idCase:a.idCase})).done((function(a){i=$.kendoTmpls(bizagi.util.trim(t.getTemplate("mashup-summary-events")),a),t.cache.events=!0,$(e.currentTab,t.content).empty(),$(e.currentTab,t.canvas).html(i),bizagi.loading.stop(),r.resolve()})):(bizagi.loading.stop(),r.resolve());break;case"#ui-bizagi-tab-activities":void 0===t.cache.activities?$.when(t.dataService.summaryActivities({data:t.data,idWorkitem:a.idWorkitem})).done((function(n){n.idCase=a.idCase,i=$.kendoTmpls(bizagi.util.trim(t.getTemplate("mashup-summary-activities")),n),t.cache.activities=!0,$(e.currentTab,t.content).empty(),$(e.currentTab,t.canvas).html(i),i.delegate(".summaryLink","click",(function(e){e.preventDefault(),t.routingExecute($(this))})),bizagi.loading.stop(),r.resolve()})):(bizagi.loading.stop(),r.resolve());break;default:bizagi.loading.stop(),r.resolve()}return r.promise()},routingExecute:function(e){var t=new $.Deferred;if(e){var i=e.data("case")||this.params.idCase,r=e.data("workitem"),a=e.data("task"),n=e.data("displayname")||this.params.displayName;$(".km-content:visible").data("kendoMobileScroller").reset(),$("#case-summary").data("kendoMobileDrawer").hide(),this.publish("renderCase",{idCase:i,idWorkitem:r,idTask:a,displayName:n}),t.resolve(!0)}else t.resolve(!1);return t.promise()},release:function(e){var t=this,i=new $.Deferred,r=[{label:t.getResource("workportal-widget-dialog-box-release-ok"),action:"resolve"},{label:t.getResource("workportal-widget-dialog-box-release-cancel")}];return $.when(bizagi.showConfirmationBox(t.getResource("workportal-widget-dialog-box-release"),t.getResource("render-actions-release"),"",r)).done((function(){bizagi.loading.start(),$.when(t.dataService.releaseActivity({idCase:e.idCase,idWorkItem:e.idWorkitem})).done((function(r){switch(r&&r.status?r.status:"Error"){case"Success":t.publish("renderActionButton",{actions:["release","routing"]}),t.publish("renderCase",{action:"routing",idCase:e.idCase,idWorkitem:e.idWorkitem});break;case"ConfigurationError":bizagi.showMessageBox(t.getResource("workportal-widget-dialog-box-release-configuration-error-message").replace("{0}",e.idWorkitem),t.getResource("workportal-widget-dialog-box-release-error"),"error",!1);break;case"Error":bizagi.showMessageBox(t.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",e.idWorkitem),t.getResource("workportal-widget-dialog-box-release-error"),"error",!1)}bizagi.loading.stop(),i.resolve()})).fail((function(){var r=t.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",e.idWorkitem);bizagi.showMessageBox(r,t.getResource("workportal-widget-dialog-box-release-error"),"error",!1),bizagi.loading.stop(),i.reject()}))})),i.promise()}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.newCase",{},{init:function(e,t,i){this._super(e,t,i),bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization),this.loadTemplates({"mashup-newcase-modal-multiorganization":bizagi.getTemplate("bizagi.mashup.common.newCase").concat("#mashup-newcase-multiorganization"),useNewEngine:!1})},renderContent:function(){},postRender:function(){this.configureHandlers()},configureHandlers:function(){var e=this;e.subscribe("createNewCase",(function(t,i){return void 0!==bizagi.currentUser&&bizagi.util.parseBoolean(bizagi.currentUser.isMultiOrganization)?e.createOrganizationList(i):i.notification?i.isBatch?e.createNewCaseNotification(i):e.hasStartForm(i):e.createNewCase(i)}))},createNewCase:function(e){var t=this,i=new $.Deferred;if(bizagi.loading.start(),e.isOfflineForm){var r={idWfClass:e.idProcess||e.idWFClass,displayName:e.displayName,isOfflineForm:e.isOfflineForm,categoryName:e.categoryName};return t.createCase(r)}return $.when(t.dataService.startProcess(e)).then((function(r){var a=t.buildCaseParameters(e,r);a.hasStartForm?(a.displayName=e.displayName,t.publish("renderStartForm",{params:a}),t.mashupFacade.navigate("#startForm")):(t.publish("renderCase",a),t.mashupFacade.navigate("#render")),i.resolve()})).fail((function(e){var t=$.parseJSON(e.responseText);bizagi.showMessageBox(t.message,"Error"),i.fail()})).always((function(){bizagi.loading.stop()})),i},createCase:function(e){var t=this;return bizagi.loading.start(),t.dataService.createNewCase(e).then((function(e){t.publish("renderCase",e),t.mashupFacade.navigate("#render")})).fail((function(e){var t=$.parseJSON(e.responseText);bizagi.showMessageBox(t.message,"Error")})).always((function(){bizagi.loading.stop()}))},hasStartForm:function(e){return!(e=e||{}).hasStartForm&&e.isShortcut?this.startShortcutProcess(e):this.createNewCaseNotification(e)},startShortcutProcess:function(e){var t=this;t.dataService.actionCreateCase(e).done((function(e){var i=e.caseId;t.dataService.getCaseAssignees({idCase:i}).done((function(e){var r=e.assignees,a=!1;if(void 0!==r&&r.length>0){var n=bizagi.currentUser.idUser;void 0!==r.find((function(e){return e.idUser==n}))&&(a=!0)}if(a)t.publish("renderCase",{action:"routing",idCase:i});else{var o=bizagi.localization.getResource("workportal-widget-templateengine-action-process-notification");o=o.replace("{0}",i),$.notifier.add({text:o})}}))})).fail((function(e){var t=$.parseJSON(e.responseText);bizagi.showMessageBox(t.message,"Error")}))},createOrganizationList:function(e){var t=this,i=new $.Deferred;return t.isAdjusted=!1,t.dataService.getOrganizationsList().done((function(r){var a=t.getTemplate("mashup-newcase-modal-multiorganization"),n=kendo.template(a,{useWithBlock:!1})({list:r.response,idWfClass:e.idProcess,isAdhocProcess:e.isAdhocProcess||!1}),o=$(n.trim()).kendoMobileModalView({close:function(){this.destroy(),this.element.remove()},useNativeScrolling:!0,modal:!1}).getKendoMobileModalView();t.configureModalHandlers(),$(".bz-wp-modal-organization-footer div.km-rightitem").addClass("inactive"),o.open(),o.adjustSize=function(){var e,i=$(".bz-wp-modal-organization-list",this.element).height();if(0!==i){var r=$(".bz-wp-modal-organization-content",this.element).width(),a=$(".bz-wp-modal-organization-header",this.wrapper).height()+$(".bz-wp-modal-organization-footer",this.wrapper).height(),n=window.innerHeight,o=window.innerWidth;i+a>=n?e=n-20:(e=i+a,"tablet_ios"!==bizagi.util.detectDevice()?e+=t.isAdjusted?90===Math.abs(window.orientation)?8:35:20:e+=90===Math.abs(window.orientation)?20:22);var s=(n-e)/2,l=(o-r)/2;this.wrapper.parent().css("top",s),this.wrapper.parent().css("left",l),this.wrapper.parent().css("height",e),t.isAdjusted=!0}},o.adjustSize(),window.addEventListener("orientationchange",(function(){bizagi.util.isAndroidDevice()?setTimeout((function(){o.adjustSize()}),500):o.adjustSize()}),!1),i.resolve()})).fail((function(e){var t,r=e.responseText;try{t=(t=JSON.parse(r)).message||r}catch(e){t=r}bizagi.showMessageBox(t,"Error"),i.fail()})).always((function(){bizagi.loading.stop()})),i},createNewCaseNotification:function(e){var t=this,i=new $.Deferred;return e.hasStartForm?(t.publish("renderStartForm",{params:e}),t.mashupFacade.navigate("#startForm"),bizagi.loading.stop(),i.resolve()):t.dataService.actionCreateCase(e).done((function(r){var a=e.mapping||{},n=e.type||"Process",o={showProcess:!1,isMultiInstance:e.isMultiInstance,notification:!0,hasStartForm:r.hasStartForm,idProcess:r.idProcess,displayName:e.displayName,mapping:a,type:n,idParentCase:e.idParentCase};if($.extend(o,r.caseInfo),e.isBatch){var s=bizagi.localization.getResource("workportal-widget-templateengine-action-process-notification");s=s.replace("{0}",r.caseNumber);var l=printf(bizagi.localization.getResource("workportal-widget-templateengine-message-summary-create-cases-singular"),1);$.notifier.add({title:l,text:s,sticky:!0}),bizagi.loading.stop()}else t.dataService.getCaseAssignees({idCase:r.caseId}).done((function(e){var i=e.assignees,a=!1;if(void 0!==i&&i.length>0){var n=bizagi.currentUser.idUser;void 0!==i.find((function(e){return e.idUser==n}))&&(a=!0)}if(bizagi.loading.stop(),a)t.publish("render-case",{action:"routing",idCase:r.caseId});else{var o=bizagi.localization.getResource("workportal-widget-templateengine-action-process-notification");o=o.replace("{0}",r.caseNumber);var s=printf(bizagi.localization.getResource("workportal-widget-templateengine-message-summary-create-cases-singular"),1);$.notifier.add({title:s,text:o,sticky:!0})}}));i.resolve()})).fail((function(e){var t=$.parseJSON(e.responseText);bizagi.loading.stop(),$.notifier.add({title:"Error",class_name:"error",text:t.message,sticky:!0}),i.fail()})),i},configureModalHandlers:function(){var e=this;$(".bz-wp-modal-organization").delegate(".bz-wp-modal-organization-footer .km-leftitem","click",(function(){$(".bz-wp-modal-organization").data("kendoMobileModalView").close()})),$(".bz-wp-modal-organization").delegate(".bz-wp-modal-organization-list > li","click",(function(e){var t=$(e.target);$(".bz-wp-modal-organization-list > li").removeClass("bz-wp-modal-organization-list-item-selected"),$(".bz-wp-modal-organization-footer div.km-rightitem").hasClass("inactive")&&($(".bz-wp-modal-organization-footer div.km-rightitem").removeClass("inactive"),$(".bz-wp-modal-organization-footer div.km-rightitem").addClass("active")),t.addClass("bz-wp-modal-organization-list-item-selected")})),$(".bz-wp-modal-organization").delegate(".bz-wp-modal-organization-footer .km-rightitem","click",(function(t){if(t.stopPropagation(),!$(".bz-wp-modal-organization-footer div.km-rightitem").hasClass("inactive")){bizagi.loading.start();var i=$(this).closest(".bz-wp-modal-organization"),r=i.data("adhoc"),a=i.data("workflow"),n=$(".bz-wp-modal-organization-list-item-selected").data("id")||null,o={};return r?(o.idProcess=a,e.createNewCase(o)):(o.idWfClass=a,o.idOrganization=n,e.createCase(o))}}))},buildCaseParameters:function(e,t){var i;if(t.oldVersion)(i=t).hasStartForm=!e.isOfflineForm&&t.hasStartForm||!1,i.displayName=e.displayName;else{var r=e.mapping||{},a=e.type||"Process";i={showProcess:!0,isMultiInstance:e.isMultiInstance,hasStartForm:!e.isOfflineForm&&t.hasStartForm,idProcess:t.idProcess,displayName:e.displayName,mapping:r,type:a,idParentCase:e.idParentCase},$.extend(i,t.caseInfo)}return i}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.startForm",{},{init:function(e,t,i){this._super(e,t,i)},renderContent:function(){var e=this.getTemplate("mashup-start-form");return $.kendoTmpls(e,{})},postRender:function(){this.view=new kendo.mobile.ui.View(this.content,{useNativeScrolling:!0}),this.view.header.hide(),this.configureHandlers()},configureHandlers:function(){var e=this;e.subscribe("renderStartForm",(function(t,i){return e.renderForm(i.params)})),$(".bz-render-back",e.view.header).bind("click",(function(){e.view.contentElement().empty(),e.mashupFacade.close()})),e.view.content.bind("routing",(function(t,i){if(i.notification){var r=bizagi.localization.getResource("workportal-widget-templateengine-action-process-notification");r=r.replace("{0}",i.idCase),$.notifier.add({text:r}),e._back()}else if(void 0!==i.idCase){var a={action:"routing",idCase:i.idCase};e.dataService.getCaseAssignees(i).done((function(t){var i=t.assignees;if(e._navigateProcess=!1,void 0!==i&&i.length>0){var r=bizagi.currentUser.idUser;void 0!==i.find((function(e){return e.idUser==r}))&&(e._navigateProcess=!0)}if(e._navigateProcess)bizagi.loading.start(),$.when(e.publish("renderCase",a)).done((function(){bizagi.loading.stop(),e.mashupFacade.navigate("#render")}));else{var n=bizagi.localization.getResource("workportal-widget-templateengine-action-process-notification");n=n.replace("{0}",a.idCase),e._refreshTemplate(),$.notifier.add({text:n,sticky:!0}),bizagi.loading.stop()}}))}}))},renderForm:function(e){var t=this;if(t.view.content.empty(),$(".km-navbar",t.view.header).data("kendoMobileNavBar").title(e.displayName),t.original_params=e,t._type=e.type,t._navigateProcess=void 0!==e.showProcess&&e.showProcess,t._origin=e.origin,"Process"===e.type){if(t._renderParams={h_action:e.hasStartForm?"LOADSTARTFORM":"LOADFORM"},void 0!==e.idParentCase&&(t._renderParams.h_idParentCase=e.idParentCase),void 0!==e.guidProcess?(t._renderParams.h_guidprocess=e.guidProcess,void 0===e.mapping&&e.isShortcut&&(t._renderParams.h_mappingstakeholders=!0)):t._renderParams.h_idProcess=e.idProcess,e.mapping)for(var i=0;i<e.mapping.length;i++){var r=e.mapping[i];r.surrogateKey&&(t._renderParams[r.xpath]=JSON.stringify(r.surrogateKey))}}else"Form"===e.type&&(t._renderParams={h_action:"LOADENTITYFORM",h_contexttype:"entity",h_guidEntity:e.entityGuid,h_guidForm:e.formGuid,h_showDisabled:!1,h_readonlyform:e.readonlyform},null!==e.entitySurrogateKey&&(t._renderParams.h_surrogateKey=e.entitySurrogateKey),void 0!==e.mapping&&null!==e.mapping&&(t._renderParams.h_mapping=JSON.stringify(e.mapping)));if(void 0===t.rendering){var a=e.proxyPrefix||t.dataService.serviceLocator.proxyPrefix;bizagi.rendering.facade.extend("bizagi.rendering.startFormFacade",{},{process:function(e){return this._super(e).then((function(i){return t._form=i,t.changeButtons(e.origin),i}))}}),t.navigation=new bizagi.mashup.controller.navigation(t),t.rendering=new bizagi.rendering.startFormFacade({proxyPrefix:a,device:bizagi.util.detectRealDevice()})}return bizagi.util.setContext({idCase:e.idCase||null,displayName:e.displayName||e.taskName,caseNumber:e.caseNumber||null}),$.when(t.dataService.getForm(t._renderParams)).then((function(i){return t.rendering.execute({data:i,navigation:t.navigation,originalParams:e,postRenderEdit:t.postRenderEdit.bind(t),getTemplate:t.getTemplate,canvas:t.view.content,type:""})})).done((function(){t.view.scroller.reset(),t.resizeParent($("#startForm .bz-form"))}))},postRenderEdit:function(){},changeButtons:function(){var e=this,t=e._form,i=t.processButton;t&&(t.processButton=function(r){"cancel"===r.action?(t.endLoading(),e._back()):(bizagi.loading.start(),void 0!==e._renderParams.h_surrogateKey&&(t.properties.surrogateKey=e._renderParams.h_surrogateKey),t.properties.contextType=e._renderParams.h_contexttype,t.validateForm()?($.forceCollectData=!0,$.when(i.apply(t,arguments)).then((function(){void 0===e._renderParams.h_surrogateKey&&void 0===e._renderParams.h_mapping||e.refreshTemplate()})).always((function(){bizagi.loading.stop(),$.forceCollectData=!1}))):bizagi.loading.stop())},"Form"===e._type&&t.bind("refresh",(function(){bizagi.loading.stop()})))},refreshTemplate:function(){if(void 0!==this._origin){var e=this.homePortalFramework.accumulatedContext,t={data:e[e.length-1],filters:[],eventType:"DATA-NAVIGATION",calculateFilters:!0};this._back(),this.publish("homeportalShow",{what:this._origin,title:void 0!==t.data?t.data.displayName:"",params:t,preventNavigate:!0})}else this._back()}}),bizagi.mashup.controllers.controller.extend("bizagi.mashup.controllers.entityTemplates",{},{init:function(e,t,i){this._super(e,t,i),this.acumContext=[],bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization)},renderContent:function(){var e=this.getTemplate("mashup-entity-templates");return $.kendoTmpls(e,{})},postRender:function(){var e=this;e.view=new kendo.mobile.ui.View(e.content,{}),e.navbar=$(".km-navbar",e.view.header).data("kendoMobileNavBar"),e.entityDataSource=new kendo.data.DataSource({transport:{read:function(t){bizagi.loading.start();var i=$.extend({page:t.data.page||1,pageSize:t.data.pageSize||40},t.data.filter.filters[0].value);$.when(e.getEntities(i)).then((function(i){e.dataCalled(i),t.success(i)})).fail((function(e){t.error(e)})).always((function(){bizagi.loading.stop()}))}},schema:{data:"entities",total:"totalRecords"},serverFiltering:!0,serverPaging:!0,page:1,pageSize:e.Class.pageSize});var t=e.getTemplate("mashup-entity-templates-pull-loader"),i=e.getTemplate("mashup-entity-templates-refresh-loader");e.entityList=e.content.find(".entity-list").kendoMobileCustomListView({autoBind:!1,loadMore:!0,messages:{pullTemplate:t,refreshTemplate:i,releaseTemplate:i,loadMoreText:e.getResource("workportal-widget-inbox-load-more")},dataSource:e.entityDataSource,template:e.getTemplate("mashup-entity-templates-item"),pullToRefresh:!0,itemBind:function(e){$(".wp-tender-template-item",e.element).append(e.data.tmpl)}}).getKendoMobileCustomListView(),e.configureHandlers()},configureHandlers:function(){var e=this;$.when(e.engineReady).then((function(){e.subscribe("dataNavigation",(function(t,i){e.entityDataSource.filter({field:"data",value:i.data}),e.entityList.scroller().reset(),e.acumContext.splice(0,e.acumContext.length),e.acumContext.push(i.data),e.navbar.title(i.data.displayName),e.mashupFacade.navigate("#entityTemplates","slide")})),e.engine.subscribe("onLoadDataNavigation",(function(t,i){e.entityDataSource.filter({field:"data",value:i.data}),e.entityList.scroller().reset(),e.acumContext.push(i.data),e.navbar.title(i.data.displayName)}))})),$(".bz-render-back",e.view.header).bind("click",(function(){if(e.acumContext.splice(e.acumContext.length-1,1),e.acumContext.length>0){var t=e.acumContext.slice(e.acumContext.length-1,1)[0];e.entityDataSource.filter({field:"data",value:t}),e.entityList.scroller().reset(),e.navbar.title(t.displayName)}else e.mashupFacade.navigate("#render","slide:right")}))},getEntities:function(e){var t=this;return t.getData(e).then((function(e){return t.getEntityTemplates(e)}))},getData:function(e){return this.dataService.getCollectionEntityData(e).then((function(e){return e}))},getEntityTemplates:function(e){var t=this,i="ENTITY"===t._referenceType?"Content":"List",r=[],a=$.map(e.entities,(function(e){return r.push({surrogateKey:e.surrogateKey,entityId:e.guid}),t.engine.render($.extend(e,{isDefaultTemplate:null===e.guidTemplate,templateType:i})).then((function(t){e.tmpl=t}))}));return $.when.apply($,a).then((function(){return e}))},dataCalled:function(e){e.entities.length>0?this.view.content.find(".activity-empty-list").hide():this.view.content.find(".activity-empty-list").show()}}),bizagi.mashup.controllers.render.extend("bizagi.mashup.controllers.render",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"mashup-render-view":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-render-view"),"mashup-render-layout":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-render-layout"),"mashup-render-edition-view":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-render-edition-view"),"mashup-info-message":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-info-message"),"mashup-routing":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-routing"),"mashup-async":bizagi.getTemplate("bizagi.mashup.controller.smartphone.render").concat("#mashup-async"),useNewEngine:!1})},postRender:function(){this._super()}}),bizagi.mashup.controllers.caseSummary.extend("bizagi.mashup.controllers.caseSummary",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"mashup-summary-view":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-view"),"mashup-summary-main":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-main"),"mashup-summary-subprocess":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-subprocess"),"mashup-summary-comments":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-comments"),"mashup-summary-assigness":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-assigness"),"mashup-summary-activities":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-activities"),"mashup-summary-events":bizagi.getTemplate("bizagi.mashup.controller.smartphone.caseSummary").concat("#mashup-summary-events"),useNewEngine:!1})},postRender:function(){this._super(),this.configureHandlers()},configureHandlers:function(){var e=this;e._super(),e.subscribe("renderSummaryCase",(function(t,i){return e.renderSummary(i)}))},renderSummary:function(e){var t=this,i=new $.Deferred;return t.params=e||{},t.cache={},t.dataService.summaryCaseDetails({idCase:e.idCase,eventAsTasks:e.eventAsTasks||!1,onlyUserWorkItems:e.onlyUserWorkItems||!1,idWorkitem:e.idWorkitem,isOfflineForm:e.isOfflineForm||!1}).done((function(r){var a=void 0!==r.estimatedSolutionDate?r.estimatedSolutionDate:r.solutionDate;r.params=t.params,r.group=bizagi.util.cases.getStatusTimeLabel(a),t.data=r,t.data.estimatedSolutionDate=bizagi.util.dateFormatter.formatDate(new Date(t.data.estimatedSolutionDate),t.getResource("dateFormat")+" "+t.getResource("timeFormat")),t.data.solutionDate=bizagi.util.dateFormatter.formatDate(new Date(t.data.solutionDate),t.getResource("dateFormat")+" "+t.getResource("timeFormat")),t.data.creationDate=bizagi.util.dateFormatter.formatDate(new Date(t.data.creationDate),t.getResource("dateFormat")+" "+t.getResource("timeFormat"));var n=$.kendoTmpls(t.getTemplate("mashup-summary-main"),t.data);$(".km-scroll-container",t.content).empty().html(n),$(".km-content",t.content).data("kendoMobileScroller").reset(),$(".ui-bizagi-container-tab",t.content).bztabs({activate:function(e){bizagi.loading.start(),r.currentTab=$(e.currentTarget).data("reference-tab"),t.renderCurrentTab(r)},tabNumber:2}),r.currentState&&r.currentState.length>0&&void 0!==r.currentState[0].allowReleaseActivity&&r.currentState[0].allowReleaseActivity&&$(".bz-wp-summary-release",t.content).bind("click",(function(){t.release(e)})),t.initialized=!0,i.resolve()})),i.promise()}}),bizagi.mashup.controllers.startForm.extend("bizagi.mashup.controllers.startForm",{},{init:function(e,t,i){this._super(e,t,i),bizagi.hasOwnProperty("kendo")?this.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):this.templateService=new bizagi.templates.services.service(bizagi.localization),this.loadTemplates({"mashup-start-form":bizagi.getTemplate("bizagi.mashup.common.startForm").concat("#mashup-start-form"),"mashup-render-edition-view":bizagi.getTemplate("bizagi.mashup.common.startForm").concat("#mashup-render-edition-view"),useNewEngine:!1})}}),bizagi.mashup.controllers.entityTemplates.extend("bizagi.mashup.controllers.entityTemplates",{pageSize:20},{init:function(e,t,i){var r=this;r._super(e,t,i),r.loadTemplates({"mashup-entity-templates":bizagi.getTemplate("bizagi.mashup.common.entityTemplates").concat("#mashup-entity-templates"),"mashup-entity-templates-item":bizagi.getTemplate("bizagi.mashup.common.entityTemplates").concat("#mashup-entity-templates-item"),"mashup-entity-templates-item-actions":bizagi.getTemplate("bizagi.mashup.common.entityTemplates").concat("#mashup-entity-templates-item-actions"),"mashup-entity-templates-pull-loader":bizagi.getTemplate("bizagi.mashup.common.entityTemplates").concat("#mashup-entity-templates-pull-loader"),"mashup-entity-templates-refresh-loader":bizagi.getTemplate("bizagi.mashup.common.entityTemplates").concat("#mashup-entity-templates-refresh-loader"),useNewEngine:!1});var a=i.proxyPrefix||t.serviceLocator.proxyPrefix,n=new bizagi.render.services.service({proxyPrefix:a}),o=new bizagi.rendering.smartphone.factory(n);r.engineReady=$.when(o.initAsyncStuff()).then((function(){r.engine=new bizagi.templateEngine({renderFactory:o,cache:!0,forcePersonalizedColumns:!1})}))}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.resize=[],bizagi.resize.attachEvent=document.attachEvent,!bizagi.resize.attachEvent){var requestFrame=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),cancelFrame=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}();window.resetTriggers=function(e){var t=e.__resizeTriggers__,i=t.firstElementChild,r=t.lastElementChild,a=i.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,a.style.width=i.offsetWidth+1+"px",a.style.height=i.offsetHeight+1+"px",i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight},window.checkTriggers=function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height},window.scrollListener=function(e){var t=this;resetTriggers(this),this.__resizeRAF__&&cancelFrame(this.__resizeRAF__),this.__resizeRAF__=requestFrame((function(){checkTriggers(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(i){i.call(t,e)})))}))}}window.bizagi.addResizeListener=function(e,t){bizagi.resize.attachEvent?e.attachEvent("resize",t):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),resetTriggers(e),e.addEventListener("scroll",scrollListener,!0)),e.__resizeListeners__.push(t))},window.bizagi.removeResizeListener=function(e,t){bizagi.resize.attachEvent?e.detachEvent("resize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",scrollListener),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))};
//# sourceMappingURL=../../../../Maps/smartphone_android/mashup.smartphone.production.js.map
