{"version":3,"sources":["jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.searchForm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.list.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.combo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.search.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.combo.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.container.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.render.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.form.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.panel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.contentPanel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.nestedForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tab.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tabItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.horizontal.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.layout.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordion.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordionItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.group.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.section.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.searchForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.startForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.adhocForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.form.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.text.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.readonly.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.extendedText.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.label.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.number.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.money.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.date.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.actionLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.entityTemplate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.polymorphicLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.yesno.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.check.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.checkList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.multiSelect.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.handSignature.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.radio.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.cascadingCombo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.collectionnavigator.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.hidden.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.grouped.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.letter.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.button.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.fileprint.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.link.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.image.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.formLink.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.geolocation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.association.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.searchList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.userfield.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.activityCheckList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.numberScientificNotation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.range.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeDate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeMoney.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeNumber.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.render.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.image.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.placeholder.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.boolean.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.link.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.label.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.text.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.dateTime.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.number.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.money.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.column.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.document.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.date.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.text.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.number.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.image.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.link.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.search.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.uploadecm.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.button.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.radio.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.list.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.exclusiveCheck.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.readonly.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.hidden.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.document.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.queryForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.formTemplate.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.usersForm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.specific_text.js","jquery/rendering/js/smartphone/bizagi.rendering.smartphone.factory.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_bizagi$rendering$sma","_defineProperty","key","value","Object","defineProperty","enumerable","configurable","writable","bizagi","rendering","container","extend","startLoading","endLoading","render","base","smartphone","initializeData","data","this","_super","formContainer","getFormContainer","formParams","getParams","internalPostRender","element","changeDisplayOption","postRender","getLabel","label","$","observableElement","getContainerRender","getAlignClass","alignType","getControl","control","length","getControlFiller","controlFiller","getContainerMessage","containerMessage","getColumnContainerMessage","changeLabelAlign","changeValueAlign","customizeRenderWidth","submitOnChange","bRefreshForm","noCollect","self","defer","Deferred","util","when","isReadyToSave","done","internalSubmitOnChange","resolve","fail","reject","always","stopLoading","promise","setValidationMessage","message","dataType","normalizeType","properties","type","isGridControl","$message","column","test","replace","attr","text","addClass","removeClass","setDisplayValue","setValue","editable","display","displayValue","getDisplayValue","html","actionSave","inputEdition","val","configureLabel","displayName","getElementsToStylize","context","getDisplayOptionClass","displayType","getFormattingLabel","clearDisplayValue","input","find","filter","index","ele","getValue","getFormParams","getRTLDisplayType","changeVisibility","argument","visible","parseBoolean","show","css","hide","changeRequired","required","triggerRenderValidate","changeRequiredLabel","changeEditabilityCellControl","xpath","saveGridChildrenVisualChanges","indexes","getIndexes","gridChildrenVisualChanges","columns","each","j","i","cell","decorated","id","visualChanges","restoreGridAppearance","restoreAppearance","restoreCellAppearance","restoreGridChildrenVisualChanges","form","init","params","warnings","errors","syncError","isOfflineErrorMode","syncMessage","undefined","isEmpty","makeArray","forEach","currentMessage","e","console","error","showToastOnSuccessSync","removeSyncErrorOnSubmit","postRenderContainer","buttons","getButtons","isiOSTabletDevice","isObjectEmpty","warningContainer","append","appendTo","prependTo","click","detach","ekey","setTimeout","addValidationMessage","document","unbind","bind","deferredSave","allowOnlineActions","autoSaveEvents","window","newData","collectRenderValues","isEmptyObject","localization","getResource","selectedSections","selectedSection","setParam","section","getRenderById","expand","saveBox","isStartForm","formtype","confirmation","showConfirmationBox","action","showSaveBox","loading","start","saveForm","isOfflineForm","offlineType","online","syncDeferred","syncParams","deferred","trigger","then","log","arguments","stop","handler","processButtons","saveButton","nextButton","navigation","getNavigation","view_container","getViewContainer","setNavigationButtons","bindTouchEvents","refreshForm","focus","getFocus","options","idCase","idWorkitem","idTask","selectedTabs","getSelectedTabs","getSelectedSection","xpathContext","idPageCache","isRefresh","getEndPointAction","idStartScope","isOfflineRefreshWithEdition","isEdited","postRenderEdit","originalParams","triggerHandler","delay","configureHandlers","configureComplexGateway","$canvas","getValidationsContainer","validationController","command","controllers","validation","validations","actionController","actions","readyDeferred","modalViewDidAppear","clearValidationMessages","modalViewDidDisappear","configureNetworkHandlers","internalSubmitForm","buttonProperties","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","submitData","executeRule","createnewcase","collectRenderValuesForSubmit","animate","scrollTop","dataService","prepare","tag","prepareCheckpointAction","executeButton","idRender","prepareCommitAction","next","back","save","nextWithoutValidations","transitions","activeTransitions","push","countProps","messageComplexGateway","errorComplexGateway","showMessageBox","forcePlanCompletion","contexttype","contextType","surrogatekey","surrogateKey","flowControlDeferred","deferreds","apply","response","multiaction","execute","responses","isNativePluginSupported","isiOSSmartphoneDevice","bHasValidations","result","messages","join","sendRollbackAction","postProcessButton","refresh","routing","IdCase","caseNumber","CaseNumber","nonSupportedMethods","res","res2","messageError","indexOf","errorType","_params","failHandler","validateFeatureSupport","isFloatingButtonsEnabled","isFormButtonsEnabled","dispose","triggerGlobalHandler","eventType","parent","error_obj","JSON","parse","code","refreshAfterSessionIdle","notifier","add","title","sticky","overlay","time","after_close","routingToProcess","processParams","idProcess","webpart","publish","showProcess","hasStartForm","fromNewCase","mapping","renderContainer","template","renderFactory","getTemplate","fasttmpl","uniqueId","helptext","helpText","mode","getMode","queryForm","getFormType","summaryForm","globalForm","displayAsReadOnly","processPath","breadCrumb","orientation","replaceChildrenHtml","renderChildrenHtml","touchMoveStart","event","preventDefault","currentPossitionY","originalEvent","targetTouches","pageY","blur","currentPositionY","changedTouches","ordinal","processButton","complexGatewayContainer","children","hasClass","on","$selected","transitionId","is","mainForm","$currentView","view","footer","panel","contentPanel","tab","material_bizagi_tabs","direction","active_index_tab","activeTab","ev","info","stopPropagation","setActiveTab","rippleEffect","tabItem","setAsActiveContainer","ready","tabs","activate","counter","afterToRefresh","horizontal","layout","accordion","accordionItem","group","toggleClass","collapse","isOpen","toogleContainer","expandedClassIcon","expandedIcon","isDesign","messageValidation","guid","displayAs","dir","getSectionOrientationRTL","mobileModal","anchor","onBeforeShow","m","addToHistoryNavigation","p","getSectionParent","bizagiapp","sectionDidAppear","isFirstLevel","onClose","close","removeFromHistoryNavigation","sectionDidDisappear","selected","pop","searchForm","renderResult","skipInitialLoad","rowsPerPage","sortBy","sortOrder","overrideGetRemoteData","getRemoteData","elements","caption","parseAdditionalProperties","columnVisible","allowDecimals","showTime","grid","getRender","allowAdd","allowEdit","allowDelete","resultsGrid","results","postRenderElement","configureDesignView","configureLayoutView","criteriaContainer","resultsContainer","ui","searchParams","hasOwnProperty","refreshResults","records","rows","Class","searchForms","searchFormParams","searchFormDeferred","searchContainer","createRenderContainer","renderEdition","renderSearchForm","getSearchContainerData","getContainer","keys","map","firstChild","tabContainer","loadSearchTab","currentSearchForm","navigate","containerGridResults","containerSearchCriteria","applyButtons","hasSessionFormException","goToStartPage","errorTemplate","getCommonTemplate","renderAddForm","addContainer","guidEntity","entity","requestedForm","getFormData","addFormParams","style","callback","saveDataAddForm","destroy","maxRows","performSearch","innerHTML","indicator","currentAddForm","handleSearchFormZindex","_","refreshParams","getErrorFormatted","validateForm","forceCollectData","formData","isMapEmpty","dataHasXpath","found","setDisplayValueToControl","renderControlSearchForm","addForm","displayBottomButtons","getSearchFormData","pipe","searchFormContainer","searchFormToLoad","otherElements","isDefault","searchFormData","Math","idSearchForm","url","containerButtons","empty","templateBtn","btnSearch","tmpl","name","btnSelect","btnAdd","btnCancel","setSearchState","toggle","allowNew","virtual","option","modalViewDisplayed","grep","n","slideFormParams","slideContainer","configureViewHandlers","goBack","renderSlideForm","getStartForm","formClass","submitForm","getPageCache","onSave","renders","getRenders","updateOriginalValue","addErrorMessage","containerParams","saveButtonLabel","onCancel","cancelButtonLabel","remove","delegate","xhr","error_message","slideFormDeferred","transformData","allowEdition","shift","row","elementsWithDefaultValue","item","defaultValue","isArray","buttonContainer","isAddForm","pageCacheId","sessionId","transformActions","transformValidations","columnProperties","mapRenderType","defaultvalue","mapValue","recalculate","isColumn","concat","additionallabel","isDisabledControl","includes","isExclusiveCheck","isExclusive","replaceAll","toLowerCase","gridActions","bDependencyFound","dependencies","newAction","encode","transformConditions","conditions","commands","transformCommands","elseCommands","gridValidations","newValidation","condition","expressions","simple","complex","argumentType","renderId","reduce","previousValue","currentValue","parameters","getMetadataForm","$renderEdition","onSaveDataMetadataForm","fileData","metadata","renderType","getRenderType","metadataType","newRender","assign","metadataId","description","readOnly","toUpperCase","thousands","maxLength","autoExtend","update","metadataValues","idMetadata","idFileUpload","fileName","xPath","idAttrib","metaValues","updateECMMetadata","fileProperties","renderReadOnly","sanitizeHTML","validateValue","attachRetypeDouble","retypeDouble","tooltip","createTooltip","$context","currentTitle","cloneRender","readonly","extendedText","minLines","maxLines","maxCharactersToShow","textarea","resize","showChar","startString","substr","endString","toString","encodedText","encodeHtmlText","actualMaxLength","which","prop","updateTextareaSize","configureHandlersReadOnly","$control","delegateTarget","currentRows","scrollHeight","offsetHeight","newValue","number","numericInput","numberToFixedString","executeFormatCurrencyPlugin","formatCurrency","symbol","positiveFormat","negativeFormat","decimalSymbol","digitGroupSymbol","groupDigits","roundToDecimalPlace","numDecimals","colorize","money","date","MAX_YEARS_DISPLAY","dateFormat","ud","dateFormatter","format","substring","search","formatDate","getDateFromFormat","i18n","fullFormat","postRenderReadOnly","getDateControl","dateControl","inputDate","configureMobiscollCalendar","calendarInstance","mobiscroll","isCordovaSupported","isAndroidDevice","cordova","plugins","Keyboard","disableScroll","controlElements","getOrientation","calendar","touchUi","controls","min","getNormalizeDate","Date","minValue","max","maxValue","timeFormat","timePickerFormat","getTimeFormat","datePickerFormat","dateWheels","select","selectType","rtl","lang","languages","BIZAGI_LANGUAGE","language","setValueFromCalendarButtons","v","getCalendarInstance","setVal","inst","clear","onSet","onChangeHandler","onDayChange","onClear","getDateFromInvariant","isiOSDevice","onShow","isNow","currentDate","getVal","currentDateString","formatInvariant","getFullFormatedDate","currentTime","fullDate","formatISO","dateFromFormat","preprocessDateValue","isValid","invalidElements","bValid","checkMinAndMaxValue","hasValue","showMandatoryMessage","isMinValue","vValue","resultValue","getTime","formatedDate","setHour","timeS","isValidMinMaxValue","validateMinAndMaxValue","formattedDate","isNumeric","ci","callBack","actionLauncher","getActions","processPropertyValueArgs","getPropertiesActionLaucher","deferredActions","isHorizontal","templatetype","getPropertyData","processPropertyValueDataTmplArgs","templateData","engine","isDefaultTemplate","wrap","configureActionsHandlers","configureTemplateHandlers","parseInt","guidProcess","guidAction","actionType","readOnlyForm","xpathActions","processAction","actionSheet","actionClicked","expr","FilterAction","array","RegExp","keyup","not","subscribe","filters","multipleSelection","countSameActions","actionManager","act","executeAction","showConfirmationDialog","notifyExecution","class_name","processActionForm","additionalXpaths","additionalXpath","def","slideForm","slide","detailLabel","showSaveButton","isActionStartForm","savedData","editMode","IdScope","renderParams","idForm","caseId","typeForm","surrogatedKey","recordXpath","rewriteContextType","processActionFormCollection","xpathContextWithKey","printf","idEntity","xpathContextWithoutKey","addGridRecordData","IdEntity","addActionToQueue","processStartForm","args","startForm","guidprocess","mappingstakeholders","executeActionImmediately","actionsToExecuteContainer","configureQueueVisibility","listOfActions","getMappingAction","removeActionSelector","openActionSelector","removeActionToQueue","target","extraParams","dataAction","actionsToExecuteTitle","allowactions","len","calculateFilters","polymorphicLauncher","getPolymorphicActions","serializePolymorphicActions","totalActions","clone","lessActions","templateArguments","allowSearch","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","guidObject","guidConstructor","onActionClicked","status","pageCache","maximized","$target","yesno","radio","parsedValue","change","cleanData","check","removeAttr","evt","isCheck","checkList","unique","ceil","random","itemId","onCheckListGroupChange","checked","items","combo","list","renderControl","mobileView","customHeader","contentTemplate","open","configureActions","isDependant","getParentCombo","parentValue","BA_ACTION_PARAMETER_PREFIX","renderCombo","content","configureModalViewHandlers","processComboData","comboValue","findDataValueById","formatItem","selectedValue","valueObjet","$elementsList","$clearButton","header","$searchInput","filterList","$li","stringContainer","stringToSearch","renderComboTemplate","selectedId","hasItems","validateItem","multiSelect","MORE_OPTION_WIDTH","SEARCH_MIN_LENGTH","dataList","getDataValue","isExecutionMode","getData","openModalView","dataMapped","el","template_content","values","isChecked","template_footer","hideSearch","enableTyping","footerTemplate","transition","afterOpenAnimation","scrollIntoView","modalView","$listContainer","$suggestInput","newList","call","querySelector","getAttribute","findItemById","getOfflineData","normalizeData","services","service","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","handSignature","isNative","$actions","$container","getSignatureContainer","autoSave","debounce2","changed","Array","slice","dataImage","saveDeferred","saveSignature","DELAY_TO_SAVE","BzjSignature","saveTimestamp","toDataURL","fire","setData","setState","STATE_TYPE","cancel","onSignatureClear","onSignatureEdit","edit","onSignatureSave","EMPTY_VALUE","clearReference","deleteSignature","executeFormFailHandler","draw","renderSignature","sizeRatio","cssclass","color","pluginInitialized","setSignature","renderSignatureValue","height","round","width","sleepUntil","getFileService","isLoading","buildItemUrl","dataUrl","isDisposed","BASE_IMAGE","EMPTY_IMAGE","postSignature","signature","postSignatureOffline","postSignatureOnline","saveImageOffline","isChanged","deleteImage","buildItemUrlOffline","trim","siblings","getSelectedValue","cascadingCombo","parentCombo","initializingCascadingCombo","isInitialValue","isRendered","deferredVisible","configureCombo","changeCombo","valueItem","getTemplateName","itemSelected","preprocessValue","collectionnavigator","hidden","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","renderItem","noFiles","filesCount","file","files","renderUploadItem","replaceFilesHtml","$contentFile","$inputFile","$nativeFile","checkFileExtensions","attachEvents","media","downloadFile","counterChoseFiles","off","chooseFile","removeFile","getUploadChoices","handlerUploadFile","appear","cancelClicked","getImageResolutionSizes","withoutCancel","handlerResolutionUpload","addFile","navigator","camera","getPicture","extensions","checkMaxSize","getFileDataInfo","checkFileTypes","getAndroidVersion","isAndroid","modalResolutionUpload","buttonIndex","getImageResolutionItems","onFail","quality","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","correctOrientation","saveImage","CAMERA","mediaType","MediaType","PICTURE","destinationType","DestinationType","FILE_URI","targetWidth","targetHeight","device","capture","captureVideo","dataVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","resolution","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","dataItem","dataFile","getImagePath","mimeType","uploadFile","fullPath","addParams","buildAddParams","queueID","encodeXpath","getUploadXpath","FileUploadOptions","fileKey","uploadKey","addUrl","decodeURIComponent","onUploadFileCompleted","processFailMessage","isValidResource","$wrapper","newItem","checkMaxFiles","isMaxFilesReached","maxFiles","maxfiles","actualFiles","validExtensions","validOptions","video","image","split","fileAPISupported","buildAddFileParams","prefix","FormData","BIZAGI_SESSION_NAME","processUploadFile","promises","itemsUpload","errorResponse","responseText","checkMaxSizeFile","deleteUploadItem","triggerRenderChange","getTemplateItemName","maxFileSizeOfProperty","Number","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","updateFilesCount","originalValue","openOfflineFile","handlerWebUploadFile","removeOfflineFile","attachNativeEvents","fileId","randomNumber","resolveBlobFromPath","blob","saveOfflineFile","onUploadOfflineFileCompleted","choosePhoto","takePhoto","addInteractions","collectData","renderValues","identicalObjects","saveResponse","fileUploaded","itemTemplate","filename","canBeSent","failReadFile","fileIndex","fileValue","triggerEvents","method","dataIndex","getFileParams","getOfflineFile","binaryFile","handleBinaryFile","blobFile","operationType","ecm","ERROR_ECM_NO_AVAILABLE","ACTION_DETAILS","ACTION_EDIT","getXpathContext","originalData","getFileProperties","renderFileLayout","metadataECMMultiaction","getECMMetadata","metaData","showMetadata","Filename","attackMenuEvents","addMenuEvents","$fileItem","viewMore","fn","processActionByType","allowUpdateMetadata","allowCheckOut","lockECMFile","allowCancelCheckOut","unlockECMFile","deleteECMFile","overflowMenu","lockUploadItem","replaceWith","unlockUploadItem","performValidationMessage","isFailResponse","lastIndexOf","singleInstance","cellMetadata","setDisplayValueEdit","updateAffectedCellManually","getRowIndexByKey","showMore","buildColumnModel","columnsTotalizers","jQuery","a","summarizeBy","bizagi_grid_smartphone","waiting","table","emptyTable","specialColumn","rowButtons","specialCell","pager","withEditForm","details","allowDetail","inlineAdd","allowMore","totalizer","showSummary","hasTotalizer","pageRequested","submitGridData","onPageRequested","sortRequested","fetchData","page","sortType","isValidGrid","drawCell","isNewRow","cellReady","onCellReady","rowSelected","totalData","onTotalData","gridControlReady","processLayout","isLabelFormat","textFormat","valueFormat","addRow","grantPerformAction","subType","addVirtualRow","editRow","editVirtualRow","deleteRow","showFormDetails","showDetailForm","updateData","changeBackgroundColor","setHeaderStyles","label_style","headerFormat","bold","background","italic","underline","strikethru","size","fetchTotalData","operationState","showTotal","columnIndex","bizAgiProperties","totalize","operation","sum","return_value","count","avg","toFixed","formatTotalizedResult","total","showTotals","sort","searchFilter","getGridData","isRTL","changeOrderData","controlType","formatMonetaryCell","cssClass","showBorder","columnModel","align","columnLabel","gridColumn","dataReady","dataReadyDeferred","setCellOverrides","triggerGridPluginHandler","omitKeys","changes","cellOverride","getCellOverride","renderColumn","newRecords","labelAlign","columntitlealign","valueAlign","columnAlign","drawEditableCell","drawReadonlyCell","cellOverrides","bindRenderChange","newFontSize","outerHTML","originalEditable","getDecorated","submitOnChangexpathContext","dataservice","submitAddRequest","newid","propertiesGridForm","recordXPath","addPage","addLabel","idAsigned","enableEditSubmitRequest","hideLabel","disableProcessButons","hasExclusiveCheck","argumentsfl","formlink","formLink","contextEdit","actionSaveNewRow","actionCancel","actionCancelRow","_sendRelation","_getData","addExclusiveChange","_InternalRenderLinkForm","currentRow","adhocForm","saveAddedRow","containerForm","editPage","editLabel","submitEditRequest","collectGridChange","dataToSend","submitDeleteRequest","rowDeleted","submitRollbackRequest","submitSaveRequest","resp","applyActionUpdateGrid","originalMethod","selfIntern","child","getElementType","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","parentPromise","inlineAddPromise","inlineAddDeferred","setError","changeCellValue","getControlCell","_value","compositeValue","getCompositeValue","changeCellBackgroundColor","background-color","background-image","changeCellColor","changeCellVisibility","findIndex","isCurrentGridCell","getColumn","changeCellEditability","changeEditability","changeCellRequired","changeMinValue","changeMaxValue","emptyValue","rowLength","errorsMessage","showValidationMessage","isBinding","setMilliseconds","merge","getDataNewRows","acum","current","success","stringify","exclusiveChanges","simpleXpath","originalRows","completeRows","isTaskForm","newRowKeys","k","createdOffline","groupBy","groupSummary","addWarning","pendingActions","initialLoadDone","applyGridPlugin","enableXlsExport","enablePdfExport","processChanges","internalRedersValues","internalNewRenderValues","temporalNew","sortArray","currentChanges","columnXpath","canColumnBeSent","columnNumber","match","buildCellXpathFilter","columnValue","addRowData","idRow","creationTimestamp","isNew","b","processOldRows","newRows","tempRows","col","leng","temp","processRow","setSurrogateKey","overrideProperties","now","onCellChange","originalFormat","renderSummary","setHours","newRow","createAddRowData","editInline","saveInlineAddedRows","bRefresh","removeNewRecords","splice","delInfo","deleteUrl","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","DEFAULT_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","deferredReference","searchInput","advancedSearch","_simplySearchView","_advanceSearchView","readyActionExecution","modalViewList","suggestFilter","debounce","autoCompleteSearchResults","selectItem","formSearchParams","helpers","allowFullSearch","maxRecords","refreshControl","getContentTemplate","processRequest","term","renderSearchItem","searchItem","req","suggestions","allowSuggest","searchLength","getSuggestData","state","hideStatus","parseValue","performTermMatches","inputText","allowClear","startsWith","letter","button","needsUserConfirmation","userConfirmationMessage","runButtonAction","pressed","changeFontBold","$label","fileprint","link","preventDefaultForAnchorTag","isValidValue","getFullyDecodedURI","linkEncode","encodeURI","linkSolver","linktarget","linkTarget","isDesignMode","showAsyncImage","configureNativeHandlers","configureHybridHandlers","imageAdd","resolutionButtonHandler","imagePreview","useCamera","imageAddNative","imageAddHybrid","performUploadFile","coordinates","getBoundingClientRect","popoverOptions","CameraPopoverOptions","left","top","imageAddNativeFromCamera","version","imageDelete","uploadFileCompleted","msg","uploadFileNativeOnline","uploadFileHybridOnline","fileService","changeOfflineImageName","htmlImage","configureMenu","baseParams","zoom","useNativeScrolling","imageData","img","getFullImage","formCompatibilityVersion","buildFullItemUrl","$preview","originalImageWidth","$viewMore","buildItemUrlOnline","imageUrl","isOfflineFormsV2Supported","offlineId","buildOfflineImageId","getOfflineImageName","_hasValue","paramsRender","proxyPrefix","serviceLocator","originalElement","orgiginalDisplayType","_isRefreshForm","getFormLinkXpathContext","getFormLinkXpath","hasentryrule","openLink","resolveCheckpointRequest","openLinkRule","paintFormLink","rollbackForm","property","getPropertyValue","dataRuleResp","showErrorMessage","propertyName","extra","jqXHR","textStatus","errorThrown","withAddForm","hideSaveButton","saveRecord","error_code","executeSubmitOnChange","hasexitrule","closeExitRule","resolveSubmitCommitRequest","ex","err","saveGridRecord","saveUrl","submitCommitRequest","submitCheckpointRequest","parentXpathContext","geolocation","ALLOW_UPDATE","coordinate","updateDisplayValue","performPrecision","onSuccess","position","coords","latitude","longitude","getCurrentPosition","association","getFlipAssociation","flip","makeJsonBase","flipped","columnData","getColumnData","getRightAssociation","formatJson","dataAssociation","rightData","leftData","isExecution","addEventControl","showDefaultGroupList","$groups","slideDown","$input","parentId","addElement","removeElement","flipstate","$element","$groupList","parents","closeAccordionSection","active","slideUp","searchList","SEARCH_ELEMENTS","searchListInput","_searchListViewModal","getHeaderTemplate","getFooterTemplate","cssClassHeader","adjustResize","finalValue","deleteItem","templateItem","getTagTemplate","modalViewTagList","modalFooter","modalHeader","getListItems","initialScreenSize","innerHeight","emptyItems","userfieldWrapper","getUserfieldControl","sControl","userfieldName","exists","eval","createUserfieldInstance","userfield","userfieldGuid","getUserfieldDefinition","loadUserfield","dynamicFunction","initialParams","getUserFieldInstance","isUserField","userfieldInstance","replicateUserfieldMethods","styleContent","styleGuid","str","loadStyle","defaultUserField","designUserField","startUserfieldLoading","endUserfieldLoading","userfieldDefinition","basicUserField","renderSingle","renderUserfieldControl","getEditableControl","isSupported","getReadonlyControl","controlName","goal","activityDescription","newItemName","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","resolved","setItemLocalStorage","hasChanges","idActivity","itemsResolved","progress","activityWork","prepareNewItem","that","contentHolder","closest","itemPosition","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","keypress","addItem","guidItem","checkListHtml","refreshValue","completed","floor","controlValueIsChanged","numberScientificNotation","range","rangeDate","defineRangeControl","rangeMoney","rangeNumber","layoutRender","layoutImage","templateUri","getImageUri","ajax","processData","contentType","getResponseHeader","byteArrayToBlob","stringToByteArray","urlCreator","URL","webkitURL","createObjectURL","hash","idcase","idworkitem","contextxpath","getUrl","replaceMultiple","layoutPlaceholder","layoutBoolean","layoutLink","proxy","onClickElement","navigateFromRender","reference","referenceType","kendoMobileApplication","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getValueFilesByData","valueResult","getHTMLFiles","getUploadFileEntityUrl","isContextContainerWidgetRender","guidentity","applyOverrides","originalGetControl","isValueValid","propertyOverrides","applyColumnStyles","cellIcon","getXpath","getDocumentXpath","getContextXpath","documentTemplateGenerate","preRenderControl","deleteDocumentTemplate","xpathcontext","generateDocumentTemplate","autoOpenDocuments","xpathPath","tableCell","deleteUploadFile","columnXpathSplit","nameFile","getUploadFileUrl","calculateInitialLayoutProperties","refreshCell","getECMXpathContext","idSession","gridChanges","mapEnabledOfflineChecks","mapEnabledCheck","overrideDecoratedRenderProperties","enabledChecks","tmpDecorated","handleOfflineChange","simpleXpathArray","newChange","updateGridData","r","allRows","rowId","rowValue","ACTION_SHOW","ACTION_DOWNLOAD","ACTION_DELETE","documents","downloadalldocuments","allowgenerate","allowGenerate","renderDocumentsHtml","renderActionsHtml","replaceActionsHtml","$inputDocument","$listDocuments","$listActions","getTemplateReadonly","buttonExecuted","validate","validateContainer","documentFile","renderAllDocumentDownload","getTemplateDownload","buildAllDocumentsUrl","joined","redrawDocuments","downloadAllDocuments","$documentContainer","$actionContainer","showDocumentPreview","resolveDocumentTemplateGenerate","resolveDeleteDocumentTemplate","formTemplate","regularExpressionExpression","regularExpression","expression","regularExpressionMessage","isEmptyField","retype","mask","validationMessages","keyUnicode","charCode","keyCode","valueToDisplay","isNull","performDesignModeMethods","internalSetInitialValue","factory","loadTemplates","loadTemplate","getFileTemplate","tmplIcons","src","onDemand","detectDevice","usersForm","nestedForm","mobileform","mobilegroup","columnParams","isExtended","exclusiveCheck","override","hiddenControlsWithDataType","uploadecm","offline","enableQuerySuggestBehavior","entityTemplate","getSearchRender","activityCheckList","getLayoutRender","getRangeRender","specific_text"],"mappings":"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","sourcesContent":["function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Search Slide Implementation\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will shows a search form\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n$.Class.extend(\"bizagi.rendering.smartphone.helpers.searchForm\", {}, {\n\n  /**\r\n                                                                        * Constructor\r\n                                                                        */\n  init: function init(dataService, renderFactory, searchForms, searchParams, searchFormParams) {\n    this.dataService = dataService;\n    this.renderFactory = renderFactory;\n    this.searchForms = searchForms;\n    this.searchParams = searchParams;\n    this.searchFormParams = searchFormParams;\n\n    this.searchFormDeferred = new $.Deferred();\n\n    // Creates a container, be careful you must destroy it later\n    this.searchContainer = this.searchFormParams.navigation.createRenderContainer({ title: this.searchFormParams.displayName });\n  },\n\n  /**\r\n      * Render the edition form,... if is an addform, then show the currentAddForm view\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderEdition: function renderEdition(params) {\n    this.properties = params;\n\n    // Render the search form\n    this.renderSearchForm(params);\n\n    // Return promise\n    return this.searchFormDeferred.promise();\n  },\n\n  /**\r\n      * Get the searchform and render it!\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderSearchForm: function renderSearchForm(params) {\n    var self = this;\n\n    var container = self.searchContainer;\n\n    $.when(self.getSearchContainerData(params)).then(function (data) {\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      if (data.form.properties) {\n        data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\n      }\n\n      var form = self.renderFactory.getContainer($.extend({}, self.searchFormParams, {\n        type: \"form\",\n        data: data.form,\n        navigation: self.searchFormParams.navigation,\n        view_container: container }));\n\n\n      self.form = form;\n\n      (Object.keys(form.children) || []).\n      map(function (key) {\n        form.children[key].params = $.extend({}, form.children[key].params, self.searchFormParams);\n      });\n\n      return form.render();\n\n    }).done(function (element) {\n      var firstChild = self.form.firstChild();\n      var tabContainer = firstChild.properties.type === \"tab\" ? firstChild : null;\n\n      if (tabContainer) {\n        // Bind select tab event\n        tabContainer.bind(\"selected\", function (e, ui) {\n          var searchForm = self.searchForms[ui.index];\n          $.when(self.loadSearchTab(params, ui.tab, searchForm)).\n          done(function () {\n            // Set currents search form\n            self.currentSearchForm = ui.tab.firstChild();\n            self.currentSearchForm.triggerHandler(\"ondomincluded\");\n          });\n        });\n\n        tabContainer.container.tabs(\"select\", 0);\n        self.currentSearchForm = tabContainer.firstChild().firstChild();\n\n        if (!self.currentSearchForm.readyDeferred)\n        self.currentSearchForm.readyDeferred = new $.Deferred();\n\n        self.currentSearchForm.triggerHandler(\"ondomincluded\");\n      } else {\n        // Set currents search form\n        self.currentSearchForm = self.form.firstChild();\n\n        if (!self.currentSearchForm.readyDeferred)\n        self.currentSearchForm.readyDeferred = new $.Deferred();\n\n        self.currentSearchForm.triggerHandler(\"ondomincluded\");\n      }\n\n      container.element.html(element);\n      self.searchFormParams.navigation.navigate(container.id);\n\n      self.containerGridResults = self.currentSearchForm.container.find(\".bz-container__search-results\");\n      self.containerSearchCriteria = self.currentSearchForm.container.find(\".bz-container__search-criteria\");\n\n      self.applyButtons(container);\n    }).fail(function (error_obj) {\n      if (self.hasSessionFormException(error_obj)) {\n        self.goToStartPage(error_obj);\n      } else {\n        var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n        var message = error_obj && error_obj.message ? error_obj.message : error_obj;\n\n        $($.fasttmpl(errorTemplate, { message: message })).\n        appendTo(container.element);\n\n        self.searchFormParams.navigation.navigate(container.id);\n      }\n    });\n  },\n\n  /**\r\n      * Get the addform and show it\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderAddForm: function renderAddForm(params) {\n    var self = this;\n    params = params || {};\n    var properties = self.properties;\n\n    if (typeof self.addContainer === \"undefined\") {\n      var message = bizagi.localization.getResource(\"render-dialog-entity\");\n      self.addContainer = self.searchFormParams.navigation.createRenderContainer({ title: message });\n\n      // Binds the view close event, and send the RollBack\n      self.addContainer.element.bind(\"close\", function () {\n        delete self.addContainer;\n      });\n    }\n\n    var isRefresh = params.isRefresh || false;\n\n    var getFormParams = {\n      idPageCache: params.idPageCache,\n      guidEntity: properties.entity,\n      contextType: \"entity\" };\n\n\n    if (isRefresh) {\n      getFormParams.isRefresh = true;\n      getFormParams.idStartScope = params.idStartScope;\n    } else {\n      getFormParams.idRender = properties.idRender;\n      getFormParams.requestedForm = \"addForm\";\n    }\n\n    // Get the addform\n    $.when(self.dataService.getFormData(getFormParams)).then(function (data) {\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      if (typeof data.form.properties !== \"undefined\") {\n        data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\n      }\n\n      data.form.contextType = \"entity\";\n\n      var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\n        type: \"form\",\n        data: data.form,\n        focus: params.focus || false,\n        selectedTabs: params.selectedTabs,\n        isRefresh: isRefresh,\n        requestedForm: params.requestedForm,\n        navigation: self.searchFormParams.navigation,\n        view_container: self.addContainer }));\n\n\n      form.buttons = [\n      $.extend(\n      form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          return self.saveDataAddForm(form).done(function () {\n\n            self.addContainer.destroy();\n            delete self.addContainer;\n\n            // TIMER: Prevent the Form is locked if not destroy the addForm\n            setTimeout(function () {\n              // Force a search after a new item is created!\n              self.searchParams.maxRows = 1;\n              self.currentSearchForm.performSearch(self.searchParams);\n            }, 350);\n\n          });\n        } }),\n\n      $.extend(\n      form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        // This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          self.addContainer.destroy();\n          delete self.addContainer;\n        } })];\n\n\n\n      $.extend(form, {\n        processButtons: function processButtons() {\n          // Not send information set in memory and save\n          $.each(form.buttons, function (index, element) {\n            switch (element[\"ordinal\"]) {\n              case 1: //next button will behave as a cancel button\n                $(form.getButtons()[index]).click(function () {\n                  self.addContainer.destroy();\n                  delete self.addContainer;\n                });\n\n                form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                form.buttons[index].action = \"back\";\n                break;\n\n              default:\n                $(form.getButtons()[index]).click(function () {\n                  self.saveDataAddForm(form);\n\n                  self.addContainer.destroy();\n                  delete self.addContainer;\n                });\n                break;}\n\n          });\n        } });\n\n\n      (Object.keys(form.children) || []).\n      map(function (indicator) {\n        form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\n      });\n\n      return $.when(form.render()).done(function (element) {\n        // Set currents search form\n        self.currentAddForm = form.firstChild();\n        self.addContainer.element.html(element);\n\n        if (!isRefresh) {\n          self.searchFormParams.navigation.navigate(self.addContainer.id);\n        }\n\n        self.addContainer.setNavigationButtons(form);\n\n        form.triggerHandler(\"ondomincluded\");\n\n        // if is any modal view displayed, hide it to allow this search form been displayed\n        self.handleSearchFormZindex(\"show\");\n\n        form.bind(\"refresh\", function (_, refreshParams) {\n          refreshParams.scrollTop = self.form.container.parent().scrollTop();\n          refreshParams = $.extend({\n            focus: focus,\n            selectedTabs: self.form.getSelectedTabs(),\n            isRefresh: true,\n            contextType: self.properties.contextType || \"\",\n            navigation: self.searchFormParams.navigation,\n            view_container: self.addContainer },\n          refreshParams);\n\n          return self.renderAddForm(refreshParams);\n        });\n\n      });\n    }).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n\n      if (self.hasSessionFormException(error_obj)) {\n        self.goToStartPage(error_obj);\n      } else {\n        self.addContainer.destroy();\n        delete self.addContainer;\n      }\n    });\n  },\n\n  /**\r\n      * Save data to add form\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  saveDataAddForm: function saveDataAddForm(form) {\n    var self = this;\n    var defer = $.Deferred();\n\n    if (form.validateForm()) {\n      var data = {};\n      $.forceCollectData = true;\n\n      form.collectRenderValues(data);\n      data.idPageCache = form.idPageCache;\n\n      var params = {\n        action: \"SAVE\",\n        data: data,\n        idPageCache: data.idPageCache,\n        guidEntity: form.properties.entity,\n        contexttype: \"entity\" };\n\n\n      // Check if the add form has data\n      var formData = {};\n\n      form.collectRenderValuesForSubmit(formData);\n\n      // Turn off flag\n      $.forceCollectData = false;\n\n      if (!bizagi.util.isMapEmpty(formData)) {\n        $.when(self.dataService.submitData(params)).\n        done(function (response) {\n          function dataHasXpath(xpath) {\n            var render = self.currentSearchForm.getRender(xpath);\n\n            if (_typeof(render) === \"object\" && render !== null)\n            return { \"found\": true, \"obj\": render };\n            return { \"found\": false, \"obj\": {} };\n          }\n\n          if (response && response.type === \"validationMessages\") {\n            form.addValidationMessage(response.messages);\n            defer.reject();\n          } else {\n\n            for (var i in formData) {\n              var mapping = dataHasXpath(i);\n              if (mapping.found) {\n                mapping.obj.setValue(formData[i]);\n                self.setDisplayValueToControl(mapping.obj, form, i, formData);\n              }\n            }\n\n            defer.resolve();\n          }\n        }).fail(function (error) {\n          var error_obj = bizagi.util.getErrorFormatted(error);\n\n          if (self.hasSessionFormException(error_obj)) {\n            self.goToStartPage(error_obj);\n          } else {\n            var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n\n            form.addValidationMessage(message);\n          }\n\n          defer.reject();\n        });\n      } else {\n        // Form has not data\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\n        defer.reject();\n      }\n    } else {\n      defer.reject();\n    }\n\n    return defer;\n  },\n\n  /***\r\n      * Set display value by control type, when add new record\r\n      * @param renderControlSearchForm\r\n      * @param addForm\r\n      * @param xpath\r\n      * @param formData\r\n      */\n  setDisplayValueToControl: function setDisplayValueToControl(renderControlSearchForm, addForm, xpath, formData) {\n    if (renderControlSearchForm.properties.type === \"searchSuggest\") {\n      renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\n    } else {\n      renderControlSearchForm.setDisplayValue(formData[xpath]);\n    }\n  },\n\n  /**\r\n      * configure searchform buttons\r\n      * */\n  applyButtons: function applyButtons(container) {\n    var self = this;\n\n    self.displayBottomButtons(container);\n\n    container.element.bind(\"close\", function () {\n      self.searchFormDeferred.reject();\n    });\n  },\n\n  loadSearchTab: function loadSearchTab(params, tab, searchForm) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // If the tab has children it is loaded already\n    if (tab.children.length > 0) return null;\n\n    // Load search form data\n    $.when(self.getSearchFormData(params, searchForm)).\n    pipe(function (data) {\n      // Render data inside selected tab\n      var searchFormContainer = self.renderFactory.getContainer({\n        type: \"searchForm\",\n        data: data.form });\n\n\n      tab.children.push(searchFormContainer);\n      return searchFormContainer.render();\n    }).\n    done(function (element) {\n      // Remove button container\n      $(\".ui-bizagi-button-container\", element).detach();\n      tab.container.append(element);\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Creates the search dialog sub-containers\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getSearchContainerData: function getSearchContainerData(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var data = {\n      form: {\n        properties: {},\n        elements: [] } };\n\n\n\n    var container = data.form;\n    var searchFormToLoad = self.searchForms[0];\n\n    // When there are more than one search form, render a tab container\n    if (self.searchForms.length > 1) {\n      var tabContainer = {\n        properties: {\n          type: \"tab\" },\n\n        elements: [] };\n\n\n      var otherElements = [];\n\n      $.each(self.searchForms, function (i, searchForm) {\n        var isDefault = searchForm[\"default\"] || false;\n        // Create tab item\n        var tab = {\n          properties: {\n            id: i,\n            type: \"tabItem\",\n            displayName: searchForm.caption },\n\n          elements: [] };\n\n\n        // Append children\n        if (isDefault) {\n          tabContainer.elements.push({ container: tab });\n          // Set properties to load default container\n          container = tab;\n          searchFormToLoad = self.searchForms[0];\n        } else {\n          otherElements.push({ container: tab });\n        }\n      });\n\n      // Append no defaults elements\n      $.each(otherElements, function (i, element) {\n        tabContainer.elements.push(element);\n      });\n\n      data.form.elements.push({ container: tabContainer });\n    }\n\n    // Loads default form\n    $.when(self.getSearchFormData(params, searchFormToLoad)).\n    done(function (searchFormData) {\n      container.elements.push(searchFormData);\n      container.properties.id = Math.guid();\n\n      // Resolve deferred\n      deferred.resolve(data);\n    }).fail(function (error) {\n      var message = bizagi.util.getErrorFormatted(error);\n      deferred.reject(message);\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Loads a search form\r\n      * @param {} params\r\n      * @param {} searchForm\r\n      * @returns {}\r\n      */\n  getSearchFormData: function getSearchFormData(params, searchForm) {\n    var self = this;\n\n    return self.dataService.getSearchFormData($.extend(params, {\n      idSearchForm: searchForm.id,\n      url: searchForm.url })).\n    pipe(function (data) {\n      // Append search render properties\n      data.form.properties.idRender = params.idRender;\n      return data;\n    });\n  },\n\n  displayBottomButtons: function displayBottomButtons(container) {\n    var self = this;\n    var containerButtons = self.currentSearchForm.container.find(\".bz-container__button-edit\").empty().show();\n    var templateBtn = \"<button class='ui-bizagi-form-button ${name}'>${text}</button>\";\n\n    var btnSearch = $.tmpl(templateBtn, {\n      name: \"bz-btn-search\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-search\") }).\n    appendTo(containerButtons);\n\n    var btnSelect = $.tmpl(templateBtn, {\n      name: \"bz-btn-select\",\n      text: bizagi.localization.getResource(\"render-search-advanced-results-button\") }).\n    appendTo(containerButtons);\n\n    var btnAdd = $.tmpl(templateBtn, {\n      name: \"bz-btn-add\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-add\") }).\n    appendTo(containerButtons);\n    var btnCancel = $.tmpl(templateBtn, {\n      name: \"bz-btn-cancel\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\") }).\n    appendTo(containerButtons);\n\n    container.element.bind(\"close\", function (e) {\n      //If the view results is in front, shouldn't go back, but change the showed panel\n      if (self.containerSearchCriteria.css(\"display\") === \"none\") {\n        e.preventDefault();\n        setSearchState();\n      }\n    });\n\n    var setSearchState = function setSearchButtons() {\n      // List possible buttons for search\n      var buttons = [\n      {\n        \"ordinal\": 1,\n        \"action\": \"search\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-search\"),\n        \"callback\": function callback() {\n          // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\n          self.searchParams.maxRows = 1;\n          return self.currentSearchForm.performSearch(self.searchParams);\n        } },\n\n      {\n        \"ordinal\": 2,\n        \"action\": \"cancel\",\n        \"caption\": \"cancel\",\n        \"callback\": function callback() {\n          self.searchFormDeferred.reject();\n          container.destroy();\n        } },\n\n      {\n        \"ordinal\": 3,\n        \"action\": \"add\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\n        \"callback\": function callback() {\n          var params = {\n            \"idCase\": self.searchFormParams.idCase,\n            \"idRender\": self.properties.idRender,\n            \"displayName\": self.properties.displayName,\n            \"idPageCache\": self.properties.idPageCache };\n\n\n          self.renderAddForm(params);\n        } }];\n\n\n\n      self.containerSearchCriteria.show();\n      self.containerGridResults.hide();\n\n      // Add only seen when allowed\n      $(btnAdd).toggle(self.searchParams.allowNew);\n      btnSearch.show();\n      btnSelect.hide();\n\n      if (!self.searchParams.allowNew) {\n        buttons.pop();\n      }\n\n      self.form.buttons = buttons;\n      delete self.form.properties.virtual;\n      container.setNavigationButtons(self.form);\n    };\n\n    var setResultState = function setSearchButtons() {\n\n      // List posible buttons for result\n      var buttons = [\n      {\n        \"ordinal\": 4,\n        \"action\": \"select\",\n        \"caption\": bizagi.localization.getResource(\"render-search-advanced-results-button\"),\n        \"callback\": function callback() {\n          self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\n          container.destroy();\n        } },\n\n      {\n        \"ordinal\": 5,\n        \"action\": \"cancel\",\n        \"caption\": \"cancel\",\n        \"callback\": function callback() {\n          setSearchState();\n        } },\n\n      {\n        \"ordinal\": 3,\n        \"action\": \"add\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\n        \"callback\": function callback() {\n          var params = {\n            \"idCase\": self.searchFormParams.idCase,\n            \"idRender\": self.properties.idRender,\n            \"displayName\": self.properties.displayName,\n            \"idPageCache\": self.properties.idPageCache };\n\n\n          self.renderAddForm(params);\n        } }];\n\n\n\n      self.containerSearchCriteria.hide();\n      self.containerGridResults.show();\n\n      // Add only seen when allowed\n      $(btnAdd).toggle(self.searchParams.allowNew);\n      btnSearch.hide();\n      btnSelect.show();\n\n      if (!self.searchParams.allowNew) {\n        buttons.pop();\n      }\n\n      self.form.buttons = buttons;\n      self.form.properties.virtual = true;\n      container.setNavigationButtons(self.form);\n    };\n\n    btnSearch.bind(\"click\", function () {\n      // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\n      self.searchParams.maxRows = 1;\n      self.currentSearchForm.performSearch(self.searchParams);\n    });\n\n    btnAdd.bind(\"click\", function () {\n      var params = {\n        \"idCase\": self.searchFormParams.idCase,\n        \"idRender\": self.properties.idRender,\n        \"displayName\": self.properties.displayName,\n        \"idPageCache\": self.properties.idPageCache };\n\n\n      self.renderAddForm(params);\n    });\n\n    btnCancel.bind(\"click\", function () {\n      self.searchFormDeferred.reject();\n      container.destroy();\n    });\n\n    btnSelect.bind(\"click\", function () {\n      self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\n      container.destroy();\n    });\n\n    self.currentSearchForm.bind(\"instancerefreshdone\", function () {\n      // Show search results container\n      if (self.currentSearchForm.resultsGrid.properties.data !== null &&\n      !$.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\n      self.currentSearchForm.resultsGrid.properties.data.rows.length > 0)\n      {\n        setResultState();\n      } else {\n        setSearchState();\n      }\n    });\n\n    setSearchState();\n  },\n\n  handleSearchFormZindex: function handleSearchFormZindex(option) {\n    // If there is an open modal, change z-index to make searchForm visible\n    var modalViewDisplayed = $.grep($(\".km-modalview-root\"), function (n, i) {\n      return $(n).css(\"display\") === \"block\";\n    });\n\n    if (modalViewDisplayed.length > 0) {\n      var index = option === \"show\" ? 0 : 10001;\n      $(modalViewDisplayed).css(\"z-index\", index);\n    }\n  },\n\n  /**\r\n      * Idle timer expired exception\r\n      * @param error\r\n      * @returns {boolean}\r\n      */\n  hasSessionFormException: function hasSessionFormException(error) {\n    return typeof error !== \"undefined\" && error.code === \"AUTH_ERROR\";\n  },\n\n  /**\r\n      * Navigate to main page\r\n      * @param error\r\n      */\n  goToStartPage: function goToStartPage(error) {\n    if (this.searchFormParams.navigation) {\n      this.searchFormParams.navigation.goToStartPage(error);\n    }\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi smartphone Render list Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the list render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.list.prototype);\n// Extends itself\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", {}, {\n\n  /*\r\n                                                                                  *   Template method to implement in each children to customize each control\r\n                                                                                  */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"list\");\n\n    return $.fasttmpl(template, {\n      editable: this.properties.editable,\n      value: this.getDisplayValue() });\n\n\n  },\n\n  /**\r\n      * Add event handlers to the combo control\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    $(\".bz-form-list\", control).bind(\"click\", function () {\n\n      $(this).mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\n        displayName: self.properties.displayName || \"\",\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: \"\",\n\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n\n        configureActions: function configureActions(context) {\n          var params = {};\n          if (self.isDependant && self.properties && /^cascadingcombo$/i.test(self.properties.type) && self.getParentCombo) {\n            var parentValue = self.getParentCombo().getValue();\n            if (parentValue && parentValue.id) {\n              params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\n            }\n          }\n\n          $.when(self.renderCombo(params)).done(function (list) {\n            $(\".bz-modal-view__content\", context.content).html(list);\n            self.configureModalViewHandlers(context);\n          });\n        } });\n\n    });\n\n  },\n\n  processComboData: function processComboData(data) {\n    var self = this;\n    data.forEach(function (value) {\n      self.validateValue(value);\n    });\n  },\n\n  /**\r\n      * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n      * */\n  setDisplayValue: function setDisplayValue(value) {\n    var comboValue;\n    value = this.mapValue(value);\n\n    if (value && _typeof(value) === \"object\" && typeof value.label !== \"undefined\") {\n\n      if (value.label !== \"\" && !bizagi.util.isNumeric(value.label)) {\n        comboValue = value.label;\n      } else {\n        var selected = this.findDataValueById(value.value);\n        comboValue = selected ? selected.value : \"\";\n      }\n\n      if ($.isArray(comboValue)) {\n        comboValue = comboValue.join(\" - \");\n      }\n      value = { \"id\": value.id, \"value\": comboValue };\n    }\n\n    var control = this.getControl();\n    $(\"input\", control).val(this.formatItem(value.value));\n\n    //Set Value\n    this.selectedValue = value;\n    this.setValue(value);\n  },\n\n  /**\r\n      * Set the handlers for the modal elements\r\n      * @param {kendoModalObject} context full modal object\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(context) {\n    var self = this;\n\n    $(\".bz-list__item\", context.content).on(\"click\", function () {\n      var valueObjet = {\n        \"id\": $(this).data(\"value\"),\n        \"value\": $(this).text() };\n\n\n      if (valueObjet.id == \"\") {\n        valueObjet.value = \"\";\n      }\n\n      self.setDisplayValue(valueObjet);\n      self.trigger(\"select\", [valueObjet, false]);\n      context.close();\n    });\n\n    var $elementsList = $(\".bz-list li\", context.content);\n    var $clearButton = $(\".bz-modal-view__clear\", context.header);\n    var $searchInput = $(\".bz-modal-view__search\", context.header);\n\n    $(\"[data-action=close]\", context.header).bind(\"click\", function () {\n      context.close();\n    });\n\n    $clearButton.bind(\"click\", function () {\n      $searchInput.val(\"\").trigger(\"change\");\n    });\n    // Filtering list\n    $searchInput.bind(\"change keyup\", function () {\n      if (this.value == \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      self.filterList(this.value, $elementsList);\n    }).focus();\n  },\n\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n\n    $li.filter(function () {\n      var stringContainer = $(this).text().toUpperCase();\n      var stringToSearch = search.toUpperCase();\n\n      if (stringContainer.indexOf(stringToSearch) >= 0) {\n        return $(this);\n      } else {\n        $(this).hide();\n      }\n    }).show();\n  },\n\n  /**\r\n      * Print the list of elements to show in the modal\r\n      * @param {object} data list of elements to print\r\n      */\n  renderComboTemplate: function renderComboTemplate(data) {\n    var template = this.renderFactory.getTemplate(\"list-items\");\n    var value = this.getValue();\n    value = value !== null && typeof value !== \"undefined\" ? value : { \"id\": \"\", \"value\": \"\" };\n\n    return $.fasttmpl(template, {\n      \"items\": data,\n      \"selectedId\": value.id,\n      \"hasItems\": data.length > 0 },\n    {\n      \"validateItem\": this.validateValue });\n\n  },\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render option select\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   Renders an option html input with attached handlers\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.combo\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.combo.extend(\"bizagi.rendering.smartphone.combo\", {}, {\n\n  /*\r\n                                                                                    *   Template method to implement in each children to customize each control\r\n                                                                                    */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"combo\");\n\n    return $.fasttmpl(template, {\n      editable: this.properties.editable,\n      value: this.getDisplayValue() });\n\n\n  },\n\n  /* \r\n     *   Gets the display value of the render\r\n     */\n  getDisplayValue: function getDisplayValue() {\n    var self = this;\n    var displayValue = \"\";\n    var item = self.getValue();\n\n    if (self.combo && self.combo.length > 0) {\n      // When there is a combo painted, we fetch the selected value from it\n      item = self.getSelectedValue();\n    }\n\n    if (item) {\n      // Check on cached propert from server first if the key exists\n      displayValue = self.formatItem(item.value);\n    }\n\n    return displayValue;\n  },\n\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this._super();\n\n    this.combo = $control.find(\"input\");\n    this.itemSelected = undefined;\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.combo = $control.find(\"input\");\n  },\n\n  /**\r\n      * Add event handlers to the combo control\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    $(\".bz-form-combo\", control).bind(\"click\", function () {\n\n      $(this).mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {\n          hideSearch: self.properties.enableTyping === false }),\n\n        displayName: self.properties.displayName || \"\",\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: \"\",\n\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n\n        configureActions: function configureActions(modalView) {\n          var params = {};\n\n          if (self.isDependant && self.properties && /cascadingcombo/i.test(self.properties.type) && self.getParentCombo) {\n            var parentValue = self.getParentCombo().getValue();\n            if (parentValue && parentValue.id) {\n              params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\n            }\n          }\n\n          $.when(self.renderCombo(params)).done(function (list) {\n            $(\".bz-modal-view__content\", modalView.content).html(list);\n            self.configureModalViewHandlers(modalView);\n          });\n        } });\n\n    });\n\n  },\n\n  processComboData: function processComboData(data) {\n    var self = this;\n    data.forEach(function (value) {\n      self.validateValue(value);\n    });\n  },\n\n  /**\r\n      * Setting the display value, always you call a setDisplayValue yor are performing a setValue under the hood.\r\n      * */\n  setDisplayValue: function setDisplayValue(value) {\n    var comboValue = \"\";\n\n    value = this.mapValue(value);\n    value = this.preprocessValue(value);\n\n    if (value && _typeof(value) === \"object\" && typeof value.label !== \"undefined\") {\n\n      if (!bizagi.util.isEmpty(value.label)) {\n        comboValue = value.label;\n      } else {\n        var selected = this.findDataValueById(value.id);\n        comboValue = selected ? selected.value : \"\";\n      }\n\n      if ($.isArray(comboValue)) {\n        comboValue = comboValue.join(\" - \");\n      }\n\n      value = { \"id\": value.id, \"value\": comboValue };\n    }\n\n    if (this.properties.editable) {\n      this.combo.val(this.formatItem(value.value));\n    } else {\n      var control = this.getControl();\n      $(control).html(this.formatItem(value.value));\n    }\n\n    //Set Value\n    this.selectedValue = value;\n    this.setValue(value);\n  },\n\n  /**\r\n      * Set the handlers for the modal elements\r\n      * @param modalView full modal object\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    $(\".bz-list__item\", modalView.content).on(\"click\", function () {\n      var valueObjet = {\n        \"id\": $(this).data(\"value\"),\n        \"value\": $(this).text() };\n\n\n      if (valueObjet.id == \"\") {\n        valueObjet.value = \"\";\n      }\n\n      self.itemSelected = true; //must be before the setDisplayValue\n      self.setDisplayValue(valueObjet);\n      self.trigger(\"select\", [valueObjet, false]);\n      modalView.close();\n    });\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    if (this.properties.enableTyping) {\n\n      var $elementsList = $(\".bz-list li\", modalView.content);\n      var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n      var $searchInput = $(\".bz-modal-view__search\", modalView.header);\n\n      $clearButton.bind(\"click\", function () {\n        $searchInput.val(\"\").trigger(\"change\");\n      });\n      // Filtering list\n      $searchInput.on(\"change keyup\", function () {\n        if (this.value == \"\") {\n          $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n        } else {\n          $clearButton.addClass(\"bz-modal-view__clear--visible\");\n        }\n        self.filterList(this.value, $elementsList);\n      }).on(\"focus\", function () {\n        modalView.header.addClass(\"bz-modal-view__header--active\");\n      }).on(\"blur\", function () {\n        modalView.header.removeClass(\"bz-modal-view__header--active\");\n      });\n\n    }\n  },\n\n  cleanData: function cleanData() {\n    var value = { id: \"\", value: \"\" };\n    //Set Value\n    this.value = this.properties.value = this.selectedValue = value;\n    var control = this.getControl();\n    $(\"input\", control).val(this.formatItem(value.value));\n  },\n\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n\n    $li.filter(function () {\n      var stringContainer = $(this).text().toUpperCase();\n      var stringToSearch = search.toUpperCase();\n\n      if (stringContainer.indexOf(stringToSearch) >= 0) {\n        return $(this);\n      } else {\n        $(this).hide();\n      }\n    }).show();\n  },\n\n  /**\r\n      * Print the list of elements to show in the modal\r\n      * @param {object} data list of elements to print\r\n      */\n  renderComboTemplate: function renderComboTemplate(data) {\n    var template = this.renderFactory.getTemplate(\"combo-list\");\n    var value = this.getValue();\n    value = value !== null && typeof value !== \"undefined\" ? value : { \"id\": \"\", \"value\": \"\" };\n\n    return $.fasttmpl(template, {\n      \"items\": data,\n      \"selectedId\": value.id,\n      \"hasItems\": data.length > 0 },\n    {\n      \"validateItem\": this.validateValue });\n\n  },\n\n  /**\r\n      * Returns the selected value in the template\r\n      * @returns {{id: *, value: *}}\r\n      */\n  getSelectedValue: function getSelectedValue() {\n    return this.selectedValue;\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","var _bizagi$rendering$sma;function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;} /**\r\n                                                                                                                                                                                                                                      *   Name: Bizagi Smartphone Render Grid Extension\r\n                                                                                                                                                                                                                                      *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                      *   Comments:\r\n                                                                                                                                                                                                                                      *   -   This script will redefine the grid render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                      */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.grid\", bizagi.rendering.grid.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid\", {}, (_bizagi$rendering$sma = {\n\n  init: function init(params) {\n    var self = this;\n    var data = params.data;\n\n    //support multiples instances of decorates objects   the object in false means \n    //enable the decorated is an array and so can save several renderings\n    data.properties.singleInstance = false;\n\n    data.properties.rowsPerPage = 1;\n    data.properties.displayType = \"vertical\";\n\n    // Call base\n    self._super(params);\n\n    // Create a data-structure to keep track of each cell properties\n    this.cellMetadata = {};\n\n    // Fill default properties\n    var properties = this.properties;\n\n    // Just apply display-type: vertical, align it to the left\n    properties.displayType = \"vertical\";\n    properties.rowsPerPage = 1;\n\n    //revisar base para mejorar comportamiento cuando esta en false los elementos\n    $.each(self.columns, function (index, value) {\n      // Enable to apply edit and next send request\n      if (this.properties && this.properties.editable)\n      this.properties.editable = properties.allowEdit == true ? true : false;\n    });\n\n    // Just for smartphones we need to take only one row if there is data in the json,\n    // because we use just one row per page\n    if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\n      var newData = [];\n      newData.push(properties.data.rows[0]);\n      properties.data.rows = newData;\n    }\n  },\n\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n    data.properties.displayType = \"vertical\";\n  },\n\n  /* method overrides\r\n     *  from base or virtual\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n  },\n\n  setDisplayValueEdit: function setDisplayValueEdit(value) {\n  },\n\n  actionSave: function actionSave() {\n  },\n\n  /*\r\n     * Updates manually the affected cell \r\n     */\n  updateAffectedCellManually: function updateAffectedCellManually() {\n  },\n\n  /*\r\n     * Get the row index using the key as a reference\r\n     */\n  getRowIndexByKey: function getRowIndexByKey() {\n  },\n\n  /**\r\n      *  Shows more info about a grid row\r\n      * in smartphones not implemented\r\n      */\n  showMore: function showMore(id) {\n  },\n\n  postRender: function postRender() {\n    var self = this;\n\n    // Call base \n    self._super();\n\n    var properties = self.properties;\n    properties.rowsPerPage = 1;\n\n    self.getLabel().hide();\n    var control = self.getControl();\n    var grid = self.grid = $(\".bz-mobile-grid\", control);\n\n    var mode = self.getMode();\n    var columns = self.buildColumnModel();\n\n    var columnsTotalizers = jQuery.grep(columns, function (a) {\n      return a.summarizeBy;\n    });\n\n    grid.bizagi_grid_smartphone({\n      columns: columns,\n      title: properties.displayName,\n      mode: self.getMode(),\n      template: {\n        grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\n        waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\n        table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\n        emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\n        column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\n        specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\n        row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\n        rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\n        cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\n        specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\n        pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\n        buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\") },\n\n      actions: {\n        add: properties.allowAdd,\n        edit: properties.allowEdit && properties.withEditForm,\n        details: properties.allowDetail,\n        remove: properties.allowDelete,\n        inlineAdd: properties.inlineAdd,\n        allowMore: false,\n        totalizer: properties.showSummary,\n        hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false },\n\n\n      pageRequested: function pageRequested(ui) {\n        if (mode != \"execution\") return;\n\n        self.submitGridData().then(function () {\n          self.onPageRequested(ui);\n        });\n      },\n      sortRequested: function sortRequested(ui) {\n        if (mode != \"execution\") return;\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\n      },\n      isValid: function isValid(invalidElements) {\n        return self.isValidGrid(invalidElements);\n      },\n      drawCell: function drawCell(ui) {\n        return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\n      },\n      cellReady: function cellReady(ui) {\n        return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\n      },\n      rowSelected: function rowSelected(ui) {\n        //self.triggerHandler(\"rowSelected\", { id: ui.key });\n      },\n      totalData: function totalData(ui) {\n        if (mode != \"execution\") return;\n\n        self.onTotalData();\n      },\n      gridControlReady: function gridControlReady() {\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\n      },\n      addRow: function addRow(ui) {\n        if (mode != \"execution\") return;\n        self.grantPerformAction(\"addRow\", function () {\n          if (self.properties.subType == \"adhocGrid\" || self.properties.inlineAdd) {\n            self.addVirtualRow();\n          } else {\n            self.addRow();\n          }\n        });\n      },\n      editRow: function editRow(ui) {\n        if (mode != \"execution\") return;\n        if (self.properties.subType == \"adhocGrid\") {\n          self.editVirtualRow(ui.key);\n        } else {\n          self.editRow(ui.key);\n        }\n      },\n      deleteRow: function deleteRow(ui) {\n        if (mode != \"execution\") return;\n        self.deleteRow(ui.key);\n      },\n      showFormDetails: function showFormDetails(ui) {\n        self.showDetailForm(ui.key);\n      },\n      showMore: function showMore(ui) {\n        self.showMore(ui.key);\n      } });\n\n\n    // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\n    if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\n      var newData = [];\n      newData.push(properties.data.rows[0]);\n      properties.data.rows = newData;\n    }\n\n    properties.skipInitialLoad = properties.skipInitialLoad || false;\n    // Set initial data\n    if (!properties.skipInitialLoad) {\n      if (properties.data) {\n        if (properties.data === \"\" || properties.data.rows.length === 0 && properties.data.page > 1) {\n          self.fetchData(undefined, properties.sortBy, properties.sortOrder);\n        } else {\n          self.updateData(properties.data);\n\n          // Trigger change in order to start up the actions when the controls is ready\n          $.when(self.ready()).\n          done(function () {\n            self.triggerRenderChange({ changed: false });\n          });\n        }\n\n      } else {\n        self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\n      }\n    }\n\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  postRenderReadOnly: function postRenderReadOnly() {\n    // Do the same as the post-render\n    this.postRender();\n  },\n\n  changeBackgroundColor: function changeBackgroundColor(color) {\n    var self = this;\n    var control = self.getControl();\n\n    if (control) {\n      $(\".bz-mobile-grid\", control).css(\"background-color\", color !== 'none' ? color : \"\");\n    }\n\n    return this;\n  },\n\n  setHeaderStyles: function setHeaderStyles(cell) {\n    var self = this;\n    var label_style = \"font-weight: bold; \";\n    var properties = self.properties;\n\n    if (properties.headerFormat) {\n      var format = properties.headerFormat;\n\n      if (typeof format.bold !== \"undefined\") {\n        label_style = \"font-weight: normal; \";\n      }\n\n      if (format.color) {\n        label_style += \"color: \" + format.color + \";\";\n      }\n\n      if (format.background) {\n        label_style += \"background-color: \" + format.background + \";\";\n      }\n\n      if (format.italic) {\n        label_style += \"font-style: italic; \";\n      }\n\n      if (format.underline || format.strikethru) {\n        var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\n        var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\n\n        label_style += \"text-decoration: \" + strikethru + underline + \";\";\n      }\n\n      if (format.size && format.size != \"0\") {\n        var newFontSize = 100 + Number(format.size) * 10 + \"%\";\n        label_style += \"font-size: \" + newFontSize + \";\";\n      }\n    }\n    return cell.replace(\"%labelStyle%\", label_style);\n  },\n\n  onTotalData: function onTotalData(ui) {\n    var self = this;\n    var containerForm = self.getFormContainer();\n    containerForm.saveForm();\n\n    //defered que retorne la respuesta del servidor\n    bizagi.loading.start();\n    $.when(self.fetchTotalData()).done(function (data) {\n      var rows = data.rows;\n\n      //calcula los totalizadores y crea el html\n      var showTotal = [];\n\n      var columnsModel = self.buildColumnModel();\n      var result;\n\n      var operationState;\n\n      columnsModel.forEach(function callback(column, columnIndex) {\n        if (column.bizAgiProperties) {\n          operationState = column.bizAgiProperties.totalize.operation;\n\n          switch (operationState) {\n            case \"sum\":\n              result = rows.sum(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n              break;\n\n            case \"count\":\n              result = rows.count(function (row) {\n                //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n\n                if (!bizagi.util.isArray(return_value)) {\n                  return return_value;\n                }\n\n                if (bizagi.util.isArray(return_value) && return_value.length > 0) {\n                  return return_value; //If the returned value is not undefined, neither null, it will count +1\n                }\n              }, column, columnIndex);\n\n              break;\n\n            case \"max\":\n              result = rows.max(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n\n              break;\n\n            case \"min\":\n              result = rows.min(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n              break;\n\n            case \"avg\":\n              result = rows.avg(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n\n              result = result.toFixed(2);\n              break;}\n\n\n          if (operationState) {\n            var dataType = bizagi.util.normalizeType(column.bizAgiProperties.type);\n            result = self.formatTotalizedResult(operationState, dataType, result);\n            showTotal.push({ label: column.label, total: result });\n          }\n        }\n      });\n\n      self.showTotals(showTotal);\n    }).fail(function (error) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /*\r\n      * Fetch Sum Data\r\n      */\n  fetchTotalData: function fetchTotalData(params) {\n    var self = this;\n    var properties = self.properties;\n\n    params = params || {};\n    $.extend(params, {\n      url: properties.dataUrl,\n      xpath: properties.xpath,\n      idRender: properties.id,\n      xpathContext: properties.xpathContext,\n      contexttype: properties.contextType,\n      idPageCache: properties.idPageCache,\n      sort: properties.sort,\n      page: 1,\n      rows: self.properties.data.records,\n      searchFilter: properties.searchFilter });\n\n\n    // Check if a custom method has been given\n    if (properties.overrideGetRemoteData) {\n      var result = properties.overrideGetRemoteData(params);\n      return result != null ? result.promise() : null;\n    }\n\n    // Default ajax call\n    var defer = new $.Deferred();\n\n    // Resolve with remote data\n    self.dataService.multiaction().getGridData(params).done(function (data) {\n      // Check RTL\n      if (self.isRTL()) {\n        data.rows = self.changeOrderData(data.rows);\n      }\n\n      defer.resolve(data);\n    }).fail(function (fail) {\n\n      defer.reject(fail);\n    });\n\n    return defer.promise();\n  },\n\n  formatTotalizedResult: function formatTotalizedResult(operation, controlType, value) {\n    switch (operation) {\n      case 'sum':\n      case 'avg':\n      case 'min':\n      case 'max':\n        if (/columnMoney/i.test(controlType) || /money/i.test(controlType)) {\n          return bizagi.util.formatMonetaryCell(value);\n        }\n        break;}\n\n\n    return value || 0;\n  },\n\n  showTotals: function showTotals(params) {\n    var self = this;\n    var content = $.fasttmpl(self.renderFactory.getTemplate('bizagi.grid.totalizer'), { items: params });\n\n    self.grid.mobileView({\n      displayName: bizagi.localization.getResource(\"render-grid-totalizer\"),\n      orientation: self.properties.orientation,\n      style: \"width: 90%; height: 70%\",\n      transition: \"fade:in\",\n      cssClass: \"bz-modal-view--totalizer\",\n      showBorder: true,\n      contentTemplate: content });\n\n  },\n\n  buildColumnModel: function buildColumnModel() {\n    var self = this;\n    var columns = self.columns;\n\n    // Create id column first\n    var keyColumn = {\n      name: \"id\",\n      index: 0,\n      label: \"id\",\n      hidden: true,\n      align: \"\",\n      key: true };\n\n\n    // Add to column model\n    var columnModel = [];\n    columnModel.push(keyColumn);\n\n    $.each(columns, function (index, column) {\n      // Set grid column\n      column.columnIndex = index + 1;\n\n      var dataType = bizagi.util.normalizeType(column.properties.type);\n      var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\n      var gridColumn = {\n        name: column.properties.xpath,\n        index: index + 1,\n        label: columnLabel,\n        key: false,\n        hidden: !column.properties.visible || /columnHidden/i.test(dataType) || column.properties.columnVisible === false,\n        summarizeBy: column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined,\n        bizAgiProperties: column.properties };\n\n      columnModel.push(gridColumn);\n    });\n\n    return columnModel;\n  },\n\n  /**\r\n      * Makes the grid to refresh\r\n      */\n  refresh: function refresh() {\n    return $.when(this.fetchData());\n  },\n\n  /*\r\n     *   Holds the execution until the grid data is ready after a load operation\r\n     */\n  dataReady: function dataReady() {\n    return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\n  },\n\n  /*\r\n     *   Method to set data and update the grid\r\n     */\n  updateData: function updateData(data) {\n    var self = this;\n    var columns = self.columns;\n\n    // Set value in control\n    if (data && self.properties) {\n      self.properties.data = data;\n      self.setCellOverrides(data, columns);\n\n      self.triggerGridPluginHandler(\"setData\", data);\n    }\n  },\n\n  /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\n  fetchData: function fetchData(page, sortBy, sortType) {\n    var self = this;\n    var properties = self.properties;\n\n    // Define defaults\n    page = page || 1;\n    sortBy = sortBy || \"\";\n    sortType = sortType || \"asc\";\n\n    // Update control properties\n    properties.page = page;\n    properties.sort = sortBy + \" \" + sortType;\n\n    bizagi.loading.start();\n\n    return $.when(self.getRemoteData()).\n    then(function (data) {\n\n      if (data) {\n        $.when(self.updateData(data)).done(function () {\n          self.triggerRenderChange({ changed: false });\n        });\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var grid = self.grid;\n\n    // Remove changes for inline added rows\n    if (grid && self.properties.inlineAdd) {\n      var omitKeys = grid.bizagi_grid_smartphone.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_smartphone(\"getNewRowKeys\") : [];\n      for (var i = 0, length = omitKeys.length; i < length; i++) {\n        if (self.changes[omitKeys[i]]) {\n          delete self.changes[omitKeys[i]];\n        }\n      }\n    }\n\n    self._super(renderValues);\n  },\n\n  onPageRequested: function onPageRequested(ui) {\n    var self = this;\n    var properties = self.properties;\n    var data = {};\n\n    if (!jQuery.isEmptyObject(data)) {\n\n      self.dataService.submitData({\n        action: \"SUBMITDATA\",\n        data: data,\n        idRender: properties.id,\n        xpath: properties.xpath,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache });\n\n\n    }\n\n    self.fetchData(ui.page, ui.sortBy, ui.sortType);\n  },\n\n  /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\n  drawCell: function drawCell(column, key, value, isNewRow) {\n    //revisar ya que en las demas implementacion en desktop y tablet utilizan una validacion para edicion en linea o no\n    var self = this;\n\n    if (column.key) return value;\n\n    // Get render column\n    var columnIndex = column.index - 1;\n    var cellOverride = self.getCellOverride(key, columnIndex);\n    var renderColumn = self.columns[columnIndex];\n\n    // Data with null records\n    self.newRecords = {};\n\n    // Get cell properties\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\n    if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\n\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n    properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    renderColumn.properties.displayType = 'value';\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    //TODO: validar despus que sucede si se adiciona a la base para todos los dispositivos\n\n    // Set the value of labelAlign and valueAlign to use the rendering in the base\n    renderColumn.properties.labelAlign = \"default\";\n    if (renderColumn.properties.columntitlealign) {\n      renderColumn.properties.labelAlign = renderColumn.properties.columntitlealign;\n    }\n\n    renderColumn.properties.valueAlign = \"default\";\n    if (renderColumn.properties.columnAlign) {\n      renderColumn.properties.valueAlign = renderColumn.properties.columnAlign;\n    }\n\n    var cell = \"\";\n    if (editable) {\n      cell = self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\n    } else {\n      cell = self.drawReadonlyCell(renderColumn, properties, key, value);\n    }\n    return visible ? cell : \"\";\n\n  },\n\n  /**\r\n      * Draws the editable version for the cell\r\n      * @param renderColumn\r\n      * @param properties\r\n      * @param key\r\n      * @param value\r\n      * @param isNewRow\r\n      */\n  drawEditableCell: function drawEditableCell(renderColumn, properties, key, value, isNewRow) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(renderColumn.render(key, value)).done(function (cell) {\n      // Register array with new records\n      if (isNewRow && !self.newRecords[key]) {\n        self.newRecords[key] = {};\n      }\n\n      (self.columns || []).forEach(function (item, index) {\n        var visible = true;\n        self.cellOverrides[key] = self.cellOverrides[key] || {};\n\n        if (typeof self.getCellOverride(key, index).visible !== \"undefined\") {\n          visible = self.getCellOverride(key, index).visible;\n        }\n\n        self.getCellOverride(key, index).visible = visible;\n      });\n\n      self.bindRenderChange(renderColumn, key, true);\n\n      defer.resolve(cell);\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Draws the readonly version for the cell\r\n      * @param renderColumn\r\n      * @param properties\r\n      * @param key\r\n      * @param value\r\n      */\n  drawReadonlyCell: function drawReadonlyCell(renderColumn, properties, key, value) {\n    var self = this;\n\n    return $.when(renderColumn.renderReadOnly(key, value)).then(function (cell) {\n\n      if (cell && $(cell).css(\"display\") !== \"none\") {\n        var item = $(cell);\n\n        if (typeof self.properties.textFormat !== \"undefined\") {\n\n          if (typeof self.properties.textFormat.color !== \"undefined\") {\n            $('label', item).css('color', self.properties.textFormat.color);\n          }\n\n          if (typeof self.properties.textFormat.size !== \"undefined\" && self.properties.textFormat.size > 0) {\n            var newFontSize = 100 + Number(self.properties.textFormat.size) * 10 + \"%\";\n            $('label', item).css('font-size', newFontSize);\n          }\n        }\n        // TODO: Review template cell.readonly\n        cell = item && item[0] ? item[0].outerHTML : cell;\n      }\n\n      return cell || \"\";\n    });\n  },\n\n  /*\r\n     *   Executes when the cell is ready and inserted into the DOM\r\n     */\n  onCellReady: function onCellReady(column, key, cell, isNewRow) {\n    var self = this;\n\n    // Get render column\n    var columnIndex = column.index - 1;\n    var cellOverride = self.getCellOverride(key, columnIndex);\n    var renderColumn = self.columns[columnIndex];\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    $(\".bz-rn-messages\", cell).toggleClass(\"bz-rn-messages\", \"bz-rn-messages-grid\");\n\n    // If the cell we are drawing is the summary cell, we need to make it readonly\n    if (key === \"summary\") editable = false;\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    if (visible) {\n      if (editable) {\n        // Set editable\n        var originalEditable = renderColumn.properties.editable;\n        renderColumn.properties.editable = editable;\n\n        // Set xpath context for submitonchange action\n        if (renderColumn.properties.submitOnChange) {\n          var control = renderColumn.getDecorated(key);\n          if (control) {\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\n          }\n        }\n\n        // Execute cell post render\n        renderColumn.postRender(key, cell);\n\n        // Restore editable\n        renderColumn.properties.editable = originalEditable;\n      } else {\n\n        if (renderColumn.properties.submitOnChange) {\n          var control = renderColumn.getDecorated(key);\n\n          if (control) {\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\n          }\n        }\n\n        renderColumn.postRender(key, cell);\n      }\n    }\n  },\n\n  /**\r\n      *  Adds a row to the grid\r\n      */\n  addRow: function addRow() {\n    var self = this;\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    bizagi.loading.start();\n\n    $.when(self.submitAddRequest()).\n    done(function (newid) {\n      var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\n      var propertiesGridForm = {\n        idRender: properties.id,\n        \"recordXPath\": recordXpath,\n        url: properties.addPage,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache,\n        xpath: recordXpath,\n        editable: true,\n        requestedForm: \"addForm\",\n        displayName: properties.addLabel,\n        idAsigned: newid,\n        enableEditSubmitRequest: false,\n        hideLabel: true,\n        disableProcessButons: true,\n        hasExclusiveCheck: properties.hasExclusiveCheck };\n\n\n      var argumentsfl = {\n        \"renderFactory\": self.renderFactory,\n        \"dataService\": dataservice,\n        \"parent\": self,\n        \"data\": {\n          properties: propertiesGridForm } };\n\n\n\n      var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n      jQuery.extend(formlink, {\n        contextEdit: $(container).find(\".bz-container__item-edit\"),\n        element: self.element,\n        actionSave: self.actionSaveNewRow,\n        actionCancel: self.actionCancelRow,\n        _sendRelation: function _sendRelation() {\n          return true;\n        },\n        _getData: self.dataService.getFormData,\n        _params: propertiesGridForm,\n        addExclusiveChange: self.addExclusiveChange });\n\n\n      self._InternalRenderLinkForm(formlink);\n\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n  addVirtualRow: function addVirtualRow() {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var formParams = self.getFormParams();\n\n    // Create mock row\n    var currentRow = [\"mock_id\"];\n    self.columns.forEach(function () {\n      currentRow.push(null);\n    });\n\n    // Render grid view\n    var slideView = new bizagi.rendering.smartphone.slide.adhocForm(self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      allowEdition: true,\n      navigation: formParams.navigation,\n      container: self.getFormContainer().container });\n\n\n    slideView.render({\n      row: currentRow,\n      columns: self.columns,\n      pageCacheId: properties.idPageCache,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      sessionId: form.properties.sessionId,\n      actions: form.actions }).\n    done(function (data) {\n      $.when(self.saveAddedRow(data)).done(function () {\n        //Update the grid again\n        if (!properties.submitOnChange) {\n          // Reload grid\n          self.fetchData();\n        } else {\n          // Submits the entire form\n          self.submitOnChange();\n        }\n      });\n    });\n  },\n\n  /*\r\n     *   Prepares the add action\r\n     */\n  saveAddedRow: function saveAddedRow(data) {\n    var self = this;\n    var properties = self.properties;\n\n    return self.dataService.multiaction().addGridRecordData({\n      url: properties.addUrl,\n      idRender: properties.id,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      contexttype: properties.contexttype,\n      idPageCache: properties.idPageCache,\n      submitData: data });\n\n  },\n\n  /**\r\n      * Edit form in the grid\r\n      * @param id\r\n      */\n  editRow: function editRow(id) {\n    var self = this;\n    var containerForm = self.getFormContainer();\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\n\n    bizagi.loading.start();\n    $.when(containerForm.saveForm()).done(function () {\n\n      var propertiesGridForm = {\n        idRender: properties.id,\n        id: properties.id,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache,\n        recordXPath: recordXpath,\n        xpath: recordXpath,\n        editable: true,\n        url: properties.editPage,\n        requestedForm: \"editForm\",\n        displayName: properties.editLabel,\n        idAsigned: id,\n        disableProcessButons: true,\n        hasExclusiveCheck: properties.hasExclusiveCheck };\n\n\n      var argumentsfl = {\n        \"renderFactory\": self.renderFactory,\n        \"dataService\": dataservice,\n        \"parent\": self,\n        \"data\": {\n          properties: propertiesGridForm } };\n\n\n\n      var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n\n      jQuery.extend(formlink, {\n        contextEdit: $(container).find(\".bz-container__item-edit\"),\n        element: self.element,\n        //disable if you want only save at the end (submit the form)\n        actionSave: self.actionSaveNewRow,\n        actionCancel: self.actionCancelRow,\n        _sendRelation: formlink.submitEditRequest,\n        _getData: self.dataService.getFormData,\n        _params: propertiesGridForm,\n        addExclusiveChange: self.addExclusiveChange });\n\n\n      self._InternalRenderLinkForm(formlink);\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n  editVirtualRow: function editVirtualRow(id) {\n    var self = this;\n    var data = self.properties.data;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var formParams = self.getFormParams();\n\n    // Search row\n    var currentRow = [];\n    for (var i = 0, length = data.rows.length; i < length; i++) {\n      if (data.rows[i][0] == id) {\n        currentRow = data.rows[i];\n        break;\n      }\n    }\n\n    // Render grid view\n    var slideView = new bizagi.rendering.smartphone.slide.adhocForm(self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      allowEdition: true,\n      navigation: formParams.navigation,\n      container: self.getFormContainer().container });\n\n\n    slideView.render({\n      row: currentRow,\n      columns: self.columns,\n      pageCacheId: properties.idPageCache,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      sessionId: form.properties.sessionId,\n      actions: form.actions }).\n    done(function (formData) {\n      // This code is executed when the user press save on the slide\n      // Update internal data\n      for (xpath in formData) {\n        self.collectGridChange({ id: id, xpath: xpath, value: formData[xpath], trigger: false });\n      }\n\n      // Prepare grid data\n      var dataToSend = {};\n      self.collectData(dataToSend);\n\n      // Send the data\n\n      self.dataService.submitData({\n        action: \"SUBMITONCHANGE\",\n        data: dataToSend,\n        idRender: properties.id,\n        xpath: properties.xpath,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache }).\n      done(function () {\n        // After successfully response refresh the grid\n        self.fetchData();\n      });\n    });\n  },\n  _InternalRenderLinkForm: function _InternalRenderLinkForm(formlink) {\n    $.when(formlink.renderEdition()).done(function () {\n      formlink.endLoading();\n    });\n  },\n\n  /**\r\n      * Show details form\r\n      * @param id\r\n      */\n  showDetailForm: function showDetailForm(id) {\n    var self = this;\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\n\n    var propertiesGridForm = {\n      idRender: properties.id,\n      id: properties.id,\n      xpathContext: properties.xpathContext,\n      idPageCache: properties.idPageCache,\n      recordXPath: recordXpath,\n      xpath: recordXpath,\n      editable: false,\n      url: properties.editPage,\n      requestedForm: \"detailForm\",\n      displayName: properties.editLabel,\n      idAsigned: id,\n      disableProcessButons: true };\n\n\n    var argumentsfl = {\n      \"renderFactory\": self.renderFactory,\n      \"dataService\": dataservice,\n      \"parent\": self,\n      \"data\": {\n        properties: propertiesGridForm } };\n\n\n\n    var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n\n    jQuery.extend(formlink, {\n      contextEdit: $(container).find(\".bz-container__item-edit\"),\n      element: self.element,\n      _getData: self.dataService.getFormData,\n      _params: propertiesGridForm });\n\n\n    self._InternalRenderLinkForm(formlink);\n  },\n\n  /**\r\n      *  Deletes  a row to the grid\r\n      */\n  deleteRow: function deleteRow(id) {\n    var self = this;\n\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).\n    done(function () {\n      // Do a grid record deletion\n      $.when(self.submitDeleteRequest(id)).\n      done(function (data) {\n        // Reload grid\n        self.fetchData();\n\n        if (data.type == \"success\") {\n          // Trigger the event\n          //'key' must be included to trigger a single call to actions and validations\n          //line 310 bizagi.command.controllers.action\n          self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\n        }\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      });\n    });\n  },\n\n  actionCancelRow: function actionCancelRow() {\n    var self = this;\n    var deferred = $.Deferred();\n\n    $.when(self.submitRollbackRequest()).done(function () {\n      deferred.resolve();\n    });\n\n    return deferred.promise();\n  },\n\n  /*\r\n      * Save data in the form link related\r\n      * parameter: data data collected in the related form link\r\n      */\n  actionSaveNewRow: function actionSaveNewRow(data) {\n    var self = this;\n    var deferred = $.Deferred();\n\n    if (self.form.validateForm() === true) {\n      var properties = self.properties;\n\n      if (!data) {\n        self.form.collectRenderValues(data);\n      }\n\n      data.idPageCache = self.form.getPageCache();\n\n      $.when(\n      self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\n        if (resp.type == \"validationMessages\") {\n          self.form.addValidationMessage(resp.messages);\n          properties.submitOnChange = false;\n          deferred.reject(resp.messages);\n        } else {\n          self.parent.fetchData();\n          if (!properties.submitOnChange) {\n            properties.submitOnChange = true;\n          }\n          self.submitOnChange({}, true);\n          deferred.resolve();\n        }\n      });\n    } else {\n      deferred.reject();\n    }\n\n    return deferred.promise();\n  },\n\n  applyActionUpdateGrid: function applyActionUpdateGrid(column, context) {\n    var self = context;\n    var properties = self.properties;\n    var originalMethod = column.decorated.actionSave;\n\n    jQuery.extend(column.decorated, {\n      actionSave: function actionSave() {\n        var selfIntern = this;\n        $.when(originalMethod.apply(selfIntern, arguments)).done(function () {\n          var data = {};\n          self.collectRenderValues(data);\n\n          $.when(self.submitSaveRequest(selfIntern.surrogateKey, data)).done(function () {\n            self.fetchData();\n          });\n        });\n      } });\n\n  },\n\n\n  collectRenderValues: function collectRenderValues(renderValues) {\n    var self = this;\n\n    $.each(self.columns, function (i, child) {\n\n      child = child.decorated;\n\n      if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\n        // Go though container\n        child.collectRenderValues(renderValues);\n      } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\n        // Check if the render can be sent to the server\n        if (child.canBeSent()) {\n          child.collectData(renderValues);\n        }\n      }\n    });\n  },\n\n  /*\r\n     *   Returns a promise that will resolve when the element is ready\r\n     */\n  ready: function ready() {\n    var self = this;\n    var parentPromise = self._super();\n    var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\n\n    return $.when(parentPromise, inlineAddPromise);\n  },\n\n  /*   Sets an error on the cell\r\n     */\n  setError: function setError(key, xpath) {\n    var self = this;\n  },\n\n  /*\r\n     *  Changes the required for cell\r\n     */\n  changeCellValue: function changeCellValue(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n      if (argument != null) control.setDisplayValue(argument);\n\n      var renderColumn = control.column || {};\n      var _value = renderColumn.getValue(key);\n      var dataType = renderColumn.properties && renderColumn.properties.type;\n\n      self.collectGridChange({\n        id: key,\n        xpath: renderColumn.properties.xpath,\n        value: _value,\n        compositeValue: control.column.getCompositeValue(key),\n        columnIndex: control.columnIndex,\n        trigger: false,\n        dataType: dataType });\n\n    }\n  },\n  /*\r\n     *\r\n     */\n  changeCellBackgroundColor: function changeCellBackgroundColor(key, xpath, argument) {\n    var self = this,\n    control = self.getControlCell(key, xpath);\n\n    if (control) {\n      control.changeCellBackgroundColor(argument);\n\n      //Exclusive for complex elements such as checkboxes, and list\n      if (control.element) {\n        control.element.find(\".bz-container-render-cell1, .bz-control\").css({\n          \"background-color\": argument,\n          \"background-image\": argument });\n\n      }\n    }\n  },\n  /*\r\n     *   Changes the background for a cell\r\n     */\n  changeCellColor: function changeCellColor(key, xpath, argument) {\n    var self = this;\n\n    var control = self.getControlCell(key, xpath);\n    if (control)\n    control.changeCellColor(argument);\n\n  },\n  /*\r\n     *   Changes the visibility for a cell\r\n     */\n  changeCellVisibility: function changeCellVisibility(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n\n      control.changeCellVisibility(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).visible = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as needed\n      if (control.properties.editable && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  },\n\n  /*\r\n     *   Changes the editability for a cell\r\n     */\n  changeCellEditability: function changeCellEditability(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n    if (control) {\n      control.changeEditability(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).editable = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as neededn\n      if (control.properties.visible && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  },\n\n  /**\r\n      * Changes the required  for a cell\r\n      * @param key\r\n      * @param xpath\r\n      * @param argument\r\n      */\n  changeCellRequired: function changeCellRequired(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n      control.changeRequired(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).required = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as needed\n      if (control.properties.visible && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  } }, _defineProperty(_bizagi$rendering$sma, \"changeCellRequired\",\n\n\n\n\nfunction changeCellRequired(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeRequired(argument);\n    for (var j = 0, length = self.columns.length; j < length; j++) {\n      if (\n      self.columns[j].properties.xpath == xpath ||\n      self.columns[j].properties.id == xpath ||\n      self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id == xpath)\n      {\n        break;\n      }\n    }\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, j).required = argument;\n\n    // Bind/Unbind the render change, so it can works with actions and validations as needed\n    if (control.properties.visible && argument) {\n      self.bindRenderChange(self.getColumn(xpath), key, true);\n    } else {\n      self.bindRenderChange(self.getColumn(xpath), key, false);\n    }\n  }\n\n}), _defineProperty(_bizagi$rendering$sma, \"changeCellMinValue\",\n\n\n\n\nfunction changeCellMinValue(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeMinValue(argument);\n\n    var index = (self.columns || []).findIndex(function (cell) {\n      return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n    }) || 0;\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, index).minValue = argument;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"changeCellMaxValue\",\n\n\n\n\nfunction changeCellMaxValue(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeMaxValue(argument);\n    var index = (self.columns || []).findIndex(function (cell) {\n      return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n    }) || 0;\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, index).maxValue = argument;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"cleanCellData\",\n\nfunction cleanCellData(key, xpath) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    return $.when(control.cleanData()).then(function (emptyValue) {\n      //Not all empty values are \"\" or [], the best approach is to get the value from the control\n      emptyValue = emptyValue || [[\"\", \"\"]];\n\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      var rows = self.properties.data.rows,i = 0,rowLength = rows.length;\n      for (; i < rowLength; i++) {\n        if (Number(key) === rows[i][0]) {\n          rows[i][index + 1] = emptyValue;\n          break;\n        }\n      }\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).value = null;\n    });\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"isValidGrid\",\n\nfunction isValidGrid(invalidElements) {\n  var self = this;\n  var errorsMessage = [];\n  var form = self.getFormContainer();\n\n  if (typeof form.validationController !== \"undefined\")\n  form.validationController.clearValidationMessages();\n\n  self.isValid(errorsMessage);\n\n  if (errorsMessage.length > 0) {\n    if (typeof form.validationController !== \"undefined\") {\n      for (var i = 0, length = errorsMessage.length; i < length; i++) {\n        // Show validation message\n        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\n      }\n    }\n\n    return false;\n  } else {\n    return true;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"triggerGridPluginHandler\",\n\n\n\n\n\nfunction triggerGridPluginHandler() {\n  var self = this;\n  var args = Array.prototype.slice.call(arguments, 0);\n\n  return self.grid.bizagi_grid_smartphone.apply(self.grid, args);\n}), _defineProperty(_bizagi$rendering$sma, \"bindRenderChange\",\n\n\n\n\nfunction bindRenderChange(renderColumn, key, isBinding) {\n  var self = this;\n  var dataType = bizagi.util.normalizeType(renderColumn.properties.type);\n  var excludedTypes = new RegExp([\"columnImage\", \"columnUpload\"].join(\"|\"), \"i\");\n\n  // Don't collect data for online column images, or upload\n  if (excludedTypes.test(dataType)) return;\n\n  if (isBinding) {\n\n    renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\n\n      var value = renderColumn.getValue(args.render.surrogateKey);\n      var compositeValue = renderColumn.getCompositeValue(args.render.surrogateKey);\n\n\n      if (/columnDate/i.test(dataType)) {\n        if (!bizagi.util.isEmpty(value)) {\n          var date = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\n          date.setMilliseconds(0);\n\n          value = bizagi.util.dateFormatter.formatInvariant(date, true);\n        } else if (value === \"\") {\n          value = \"\";\n        }\n      }\n      if (renderColumn.properties && !renderColumn.properties.isExclusive) {\n        self.collectGridChange($.extend(args, {\n          id: args.render.surrogateKey,\n          xpath: renderColumn.properties.xpath || renderColumn.properties.id,\n          value: value,\n          compositeValue: compositeValue,\n          columnIndex: renderColumn.columnIndex,\n          dataType: renderColumn.properties.type }));\n\n      }\n\n      // Update change in grid's component data\n      self.grid.bizagi_grid_smartphone(\"changeCellValue\", args.render.surrogateKey, renderColumn.columnIndex, value);\n\n      // If the column has totalizers then we need to refresh the summary\n      if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\n        self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\n      }\n    });\n  } else {\n    renderColumn.getDecorated(key).unbind(\"renderchange\");\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"executeFormFailHandler\",\n\n\n\n\n\n\nfunction executeFormFailHandler(error) {\n  var self = this;\n  var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\n  self.getFormContainer().failHandler(errorResponse);\n}), _defineProperty(_bizagi$rendering$sma, \"getIndexes\",\n\n\n\n\n\nfunction getIndexes() {\n  var self = this;\n  var data = $.merge(self.properties.data.rows, self.getDataNewRows());\n\n  return data.reduce(function (acum, current) {\n    if (typeof acum.find(function (el) {\n      return el[0] == current[0];\n    }) === 'undefined') {\n      acum.push(current);\n    }\n    return acum;\n  }, []).map(function (item) {\n    return item[0];\n  });\n}), _defineProperty(_bizagi$rendering$sma, \"startLoading\",\n\nfunction startLoading() {\n  bizagi.loading.start();\n}), _defineProperty(_bizagi$rendering$sma, \"endLoading\",\n\nfunction endLoading() {\n  bizagi.loading.stop();\n}), _defineProperty(_bizagi$rendering$sma, \"grantPerformAction\",\n\n\n\n\nfunction grantPerformAction(action, success, error) {\n  var self = this;\n  if (action == \"addRow\" || action == \"navigateToPage\") {\n    var data = self.properties.data;\n    var rows = data && data.rows ? data.rows : [];\n    if (rows.length === 0) {\n      success();\n    } else if (self.isValidGrid()) {\n      self.submitGridData().then(function () {\n        if (success)\n        success();\n      }).fail(function () {\n        if (error)\n        error();\n      });\n    } else {\n      if (error)\n      error();\n    }\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"submitGridData\",\n\n\n\nfunction submitGridData() {\n  var data = {},\n  def = new $.Deferred();\n  this.collectData(data);\n  if (JSON.stringify(data) === JSON.stringify({})) {\n    def.resolve();\n  } else {\n    //submit without refresh and not collect\n    this.submitOnChange(data, false, true).then(function () {\n      def.resolve();\n    }).fail(function () {\n      def.reject();\n    });\n  }\n  return def.promise();\n}), _defineProperty(_bizagi$rendering$sma, \"addExclusiveChange\",\n\nfunction addExclusiveChange(id, data, grid) {\n  var self = grid ? grid : this;\n  if (self.properties.hasExclusiveCheck) {\n    for (var xpath in data) {\n      var column = self.columns.find(function (el) {\n        return el.properties.xpath == xpath;\n      });\n      // Check if some of the changes from the edit or add form match with the exclusive controls in the grid\n      var value = data[xpath];\n      if (column && column.properties.isExclusive && value) {\n        self.exclusiveChanges[xpath] = {\n          xpath: xpath,\n          simpleXpath: xpath,\n          value: value,\n          key: id };\n\n      }\n    }\n  }\n}), _bizagi$rendering$sma));","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render Grid Offline Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Daniel Ordonez\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the offline grid render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends itself\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.offline\", {}, {\n  /*\r\n                                                                                          *   Constructor\r\n                                                                                          */\n  init: function init(params) {\n    var self = this;\n    var originalRows = bizagi.clone(params.data.properties.data.rows);\n    var completeRows = bizagi.clone(params.data.properties.data.rows);\n    // Call base\n    this._super(params);\n    var properties = this.properties;\n    properties.data.originalRows = originalRows;\n    properties.data.completeRows = completeRows;\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: self });\n\n    // Fill default properties\n    var form = self.getFormContainer();\n\n    properties.isTaskForm = form.properties.isTaskForm;\n    self.newRecords = {};\n    //Preload new lines previously added offline\n    if (properties.editable === true) {\n      if (properties[\"new-records\"]) {\n        var newRowKeys = Object.keys(properties[\"new-records\"]);\n        for (var k = 0; k < newRowKeys.length; k++) {\n          self.newRecords[newRowKeys[k]] = { createdOffline: true };\n          self.changes[newRowKeys[k]] = properties[\"new-records\"][newRowKeys[k]];\n        }\n      }\n      self[\"deleted-records\"] = properties[\"deleted-records\"] ? properties[\"deleted-records\"] : {};\n    }\n\n    if (properties.groupBy || properties.groupSummary) {\n      // Add warning\n      form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\n    }\n\n    // Create a collection to save grid cell changes to execute after it is loaded\n    self.pendingActions = [];\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n\n    self.initialLoadDone = false;\n\n    // Find component holder\n    self.grid = $(\">div\", control);\n\n    // Hide common label\n    self.getLabel().hide();\n\n    // Grid plugin\n    self.applyGridPlugin();\n\n    // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\n    if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\n      var newData = [];\n      newData.push(properties.data.completeRows[0]);\n      properties.data.rows = newData;\n    }\n\n    // Set initial data\n    if (properties.data) {\n\n      self.updateData(properties.data);\n\n      // Trigger change in order to start up the actions when the controls is ready\n      $.when(self.ready()).done(function () {\n        self.triggerRenderChange({ changed: false });\n      });\n    }\n\n    // Execute pending actions\n    self.initialLoadDone = true;\n\n    if (self.pendingActions && self.pendingActions.length > 0) {\n      for (var i in self.pendingActions) {\n        self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\n      }\n    }\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var self = this;\n\n    // Do the same as the post-render            \n    self.postRender();\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  applyGridPlugin: function applyGridPlugin() {\n    var self = this;\n    var properties = self.properties;\n    var grid = self.grid;\n    var mode = self.getMode();\n\n    // Build column metadata\n    var columns = self.buildColumnModel();\n\n    // Apply grid plugin\n    grid.bizagi_grid_smartphone({\n      columns: columns,\n      title: properties.displayName,\n      isOfflineForm: this.isOfflineForm || false,\n      mode: self.getMode(),\n      template: {\n        grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\n        waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\n        table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\n        emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\n        column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\n        specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\n        row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\n        rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\n        cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\n        pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\n        specialCell: self.renderFactory.getTemplate(\"bizagi.grid.offline.cell.special\"),\n        buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\") },\n\n      actions: {\n        add: properties.allowAdd,\n        edit: properties.allowEdit && properties.withEditForm && properties.data != null,\n        remove: properties.allowDelete,\n        inlineAdd: properties.inlineAdd,\n        details: false,\n        allowMore: false,\n        enableXlsExport: false,\n        enablePdfExport: false,\n        hasTotalizer: false },\n\n      isValid: function isValid() {\n        return self.isValidGrid();\n      },\n      pageRequested: function pageRequested(ui) {\n        if (mode !== \"execution\") return;\n        self.onPageRequested(ui);\n      },\n      totalData: function totalData(ui) {\n        if (mode != \"execution\") return;\n        //self.onTotalData();\n      },\n      drawCell: function drawCell(ui) {\n        return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\n      },\n      cellReady: function cellReady(ui) {\n        return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\n      },\n      rowSelected: function rowSelected(ui) {\n        //self.triggerHandler(\"rowSelected\", {id: ui.key, data: ui});\n      },\n      addRow: function addRow(ui) {\n        if (mode !== \"execution\") return;\n        self.addRow();\n      },\n      editRow: function editRow(ui) {\n        if (mode !== \"execution\") return;\n        self.editRow(ui.key);\n      },\n      deleteRow: function deleteRow(ui) {\n        if (mode !== \"execution\") return;\n        self.deleteRow(ui.key);\n      },\n      showMore: function showMore(ui) {\n        self.showMore(ui.key);\n      } });\n\n  },\n\n  /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\n  fetchData: function fetchData(page, sortBy, sortType) {\n    var self = this;\n    var properties = self.properties;\n\n    // Define defaults\n    page = page || 1;\n    sortBy = sortBy || \"\";\n    sortType = sortType || \"asc\";\n\n    // Update control properties\n    properties.page = page;\n    properties.sort = sortBy + \" \" + sortType;\n\n    self.dataReadyDeferred = new $.Deferred();\n\n    // Start loading to avoid multiple calls to the server\n    self.startLoading();\n\n    $.when(self.getRemoteData()).then(function (data) {\n      self.endLoading();\n      if (data) {\n        self.updateData(data);\n        self.triggerRenderChange();\n        self.dataReadyDeferred.resolve();\n      }\n    });\n  },\n\n  /*\r\n     * Method not required in smartphone implementation\r\n     */\n  processChanges: function processChanges() {\n    var self = this;\n    var rowsList = [];\n    return rowsList;\n  },\n\n  /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var errorsMessage = [];\n    var internalRedersValues = [];\n    var internalNewRenderValues = [];\n    var properties = self.properties;\n    var data = self.properties.data;\n    var temporalNew = {};\n    // Save pending inline add rows\n    if (self.isValid(errorsMessage)) {\n      for (var id in self.changes) {\n        var sortArray = [];\n        var currentChanges = {};\n        for (var columnXpath in self.changes[id]) {\n\n          // Check if the render can submit data\n          if (self.canColumnBeSent(id, columnXpath)) {\n            var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\n            var value = self.changes[id][columnXpath];\n\n            if (typeof value === \"string\") {\n              if (value.match(/\\n/gm) !== null) {\n                value = value.replaceAll(\"\\n\", \"\\\\n\");\n              }\n            }\n\n            sortArray[columnNumber] = value;\n            var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\n            var columnValue = self.changes[id][columnXpath];\n            var value = columnValue && columnValue.value ? columnValue.value : columnValue;\n            renderValues[xpath] = value;\n            //Changes are store to delete them if the row is new, the rest of changes can be saved by xpath\n            currentChanges[xpath] = value;\n          }\n        }\n        //If new record store action data\n        if (self.newRecords[id]) {\n          //Use - to avoid issues with possible xpaths in renderValues used both in new and deleted records\n          var addRowData = {\n            url: properties.addUrl,\n            idRender: properties.id,\n            xpath: properties.xpath,\n            xpathContext: properties.xpathContext,\n            contexttype: properties.contexttype,\n            idPageCache: properties.idPageCache,\n            submitData: self.changes[id],\n            prepare: true,\n            idRow: parseInt(id + ''),\n            creationTimestamp: self.newRecords[id].creationTimestamp };\n\n          temporalNew[id] = addRowData;\n          for (change in currentChanges) {\n            delete renderValues[change];\n          }\n          var details = {};\n          details.idRow = parseInt(id + '');\n          details.isNew = true;\n          details.changes = self.changes[id];\n          sortArray.push(details);\n          if (!self.newRecords[id].createdOffline) {\n            sortArray.creationTimestamp = self.newRecords[id].creationTimestamp;\n            internalNewRenderValues.push(sortArray);\n          }\n        }\n      }\n    }\n\n    internalNewRenderValues = internalNewRenderValues.sort(function (a, b) {\n      return a.creationTimestamp - b.creationTimestamp;\n    });\n    internalNewRenderValues = internalNewRenderValues.map(function (row) {\n      if (row.creationTimestamp) {\n        delete row.creationTimestamp;\n      }\n      return row;\n    });\n    internalRedersValues = internalRedersValues.concat(internalNewRenderValues);\n    // Get data\n    if (JSON.stringify(data.completeRows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\n      renderValues[properties.xpath] = renderValues[properties.xpath] ? renderValues[properties.xpath] : {};\n      if (typeof data.completeRows !== \"undefined\" && data.completeRows.length > 0) {\n        renderValues[properties.xpath].rows = self.processOldRows(data.completeRows);\n      } else {\n        renderValues[properties.xpath].rows = internalRedersValues;\n      }\n      if (self[\"deleted-records\"] && Object.keys(self[\"deleted-records\"]).length > 0)\n      renderValues[properties.xpath][\"deleted-records\"] = self[\"deleted-records\"];\n      if (temporalNew && Object.keys(temporalNew).length > 0)\n      renderValues[properties.xpath][\"new-records\"] = temporalNew;\n    }\n\n\n  },\n\n  /*\r\n     *   Delete field id array objects\r\n     */\n  processOldRows: function processOldRows(rows) {\n    var newRows = [];\n    var tempRows = rows;\n    var self = this;\n\n    for (var col = 0, leng = tempRows.length; col < leng; col++) {\n      var temp = tempRows[col];\n      newRows[col] = $.grep(temp, function (n, i) {\n        return i > 0;\n      });\n      var details = {};\n      details.idRow = parseInt(temp[0] + '');\n      details.isNew = self.newRecords[temp[0]] ? true : false;\n      details.changes = self.changes[temp[0]] ? self.changes[temp[0]] : {};\n      newRows[col].push(details);\n    }\n\n    return newRows;\n  },\n  /*\r\n     *   Delete field id array\r\n     */\n  processRow: function processRow(row) {\n    return $.grep(row, function (n, i) {\n      return i > 0;\n    });\n  },\n\n  onPageRequested: function onPageRequested(ui) {\n    var self = this;\n    self.fetchData(ui.page, ui.sortBy, ui.sortType);\n  },\n\n  /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\n  drawCell: function drawCell(column, key, value, isNewRow) {\n    var self = this;\n\n    if (column.key) return value;\n\n    if (_typeof(value) === \"object\" && value !== null && !isNewRow) {\n      value = value.hasOwnProperty(\"value\") ? value.value : value;\n    }\n\n    // Get render column                \n    var columnIndex = column.index - 1;\n    var renderColumn = self.columns[columnIndex];\n    var cellOverride = self.getCellOverride(key, column.index - 1);\n\n    self.newRecords = self.newRecords || {};\n\n    // Get cell properties\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\n    if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    // If the cell we are drawing is the summary cell, we need to make it readonly\n    if (key === \"summary\") editable = false;\n\n    renderColumn.properties.displayType = 'value';\n    renderColumn.setValue(key, value);\n    renderColumn.setSurrogateKey(key);\n    renderColumn.properties.data = renderColumn.properties.data || [];\n\n    // Column search\n    if (renderColumn.properties.type === \"columnSearch\" && value != null) {\n      for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\n        if (renderColumn.properties.data[i].id == value) {\n          value = { id: renderColumn.properties.data[i].id, label: renderColumn.properties.data[i].value };\n        }\n      }\n    }\n\n    if ((renderColumn.properties.type === \"columnCombo\" || renderColumn.properties.type === \"columnList\") && value != null) {//|| renderColumn.properties.type == \"columnRadio\"\n      for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\n        if (renderColumn.properties.data[i].id == value) {\n          value = [[renderColumn.properties.data[i].id, renderColumn.properties.data[i].value]];\n        }\n      }\n    }\n\n    // Column text\n    if (renderColumn.properties.type === \"columnText\" && bizagi.util.isEmpty(value) && value != null) {\n      value = \"\";\n    }\n\n    if (renderColumn.properties.type === \"columnUpload\") {\n      renderColumn.getDecorated(key).properties.xpathContext = self.properties.xpath + self.buildCellXpathFilter(key);\n    }\n\n    // Do the render\n    if (visible) {\n      if (editable) {\n        return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\n      } else {\n        return self.drawReadonlyCell(renderColumn, properties, key, value);\n      }\n    } else {\n      return \"\";\n    }\n  },\n\n  /*\r\n     *   Draws the editable version for the cell\r\n     */\n  drawEditableCell: function drawEditableCell(renderColumn, properties, key, value, isNewRow) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Set editable\n    var originalEditable = renderColumn.properties.editable;\n    renderColumn.properties.editable = true;\n\n    // Fix problem when required property lose\n    renderColumn.overrideProperties({ required: properties.required });\n\n    // Render cell\n    $.when(renderColumn.render(key, value)).done(function (cell) {\n      // Register array with new records, just when this is a new-record\n      if (isNewRow && !self.newRecords[key]) {\n        self.newRecords[key] = { creationTimestamp: Date.now() };\n      }\n\n      // convert all row visible\n      for (var j = 0; j < self.columns.length; j++) {\n        self.cellOverrides[key] = self.cellOverrides[key] || {};\n        self.getCellOverride(key, j).visible = self.getCellOverride(key, j).visible != undefined ? self.getCellOverride(key, j).visible : true;\n      }\n\n      // Add change handler  \n      renderColumn.getDecorated(key).bind(\"renderchange\", function (render) {\n        self.onCellChange(renderColumn, cell, key);\n      });\n\n      // Resolve cell\n      defer.resolve(cell);\n    });\n\n    // Restore editable\n    renderColumn.properties.editable = originalEditable;\n\n    // Return promise\n    return defer.promise();\n  },\n\n  /*\r\n     *   Draws the readonly version for the cell\r\n     */\n  drawReadonlyCell: function drawReadonlyCell(renderColumn, properties, key, value) {\n    var result = \"\";\n\n    // Use totalizer format when printing summary row\n    if (key === \"summary\") {\n      var originalFormat = renderColumn.properties.textFormat;\n      if (renderColumn.properties.totalize) {\n        renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\n      }\n\n      result = renderColumn.renderSummary(key, value);\n\n      // Restore column format\n      renderColumn.properties.textFormat = originalFormat;\n    } else {\n      result = renderColumn.renderReadOnly(key, value);\n    }\n    return result;\n  },\n\n  /*\r\n     *   Defines the handler when a cell changes its value\r\n     */\n  onCellChange: function onCellChange(renderColumn, cell, key) {\n\n    var self = this;\n    var _value = renderColumn.getValue(key);\n    var compositeValue = renderColumn.getCompositeValue(key);\n\n    if (renderColumn.properties.type === \"columnDate\" && renderColumn.data.properties.showTime == true) {\n\n      if (!bizagi.util.isEmpty(_value)) {\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\n        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\n      } else if (_value === \"\") {\n        _value = \"\";\n      }\n    } else if (renderColumn.properties.type === \"columnDate\") {\n\n      if (!bizagi.util.isEmpty(_value)) {\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\n        date.setHours(0, 0, 0, 0);\n        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\n      } else if (_value === \"\") {\n        _value = \"\";\n      }\n    }\n\n    if (self.properties.allowEdit || self.grid.bizagi_grid_smartphone(\"isNewRecord\", key)) {\n      var trigger = self.grid.bizagi_grid_smartphone(\"isNewRecord\", key) ? false : true;\n      self.collectGridChange({\n        id: key,\n        xpath: renderColumn.properties.xpath,\n        value: _value,\n        compositeValue: compositeValue,\n        columnIndex: renderColumn.columnIndex,\n        trigger: trigger,\n        dataType: renderColumn.properties && renderColumn.properties.type });\n\n    }\n\n    // Update change in grid's component data\n    self.grid.bizagi_grid_smartphone(\"changeCellValue\", key, renderColumn.columnIndex, _value);\n\n    // If the column has totalizers then we need to refresh the summary\n    if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\n      self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\n    }\n  },\n  /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\n  collectGridChange: function collectGridChange(params) {\n    var self = this;\n    params = params || {};\n    var id = params.id;\n    var xpath = params.xpath;\n    var value = params.value;\n    var trigger = typeof params.trigger !== \"undefined\" ? params.trigger : true;\n\n    self.changes[id] = self.changes[id] || {};\n    self.changes[id][xpath] = value;\n\n    if (trigger)\n    self.triggerRenderChange({ key: id, column: xpath });\n  },\n\n  /**\r\n      *  Adds a row to the grid\r\n      */\n  addRow: function addRow() {\n\n    var self = this;\n    var properties = self.properties;\n    var data = properties.data;\n    // Handle information stored offline based on data        \n    var newData = [];\n    var newRow = self.createAddRowData();\n    newData.push(newRow);\n\n    //Support for deletion and new rows\n    self.newRecords[newRow[0]] = {\n      createdOffline: true,\n      creationTimestamp: Date.now() };\n\n\n    data.rows = newData;\n    data.completeRows.push(newRow);\n    data.records++;\n    data.page = data.records;\n\n    self.updateData(data);\n    self.triggerRenderChange();\n  },\n\n  /**\r\n      * Creates a dummy data for the new row\r\n      * @returns {}\r\n      */\n  createAddRowData: function createAddRowData() {\n    var self = this;\n\n    var row = [];\n    var key = Math.ceil(Math.random() * 100000);\n    row.push(key);\n    $.each(self.columns, function (i) {\n      row.push(null);\n    });\n\n    return row;\n  },\n\n  /**\r\n      *  Edits a row in the grid\r\n      */\n  editRow: function editRow(id) {\n  },\n\n  /**\r\n      *  Deletes a row to the grid\r\n      */\n  deleteRow: function deleteRow(id) {\n    var self = this;\n\n    if (!id || id == 0) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\n      return;\n    }\n\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function () {\n      // Do a grid record deletion\n      $.when(self.submitDeleteRequest(id)).\n      done(function () {\n        // Reload grid\n        self.fetchData();\n\n        // Trigger the event\n        //'key' must be included to trigger a single call to actions and validations\n        //line 310 bizagi.command.controllers.action\n        self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\n      });\n    });\n  },\n\n  /**\r\n      *  Edits the entire row (inline) in another slide\r\n      */\n  editInline: function editInline(id) {\n  },\n  /*\r\n     *   Retrieve the data for the new rows and push them into the server\r\n     */\n  saveInlineAddedRows: function saveInlineAddedRows(keys, bRefresh) {\n    var self = this;\n    var rows = self.processChanges();\n\n    if (!bizagi.util.isEmpty(rows)) {\n      self.properties.data.rows = $.merge(self.properties.data.rows, rows);\n    }\n  },\n\n  /*\r\n     * Removes invalid records \r\n     */\n  removeNewRecords: function removeNewRecords(ui) {\n    var self = this;\n\n    if (ui && ui.keys) {\n      $.each(ui.keys, function (_, key) {\n        if (self.newRecords[key]) {\n          delete self.newRecords[key];\n        }\n      });\n    }\n  },\n\n  /*\r\n     *   Fetch the data into a deferred\r\n     */\n  getRemoteData: function getRemoteData(params) {\n    var self = this;\n    var properties = self.properties;\n\n    // Set params\n    params = params || {};\n\n    // Check if a custom method has been given\n    if (properties.overrideGetRemoteData) {\n      var result = properties.overrideGetRemoteData(params);\n      return result != null ? result.promise() : null;\n    }\n\n    // Default ajax call\n    var defer = new $.Deferred();\n\n\n    // Resolve with remote data\n    var data = properties.data;\n    // Handle information stored offline based on data\n    if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\n      var newData = [];\n      newData.push(properties.data.completeRows[properties.page - 1]);\n      properties.data.rows = newData;\n      properties.data.page = properties.page;\n    } else\n    if (properties.data.completeRows && properties.data.completeRows.length == 0) {\n      properties.data.rows = [];\n    }\n\n    // Check RTL\n    if (self.isRTL()) {\n      data.rows = self.changeOrderData(data.rows);\n    }\n\n    defer.resolve(data);\n\n    return defer.promise();\n  },\n  /*\r\n     *   Submits a grid delete record request for the given id \r\n     *   Returns a deferred\r\n     */\n  submitDeleteRequest: function submitDeleteRequest(id) {\n    var self = this;\n    var properties = self.properties;\n    var data = self.properties.data;\n    for (var i = 0, length = data.completeRows.length; i < length; i++) {\n      if (data.completeRows[i][0] == id) {\n\n        data.completeRows.splice(i, 1);\n        i--;\n\n        data.records--;\n        //Enters if it was created online\n        if (!self.newRecords[id])\n        {\n          var xpath = properties.xpath + self.buildCellXpathFilter(id);\n\n          var delInfo = {\n            url: properties.deleteUrl,\n            idRender: properties.id,\n            xpath: xpath,\n            xpathContext: properties.xpathContext,\n            idPageCache: properties.idPageCache,\n            contexttype: properties.contextType,\n            prepare: true };\n\n          self[\"deleted-records\"][id] = delInfo;\n        } else {\n          delete self.newRecords[id];\n          delete self.changes[id];\n        }\n        break;\n      }\n    }\n\n    return data.completeRows;\n  },\n\n  isValidGrid: function isValidGrid() {\n    var self = this;\n    var errorsMessage = [];\n    var form = self.getFormContainer();\n\n    if (typeof form.validationController !== \"undefined\")\n    form.validationController.clearValidationMessages();\n\n    //self.isValid(errorsMessage);\n\n    if (errorsMessage.length > 0) {\n      if (typeof form.validationController !== \"undefined\") {\n        for (var index = 0; index < errorsMessage.length; index++) {\n          form.validationController.showValidationMessage(errorsMessage[index].message, errorsMessage[index].xpath);\n        }\n      }\n\n      return false;\n    } else {\n      return true;\n    }\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render Search Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the search render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.search\", bizagi.rendering.search.prototype);\n// Extends itself\nbizagi.rendering.smartphone.search.extend(\"bizagi.rendering.smartphone.search\", {\n  ADVANCED_SEARCH_ID: -1,\n  ADVANCED_ADDITION_ID: -2,\n  CLEAR_SEARCH_ID: -3,\n  NO_RESULTS_SEARCH_ID: -4,\n  DEFAULT_SEARCH_ID: \"\",\n  SEARCH_MIN_LENGTH: 3,\n  SEARCH_DELAY: 250,\n  SEARCH_MAX_RECORDS: 50 },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data submitData\r\n   * @returns {}\r\n   */\n  initializeData: function initializeData(data) {\n    var self = this;\n\n    // Call base\n    self._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.properties.submitOnChange = this.isOfflineForm ? false : this.properties.submitOnChange;\n\n    // Store reference of all ajax request in order to run only one instance of them\n    this.deferredReference = null;\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n    var value = this.getDisplayValue();\n    var label = value.label || value.value;\n\n    if (typeof label != \"undefined\") {\n      if (_typeof(label) == \"object\")\n      label = label.join(\" - \");\n    } else {\n      label = \"\";\n    }\n\n    if (typeof label == \"string\") {\n      if (value.additionallabel) {\n        label += \" - \" + value.additionallabel;\n      }\n\n      label = bizagi.util.sanitizeHTML(label);\n    }\n\n    return $.fasttmpl(template, {\n      value: label,\n      editable: this.properties.editable });\n\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      * @returns {}\r\n      */\n  postRender: function postRender() {\n    this.searchInput = $(\".bz-input-icon\", this.getControl());\n  },\n\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.searchInput = $(\".bz-input-icon\", this.getControl());\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    // Select new item\n    $(\".bz-input-icon\", control).on(\"click\", function () {\n      if (!self.properties.advancedSearch || self.isOfflineForm) {\n        self._simplySearchView();\n      } else {\n        self._advanceSearchView();\n      }\n    });\n\n    $(\".bz-icn--clear\", control).bind(\"click\", function (event) {\n      // Change display icon\n      $(\".bz-input-icon\", control).addClass(\"bz-input-icon--empty\");\n\n      // Call clean data\n      self.cleanData();\n\n      // Submit info to server\n      self.readyActionExecution().done(function () {\n        if (self.properties.submitOnChange) {\n          self.submitData();\n        }\n      });\n\n      event.stopPropagation();\n    });\n\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new suggest control\r\n      * @param {} inputContainer\r\n      * @returns {}\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    // Configuring list as a selectable element\n    self.modalViewList = $(\".bz-list\", modalView.content);\n\n    // Suggest\n    var suggestFilter = bizagi.util.debounce(function (value) {\n      self.autoCompleteSearchResults($.trim(value));\n    }, self.Class.SEARCH_DELAY);\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n    var $searchInput = $(\".bz-modal-view__search\", modalView.header);\n\n    $clearButton.bind(\"click\", function () {\n      $searchInput.val(\"\").trigger(\"clean\");\n    });\n\n    // Setting the initial selected display value\n    $(\".bz-list\", modalView.content).on(\"click\", \"li\", function () {\n      var item = $.data(this).item;\n      if (!item || item && item.id == self.Class.NO_RESULTS_SEARCH_ID)\n      return;\n\n      self.selectItem(item);\n      modalView.close();\n    });\n\n    // Filtering list\n    $searchInput.bind(\"clean keyup\", function () {\n      if (this.value == \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      suggestFilter(this.value);\n    }).on(\"focus\", function () {\n      modalView.header.addClass(\"bz-modal-view__header--active\");\n    }).on(\"blur\", function () {\n      modalView.header.removeClass(\"bz-modal-view__header--active\");\n    });\n\n\n  },\n\n  /**\r\n      * Opens the search slide\r\n      * @private\r\n      */\n  _advanceSearchView: function _advanceSearchView() {\n    var self = this;\n    var properties = self.properties;\n    var formSearchParams = $.extend({}, self.getParams(), {\n      navigation: self.getFormContainer().getNavigation() });\n\n\n\n    var searchForm = new bizagi.rendering.smartphone.helpers.searchForm(\n    self.dataService, self.renderFactory,\n    properties.searchForms, {\n      allowFullSearch: properties.allowFullSearch,\n      maxRecords: properties.maxRecords,\n      allowNew: properties.allowNew || false,\n      orientation: properties.orientation || \"ltr\",\n      editable: properties.editable },\n\n    formSearchParams);\n\n\n    searchForm.renderEdition({\n      idRender: properties.id,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      displayName: properties.displayName,\n      idPageCache: properties.idPageCache }).\n    done(function (itemId) {\n      self.setValue({ id: itemId });\n\n      self.readyActionExecution().done(function () {\n        var form = self.getFormContainer();\n        if (!self.properties.submitOnChange) {\n          $.when(form.submitData()).done(function () {\n            self.refreshControl();\n          });\n        }\n      });\n    });\n  },\n\n  /**\r\n      * Simply search autocomplete\r\n      * @private\r\n      */\n  _simplySearchView: function _simplySearchView() {\n    var self = this;\n    var content = self.getContentTemplate();\n\n    self.searchInput.mobileView({\n      customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\n      orientation: self.properties.orientation || \"\",\n      contentTemplate: content,\n      transition: \"slideIn:up\",\n      close: function close() {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      },\n      afterOpenAnimation: function afterOpenAnimation(event) {\n        var $context = $(\".bz-modal-view__search\", event.view.header);\n\n        // Fix the moving content to top\n        if ($context && $context[0]) {\n          $context[0].scrollIntoView(true);\n          $context.focus();\n        }\n      },\n      open: function open() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      configureActions: function configureActions(context) {\n        self.configureModalViewHandlers(context);\n      } });\n\n  },\n\n  autoCompleteSearchResults: function autoCompleteSearchResults(currentValue) {\n    var self = this;\n\n    $.when(self.processRequest({ term: currentValue })).\n    done(function (response) {\n\n      self.modalViewList.find(\"li\").remove();\n\n      for (var i = 0, length = response.length; i < length; i++) {\n        var searchItem = self.renderSearchItem(response[i]);\n\n        searchItem.appendTo(self.modalViewList);\n      }\n    });\n  },\n\n  renderSearchItem: function renderSearchItem(item) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"search.item\");\n\n    var searchItem = $.tmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: item.value });\n\n\n    searchItem.data(\"item\", item);\n\n    return searchItem;\n  },\n\n  processRequest: function processRequest(req) {\n    var self = this;\n    var properties = self.properties;\n    var deferred = new $.Deferred();\n\n    // Create array for response objects\n    var suggestions = [];\n\n    if (self.properties.allowSuggest && req.term.length >= self.properties.searchLength) {\n\n      // Update term property to reflect the search\n      properties.term = req.term;\n\n      var getSuggestData = self.isOfflineForm ? self.getOfflineData() : self.getData();\n\n      // Cancel previous request in order to improve the performance\n      if (self.deferredReference && typeof self.deferredReference.reject === \"function\" && self.deferredReference.state() !== \"resolved\") {\n        self.deferredReference.reject({ hideStatus: true });\n      }\n\n      self.deferredReference = getSuggestData.done(function (data) {\n        if (data && data.length > 0) {\n          data = data.slice(0, properties.maxRecords);\n\n          if (data.length > self.Class.SEARCH_MAX_RECORDS) {\n            data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\n\n            suggestions.push({\n              id: self.Class.NO_RESULTS_SEARCH_ID,\n              label: self.getResource(\"render-search-maximum-records-allowed\"),\n              value: \"\" });\n\n\n\n          } else {\n            data = data.slice(0, properties.maxRecords);\n          }\n\n          // Default value\n          suggestions.push({\n            id: self.Class.DEFAULT_SEARCH_ID,\n            label: self.getResource(\"render-combo-empty-value\"),\n            value: \"\" });\n\n\n          $.each(data, function (i, val) {\n            if (properties.maxRecords === 0 || i < properties.maxRecords) {\n              var parseValue = bizagi.util.performTermMatches(val.value, req.term);\n\n              suggestions.push({ id: val.id, label: parseValue, value: val.value });\n            }\n          });\n\n        } else {\n          suggestions.push({\n            id: self.Class.NO_RESULTS_SEARCH_ID,\n            label: self.getResource(\"render-grid-no-records\"),\n            value: \"\" });\n\n        }\n\n        deferred.resolve(suggestions);\n\n      }).fail(function () {\n        deferred.reject();\n      });\n\n    } else {\n      deferred.resolve(suggestions);\n    }\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Sets the value to show and calls the method to sets the control value\r\n      * @param {object} value\r\n      * @param {int} value.id\r\n      * @param {string} value.label\r\n      * @param {string=} value.additionallabel\r\n      * @example\r\n      *   value = {\r\n      *     id: 123,\r\n      *     label: \"xx\",\r\n      *     additionallabel: \"yyyy\"\r\n      *   }\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var label = \"\";\n\n    value = self.mapValue(value);\n\n    if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\n      if (value.additionallabel && value.label) {\n        label = value.label + \" - \" + value.additionallabel;\n      } else if (value.label) {\n        label = value.label;\n      } else {\n        label = \"\";\n      }\n\n      var inputText = self.searchInput.find(\"input\");\n      inputText.val(label);\n      inputText.attr(\"id\", value.id);\n\n      if (value.id !== \"\" && self.properties.allowClear) {\n        $(\".bz-input-icon\", self.getControl()).removeClass(\"bz-input-icon--empty\");\n      }\n\n      if (self.properties.editable) {\n        self.setValue(value, true);\n      }\n    }\n  },\n\n  /**\r\n      * on the smartphone only sends the id to submit in the smartphone it send the id and the value\r\n      * @returns {}\r\n      */\n  submitData: function submitData() {\n    var self = this;\n    var data = {};\n\n    // Add current data\n    data[self.properties.xpath] = self.getValue();\n\n    // Executes submit on change\n    if (self.properties.submitOnChange && data[self.properties.xpath].id != undefined)\n    self.submitOnChange(data, true);\n  },\n\n  /**\r\n      * Cleans the control's data\r\n      * @returns {}\r\n      */\n  cleanData: function cleanData() {\n    var value = { id: \"\", value: \"\" };\n\n    if (bizagi.util.isEmpty(this.value)) {\n      value = {};\n    }\n\n    this.setValue(value);\n    this.setDisplayValue(value);\n  },\n\n  getContentTemplate: function getContentTemplate() {\n    var template = this.renderFactory.getTemplate(\"search.items\");\n    var content = $.fasttmpl(template, {});\n\n    return $.trim(content);\n  },\n\n  selectItem: function selectItem(item) {\n    var self = this;\n    var previousValue = self.hasValue();\n    var label = Array.isArray(item.value) ? item.value.join(\" - \") : item.value;\n\n    self.setDisplayValue({ id: item.id, label: label });\n\n    if (self.properties.allowClear) {\n\n      if (item.id === self.Class.DEFAULT_SEARCH_ID) {\n        self.searchInput.find(\".bz-search__clear\").addClass(\"bz-search--hidden\");\n        self.searchInput.find(\".bz-search__icon\").removeClass(\"bz-search--hidden\");\n      } else {\n        if (!previousValue && item.id !== self.Class.DEFAULT_SEARCH_ID) {\n          self.searchInput.find(\".bz-search__clear\").removeClass(\"bz-search--hidden\");\n          self.searchInput.find(\".bz-search__icon\").addClass(\"bz-search--hidden\");\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Get offline data for request\r\n      * @param request\r\n      */\n  getOfflineData: function getOfflineData() {\n    var self = this;\n    var dataList = self.properties.data || [];\n    var filter = (self.properties.term || \"\").toLowerCase();\n\n    return $.when(filter.startsWith(\"%%\") ? dataList : dataList.filter(function (item) {\n      var value = item && item.value ? item.value : \"\";\n      if (_typeof(value) === \"object\") {\n        value = value.toString();\n      }\n\n      return value.toLowerCase().indexOf(filter) > -1;\n    }));\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Smartphone Column Decorator Extension\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, bizagi.rendering.columns.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, {\n  applyOverrides: function applyOverrides(decorated) {\n    // Hacks the getControl method in the decorated render to add features\n    var self = this;\n    self._super(decorated);\n\n    if (decorated && decorated.getControl) {\n      self.originalGetControl = decorated.getControl;\n      decorated.getControl = self.getControl;\n      decorated.properties.displayType = \"normal\";\n    }\n  },\n\n  /*\r\n     *   Template method to get the control element\r\n     *   This code runs under the decorated element context\r\n     */\n  getControl: function getControl() {\n    var self = this;\n    var result = self._super();\n\n    if (!result || result.length == 0) {\n      result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\n    }\n\n    return result;\n  },\n  /*\r\n     *   Sets the internal value\r\n     */\n  setValue: function setValue(surrogateKey, value) {\n    var self = this;\n\n    // Check is offline form\n    var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\n    if (isOfflineForm && (typeof value == \"number\" || typeof value == \"string\")) {\n      var newValue = _typeof(self.properties.data) == \"object\" ? self.properties.data.find(function (item) {\n        return item.id == value;\n      }) : value;\n      var decorated = self.getDecorated(surrogateKey);\n      if (decorated !== null) {\n        decorated.selectedValue = value;\n      }\n      return self._super(surrogateKey, newValue);\n    } else {\n      return self._super(surrogateKey, value);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.container.extend(\"bizagi.rendering.smartphone.container\", {}, {\n  /**\r\n                                                                                  * Starts waiting signal for async stuff\r\n                                                                                  */\n  startLoading: function startLoading() {\n  },\n\n  /**\r\n      * Ends waiting for async stuff\r\n      */\n  endLoading: function endLoading() {\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the render class to adjust to smartphone devices\r\n */\n\n// Extends from render base\nbizagi.rendering.render.extend(\"bizagi.rendering.smartphone.render\", bizagi.rendering.render.base.prototype);\n// Extends itself\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.render\", {}, {\n\n  /**\r\n                                                                                       * Update or init the element data\r\n                                                                                       * @param data\r\n                                                                                       */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    var formContainer = this.getFormContainer();\n    this.formParams = formContainer.getParams();\n  },\n\n  /**\r\n      * Override internal rendering in order to apply new smartphone layout\r\n      */\n  internalPostRender: function internalPostRender(element) {\n    this._super(element);\n\n    this.changeDisplayOption();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Returns the label element usually to apply styles\r\n      */\n  getLabel: function getLabel() {\n    if (!this.label)\n    this.label = $(\".bz-form-label label\", this.element || this.observableElement);\n\n    return this.label;\n  },\n\n  getContainerRender: function getContainerRender() {\n    return $(this.element);\n  },\n\n  /**\r\n      * Return the right align class\r\n      */\n  getAlignClass: function getAlignClass(alignType) {\n    return alignType;\n  },\n\n  /**\r\n      * Template method to get the control element\r\n      */\n  getControl: function getControl() {\n    if (!this.control || this.control.length === 0)\n    this.control = $(\".bz-control\", this.element || this.observableElement);\n\n    if (!this.control || this.control.length === 0) return null;\n\n    return this.control;\n  },\n\n  /**\r\n      * Template method to get the control filler element\r\n      */\n  getControlFiller: function getControlFiller() {\n    if (!this.controlFiller)\n    this.controlFiller = $(\".bz-form-item__control\", this.element || this.observableElement);\n\n    return this.controlFiller;\n  },\n\n  getContainerMessage: function getContainerMessage() {\n    if (!this.containerMessage)\n    this.containerMessage = $(\".bz-form-message__text\", this.element || this.observableElement);\n\n    return this.containerMessage;\n  },\n\n  getColumnContainerMessage: function getColumnContainerMessage() {\n    if (!this.containerMessage)\n    this.containerMessage = $(\".bz-form-cell-message__text\", this.element || this.observableElement);\n\n    return this.containerMessage;\n  },\n\n  /**\r\n      * Customizes render label align\r\n      */\n  changeLabelAlign: function changeLabelAlign(alignType) {\n  },\n\n  /**\r\n      * Customizes render value align\r\n      */\n  changeValueAlign: function changeValueAlign(alignType) {\n  },\n\n  /**\r\n      * Customizes render label and value width\r\n      * @returns {}\r\n      */\n  customizeRenderWidth: function customizeRenderWidth() {\n  },\n\n  /**\r\n      * Sends all the info to the server then refreshes the form. Returns a deferred\r\n      */\n  submitOnChange: function submitOnChange(data, bRefreshForm, noCollect) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // TODO: Review loader for smartphone\n    bizagi.util.smartphone.startLoading();\n\n    $.when(self.isReadyToSave()).done(function () {\n      $.when(self.internalSubmitOnChange(data, bRefreshForm, noCollect)).\n      done(function () {\n        defer.resolve();\n      }).fail(function () {\n        defer.reject();\n      }).always(function () {\n        bizagi.util.smartphone.stopLoading();\n      });\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Adds a validation message to the render\r\n      */\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n    var dataType = bizagi.util.normalizeType(this.properties.type);\n    var isGridControl = dataType === \"grid\" || dataType === \"groupedgrid\";\n    var isColumn = this.column && /column/.test(dataType);\n    var $message = isColumn ? this.getColumnContainerMessage() : this.getContainerMessage();\n\n    if (message && message.length > 0) {\n      message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\n\n      $message.attr(\"data-error\", message);\n      $message.text(message);\n\n      if (this.element) {\n        isGridControl ? this.element.addClass(\"bz-form-item-grid--error\") : this.element.addClass(\"bz-form-item--error\");\n      }\n    } else {\n      $message.text(\"\");\n\n      if (this.element) {\n        isGridControl ? this.element.removeClass(\"bz-form-item-grid--error\") : this.element.removeClass(\"bz-form-item--error\");\n      }\n    }\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var control = self.getControl();\n\n    // Set internal value\n    self.setValue(value, false);\n\n    if (!self.properties.editable && self.properties.display !== \"check\") {\n      // Render as simple value\n      var displayValue = self.getDisplayValue(value);\n\n      if (typeof displayValue == \"string\" || typeof displayValue == \"number\") {\n        $(control).html(\"<label class='bz-form-label'>\" + displayValue + \"</label>\");\n      }\n    }\n  },\n\n  actionSave: function actionSave() {\n    this.setValue(this.inputEdition.val(), false);\n  },\n\n  configureLabel: function configureLabel() {\n    return this.properties.displayName;\n  },\n\n  /**\r\n      * Starts waiting signal for async stuff\r\n      */\n  startLoading: function startLoading() {\n  },\n\n  /**\r\n      * Ends waiting for async stuff\r\n      */\n  endLoading: function endLoading() {\n  },\n\n  /**\r\n      * In mobiles, don't apply styles to icon's elements\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\".bz-input\", context);\n  },\n\n  /**\r\n      * Return the right display option class\r\n      * @param displayType\r\n      * @returns {string}\r\n      */\n  getDisplayOptionClass: function getDisplayOptionClass(displayType) {\n    if (displayType === \"reversed\") {\n      return \"bz-form-item--display-reversed\";\n    } else if (displayType === \"label\") {\n      return \"bz-form-item--display-label\";\n    } else if (displayType === \"value\") {\n      return \"bz-form-item--display-value\";\n    }\n  },\n\n  /**\r\n      * Return the label\r\n      */\n  getFormattingLabel: function getFormattingLabel() {\n    // TODO: Despues de cambiar a genome desktop, validar se solo se deja este metodo en la base\n    return this.getLabel();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n    var control = self.getControl();\n\n    var input = control.find(\"input\").filter(function (index, ele) {\n      return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\";\n    });\n\n    if (input.length > 0) {\n      input.val(self.getValue());\n    } else {\n      self.setDisplayValue(\"\");\n    }\n  },\n\n  getFormParams: function getFormParams() {\n    return this.formParams || {};\n  },\n\n  /**\r\n      * Transform the display type when using RTL orientation\r\n      */\n  getRTLDisplayType: function getRTLDisplayType(displayType) {\n    return displayType;\n  },\n\n  /**\r\n      * Changes the render visibility\r\n      * @param argument\r\n      */\n  changeVisibility: function changeVisibility(argument) {\n    // Update properties\n    this.properties.visible = argument;\n\n    // Hide - show the render\n    if (bizagi.util.parseBoolean(argument)) {\n      if (this.properties.type !== \"hidden\") {\n        this.element.show();\n        this.element.css(\"display\", \"\");\n      }\n    } else if (this.element) {\n      this.element.hide();\n    }\n  },\n\n  /**\r\n      *  Changes the render required\r\n      * @param argument\r\n      */\n  changeRequired: function changeRequired(argument) {\n    // Update properties\n    this.properties.required = argument;\n\n    if (bizagi.util.parseBoolean(argument) && this.properties.editable) {\n      this.element.addClass(\"bz-form-item--required\");\n    } else {\n      this.element.removeClass(\"bz-form-item--required\");\n    }\n\n    // Perform validations again to check if the form is valid after this change\n    this.triggerRenderValidate();\n  },\n\n  /**\r\n      * This method just make a toggle of red label indicator\r\n      * @argument {boolean} argument\r\n      */\n  changeRequiredLabel: function changeRequiredLabel(argument) {\n    // Prevent take the base\n  },\n\n  /**\r\n      * Change cell editability and attach bindings\r\n      * @param argument\r\n      * @param key\r\n      * @param xpath\r\n      */\n  changeEditabilityCellControl: function changeEditabilityCellControl(argument, key, xpath) {\n    this._super(argument, key, xpath);\n  },\n\n  /**\r\n      * Save visual changes of children in grid\r\n      */\n  saveGridChildrenVisualChanges: function saveGridChildrenVisualChanges() {\n    var self = this;\n    var indexes = self.getIndexes();\n\n    self.gridChildrenVisualChanges = [];\n\n    if (self.columns.length > 0) {\n      $.each(self.columns, function (j, column) {\n        if (column.properties.xpath) {\n          for (var i = 0; i < indexes.length; i++) {\n            var cell = column.decorated;\n\n            if (cell && cell.properties)\n            self.gridChildrenVisualChanges[cell.properties.id + indexes[i]] = cell.visualChanges;\n          }\n\n        }\n      });\n    }\n  },\n\n  /**\r\n      * Restore appearance of grid\r\n      */\n  restoreGridAppearance: function restoreGridAppearance() {\n    var self = this;\n    var indexes = self.getIndexes();\n\n    self.restoreAppearance();\n\n    if (self.columns.length > 0) {\n      $.each(self.columns, function (j, column) {\n        for (var i = 0; i < indexes.length; i++) {\n          column.decorated.restoreCellAppearance();\n        }\n      });\n    }\n  },\n\n  restoreGridChildrenVisualChanges: function restoreGridChildrenVisualChanges() {\n    var self = this;\n    var indexes = self.getIndexes();\n    if (self.columns.length > 0) {\n      $.each(self.columns, function (j, column) {\n        if (column.properties.xpath) {\n          for (var i = 0; i < indexes.length; i++) {\n            var cell = column.decorated;\n\n            if (cell && cell.properties)\n            cell.visualChanges = self.gridChildrenVisualChanges[cell.properties.id + indexes[i]] || {};\n          }\n\n        }\n      });\n    }\n\n    delete self.gridChildrenVisualChanges;\n  } });","/*\r\n*   Name: Bizagi Smartphone Form Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.form\", bizagi.rendering.form.prototype);\n// Auto extend\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.form\", {}, {\n\n  init: function init(params) {\n    var self = this;\n    params = params || {};\n    // Define variables\n    self.warnings = {};\n    self.errors = {};\n    if (params.syncError) {\n      params.data.properties.editable = params.isOfflineErrorMode !== true;\n      var syncMessage = params.syncError.type == \"business\" ? params.syncError.message : undefined;\n      if (!bizagi.util.isEmpty(syncMessage)) {\n        try {\n          syncMessage = $.makeArray(syncMessage);\n          syncMessage.forEach(function (currentMessage) {\n            self.errors[currentMessage] = currentMessage;\n          });\n        } catch (e) {\n          console.error(\"syncErrorMessage could not be parsed as array\", syncMessage);\n          self.errors[syncMessage] = syncMessage;\n        }\n      }\n      delete params.syncError;\n    }\n    self.isOfflineErrorMode = params.isOfflineErrorMode === true;\n    self.showToastOnSuccessSync = params.showToastOnSuccessSync === true;\n    self.removeSyncErrorOnSubmit = params.removeSyncErrorOnSubmit === true;\n    // Call base\n    this._super(params);\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each container after processed\r\n      */\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n\n    self._super(container);\n    var buttons = self.getButtons();\n\n    //disable overflow-scrolling touch untill the form is loaded QA-2178\n    if (bizagi.util.isiOSTabletDevice()) {\n      $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\n    }\n\n    // Show warnings\n    if (!bizagi.util.isObjectEmpty(self.warnings)) {\n      var warningContainer = $('<ul class=\"ui-bizagi-form-warnings\"></ul>');\n      for (var key in self.warnings) {\n        warningContainer.append($('<li>' + key + '</li>'));\n      }\n\n      // Add button\n      $(\"<button>\" + \"X\" + \"</button>\").appendTo(warningContainer);\n\n      // Append to body \n      warningContainer.prependTo(self.container);\n      warningContainer.click(function () {\n        warningContainer.detach();\n      });\n    }\n\n    // Show errors\n    if (!bizagi.util.isEmpty(self.errors)) {\n      for (var ekey in self.errors) {\n        setTimeout(function () {\n          self.addValidationMessage(ekey);\n        }, 1);\n      }\n    }\n\n    //Set button length\n    var lengthButtons = buttons ? buttons.length : 0;\n\n    if (lengthButtons) {\n\n      $(document).data(\"auto-save\", \"auto-save\");\n\n      //bind event auto-save\n      $(document).unbind(\"save-form\").bind(\"save-form\", function (e, deferredSave) {\n        if (self.allowOnlineActions()) {\n          self.autoSaveEvents(deferredSave);\n        } else {\n          deferredSave.resolve();\n        }\n      });\n\n      //bind event beforeunload\n      $(window).unbind('beforeunload').bind('beforeunload', function (e) {\n        var newData = {};\n        self.collectRenderValues(newData);\n\n        //if there are changes in the form show a message\n        if (!$.isEmptyObject(newData) && $(document).data('auto-save'))\n        return bizagi.localization.getResource(\"confirmation-savebox-message2\");\n\n        return;\n      });\n    }\n\n    // Process Sections opened\n    var formParams = this.getParams() || {};\n    var selectedSections = $.extend([], formParams.selectedSection);\n    this.setParam(\"selectedSection\", []);\n    if (selectedSections.length > 0) {\n      selectedSections.forEach(function (id) {\n        var section = self.getRenderById(id);\n        if (typeof section !== \"undefined\") {\n          section.expand();\n        }\n      });\n    }\n  },\n\n  /**\r\n      * Auto Save Events\r\n      *\r\n      * @param {} deferredSave\r\n      * @param {} saveBox\r\n      * @returns {}\r\n      */\n  autoSaveEvents: function autoSaveEvents(deferredSave, saveBox) {\n    var self = this;\n    var data = {};\n\n    if (self.isOfflineErrorMode) {\n      deferredSave.resolve();\n      return;\n    }\n\n    self.collectRenderValues(data);\n\n    if (!$.isEmptyObject(data)) {\n      var isStartForm = self.properties.formtype === \"startform\";\n      var message = isStartForm ? bizagi.localization.getResource(\"confirmation-savebox-message4\") : bizagi.localization.getResource(\"confirmation-savebox-message1\");\n\n      var confirmation = isStartForm ? bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\", [{ label: bizagi.localization.getResource(\"confirmation-box-ok\"), action: \"resolve\" }, { label: bizagi.localization.getResource(\"confirmation-box-cancel\"), action: \"reject\" }]) :\n      bizagi.showSaveBox(message, \"Bizagi\", \"warning\");\n      $.when(confirmation).\n      done(function () {\n        if (!isStartForm) {\n          bizagi.loading.start();\n          $.when(self.saveForm()).\n          always(function () {\n            if (self.params.isOfflineForm && self.params.offlineType === \"task\" && self.online) {\n              var syncDeferred = new $.Deferred();\n              var syncParams = $.extend({ deferred: syncDeferred }, self.params);\n              $(document).trigger(\"tryPushCase.offline\", syncParams);\n              $.when(syncDeferred).\n              then(function () {\n                deferredSave.resolve();\n              }).\n              fail(function () {\n                console.log(\"Auto-Save Sync Error\", arguments);\n                //Resolve the save to allow back to the inbox\n                deferredSave.resolve();\n              }).always(function () {\n                bizagi.loading.stop();\n              });\n            } else\n            {\n              bizagi.loading.stop();\n              deferredSave.resolve();\n            }\n          });\n        } else {\n          deferredSave.resolve();\n        }\n      }).fail(function () {\n        if (isStartForm) {\n          deferredSave.reject();\n        } else {\n          deferredSave.resolve();\n        }\n      });\n    } else {\n      deferredSave.resolve();\n    }\n  },\n\n  /**\r\n      * TEMPLATE METHOD TO GET THE BUTTONS OBJECTS\r\n      */\n  getButtons: function getButtons() {\n    var self = this;\n\n    if (self.getParams() && (handler = self.getParams().getButtons))\n    handler(self);\n\n    return $(\".ui-bizagi-button-container :button\", self.container);\n  },\n\n  processButtons: function processButtons() {\n    var self = this;\n    var params = self.getParams();\n\n    if (params && params.processButtons) {\n      var handler = params.processButtons;\n      handler(self);\n    }\n\n    var properties = self.properties;\n    properties.buttons = self.buttons;\n\n    // To cache a submit Data Buttom if exist\n    self.saveButton = null;\n    self.nextButton = null;\n\n    // Set saveButton and nextButton if exist\n    for (var i = 0, length = properties.buttons.length; i < length; i++) {\n      if (properties.buttons[i].action === \"save\") {\n        self.saveButton = properties.buttons[i];\n      } else if (properties.buttons[i].action === \"next\") {\n        self.nextButton = properties.buttons[i];\n      }\n    }\n\n    var navigation = self.getNavigation();\n\n    if (typeof navigation !== \"undefined\") {\n      //si tiene un viewConteiner sera porque es una forma dentro de container de edicion\n      var view_container = self.getViewContainer();\n      if (typeof view_container !== \"undefined\") {\n        view_container.setNavigationButtons(self);\n      } else {\n        navigation.setNavigationButtons(self);\n      }\n    }\n\n    // bind de touch events\n    self.bindTouchEvents(self.getButtons());\n  },\n\n  refreshForm: function refreshForm(focus) {\n    var self = this;\n    var params = self.getParams();\n    var defer = new $.Deferred();\n\n    focus = focus || self.getFocus();\n\n    var options = {\n      idCase: self.params.idCase || \"\",\n      idWorkitem: self.params.idWorkitem || \"\",\n      idTask: self.params.idTask || \"\",\n      focus: focus,\n      selectedTabs: self.getSelectedTabs(),\n      selectedSection: self.getSelectedSection(),\n      xpathContext: self.properties.xpathContext,\n      idPageCache: self.properties.idPageCache,\n      isRefresh: true,\n      action: self.getEndPointAction(),\n      idStartScope: self.properties.idStartScope || \"\",\n      navigation: params.navigation,\n      view_container: params.view_container };\n\n\n    if (self.isOfflineRefreshWithEdition) {\n      options.isEdited = true;\n      self.isOfflineRefreshWithEdition = false;\n    }\n\n    if (params.postRenderEdit || params.processButtons) {\n      options.postRenderEdit = params.postRenderEdit;\n      options.processButtons = params.processButtons;\n      options.originalParams = params.originalParams || {};\n      options.getButtons = params.getButtons;\n    }\n\n    // Notify the refresh event so the consumer takes the decision about what to do\n    self.startLoading();\n\n    $.when(self.triggerHandler(\"refresh\", options)).done(function () {\n      defer.resolve();\n    }).fail(function () {\n      defer.reject();\n    }).always(function () {\n      self.endLoading();\n    });\n\n    return defer.promise();\n  },\n\n  startLoading: function startLoading(delay) {\n    bizagi.util.smartphone.startLoading();\n  },\n\n  endLoading: function endLoading() {\n    bizagi.util.smartphone.stopLoading();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the container's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var form = self.container;\n\n    // Process complex-gateway\n    self.configureComplexGateway();\n\n    // Process buttons\n    self.processButtons(form);\n\n    // Check for dom included event\n    self.bind(\"ondomincluded\", function () {\n      var $canvas = self.getValidationsContainer();\n\n      // Creates validation controller after the form is ready\n      self.validationController = new bizagi.command.controllers.validation(self, self.validations, $canvas);\n\n      // Creates action controller after the form is ready\n      self.actionController = new bizagi.command.controllers.action(self, self.actions);\n\n      // Resolve this deferred to start executing DOM dependant plugins\n      self.readyDeferred.resolve();\n    });\n\n    //Event to notify the native code the form will be showing a modal view\n    self.bind(\"modalViewDidAppear\", function () {\n      self.params.navigation.modalViewDidAppear();\n    });\n\n    self.bind(\"closeModalValidationMessage\", function () {\n      if (self.validationController) {\n        self.validationController.clearValidationMessages();\n      }\n    });\n\n    //Event to notify the native code the form will be hiding a modal view\n    self.bind(\"modalViewDidDisappear\", function () {\n      self.params.navigation.modalViewDidDisappear();\n    });\n\n    // Add network listener\n    self.configureNetworkHandlers();\n  },\n\n  internalSubmitForm: function internalSubmitForm(buttonProperties) {\n    var self = this;\n    var actions = [];\n    var defer = $.Deferred();\n    var submitDataAction = null;\n    var executeButtonAction = null;\n    var performAction = null;\n    var checkpointAction = null;\n    var commitAction = null;\n    var data = {};\n\n    // Fill data hash | Collect data\n    if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase)\n    data = self.collectRenderValuesForSubmit();\n\n    // Start asynchronous operation\n    $.when(self.startLoading()).done(function () {\n      $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\n    });\n\n    // Prepare actions\n    // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\n    if (buttonProperties.executeRule) {\n      submitDataAction = self.dataService.submitData({\n        action: \"SUBMITDATA\",\n        data: data,\n        xpathContext: self.properties.xpathContext,\n        idPageCache: self.properties.idPageCache,\n        prepare: true });\n\n\n      submitDataAction.tag = \"submitData\";\n      checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\n\n      // Reset data because when an execute rule operation has been performed, it saved already all the data\n      data = {};\n      executeButtonAction = self.dataService.executeButton({\n        idRender: buttonProperties.id,\n        xpathContext: self.properties.xpathContext || \"\",\n        idPageCache: self.properties.idPageCache,\n        prepare: true });\n\n\n      executeButtonAction.tag = \"executeRule\";\n      commitAction = self.prepareCommitAction(buttonProperties.id);\n    }\n\n    if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\n      // Verify transitions\n      if (self.transitions) {\n        var transitions = [];\n        $.each(this.activeTransitions, function (key, value) {\n          value ? transitions.push(key) : \"\";\n        });\n\n        if (bizagi.util.countProps(transitions) == 0) {\n          var messageComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-path\");\n          var errorComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-error\");\n\n          bizagi.showMessageBox(messageComplexGateway, errorComplexGateway, \"info\", false);\n          self.endLoading();\n          defer.reject();\n          return defer.promise();\n        }\n      }\n\n      performAction = self.dataService.submitData({\n        action: buttonProperties.action,\n        forcePlanCompletion: buttonProperties.forcePlanCompletion,\n        data: data,\n        xpathContext: self.properties.xpathContext,\n        idPageCache: self.properties.idPageCache,\n        prepare: true,\n        transitions: transitions || \"\",\n        contexttype: self.properties.contextType,\n        surrogatekey: self.properties.surrogateKey });\n\n\n      performAction.tag = \"performAction\";\n    }\n\n    if (executeButtonAction) {\n      actions.push(submitDataAction);\n\n      //Validates if the method CHECKPOINT is supported\n      if (checkpointAction) {\n        actions.push(checkpointAction);\n      }\n\n      actions.push(executeButtonAction);\n\n      //Validates if the method COMMIT is supported\n      if (commitAction) {\n        actions.push(commitAction);\n      }\n    }\n\n    if (performAction)\n    actions.push(performAction);\n\n    //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\n    var flowControlDeferred = new $.Deferred();\n\n    if (data && data.deferreds) {\n      $.when.apply(this, data.deferreds).\n      done(function (response) {\n        flowControlDeferred.resolve(response);\n      }).fail(function () {\n        console.log(\"Error: It was not possible resolve async actions on form \");\n        flowControlDeferred.reject();\n      });\n    } else {\n      flowControlDeferred.resolve();\n    }\n\n    $.when(flowControlDeferred).done(function () {\n      bizagi.util.smartphone.startLoading();\n      $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\n        //Hard refresh buttons\n        if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()) {\n          var navigation = self.getNavigation();\n          if (typeof navigation !== \"undefined\") {\n            navigation.setNavigationButtons(self);\n          }\n        }\n        // End asynchronous operation\n        self.endLoading();\n        // Find validations\n        var bHasValidations;\n        $.each(responses, function (i, response) {\n          // Something went wrong, we gotta display messages in notifications grid\n          if (response.result.type == \"validationMessages\") {\n            self.addValidationMessage(response.result.messages);\n            bHasValidations = true;\n          }\n          if (response.result.type == \"alertMessages\") {\n            // Something went wrong, we are gonna display messages in an alert\n            bizagi.showMessageBox(response.result.messages.join(','), bizagi.localization.getResource(\"workportal-general-word-information\", \"Information\"));\n            bHasValidations = true;\n          }\n        });\n\n        if (!bHasValidations) {\n          // Everything went ok .. succesfully response from the server\n          if (!self.postProcessButton(responses, buttonProperties))\n          return;\n\n          // After successfully response refresh the form\n          if (buttonProperties.refresh)\n          self.refreshForm();\n\n          // If needs routing publish an event\n          if (buttonProperties.routing) {\n            self.triggerHandler(\"routing\", { idCase: self.params.idCase });\n          }\n\n          // Create case\n          if (buttonProperties.createnewcase) {\n            if (responses.length > 0) {\n              self.triggerHandler(\"routing\", {\n                idCase: responses[0].result.IdCase,\n                caseNumber: responses[0].result.CaseNumber });\n\n            }\n          }\n        } else {\n          if (buttonProperties.executeRule)\n          self.sendRollbackAction(buttonProperties.id);\n        }\n\n        //Removes the nonSupportedMethods to prevent further iterations\n        delete self.nonSupportedMethods;\n\n        defer.resolve();\n      }).fail(function (res, res2, response) {\n        var messageError = \"\";\n        var errorTypeList = [\"WaitForCompletionPlanException\", \"InvalidPlanStateException\", \"CustomMessageException\"];\n\n        if (buttonProperties.executeRule) self.sendRollbackAction(buttonProperties.id);\n\n        if (response && response.error && errorTypeList.indexOf(response.error.errorType) !== -1) {\n          messageError = bizagi.localization.getResource(response.error.message);\n          self.endLoading();\n\n          $.when(bizagi.showConfirmationBox(messageError, null, false)).then(function () {\n            var _params = $.extend({}, buttonProperties, { forcePlanCompletion: true });\n\n            return $.when(self.internalSubmitForm(_params));\n          }).done(function () {\n            defer.resolve();\n          }).fail(function () {\n            defer.reject();\n          });\n        } else {\n          messageError = typeof response === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response;\n          self.failHandler({ \"error\": messageError });\n          defer.reject(response);\n        }\n      }).always(function () {\n        bizagi.util.smartphone.stopLoading();\n      });\n    }).always(function () {\n      bizagi.util.smartphone.stopLoading();\n    });\n\n    return defer.promise();\n  },\n\n  prepareCheckpointAction: function prepareCheckpointAction(id) {\n    return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\n  },\n\n  prepareCommitAction: function prepareCommitAction(id) {\n    return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\n  },\n\n  getNavigation: function getNavigation() {\n    var params = this.getFormContainer().getParams();\n    return params.navigation;\n  },\n\n  getViewContainer: function getViewContainer() {\n    var params = this.getFormContainer().getParams();\n    return params.view_container;\n  },\n\n  isFloatingButtonsEnabled: function isFloatingButtonsEnabled() {\n    var navigation = this.getNavigation();\n    return navigation && navigation.isFloatingButtonsEnabled();\n  },\n\n  isFormButtonsEnabled: function isFormButtonsEnabled() {\n    var navigation = this.getNavigation();\n    return navigation && navigation.isFormButtonsEnabled();\n  },\n\n  dispose: function dispose(params) {\n    // Active refresh on smartphone\n    if (typeof params === \"undefined\" || typeof params.isRefresh === \"undefined\" || params.isRefresh == false) {\n      this._super();\n    }\n  },\n\n  /**\r\n      * Publish a global event that the facade will replicate, also will be triggered in the form\r\n      */\n  triggerGlobalHandler: function triggerGlobalHandler(eventType, data) {\n    var self = this;\n\n    if (!self.parent) {\n      if (self.observableElement) {\n        self.observableElement.trigger(eventType, data);\n      }\n    } else {\n      self.parent.triggerGlobalHandler(eventType, data);\n    }\n\n    return self._super(eventType, data);\n  },\n\n  // TODO: REVIEW, ADD NOTIFIER PLUGIN!!!\n  failHandler: function failHandler(error) {\n    var self = this;\n    self._super(error);\n\n    var error_obj = {};\n\n    try {\n      error_obj = JSON.parse(error) || {};\n    } catch (e) {\n      error_obj = error.length && error.length > 1 ? error[0] : error;\n    } finally {\n      //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\n      if (error_obj.error) error_obj = error_obj.error;\n      if (error_obj.error) error_obj = error_obj.error;\n\n      // trigger the routing event in order to refresh the case\n      if (typeof error_obj.code !== \"undefined\" && error_obj.code === \"AUTH_ERROR\") {\n        self.refreshAfterSessionIdle();\n      }\n    }\n  },\n\n  /**\r\n      * Display session IDLE message error and routing to process\r\n      */\n  refreshAfterSessionIdle: function refreshAfterSessionIdle() {\n    $.notifier.add({\n      title: bizagi.localization.getResource(\"workportal-sessiontimeout-expired-title\", \"Your session has expired\"),\n      text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\n      sticky: false,\n      overlay: true,\n      time: 5000,\n      after_close: this.routingToProcess.bind(this) });\n\n  },\n\n  /**\r\n      * Refresh the process\r\n      */\n  routingToProcess: function routingToProcess() {\n    var self = this;\n    var params = self.params || {};\n    var form = self.getFormContainer();\n    var isStartForm = form && form.isStartForm();\n\n    if (isStartForm) {\n      var processParams = params && params.originalParams || {};\n      if (processParams && processParams.idProcess) {\n        bizagi.webpart.publish(\"render-start-form\", {\n          params: {\n            showProcess: true,\n            hasStartForm: true,\n            fromNewCase: true,\n            idProcess: processParams.idProcess,\n            displayName: processParams.displayName || \"\",\n            mapping: {},\n            type: \"Process\" } });\n\n\n      }\n    } else {\n      self.triggerHandler(\"routing\", {\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem });\n\n    }\n  },\n\n  /**\r\n      * Build the container html\r\n      */\n  renderContainer: function renderContainer() {\n    var self = this;\n    var properties = this.properties;\n    var template = self.renderFactory.getTemplate(\"form\");\n    var idCase = \"\";\n\n    // Render the form\n    var html = $.fasttmpl(template, {\n      buttons: self.buttons,\n      transitions: self.transitions,\n      uniqueId: properties.uniqueId,\n      helptext: properties.helpText,\n      mode: self.getMode(),\n      queryForm: self.getFormType() == \"queryForm\",\n      summaryForm: self.params.summaryForm || false,\n      globalForm: self.properties.displayAsReadOnly || false,\n      idCase: idCase,\n      displayName: self.params.displayName || idCase,\n      processPath: properties.processPath,\n      breadCrumb: properties.breadCrumb,\n      orientation: properties.orientation });\n\n\n    // Render children\n    return self.replaceChildrenHtml(html, self.renderChildrenHtml());\n  },\n\n  bindTouchEvents: function bindTouchEvents(buttons) {\n    var self = this;\n    var touchMoveStart = 0;\n\n    // Don't process buttons if they are undefined in the template\n    if (!buttons || buttons.length === 0) return;\n\n    buttons.bind(\"touchstart\", function (event) {\n      event.preventDefault();\n\n      var pointer = event.originalEvent.targetTouches ? event.originalEvent.targetTouches[0] : event;\n      var currentPossitionY = pointer.pageY;\n\n      touchMoveStart = currentPossitionY;\n    });\n\n    buttons.bind(\"touchend\", function (event) {\n      event.preventDefault();\n\n      // Trigger the blur of the focused element in order to catch the render Change in the last changed control\n      $(\":focus\", self.container).blur();\n      var pointer = event.originalEvent.changedTouches ? event.originalEvent.changedTouches[0] : event;\n      var currentPositionY = pointer.pageY;\n\n      self.startLoading();\n\n      // If the finger is too far from the button when you stop touching the screen, then do nothing\n      if (event.type !== \"click\" && currentPositionY > touchMoveStart + 40 || currentPositionY < touchMoveStart - 40) {\n        self.endLoading();\n      } else {\n        var button = $(this);\n        var ordinal = button.attr(\"ordinal\");\n        var buttonProperties = self.buttons[ordinal];\n\n        // Execute button\n        $.when(self.processButton(buttonProperties)).always(function () {\n          self.endLoading();\n        });\n      }\n    });\n\n    buttons.bind(\"click\", function () {\n      self.startLoading();\n      var ordinal = $(this).attr(\"ordinal\");\n      var buttonProperties = self.buttons[ordinal];\n\n      // Execute button\n      $.when(self.processButton(buttonProperties)).always(function () {\n        self.endLoading();\n      });\n    });\n\n    return;\n  },\n\n  /**\r\n      * Configure actions to complex-gateway\r\n      */\n  configureComplexGateway: function configureComplexGateway() {\n    var self = this;\n    var complexGatewayContainer;\n    var form = self.container;\n\n    if (form.length > 1) {\n      $(form.children()).each(function () {\n        if ($(this).hasClass('.bz-complex-gateway'))\n        complexGatewayContainer = this;\n      });\n    } else {\n      complexGatewayContainer = $(\".bz-complex-gateway\", form);\n    }\n\n    // activeTransitions is used to store ids of activities in Complex Gateway\n    self.activeTransitions = {};\n\n    // Set events for complex gateway interface\n    $(\".bz-checkbox__input\", complexGatewayContainer).on(\"click\", function () {\n      var $selected = $(this);\n      var transitionId = $selected.data(\"value\") || \"\";\n\n      if (typeof self.activeTransitions[transitionId] == \"undefined\") {\n        self.activeTransitions[transitionId] = false;\n      }\n\n      self.activeTransitions[transitionId] = $selected.is(':checked') || false;\n\n    });\n  },\n\n  /**\r\n      * Perform validation container\r\n      * @param form\r\n      * @param mainForm\r\n      * @returns {*}\r\n      */\n  getValidationsContainer: function getValidationsContainer(mainForm) {\n    var form = this;\n    var navigation = form.getNavigation();\n\n    if (typeof navigation !== \"undefined\") {\n      var view_container = form.getViewContainer();\n      var $currentView = typeof view_container !== \"undefined\" ? view_container.view : navigation.view;\n\n      if ($currentView && $currentView.footer) {\n        return $currentView.footer;\n      }\n    }\n\n    return this._super(mainForm);\n  } });","/**\r\n *   Name: Bizagi Smartphone Panel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.panel\", bizagi.rendering.panel.prototype);\n// Extends itself\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.panel\", {}, {});","/**\r\n *   Name: Bizagi Smartphone ContentPanel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the content panel class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.contentPanel\", bizagi.rendering.contentPanel.prototype);\n// Extends itself\nbizagi.rendering.smartphone.contentPanel.extend(\"bizagi.rendering.smartphone.contentPanel\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Nested Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for smartphone devices\r\n*/\n\n// Extends from panel smartphone base\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.nestedForm\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Tab Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tab\", bizagi.rendering.tab.prototype);\n// Auto extend\nbizagi.rendering.smartphone.tab.extend(\"bizagi.rendering.smartphone.tab\", {}, {\n\n  /* POST RENDER CONTAINER ACTIONS\r\n                                                                                =================================================*/\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n\n    this._super(container);\n\n    container.material_bizagi_tabs({\n      direction: this.properties.orientation,\n      active_index_tab: this.activeTab }).\n    on(\"updateActive\", function (ev, info) {\n      ev.stopPropagation();\n\n      self.setActiveTab(info.index);\n    });\n\n    $(\"> .bz-tabs > .bz-tab\", container).rippleEffect();\n  } });","/*\r\n*   Name: Bizagi Smartphone Panel Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tabItem\", bizagi.rendering.tabItem.prototype);\n// Extends itself\nbizagi.rendering.smartphone.tabItem.extend(\"bizagi.rendering.smartphone.tabItem\", {}, {\n\n  /**\r\n                                                                                         * Change selected item\r\n                                                                                         *\r\n                                                                                         * @param {} argument\r\n                                                                                         * @returns {}\r\n                                                                                         */\n  setAsActiveContainer: function setAsActiveContainer(argument) {\n    var self = this;\n\n    $.when(self.ready()).done(function () {\n      var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\n\n      tabItem.css(\"display\", \"\");\n      tabItem.click();\n    });\n  },\n  /* \r\n     *   Focus on container\r\n     */\n  focus: function focus() {\n    // Activate the tab if it hasn't been loaded\n    this.activate();\n\n    // Set this tab as an active container\n    this.setAsActiveContainer();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      *  Hides / Show container\r\n      *\r\n      * @param {} argument\r\n      * @returns {}\r\n      */\n  changeVisibility: function changeVisibility(argument) {\n    var self = this;\n\n    // Store in properties\n    self.properties.visible = bizagi.util.parseBoolean(argument);\n\n    $.when(self.ready()).done(function () {\n      var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\n      var activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\n\n      // Hide - show the render\n      if (self.properties.visible) {\n        tabItem.css(\"display\", \"\");\n        if (self.properties.counter === activeTab.index) {\n          self.container.css(\"display\", \"\");\n          self.setAsActiveContainer();\n        } else {\n          self.container.css(\"display\", \"none\");\n        }\n      } else {\n        self.container.css(\"display\", \"none\");\n        tabItem.css(\"display\", \"none\");\n\n        // If we are focus in the same tab is going to be invisible\n        activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\n\n        if (self.properties.counter === activeTab.index) {\n          self.parent.container.material_bizagi_tabs(\"moveToNextTab\");\n        } else {\n          self.parent.container.material_bizagi_tabs(\"refreshPositions\");\n        }\n      }\n    });\n  },\n\n  afterToRefresh: function afterToRefresh() {\n    var self = this;\n    self._super();\n    $.when(self.ready()).done(function () {\n      self.parent.container.material_bizagi_tabs(\"refreshTab\", self.properties.id);\n    });\n  } });","/*\r\n*   Name: Bizagi Smartphone Horizontal Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.horizontal\", bizagi.rendering.horizontal.prototype);\n// Auto extend\nbizagi.rendering.smartphone.horizontal.extend(\"bizagi.rendering.smartphone.horizontal\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Layout Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the layout class to adjust to smartphone devices\r\n*/\n\n// Extends from container desktop base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.layout\", bizagi.rendering.layout.prototype);\n// Extends itself\nbizagi.rendering.smartphone.layout.extend(\"bizagi.rendering.smartphone.layout\", {}, {});","/*\r\n*   Name: Bizagi smartphone Accordion Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordion\", bizagi.rendering.accordion.prototype);\n// Extends itself\nbizagi.rendering.smartphone.accordion.extend(\"bizagi.rendering.smartphone.accordion\", {}, {});","/*\r\n*   Name: Bizagi smartphone AccordionItem Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordionItem\", bizagi.rendering.accordionItem.prototype);\n// Extends itself\nbizagi.rendering.smartphone.accordionItem.extend(\"bizagi.rendering.smartphone.accordionItem\", {}, {});","/*\r\n *   Name: Bizagi Smartphones Group Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the group class to adjust to smartphones devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.group\", bizagi.rendering.group.prototype);\n// Auto extend\nbizagi.rendering.smartphone.group.extend(\"bizagi.rendering.smartphone.group\", {}, {\n\n  /**\r\n                                                                                    * Method to customize the container's behaviour to add handlers\r\n                                                                                    */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    $(\">h5.bz-collapsible__header\", self.container).bind(\"click\", function () {\n      $(self.container).toggleClass(\"bz-collapsible--collapsed\");\n    });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each container after processeds\r\n      * @param {} group      \r\n      */\n  postRenderContainer: function postRenderContainer(group) {\n    // Call base\n    this._super(group);\n    if (this.properties.collapse) {\n      this.collapse();\n    }\n  },\n\n  /**\r\n     * Check if group its open\r\n     * \r\n     * @return boolean\r\n     */\n  isOpen: function isOpen() {\n    return this.container.hasClass(\"bz-collapsible--collapsed\") ? false : true;\n  },\n\n  /**\r\n      * Focus on container     \r\n      */\n  focus: function focus() {\n    // Expand container\n    this.expand();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Expands group container \r\n      * @returns {} \r\n      */\n  expand: function expand() {\n    if (!this.isOpen()) {\n      $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Collapses group container \r\n      * @returns {} \r\n      */\n  collapse: function collapse() {\n    if (this.isOpen()) {\n      $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Expands or collapse the container from actions\r\n      * @param {} argument      \r\n      */\n  toogleContainer: function toogleContainer(argument) {\n    if (argument) {\n      this.expand();\n    } else {\n      this.collapse();\n    }\n  } });","/*\r\n *   Name: Bizagi Smartphone Section Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the section class to adjust to smartphone devices\r\n */\n\n// Extends from container tablet base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.section\", bizagi.rendering.section.prototype);\n// Auto extend\nbizagi.rendering.smartphone.section.extend(\n\"bizagi.rendering.smartphone.section\",\n{},\n{\n  /*\r\n   *   Render the container layout\r\n   */\n  renderContainer: function renderContainer() {\n    var self = this;\n    var properties = this.properties;\n    var template = self.renderFactory.getTemplate(\"section\");\n\n    // Render the panel\n    var html = $.fasttmpl(template, {\n      expandedClassIcon: self.expandedIcon,\n      displayName: properties.displayName,\n      editable: properties.editable,\n      orientation: properties.orientation,\n      uniqueId: properties.uniqueId,\n      isDesign: self.getMode() !== \"execution\",\n      messageValidation: properties.messageValidation,\n      guid: properties.guid,\n      displayAs: properties.displayAs });\n\n\n    // Render children\n    html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\n    return html;\n  },\n\n  /**\r\n      * Method to customize the container's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    //Fix para establecer la orientacin correcta en el modal\n    var dir = self.getSectionOrientationRTL(self) ? \"rtl\" : \"ltr\";\n    $(self.container).attr(\"dir\", dir);\n\n    self.bind(\"reopenSection\", function () {\n      self.expand();\n    });\n\n    $(\">div.bz-section__content\", self.container).mobileModal({\n      displayName: self.properties.displayName,\n      anchor: $(\">div.bz-section__header\", self.container),\n      appendTo: self.container,\n      dir: dir,\n      onBeforeShow: function onBeforeShow(m) {\n        self.addToHistoryNavigation();\n        setTimeout(function () {\n          var p = self.getSectionParent(self.parent);\n          var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n          if (isIphoneNative) {\n            bizagiapp.sectionDidAppear();\n          } else {\n            $(\"header[data-role=header]\").css({ display: \"none\" });\n            $(\"div[data-role=footer] .bz-form-buttons\").css({ \"display\": \"none\" });\n          }\n\n          if (!self.isFirstLevel(true)) {\n            $($(\"div[data-role=header]\", p.container)[0]).css({ display: \"none\" });\n          }\n        }, 250);\n      },\n\n      onClose: function onClose(m) {\n        if (m) m.close();\n        self.removeFromHistoryNavigation();\n        var p = self.getSectionParent(self.parent);\n        if (self.isFirstLevel()) {\n          var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n\n          if (isIphoneNative) {\n            bizagiapp.sectionDidDisappear();\n          } else {\n            $('header[data-role=header]').css({ \"display\": \"block\" });\n            $(\"div[data-role=footer] .bz-form-buttons\").css({ \"display\": \"flex\" });\n          }\n        } else {\n          $($(\"div[data-role=header]\", p.container)[0]).css({ display: \"flex\" });\n        }\n      } });\n\n  },\n\n  /**\r\n      * Return true if the section is on the main form, or false if it is nested.\r\n      */\n  isFirstLevel: function isFirstLevel(isOpen) {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    var selected = params.selectedSection;\n    if (typeof selected === \"undefined\") return true;\n    return isOpen ? selected.length <= 1 : selected.length === 0;\n  },\n\n  /**\r\n      * Set the selected section opened\r\n      */\n  addToHistoryNavigation: function addToHistoryNavigation() {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    if (typeof params.selectedSection === \"undefined\") {\n      form.setParam(\"selectedSection\", []);\n      params = form.getParams();\n    }\n    params.selectedSection.push(this.properties.id);\n  },\n\n  /**\r\n      * Unset the actual section as a opened section\r\n      */\n  removeFromHistoryNavigation: function removeFromHistoryNavigation() {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    if (typeof params.selectedSection !== \"undefined\") {\n      params.selectedSection.pop();\n    }\n  },\n\n  /**\r\n      * Check if section its open\r\n      *\r\n      * @return boolean\r\n      */\n  isOpen: function isOpen() {\n    return this.container.hasClass(\"bz-section--collapsed\") ? false : true;\n  },\n\n  /**\r\n      * Focus on container\r\n      */\n  focus: function focus() {\n    // Expand container\n    this.expand();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Shows slide section container\r\n      * @returns {}\r\n      */\n  expand: function expand() {\n    $(\">div.bz-section__header\", this.container).trigger(\"click\");\n  },\n\n  /**\r\n      * Closes slide section container\r\n      * @returns {}\r\n      */\n  collapse: function collapse() {\n    if (this.isOpen()) {\n      $(\">div.bz-section__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Shows or closes the slide section container from actions\r\n      * @param {} argument\r\n      */\n  toogleContainer: function toogleContainer(argument) {\n    if (argument) {\n      this.expand();\n    } else {\n      this.collapse();\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Search Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.searchForm\", bizagi.rendering.searchForm.prototype);\n// Extends itself\nbizagi.rendering.smartphone.searchForm.extend(\"bizagi.rendering.smartphone.searchForm\", {}, {\n\n  /*\r\n                                                                                              *   Render the results of the query\r\n                                                                                              *   Resolved in each device\r\n                                                                                              */\n  renderResult: function renderResult() {\n    var self = this;\n    var properties = self.properties;\n\n    // Creates grid definition\n    var data = {};\n    data.properties = {\n      displayName: self.getResource(\"render-search-advanced-results-label\"),\n      type: \"grid\",\n      xpath: \"searchForm\" + properties.id,\n      id: properties.id,\n      skipInitialLoad: true,\n      rowsPerPage: 10,\n      sortBy: properties.sortBy,\n      sortOrder: properties.sortOrder,\n      overrideGetRemoteData: function overrideGetRemoteData(params) {\n        return self.getRemoteData(params);\n      } };\n\n    data.elements = [];\n\n    // Creates columns\n    var columns = properties.columns;\n    $.each(columns, function (i) {\n      var column = {\n        render: {} };\n\n      column.render.properties = {\n        displayName: columns[i].caption,\n        xpath: columns[i].xpath,\n        editable: false };\n\n\n      $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\n\n      // Next conditional added to print only columns and not labels\n      // if type = label then column is not rendered on the results table\n      if (columns[i].dataType == 0)\n      column.render.properties.columnVisible = false;\n\n      // if column is number or monetary push allowDecimals property\n      if (columns[i].dataType == 7 || columns[i].dataType == 8)\n      column.render.properties.allowDecimals = columns[i].allowDecimals;\n\n      // if column is real or float set allowDecimals property to true\n      if (columns[i].dataType == 10 || columns[i].dataType == 11)\n      column.render.properties.allowDecimals = true;\n\n      // if column is date push showtime property\n      if (columns[i].dataType == 12)\n      column.render.properties.showTime = columns[i].showTime;\n\n      data.elements.push(column);\n    });\n\n    var grid = self.renderFactory.getRender({\n      type: \"grid\",\n      data: data,\n      parent: self,\n      mode: self.getMode() });\n\n\n    grid.properties.allowAdd = false;\n    grid.properties.allowEdit = false;\n    grid.properties.allowDelete = false;\n\n    // Saves reference\n    self.resultsGrid = grid;\n\n    return grid.render();\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each container after processed\r\n     */\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n    self._super(container);\n\n    var results = container.find(\".bz-container__search-results\");\n    var mode = self.getMode();\n\n    // Process children elements\n    self.container = container;\n\n    // Process result\n    var grid = $(results.children()[0]);\n    self.resultsGrid.postRenderElement(grid);\n\n    // Apply handlers\n    if (mode == \"execution\") {\n      self.configureHandlers();\n    }\n\n    // Configure view\n    if (mode == \"design\") {\n      self.configureDesignView();\n    }\n\n    // Configure view\n    if (mode == \"layout\") {\n      self.configureDesignView();\n      self.configureLayoutView();\n    }\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Saves reference\n    self.criteriaContainer = $(\".bz-container__search-criteria\", self.container);\n    self.resultsContainer = $(\".bz-container__search-results\", self.container);\n\n    // Bind to grid row select event\n    self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\n      if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\n        self.trigger(\"multiSelect\", ui);\n      } else {\n        // Trigger event to bubble up to main container\n        self.trigger(\"instanceSelected\", ui);\n      }\n    });\n  },\n\n  /*\r\n     *   Refresh the result panel, making it to query data with current criteria\r\n     */\n  refreshResults: function refreshResults() {\n    var self = this;\n    self.trigger(\"instancerefresh\");\n\n    $.when(self.resultsGrid.refresh()).done(function () {\n      self.trigger(\"instancerefreshdone\");\n\n      if (self.resultsGrid.properties.data && self.resultsGrid.properties.data.records == 0 && self.resultsGrid.properties.data.rows.length == 0) {\n        var message = bizagi.localization.getResource(\"workportal-general-no-records-found\");\n        var title = bizagi.localization.getResource(\"render-dialog-sendemail-message\");\n\n        bizagi.showMessageBox(message, title);\n      }\n    });\n  },\n  /*\r\n      *   Publish a global event that the facade will replicate, also will be triggered by the principal form\r\n      */\n  triggerGlobalHandler: function triggerGlobalHandler(eventType, data) {\n    var self = this;\n    self._super(eventType, data);\n    if (!self.parent) {\n      if (self.observableElement) {\n        return self.observableElement.trigger(eventType, data);\n      } else {\n        return null;\n      }\n    } else {\n      return self.parent.triggerGlobalHandler(eventType, data);\n    }\n  } });","/**\r\n *   Name: BizAgi Smartphone slide StartForm implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\n\n// Extends itself\n$.Class.extend(\"bizagi.rendering.smartphone.startForm\", {}, {\n\n  /* CONSTRUCTOR\r\n                                                               =====================================================*/\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n    self.slideFormParams = slideFormParams || {};\n\n    // Create container    \t\n    self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n    self.configureViewHandlers();\n  },\n\n  /**\r\n      * Handlers de la vista de kendo\r\n      */\n  configureViewHandlers: function configureViewHandlers() {\n  },\n\n  /**\r\n      * go back and destroy\r\n      */\n  goBack: function goBack() {\n    var self = this;\n    self.slideContainer.destroy();\n  },\n\n  /*\r\n      *   Render the form\r\n      *   The params are the same that will be send to the ajax service\r\n      *   Returns a deferred\r\n      */\n  render: function render(params) {\n    var self = this;\n    // Fill content\n    self.renderSlideForm(params);\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Load template and data\n    $.when(self.dataService.getStartForm(params)).then(function (data) {\n      /*** SUCCESS FILTER **/\n      // Apply editable param\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Render dialog template\n      var formClass = bizagi.rendering.smartphone.form.extend({\n        submitForm: function submitForm() {\n          if (self.form) {\n            this.endLoading();\n            // Perform validations\n            if (self.form.validateForm()) {\n              // Collect data\n              var data = {};\n              self.form.collectRenderValues(data);\n              // Add page cache for this form\n              data.idPageCache = self.form.getPageCache();\n              // Call user callback\n              if (self.slideFormParams.onSave) {\n                $.when(self.slideFormParams.onSave(data)).\n                done(function (result) {\n                  if (result === null || result === true || result.type === \"success\") {\n                    defer.resolve();\n                    self.goBack();\n                  } else if (result.type === \"validationMessages\") {\n                    // Add validation messages\n                    self.form.addValidationMessage(result.messages);\n                    // Update original value to use as reference to other futures changes in the dialogBox\n                    $.each(data, function (key) {\n                      var renders = self.form.getRenders(key);\n                      $.each(renders, function (i, render) {\n                        render.updateOriginalValue();\n                      });\n                    });\n                  } else if (result.type === \"error\") {\n                    // Add error messages\n                    self.form.addErrorMessage(result.message);\n                  }\n                });\n\n              } else {\n                defer.resolve();\n                self.goBack();\n              }\n            }\n          }\n        } });\n\n\n      var containerParams = $.extend({\n        type: \"form\",\n        data: data.form,\n        navigation: self.slideFormParams.navigation,\n        view_container: self.slideContainer },\n\n      {\n        renderFactory: self.renderFactory,\n        dataService: self.renderFactory.dataService });\n\n      self.form = new formClass(containerParams);\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function (_, refreshParams) {\n        refreshParams = $.extend({\n          selectedTabs: self.form.getSelectedTabs(),\n          isRefresh: true },\n        params, refreshParams, { idStartScope: self.form.properties.idStartScope });\n\n        self.renderSlideForm(refreshParams);\n      });\n      // Return rendering promise\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": self.slideFormParams.saveButtonLabel,\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          self.form.submitForm();\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          if (self.slideFormParams.onCancel) {\n            self.slideFormParams.onCancel();\n          }\n          self.goBack();\n        } })];\n\n\n\n      return self.form.render();\n    }).done(function (element) {\n      var saveButtonLabel = self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\n      var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\n      // Append form  in the view\n      self.slideContainer.element.html(element);\n\n      if (!params.isRefresh) {\n        self.slideFormParams.navigation.navigate(self.slideContainer.id);\n      }\n\n      $(\".ui-bizagi-button-container div\", self.form.container).remove();\n\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal='0' id='formButton0' class='action-button ui-bizagi-form-button'>\" +\n      saveButtonLabel + \"</div>\").delegate(\"div[ordinal='0']\", \"click\", function () {\n        self.form.submitForm();\n      });\n\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal='1' id='formButton1' class='action-button ui-bizagi-form-button'>\" +\n      cancelButtonLabel + \"</div>\").delegate(\"div[ordinal='1']\", \"click\", function () {\n        self.slideFormParams.onCancel && self.slideFormParams.onCancel();\n        self.goBack();\n      });\n\n      //self.view.scroller.reset();\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n    }).fail(function (xhr, errorType, message) {\n      /*** FAIL FILTER **/\n      var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n      var error_message = message.message || \"Error\";\n\n      $.tmpl(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n    });\n\n    return defer.promise();\n  } });","/**\r\n *   Name: Bizagi Smartphone slide Grid AdHoc implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide view that will show hidden columns for a grid\r\n */\n\n// Extends itself\n$.Class.extend('bizagi.rendering.smartphone.slide.adhocForm', {}, {\n\n  /* CONSTRUCTOR\r\n                                                                      =====================================================*/\n  init: function init(renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    this.renderFactory = renderFactory;\n    this.slideFormDeferred = new $.Deferred();\n    this.slideFormParams = slideFormParams || {};\n\n    // Create container\n    self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n  },\n\n  /**\r\n      * Render the grid view form\r\n      * The params are the same that will be send to the ajax service\r\n      * @param params\r\n      * @returns Returns a deferred\r\n      */\n  render: function render(params) {\n    var self = this;\n\n    // Fill content\n    self.renderSlideForm(params);\n    // Return promise\n    return self.slideFormDeferred.promise();\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n\n    var self = this;\n    var data = self.transformData(params);\n\n    // Load template and data\n    self.form = self.renderFactory.getContainer({\n      type: \"form\",\n      data: data.form,\n      navigation: this.slideFormParams.navigation,\n      view_container: self.container });\n\n\n    self.form.buttons = [$.extend(self.form.buttons[0] || {},\n    {\n      \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      \"actions\": [\"submitData\", \"refresh\"],\n      \"submitData\": true,\n      \"refresh\": true,\n      \"ordinal\": 0,\n      \"action\": \"save\",\n      \"save\": true,\n      \"style\": \"\",\n      // This callback avoid to call the default processButton in the form\n      callback: function callback() {\n        if (self.form.validateForm()) {\n          self.goBack();\n          // Resolve deferred with form data\n          var data = {};\n          self.form.collectRenderValues(data);\n          self.slideFormDeferred.resolve(data);\n        }\n      } }),\n\n    $.extend(self.form.buttons[1] || {}, {\n      \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      \"actions\": [\"submitData\", \"refresh\"],\n      \"submitData\": true,\n      \"refresh\": true,\n      \"ordinal\": 1,\n      \"action\": \"back\",\n      \"save\": true,\n      \"style\": \"\",\n      //This callback avoid to call the default processButton in the form\n      callback: function callback() {\n        // Close slide\n        self.goBack();\n        self.slideFormDeferred.reject();\n      } })];\n\n\n\n    // Add save button if the form is editable\n    if (!self.slideFormParams.allowEdition) {\n      self.form.buttons.shift();\n    }\n\n    $.when(self.form.render()).\n    done(function (element) {\n\n      if (params.row[0] == \"mock_id\") {// If it is an add form\n        $.each(data.elementsWithDefaultValue, function (i, item) {\n          var render = self.form.getRender(item.xpath + \".\" + item.id);\n          if (!render) {\n            render = self.form.getRender(item.xpath);\n          }\n          var defaultValue = bizagi.util.isArray(item.defaultValue) ? item.defaultValue[0] : item.defaultValue;\n          render.setDisplayValue(defaultValue);\n        });\n      }\n\n      // Append form in the slide view\n      self.container.element.html(element);\n\n      self.slideFormParams.navigation.navigate(self.container.id);\n\n      //self.container.setNavigationButtons(self.form);\n\n      // Remove default form buttons\n      $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\n\n      // Add Button\n      $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n    });\n  },\n\n  /**\r\n      * Transform data into a JSON standard rendering format\r\n      * @param params\r\n      * @returns {[]}\r\n      */\n  transformData: function transformData(params) {\n    var self = this;\n    var row = params.row;\n    var columns = params.columns;\n    var isAddForm = false;\n\n    // Set xpath context\n    var xpathContext = params.xpathContext.length > 0 ?\n    params.xpathContext + \".\" + params.xpath + \"[\" + params.row[0] + \"]\" :\n    params.xpath + \"[id=\" + params.row[0] + \"]\";\n\n    var data = {\n      type: \"form\",\n      form: {\n        elements: [],\n        pageCacheId: params.pageCacheId,\n        sessionId: params.sessionId,\n        properties: {\n          xpathContext: xpathContext },\n\n        actions: self.transformActions(params.xpath, params.actions),\n        validations: self.transformValidations(params.xpath, params.validations) },\n\n      elementsWithDefaultValue: [] };\n\n\n    if (row[0] === \"mock_id\") {\n      isAddForm = true;\n    }\n\n    $.each(row, function (i, item) {\n\n      // Skip first data (key not need to be rendered)\n      if (i > 0) {\n        var columnProperties = columns[i - 1].properties;\n        var element = { render: { properties: $.extend({}, columnProperties) } };\n\n        // Hack properties\n        element.render.properties.type = self.mapRenderType(element.render.properties.type);\n        element.render.properties.defaultvalue = typeof element.render.properties.defaultvalue !== \"undefined\" ? element.render.properties.defaultvalue : element.render.properties.defaultValue;\n        element.render.properties.displayType = 'both';\n        if (self.slideFormParams.allowEdition == false) element.render.properties.editable = false;\n        element.render.properties.value = self.mapValue(element.render.properties.type, item);\n        if (element.render.properties.recalculate) element.render.properties.data = null;\n\n        // Check defaultValue property\n        if (typeof element.render.properties.defaultvalue !== \"undefined\") {\n          if (typeof element.render.properties.value === \"undefined\" || element.render.properties.value == null) {\n            //element.render.properties.value = element.render.properties.defaultvalue;\n            data.elementsWithDefaultValue.push({\n              id: element.render.properties.id,\n              xpath: element.render.properties.xpath,\n              defaultValue: element.render.properties.defaultvalue });\n\n\n\n          }\n        }\n\n        // Check columnVisible property\n        if (typeof element.render.properties.columnVisible !== \"undefined\") {\n          element.render.properties.visible = element.render.properties.columnVisible;\n        }\n\n        // Fix readonly columns\n        if (element.render.properties.type === \"readonly\") {\n          element.render.properties.type = \"text\";\n          element.render.properties.editable = false;\n        }\n\n        // Fix upload columns\n        if (element.render.properties.type === \"upload\") {\n          element.render.properties.isColumn = true;\n        }\n\n        // Fix search columns\n        if (element.render.properties.type === \"search\") {\n          var value = element.render.properties.value;\n\n          if (value == null) {\n            element.render.properties.value = {};\n          } else if (value.length > 0) {\n            value = [].concat(value[0]);\n            element.render.properties.value = {\n              id: value[0],\n              label: value[1],\n              additionallabel: value[2] || undefined };\n\n          }\n        }\n        var isDisabledControl = [\"document\", \"formLink\", \"upload\", \"uploadecm\", \"image\", \"search\"].includes(element.render.properties.type);\n        var isExclusiveCheck = (element.render.properties.isExclusive || false) && \"boolean\" === element.render.properties.type;\n\n        if (isExclusiveCheck || isAddForm && isDisabledControl) {\n          element.render.properties.editable = false;\n        } else if (isExclusiveCheck) {\n          element.render.properties.value = value;\n          element.render.properties.editable = false;\n        }\n\n        // Add element\n        data.form.elements.push(element);\n      }\n\n    });\n\n    return data;\n  },\n\n  /**\r\n      * Map column renderType into normal render\r\n      * @param type\r\n      * @returns {string}\r\n      */\n  mapRenderType: function mapRenderType(type) {\n    type = type.replaceAll(\"smartphone\", \"\").replaceAll(\"column\", \"\");\n\n    //some exceptions\n    if (type === \"FormLink\") return \"formLink\";\n\n    type = type.toLowerCase();\n    return type;\n  },\n\n  /**\r\n      * Method to translate grid values into render values\r\n      * @param type\r\n      * @param value\r\n      * @returns {[]}\r\n      */\n  mapValue: function mapValue(type, value) {\n    if ([\"combo\", \"radio\", \"list\"].includes(type)) {\n      if (value && value.length > 0) {\n\n        // Transform the value property\n        return [{\n          id: value[0][0],\n          value: value[0].length > 2 ? $.grep(value[0], function (item, i) {\n            return i !== 0;\n          }) : value[0][1] }];\n\n\n      } else {\n        return null;\n      }\n    }\n\n    // Else: Don't do anything\n    return value;\n  },\n\n  /**\r\n      * Parse form actions into just grid form actions\r\n      * @param xpath\r\n      * @param actions\r\n      * @returns {[]}\r\n      */\n  transformActions: function transformActions(xpath, actions) {\n    var self = this;\n    var gridActions = [];\n\n    if (bizagi.util.isEmpty(actions)) return gridActions;\n\n    $.each(actions, function (index, action) {\n      var bDependencyFound = false;\n      for (var i = 0; i < action.dependencies.length; i++) {\n        if (action.dependencies[i].indexOf(xpath) != -1) {\n          bDependencyFound = true;\n        }\n      }\n\n      if (bDependencyFound) {\n        var newAction = JSON.parse(JSON.encode(action));\n\n        // Replace dependencies\n        for (var j = 0; j < newAction.dependencies.length; j++) {\n          newAction.dependencies[j] = newAction.dependencies[j].replaceAll(xpath + \"[].\", \"\");\n        }\n\n        // Replace conditions\n        self.transformConditions(xpath, newAction.conditions);\n\n        // Replace commands\n        newAction.commands = self.transformCommands(xpath, newAction.commands);\n        newAction.elseCommands = self.transformCommands(xpath, newAction.elseCommands);\n\n        // Add to grid actions\n        gridActions.push(newAction);\n      }\n    });\n\n    return gridActions;\n  },\n\n  /**\r\n      * Parse form validations into just grid form validations\r\n      * @param xpath\r\n      * @param validations\r\n      * @returns {[]}\r\n      */\n  transformValidations: function transformValidations(xpath, validations) {\n    var self = this;\n    var gridValidations = [];\n\n    if (bizagi.util.isEmpty(validations)) return gridValidations;\n\n    $.each(validations, function (index, validation) {\n      var newValidation = JSON.parse(JSON.encode(validation));\n\n      // Replace conditions\n      self.transformConditions(xpath, newValidation.conditions);\n\n      // Add to grid actions\n      gridValidations.push(newValidation);\n\n    });\n\n    return gridValidations;\n  },\n\n  /**\r\n      * Parse a single condition or a complex condition in order to prepare a grid action/validation\r\n      * @param xpath\r\n      * @param condition\r\n      */\n  transformConditions: function transformConditions(xpath, condition) {\n    var self = this;\n\n    if (condition.expressions) {\n      for (var index in condition.expressions) {\n        self.transformConditions(xpath, condition.expressions[index]);\n      }\n    } else if (condition.simple) {\n      self.transformConditions(xpath, condition.simple);\n    } else if (condition.complex) {\n      self.transformConditions(xpath, condition.complex);\n    } else {\n      if (condition.xpath) {\n        condition.xpath = condition.xpath.replaceAll(xpath + \"[].\", \"\");\n        if (condition.argumentType === 'xpath') {\n          condition.argument = condition.argument.replaceAll(xpath + \"[].\", \"\");\n        }\n      } else {\n        // Apply to button and label controls\n        if (condition && condition.renderId) {\n          condition.renderId = condition.renderId.replaceAll(xpath + \"[].\", \"\");\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Parse a command action to prepare a grid action\r\n      * @param xpath\r\n      * @param commands\r\n      */\n  transformCommands: function transformCommands(xpath, commands) {\n    if (commands == null || commands === undefined) return;\n    return commands.reduce(function (previousValue, currentValue) {\n      if (![\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\", \"execute-pipeline\"].includes(currentValue.command)) {\n        if (currentValue.xpath) {\n          currentValue.xpath = currentValue.xpath.replaceAll(xpath + \"[].\", \"\");\n        }\n        if (currentValue.argumentType === 'xpath') {\n          currentValue.argument = currentValue.argument.replaceAll(xpath + \"[].\", \"\");\n        }\n\n        if (!currentValue.xpath && currentValue.renderId) {\n          currentValue.renderId = currentValue.renderId.replaceAll(xpath + \"[].\", \"\");\n        }\n        previousValue.push(currentValue);\n      }\n      return previousValue;\n    }, []);\n  },\n\n  /**\r\n      * Go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.container.destroy();\n  } });","/**\r\n *   Name: Bizagi Smartphone slide form implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\n$.Class.extend(\"bizagi.rendering.smartphone.slide.form\", {}, {\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n    self.slideFormParams = slideFormParams || {};\n\n    // Create container\n    self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n    self.configureViewHandlers();\n  },\n\n  /**\r\n      * go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.slideContainer.destroy();\n  },\n\n  /**\r\n      * Handlers de la vista de kendo\r\n      */\n  configureViewHandlers: function configureViewHandlers() {\n  },\n\n  /*\r\n      *   Render the form\r\n      *   The params are the same that will be send to the ajax service\r\n      *   Returns a deferred\r\n      */\n  render: function render(params) {\n    this.renderSlideForm(params);\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Load template and data\n    $.when(self.dataService.getFormData(params)).\n    pipe(function (data) {\n      /*** SUCCESS FILTER **/\n      // Apply editable param\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Render dialog template\n      var formClass = bizagi.rendering.smartphone.form.extend({\n        submitForm: function submitForm(parameters) {\n          if (self.form) {\n            this.endLoading();\n            // Perform validations\n            if (self.form.validateForm()) {\n              // Collect data\n              var data = {};\n              self.form.collectRenderValues(data);\n              // Add page cache for this form\n              data.idPageCache = self.form.getPageCache();\n              // Call user callback\n              if (self.slideFormParams.onSave) {\n                $.when(self.slideFormParams.onSave(data)).\n                done(function (result) {\n                  if (result === null || result === true || result.type === \"success\") {\n                    defer.resolve();\n                    self.goBack();\n                  } else if (result.type === \"validationMessages\") {\n                    // Add validation messages\n                    self.form.addValidationMessage(result.messages);\n                    // Update original value to use as reference to other futures changes in the dialogBox\n                    $.each(data, function (key, value) {\n                      var renders = self.form.getRenders(key);\n                      $.each(renders, function (i, render) {\n                        render.updateOriginalValue();\n                      });\n                    });\n                  } else if (result.type === \"error\") {\n                    // Add error messages\n                    self.form.addErrorMessage(result.message);\n                  }\n                });\n\n              } else {\n                defer.resolve();\n                self.goBack();\n              }\n            }\n          }\n        } });\n\n      var containerParams = $.extend({\n        type: \"form\",\n        data: data.form,\n        navigation: self.slideFormParams.navigation,\n        view_container: self.slideContainer },\n      {\n        renderFactory: self.renderFactory,\n        dataService: self.renderFactory.dataService });\n\n      self.form = new formClass(containerParams);\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          self.form.submitForm();\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          if (self.slideFormParams.onCancel) {\n            self.slideFormParams.onCancel();\n          }\n          self.goBack();\n        } })];\n\n\n\n      // Return rendering promise\n      return self.form.render();\n    }).done(function (element) {\n      var saveButtonLabel = self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel :\n      bizagi.localization.getResource(\"render-form-dialog-box-save\");\n      var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\n\n      // Append form  in the view\n      self.slideContainer.element.html(element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n\n      $(\".ui-bizagi-button-container div\", self.form.container).remove();\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal=\\\"0\\\" id=\\\"formButton0\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\n      saveButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"0\\\"]\", \"click\", function () {\n        self.form.submitForm();\n      });\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal=\\\"1\\\" id=\\\"formButton1\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\n      cancelButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"1\\\"]\", \"click\", function () {\n        self.slideFormParams.onCancel && self.slideFormParams.onCancel();\n        self.goBack();\n      });\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function () {\n        self.renderSlideForm(params);\n      });\n    }).fail(function (message) {\n      /*** FAIL FILTER **/\n      var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n      var error_message = message.message || \"Error\";\n\n      $.tmpl(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n    });\n\n    return defer.promise();\n  } });","/**\r\n *   Name: Bizagi Smartphone ECM Slide Implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will shows a ECM form\r\n */\n$.Class.extend(\"bizagi.rendering.smartphone.slide.ecm\", {}, {\n\n  /**\r\n                                                               * Constructor\r\n                                                               * @param dataService\r\n                                                               * @param renderFactory\r\n                                                               * @param slideFormParams\r\n                                                               */\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n\n    self.slideFormParams = slideFormParams || {};\n    self.slideFormDeferred = new $.Deferred();\n\n    // Create container\n    self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n  },\n\n  /**\r\n      * Render the form\r\n      * @param params\r\n      */\n  render: function render(params) {\n\n    // Fill content\n    this.renderSlideForm(params);\n\n    // Return promise\n    return this.slideFormDeferred.promise();\n  },\n\n  renderSlideForm: function renderSlideForm(params) {\n    var self = this;\n    var data = self.getMetadataForm(params);\n\n    // Load template and data\n    self.form = self.renderFactory.getContainer({\n      type: \"form\",\n      data: data.form,\n      navigation: self.slideFormParams.navigation,\n      view_container: self.container });\n\n\n    // Binds the view close event\n    /*self.container.element.bind(\"close\", function () {\r\n        // delete self.container;\r\n        console.log(\"closed!\");\r\n    });*/\n\n    $.when(self.form.render()).\n    done(function ($renderEdition) {\n\n      // Append form in the slide view\n      self.container.element.html($renderEdition);\n\n      self.slideFormParams.navigation.navigate(self.container.id);\n\n      self.processButtons(self.form, params);\n      self.container.setNavigationButtons(self.form);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n\n      // Attach a refresh handler to recreate all the form\n      /*self.form.bind(\"refresh\", function () {\r\n          // self.renderSlideForm(params);\r\n      });*/\n\n    }).always(function () {\n      self.slideFormDeferred.resolve();\n    });\n\n  },\n\n  /**\r\n      * Shows the slideForm form container in the browser\r\n      * @returns {} Returns a promise that the dialog will be closed\r\n      */\n  processButtons: function processButtons(form, params) {\n    var self = this;\n\n    form.buttons = [\n    {\n      ordinal: 0,\n      action: \"save\",\n      caption: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      callback: self.onSaveDataMetadataForm.bind(self, params.fileData) },\n\n    {\n      ordinal: 1,\n      action: \"back\",\n      caption: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      callback: function callback() {\n        self.slideFormParams.onCancel({});\n\n        self.goBack();\n      } }];\n\n\n\n    // Add save button if the form is editable\n    if (!self.slideFormParams.editable) {\n      form.buttons.shift();\n    }\n  },\n\n  /**\r\n      * Process render data\r\n      * @param params\r\n      * @returns {{form: *, type: string}}\r\n      */\n  getMetadataForm: function getMetadataForm(params) {\n    var self = this;\n    var data = {\n      type: \"form\",\n      form: {\n        elements: [],\n        pageCacheId: params.pageCacheId,\n        sessionId: params.sessionId,\n        properties: {\n          id: 101,\n          xpathContext: params.xpathContext,\n          editable: self.slideFormParams.editable,\n          orientation: self.slideFormParams.orientation || \"ltr\" } } };\n\n\n\n\n    // Mapping metadata to render\n    $.each(params.metadata, function (index, item) {\n      var renderType = self.getRenderType(item.metadataType);\n\n      var newRender = Object.assign({\n        \"id\": index + 1,\n        \"xpath\": item.metadataId,\n        \"displayName\": item.description,\n        \"required\": bizagi.util.parseBoolean(item.required) === true,\n        \"editable\": bizagi.util.parseBoolean(item.readOnly) === false,\n        \"value\": item.value },\n      renderType);\n\n      data.form.elements.push({ \"render\": { \"properties\": newRender } });\n    });\n\n    return data;\n  },\n\n  /**\r\n      * Get type of render\r\n      * @param type\r\n      * @returns {*}\r\n      */\n  getRenderType: function getRenderType(type) {\n    switch (type.toUpperCase()) {\n      case \"INTEGER\":\n        return {\n          type: \"number\",\n          dataType: 2,\n          allowDecimals: false,\n          thousands: false };\n\n      case \"DECIMAL\":\n        return {\n          type: \"number\",\n          dataType: 10,\n          allowDecimals: true,\n          thousands: true };\n\n      case \"DATETIME\":\n        return { type: \"date\", dataType: 12 };\n      case \"BOOL\":\n        return { type: \"boolean\", dataType: 5 };\n      case \"STRING\":\n      default:\n        return {\n          type: \"text\",\n          dataType: 15,\n          maxLength: 50,\n          autoExtend: false };}\n\n\n\n  },\n\n  /**\r\n      * Save data to ECM form\r\n      * @returns {jQuery}\r\n      * @param fileData\r\n      */\n  onSaveDataMetadataForm: function onSaveDataMetadataForm(fileData) {\n    var self = this;\n    var deferred = $.Deferred();\n\n    if (self.form.validateForm()) {\n      // Check if the add form has data\n      var formData = {};\n      self.form.collectRenderValuesForSubmit(formData);\n\n      // Turn off flag\n      $.forceCollectData = false;\n\n      if (!bizagi.util.isMapEmpty(formData)) {\n\n        var metadataValues = Object.keys(formData).\n        map(function (key, index) {\n          return { \"idMetadata\": key, \"value\": formData[key] };\n        });\n\n        var params = {\n          \"idFileUpload\": fileData.idFileUpload,\n          \"fileName\": fileData.fileName,\n          \"idPageCache\": fileData.idPageCache,\n          \"xpathContext\": fileData.xpathContext,\n          \"xPath\": fileData.xpath,\n          \"idAttrib\": fileData.idAttrib };\n\n\n        params.metaValues = JSON.encode({ metadataValues: metadataValues });\n        bizagi.loading.start();\n\n        $.when(self.dataService.updateECMMetadata(params)).\n        done(function (fileProperties) {\n          if (fileProperties && fileProperties.idFileUpload) {\n\n            self.slideFormParams.onSave({\n              update: true,\n              idFileUpload: fileProperties.idFileUpload,\n              fileName: fileData.fileName });\n\n\n            deferred.resolve({ update: true });\n          }\n\n          self.goBack();\n\n        }).fail(function (message) {\n          self.form.addValidationMessage(message.message);\n          deferred.reject();\n        }).always(function () {\n          bizagi.loading.stop();\n        });\n      } else {\n        self.slideFormParams.onSave({ update: false });\n        deferred.resolve({ update: false });\n        self.goBack();\n      }\n    }\n\n    deferred.promise();\n  },\n\n  /**\r\n      * Go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.container.destroy();\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.text\", bizagi.rendering.text.prototype);\n// Extends itself\nbizagi.rendering.smartphone.text.extend(\"bizagi.rendering.smartphone.text\", {}, {\n\n  //#region Side effects functions\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    // Call base \n    this._super();\n\n    // Define max length of element\n    if (this.properties.maxLength > 0)\n    this.input.attr(\"maxlength\", this.properties.maxLength);\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"text-read-only\");\n    var value = this.getValue();\n\n    if (typeof value !== \"undefined\" && value !== null) {\n      value = bizagi.util.sanitizeHTML(value);\n    }\n\n    var data = {\n      value: value || \"\",\n      editable: this.properties.editable };\n\n\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n\n    value = this.validateValue(value, self.properties.maxLength);\n\n    // Set internal value\n    self.setValue(value, false);\n\n    // Set value in input\n    if (self.properties.editable) {\n      self.input.val(value);\n    } else {\n      $(\".bz-text-readonly\", self.getControl()).html(bizagi.util.sanitizeHTML(value));\n    }\n  },\n\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      self.retypeDouble(control);\n    });\n  },\n\n  /**\r\n      * Retype actions\r\n      * @param {} control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible) {\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.setValidationMessage(self.getResource(\"render-text-retype-error\"));\n          control.val(\"\");\n\n          setTimeout(function () {\n            control.focus();\n          }, 100);\n\n        } else {\n          control.data(\"newValue\", currentValue);\n        }\n        control.data(\"oldValue\", \"\");\n        if (control.data('ui-tooltip')) control.tooltip('destroy');\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".bz-text-readonly\", $context);\n  },\n\n  /**\r\n      * Helptext tooltip\r\n      * @param {} control\r\n      * @param {} currentValue\r\n      * @param {} currentTitle\r\n      */\n  createTooltip: function createTooltip(control, currentValue, currentTitle) {\n    this._super(control, currentValue, currentTitle);\n\n    $('body').bind('touchmove', function (e) {\n      $('body').unbind('touchmove');\n      if (control.data('ui-tooltip')) control.tooltip('destroy');\n    });\n  },\n\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n\n    if (this.cloneRender) {\n      this.cloneRender.setValidationMessage(message);\n    }\n  }\n\n  //#endregion Side effects functions\n});","/**\r\n *   Name: Bizagi Smartphone Render Readonly Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the readonly render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.readonly\", bizagi.rendering.readonly.prototype);\n// Extends itself\nbizagi.rendering.smartphone.readonly.extend(\"bizagi.rendering.smartphone.readonly\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments: Extended text implementation\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.extendedText\", bizagi.rendering.extendedText.prototype);\n// Extends itself\nbizagi.rendering.smartphone.extendedText.extend(\"bizagi.rendering.smartphone.extendedText\", {\n  minLines: 2,\n  maxLines: 8,\n  maxCharactersToShow: 100 },\n{\n\n  //#region Side effects functions\n\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    var self = this;\n    self._super();\n    self.textarea = self.getControl().find(\"textarea\");\n    if (self.textarea) self.textarea.css({ resize: \"vertical\" });\n  },\n\n  /**\r\n      * Update or init the element data\r\n      * @param {} data\r\n      */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n    var maxLines = this.properties.maxLines;\n    this.properties.maxLines = maxLines > this.Class.maxLines ? this.Class.maxLines : maxLines < this.Class.minLines ? this.Class.minLines : maxLines;\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"extendedText-readOnly\");\n    var value = this.getValue();\n    value = typeof value !== \"undefined\" && value !== null ? bizagi.util.sanitizeHTML(value) : \"\";\n    var showChar = this.Class.maxCharactersToShow;\n\n    var startString = value.substr(0, showChar);\n    var endString = value.substr(showChar - 1, value.length - showChar);\n\n    var data = {\n      \"value\": value,\n      \"startString\": startString,\n      \"endString\": endString };\n\n\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Sets the value in the redered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    value = !bizagi.util.isEmpty(value) && typeof value !== \"string\" ? value.toString() : value;\n    value = self.validateValue(typeof value == \"string\" ? value : \"\", self.properties.maxLength);\n\n    // Call base        \n    self.setValue(value, false);\n\n    // Set value in input\n    if (self.properties.editable) {\n      self.textarea.val(value);\n    } else {\n      var encodedText = bizagi.util.encodeHtmlText(self.getDisplayValue());\n      $(\".bz-textarea-readonly\", self.getControl()).html(encodedText);\n    }\n  },\n\n  /**\r\n      * Implement to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Call base\n    self._super();\n\n    // Define max length of element\n\n    // Cuando el tipo de dato es extended manda como maxlength 0 por lo que la validacion no puede ir sobre todo el metodo\n    if (self.properties.maxLength > 0) {\n      self.textarea.attr(\"maxlength\", self.properties.maxLength);\n      self.actualMaxLength = self.properties.maxLength;\n    }\n\n    $(self.textarea).bind(\"focus keyup paste\", function (e) {\n      if (e.which === 8 || e.which === 46) {\n        var currentRow = self.textarea.prop(\"rows\");\n        if (currentRow > self.properties.maxLines) {\n          self.textarea.prop(\"rows\", self.properties.maxLines);\n        }\n      }\n      self.updateTextareaSize(this);\n    });\n\n    $(self.textarea).bind(\"blur\", function (e) {\n      self.textarea.prop(\"rows\", self.properties.maxLines);\n    });\n  },\n\n  /**\r\n      * Sets the functions when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n\n    var $control = this.getControl();\n    $(\".bz-textarea-readonly\", $control).on(\"click\", \".bz-read-more\", function (e) {\n      if ($(e.delegateTarget).hasClass(\"bz-textarea-readonly--active\")) {\n        $(e.delegateTarget).removeClass(\"bz-textarea-readonly--active\");\n        $(this).html(self.getResource(\"workportal-project-discussion-comment-viewmore\"));\n      } else {\n        $(e.delegateTarget).addClass(\"bz-textarea-readonly--active\");\n        $(this).html(self.getResource(\"workportal-project-discussion-comment-viewless\"));\n      }\n      return false;\n    });\n  },\n\n  /**\r\n      * Changes control's height when it's auto extended\r\n      * @param {Object} control HTML Object\r\n      */\n  updateTextareaSize: function updateTextareaSize(textarea) {\n    if (this.properties.autoExtend) {\n      var currentRows = $(textarea).prop(\"rows\");\n      if (textarea.scrollHeight > textarea.offsetHeight && currentRows >= this.Class.minLines && currentRows < this.Class.maxLines) {\n        //Extend the rows\n        $(textarea).prop(\"rows\", currentRows + 1);\n        this.updateTextareaSize(textarea);\n      }\n    }\n  },\n\n  /**\r\n      * Handler of retype double actions\r\n      */\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input, textarea\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      var previousValue = self.previousValue;\n      var value = self.value;\n\n      if (previousValue != null && value != previousValue) {\n        if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\n          $(this).data().newValue = undefined;\n        }\n      }\n\n      self.retypeDouble(control);\n    });\n  },\n\n  /**\r\n      * Retype actions\r\n      * @param {} control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible) {\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.setValidationMessage(self.getResource(\"render-text-retype-error\"));\n          control.val(\"\");\n\n          setTimeout(function () {\n            control.focus();\n          }, 100);\n\n        } else {\n          control.data(\"newValue\", currentValue);\n        }\n        control.data(\"oldValue\", \"\");\n        if (control.data('ui-tooltip')) control.tooltip('destroy');\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"textarea\", $context) : $(\".bz-textarea-readonly\", $context);\n  },\n\n  /**\r\n      * Helptext tooltip\r\n      * @param {} control\r\n      * @param {} currentValue\r\n      * @param {} currentTitle\r\n      */\n  createTooltip: function createTooltip(control, currentValue, currentTitle) {\n    this._super(control, currentValue, currentTitle);\n\n    $('body').bind('touchmove', function (e) {\n      $('body').unbind('touchmove');\n      if (control.data('ui-tooltip')) control.tooltip('destroy');\n    });\n  },\n\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n\n    if (this.cloneRender) {\n      this.cloneRender.setValidationMessage(message);\n    }\n  }\n\n  //#endregion Side effects functions\n});","/**\r\n *   Name: Bizagi Smartphone Render Label Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the label render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.label\", bizagi.rendering.label.prototype);\n// Extends itself\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.label\", {}, {\n  /**\r\n                                                                                    * Method to render non editable values\r\n                                                                                    */\n  renderReadOnly: function renderReadOnly() {\n    this.setValue(this.properties.displayName);\n    return this._super();\n  },\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // DON'T DO ANYTHING\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.number\", bizagi.rendering.number.prototype);\n// Extends itself\nbizagi.rendering.smartphone.number.extend(\"bizagi.rendering.smartphone.number\", {}, {\n\n  /**\r\n                                                                                       * Method to customize each render after processed in read-only mode\r\n                                                                                       * @returns {*|jQuery}\r\n                                                                                       */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"number\");\n\n    return $.fasttmpl(template, {\n      value: self.getDisplayValue(),\n      editable: self.properties.editable,\n      type: \"text\",\n      isDesign: self.getMode() !== \"execution\" });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    // Call base\n    this.setValue(value, false);\n\n    // Set value in input\n    if (value !== null && value !== undefined) {\n      if (self.properties.editable) {\n        self.numericInput.val(bizagi.util.numberToFixedString(value));\n\n        self.value = self.properties.value = value;\n\n        // Formats the input\n        self.executeFormatCurrencyPlugin();\n      } else {\n        $(\".bz-input\", self.getControl()).val(bizagi.util.numberToFixedString(value)).formatCurrency(\n        {\n          symbol: self.properties.symbol,\n          positiveFormat: self.properties.positiveFormat,\n          negativeFormat: self.properties.negativeFormat,\n          decimalSymbol: self.properties.decimalSymbol,\n          digitGroupSymbol: self.properties.digitGroupSymbol,\n          groupDigits: self.properties.groupDigits,\n          roundToDecimalPlace: self.properties.numDecimals,\n          colorize: self.properties.colorize });\n\n\n      }\n    }\n  },\n\n  /**\r\n      * Retype function\r\n      */\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      var previousValue = self.previousValue;\n      var value = self.value;\n      var typeControl = self.parent.properties.type;\n\n      if (typeControl === \"grid\") {\n        if (previousValue != null && value !== previousValue) {\n          if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\"))\n          $(this).data().newValue = undefined;\n        }\n\n        self.retypeDouble(control);\n      } else {\n        self.retypeDouble(control);\n      }\n    });\n  },\n\n  /**\r\n      * Retype function\r\n      * @param control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible && $(this).data(\"newValue\") === undefined) {\n\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"));\n        } else {\n          control.data(\"newValue\", currentValue);\n          control.data(\"oldValue\", \"\");\n          try {\n            // Destroy tooltips\n            control.tooltip(\"destroy\");\n          } catch (e) {\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input\", $context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the money render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.number.prototype);\n// Extends itself\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.money.prototype);\n// Extends itself\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", {}, {\n\n  /**\r\n                                                                                     * Method to customize each render after processed in read-only mode\r\n                                                                                     * @returns {*|jQuery}\r\n                                                                                     */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"number\");\n\n    return $.fasttmpl(template, {\n      value: self.getDisplayValue(),\n      editable: self.properties.editable,\n      type: \"text\",\n      isDesign: self.getMode() !== \"execution\" });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    // Call base\n    this.setValue(value, false);\n\n    // Set value in input\n    if (value !== null && value !== undefined) {\n      if (self.properties.editable) {\n        self.numericInput.val(bizagi.util.numberToFixedString(value));\n\n        self.value = self.properties.value = value;\n\n        // Formats the input\n        self.executeFormatCurrencyPlugin();\n      } else {\n        $(\".bz-input\", self.getControl()).val(bizagi.util.numberToFixedString(value)).formatCurrency(\n        {\n          symbol: self.properties.symbol,\n          positiveFormat: self.properties.positiveFormat,\n          negativeFormat: self.properties.negativeFormat,\n          decimalSymbol: self.properties.decimalSymbol,\n          digitGroupSymbol: self.properties.digitGroupSymbol,\n          groupDigits: self.properties.groupDigits,\n          roundToDecimalPlace: self.properties.numDecimals,\n          colorize: self.properties.colorize });\n\n\n      }\n    }\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  /*getElementsToStylize: function (context) {\r\n             return $(\".bz-input\", context);\r\n         }*/\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input\", $context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the date render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.date\", bizagi.rendering.date.prototype);\n// Extends itself\nbizagi.rendering.smartphone.date.extend(\"bizagi.rendering.smartphone.date\", {\n  MAX_YEARS_DISPLAY: 100 },\n{\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var properties = self.properties;\n    var dateFormat = properties.dateFormat;\n    var ud = bizagi.util.dateFormatter;\n\n    var format = dateFormat.substring(0, dateFormat.search(\"h|H\") != -1 ? dateFormat.search(\"h|H\") - 1 : dateFormat.length);\n    var value = ud.formatDate(ud.getDateFromFormat(self.getValue(), format, self.i18n), properties.fullFormat);\n    var data = {\n      value: self.getMode() !== \"execution\" ? properties.fullFormat : value,\n      editable: properties.editable };\n\n\n    var template = this.renderFactory.getTemplate(\"readonly\");\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.input = $(\"input\", this.getDateControl());\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var dateControl = self.getControl();\n    var inputDate = $(\".bz-input-icon\", dateControl);\n\n    self.configureMobiscollCalendar();\n    self.calendarInstance = inputDate.mobiscroll(\"getInst\");\n\n    // Bind event on input date\n    inputDate.on(\"focus\", function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\n        cordova.plugins.Keyboard.disableScroll(true);\n        cordova.plugins.Keyboard.close();\n      }\n      self.calendarInstance.show();\n    });\n\n    inputDate.attr(\"keyboard\", \"disable\");\n  },\n\n  /**\r\n      * Initializes the Mobiscroll Calendar with the indicated configuration\r\n      */\n  configureMobiscollCalendar: function configureMobiscollCalendar() {\n    var self = this;\n    var properties = self.properties;\n    var controlElements = properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\n    var dateControl = self.getControl();\n    var inputDate = $(\".bz-input-icon\", dateControl);\n    var orientation = self.getOrientation();\n\n    inputDate.mobiscroll().calendar({\n      mode: \"mixed\",\n      touchUi: true,\n      display: \"bottom\",\n      controls: controlElements,\n      min: self.getNormalizeDate(new Date(properties.minValue)),\n      max: self.getNormalizeDate(new Date(properties.maxValue)),\n      defaultValue: self.getDisplayValue(),\n      timeFormat: properties.timePickerFormat ? self.getTimeFormat(properties.timePickerFormat) : \"\",\n      dateFormat: properties.datePickerFormat,\n      dateWheels: 'dd/MM/yyyy',\n      select: \"single\",\n      selectType: \"Day\",\n      rtl: orientation && orientation === \"rtl\",\n      lang: bizagi.util.languages[BIZAGI_LANGUAGE] || bizagi.localization.language || \"en\",\n      buttons: self.properties.showTime ?\n      [\n      {\n        text: self.getResource(\"render-timeentry-now\"),\n        handler: function handler() {\n          self.setValueFromCalendarButtons(new Date(), function (v) {\n            self.getCalendarInstance().setVal(v, false, false, false);\n            self.getCalendarInstance().hide();\n          });\n        } },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-select-link\"),\n        handler: \"set\" },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-clear-button-name\"),\n        handler: function handler(e, inst) {\n          inst.clear();\n        } }] :\n\n\n      [\n      {\n        text: self.getResource(\"render-timeentry-now\"),\n        handler: function handler() {\n          self.setValueFromCalendarButtons(new Date(), function (v) {\n            self.getCalendarInstance().setVal(v, false, false, false);\n            self.getCalendarInstance().hide();\n          });\n        } },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-clear-button-name\"),\n        handler: function handler(e, inst) {\n          inst.clear();\n        } }],\n\n\n      onSet: function onSet() {\n        self.onChangeHandler();\n      },\n      onDayChange: function onDayChange(obj) {\n        self.setValueFromCalendarButtons(obj.date, function (v) {\n          self.getCalendarInstance().setVal(v, false, false, false);\n          if (!self.properties.showTime) self.getCalendarInstance().hide();\n        });\n      },\n      onClear: function onClear() {\n        self.setValueFromCalendarButtons(null, function (v) {\n          self.getCalendarInstance().setVal(v, false, false, false);\n          self.getCalendarInstance().hide();\n        });\n      },\n      onBeforeShow: function onBeforeShow(event, inst) {\n        //self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n\n        inst.option({\n          max: bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime),\n          min: bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) });\n\n\n        //TODO temporal fix in ios smartphone when a notification container is already displayed (QAF-6385 / MOB-171), review mobiscroll.min versions\n        if (bizagi.util.isiOSDevice()) {\n          $(\".ui-bizagi-notifications-container\").css(\"display\", \"none\");\n        }\n      },\n      onClose: function onClose(event, inst) {\n        // Your custom event handler goes here\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\n      },\n      onShow: function onShow(event, inst) {\n        $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\n      } });\n\n  },\n\n  /**\r\n      * Get the DOM Control\r\n      */\n  getDateControl: function getDateControl() {\n    return $(\".bz-input-icon\", this.getControl());\n  },\n\n  /**\r\n      * Set the control value when the control change\r\n      */\n  onChangeHandler: function onChangeHandler(isNow) {\n    var self = this;\n    var properties = self.properties;\n    var currentDate = self.getNormalizeDate(self.getCalendarInstance().getVal());\n    var currentDateString = \"\";\n    var ud = bizagi.util.dateFormatter;\n\n    if (!currentDate || currentDate == 0) {\n      return;\n    }\n    //Attemp set the value of the datepicker control. If not valid go back to the previous.\n    var previousValue = self.value;\n\n    //sets the value with the current format date, changed to use the same displayValue method\n    if (isNow == true) {\n      currentDate = self.getNormalizeDate(new Date());\n      currentDateString = ud.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\n      self.value = currentDateString;\n    } else {\n      self.value = ud.formatInvariant(currentDate, properties.showTime);\n    }\n\n    if (isNow || currentDate) {\n      self.value = previousValue;\n      currentDateString = ud.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\n      self.setValue(currentDateString);\n      self.setDisplayValue(currentDateString);\n    }\n  },\n\n  /**\r\n      * Apply the final format that will be showed on the input\r\n      */\n  getFullFormatedDate: function getFullFormatedDate(currentDate, currentTime) {\n    var fullDate = \"\";\n\n    if (currentDate.length > 0) {\n      fullDate = currentDate;\n    } else if (currentDate !== undefined) {\n      fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\n    } else {\n      fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\n    }\n\n    fullDate += currentTime;\n    var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\n\n    return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\n  },\n\n  /*\r\n      *  Checks if the date could be localized using site language\r\n      */\n  preprocessDateValue: function preprocessDateValue(date) {\n    return bizagi.util.dateFormatter.formatDate(date, this.properties.fullFormat);\n  },\n\n  /**\r\n      * Public method to determine if a value is valid or not\r\n      */\n  isValid: function isValid(invalidElements) {\n    var self = this;\n    var properties = self.properties;\n    var bValid = true;\n    var value = self.getValue();\n\n    if (value) {\n      if (bizagi.util.parseBoolean(properties.editable)) {\n        value = self.getNormalizeDate(bizagi.util.dateFormatter.getDateFromInvariant(value));\n\n        if (value != 0) {\n          // Check min value and max value\n          if (properties.minValue && typeof properties.minValue === \"string\") {\n            bValid = self.checkMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\n          }\n\n          if (properties.maxValue && typeof properties.maxValue === \"string\") {\n            bValid = self.checkMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\n          }\n        }\n      }\n    }\n\n    if (bizagi.util.parseBoolean(properties.editable)) {\n      // Check required\n      if (properties.required && !self.hasValue()) {\n        self.showMandatoryMessage(properties, invalidElements);\n      }\n    }\n\n    if (bValid) {\n      // Clear error message\n      self.setValidationMessage(\"\");\n    }\n\n    return bValid;\n  },\n\n  /**\r\n      * To validate the min and max values\r\n      * @param {} value\r\n      * @param {} isMinValue\r\n      * @param {} properties\r\n      * @param {} invalidElements\r\n      */\n  checkMinAndMaxValue: function checkMinAndMaxValue(value, isMinValue, properties, invalidElements) {\n    var vValue = this.getNormalizeDate(\n    bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue));\n\n\n    //In case the value from the minValue or maxValue are assigned from a Date control that does not have the option  \"showTime!\n    if (vValue == 0) {\n      var resultValue = \"\";\n      if (properties.timeFormat.indexOf(\":ss\") == -1) {\n        if (isMinValue) {\n          resultValue = properties.minValue + \":00\";\n        } else {\n          resultValue = properties.maxValue + \":00\";\n        }\n      }\n      vValue = this.getNormalizeDate(bizagi.util.dateFormatter.getDateFromFormat(resultValue, properties.fullFormat + \":ss\"));\n    }\n\n    if (isMinValue && value.getTime() < vValue.getTime() || !isMinValue && value.getTime() > vValue.getTime()) {\n      var formatedDate = bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat);\n      var message = \"\";\n\n      if (isMinValue) {\n        message = this.getResource(\"render-date-minimum-validation\").\n        replaceAll(\"#label#\", properties.displayName).\n        replaceAll(\"#minValue#\", formatedDate);\n      } else {\n        message = this.getResource(\"render-date-maximum-validation\").\n        replaceAll(\"#label#\", properties.displayName).\n        replaceAll(\"#maxValue#\", formatedDate);\n      }\n\n      invalidElements.push({ xpath: properties.xpath, message: message });\n      return true;\n    }\n    return false;\n  },\n\n  /**\r\n      * To show the mandatory values message\r\n      * */\n  showMandatoryMessage: function showMandatoryMessage(properties, invalidElements) {\n    var self = this;\n    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\n\n    invalidElements.push({ xpath: properties.xpath, message: message });\n\n    return false;\n  },\n\n  setHour: function setHour(date) {\n    return date.replace(/\\s(\\d:)/, \" 0$1\");\n  },\n\n  /**\r\n      * Cleans the control fields as it requires\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n\n    self.date = undefined;\n    self.time = undefined;\n    self.timeS = undefined;\n    self.setValue(\"\");\n    self.setDisplayValue(\"\");\n  },\n\n  isValidMinMaxValue: function isValidMinMaxValue() {\n    var self = this;\n    var isValid = true;\n    var value = self.getValue();\n\n    if (value) {\n      value = bizagi.util.dateFormatter.getDateFromInvariant(value);\n\n      if (value !== 0) {\n        // Check min value and max value\n        if (self.properties.minValue && typeof self.properties.minValue === \"string\") isValid = self.validateMinAndMaxValue(value, true);\n\n        if (self.properties.maxValue && typeof self.properties.maxValue === \"string\") isValid = self.validateMinAndMaxValue(value, false);\n      }\n    }\n\n    return isValid;\n  },\n\n  validateMinAndMaxValue: function validateMinAndMaxValue(currentDate, isMinValue) {\n    var self = this;\n    var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\n    var formattedDate = self.getNormalizeDate(bizagi.util.dateFormatter.getDateFromInvariant(date));\n\n    return !(\n    isMinValue && currentDate.getTime() < formattedDate.getTime() ||\n    !isMinValue && currentDate.getTime() > formattedDate.getTime());\n\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input, .bz-input--readonly\", $context);\n  },\n\n  /**\r\n      * Gets Mobiscroll Calendar's instance\r\n      * @returns {Object} Mobiscroll's instance\r\n      */\n  getCalendarInstance: function getCalendarInstance() {\n    return this.calendarInstance || (this.calendarInstance = $(this.getDateControl()).mobiscroll(\"getInst\"));\n  },\n\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    var properties = self.properties;\n    var dateControl = self.getControl();\n    var input = $(\".bz-input-icon__input, .bz-input--readonly\", dateControl);\n    var ud = bizagi.util.dateFormatter;\n\n    if (bizagi.util.isNumeric(value) && value !== 0) {\n      value = ud.formatInvariant(new Date(value), properties.showTime);\n    }\n\n    if (value) {\n      if (typeof value == \"string\") {\n        value = self.getNormalizeDate(ud.getDateFromInvariant(value, properties.showTime));\n      } else {\n        value = self.getNormalizeDate(value);\n      }\n    }\n\n    // Assert that the date could be parsed\n    var ci = self.getCalendarInstance();\n    if (properties.editable && ci.setVal) ci.setVal(value);\n    self.setValue(ud.formatInvariant(value, true));\n    properties.displayValue = ud.formatDate(value, properties.fullFormat, self.i18n);\n\n    // Set display value\n    if (typeof properties.displayValue === \"string\" || typeof properties.displayValue === \"number\") {\n      input.prop(\"value\", properties.displayValue);\n      input.prop(\"title\", properties.displayValue);\n    }\n\n    if (!properties.editable) {\n      input.html(properties.displayValue);\n    }\n  },\n  /**\r\n      * Sets value to the control and execute a callback function\r\n      * @param {Date} date date to asign\r\n      * @param {Function} callBack function to execute\r\n      * @returns {}\r\n      */\n  setValueFromCalendarButtons: function setValueFromCalendarButtons(date, callBack) {\n    this._super(date);\n    if (typeof callBack === \"function\") callBack(date);\n    this.onChangeHandler();\n  } });","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Prez\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\n// Extends itself\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.actionLauncher\", {}, {\n\n  /**\r\n                                                                                                       * Render a specific implementation for Desktop device\r\n                                                                                                       */\n  postRender: function postRender() {\n    if (this.getMode() == \"design\") {\n      return;\n    }\n\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    self.actions = [];\n    self.startLoading();\n\n    // Define params to get list of actions        \n    $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).\n    then(function (response) {\n      response = self.getPropertiesActionLaucher(response);\n      self.actions = response;\n      self.deferredActions.resolve(response);\n\n      if (self.actions.length > 0) {\n        $(\"[data-element='actions-add-btn']\", control).show();\n      } else\n      {\n        $(\"[data-element='actions-add-btn']\", control).hide();\n      }\n\n      if (properties.isHorizontal) {\n        if (properties.templatetype != \"none\") {\n          return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs).\n          then(function (templateData) {\n            return self.engine.render($.extend(templateData, {\n              isDefaultTemplate: properties.templatetype === \"default\",\n              sessionId: self.properties.sessionId }),\n            self.processPropertyValueDataTmplArgs);\n          }).then(function (tmpl) {\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n            var html = $($.fasttmpl(template, {\n              template: true }));\n\n\n            $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\n            return html;\n          });\n        }\n      } else\n      {\n        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n        return $.fasttmpl(template, {\n          template: false });\n\n      }\n    }).done(function (html) {\n      $(\"[data-element='template-container']\", control).append(html);\n      self.configureActionsHandlers();\n      self.configureTemplateHandlers();\n    }).always(function () {\n      self.endLoading();\n    });\n  },\n\n\n  /**\r\n      * Validates if the action launcher control contains a valid value\r\n      * @returns {boolean}\r\n      */\n  hasValue: function hasValue() {\n    var value = this.getValue();\n    return typeof value !== \"undefined\" && value !== null && value.length > 0;\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  configureActionsHandlers: function configureActionsHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var actionLauncherControls = $(\".action-launcher-control\", control);\n\n    //Binding for click action on buttons\n    actionLauncherControls.on(\"click\", function () {\n      var item = self.actions[parseInt($(this).data(\"index\"))];\n      var action = {\n        guidProcess: item[0],\n        guidAction: item[4],\n        displayName: item[1],\n        actionType: item[3],\n        xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n        readOnlyForm: item[6] || false,\n        guidEntity: self.properties.guidEntity,\n        xpathActions: self.properties.xpathActions || \"\" };\n\n\n      self.processAction(action);\n    });\n\n    var actions = [];\n    for (var i = 0, length = self.actions.length; i < length; i++) {\n      actions.push({\n        guid: self.actions[i][0],\n        displayName: self.actions[i][1] });\n\n    }\n\n\n    //Binding for click action sheet\n    $(\"[data-element='actions-add-btn']\", control).actionSheet({\n      actions: actions,\n      actionClicked: function actionClicked(action) {\n        var item = self.actions.find(function (element) {\n          return element[0] == action.guid;\n        });\n\n        self.processAction({\n          guidProcess: item[0],\n          guidAction: item[4],\n          displayName: item[1],\n          actionType: item[3],\n          xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n          readOnlyForm: item[6] || false,\n          xpathActions: self.properties.xpathActions || \"\" });\n\n      } });\n\n\n    //Catch the typed text in the search field and filter the action list\n    $.expr[\":\"].FilterAction = function (entity, i, array) {\n      var search = array[3];\n      if (!search) {\n        return false;\n      }\n      return new RegExp(search, \"i\").test($(entity).text());\n    };\n    $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\n      var search = $(this).val();\n      $(\".action-launcher-control\", control).show();\n      if (search) {\n        $(\".action-launcher-control\", control).\n        not(\":FilterAction(\" + search + \")\").hide();\n      }\n    });\n  },\n  /**\r\n      *\r\n      */\n  configureTemplateHandlers: function configureTemplateHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    //Catch the event from the layout link\n    self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\n      params.filters = [];\n      self.triggerGlobalHandler(\"dataNavigation\", params);\n    });\n\n    $(\".bz-template-more-or-less\", control).bind(\"click\", function () {\n      $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\n    });\n  },\n  /**\r\n      *\r\n      * @param action\r\n      */\n  processAction: function processAction(action) {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n    var multipleSelection = typeof properties.multipleSelection == \"undefined\" ? true : properties.multipleSelection;\n\n    if (multipleSelection) {\n      // If this is a form and has been queued, so open it\n      if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\n        //Open action\n        $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\n      } else {\n        $.when(self.actionManager(action)).done(function (act) {\n          self.executeAction(act);\n        });\n      }\n    } else if (self.getValue().length > 0) {\n      self.showConfirmationDialog(action);\n    } else {\n      $.when(self.actionManager(action)).done(function (act) {\n        self.executeAction(act);\n      });\n    }\n  },\n\n  /**\r\n      *\r\n      * @param data\r\n      * @param action\r\n      */\n  notifyExecution: function notifyExecution(data, action) {\n    var self = this;\n\n    if (data.response == \"success\") {\n      $.notifier.add({\n        class_name: \"success\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    } else {\n      $.notifier.add({\n        class_name: \"error\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    }\n  },\n  /**\r\n      *\r\n      * @param action\r\n      * @returns {*}\r\n      */\n  processActionForm: function processActionForm(action) {\n    var self = this;\n    var properties = self.properties;\n    var formParams = self.getParams();\n\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var xpathContext = action.xpathContext ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\n    var def = new $.Deferred();\n\n    // Show dialog with new form after that\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: slideForm.form.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          if (!action.editMode && self.countSameActions(action) === 0) {\n            action.idStartScope = savedData.IdScope;\n          }\n          def.resolve(savedData.IdScope);\n        });\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    var renderParams = {\n      \"idForm\": action.guidProcess,\n      \"contextType\": \"start\",\n      \"idCase\": self.properties.caseId,\n      \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      \"additionalXpaths\": additionalXpaths,\n      \"xpathContext\": xpathContext,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"readOnlyForm\": action.readOnlyForm,\n      \"recordXpath\": action.recordXpath };\n\n\n    if (action.actionType === \"Form\") {\n      renderParams.contextType = \"entitytemplate\";\n      renderParams.xpathContext = undefined;\n      renderParams.guidEntity = action.guidEntity;\n      renderParams.rewriteContextType = true;\n    }\n\n    slideForm.render(renderParams);\n\n    return def.promise();\n  },\n  /**\r\n      *\r\n      * @param action\r\n      * @returns {*}\r\n      */\n  processActionFormCollection: function processActionFormCollection(action) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var def = new $.Deferred();\n    var xpathContext = action.xpathContext ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\n    var xpathPattern = \"%s[id=%s]\";\n    var xpathPatternWithoutkey = \"%s[]\";\n    var xpathContextWithKey = xpathContext !== \"\" ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\n    var xpathContextWithoutKey = xpathContext !== \"\" ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\n    var formParams = form.getParams();\n\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        if (action.editMode) {\n          return self.dataService.multiaction().submitData({\n            action: \"SAVE\",\n            data: data,\n            xpathContext: xpathContextWithKey,\n            idPageCache: data.idPageCache,\n            isOfflineForm: false,\n            isActionStartForm: true }).\n          done(function (savedData) {\n            def.resolve(savedData.IdScope);\n          });\n        } else {\n          return self.dataService.addGridRecordData({\n            idRender: properties.id,\n            //xpath: properties.xpath,\n            xpathContext: xpathContext,\n            contexttype: \"start\",\n            idPageCache: data.idPageCache,\n            submitData: data }).\n          done(function (savedData) {\n            action.idStartScope = savedData.IdScope;\n            action.idEntity = savedData.IdEntity;\n            self.addActionToQueue(action);\n            def.resolve(savedData.IdScope);\n          });\n        }\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    slideForm.render({\n      \"idForm\": action.guidProcess,\n      \"contextType\": \"start\",\n      \"idCase\": formParams.idCase,\n      \"additionalXpaths\": additionalXpaths,\n      \"xpathContext\": action.editMode ? xpathContextWithKey : xpathContextWithoutKey,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"readOnlyForm\": action.readOnlyForm,\n      \"recordXpath\": action.recordXpath });\n\n\n    return def.promise();\n  },\n  /**\r\n      * Process a start form\r\n      * @param args\r\n      * @return {*}\r\n      */\n  processStartForm: function processStartForm(args) {\n    var self = this;\n    var def = new $.Deferred();\n    args = args || {};\n    var formParams = self.getFormContainer().getParams();\n\n    // Show dialog\n    var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\n      title: args.title || \"\",\n      navigation: formParams.navigation,\n      saveButtonLabel: self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\" ?\n      bizagi.localization.getResource(\"render-form-button-create\") :\n      bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      onSave: function onSave(data) {\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: self.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          def.resolve(savedData.IdScope);\n        });\n      } });\n\n    // Render the search form\n    slideForm.render({\n      guidprocess: args.guidprocess,\n      idStartScope: args.idStartScope,\n      idCase: self.properties.caseId,\n      idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      additionalXpaths: self.properties.additionalXpath.join(\",\"),\n      surrogatedKey: self.properties.surrogatedKey,\n      recordXpath: args.recordXpath,\n      mappingstakeholders: true });\n\n\n    return def.promise();\n  },\n  /**\r\n      *\r\n      * @param action\r\n      */\n  executeAction: function executeAction(action) {\n    var self = this;\n\n    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\n      var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n        self.executeActionImmediately(action);\n      });\n    } else {\n      self.addActionToQueue(action);\n    }\n  },\n\n  /**\r\n      * Show the confirmation dialog\r\n      * bizagi.createOkCancelPopup\r\n      * @param action\r\n      * */\n  showConfirmationDialog: function showConfirmationDialog(action) {\n    var self = this;\n    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\n\n    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n    done(function () {\n      self.setValue([]);\n\n      $.when(self.actionManager(action)).done(function (act) {\n        self.executeAction(act);\n      });\n    });\n  },\n\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\"[data-element='actions-container']\", control);\n    var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\n\n    self.configureQueueVisibility();\n\n    $.when(self.deferredActions).done(function (listOfActions) {\n      var getMappingAction = function getMappingAction(guidAction) {\n        var mapping = [];\n        $.each(listOfActions, function (key, value) {\n          if (value[4] == guidAction) {\n            mapping = value;\n          }\n        });\n\n        return mapping;\n\n      };\n\n      $.each(data, function (key, value) {\n        var mapping = getMappingAction(value.guidAction);\n        data[key].displayName = mapping[1];\n        data[key].guidProcess = mapping[0];\n        data[key].actionType = mapping[3];\n        data[key].xpathContext = mapping[5];\n        data[key].readOnlyForm = mapping[6];\n\n        if (data[key].params && data[key].params.idStartScope) {\n          data[key].idStartScope = data[key].params.idStartScope;\n        }\n        if (data[key].params && data[key].params.idPageCache) {\n          data[key].idPageCache = data[key].params.idPageCache;\n        }\n        if (data[key].params && data[key].params.idEntity) {\n          data[key].idEntity = data[key].params.idEntity;\n        }\n      });\n\n      if (data.length > 0) {\n        $.when($.fasttmpl(template, { actions: data })).done(function (html) {\n          actionsToExecuteContainer.empty();\n          actionsToExecuteContainer.append(html);\n\n          var removeActionSelector = $(\".bz-actions-to-execute .bz-btn-icn\", actionsToExecuteContainer);\n          var openActionSelector = $(\"label\", actionsToExecuteContainer);\n\n          removeActionSelector.on(\"click\", function () {\n            var index = $(this).parent().data(\"index\");\n            self.removeActionToQueue(index);\n          });\n\n          openActionSelector.on(\"click\", function () {\n            var target = $(this).parent();\n            var type = target.data(\"actiontype\");\n            var guidprocess = target.data(\"guidprocess\");\n            var idStartScope = target.data(\"idstartscope\");\n            var title = target.data(\"title\");\n            // When undefined return string \"undefined\" instead of type \"undefined\"\n            var xpathContext = target.data(\"xpathcontext\");\n            var readOnlyForm = target.data(\"readonlyform\") || false;\n            var idEntity = target.data(\"identity\") || \"\";\n            var guidAction = target.data(\"guidaction\");\n            var recordXpath = xpathContext || self.properties.xpathContext;\n            switch (type) {\n              case \"Process\":\n                if (idStartScope) {\n                  self.processStartForm({\n                    guidprocess: guidprocess,\n                    idStartScope: idStartScope,\n                    title: title,\n                    xpathContext: xpathContext,\n                    recordXpath: recordXpath });\n\n                }\n                break;\n              case \"Form\":\n                var action = {\n                  guidProcess: guidprocess,\n                  idStartScope: idStartScope,\n                  editMode: true,\n                  xpathContext: xpathContext,\n                  readOnlyForm: readOnlyForm,\n                  idEntity: idEntity,\n                  recordXpath: recordXpath };\n\n\n                if (action.xpathContext) {\n                  self.processActionFormCollection(action);\n                } else {\n                  // Convert string \"undefined\" into type \"undefined\"\n                  action.xpathContext = undefined;\n\n                  // Add parameters if action form\n                  var extraParams = {};\n                  var dataAction = self.value.filter(function (item) {\n                    return item.guidAction == guidAction;\n                  });\n\n                  if (dataAction.length > 0) {\n                    extraParams = {\n                      actionType: \"Form\",\n                      contextType: \"entitytemplate\",\n                      guidEntity: self.properties.guidEntity || dataAction[0].guidEntity };\n\n                  }\n\n                  self.processActionForm($.extend(action, extraParams));\n                }\n                break;\n              case \"Rule\":\n                // Rules dont have forms or something like that\n                break;}\n\n          });\n        });\n      } else {\n        actionsToExecuteContainer.empty();\n      }\n\n    });\n  },\n  /**\r\n      * Show container if it has actions\r\n      */\n  configureQueueVisibility: function configureQueueVisibility() {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\n    var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\n\n    if (self.getValue().length > 0) {\n      actionsToExecuteContainer.show();\n      actionsToExecuteTitle.show();\n    } else {\n      actionsToExecuteContainer.hide();\n      actionsToExecuteTitle.hide();\n    }\n  } });","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Prez\r\n */\n\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.entityTemplate\", {}, {\n\n  /**\r\n                                                                                                       * Render a specific implementation for smartphone device\r\n                                                                                                       */\n  postRender: function postRender() {\n    if (this.getMode() == \"design\") {\n      return;\n    }\n\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    self.actions = [];\n    self.configureQueueVisibility();\n    self.startLoading();\n\n    // Define params to get template               \n    self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs).\n    then(function (templateData) {\n      return self.engine.render(templateData, $.extend(self.processPropertyValueDataTmplArgs, { formParams: self.getFormParams() })).\n      then(function (tmpl) {\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n        var html = $($.fasttmpl(template, { template: true }));\n        $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\n\n        if (properties.allowactions) {\n          return self.dataService.multiaction().getActions(self.processPropertyValueArgs).\n          then(function (response) {\n            self.deferredActions.resolve(response);\n            self.actions = response;\n\n            if (self.actions.length > 0) {\n              $(\"[data-element='actions-add-btn']\", control).show();\n            } else\n            {\n              $(\"[data-element='actions-add-btn']\", control).hide();\n            }\n            return html;\n          });\n        } else\n        {\n          return html;\n        }\n      });\n\n    }).done(function (html) {\n      $(\"[data-element='template-container']\", control).append(html);\n      self.configureActionsHandlers();\n      self.configureTemplateHandlers();\n    }).always(function () {\n      self.endLoading();\n    });\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  configureActionsHandlers: function configureActionsHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var entityTemplateControls = $(\".action-launcher-control\", control);\n\n    /**\r\n                                                                          * Binding for click action on buttons\r\n                                                                          */\n    entityTemplateControls.on(\"click\", function () {\n      var item = self.actions[parseInt($(this).data(\"index\"))];\n      var action = {\n        guidProcess: item[0],\n        guidAction: item[4],\n        displayName: item[1],\n        actionType: item[3],\n        xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n        xpathActions: self.properties.xpathActions || \"\" };\n\n\n      if (action.actionType === \"Form\") {\n        action.xpathContext = undefined;\n        action.contextType = \"entitytemplate\";\n        action.guidEntity = self.properties.guidEntity;\n      }\n\n      self.processAction(action);\n    });\n\n    var actions = [];\n    for (var i = 0, len = self.actions.length; i < len; i++) {\n      actions.push({\n        guid: self.actions[i][0],\n        displayName: self.actions[i][1] });\n\n    }\n\n    /**\r\n       * Binding for click action sheet\r\n       */\n    $(\"[data-element='actions-add-btn']\", control).actionSheet({\n      actions: actions,\n      actionClicked: function actionClicked(action) {\n        var item = self.actions.find(function (e) {\n          return e[0] == action.guid;\n        });\n        self.processAction({\n          guidProcess: item[0],\n          guidAction: item[4],\n          displayName: item[1],\n          actionType: item[3],\n          xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\" });\n\n      } });\n\n\n  },\n\n  configureTemplateHandlers: function configureTemplateHandlers() {\n    var self = this;\n    var control = self.getControl();\n    /**\r\n                                      * Catch the event from the layout link\r\n                                      */\n    self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\n      params.filters = [];\n      params.calculateFilters = params.calculateFilters || true;\n\n      self.triggerGlobalHandler(\"dataNavigation\", params);\n    });\n\n    $(\".bz-template-more-or-less\", control).bind(\"click\", function () {\n      $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\n    });\n  } });","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Andres Felipe Arenas\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\n// Extends itself\nbizagi.rendering.smartphone.polymorphicLauncher.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", {}, {\n  /**\r\n                                                                                                                  * Render a specific implementation for Smartphone device\r\n                                                                                                                  */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n    var mode = self.getMode();\n    var html, template;\n\n    if (mode == \"design\" || !self.properties.surrogatedKey) {\n      return \"\";\n    }\n\n    self.configureQueueVisibility();\n\n    /**\r\n                                      * Define params to get list of actions\r\n                                      */\n    return $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function (response) {\n      // Convert default response to tree data structure\n      response = self.dataService.serializePolymorphicActions(response);\n      self.totalActions = bizagi.clone(response);\n      var actions = bizagi.clone(response);\n      self.lessActions = bizagi.clone(actions);\n\n      // NOTE: Code extracted\n      var templateArguments = {\n        actions: actions,\n        allowSearch: properties.allowSearch,\n        treeActionsList: self.getTreeItems(actions) };\n\n      template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\n\n      var control = self.getControl();\n      var actionsContainer = $(\".bz-polymorphic-launcher__constructors\", control);\n      actionsContainer.append($.fasttmpl(template, templateArguments));\n      self.bindHandlers();\n    });\n  },\n\n  /**\r\n      * Get rendered html of each node of constructors\r\n      * @param actions\r\n      * @param level\r\n      * @return {string}\r\n      */\n  getTreeItems: function getTreeItems(actions, level) {\n    var self = this;\n    var item = \"<ul>\";\n    var templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\n    actions = actions || {};\n    level = level || 1;\n\n    $.each(actions, function (key, value) {\n      item += $.fasttmpl(templateTreeItem, value);\n\n      if (value.children) {\n        item += self.getTreeItems(value.children, level + 1);\n      }\n    });\n    item += \"</ul>\";\n    return item;\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  bindHandlers: function bindHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var actionLauncherControls = $(\".bz-polymorphic-launcher__constructors li span\", control);\n\n    //Binding for click action on buttons\n    actionLauncherControls.on(\"click\", function () {\n      var $targetData = $(this).parent();\n      var action = {\n        guidEntity: $targetData.data(\"guidentity\"),\n        guidObject: $targetData.data(\"guidobject\"),\n        guidConstructor: $targetData.data(\"guidconstructor\"),\n        displayName: $targetData.data(\"display-name\"),\n        actionType: $targetData.data(\"action-type\"),\n        xpathContext: $targetData.data(\"xpathcontext\") };\n\n      self.onActionClicked(action);\n    });\n    //Catch the typed text in the search field and filter the action list\n    $.expr[\":\"].FilterAction = function (entity, i, array) {\n      var search = array[3];\n      if (!search) {\n        return false;\n      }\n      return new RegExp(search, \"i\").test($(entity).text());\n    };\n    $(\"input[data-action=search]\", control).keyup(function () {\n      var search = $(this).val();\n      $(\".bz-polymorphic-launcher__constructors li\", control).show();\n      if (search) {\n        $(\".bz-polymorphic-launcher__constructors li\", control).not(\":FilterAction(\" + search + \")\").hide();\n      }\n    });\n\n  },\n  /**\r\n      * Execute an Action\r\n      * @param action\r\n      */\n  onActionClicked: function onActionClicked(action) {\n    var self = this;\n\n    $.when(self.actionManager(action)).done(function (act) {\n      self.executeAction(act);\n    });\n  },\n  /**\r\n      * Show a message when action has been executed\r\n      * @param status\r\n      * @param action\r\n      */\n  notifyExecution: function notifyExecution(status, action) {\n    var self = this;\n    if (status == \"success\") {\n      $.notifier.add({\n        class_name: \"success\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n\n    } else {\n      $.notifier.add({\n        class_name: \"error\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    }\n  },\n  /**\r\n      * Show a dialog with a form\r\n      * @param action\r\n      * @return {*}\r\n      */\n  processActionForm: function processActionForm(action) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var def = new $.Deferred();\n    var xpathContext = action.xpathContext || \"\";\n    var formParams = form.getParams();\n\n    var recordXpath = self.properties.recordXpath;\n\n    // Show dialog with new form after that\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        var pageCache = data.idPageCache;\n        data.idPageCache = null;\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\n          idPageCache: pageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          if (!action.editMode && self.countSameActions(action) == 0) {\n            action.idStartScope = savedData.IdScope;\n          }\n          def.resolve(savedData.IdScope);\n        });\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    slideForm.render({\n      \"idForm\": action.guidObject,\n      \"contextType\": \"entity\",\n      \"guidEntity\": action.guidEntity,\n      \"idCase\": self.properties.caseId,\n      \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      \"additionalXpaths\": additionalXpaths,\n      //\"xpathContext\": xpathContext,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"recordXpath\": recordXpath });\n\n\n    return def.promise();\n  },\n\n  /**\r\n      * Process a start form\r\n      * @param args\r\n      * @return {*}\r\n      */\n  processStartForm: function processStartForm(args) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var def = new $.Deferred();\n    var formParams = form.getParams();\n    args = args || {};\n\n\n    var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\n      //showSaveButton: properties.editable,\n      maximized: properties.maximized,\n      title: args.title || \"\",\n      navigation: formParams.navigation,\n      saveButtonLabel: self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\" ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      onSave: function onSave(data) {\n        form.startLoading();\n\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: self.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          form.endLoading();\n          def.resolve(savedData.IdScope);\n        });\n      } });\n\n\n    slideForm.render({\n      guidprocess: args.guidprocess,\n      idStartScope: args.idStartScope,\n      idCase: self.properties.caseId,\n      idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      additionalXpaths: self.properties.additionalXpath.join(\",\"),\n      surrogatedKey: self.properties.surrogatedKey,\n      recordXpath: args.recordXpath,\n      mappingstakeholders: true });\n\n\n    return def.promise();\n  },\n  /**\r\n      * Execute and action if a form is global form or summary, or send to queue\r\n      * @param action\r\n      */\n  executeAction: function executeAction(action) {\n    var self = this;\n\n    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\n      var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n        self.executeActionImmediately(action);\n      });\n    } else {\n      self.addActionToQueue(action);\n    }\n  },\n\n  /**\r\n      * Show confirmation dialog\r\n      * @param action\r\n      */\n  showConfirmationDialog: function showConfirmationDialog(action) {\n    var self = this;\n    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\n\n    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n    done(function () {\n      self.setValue([]);\n\n      $.when(self.actionManager(action)).\n      done(function (act) {\n        self.executeAction(act);\n      });\n    });\n  },\n\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\n    var template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\n    self.configureQueueVisibility();\n\n    $.when($.fasttmpl(template, { actions: data })).done(function (html) {\n      actionsToExecuteContainer.empty();\n      actionsToExecuteContainer.append(html);\n      var removeActionSelector = $(\".bz-pill .bz-btn-icn\", actionsToExecuteContainer);\n      var openActionSelector = $(\".bz-pill__label\", actionsToExecuteContainer);\n      removeActionSelector.on(\"click\", function () {\n        var index = $(this).parent().data(\"index\");\n        self.removeActionToQueue(index);\n      });\n      openActionSelector.bind(\"click\", function () {\n        var $target = $(this).parent();\n        var type = $target.data(\"actiontype\");\n        var guidprocess = $target.data(\"guidprocess\");\n        var idStartScope = $target.data(\"idstartscope\");\n        var title = $target.data(\"title\");\n        var xpathContext = $target.data(\"xpathcontext\");\n        var idEntity = $target.data(\"identity\") || \"\";\n        var guidEntity = $target.data(\"guidentity\");\n        var recordXpath = xpathContext || self.properties.xpathContext;\n\n        switch (type) {\n          case \"Process\":\n            if (idStartScope) {\n              self.processStartForm({\n                guidprocess: guidprocess,\n                idStartScope: idStartScope,\n                title: title,\n                xpathContext: xpathContext,\n                recordXpath: recordXpath });\n\n            }\n            break;\n          case \"Form\":\n            var action = {\n              guidProcess: guidprocess,\n              idStartScope: idStartScope,\n              editMode: true,\n              xpathContext: xpathContext,\n              idEntity: idEntity,\n              guidEntity: guidEntity,\n              guidObject: guidprocess };\n\n\n            self.processActionForm(action);\n            break;\n          case \"Rule\":\n            // Rules dont have forms or something like that\n            break;}\n\n      });\n    });\n  },\n  /**\r\n      * Show container if it has actions\r\n      */\n  configureQueueVisibility: function configureQueueVisibility() {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\n    var actionsToExecuteTitle = $(\".bz-polymorphic-launcher__title\", control);\n    if (self.getValue().length > 0) {\n      actionsToExecuteContainer.show();\n      actionsToExecuteTitle.show();\n    } else {\n      actionsToExecuteContainer.hide();\n      actionsToExecuteTitle.hide();\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.yesno\", bizagi.rendering.yesno.prototype);\n// Extends itself\nbizagi.rendering.smartphone.yesno.extend(\"bizagi.rendering.smartphone.yesno\", {}, {\n\n  /**\r\n                                                                                     * Method to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input[type=radio]\");\n\n    if (this.properties.editable && (this.value == null || this.value === undefined) && this.properties.value != null) {\n      this.value = this.properties.value;\n    }\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var $control = this.getControl();\n    var parsedValue = bizagi.util.parseBoolean(value);\n\n    this.setValue(parsedValue, false);\n\n    if (this.properties.editable) {\n      if (parsedValue) {\n        $control.find(\"input[value=true]\").prop('checked', true);\n        $control.find(\"input[value=false]\").prop('checked', false);\n      } else {\n        $control.find(\"input[value=false]\").prop('checked', true);\n        $control.find(\"input[value=true]\").prop('checked', false);\n      }\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    self.radio.change(function () {\n      var $selected = $(this);\n      var value = $selected.prop('value');\n\n      if (self.value !== value) {\n        self.setValue(value);\n      }\n    });\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\"label.bz-radio__label\", context);\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    var value = null;\n    this.setValue(value, false);\n    this.clearDisplayValue();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    if (this.properties.editable) {\n      this.radio.prop('checked', false);\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Check\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.check\", bizagi.rendering.check.prototype);\n// Extends itself\nbizagi.rendering.smartphone.check.extend(\"bizagi.rendering.smartphone.check\", {}, {\n\n  /**\r\n                                                                                     * Template method to implement in each device to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.check = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.check = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // Render as simple value\n    var displayValue = bizagi.util.parseBoolean(value);\n\n    // Set internal value\n    this.setValue(displayValue, false);\n\n    if (this.properties.editable && this.check) {\n      if (displayValue) {\n        this.check.attr(\"checked\", \"checked\");\n      } else {\n        this.check.removeAttr(\"checked\");\n      }\n    } else if (this.check) {\n      this.check.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    this.check.on(\"click\", function (evt) {\n      var isCheck = $(this).is(':checked');\n\n      self.setValue(isCheck, true);\n\n    });\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    this.setDisplayValue(false);\n    this.setValue(false, false);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.checkList\", bizagi.rendering.checkList.prototype);\n// Extends itself\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.checkList\", {}, {\n\n  /**\r\n                                                                                             *   Template method to implement in each device to customize each render after processed\r\n                                                                                             */\n  postRender: function postRender() {\n    this._super();\n    this.properties.unique = Math.ceil(Math.random() * 1000);\n    this.properties.required = true;\n  },\n\n  /**\r\n      *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    // Call base\n    self._super();\n    $(\"input[type=checkbox]\", self.getControl()).bind(\"change\", function () {\n      var itemId = $(this).data(\"item-guid\");\n      self.onCheckListGroupChange(itemId, this.checked);\n    });\n  },\n\n  onCheckListGroupChange: function onCheckListGroupChange(itemId, checked) {\n    var self = this;\n    var item;\n    var items = $.grep(self.properties.items, function (element, index) {\n      return element.guid === itemId;\n    });\n    if (items && items.length > 0) {\n      item = items[0];\n    }\n    item.checked = checked;\n  },\n\n  /**\r\n      *   Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    $(\"input[type=checkbox]\", this.getControl()).removeAttr(\"checked\");\n  },\n\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.multiSelect\", bizagi.rendering.multiSelect.prototype);\n// Extends itself\nbizagi.rendering.smartphone.multiSelect.extend(\"bizagi.rendering.smartphone.multiSelect\", {\n  MORE_OPTION_WIDTH: 40,\n  SEARCH_MIN_LENGTH: 1 },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data submitData\r\n   * @returns {}\r\n   */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.readonly\");\n    var dataList = self.getDataValue() || [];\n\n    // Render template\n    var content = $.fasttmpl(template, {\n      items: dataList,\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return content;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n\n    if (this.isExecutionMode()) {\n      this.getData().done(function (data) {\n        self.properties.data = data;\n      });\n    }\n\n    // Call base\n    this._super();\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action=modal]\", $control).bind(\"click\", function () {\n      self.openModalView();\n    });\n  },\n\n  /**\r\n      * Sets the value and display, avoid to include setValue in this method.\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    this._super(value);\n\n    if (value !== undefined) {\n      var dataList = self.getDataValue() || [];\n      var dataMapped = dataList.map(function (el) {\n        return self.formatItem(el.value);\n      }).join(\", \");\n\n      $(\".bz-input-icon__input\", this.getControl()).html(dataMapped);\n    }\n  },\n\n  /**\r\n      * Opens the modal view\r\n      */\n  openModalView: function openModalView() {\n    var self = this;\n    self.getData().done(function (result) {\n      var template_content = self.renderFactory.getTemplate('multiselect-list');\n      var value = self.getDataValue() || [];\n\n      var data = {\n        values: result,\n        isChecked: function isChecked(id) {\n          return self.isChecked(value, id);\n        } };\n\n\n      var content = $.fasttmpl(template_content, data, {\n        formatItem: self.formatItem });\n\n\n      var template_footer = self.renderFactory.getTemplate(\"modal-footer-done\");\n      var footer = $.fasttmpl(template_footer, {});\n\n      self.getControl().mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {\n          hideSearch: self.properties.enableTyping === false }),\n\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: content,\n        footerTemplate: footer,\n        transition: \"slideIn:up\",\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n        afterOpenAnimation: function afterOpenAnimation(event) {\n          var $context = $(\".bz-modal-view__search\", event.view.header);\n\n          // Fix the moving content to top\n          if ($context && $context[0]) {\n            $context[0].scrollIntoView(true);\n            $context.focus();\n          }\n        },\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        configureActions: function configureActions(modalView) {\n          self.configureModalViewHandlers(modalView);\n        } });\n\n    });\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new combo control.\r\n      * */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    var $listContainer = $(\".bz-checkbox-list li\", modalView.content);\n    //clear button\n    var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n    // Suggest input\n    var $suggestInput = $(\".bz-modal-view__search\", modalView.header);\n\n    if (this.properties.enableTyping) {\n      $suggestInput.on(\"change keyup\", function () {\n        if (this.value === \"\") {\n          $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n        } else {\n          $clearButton.addClass(\"bz-modal-view__clear--visible\");\n        }\n        self.filterList(this.value, $listContainer);\n      }).on(\"focus\", function () {\n        modalView.header.addClass(\"bz-modal-view__header--active\");\n      }).on(\"blur\", function () {\n        modalView.header.removeClass(\"bz-modal-view__header--active\");\n      });\n\n      //Clear the search\n      $clearButton.on(\"click\", function () {\n        $suggestInput.val(\"\").trigger(\"change\");\n      });\n    }\n\n    $(\"[data-action=close]\", modalView.header).on(\"click\", function () {\n      modalView.close();\n    });\n\n    $(modalView.footer).on(\"click\", \"[data-action=save]\", function () {\n      // Create a temporal array\n      var newList = [];\n\n      $.each.call(this, $listContainer, function (index, item) {\n        var check = item.querySelector(\"input\");\n\n        if (check.checked) {\n          var id = check.getAttribute(\"data-id\");\n          var element = this.findItemById(id);\n          var value = element.value;\n          newList.push({ id: id, value: value });\n        }\n      }.bind(self));\n\n      self.setDisplayValue(newList);\n\n      modalView.close();\n    });\n  },\n\n  /**\r\n      * Fetch the data into a deferred\r\n      * @returns {*[]}\r\n      */\n  getData: function getData() {\n    var self = this;\n\n    return this.isOfflineForm ?\n    this.getOfflineData() :\n    $.when(this._super()).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = typeof error_obj === \"undefined\" ? {\n        \"message\": bizagi.localization.getResource(\"workportal-general-error\") } :\n      error_obj;\n\n      self.getFormContainer().failHandler(message);\n    });\n  },\n\n  /**\r\n      * Get offline data for request\r\n      */\n  getOfflineData: function getOfflineData() {\n    var data = this.properties.data || [];\n\n    return $.when(this.normalizeData(data));\n  } });","/**\r\n *   Name: Bizagi Render HandSignature Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Hand Signature render class to adjust to smartphone devices\r\n */\n\n// Extends from render Smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.handSignature\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.handSignature.prototype);\n// Extends itself\nbizagi.rendering.smartphone.handSignature.extend(\"bizagi.rendering.smartphone.handSignature\", {}, {\n\n  /**\r\n                                                                                                     * Whether or not is a native device\r\n                                                                                                     * @var isNative boolean\r\n                                                                                                     */\n  isNative: false,\n\n  /**\r\n                    * Whether or not is a offline control\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $actions = $(\".bz-actions\", this.getControl());\n    var $container = self.getSignatureContainer();\n\n    var autoSave = bizagi.util.debounce2(function (params) {\n      if (!changed) return;\n\n      var data = Array.prototype.slice.call(params || []);\n      var dataImage = (data && data[0] || []).dataImage || \"\";\n\n      self.saveDeferred = $.when(self.saveSignature(dataImage));\n    }, !self.isOfflineForm ? self.DELAY_TO_SAVE : 0);\n\n    var changed = false;\n\n    $container.bind(\"change\", function () {\n      changed = true;\n      if ($(this).BzjSignature(\"isModified\")) {\n        self.saveTimestamp = new Date().getTime();\n        var $canvas = $(\".bz-signature__container-canvas\", this)[0];\n        var dataImage = $canvas.toDataURL(\"image/png\");\n        autoSave.fire({ dataImage: dataImage });\n        self.setData(dataImage.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\"));\n        self.properties.url = dataImage;\n        self.setState(self.STATE_TYPE.done);\n      }\n    });\n\n    $actions.on(\"click\", \"[data-action='clear']\", function () {\n      changed = true;\n      autoSave.cancel();\n      self.onSignatureClear($container);\n    });\n\n    $actions.on(\"click\", \"[data-action='edit']\", function () {\n      self.onSignatureEdit($container);\n      changed = false;\n    });\n\n    $actions.on(\"click\", \"[data-action='save']\", function () {\n      if (!changed) {\n        self.setState(self.STATE_TYPE.edit);\n        $container.BzjSignature(\"disable\");\n        return;\n      }\n\n      self.onSignatureSave($container, autoSave);\n      changed = false;\n    });\n\n  },\n\n  onSignatureClear: function onSignatureClear($container) {\n    var self = this;\n\n    $container.BzjSignature(\"reset\");\n\n    var clearReference;\n\n    if (self.hasValue()) {\n      bizagi.loading.start();\n      self.setData(self.EMPTY_VALUE);\n      self.properties.url = self.EMPTY_VALUE;\n\n      var clearReference = self.deleteSignature();\n      $.when(clearReference).then(function (result) {\n        self.setData(result);\n        self.properties.url = result;\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    }\n\n    return $.when(clearReference);\n  },\n\n  onSignatureEdit: function onSignatureEdit($container) {\n    this.setState(this.STATE_TYPE.draw);\n    $container.BzjSignature(\"enable\");\n  },\n\n  onSignatureSave: function onSignatureSave($container, autoSave) {\n    var self = this;\n\n    $container.BzjSignature(\"disable\");\n\n    if ($container && $container.BzjSignature(\"isModified\")) {\n      var $canvas = $(\".bz-signature__container-canvas\", $container)[0];\n      bizagi.loading.start();\n\n      autoSave.cancel();\n      self.saveSignature($canvas.toDataURL(\"image/png\")).always(function () {\n        self.setState(self.STATE_TYPE.edit);\n        bizagi.loading.stop();\n      });\n    } else {\n      self.setState(self.STATE_TYPE.edit);\n    }\n  },\n\n  /**\r\n      * Apply plugin\r\n      */\n  renderSignature: function renderSignature() {\n    var self = this;\n    var $container = self.getSignatureContainer();\n    var config = {\n      sizeRatio: 3,\n      cssclass: \"bz-signature__container-canvas\",\n      color: \"#000\" };\n\n\n    $container.empty();\n    $container.BzjSignature(config);\n    $container.BzjSignature(\"disable\");\n\n    if (self.pluginInitialized && self.properties.url) {\n      self.setSignature($container);\n    } else {\n      self.renderSignatureValue($container);\n    }\n\n    // Only apply for mobile\n    var $canvas = $(\".bz-signature__container-canvas\", $container);\n    var height = Math.round($canvas.width() / 2);\n\n    $canvas.attr(\"height\", height).css(\"height\", height);\n    $canvas.css(\"width\", \"100%\");\n\n    // Required for resize observer\n    self.pluginInitialized = true;\n  },\n\n  /**\r\n      * Set data to control\r\n      * @param $container\r\n      * @returns {*}\r\n      */\n  renderSignatureValue: function renderSignatureValue($container) {\n    var self = this;\n\n    bizagi.util.sleepUntil(function () {\n      return !self.dataService.getFileService().isLoading(self);\n    }).then(function () {\n      return self.buildItemUrl();\n    }).then(function (dataUrl) {\n      if (!self.isDisposed()) {\n        // Fake empty\n        if (dataUrl === self.BASE_IMAGE + self.EMPTY_IMAGE) {\n          dataUrl = \"\";\n        }\n\n        var url = dataUrl !== \"\" ? dataUrl : \"\";\n        self.properties.url = url;\n\n        if (!bizagi.util.isEmpty(url)) {\n          $container.BzjSignature(\"setData\", url);\n        } else {\n          self.setData(self.EMPTY_VALUE);\n        }\n      }\n    });\n  },\n\n  /**\r\n      * Execute upload image\r\n      * @param dataImage\r\n      * @returns {*}\r\n      */\n  postSignature: function postSignature(dataImage) {\n    var signature = dataImage.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\");\n\n    if (!this.isOfflineForm) {\n      return this.postSignatureOnline(signature);\n    }\n\n    return this.postSignatureOffline(signature);\n  },\n\n  /**\r\n      * Execute upload image for offline mode\r\n      * @param signature\r\n      * @returns {*}\r\n      */\n  postSignatureOffline: function postSignatureOffline(signature) {\n    var self = this;\n\n    return self.saveImageOffline(signature).then(function () {\n      self.properties.isChanged = true;\n      return signature;\n    });\n  },\n\n  /**\r\n      * Delete data image\r\n      * @returns {*}\r\n      */\n  deleteSignature: function deleteSignature() {\n    var self = this;\n\n    if (!self.isOfflineForm) {\n      return this.deleteImage().then(function () {\n        return self.EMPTY_VALUE;\n      });\n    }\n    return self.saveImageOffline(self.EMPTY_IMAGE).then(function () {\n      self.properties.isChanged = true;\n      return self.EMPTY_VALUE;\n    });\n  },\n\n  /**\r\n      * Builds the upload item url\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  buildItemUrl: function buildItemUrl(params) {\n    if (this.isOfflineForm) {\n      return this.buildItemUrlOffline(params);\n    } else {\n      return this._super(params);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the radio render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.radio.prototype);\n// Extends itself\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", {}, {\n\n  /**\r\n                                                                                     * Template method to implement in each device to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input[type=radio]\");\n\n    if (this.properties.editable && (this.value == null || this.value === undefined) && this.properties.value != null) {\n      this.value = this.properties.value;\n    }\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input\");\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var $control = self.getControl();\n\n    // Map data from actions\n    value = self.mapValue(value);\n\n    // Set internal value\n    self.setValue(value, false);\n\n    if (value !== undefined && value.id != null && value.id !== \"\") {\n\n      if (this.properties.editable) {\n\n        var radioItem = $control.\n        find('input[type=\"radio\"][value=\"' + value.id + '\"]');\n\n        radioItem.prop('checked', 'checked');\n      } else {\n        self.radio.val(this.getDisplayValue());\n        self.radio.attr(\"id\", value.id);\n      }\n    }\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    this.radio.change(function () {\n      var $selected = $(this);\n\n      var newValue = {\n        id: $selected.prop('value'),\n        value: $.trim($selected.siblings(\"label\").text()) };\n\n\n      self.setValue(newValue);\n    });\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\"label.bz-radio__label, .bz-input.bz-input--readonly\", context);\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    var value = { id: \"\", label: \"\" };\n    this.setValue(value, false);\n\n    this.clearDisplayValue();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    if (this.properties.editable) {\n      this.radio.prop('checked', false);\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Returns the selected value in the template\r\n      * @returns {*}\r\n      */\n  getSelectedValue: function getSelectedValue() {\n    return this.selectedValue;\n  } });","/**\r\n*   Name: BizAgi Smartphone Render Cascading combo Extension\r\n*   Author: Forms team\r\n*   Comments:\r\n*   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX },\n{\n\n  /*\r\n  *   Template method to implement in each children to customize each control\r\n  */\n  renderControl: function renderControl() {\n    var mode = this.getMode();\n\n    // Check if this is a dependant combo\n    this.parentCombo = this.getParentCombo();\n    if (this.parentCombo != null) {\n\n      if (/cascadingcombo/i.test(this.parentCombo.properties.type)) {\n        this.isDependant = true;\n      }\n    }\n\n    // Apply element plugin, set a flag to avoid dependant combo ajax requests\n    this.initializingCascadingCombo = true;\n\n    if (mode != \"execution\") {\n      this.initializingCascadingCombo = false;\n    }\n\n    return bizagi.rendering.smartphone.combo.prototype.renderControl.apply(this, arguments);\n  },\n\n  postRender: function postRender() {\n    bizagi.rendering.smartphone.combo.prototype.postRender.apply(this, arguments);\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    // Call base\n    this._super();\n\n    // Call desktop.combo method\n    bizagi.rendering.smartphone.combo.prototype.configureHandlers.apply(this, arguments);\n  },\n\n  /**\r\n      * Override to avoid the trigguer\r\n      */\n  cleanData: function cleanData() {\n    bizagi.rendering.smartphone.combo.prototype.cleanData.apply(this, arguments);\n  },\n\n  /*\r\n     *   Refresh the combo, after it has been painted\r\n     */\n  refresh: function refresh(params, isInitialValue) {\n    var self = this;\n    // Wait until current element is rendered\n    $.when(self.isRendered()).done(function () {\n      // Clear current control\n      var control = self.getControl();\n      var mode = self.getMode();\n      control.empty();\n\n      // Render combo again\n      $.when(self.renderControl()).then(function (html) {\n        // Append new element\n        control.html(html);\n        // Post-render method\n        self.postRender();\n\n        if (mode == \"execution\") {\n          self.configureHandlers();\n        }\n\n        // Set current value\n        if (isInitialValue) {\n          self.setDisplayValue(self.getValue());\n        } else {\n          self.setDisplayValue({\n            \"id\": \"\",\n            \"value\": \"\" });\n\n        }\n\n        if (self.deferredVisible) {\n          self.deferredVisible.resolve();\n        }\n\n        self.trigger(\"select\", [self.getValue(), isInitialValue]);\n      });\n    });\n  },\n  /*\r\n     *   Sets the value in the rendered control\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n    bizagi.rendering.smartphone.combo.prototype.setDisplayValue.apply(this, arguments);\n  },\n\n  processComboData: function processComboData() {\n    bizagi.rendering.smartphone.combo.prototype.processComboData.apply(this, arguments);\n  },\n\n  validateValue: function validateValue() {\n    return bizagi.rendering.smartphone.combo.prototype.validateValue.apply(this, arguments);\n  },\n\n  renderComboTemplate: function renderComboTemplate() {\n    return bizagi.rendering.smartphone.combo.prototype.renderComboTemplate.apply(this, arguments);\n  },\n\n  configureModalViewHandlers: function configureModalViewHandlers() {\n    bizagi.rendering.smartphone.combo.prototype.configureModalViewHandlers.apply(this, arguments);\n  },\n\n  configureCombo: function configureCombo() {\n    bizagi.rendering.smartphone.combo.prototype.configureCombo.apply(this, arguments);\n  },\n\n  changeCombo: function changeCombo(valueItem, valueObjet) {\n    bizagi.rendering.smartphone.combo.prototype.changeCombo.apply(this, arguments);\n  },\n\n  /*\r\n     *   Returns the selected value in the template\r\n     */\n  getSelectedValue: function getSelectedValue() {\n    return bizagi.rendering.smartphone.combo.prototype.getSelectedValue.call(this, arguments);\n  },\n\n  getTemplateName: function getTemplateName() {\n    return \"combo\";\n  },\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n    return bizagi.rendering.smartphone.combo.prototype.filterList.call(this, search, $li);\n  } });","/**\r\n *   Name: Bizagi Smartphone Collection Navigator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the collection Navigator class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\n// Extends itself\nbizagi.rendering.smartphone.collectionnavigator.extend(\"bizagi.rendering.smartphone.collectionnavigator\", {}, {\n\n  /**\r\n                                                                                                                 * Method to customize each render after processed\r\n                                                                                                                 */\n  postRender: function postRender() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  } });","/**\r\n *   Name: Bizagi Smartphones Render Hidden Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.hidden\", bizagi.rendering.hidden.prototype);\n// Extends itself\nbizagi.rendering.smartphone.hidden.extend(\"bizagi.rendering.smartphone.hidden\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.upload\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.upload.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"] },\n{\n  /**\r\n   * Whether or not is a native device\r\n   * @var isNative boolean\r\n   */\n  isNative: false,\n\n  /**\r\n                    * Whether or not we are offline\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n  },\n\n  /**\r\n      * Template method to implement in each children to customize each control\r\n      * @returns {}\r\n      */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"upload\");\n\n    return this.renderItem(template, {});\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"upload-readonly\");\n    var data = {\n      noFiles: this.filesCount === 0 };\n\n\n    return this.renderItem(template, data);\n  },\n\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.filesCount; i++) {\n      var file = { id: self.files[i][0], fileName: self.files[i][1] };\n      var item = self.renderUploadItem(file);\n      items += item;\n    }\n\n    html = self.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$contentFile = $(\".bz-file-upload__container\", $control);\n    this.$inputFile = $(\".bz-file-upload__input\", $control);\n    this.$nativeFile = $(\".bz-file-upload__native\", $control);\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.checkFileExtensions();\n    this.attachEvents();\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download a file\n    $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n    var counterChoseFiles = 0;\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      if (!self.isNative || counterChoseFiles > 0) {\n        self.chooseFile();\n      } else {\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-upload-error-files-extension-supported-app\", \"You can only add images or videos.\"), 'Userfield error');\n      }\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      self.removeFile(item, file.id);\n    });\n\n    if (self.isNative) {\n      // Upload files\n      var actions = self.getUploadChoices();\n      counterChoseFiles = actions.length;\n      this.$nativeFile.off(\"click\").actionSheet({\n        actions: actions,\n        actionClicked: function actionClicked(action) {\n          self.handlerUploadFile(action.guid);\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n\n      // Resolution upload\n      $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\n        actions: bizagi.util.media.getImageResolutionSizes(),\n        withoutCancel: true,\n        actionClicked: function actionClicked(action) {\n          bizagi.loading.start();\n\n          $.when(self.handlerResolutionUpload(action.guid)).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n    } else {\n\n      // Attach event to web upload-control\n      this.$inputFile.off(\"change\").on(\"change\", function () {\n        self.addFile();\n        this.value = \"\";\n      });\n\n      // Just in case\n      this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n        evt.stopPropagation();\n      });\n    }\n  },\n\n  /**\r\n      * Handler of upload files\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    switch (actionSelected) {\n      case 2:\n\n        navigator.camera.getPicture(function (dataImage) {\n          self.dataImage = dataImage;\n          var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n          then(function () {\n            //Gets the real properties for the file\n            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n            then(function (fileData) {\n              self.fileProperties = fileData;\n\n              if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n                // \"new Blob\" constructor is not supported in android version 4.2.2\n                var version = bizagi.util.getAndroidVersion();\n\n                if (!bizagi.util.isAndroid()) {\n                  return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\n                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                      return self.handlerResolutionUpload(buttonIndex);\n                    }\n                  });\n\n                } else {\n                  // Force click to show actionSheet menu\n                  $(\".bz-file-upload__resolution\", self.getControl()).click();\n                }\n              }\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\n          correctOrientation: true });\n\n        break;\n      case 1:\n        navigator.camera.getPicture(function (dataImage) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n              self.fileProperties = fileData;\n              return self.saveImage(dataImage);\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: navigator.camera.PictureSourceType.CAMERA,\n          mediaType: navigator.camera.MediaType.PICTURE,\n          destinationType: Camera.DestinationType.FILE_URI,\n          correctOrientation: true,\n          targetWidth: 1280,\n          targetHeight: 960 });\n\n        break;\n      case 3:\n        navigator.device.capture.captureVideo(function (dataVideo) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties)).\n          then(function () {\n            return self.saveVideo(dataVideo);\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), { limit: self.Class.LIMIT });\n        break;}\n\n  },\n\n  /**\r\n      * Handler of resolution upload\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerResolutionUpload: function handlerResolutionUpload(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.saveImage(self.dataImage);\n    } else {\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.saveImage(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      * @param {} dataImage\r\n      */\n  saveImage: function saveImage(dataImage) {\n    var self = this;\n    var dataItem = \"\";\n\n    if (self.editedImageURL) {\n      dataItem = self.editedImageURL;\n    } else if (self.fileProperties) {\n      dataItem = self.fileProperties.url;\n    }\n\n    // Fix android 4.4 getting images from recent folder\n    var dataFile = bizagi.util.media.getImagePath(dataItem);\n    var data = {\n      dataFile: dataFile,\n      fileName: self.fileProperties.name,\n      mimeType: \"image/jpeg\" };\n\n\n    // Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a video file\r\n      * @param {} dataVideo\r\n      * @returns {}\r\n      */\n  saveVideo: function saveVideo(dataVideo) {\n    var data = {\n      dataFile: dataVideo[0].fullPath,\n      fileName: dataVideo[0].name,\n      mimeType: \"video/quicktime\" };\n\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a file\r\n      * @param data\r\n      * @returns {*|void}\r\n      */\n  uploadFile: function uploadFile(data) {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = data.fileName;\n    params.options.uploadKey = { key: addParams[\"h_xpath\"] };\n    params.options.addUrl = self.properties.addUrl;\n    params.dataFile = data.dataFile;\n\n    if (data.mimeType)\n    params.options.mimeType = data.mimeType;\n\n    return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\n      var response = JSON.parse(decodeURIComponent(result.response));\n\n      if (response.type === \"error\") {\n        bizagi.showMessageBox(response.message, response.errorType);\n      } else {\n        self.onUploadFileCompleted(response);\n      }\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * onFail\r\n      * @param {} error\r\n      */\n  onFail: function onFail(error) {\n    var messageError = bizagi.util.processFailMessage(error);\n\n    bizagi.loading.stop();\n\n    if (messageError && typeof messageError === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\n      var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\n      var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\n\n      bizagi.showMessageBox(message);\n    }\n  },\n\n  /**\r\n      * onUploadFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadFileCompleted: function onUploadFileCompleted(result) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    if (result.id && result.fileName) {\n      // Locate it before the upload wrapper\n      var newItem = self.renderUploadItem(result);\n      $wrapper.append(newItem);\n\n      // Increment counter\n      self.filesCount = self.filesCount + 1;\n\n      // Copy the files value but not its reference\n      var files = self.files.slice();\n\n      //Add the new item to this temporal array\n      files.push([result.id, result.fileName]);\n\n      // Update value\n      self.setValue(files, true);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n\n      self.editedImageURL = null;\n    } else {\n      bizagi.showMessageBox(result.message, \"Error\");\n    }\n  },\n\n  /**\r\n      * Check maximum number of files\r\n      */\n  checkMaxFiles: function checkMaxFiles() {\n    if (this.isMaxFilesReached()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    } else {\n      $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    var actualFiles = this.properties.value ? this.properties.value.length : 0;\n\n    return maxFiles !== 0 && this.filesCount >= maxFiles && actualFiles >= maxFiles;\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions = { video: true, image: true, file: true };\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.video = true;\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.file = true;\n          } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.video = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !self.isNative && (!bizagi.util.media.fileAPISupported() || self.isOfflineForm)) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n\n    // Build add params to send to the server\n    formData.append(prefix + \"xpath\", self.getUploadXpath());\n    formData.append(prefix + \"idRender\", self.properties.id);\n    formData.append(prefix + \"xpathContext\", self.properties.xpathContext);\n    formData.append(prefix + self.Class.BA_PAGE_CACHE, self.properties.idPageCache);\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n    formData.append(self.properties.xpath, dataFile);\n\n    if (self.properties.contexttype)\n    formData.append(prefix + \"contexttype\", self.properties.contexttype);\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(dataFile) {\n    var data = {\n      url: this.properties.addUrl,\n      formData: this.buildAddFileParams(dataFile) };\n\n\n    return this.dataService.processUploadFile(data);\n  },\n\n  /*\r\n     * Cleans current value\r\n     */\n  cleanData: function cleanData() {\n    return this.clearDisplayValue();\n  },\n  /**\r\n      * Remove data of file upload\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n    var items = $(\".bz-files\", self.getControl());\n    var promises = [];\n\n    $(\".bz-file\", items).each(function (index, item) {\n      item = $(item);\n      var file = item.data();\n\n      promises.push($.when(self.removeFile(item, file.id)));\n    });\n\n    return $.when.apply($, promises).then(function () {\n      return self.getValue();\n    });\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    var self = this;\n    var itemsUpload = [];\n\n    // Take photo, Choose photo\n    if (self.validOptions.image) {\n      itemsUpload.push({\n        \"guid\": 1,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\n\n      itemsUpload.push({\n        \"guid\": 2,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\n\n    }\n\n    // Take video\n    if (self.validOptions.video) {\n      itemsUpload.push({\n        \"guid\": 3,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\n\n    }\n\n    // Stores the upload options        \n    return [].concat(itemsUpload);\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var errorResponse = \"\";\n\n    if (error && error.responseText) {\n      errorResponse = error.responseText;\n    } else {\n      errorResponse = bizagi.localization.getResource(\"workportal-general-error\");\n    }\n\n    this.getFormContainer().failHandler(errorResponse);\n  },\n\n  /**\r\n      * Method to add new file from native or hybrid environment\r\n      */\n  chooseFile: function chooseFile() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported() && !this.isOfflineForm) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Method to add new file\r\n      */\n  addFile: function addFile() {\n    var self = this;\n    var dataFile = this.$inputFile[0].files[0];\n    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n\n      $.when(self.processUploadFile(dataFile)).\n      then(function (result) {\n        self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  /**\r\n      * Method to remove item\r\n      * @param item\r\n      * @param id\r\n      */\n  removeFile: function removeFile(item, id) {\n    var self = this;\n\n    return $.when(self.deleteUploadItem(item, id)).done(function () {\n      // Remove item\n      item.hide();\n      item.remove();\n\n      // Update value\n      self.setValue(self.files, false);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n\n      // Trigger change\n      self.triggerRenderChange();\n    });\n  },\n\n  /**\r\n      * Template for upload items\r\n      */\n  getTemplateItemName: function getTemplateItemName() {\n    return \"upload-item\";\n  },\n\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\".bz-input-icon__input\", context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render upload Extension\r\n *   Author: Mobile SWAT Team\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload.offline\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"] },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data\r\n   */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\n    var maxFileSizeOfUser = typeof BIZAGI_SETTINGS !== \"undefined\" && typeof BIZAGI_SETTINGS.UploadMaxFileSize !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\n\n    this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\n\n    this.updateFilesCount();\n    this.updateOriginalValue();\n  },\n\n  /*\r\n     *   Updates original value for some comparisons\r\n     */\n  updateOriginalValue: function updateOriginalValue() {\n    var self = this;\n    self.properties.originalValue = bizagi.clone(self.properties.value);\n  },\n\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.files.length; i++) {\n      var file = self.files[i];\n      if (file.status && file.status !== \"deleted\" && file.status !== \"new-deleted\") {\n        var item = self.renderUploadItem(file, i);\n        items += item;\n      }\n    }\n\n    html = self.replaceFilesHtml(html, items);\n    return html;\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.openOfflineFile(item);\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      if (self.isNative)\n      self.$nativeFile.click();else\n\n      self.$inputFile.click();\n      self.$inputFile.off(\"change\").on(\"change\", function () {\n        self.handlerWebUploadFile();\n      });\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.openOfflineFile(item);\n    });\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.removeOfflineFile(item);\n    });\n\n    if (self.isNative) {\n      self.attachNativeEvents();\n    }\n  },\n\n  attachNativeEvents: function attachNativeEvents() {\n    var self = this;\n\n    // Upload files\n    this.$nativeFile.off(\"click\").actionSheet({\n      actions: self.getUploadChoices(),\n      actionClicked: function actionClicked(action) {\n        self.handlerUploadFile(action.guid);\n      },\n\n      appear: function appear() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      cancelClicked: function cancelClicked() {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      } });\n\n  },\n\n  //Only should be used for testing purposes\n  handlerWebUploadFile: function handlerWebUploadFile() {\n    var self = this;\n    var dataFile = self.$inputFile[0].files[0];\n\n    var fileId = bizagi.util.randomNumber();\n    var fileName, mimeType;\n    self.$inputFile[0].value = \"\";\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties)) {\n      return self.dataService.getFileService().resolveBlobFromPath(dataFile).\n      then(function (blob) {\n        bizagi.loading.start();\n        mimeType = blob.type;\n        fileName = blob.name;\n        return self.saveOfflineFile(blob, fileId, mimeType);\n      }).then(function () {\n        self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    }\n  },\n\n  /**\r\n      * Handler of upload image\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n    switch (actionSelected) {\n      case 2: // Choose photo\n        self.choosePhoto();\n        break;\n      case 1: // Take photo\n        self.takePhoto();\n        break;\n      default:\n        console.log(\"The option is not supported!\");\n        break;}\n\n  },\n\n  choosePhoto: function choosePhoto() {\n    var self = this;\n    navigator.camera.getPicture(function (dataImage) {\n      self.dataImage = dataImage;\n      var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n      then(function () {\n        //Gets the real properties for the file\n        return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n        then(function (fileData) {\n          self.fileProperties = fileData;\n          if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n            return self.saveImage(self.dataImage);\n          }\n        });\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n\n    }, self.onFail.bind(self), {\n      quality: self.Class.QUALITY_PICTURE,\n      sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\n      correctOrientation: true });\n\n  },\n\n  takePhoto: function takePhoto() {\n    var self = this;\n    navigator.camera.getPicture(function (dataImage) {\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n        return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n          self.fileProperties = fileData;\n          return self.saveImage(dataImage);\n        });\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    },\n    self.onFail.bind(self), {\n      quality: self.Class.QUALITY_PICTURE,\n      sourceType: navigator.camera.PictureSourceType.CAMERA,\n      mediaType: navigator.camera.MediaType.PICTURE,\n      destinationType: Camera.DestinationType.FILE_URI,\n      correctOrientation: true,\n      targetWidth: 1280,\n      targetHeight: 960 });\n\n  },\n\n  /**\r\n      * Add the interactions to the upload control items\r\n      * @return {}\r\n      */\n  addInteractions: function addInteractions() {\n    var self = this;\n    var control = self.getControl();\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", control).on(\"click\", \".bz-file .bz-file__delete\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.removeOfflineFile(item);\n    });\n  },\n\n  /**\r\n      * Collect Data\r\n      * @param {} renderValues\r\n      * @returns {}\r\n      */\n  collectData: function collectData(renderValues) {\n    var self = this;\n\n\n    if (bizagi.util.identicalObjects(self.properties.originalValue, self.files)) {\n      return;\n    }\n    renderValues[self.properties.xpath] = self.files;\n\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      * @param {} dataImage\r\n      */\n  saveImage: function saveImage(dataImage) {\n    var self = this;\n    bizagi.loading.start();\n\n    var fileId = bizagi.util.randomNumber();\n    var fileName = self.fileProperties.name;\n    var mimeType;\n\n    //TODO: SWAT Check if the file already exists\n    $.when(self.dataService.getFileService().resolveBlobFromPath(dataImage, fileName)).\n    always(function () {\n      bizagi.loading.stop();\n    }).\n    then(function (blob) {\n      mimeType = blob.type;\n      fileName = blob.name;\n      return self.saveOfflineFile(blob, fileId, mimeType);\n    }).then(function (saveResponse) {\n      self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);\n    });\n    self.$inputFile[0].value = \"\";\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * Only support to image in offline capability\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions.image = true;\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.image) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !bizagi.util.media.fileAPISupported()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * onUploadOfflineFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadOfflineFileCompleted: function onUploadOfflineFileCompleted(fileName, mimeType, fileId) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    var fileUploaded = {\n      id: fileId,\n      fileName: fileName,\n      mimeType: mimeType,\n      status: \"new\" };\n\n\n    // Locate it before the upload wrapper\n    var newItem = self.renderUploadItem(fileUploaded, self.files.length);\n    $wrapper.append(newItem);\n\n    // Increment counter\n    self.filesCount = self.filesCount + 1;\n\n    // Copy the files value but not its reference\n    var files = self.files.slice();\n\n    //Add the new item to this temporal array\n    files.push(fileUploaded);\n\n    // Update value\n    self.setValue(files, false);\n\n    // Check maxFiles\n    self.checkMaxFiles();\n\n    // Trigger change\n    self.triggerRenderChange();\n  },\n\n  /**\r\n      * Renders a single upload item\r\n      * @param file\r\n      * @returns {*|jQuery}\r\n      */\n  renderUploadItem: function renderUploadItem(file, index) {\n    var self = this;\n    var itemTemplate = self.getTemplateItemName();\n    var template = self.renderFactory.getTemplate(itemTemplate);\n\n    var html = $.fasttmpl(template, {\n      url: \"javascript:void(0);\",\n      id: file.id,\n      allowDelete: self.properties.allowDelete || false,\n      filename: file.fileName,\n      index: index });\n\n\n    return html;\n  },\n\n  /**\r\n      * This render cannot be sent because it is full ajax\r\n      * @returns {}\r\n      */\n  canBeSent: function canBeSent() {\n    return true;\n  },\n\n  /**\r\n      * Fail action\r\n      * @param {} evt\r\n      * @returns {}\r\n      */\n  failReadFile: function failReadFile(evt) {\n    try {\n      bizagi.log(\"Error code: \" + evt.target.error.code);\n    } catch (e) {\n    }\n  },\n\n  /**\r\n      * Fail action\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  onFail: function onFail(error) {\n    this._super(error);\n  },\n\n  /**\r\n      * Method to remove item\r\n      * @param item\r\n      * @param id\r\n      */\n  removeOfflineFile: function removeOfflineFile(item) {\n    var self = this;\n    var file = item.data();\n    var fileIndex = file.index;\n\n    // Mark the file as deleted\n    var fileValue = self.files[fileIndex];\n    if (!fileValue) {\n      //Nothing to do\n      return;\n    }\n    if (fileValue.status !== \"new\") {\n      fileValue.status = \"deleted\";\n    } else {\n      fileValue.status = \"new-deleted\";\n    }\n\n    // Remove item\n    item.hide();\n    item.remove();\n\n    // Update value\n    self.setValue(self.files, false);\n\n    // Check maxFiles\n    self.checkMaxFiles();\n\n    // Trigger change\n    self.triggerRenderChange();\n  },\n\n  /**\r\n      * Update the filesCount attribute based on the status (new|deleted) of each file\r\n      */\n  updateFilesCount: function updateFilesCount() {\n    var self = this;\n    var files = this.properties.value || [];\n\n    for (var i = 0; i < files.length; i++) {\n      var status = files[i].status;\n      if (status && status.includes(\"deleted\")) {\n        self.filesCount = self.filesCount - 1;\n      }\n    }\n  },\n\n  /**\r\n      * Sets the internal value\r\n      * @param value\r\n      * @param triggerEvents\r\n      */\n  setValue: function setValue(value, triggerEvents) {\n    var self = this;\n    self._super(value, triggerEvents);\n    self.updateFilesCount();\n    if (self.filesCount === 0) {\n      self.properties.method = \"delete\";\n    }\n  },\n\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    return maxFiles !== 0 && this.filesCount >= maxFiles;\n  },\n\n  openOfflineFile: function openOfflineFile(item) {\n    var self = this;\n    var file = item.data();\n    var dataIndex = file.index;\n    var selectedValue = typeof dataIndex == \"number\" ? self.properties.value[dataIndex] : null;\n    if (selectedValue) {\n      var formParams = self.getFormParams();\n      var getFileParams = {\n        idCase: formParams.idCase,\n        idWorkitem: formParams.idWorkitem,\n        id: (self.properties.xpathContext ? self.properties.xpathContext + \".\" : \"\") +\n        self.properties.xpath + '.' + selectedValue.id,\n        offlineType: formParams.offlineType };\n\n      bizagi.loading.start();\n      $.when(self.dataService.getOfflineFile(getFileParams, \"blob\", selectedValue.mimeType)).\n      then(function (binaryFile) {\n        if (binaryFile != undefined) {\n          var fileName = file.title;\n          var url = fileName || \"downloaded.jpg\";\n          if (bizagi.util.isAndroidDevice()) {\n            bizagi.util.media.handleBinaryFile(binaryFile, fileName, url);\n          } else {\n            bizagi.util.media.handleBinaryFile(binaryFile, fileName);\n          }\n        }\n      }).\n      fail(function (error) {\n        console.log(\"Error opening offline file\", error);\n      }).\n      always(function () {\n        bizagi.loading.stop();\n      });\n    }\n  },\n\n  saveOfflineFile: function saveOfflineFile(blobFile, fileId, mimeType) {\n    var self = this;\n    var formParams = self.getFormParams();\n    var parameters = {\n      idCase: formParams.idCase,\n      idWorkitem: formParams.idWorkitem,\n      id: (self.properties.xpathContext ? self.properties.xpathContext + \".\" : \"\") +\n      self.properties.xpath + '.' + fileId,\n      operationType: \"edition\",\n      offlineType: formParams.offlineType };\n\n    return self.dataService.saveOfflineFile(parameters, blobFile, mimeType);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render ECM Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the ecm render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.ecm\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.ecm.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.ecm.extend(\"bizagi.rendering.smartphone.ecm\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"],\n  ERROR_ECM_NO_AVAILABLE: 3,\n  ACTION_DETAILS: \"details\",\n  ACTION_EDIT: \"edit\" },\n{\n\n  /**\r\n   * Whether or not is a native device\r\n   * @var isNative boolean\r\n   */\n  isNative: false,\n\n  /**\r\n                    * Update or init the element data\r\n                    * @param {} data\r\n                    */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    this.isNative = bizagi.util.isCordovaSupported();\n    this.fileData = [];\n  },\n\n  /**\r\n      * Method to customize each control\r\n      * @returns {}\r\n      */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(\"ecm\");\n\n    // Set files property\n    self.files = self.properties.value || [];\n    self.filesCount = self.files.length;\n\n    return this.renderItem(template, {});\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"ecm-readonly\");\n    var data = {\n      noFiles: this.filesCount === 0 };\n\n\n    return this.renderItem(template, data);\n  },\n\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.filesCount; i++) {\n      var item = self.renderUploadItem(self.files[i]);\n\n      items += item;\n    }\n\n    html = self.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Renders a single upload item\r\n      * @param file\r\n      * @returns {*}\r\n      */\n  renderUploadItem: function renderUploadItem(file) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"ecm-item\");\n    var form = self.getFormContainer();\n\n    var data = {\n      id: self.properties.id,\n      idFileUpload: file[0],\n      fileName: file[1],\n      editable: self.properties.editable,\n      xPath: self.properties.xpath,\n      xpathContext: self.getXpathContext() || form.properties.xpathContext || \"\",\n      idPageCache: self.properties.idPageCache,\n      idAttrib: self.properties.idAttrib,\n      sessionId: form.properties.sessionId };\n\n\n    // Builds the upload item url\n    var originalData = $.extend({}, data);\n    data.url = self.buildItemUrl(originalData);\n\n    // Define File Properties\n    file.getFileProperties = $.when(self.renderFileLayout(data));\n\n    var html = $.fasttmpl(template, data);\n\n    return html;\n  },\n\n  /**\r\n      * Method to get properties and metadata of ECM item\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  renderFileLayout: function renderFileLayout(data) {\n    var self = this;\n    var form = self.getFormContainer();\n    var deferred = new $.Deferred();\n\n    var originalData = $.extend({}, data);\n\n    $.when(\n    self.dataService.metadataECMMultiaction().getECMMetadata(data),\n    self.dataService.metadataECMMultiaction().getFileProperties(originalData)).\n    done(function (metaData, fileProperties) {\n\n      if (Array.isArray(fileProperties)) {\n        fileProperties = fileProperties[0];\n      }\n\n      if (Array.isArray(metaData)) {\n        metaData = metaData[0];\n      }\n\n      fileProperties.idAttrib = self.properties.idAttrib;\n      fileProperties.showMetadata = self.properties.showMetadata;\n      fileProperties.xpathContext = self.getXpathContext() || form.properties.xpathContext || \"\";\n      fileProperties.xpath = self.properties.xpath;\n      fileProperties.fileName = data.fileName;\n      fileProperties.idPageCache = self.properties.idPageCache;\n      fileProperties.fileData = originalData;\n\n      var result = $.extend({}, fileProperties, metaData);\n\n      deferred.resolve(result);\n\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n      * @param html\r\n      * @param replace\r\n      * @returns {*}\r\n      */\n  replaceFilesHtml: function replaceFilesHtml(html, replace) {\n    return html.replace(\"{{files}}\", replace);\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$contentFile = $(\".bz-file-upload__container\", $control);\n    this.$inputFile = $(\".bz-file-upload__input\", $control);\n    this.$nativeFile = $(\".bz-file-upload__native\", $control);\n  },\n\n  configureHandlers: function configureHandlers() {\n    this.checkFileExtensions();\n    this.attachEvents();\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download the file\n    $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      */\n  saveImage: function saveImage() {\n    var self = this;\n    var dataItem = \"\";\n\n    if (self.editedImageURL) {\n      dataItem = self.editedImageURL;\n    } else if (self.fileProperties) {\n      dataItem = self.fileProperties.url;\n    }\n\n    // Fix android 4.4 getting images from recent folder\n    var dataFile = bizagi.util.media.getImagePath(dataItem);\n    var data = {\n      dataFile: dataFile,\n      fileName: self.fileProperties.name,\n      mimeType: \"image/jpeg\" };\n\n\n    // Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a video file\r\n      * @param {} dataVideo\r\n      * @returns {}\r\n      */\n  saveVideo: function saveVideo(dataVideo) {\n    var data = {\n      dataFile: dataVideo[0].fullPath,\n      fileName: dataVideo[0].name,\n      mimeType: \"video/quicktime\" };\n\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a file\r\n      * @param data\r\n      * @returns {*|void}\r\n      */\n  uploadFile: function uploadFile(data) {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n    addParams[\"xPath\"] = addParams[\"xPath\"];\n    addParams.Filename = data.fileName;\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = data.fileName;\n    params.options.uploadKey = { key: \"Filedata\" };\n    params.options.addUrl = self.properties.addUrl;\n    params.dataFile = data.dataFile;\n\n    if (data.mimeType)\n    params.options.mimeType = data.mimeType;\n\n    return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\n      self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result.response)));\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handlers to management of menu actions\n    $.each(self.files, function (i, file) {\n      self.attackMenuEvents(file);\n    });\n\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      self.chooseFile();\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n\n\n    if (self.isNative) {\n      // Upload files\n      this.$nativeFile.off(\"click\").actionSheet({\n        actions: self.getUploadChoices(),\n        actionClicked: function actionClicked(action) {\n          self.handlerUploadFile(action.guid);\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n\n      // Resolution upload\n      $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\n        actions: bizagi.util.media.getImageResolutionSizes(),\n        withoutCancel: true,\n        actionClicked: function actionClicked(action) {\n          bizagi.loading.start();\n\n          $.when(self.handlerResolutionUpload(action.guid)).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n    } else {\n\n      // Attach event to web upload-control\n      this.$inputFile.off(\"change\").on(\"change\", function () {\n        self.addFile();\n        this.value = \"\";\n      });\n\n      // Just in case\n      this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n        evt.stopPropagation();\n      });\n    }\n  },\n\n  /**\r\n      * Update menu options\r\n      * @param $fileItem\r\n      * @param fileProperties\r\n      */\n  addMenuEvents: function addMenuEvents($fileItem, fileProperties) {\n    var self = this;\n    var viewMore = $fileItem.find(\".bz-file-menu\");\n    var items = [];\n\n    if (fileProperties.showMetadata) {\n      items.push({\n        name: self.getResource(\"render-collection-navigator-details-form\"),\n        fn: function fn() {\n          self.processActionByType(self.Class.ACTION_DETAILS, fileProperties, $fileItem);\n        } });\n\n    }\n\n    if (fileProperties.showMetadata && fileProperties.allowUpdateMetadata)\n    items.push({\n      name: self.getResource(\"render-collection-navigator-edit-form\"),\n      fn: function fn() {\n        self.processActionByType(self.Class.ACTION_EDIT, fileProperties, $fileItem);\n      } });\n\n\n    if (fileProperties.allowCheckOut) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-lock\"),\n        fn: function fn() {\n          self.lockECMFile($fileItem, fileProperties);\n        } });\n\n    }\n\n    if (fileProperties.allowCancelCheckOut) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-unlock\"),\n        fn: function fn() {\n          self.unlockECMFile($fileItem, fileProperties);\n        } });\n\n    }\n\n    /*if (fileProperties.allowUpdateContent) {\r\n          items.push({\r\n              name: self.getResource(\"render-ecm-bt-upgrade\"),\r\n              fn: function () {\r\n                  self.processActionByType(\"upgrade\", fileProperties);\r\n              }\r\n          });\r\n      }*/\n\n    if (fileProperties.allowDelete) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-delete\"),\n        fn: function fn() {\n          self.deleteECMFile($fileItem, fileProperties.idFileUpload);\n        } });\n\n    }\n\n    // TODO: Check items has data\n    viewMore.overflowMenu({ items: items });\n  },\n\n  /**\r\n      * Removes a file from the ECM control\r\n      * @param $fileItem\r\n      * @param fileId\r\n      */\n  deleteECMFile: function deleteECMFile($fileItem, fileId) {\n    var self = this;\n\n    bizagi.showConfirmationBox(this.getResource(\"render-ecm-confirm-message\")).\n    done(function () {\n      $.when(self.deleteUploadItem($fileItem, fileId)).\n      done(function () {\n        // Detach item\n        $fileItem.hide();\n        $fileItem.remove();\n\n        // Update value\n        self.setValue(self.files, false);\n\n        // Check maxFiles\n        self.checkMaxFiles();\n\n        // Trigger change\n        self.triggerRenderChange();\n      });\n    });\n  },\n\n  /**\r\n      * Check maximum number of files\r\n      */\n  checkMaxFiles: function checkMaxFiles() {\n    if (this.isMaxFilesReached()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    } else {\n      $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    var actualFiles = this.properties.value ? this.properties.value.length : 0;\n\n    return maxFiles !== 0 && this.filesCount >= maxFiles && actualFiles >= maxFiles;\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var errorResponse = \"\";\n\n    if (error && error.code === this.Class.ERROR_ECM_NO_AVAILABLE) {\n      errorResponse = this.getResource(\"render-ecm-service-not-available\");\n    } else if (error && error.responseText) {\n      errorResponse = error.responseText;\n    } else {\n      errorResponse = this.getResource(\"render-ecm-service-general-error\");\n    }\n\n    this.getFormContainer().failHandler(errorResponse);\n  },\n\n  lockECMFile: function lockECMFile($fileItem, fileProperties) {\n    var self = this;\n\n    $.when(self.lockUploadItem(fileProperties.idFileUpload)).done(\n    function (result) {\n      var file = [result.idFileUpload, fileProperties.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      $fileItem.replaceWith(newItem);\n      self.attackMenuEvents(file);\n    });\n  },\n\n  unlockECMFile: function unlockECMFile($fileItem, fileProperties) {\n    var self = this;\n\n    $.when(self.unlockUploadItem(fileProperties.idFileUpload)).\n    done(function (result) {\n      var file = [result.idFileUpload, fileProperties.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      $fileItem.replaceWith(newItem);\n      self.attackMenuEvents(file);\n    });\n  },\n\n  /**\r\n      * Method to add new file from native or hybrid environment\r\n      */\n  chooseFile: function chooseFile() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported()) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions = { video: true, image: true, file: true };\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.video = true;\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.file = true;\n          } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.video = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !self.isNative && !bizagi.util.media.fileAPISupported()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    var self = this;\n    var itemsUpload = [];\n\n    // Take photo, Choose photo\n    if (self.validOptions.image) {\n      itemsUpload.push({\n        \"guid\": 1,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\n\n      itemsUpload.push({\n        \"guid\": 2,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\n\n    }\n\n    // Take video\n    if (self.validOptions.video) {\n      itemsUpload.push({\n        \"guid\": 3,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\n\n    }\n\n    // Stores the upload options\n    return [].concat(itemsUpload);\n  },\n\n  /**\r\n      * Handler of upload files\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    switch (actionSelected) {\n      case 2:\n\n        navigator.camera.getPicture(function (dataImage) {\n          self.dataImage = dataImage;\n          var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n          then(function () {\n            // Gets the real properties for the file\n            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n            then(function (fileData) {\n              self.fileProperties = fileData;\n\n              if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n                if (!bizagi.util.isAndroid()) {\n                  return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\n                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                      return self.handlerResolutionUpload(buttonIndex);\n                    }\n                  });\n\n                } else {\n                  // Force click to show actionsheet menu\n                  $(\".bz-file-upload__resolution\", self.getControl()).click();\n                }\n              }\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: Camera.PictureSourceType.PHOTOLIBRARY });\n\n        break;\n      case 1:\n        navigator.camera.getPicture(function (dataImage) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n              self.fileProperties = fileData;\n              return self.saveImage(dataImage);\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: navigator.camera.PictureSourceType.CAMERA,\n          mediaType: navigator.camera.MediaType.PICTURE,\n          destinationType: Camera.DestinationType.FILE_URI,\n          correctOrientation: true,\n          targetWidth: 1280,\n          targetHeight: 960 });\n\n        break;\n      case 3:\n        navigator.device.capture.captureVideo(function (dataVideo) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties)).\n          then(function () {\n            return self.saveVideo(dataVideo);\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), { limit: self.Class.LIMIT });\n        break;}\n\n  },\n\n  /**\r\n      * Catch errors\r\n      * @param {} error\r\n      */\n  onFail: function onFail(error) {\n    var messageError = bizagi.util.processFailMessage(error);\n\n    bizagi.loading.stop();\n\n    if (messageError && typeof messageError === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\n      var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\n      var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\n\n      self.performValidationMessage(message);\n    }\n  },\n\n  /**\r\n      * Adds a validation message to the render\r\n      * @param message\r\n      */\n  performValidationMessage: function performValidationMessage(message) {\n    var fail = bizagi.util.processFailMessage(message);\n\n    bizagi.showMessageBox(fail);\n  },\n\n  /**\r\n      * Handler of resolution upload\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerResolutionUpload: function handlerResolutionUpload(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.saveImage(self.dataImage);\n    } else {\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\n\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.saveImage(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Method to add new file\r\n      */\n  addFile: function addFile() {\n    var self = this;\n    var dataFile = this.$inputFile[0].files[0];\n    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n\n      $.when(self.processUploadFile(dataFile)).done(function (result) {\n        if (!bizagi.util.isFailResponse(result)) {\n          self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\n        } else {\n          self.performValidationMessage(result);\n        }\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n    var data = self.buildAddParams();\n\n    // Build add params to send to the server\n    var keys = Object.keys(data);\n\n    keys.map(function (key) {\n      formData.append(key, data[key]);\n    });\n\n    formData.append(\"Filedata\", dataFile);\n    formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1));\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n\n    if (self.properties.contexttype)\n    formData.append(prefix + \"contexttype\", self.properties.contexttype);\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(dataFile) {\n    var data = {\n      url: this.properties.addUrl,\n      formData: this.buildAddFileParams(dataFile) };\n\n\n    return this.dataService.processUploadFile(data);\n  },\n\n  /**\r\n      * onUploadFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadFileCompleted: function onUploadFileCompleted(result) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    if (result.idFileUpload && result.fileName) {\n      var file = [result.idFileUpload, result.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      // Locate it before the upload wrapper\n      $wrapper.append(newItem);\n\n      // Copy the files value but not its reference\n      var files = self.files.slice();\n\n      //Add the new item to this temporal array\n      files.push(file);\n\n      // Update value\n      self.setValue(files, true);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n      self.attackMenuEvents(file);\n\n      self.editedImageURL = null;\n    } else {\n      self.performValidationMessage(result.message);\n    }\n  },\n\n  attackMenuEvents: function attackMenuEvents(file) {\n    var self = this;\n    var $control = self.getControl();\n\n    if (file && file.getFileProperties) {\n      $.when(file.getFileProperties).done(function (fileProperties) {\n        // TODO: Fail scenario...\n        var $fileItem = $(\".\" + self.properties.id + \"-\" + fileProperties.idFileUpload, $control);\n\n        self.fileData[fileProperties.idFileUpload] = fileProperties.metadata || [];\n        self.addMenuEvents($fileItem, fileProperties);\n      });\n    }\n  },\n\n  processActionByType: function processActionByType(type, fileData, $fileItem) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n\n    bizagi.loading.start();\n\n    // Instantiate slide form object\n    var slideView = new bizagi.rendering.smartphone.slide.ecm(self.dataService, self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      container: form.container,\n      navigation: self.getParams().navigation,\n      editable: properties.editable && type !== self.Class.ACTION_DETAILS,\n      orientation: properties.orientation || \"ltr\",\n      onSave: function onSave(result) {\n        if (result.update) {\n          var file = [result.idFileUpload, result.fileName];\n          var newItem = self.renderUploadItem(file);\n\n          $fileItem.replaceWith(newItem);\n          self.attackMenuEvents(file);\n        }\n      },\n      onCancel: function onCancel() {\n        // console.log(\"CANCEL\");\n      } });\n\n\n    slideView.render({ metadata: fileData.metadata, fileData: fileData }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\n\n// Extends from Grid Smartphone base\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.grouped\", {}, {\n\n  /**\r\n                                                                                           * Method to customize each render after processed\r\n                                                                                           */\n  postRender: function postRender() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  isValidGrid: function isValidGrid(invalidElements) {\n    return this._super(invalidElements);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.letter\", bizagi.rendering.letter.prototype);\n// Extends itself\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.letter\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Button Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.button\", bizagi.rendering.button.prototype);\n// Extends itself\nbizagi.rendering.smartphone.button.extend(\"bizagi.rendering.smartphone.button\", {}, {\n\n  /**\r\n                                                                                       * Whether or not we are offline 'Just a shortcut\r\n                                                                                       * @var isOfflineForm boolean\r\n                                                                                       */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if the form is offline\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    $(\":button\", self.getControl()).on(\"click\", function () {\n      self.processButton();\n    });\n  },\n\n  /**\r\n      * In offline forms the button only works for actions and validations\r\n      * @returns {boolean|*}\r\n      */\n  executeButton: function executeButton() {\n    if (!this.isOfflineForm) {\n      return this._super();\n    } else {\n      // returns false to prevent form refreshing\n      return false;\n    }\n  },\n\n  /**\r\n      * Process the button actions workflow\r\n      * @returns {}\r\n      */\n  processButton: function processButton() {\n    var self = this;\n\n    if (self.properties.editable) {\n\n      // Check if action need conformation\n      if (self.properties.needsUserConfirmation) {\n        $.when(bizagi.showConfirmationBox(self.properties.userConfirmationMessage, \"Bizagi\", \"warning\")).\n        done(function () {\n          if (!self.properties.preventDefault)\n          self.runButtonAction();\n          // Trigger change\n          self.triggerRenderChange({ pressed: true });\n        });\n      } else {\n        if (!self.properties.preventDefault)\n        self.runButtonAction();\n\n        // Trigger change\n        self.triggerRenderChange({ pressed: true });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"button\", $context);\n  },\n\n  /**\r\n      * Customizes the font weight\r\n      * @param {} $label\r\n      * @param {} bold\r\n      * @returns {}\r\n      */\n  changeFontBold: function changeFontBold($label, bold) {\n    if (bizagi.util.parseBoolean(bold)) {\n      $label.css(\"font-weight\", \"bold\");\n    }\n\n    return this;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.fileprint\", bizagi.rendering.fileprint.prototype);\n// Extends itself\nbizagi.rendering.smartphone.fileprint.extend(\"bizagi.rendering.smartphone.fileprint\", {}, {\n\n  /**\r\n                                                                                             * method to customize each render after processed\r\n                                                                                             */\n  postRender: function postRender() {\n    this.getControl().parent().hide();\n  } });","/**\r\n *   Name: Bizagi smartphone Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphoe devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.link\", bizagi.rendering.link.prototype);\n// Extends itself\nbizagi.rendering.smartphone.link.extend(\"bizagi.rendering.smartphone.link\", {}, {\n\n  /**\r\n                                                                                   * Template method to implement in each device to customize each render after processed\r\n                                                                                   * @returns {}\r\n                                                                                   */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.link = $control.find(\".bz-link\");\n\n    this._super();\n\n    this.preventDefaultForAnchorTag();\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.link = $control.find(\".bz-link\");\n\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // Set internal value\n    this.setValue(value, false);\n\n    if (this.isValidValue()) {\n      // Get the decoded version of the URL\n      value = getFullyDecodedURI($.trim(value));\n\n      this.link.attr(\"href\", value);\n    }\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Configure event handlers\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n\n    if (self.isValidValue()) {\n      self.link.on(\"click\", function (evt) {\n        evt.preventDefault();\n        evt.stopPropagation();\n\n        var linkEncode = encodeURI(this.getAttribute(\"href\"));\n\n        self.linkSolver(linkEncode, self.properties.linktarget);\n      });\n    } else {\n      self.link && self.link.addClass(\"bz-link--disabled\");\n    }\n  },\n\n  /**\r\n      * Checks if the value is a valid url (http/https valid urls)\r\n      * TODO: Check if this validation is necessary\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  isValidValue: function isValidValue() {\n    if (!this.hasValue()) return false;\n    var value = $.trim(this.getValue() || \"\");\n\n    return value.toLowerCase().match(/^(http|https):\\/\\//) !== null || false;\n  },\n\n  /**\r\n      * Executes the link\r\n      * @param {} linkEncode\r\n      * @param {} linkTarget\r\n      * @returns {}\r\n      */\n  linkSolver: function linkSolver(linkEncode, linkTarget) {\n    if (linkTarget === \"newwindow\" || bizagi.util.isCordovaSupported()) {\n      window.open(linkEncode, \"_system\", \"location=yes\");\n    } else {\n      window.open(linkEncode, \"_system\");\n    }\n  },\n\n  processLayout: function processLayout(isLabelFormat) {\n    if (!isLabelFormat) {\n      this._super(isLabelFormat, this.properties.textFormat);\n    } else {\n      if (typeof this.properties.textFormat.background !== \"undefined\") {\n        this._super(isLabelFormat, { background: this.properties.textFormat.background });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\".bz-link\", $context);\n  } });","/**\r\n *   Name: Bizagi Render Image Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.image\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.image.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.image.extend(\"bizagi.rendering.smartphone.image\", {\n  QUALITY_PICTURE: 80,\n  EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"] },\n{\n\n  /**\r\n   * DOM input to handle HTML uploads\r\n   * @var $inputFile jQuery DOM\r\n   */\n  $inputFile: null,\n\n  /**\r\n                     * Whether or not is a native device 'Just a shortcut\r\n                     * @var isNative boolean\r\n                     */\n  isNative: false,\n\n  /**\r\n                    * Whether or not we are offline 'Just a shortcut\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n\n    if (this.isOfflineForm) {\n      var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\n      var maxFileSizeOfUser = typeof BIZAGI_SETTINGS !== \"undefined\" && typeof BIZAGI_SETTINGS.UploadMaxFileSize !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\n      this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\n    }\n  },\n\n  /**\r\n      * This method tries to get the HTML template an render the current object inside\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"image\");\n\n    return $.fasttmpl(template, { url: \"\" });\n  },\n\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $({});\n  },\n\n  /**\r\n      * There is no difference when rendering a readonly image, so...\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(\"image-readonly\");\n\n    return self.buildItemUrl().\n    then(function (dataUrl) {\n      var url = dataUrl || \"\";\n\n      if (!self.isDisposed()) {\n        self.properties.url = url;\n        var html = $.fasttmpl(template, { url: self.properties.url });\n        return html;\n      }\n    });\n  },\n\n  /**\r\n      * After rendering element\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.$inputFile = $(\".bz-image__input\", $control);\n    this.$nativeFile = $(\".bz-image__native\", $control);\n\n    if (!this.isDesignMode())\n    this.showAsyncImage();\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = this.getControl();\n\n    // Attach all events\n    $control.on(\"click\", \"[data-action=upload]\", function (evt) {\n      self.choosePhoto();\n    });\n\n    if (this.isNative) {\n      self.configureNativeHandlers();\n    } else {\n      self.configureHybridHandlers();\n    }\n  },\n\n  configureNativeHandlers: function configureNativeHandlers() {\n    var self = this;\n    var $control = this.getControl();\n\n    // Upload Image Options\n    this.$nativeFile.off(\"click\").actionSheet({\n      actions: self.getUploadChoices(),\n      actionClicked: function actionClicked(action) {\n        switch (action.guid) {\n          case 1:\n            self.imageAdd();\n            break;\n          case 2:\n            self.imageAdd(true);\n            break;}\n\n      },\n      appear: function appear() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      cancelClicked: function cancelClicked(action) {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      } });\n\n\n    $(\".bz-image__resolution\", $control).off(\"click\").actionSheet({\n      actions: bizagi.util.media.getImageResolutionSizes(),\n      withoutCancel: true,\n      actionClicked: function actionClicked(action) {\n        bizagi.loading.start();\n        self.resolutionButtonHandler(action.guid).\n        always(function () {\n          bizagi.loading.stop();\n        });\n      },\n      appear: function appear(action) {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      cancelClicked: function cancelClicked(action) {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      } });\n\n  },\n\n  configureHybridHandlers: function configureHybridHandlers() {\n    var self = this;\n\n    // Image change (Hybrid only)\n    this.$inputFile.off(\"change\").on(\"change\", function () {\n      self.imageAdd();\n      this.value = \"\";\n    });\n\n    // Just in case\n    this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n      evt.stopPropagation();\n    });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = this.getControl();\n\n    $control.off(\"click\").on(\"click\", \".bz-image\", function () {\n      self.imagePreview();\n    });\n  },\n\n  /**\r\n      * Add an image\r\n      * @param useCamera boolean Whether or not to use device's camera\r\n      */\n  imageAdd: function imageAdd(useCamera) {\n    var self = this;\n\n    if (!this.isNative) {\n      self.imageAddHybrid();\n    } else {\n      self.imageAddNative(useCamera);\n    }\n  },\n\n  imageAddHybrid: function imageAddHybrid() {\n    var self = this;\n    var extensions = this.Class.EXTENSIONSIMG;\n    var dataFile = this.$inputFile[0].files[0];\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n      self.performUploadFile(dataFile).\n      always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  imageAddNative: function imageAddNative(useCamera) {\n    var self = this;\n    var options = {\n      quality: self.Class.QUALITY_PICTURE,\n      targetWidth: 1280,\n      targetHeight: 960,\n      correctOrientation: true };\n\n\n    if (!useCamera) {\n      var coordinates = self.getControl()[0].getBoundingClientRect();\n\n      options = {\n        quality: self.Class.QUALITY_PICTURE,\n        sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\n        popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\n        destinationType: navigator.camera.DestinationType.FILE_URI,\n        correctOrientation: true };\n\n    }\n\n    navigator.camera.getPicture(\n    function (dataImage) {// on success\n      return self.imageAddNativeFromCamera(dataImage);\n    }, function () {// on fail \n      bizagi.loading.stop();\n    }, options);\n\n  },\n\n  imageAddNativeFromCamera: function imageAddNativeFromCamera(dataImage) {\n    var self = this;\n    bizagi.loading.start();\n\n    // Check max size, then get file data info and upload file\n    bizagi.util.media.checkMaxSize(dataImage, self.properties).\n    then(function () {\n      return bizagi.util.media.getFileDataInfo(dataImage);\n    }).\n    then(function (fileData) {\n      if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\n\n        self.dataImage = dataImage;\n        self.fileProperties = fileData;\n\n        // \"new Blob\" constructor is not supported in android version 4.2.2\n        var version = bizagi.util.getAndroidVersion();\n        if (version && version <= 4.2 || self.isOfflineForm) {\n          self.performUploadFile(self.dataImage).\n          always(function () {\n            bizagi.loading.stop();\n          });\n        } else {\n\n          if (!bizagi.util.isAndroid()) {\n            return $.when(bizagi.util.media.modalResolutionUpload()).\n            then(function (buttonIndex) {\n              if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                return self.resolutionButtonHandler(buttonIndex);\n              }\n            });\n          } else {\n            // Force click to show actionsheet menu\n            $(\".bz-image__resolution\", self.getControl()).click();\n          }\n        }\n      }\n    }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Remove the current image\r\n      */\n  imageDelete: function imageDelete() {\n    var self = this;\n\n    bizagi.loading.start();\n\n    return self.dataService.deleteImage({\n      url: self.properties.deleteUrl,\n      idRender: self.properties.id,\n      xpath: self.properties.xpath,\n      xpathContext: self.properties.xpathContext,\n      idPageCache: self.properties.idPageCache,\n      contexttype: self.properties.contexttype }).\n    then(function () {\n      self.properties.value = [];\n      self.uploadFileCompleted();\n    }).fail(function (msg) {\n      var message;\n      var responseText = msg.responseText;\n\n      try {\n        message = JSON.parse(responseText);\n        message = message.message || responseText;\n      } catch (e) {\n        message = responseText;\n      }\n\n      self.setValidationMessage(message);\n\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Send file using HTTP\r\n      * @param dataFile\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  uploadFile: function uploadFile(dataFile) {\n    var self = this;\n    self.properties.isChanged = true;\n\n    if (!this.isOfflineForm) {\n      if (this.isNative) {\n        return self.uploadFileNativeOnline(dataFile);\n      }\n      return self.uploadFileHybridOnline(dataFile);\n    }\n\n    // Offline code\n    if (bizagi.util.isEmpty(self.properties.value)) self.properties.value = [[null, null]];\n    var fileName = self.fileProperties != undefined ? self.fileProperties.name : dataFile.name;\n    self.dataService.fileService.changeOfflineImageName(self.properties.value, fileName);\n    return self.saveImageOffline(dataFile);\n  },\n\n  uploadFileNativeOnline: function uploadFileNativeOnline() {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n    var fileName = self.fileProperties.name;\n\n    if (self.editedImageURL) {\n      params.dataFile = self.editedImageURL;\n    } else if (self.fileProperties) {\n      params.dataFile = self.fileProperties.url;\n    }\n\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = fileName;\n    params.options.mimeType = \"image/jpeg\";\n    params.options.uploadKey = { key: addParams[\"h_xpath\"] };\n    params.options.addUrl = self.properties.addUrl;\n\n    //Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    // Fix android 4.4 getting images from recent folder\n    params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\n\n    return $.when(bizagi.util.media.uploadFile(params)).\n    then(function (result) {\n      var response = JSON.parse(decodeURIComponent(result.response));\n      if (response.type === \"error\") {\n        return $.Deferred().reject(response).promise();\n      }\n      return response;\n    });\n  },\n\n  uploadFileHybridOnline: function uploadFileHybridOnline(dataFile) {\n    var self = this;\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\n    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\n\n      return self.dataService.processUploadFile({\n        url: self.properties.addUrl,\n        formData: self.buildAddFileParams(dataFile) });\n\n\n    } else {\n      return $.Deferred().reject().promise();\n    }\n  },\n\n  /**\r\n      * File upload is done\r\n      */\n  uploadFileCompleted: function uploadFileCompleted() {\n    try {\n      this.showAsyncImage();\n      this.editedImageURL = null;\n    } catch (error) {\n      // TODO: Review scenario\n      this.getFormContainer().refreshForm();\n    }\n  },\n\n  /**\r\n      * Show async image\r\n      * */\n  showAsyncImage: function showAsyncImage() {\n    var self = this;\n    var $control = self.getControl();\n    var $wrapper = $(\".bz-input-icon\", $control);\n\n    self.renderUploadItem().\n    then(function (htmlImage) {\n      if (!self.isDisposed()) {\n\n        // Empty container and add new image\n        $wrapper.empty();\n        $wrapper.append(htmlImage);\n\n        var action = self.hasValue() ? \"update\" : \"upload\";\n\n        $wrapper.attr(\"data-action\", action);\n\n        // Attack events to overflow-menu\n        if (self.hasValue()) {\n          self.configureMenu();\n        }\n      }\n    });\n  },\n\n  /**\r\n      * resolutionButtonHandler\r\n      * @param ordinal\r\n      */\n  resolutionButtonHandler: function resolutionButtonHandler(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.performUploadFile(self.dataImage);\n    } else {\n\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).\n      then(function (result) {\n\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.performUploadFile(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Render edition view\r\n      * @returns {}\r\n      */\n  imagePreview: function imagePreview() {\n    var self = this;\n    var baseParams = self.getParams();\n    var container = baseParams.navigation.createRenderContainer({\n      title: self.properties.displayName,\n      view: {\n        zoom: true,\n        useNativeScrolling: false } });\n\n\n\n    var template = self.renderFactory.getTemplate(\"image-preview\");\n    var imageData = { \"url\": self.properties.url && self.properties.url !== \"\" ? self.properties.url : \"\" };\n    var img = $.fasttmpl(template, imageData);\n\n    container.element.css(\"display\", \"none\");\n    self.inputEdition = container.element.html(img);\n    baseParams.navigation.navigate(container.id);\n\n    bizagi.loading.start();\n\n    var getFullImage = this.formCompatibilityVersion >= 2 ? function () {\n      return imageData.url;\n    } : self.buildFullItemUrl.bind(self);\n\n    $.when(getFullImage()).then(function (dataUrl) {\n      container.element.css(\"display\", \"block\");\n\n      if (dataUrl.indexOf(\"error\") < 0) {\n        var $preview = $(\".bz-image__preview-item:first\", container.element).attr(\"src\", dataUrl);\n        var originalImageWidth = $preview.css(\"width\");\n\n        originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\n\n        if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\n          $preview.css(\"width\", \"100%\");\n        }\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var properties = self.properties;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n\n    // Build add params to send to the server\n    formData.append(prefix + \"xpath\", properties.xpath);\n    formData.append(prefix + \"idRender\", properties.id);\n    formData.append(prefix + \"xpathContext\", properties.xpathContext);\n    formData.append(prefix + self.Class.BA_PAGE_CACHE, properties.idPageCache);\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n    formData.append(prefix + \"action\", \"savefile\");\n    formData.append(self.properties.xpath, dataFile);\n\n    if (properties.contexttype) {\n      formData.append(prefix + \"contexttype\", properties.contexttype);\n    }\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var self = this;\n    var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\n\n    self.getFormContainer().failHandler(errorResponse);\n  },\n\n  /**\r\n      * Execute upload file\r\n      * @param {} context\r\n      * @param {} dataImage\r\n      * @returns {}\r\n      */\n  performUploadFile: function performUploadFile(dataImage) {\n    var self = this;\n\n    return $.when(self.uploadFile(dataImage)).\n    then(function () {\n      if (bizagi.util.isEmpty(self.properties.value)) self.properties.value = [[0, \"uploaded\"]];\n      self.uploadFileCompleted();\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * Choose photo\r\n      */\n  choosePhoto: function choosePhoto() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported()) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Process an action in order to do something with the image\r\n      */\n  configureMenu: function configureMenu() {\n    var self = this;\n    var items = [];\n    var $control = this.getControl();\n    var $viewMore = $(\".bz-input-icon__input + .bz-icn\", $control);\n    var allowDelete = self.isOfflineForm ? false : self.properties.allowDelete && self.properties.editable;\n\n    items.push({\n      name: bizagi.localization.getResource(\"workportal-actionsheet-upload-image-preview\"),\n      fn: function fn() {\n        self.imagePreview();\n      } });\n\n\n    items.push({\n      name: bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\"),\n      fn: function fn() {\n        self.choosePhoto();\n      } });\n\n\n    if (allowDelete) {\n      items.push({\n        name: bizagi.localization.getResource(\"workportal-actionsheet-upload-remove-photo\"),\n        fn: function fn() {\n          bizagi.showConfirmationBox(self.getResource(\"render-grid-delete-confirmation\")).\n          then(function () {\n            self.imageDelete();\n          });\n        } });\n\n    }\n\n    $viewMore.overflowMenu({ items: items });\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    return [\n    { \"guid\": 1, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") },\n    { \"guid\": 2, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") }];\n\n  },\n\n  /**\r\n      * Builds the upload item url\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  buildItemUrl: function buildItemUrl(params) {\n    var self = this;\n\n    if (self.isOfflineForm) {\n      return self.buildItemUrlOffline();\n    }\n\n    return self.buildItemUrlOnline(params);\n  },\n\n  buildItemUrlOffline: function buildItemUrlOffline() {\n    var self = this;\n    return bizagi.util.sleepUntil(function () {\n      return !self.dataService.getFileService().isLoading(self);\n    }).then(function () {\n      return bizagi.rendering.image.prototype.buildItemUrlOffline.apply(self, arguments);\n    });\n  },\n\n  buildItemUrlOnline: function buildItemUrlOnline() {\n    var self = this;\n    // Change directly properties.value in order to avoid collectData changes\n    return bizagi.rendering.image.prototype.buildItemUrl.apply(this, arguments).then(function (imageUrl) {\n      if (self.formCompatibilityVersion < 2) {\n        if (imageUrl.length > 0) {\n          self.properties.value = [[0, \"uploaded\"]];\n        } else {\n          self.properties.value = [];\n        }\n      }\n      return imageUrl;\n    });\n  },\n\n  collectData: function collectData(renderValues) {\n    var self = this;\n\n    if (self.isOfflineForm && bizagi.util.isOfflineFormsV2Supported()) {\n      if (!self.properties.isChanged) return;\n\n      var xpath = self.properties.xpath;\n      if (!bizagi.util.isEmpty(xpath)) {\n        renderValues[xpath] = {\n          offlineId: self.buildOfflineImageId(),\n          name: self.dataService.fileService.getOfflineImageName(self.getValue()) };\n\n      }\n    }\n  },\n\n  /**\r\n      * Cleans current value\r\n      */\n  cleanData: function cleanData() {\n    if (!this.hasValue()) return;\n    return $.when(this.imageDelete());\n  },\n\n  hasValue: function hasValue() {\n    var _hasValue = false;\n    var _value = this.properties.value || [];\n    if (_value.length > 0) {\n      _hasValue = true;\n    }\n    return _hasValue;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Form Link Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.formLink\", {\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\" },\nbizagi.rendering.formLink.prototype);\n// Extends itself\nbizagi.rendering.smartphone.formLink.extend(\"bizagi.rendering.smartphone.formLink\", {}, {\n\n  init: function init(params) {\n    var self = this;\n\n    // Call base\n    self._super(params);\n\n    params.context = params.context || \"workflow\";\n\n    var paramsRender = $.extend({}, this._params, {\n      \"proxyPrefix\": this.dataService.serviceLocator.proxyPrefix,\n      \"context\": this.dataService.serviceLocator.context });\n\n\n    this.serviceLocator = new bizagi.render.services.context(paramsRender);\n  },\n\n  /**\r\n      * Update or init the element data\r\n      * @param data\r\n      */\n  initializeData: function initializeData(data) {\n    var self = this;\n\n    self._super(data);\n\n    var properties = self.properties;\n\n    self.originalElement = self.element;\n    properties.orgiginalDisplayType = properties.displayType;\n    properties.displayType = \"normal\";\n\n    self._sendRelation = self.submitEditRequest;\n    self._getData = self.dataService.getFormData;\n    self._isRefreshForm = false;\n  },\n\n  /**\r\n      * Method to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n\n    self._super();\n\n    self._params = {\n      idRender: properties.id,\n      xpathContext: self.getFormLinkXpathContext(),\n      idPageCache: properties.idPageCache,\n      recordXPath: self.getFormLinkXpath(),\n      requestedForm: \"linkform\",\n      editable: properties.editable,\n      url: properties.editPage };\n\n\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    // Execute the same as post-render\n    this.postRender();\n  },\n\n  /**\r\n      * Para la grilla lo que se debe hacer es sobreescribir o crear los metodos params, sendrelation,getData\r\n      * @returns {*}\r\n      */\n  renderEdition: function renderEdition() {\n    var self = this;\n    var properties = self.properties;\n\n    self.container = self.getParams().navigation.createRenderContainer({ title: properties.displayName });\n    self.inputEdition = self.container.element;\n\n    if (self.properties.hasentryrule) {\n      var form = self.getFormContainer();\n\n      $.when(form.saveForm()).done(function () {\n        self.resolveCheckpointRequest().done(function () {\n          return self.openLinkRule(\"entryrule\");\n        });\n      });\n    } else {\n      return self.openLink();\n    }\n  },\n\n  /**\r\n      * Open link display from inside a dialog\r\n      */\n  openLink: function openLink() {\n    var self = this;\n\n    return $.when(self._sendRelation.apply(self)).done(function () {\n      bizagi.loading.start();\n\n      $.when(self.paintFormLink()).done(function () {\n        bizagi.loading.stop();\n      }).fail(function () {\n        //Executes Rollback action\n        bizagi.loading.start();\n        self.rollbackForm();\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    }).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n      var form = self.getFormContainer();\n\n      if (typeof form !== \"undefined\") {\n        form.addValidationMessage(message);\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  openLinkRule: function openLinkRule(property) {\n    var self = this;\n    var def = new $.Deferred();\n\n    bizagi.loading.start();\n\n    self.getPropertyValue(property, {}).\n    done(function (dataRuleResp) {\n      if (dataRuleResp.messages) {\n        var message = dataRuleResp.messages[0];\n        var form = self.getFormContainer();\n\n        form.validationController.showErrorMessage(message);\n        def.reject();\n      } else {\n        if (property === \"entryrule\") {\n          self.openLink();\n        }\n      }\n      def.resolve();\n    }).fail(function () {\n      def.reject();\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n\n    return def.promise();\n  },\n\n  getPropertyValue: function getPropertyValue(propertyName, params) {\n    var self = this;\n    var properties = self.properties;\n    var defer = new $.Deferred();\n\n    self.dataService.multiaction().getPropertyData({\n      url: properties.dataUrl,\n      xpath: properties.xpath,\n      idRender: properties.id,\n      xpathContext: properties.xpathContext,\n      idPageCache: properties.idPageCache,\n      property: propertyName,\n      extra: params,\n      dataType: params ? params.dataType : null }).\n    done(function (data) {\n      if (data.type === \"error\") {\n        // Workflow engine error, we gotta show it with error\n        var form = self.getFormContainer();\n\n        form.validationController.showErrorMessage(data.message);\n        defer.reject(data);\n      } else {\n        defer.resolve(data);\n      }\n    }).fail(function (jqXHR, textStatus, errorThrown) {\n      // Add error messages\n      var form = self.getFormContainer();\n\n      form.validationController.showErrorMessage(jqXHR.message);\n\n      defer.reject(jqXHR, textStatus, errorThrown);\n    });\n\n    return defer.promise();\n  },\n\n  paintFormLink: function paintFormLink() {\n    var self = this;\n    var deferred = $.Deferred();\n\n    $.extend(self._params, { \"proxyPrefix\": self.serviceLocator.proxyPrefix });\n\n    $.when(self._getData.call(self, self._params)).pipe(function (data) {\n      if (self._params.recordXPath) {\n        data.form.properties.recordXpath = self._params.recordXPath;\n      }\n\n      if (self._params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Grid\n      if (self._params.hasOwnProperty(\"withAddForm\") && self._params.withAddForm) {\n        if (!data.form.elements || data.form.elements && data.form.elements.length === 0) {\n          self._params.hideSaveButton = true;\n        }\n      }\n\n      /**\r\n         * This creation of form on every action like refresh or save\r\n         * is driving nuts the listeners in native apps\r\n         */\n      self.form = self.renderFactory.getContainer({\n        type: \"form\",\n        data: data.form,\n        navigation: self.getParams().navigation,\n        view_container: self.container });\n\n\n      self.form.params = $.extend(self.form.params, self.getFormContainer().getParams());\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\",\n        // This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          return self.saveRecord().then(function () {\n            self.container.destroy();\n          }).fail(function (error) {\n            if (error && error.error_code && error.error_code == 1) {\n              //if doesn't support commit, rollback, etc.\n              $.when(self.actionSave(error.data)).then(function () {\n                self.container.destroy();\n              });\n            } else if (error && error.type === \"validationMessages\") {\n              self.form.addValidationMessage(error.messages);\n            } else if (error && error.responseText) {\n              var error_obj = bizagi.util.getErrorFormatted(error);\n              var message = error_obj && error_obj.message ? error_obj.message : error_obj || bizagi.localization.getResource(\"workportal-general-error\");\n\n              if (self.hasSessionFormException(error_obj)) {\n                self.goToStartPage(error_obj);\n              } else {\n                bizagi.showMessageBox(message, \"Error\");\n              }\n            }\n          });\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\",\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          self.container.destroy();\n          deferred.reject();\n        } })];\n\n\n\n      $.extend(self.form, {\n        processButtons: function processButtons() {\n          //not send information set in memory and save\n          $.each(self.form.buttons, function (index, element) {\n            switch (element[\"ordinal\"]) {\n              case 1: //next button will behave as a cancel button\n                $(self.form.getButtons()[index]).click(function () {\n                  self.container.destroy();\n                  deferred.reject();\n                });\n\n                self.form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n\n                self.form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                self.form.buttons[index].action = \"back\";\n                break;\n\n              default:\n                $(self.form.getButtons()[index]).click(function () {\n                  if (self._params.hideSaveButton) {\n                    $(self.form.getButtons()[index]).hide();\n                  }\n\n                  return self.saveRecord().then(function () {\n                    self.container.destroy();\n                  }).fail(function (error) {\n                    if (error && error.error_code && error.error_code == 1) {\n                      //if doesn't support commit, rollback, etc.\n                      $.when(self.actionSave(error.data)).then(function () {\n                        self.container.destroy();\n                      });\n                    } else {\n                      var error_obj = bizagi.util.getErrorFormatted(error);\n                      var message = error_obj && error_obj.message ? error_obj.message : error_obj || bizagi.localization.getResource(\"workportal-general-error\");\n\n                      bizagi.showMessageBox(message, \"Error\");\n                    }\n                  });\n                });\n                break;}\n\n          });\n        } });\n\n\n      return self.form.render();\n\n    }, function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n      var form = self.getFormContainer();\n\n      if (typeof form !== \"undefined\") {\n        form.addValidationMessage(message);\n      }\n\n      deferred.reject();\n    }).done(function (element) {\n      self.inputEdition.html(element);\n\n      if (!self._isRefreshForm) {\n        self.getParams().navigation.navigate(self.container.id);\n      }\n\n      self.container.setNavigationButtons(self.form);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function () {\n        //TODO the parent who call this class implement redraw. see smartphone.grid _InternalRenderLinkForm\n        self.inputEdition.empty();\n        self._isRefreshForm = true;\n\n        //Adds the events to capture the\n        $.when(self.paintFormLink()).done(function () {\n        }).fail(function () {\n          self.submitRollbackRequest();\n        });\n      });\n\n      // Binds the view close event, and send the RollBack\n      self.container.element.bind(\"close\", function () {\n        self.rollbackForm();\n      });\n\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n\n    return deferred.promise();\n  },\n\n  rollbackForm: function rollbackForm() {\n    var self = this;\n    var form = self.form || self.getFormContainer();\n\n    $.when(self.submitRollbackRequest({ idPageCache: form.idPageCache })).done(function () {\n      // Sends additional rollback request to delete checkpoint from entry rule\n      if (self.properties.hasentryrule) {\n        self.submitRollbackRequest({ idPageCache: form.idPageCache });\n      }\n    });\n  },\n\n  saveRecord: function saveRecord() {\n    var self = this;\n    var deferred = $.Deferred();\n    var properties = self.properties;\n\n    if (self.form.validateForm()) {\n      var data = {};\n      self.form.collectRenderValues(data);\n      // Add page cache for this form\n      data.idPageCache = self.form.getPageCache();\n\n      $.when(self.submitSaveRequest(data)).done(function (result) {\n        try {\n          if (self.properties.hasExclusiveCheck && self.addExclusiveChange) {\n            self.addExclusiveChange(self.properties.idAsigned, data, self.parent);\n          }\n          var executeSubmitOnChange = true;\n          if (result && result.type === \"validationMessages\") {\n            executeSubmitOnChange = false;\n            deferred.reject(result);\n          }\n          if (properties.hasexitrule) {\n            self.closeExitRule().done(function () {\n              if (executeSubmitOnChange) {\n                self.resolveSubmitCommitRequest().then(function () {\n                  self.submitOnChange({}).then(function () {\n                    deferred.resolve(result);\n                    if (properties.hasentryrule) {\n                      self.resolveSubmitCommitRequest();\n                    }\n                  });\n                });\n              } else {\n                deferred.reject();\n              }\n            }).fail(function () {\n              deferred.reject();\n            });\n          } else if (executeSubmitOnChange) {\n            self.resolveSubmitCommitRequest().then(function () {\n              if (properties.hasentryrule) {\n                self.resolveSubmitCommitRequest().done(function () {\n                  self.submitOnChange({}).then(function () {\n                    deferred.resolve(result);\n                  });\n                });\n              } else {\n                self.submitOnChange({}).then(function () {\n                  deferred.resolve(result);\n                });\n              }\n            });\n          } else {\n            deferred.reject();\n          }\n        } catch (ex) {\n          deferred.reject();\n        }\n      }).fail(function (error) {\n        var err = JSON.parse(error.responseText || '{\"message\":\"\",\"code\":\"\"}');\n\n        if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1 &&\n        err.message.indexOf(\"was not found\") !== -1) {\n          deferred.reject({ error_code: 1, data: data });\n        } else {\n          deferred.reject(error);\n        }\n      });\n    } else {\n      deferred.reject();\n    }\n\n    return deferred.promise();\n  },\n\n  submitSaveRequest: function submitSaveRequest(data) {\n    var self = this;\n    var properties = self.properties;\n\n    // Don't send request when the link is not editable\n    if (properties.editable === false && !properties.value) {\n      return null;\n    }\n\n    var xpath = self.getFormLinkXpath();\n    var xpathContext = xpath;\n\n    if (properties.xpathContext !== undefined && properties.xpathContext !== \"\") {\n      xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\n    }\n\n    // SaveGridRecord\n    return self.dataService.saveGridRecord({\n      url: properties.saveUrl,\n      idRender: properties.id,\n      xpathContext: xpathContext,\n      submitData: data });\n\n  },\n\n  resolveSubmitCommitRequest: function resolveSubmitCommitRequest() {\n    var def = new $.Deferred();\n\n    this.submitCommitRequest().done(function () {\n      def.resolve();\n    }).fail(function (error) {\n      var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\n      if (err.code === \"UNKNOWN_ERROR\") {\n        def.resolve();\n      } else {\n        def.reject();\n      }\n    });\n\n    return def.promise();\n  },\n\n  resolveCheckpointRequest: function resolveCheckpointRequest() {\n    var def = new $.Deferred();\n\n    this.submitCheckpointRequest().done(function () {\n      def.resolve();\n    }).fail(function (error) {\n      var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\n\n      if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1 &&\n      err.message.indexOf(\"was not found\") !== -1) {\n        def.resolve();\n      } else {\n        def.reject();\n      }\n    });\n\n    return def.promise();\n  },\n\n  closeExitRule: function closeExitRule() {\n    var def = new $.Deferred();\n\n    if (this.properties.hasexitrule) {\n      $.when(this.openLinkRule(\"exitrule\")).done(function (result) {\n        def.resolve(result);\n      }).fail(function () {\n        def.reject();\n      });\n    } else {\n      def.resolve();\n    }\n\n    return def.promise();\n  },\n\n  getFormLinkXpathContext: function getFormLinkXpathContext() {\n    var xpathContext = this.properties.xpathContext;\n    var parentXpathContext = this.getXpathContext();\n\n    if (parentXpathContext && xpathContext) {\n      return xpathContext.indexOf(parentXpathContext) === 0 ? xpathContext : parentXpathContext + \".\" + xpathContext;\n    } else {\n      return xpathContext;\n    }\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Configure event handlers\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action=open]\", $control).on(\"click\", function () {\n      bizagi.loading.start();\n\n      $.when(self.renderEdition()).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  processLayout: function processLayout(isLabelFormat) {\n    if (!isLabelFormat) {\n      this._super(isLabelFormat, this.properties.textFormat);\n    } else {\n      if (typeof this.properties.textFormat.background !== \"undefined\") {\n        this._super(isLabelFormat, { background: this.properties.textFormat.background });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\".bz-link\", $context);\n  },\n  /**\r\n      * Idle timer expired exception\r\n      * @param error\r\n      * @returns {boolean}\r\n      */\n  hasSessionFormException: function hasSessionFormException(error) {\n    return typeof error !== \"undefined\" && error.code === \"AUTH_ERROR\";\n  },\n\n  /**\r\n      * Navigate to main page\r\n      * @param error\r\n      */\n  goToStartPage: function goToStartPage(error) {\n    var navigation = this.getParams().navigation;\n    if (navigation) {\n      navigation.goToStartPage(error);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Geolocation Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the geolocation render class to adjust to Smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.geolocation\", bizagi.rendering.geolocation.prototype);\n// Extends itself\nbizagi.rendering.smartphone.geolocation.extend(\"bizagi.rendering.smartphone.geolocation\", {\n  ALLOW_UPDATE: \"update\" },\n{\n\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.coordinate = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.coordinate = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = self.getControl();\n\n    // If the control doesn't have a value set the position\n    if (self.value == null) {\n      self.updateDisplayValue();\n    }\n\n    $control.on(\"click\", \"[data-action=\" + self.Class.ALLOW_UPDATE + \"]\", self.processAction.bind(self));\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (value != null && value !== \"\") {\n      if (self.coordinate)\n      self.coordinate.val(self.performPrecision(value));\n\n      // Set internal value \n      self.setValue(value, false);\n      def.resolve();\n    } else {\n      var onSuccess = function onSuccess(position) {\n        var coordinates = position.coords.latitude + \" \" + position.coords.longitude;\n\n        self.coordinate.val(self.performPrecision(coordinates));\n\n        // Set internal value \n        self.setValue(coordinates, false);\n        def.resolve();\n      };\n\n      var onFail = function onFail(message) {\n        def.reject(message);\n      };\n\n      if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\n        navigator.geolocation.getCurrentPosition(onSuccess, onFail);\n      } else {\n        self.getCurrentPosition(onSuccess, onFail);\n      }\n    }\n\n    return def.promise();\n  },\n\n  updateDisplayValue: function updateDisplayValue() {\n    var self = this;\n\n    self.setDisplayValue().then(function () {\n      self.setValidationMessage(\"\");\n    }).fail(function (message) {\n      self.coordinate.val(\"\");\n      self.setValidationMessage(message);\n    });\n  },\n\n  /**\r\n      * Process an action in order to do something with the geolocation\r\n      */\n  processAction: function processAction() {\n    this.coordinate.empty();\n    this.updateDisplayValue();\n  },\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","/*\r\n*   Name: BizAgi smartphone Render Association\r\n*   Author: UI Forms Team\r\n*   Comments: Defines the association control\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.association\", bizagi.rendering.association.prototype);\n// Extends itself\nbizagi.rendering.smartphone.association.extend(\"bizagi.rendering.smartphone.association\", {}, {\n\n  /**\r\n                                                                                                  * Template method to implement in each children to customize each control\r\n                                                                                                  * \r\n                                                                                                  * @returns {} \r\n                                                                                                  */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"association\");\n    var def = new $.Deferred();\n\n    self.properties.property = \"flipped\";\n    self.properties.idRender = self.properties.id;\n\n    // Define flipped\n    $.when(self.getFlipAssociation()).done(function (flip) {\n      // Make json base, create self.properties.formatJson\n      self.makeJsonBase();\n\n      self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\n\n      var columnData = self.getColumnData();\n\n      var html = $.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\n        getColumnData: self.getColumnData,\n        getRightAssociation: self.getRightAssociation });\n\n\n      /* by default need set self.properties.formatJson */\n      self.setValue(JSON.encode(self.properties.formatJson));\n\n      def.resolve(html);\n    });\n    return def.promise();\n  },\n\n\n  /**\r\n      * Get Left Data, verify if flipper flags sets true\r\n      *\r\n      * @param column {'0'||'1'}\r\n      */\n  getColumnData: function getColumnData() {\n    var self = this;\n    var properties = self.properties;\n    var data = [];\n\n    self.data = properties;\n\n    var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\n\n    $.each(dataAssociation, function (key, item) {\n      data.push({\n        id: item.id,\n        value: item.value,\n        association: self.getRightAssociation(item.id) });\n\n    });\n\n    return data;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var isExecution = self.getMode() === \"execution\";\n    var $control = self.getControl();\n\n    // Cache control\n    self.association = $(\".bz-association\", $control);\n\n    // Add Events at Association Control\n    if (isExecution) {self.addEventControl();}\n\n    self.showDefaultGroupList();\n  },\n\n  showDefaultGroupList: function showDefaultGroupList() {\n    var self = this;\n    var $control = self.getControl();\n    var $groups = $('.bz-association-group', $control);\n\n    if ($groups.length > 0) {\n      $(\"[data-action='collapse']\", $groups[0]).toggleClass(\"bz-icn--expanded\");\n\n      $(\".bz-association-group__list\", $groups[0]).\n      slideDown(300, function () {\n        $(this).toggleClass(\"bz-association-group__list--hidden\");\n      });\n    }\n  },\n\n  /**\r\n      * Add event to control\r\n      * @returns {} \r\n      */\n  addEventControl: function addEventControl() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"association\");\n    var control = self.getControl();\n\n    // Bind check toggle\n    self.association.\n    on(\"change\", \"input:checkbox\", function () {\n      var $input = $(this);\n      var parentId = $input.data(\"parent-id\");\n      var id = $input.data(\"id\");\n\n      if ($input.prop(\"checked\")) {self.addElement(parentId, id);} else\n      {self.removeElement(parentId, id);}\n    });\n\n    // Bind flip actions\n    self.association.\n    find(\"[data-action='flip']\").\n    click(function () {\n      $(control).empty();\n\n      // Define flipped\n      self.properties.flipped = !self.properties.flipped;\n\n      // Send flip data to server\n      self.properties.flipstate = self.properties.flipped;\n\n      self.dataService.getFlipAssociation(self.properties);\n\n      var columnData = self.getColumnData();\n\n      // Render template\n      $($.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\n        getColumnData: self.getColumnData,\n        getRightAssociation: self.getRightAssociation })).\n      appendTo(control);\n\n      self.postRender();\n    });\n\n    //header\n    self.association.on(\"click\", \"[data-action='collapse']\", function () {\n      var $element = $(this);\n      var $groupList =\n      $element.\n      parents('.bz-association-group').\n      find(\".bz-association-group__list\");\n\n      self.closeAccordionSection();\n      if ($groupList.hasClass(\"bz-association-group__list--hidden\")) {\n\n        $element.toggleClass(\"bz-icn--expanded\");\n\n        $groupList.slideDown(300, function () {\n          $(this).toggleClass(\"bz-association-group__list--hidden\");\n        });\n      }\n    });\n  },\n\n  closeAccordionSection: function closeAccordionSection(active) {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action='collapse']\", $control).removeClass('bz-icn--expanded');\n\n    $(\".bz-association-group__list\", $control).\n    slideUp(300, function () {\n      $(this).addClass(\"bz-association-group__list--hidden\");\n    });\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n\n    return self.renderControl();\n  },\n\n  /**\r\n      * Render for readonly\r\n      * @returns {} \r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.postRender();\n  },\n\n  /* SET-DISPLAY-VALUE\r\n      =====================================================*/\n  setDisplayValue: function setDisplayValue(value) {\n    // Set internal value\n    this.setValue(value, false);\n  },\n\n  getLabel: function getLabel() {\n    if (!this.label) {\n      var label = $(\"> .bz-form-label\", this.element || this.observableElement);\n\n      if (label.length > 0)\n      this.label = label;\n\n      return label;\n    }\n    return this.label;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Search List Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search-list render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.searchList\", bizagi.rendering.searchList.prototype);\n// Extends itself\nbizagi.rendering.smartphone.searchList.extend(\"bizagi.rendering.smartphone.searchList\", {\n  SEARCH_MIN_LENGTH: 2,\n  SEARCH_MAX_RECORDS: 50,\n  SEARCH_DELAY: 250,\n  SEARCH_ELEMENTS: {} },\n{\n\n  renderControl: function renderControl() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"searchList\");\n\n    return $.fasttmpl(template, {\n      id: properties.id,\n      value: properties.value.map(function (el) {\n        return self.formatItem(el.value);\n      }).join(\", \") });\n\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      * @returns {}\r\n      */\n  postRender: function postRender() {\n    this.searchListInput = $(\".bz-search-list__input\", this.getControl());\n  },\n\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.searchListInput = $(\".bz-search-list__input\", this.getControl());\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.readonly\");\n\n    // Render template\n    var content = $.fasttmpl(template, {\n      items: self.properties.value || {},\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return content;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Select new item\n    self.searchListInput.on(\"click\", function (evt) {\n      var parent = $(evt.target).parent() || {};\n      if (parent.hasClass('bz-pill')) return;\n\n      self._searchListViewModal();\n    });\n  },\n\n  _searchListViewModal: function _searchListViewModal() {\n    var self = this;\n    var header = self.getHeaderTemplate();\n    var content = self.getContentTemplate();\n    var footer = self.getFooterTemplate();\n\n    self.searchListInput.mobileView({\n      customHeader: header,\n      orientation: self.properties.orientation || \"\",\n      cssClassHeader: \"bz-modal-view__header-multiple\",\n      contentTemplate: content,\n      footerTemplate: footer,\n      transition: \"slideIn:up\",\n      close: function close() {\n        $(window).unbind(\"resize\");\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      },\n      afterOpenAnimation: function afterOpenAnimation(event) {\n        var $context = $(\".bz-modal-view__search\", event.view.header);\n\n        // Fix the moving content to top\n        if ($context && $context[0]) {\n          $context[0].scrollIntoView(true);\n          $context.focus();\n        }\n      },\n      open: function open() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      configureActions: function configureActions(context) {\n        self.adjustResize();\n        self.configureModalViewHandlers(context);\n      } });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n\n    // Set internal value\n    self.setValue(finalValue);\n\n    if (value !== undefined) {\n      if (self.properties.editable) {\n        self.searchListInput.html(finalValue.map(function (el) {\n          return self.formatItem(el.value);\n        }).join(\", \"));\n      }\n    }\n  },\n\n  /**\r\n      * Remove a item from the list\r\n      * @param {} element\r\n      * @returns {}\r\n      */\n  deleteItem: function deleteItem(element) {\n    var self = this;\n    var item = element.parent('div');\n\n    // Remove from main memory and set the new value\n    self.removeElement({ id: item.data(\"id\") });\n\n    // Remove list element\n    item.remove();\n  },\n\n  selectItem: function selectItem(item) {\n    var templateItem = this.getTagTemplate(item, this.properties.editable);\n    this.modalViewTagList.append(templateItem);\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new suggest control\r\n      * @param {} inputContainer\r\n      * @returns {}\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n    var modalFooter = modalView.footer;\n    var modalHeader = modalView.header;\n\n    // Initialize data\n    var elements = {};\n\n    if (self.hasValue()) {\n      var list = self.getListItems();\n      $.each(list, function (index, item) {\n        elements[item.id] = item;\n      });\n    }\n\n    // Configuring list as a selectable element\n    self.modalViewList = $(\".bz-list\", modalView.content);\n    self.modalViewTagList = $(\".bz-search-pill__results\", modalHeader);\n\n    var $clearButton = $(\".bz-modal-view__clear\", modalHeader);\n\n    // Suggest\n    var $suggestInput = $(\".bz-modal-view__search\", modalHeader);\n    var suggestFilter = bizagi.util.debounce(function () {\n      if (this.value === \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      self.autoCompleteSearchResults($.trim(this.value));\n    }, this.Class.SEARCH_DELAY);\n\n    $suggestInput.on(\"change keyup\", suggestFilter).on(\"focus\", function () {\n      $(\".bz-search__header\", modalView.header).addClass(\"bz-search__header--active\");\n    }).on(\"blur\", function () {\n      $(\".bz-search__header\", modalView.header).addClass(\"bz-search__header--active\");\n    });\n\n    //Clear the search\n    $clearButton.bind(\"click\", function () {\n      $suggestInput.val(\"\").trigger(\"change\");\n    });\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    // Add tags to list\n    self.modalViewList.on(\"click\", \"li\", function () {\n      var item = $.data(this).item;\n\n      // Prevent duplicate elements\n      if (!item || item && elements[item.id]) return;\n      elements[item.id] = item;\n\n      // Update state of button\n      $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\n      $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\n\n      // Update list\n      if ((Object.keys(elements) || []).length === 1) {\n        $(modalHeader).find(\".bz-search-pill__selected \").\n        removeClass(\"bz-search-pill__selected--hidden\");\n      }\n\n      self.selectItem(item);\n    });\n\n    // Remove tags of list\n    self.modalViewTagList.on(\"click\", '.bz-pill > .bz-btn-icn', function (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n\n      var element = $(this);\n      var tag = element.parent('div');\n\n      // Update state of button\n      $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\n      $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\n\n      // Remove from main memory and set the new value\n      delete elements[tag.data(\"id\")];\n\n      // Remove list element\n      tag.remove();\n\n      // Update list\n      if ((Object.keys(elements) || []).length === 0) {\n        $(modalHeader).find(\".bz-search-pill__selected \").\n        addClass(\"bz-search-pill__selected--hidden\");\n      }\n    });\n\n    $(modalFooter).delegate(\"[data-action=save]\", \"click\", function (evt) {\n      // Create a temporal array\n      var newList = [];\n      $.each(elements, function (index, item) {\n        newList.push(item);\n      });\n\n      self.setDisplayValue({ value: newList });\n\n      modalView.close();\n    });\n  },\n\n  autoCompleteSearchResults: function autoCompleteSearchResults(currentValue) {\n    var self = this;\n\n    $.when(self.processRequest({ term: currentValue })).\n    done(function (response) {\n\n      self.modalViewList.find(\"li\").remove();\n\n      for (var i = 0, length = response.length; i < length; i++) {\n        var searchItem = self.renderSearchItem(response[i]);\n\n        searchItem.appendTo(self.modalViewList);\n      }\n    });\n  },\n\n  renderSearchItem: function renderSearchItem(item) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.item\");\n\n    var searchItem = $.tmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: this.formatItem(item.value) });\n\n\n    searchItem.data(\"item\", item);\n\n    return searchItem;\n  },\n\n  /**\r\n      * Process the request data for the autocomplete control\r\n      * @param {} req\r\n      * @returns {}\r\n      */\n  processRequest: function processRequest(req) {\n    var self = this;\n    var properties = self.properties;\n    var deferred = new $.Deferred();\n\n    // Create array for response objects   \n    var suggestions = [];\n\n    if (req.term.length >= this.Class.SEARCH_MIN_LENGTH) {\n\n      // Update term property to reflect the search\n      properties.term = req.term;\n\n      // Cancel previous request in order to improve the performance\n      if (self.deferredReference && typeof self.deferredReference.reject === \"function\" &&\n      self.deferredReference.state() !== \"resolved\") {\n        self.deferredReference.reject({ hideStatus: true });\n      }\n\n      self.deferredReference = self.getData().done(function (data) {\n        if (data && data.length > 0) {\n          data = data.slice(0, properties.maxRecords);\n\n          if (data.length > self.Class.SEARCH_MAX_RECORDS) {\n            data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\n\n            suggestions.push({\n              id: self.Class.NO_RESULTS_SEARCH_ID,\n              label: self.getResource(\"render-search-maximum-records-allowed\"),\n              value: \"\" });\n\n\n\n          } else {\n            data = data.slice(0, properties.maxRecords);\n          }\n\n          $.each(data, function (i, val) {\n            if (properties.maxRecords === 0 || i < properties.maxRecords) {\n              var parseValue = bizagi.util.performTermMatches(val.value, req.term);\n\n              suggestions.push({ id: val.id, label: parseValue, value: val.value });\n            }\n          });\n\n        } else {\n          suggestions.push({\n            id: self.Class.NO_RESULTS_SEARCH_ID,\n            label: self.getResource(\"render-grid-no-records\"),\n            value: \"\" });\n\n        }\n\n        deferred.resolve(suggestions);\n\n      }).fail(function () {\n        deferred.reject();\n      });\n\n    } else {\n      deferred.resolve(suggestions);\n    }\n\n    return deferred.promise();\n  },\n\n  getContentTemplate: function getContentTemplate() {\n    var self = this;\n    var value = self.getValue();\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n\n    var template = this.renderFactory.getTemplate(\"searchList.items\");\n    var content = $.fasttmpl(template, {\n      items: finalValue || {},\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return $.trim(content);\n  },\n\n  getFooterTemplate: function getFooterTemplate() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.actions\");\n    var content = $.fasttmpl(template, {\n      items: self.properties.value || {},\n      editable: self.properties.editable || true });\n\n\n    return $.trim(content);\n  },\n\n  getTagTemplate: function getTagTemplate(item, editable) {\n    var template = this.renderFactory.getTemplate(\"searchList.tag\");\n    var content = $.fasttmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: this.formatItem(item.value),\n      editable: editable });\n\n    return $.trim(content);\n  },\n\n  adjustResize: function adjustResize() {\n    var self = this;\n    var initialScreenSize = window.innerHeight;\n\n    $(window).off(\"resize\").on(\"resize\", bizagi.util.debounce(function () {\n      var that = $(this);\n\n      // Hide the footer\n      if (that.height() < initialScreenSize) {\n        $(\".bz-mobile-view__footer_content\").addClass(\"bz-hidden\");\n      } else {\n        $(\".bz-mobile-view__footer_content\").removeClass(\"bz-hidden\");\n      }\n    }, self.Class.SEARCH_DELAY));\n  },\n\n  getHeaderTemplate: function getHeaderTemplate() {\n    var self = this;\n    var value = self.getValue();\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n    var template = this.renderFactory.getTemplate(\"searchList-modal-header\");\n\n    var content = $.fasttmpl(template, {\n      items: finalValue || {},\n      editable: self.properties.editable || true,\n      emptyItems: (finalValue || []).length === 0 },\n    {\n      formatItem: self.formatItem });\n\n\n    return $.trim(content);\n  } });","/**\r\n *   Name: Bizagi User Field render tablet Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define the basic behaviour for userfields\r\n */\n\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\nbizagi.rendering.smartphone.userfieldWrapper.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", {}, {\n\n  /**\r\n                                                                                                           *   Load userfield\r\n                                                                                                           */\n  getUserfieldControl: function getUserfieldControl() {\n    var self = this;\n    var sControl = self.userfieldName;\n    var mode = self.getMode();\n    var exists = eval(\"typeof bizagi.rendering.smartphone.\" + sControl + \" !== 'undefined'\");\n    var def = new $.Deferred();\n\n    if (exists) {\n      // Creates the userfield instance\n      // Set true argument for tabItem\n      $.when(self.parent.ready()).done(function () {\n        def.resolve(self.createUserfieldInstance(sControl));\n      });\n\n    } else {\n      if (mode != \"execution\") {\n        setTimeout(function () {\n          $.when(self.triggerGlobalHandler(\"loadUserField\", { userfield: self.userfieldGuid, device: \"Smartphone\" })).\n          pipe(function (result) {\n            if (result) {\n              // Creates the userfield instance\n              def.resolve(self.createUserfieldInstance(sControl));\n            }\n          });\n        }, 10);\n\n      } else\n      {\n        // Call ajax service in order to retrieve user field definitions\n        $.when(self.dataService.getUserfieldDefinition({\n          userfield: self.userfieldGuid,\n          device: \"smartphone\" })).\n        pipe(function (data) {\n          // Load userfield in memory\n          self.loadUserfield(data);\n\n          // Creates the userfield instance\n          def.resolve(self.createUserfieldInstance(sControl));\n        });\n      }\n    }\n\n\n    return def.promise();\n  },\n\n  /**\r\n      * Creates the userfield instance when the userfield prototype is loaded in memory\r\n      */\n  createUserfieldInstance: function createUserfieldInstance(sControl) {\n    var self = this;\n    var control;\n    try {\n      // Create a dynamic function to avoid problem with eval calls when minifying the code\n      var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\n      dynamicFunction += \"return new bizagi.rendering.smartphone.\" + sControl + \"(renderParams);\\r\\n\";\n      dynamicFunction += \"}\\r\\n\";\n      dynamicFunction += \"baDynamicFn\";\n      dynamicFunction = eval(dynamicFunction);\n\n      // Call the dynamic function\n      control = dynamicFunction(self.initialParams);\n    } catch (e) {\n      // If the call fails, return the default user field\n      control = self.getUserFieldInstance(self.initialParams);\n    }\n    control.properties.isUserField = true;\n\n    // Save userfield instance\n    self.userfieldInstance = control;\n\n    // Create proxy methods from the wrapper to the userfield instance\n    self.replicateUserfieldMethods(control);\n\n    // Replicate renderchange event from wrapped element to grid if applies\n    self.userfieldInstance.bind(\"renderchange\", function (_, data) {\n      self.triggerHandler(\"renderchange\", data);\n    });\n\n    return control;\n  },\n\n  /**\r\n      * Load userfield into memory\r\n      */\n  loadUserfield: function loadUserfield(data) {\n    var self = this;\n    var styleContent = \"\";\n\n    self.properties.styleGuid = self.properties.styleGuid || Math.guid();\n\n    try {\n      // Parse data\n      try {\n        data = eval(data);\n      } catch (e) {\n        bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\n      }\n\n      // Iterate elements\n      $.each(data, function (index, val) {\n        if (val.type === \"js\") {\n          try {var\n            replaceWithDevice = function replaceWithDevice(str) {\n              return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.smartphone\");\n            };\n\n            val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\n            window.eval(val.content);\n          } catch (ex) {\n            bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message);\n          }\n        }\n        if (val.type === \"css\") {\n          styleContent += val.content;\n        }\n      });\n\n      if ($.trim(styleContent) !== \"\") {\n        bizagi.util.loadStyle(styleContent, self.properties.styleGuid);\n      }\n\n      // Replicate userfield methods to the wrapper\n      var control = eval(\"bizagi.rendering.\" + self.userfieldName);\n\n    } catch (e) {\n      bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\n    }\n  },\n\n  getUserFieldInstance: function getUserFieldInstance(params) {\n    var mode = this.getMode();\n    // If the call fails, return the default user field\n    return mode === \"execution\" ?\n    new bizagi.rendering.smartphone.defaultUserField(params) :\n    new bizagi.rendering.smartphone.designUserField(params);\n  },\n\n  /*\r\n     *   Starts waiting signal for async stuff\r\n     */\n  startUserfieldLoading: function startUserfieldLoading() {\n    this.element.addClass(\"bz-form-userfield__loader\");\n  },\n\n  /*\r\n     *   Ends waiting for async stuff\r\n     */\n  endUserfieldLoading: function endUserfieldLoading() {\n    this.element.removeClass(\"bz-form-userfield__loader\");\n  } });\n\n\n// Auto-extension\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.basicUserField.prototype);\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", {}, {\n\n  renderSingle: function renderSingle() {\n    return this.postRender();\n  },\n\n  renderEdition: function renderEdition() {\n    var self = this;\n    var defer = $.Deferred();\n    $.when(self.postRender()).done(function () {\n      $.when(self.renderUserfieldControl()).done(function () {\n\n        self.inputEdition = self.input;\n        // alert(\"render Edition\");\n        defer.resolve();\n      });\n\n    });\n\n    return defer.promise();\n  },\n\n  getEditableControl: function getEditableControl() {\n    if (!this.isSupported()) {\n      return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\n    }\n  },\n\n  getReadonlyControl: function getReadonlyControl() {\n    if (!this.isSupported()) {\n      return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\n    }\n  },\n\n  isSupported: function isSupported() {\n    return true;\n  } });\n\n\n/*\r\n        *   Default implementation for user fields\r\n        */\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.defaultUserField\", {}, {\n\n  /*\r\n                                                                                                        *   Template method to implement in each device to customize each render after processed\r\n                                                                                                        */\n  getEditableControl: function getEditableControl() {\n    var self = this;\n    var control = self.getControl();\n    var container = self.getContainerRender();\n    var properties = self.properties;\n    var controlName = properties.control.replace(/column/g, \"\");\n\n    self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\n    self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\n\n    container.addClass(\"bz-command-not-edit\");\n\n    return self.input;\n  },\n\n  /*\r\n     *  Dont send the data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n  },\n\n  getDisplayValue: function getDisplayValue() {\n    var self = this;\n    var properties = self.properties;\n    var controlName = properties.control;\n\n    return \"Userfield: \" + controlName + \" not found\";\n  },\n\n  getReadonlyControl: function getReadonlyControl() {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n    var controlName = properties.control;\n    var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\n\n    return mycontrol;\n  } });","/*\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the activity checkList render class to adjust to smartphone devices\r\n */\n\n// Extends from base list\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.activityCheckList\", {}, {\n\n  /**\r\n                                                                                                     * Update or init the element data\r\n                                                                                                     * @param data\r\n                                                                                                     */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n    var goal = this.properties.activityDescription && this.properties.activityDescription !== \"\" ?\n    bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") + \": \" + this.properties.activityDescription : \"\";\n    this.properties.displayName = goal !== \"\" ? goal : bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\");\n    this.properties.displayType = \"vertical\";\n  },\n  /*\r\n      *   Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    var $control = self.getControl();\n    // Call base\n    this._super();\n\n    self.newItemName = $(\".bz-checkList__input\", $control);\n    self.addEditButton = $(\".add-edit-item-button-checklist\", $control);\n    self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", $control);\n\n    self.additionalElements();\n    self.notifyLoadItems();\n  },\n\n  notifyLoadItems: function notifyLoadItems() {\n    var self = this;\n    setTimeout(function () {\n      var resolvedItems = self.properties.items.filter(function (i) {\n        return i.resolved;\n      }).length;\n      bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\n        'hasChanges': true,\n        'idActivity': self.properties.idActivity,\n        'itemsResolved': resolvedItems,\n        'items': self.properties.items,\n        'progress': self.properties.activityWork }));\n\n\n      bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\n    }, 100);\n  },\n\n  additionalElements: function additionalElements() {\n    var self = this;\n\n    if (self.addEditButton && self.addEditButton.length > 0) {\n      self.addEditButton.hide();\n    }\n    if (self.cancelEditButton && self.cancelEditButton.length > 0) {\n      self.cancelEditButton.hide();\n    }\n    //control.parent().addClass(\"render-activity-check\");\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n    this._super();\n    $(\"[data-action=add]\", control).unbind(\"click\").click(function () {\n      var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n      if (itemSelected.length <= 0) {\n        self.prepareNewItem();\n      } else {\n        $(\".bz-checkList__input\", itemSelected).focus();\n      }\n    });\n\n    $(\"[data-action=delete]\", self.control).bind(\"click\", function () {\n      var that = this;\n      var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\n      var contentHolder = $(this).closest(\".bz-checkList__item\");\n\n      contentHolder.addClass(\"ui-bizagi-to-remove\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n\n        var itemId = $(that).closest(\".bz-checkList__item\").data(\"item-guid\");\n\n        self.deleteItem(itemId);\n      }).fail(function () {\n        contentHolder.removeClass(\"ui-bizagi-to-remove\");\n      });\n    });\n\n    $(\"label[data-action=edit-item]\", self.control).bind(\"click\", function () {\n      var element = $(this).closest(\".bz-checkList__item\");\n      var itemId = element.data(\"item-guid\");\n      var itemPosition = element.data(\"item-position\");\n\n      self.selectItem(itemId, itemPosition);\n    });\n  },\n\n  selectItem: function selectItem(itemId) {\n    var self = this;\n\n    for (var i = 0, length = self.properties.items.length; i < length; i++) {\n      if (self.properties.items[i].guid === itemId) {\n        self.properties.items[i].selected = true;\n      } else {\n        self.properties.items[i].selected = false;\n      }\n    }\n\n    self.repaintControl();\n\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.getControl());\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    var itemContent = itemSelectedName.val();\n\n    itemSelectedName.focus();\n    itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\n\n    self.addSelectedHandlers();\n  },\n\n  deleteItem: function deleteItem(itemId) {\n    var self = this;\n\n    for (var i = 0, length = self.properties.items.length; i < length; i++) {\n      if (self.properties.items[i].guid === itemId) {\n        self.properties.items.splice(i, 1);\n        break;\n      }\n    }\n\n    self.setValue(self.properties.items);\n    self.repaintControl();\n    self.addSelectedHandlers();\n  },\n\n  prepareNewItem: function prepareNewItem() {\n    var self = this;\n    var newItem = {\n      guid: Math.guid(),\n      resolved: false,\n      name: \"\",\n      selected: true };\n\n\n    self.properties.items.push(newItem);\n    self.repaintControl();\n    self.newItemName.focus();\n\n    self.newItemName.blur(function () {\n      var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n      var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n      var valueInput = itemSelectedName.val();\n\n      if (valueInput === \"\" && self.properties.items && self.properties.items.length >= 1 &&\n      self.properties.items.slice(-1)[0].name === \"\") {\n        self.properties.items.pop();\n      }\n    });\n    self.addSelectedHandlers();\n    self.newItemName.keypress(function (event) {\n      if (event.which == 13) {\n        event.preventDefault();\n        self.addItem();\n        self.prepareNewItem();\n      }\n    });\n  },\n\n  addSelectedHandlers: function addSelectedHandlers() {\n    var self = this;\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    itemSelectedName.focus();\n    $(\"[data-action=accept-edit]\", itemSelected).bind(\"click\", function () {\n      var newItemName = itemSelectedName.val();\n      if (newItemName && newItemName !== \"\") {\n        self.addItem();\n      }\n    });\n\n\n    $(\"[data-action=cancel-edit]\", itemSelected).bind(\"click\", function (e) {\n      var newItemName = itemSelectedName.val();\n      var element = $(this).closest(\".bz-checkList__item\");\n      var itemPosition = element.data(\"item-position\");\n      var guidItem = element.data(\"item-guid\");\n\n      if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\n        self.properties.items[itemPosition].selected = false;\n      }\n      if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\n        self.deleteItem(guidItem);\n      }\n      //self.addButton.show();\n      self.repaintControl();\n    });\n  },\n\n  addItem: function addItem() {\n    var self = this;\n    var $control = self.getControl();\n\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", $control);\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    var newItemName = itemSelectedName.val();\n\n    $.each(self.properties.items, function (index, item) {\n      if (item.selected) {\n        item.name = newItemName;\n        item.selected = false;\n      }\n    });\n    self.updateOriginalValue();\n    self.setValue(self.properties.items);\n    self.repaintControl();\n  },\n\n  repaintControl: function repaintControl() {\n    var self = this;\n    var checkListHtml = self.renderControl();\n    $(\"[data-component=checkList]\", self.control).replaceWith(checkListHtml);\n    self.postRender();\n    self.configureHandlers();\n  },\n\n  onCheckListGroupChange: function onCheckListGroupChange(itemId, checked) {\n    var self = this;\n    var item;\n    var items = $.grep(self.properties.items, function (element, index) {\n      return element.guid === itemId;\n    });\n    if (items && items.length > 0) {\n      item = items[0];\n    }\n    item.resolved = checked;\n    self.setValue(self.properties.items);\n    self.refreshValue(self.properties.items);\n  },\n\n  refreshValue: function refreshValue(items) {\n    var self = this,\n    length = items.length,\n    completed = 0;\n\n    for (var i = 0; i < length; i++) {\n      if (items[i].resolved) {\n        completed += 1;\n      }\n    }\n\n    if (length > 0) {\n      self.properties.activityWork = Math.floor(100 * completed / length);\n    } else\n    {\n      self.properties.activityWork = 100;\n    }\n\n    self.notifyLoadItems();\n  },\n\n  getValue: function getValue() {\n    var self = this;\n    return self.value || [];\n  },\n\n  controlValueIsChanged: function controlValueIsChanged() {\n    var self = this;\n    var originalValue = JSON.stringify(self.properties.originalValue);\n    var newValue = JSON.stringify(self.value);\n    return originalValue !== newValue;\n  },\n\n  /*\r\n      *   Updates original value for some comparisons\r\n      */\n  updateOriginalValue: function updateOriginalValue() {\n    var self = this;\n    self.properties.originalValue = bizagi.clone(self.value);\n  },\n\n  /*\r\n      *   Add the render data to the given collection in order to send data to the server\r\n      */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var properties = self.properties;\n\n    // Add the render value\n    var xpath = properties.xpath;\n    var value = self.getValue();\n    var idActivity = self.properties.idActivity;\n\n    if (self.controlValueIsChanged()) {\n      // Filter by valid xpaths and valid values\n      if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\n        if (Array.isArray(value)) {\n          renderValues[properties.xpath] = {\n            idActivity: idActivity,\n            items: value };\n\n        } else if (value === \"\") {\n          renderValues[properties.xpath] = \"\";\n        }\n      }\n    } else {\n      bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\n        'hasChanges': false }));\n\n    }\n  },\n\n  isValid: function isValid(invalidElements) {\n    var self = this,\n    properties = self.properties,\n    message;\n    var items = self.getValue();\n    message = self.getResource(\"render-activity-check-list-validation\");\n    for (var i = 0; i < items.length; i += 1) {\n      var item = items[i];\n      if (!item.resolved) {\n        invalidElements.push({\n          xpath: properties.xpath,\n          message: message });\n\n        break;\n      }\n    }\n  } });","/*\r\n*   Name: Bizagi smartphone Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to smartphone devices\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\n// Extends itself\nbizagi.rendering.smartphone.numberScientificNotation.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", {}, {});","/*  \r\n *   Name: Bizagi Smartphone Range Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range render class to adjust to smartphone devices\r\n */\n\n// Extends from render Smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.range\", bizagi.rendering.range.prototype);\n// Extends itself\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.range\", {}, {\n\n  /**\r\n                                                                                     * Render a specific implementation for Smartphone device\r\n                                                                                     */\n  postRender: function postRender() {\n    var properties = this.properties;\n  },\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var control = this.getControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Range Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range date render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeDate\", bizagi.rendering.rangeDate.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeDate.extend(\"bizagi.rendering.smartphone.rangeDate\", {}, {\n\n  /**\r\n                                                                                             * Render a specific implementation for Desktop device\r\n                                                                                             */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Money Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range money render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeMoney.extend(\"bizagi.rendering.smartphone.rangeMoney\", {}, {\n\n  /**\r\n                                                                                               * Render a specific implementation for Desktop device\r\n                                                                                               */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Range Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range number render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeNumber.extend(\"bizagi.rendering.smartphone.rangeNumber\", {}, {\n\n  /**\r\n                                                                                                 * Render a specific implementation for Desktop device\r\n                                                                                                 */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*\r\n*   Name: BizAgi Desktop Render Template Text Extension\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\n\n// Extends from render desktop base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutImage\", bizagi.rendering.layoutImage.prototype);\n\nbizagi.rendering.smartphone.layoutImage.extend(\"bizagi.rendering.smartphone.layoutImage\", {},\n{\n\n  renderControl: function renderControl() {\n    var self = this;\n    var templateUri = self.renderFactory.getTemplate(\"layout-image\");\n    self.control = self.getControl();\n    return $.fasttmpl(templateUri, {});\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\n      //Get image of customer in binary format\n      var url = self.getImageUri();\n      $.ajax({\n        url: url,\n        type: \"GET\",\n        dataType: \"binary\",\n        processData: false,\n        success: function success(blob) {\n\n          if (typeof blob == \"string\") {\n            var xhr = arguments[2];\n            var contentType = xhr.getResponseHeader('Content-type');\n            blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\n          }\n\n          var urlCreator = window.URL || window.webkitURL;\n          var imageUrl = urlCreator.createObjectURL(blob);\n\n          $(control).find('img').attr(\"src\", imageUrl);\n        } });\n\n    }\n  },\n\n  /**\r\n      * Gets the url to get the array image\r\n      */\n  getImageUri: function getImageUri() {\n    var self = this;\n    var templateControl = self.parent.parent;\n    var renderParams = templateControl.properties.paramsRender || {};\n\n    var map = {\n      entity: self.value.guid,\n      surrogateKey: self.value.surrogateKey,\n      xpath: self.properties.xpath,\n      width: 96,\n      height: 96,\n      hash: self.value.value };\n\n\n    if (renderParams.formParams) {\n\n      if (renderParams.formParams.idCase) {\n        map.idcase = renderParams.formParams.idCase;\n      }\n\n      if (renderParams.formParams.idWorkitem) {\n        map.idworkitem = renderParams.formParams.idWorkitem;\n      }\n\n      if (renderParams.xpathActions) {\n        map.contextxpath = renderParams.xpathActions;\n      }\n    }\n\n    return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\n  },\n  /**\r\n      *   Sets the value in the rendered control\r\n      */\n  getDisplayValue: function getDisplayValue() {\n    var self = this;\n    return [self.value];\n  } });","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\n\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLink\", bizagi.rendering.layoutLink.prototype);\n\nbizagi.rendering.smartphone.layoutLink.extend(\"bizagi.rendering.smartphone.layoutLink\", {\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var element = self.element;\n    if (element) {\n      element.on(\"click\", $.proxy(self.onClickElement, self));\n    }\n  },\n\n  onClickElement: function onClickElement() {\n    var self = this,\n    params = {\n      \"displayName\": self.properties.displayName,\n      \"navigateFromRender\": false,\n      \"reference\": self.properties.reference,\n      \"referenceType\": self.properties.referenceType,\n      \"xpath\": self.properties.xpath };\n\n    if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id == \"#renderSplitView\") {\n      params.navigateFromRender = true;\n    }\n    self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\n  } });","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\n\nbizagi.rendering.smartphone.layoutLabel.extend(\"bizagi.rendering.smartphone.layoutLabel\", {\n\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    self.properties.displayName = val;\n    this._super(val, triggerEvents);\n    var control = self.getControl();\n    if (control) {\n      $(\".ui-bizagi-render-label\", control).text(val);\n    }\n  } });","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutText\", bizagi.rendering.layoutText.prototype);\n\nbizagi.rendering.smartphone.layoutText.extend(\"bizagi.rendering.smartphone.layoutText\", {\n  setDisplayValue: function setDisplayValue(value) {\n  } });","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\n\nbizagi.rendering.smartphone.layoutNumber.extend(\"bizagi.rendering.smartphone.layoutNumber\", {\n  /**\r\n                                                                                               * Sets the value in the rendered control\r\n                                                                                               */\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    var control = self.getControl();\n    val = typeof val === \"undefined\" || val === null ? \"\" : self.getDisplayValue(val);\n    self.properties.displayName = val;\n\n    this._super(val, triggerEvents);\n    if (control) {\n      $(\".ui-bizagi-render-number\", control).text(val);\n    }\n  },\n\n  /**\r\n      * Returns the display value of the render\r\n      */\n  getDisplayValue: function getDisplayValue(value) {\n    var self = this;\n    var properties = self.properties;\n    var label = $('<label/>').html(value); // To get the display value by the format currency plugin, because it requires a control\n\n    label.formatCurrency({\n      symbol: properties.symbol,\n      positiveFormat: properties.positiveFormat,\n      negativeFormat: properties.negativeFormat,\n      decimalSymbol: properties.decimalSymbol,\n      digitGroupSymbol: properties.digitGroupSymbol,\n      groupDigits: properties.groupDigits,\n      roundToDecimalPlace: properties.numDecimals,\n      colorize: properties.colorize });\n\n\n    return [label.text()];\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Template Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to smartphone devices\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\n// Extends itself\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", {\n  /**\r\n                                                                                             * Sets the value in the rendered control\r\n                                                                                             */\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    var control = self.getControl();\n\n    val = typeof val === \"undefined\" || val === null ? \"\" : self.getDisplayValue(val);\n    self.properties.displayName = val;\n\n    this._super(val, triggerEvents);\n    if (control) {\n      $(\".ui-bizagi-render-number\", control).text(val);\n    }\n  } });","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\n\nbizagi.rendering.smartphone.layoutUpload.extend(\"bizagi.rendering.smartphone.layoutUpload\", {\n  /**\r\n                                                                                               *   Template method to implement in each children to customize each control\r\n                                                                                               */\n  renderControl: function renderControl() {\n    var self = this,\n    properties = self.properties,\n    defer = $.Deferred();\n\n    $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function (properties, valueResult) {\n      self.properties = properties;\n      self.files = valueResult.files;\n      defer.resolve(self.getHTMLFiles());\n    });\n\n    return defer.promise();\n  },\n\n  getHTMLFiles: function getHTMLFiles() {\n    var self = this;\n    var files = $.map(self.files, function (el) {\n      var file = { \"id\": el[0], \"filename\": el[1] };\n      file.url = self.buildItemUrl(file);\n      return file;\n    });\n\n    var template = self.renderFactory.getTemplate(\"layout-upload\");\n    return $.fasttmpl(template, { \"files\": files });\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n    var filesLinkElements = control.find(\".ui-bizagi-render-upload-item a\");\n\n    filesLinkElements.on(\"click\", function () {\n      bizagi.loading.start();\n      $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\n        if (error.responseText) {\n          self.getFormContainer().failHandler(error.responseText);\n        }\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  /**\r\n      *   Builds the upload item url\r\n      */\n  buildItemUrl: function buildItemUrl(file) {\n    var self = this,\n    properties = self.properties;\n\n    var form = self.getFormContainer();\n\n    return self.dataService.getUploadFileEntityUrl({\n      isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\n      xpath: self.getUploadXpath(),\n      fileId: file.id,\n      idRender: form.properties.paramsRender.idRender || \"undefined\",\n      xpathContext: properties.xpathContext,\n      idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\n      xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\n      sessionId: form.properties.sessionId,\n      surrogatekey: self.properties.value.surrogateKey,\n      guidentity: self.properties.value.guid });\n\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\n\n// Extends itself\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.smartphone.columns.column\", {}, {\n\n  /*\r\n                                                                                           *   Apply custom overrides to each decorated instance\r\n                                                                                           */\n  applyOverrides: function applyOverrides(decorated) {\n    // Hacks the getControl method in the decorated render to add features\n    if (decorated && decorated.getControl) {\n      this.originalGetControl = decorated.getControl;\n      decorated.getControl = this.getControl;\n      decorated.properties.displayType = \"normal\";\n    }\n  },\n\n  getContainerMessage: function getContainerMessage(surrogateKey) {\n    var decorated = this.getDecorated(surrogateKey);\n    return $(\".bz-form-cell-message__text\", decorated.element);\n  },\n\n  /*\r\n     *   Template method to get the control element\r\n     *   This code runs under the decorated element context\r\n     */\n  getControl: function getControl() {\n    return $(\".bz-control\", this.element || this.observableElement);\n  },\n\n  isValueValid: function isValueValid(surrogateKey, value, messages, propertyOverrides) {\n    var isValid = this._super(surrogateKey, value, messages, propertyOverrides);\n    var decorated = this.getDecorated(surrogateKey);\n    var $message = this.getContainerMessage(surrogateKey);\n\n    if (decorated && decorated.element) {\n      if (!isValid) {\n        var message = messages.join(\",\").replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\n        $message.text(message);\n        decorated.element.addClass(\"bz-form-item--error\");\n      } else {\n        $message.text(\"\");\n        decorated.element.removeClass(\"bz-form-item--error\");\n      }\n    }\n\n    return isValid;\n  },\n\n  /*\r\n     *   Apply column styles to a specified element\r\n     */\n  applyColumnStyles: function applyColumnStyles(element) {\n    var self = this;\n    var properties = self.properties;\n\n    // Set cell back color\n    if (properties.textFormat.background) {\n      element.css(\"background-color\", properties.textFormat.background);\n      element.css(\"background-image\", \"none\");\n    }\n  },\n\n  /*\r\n     *   Post process the element after it has been rendered\r\n     */\n  postRenderReadOnly: function postRenderReadOnly(surrogateKey, cell) {\n    var self = this;\n\n    // Call base        \n    self._super(surrogateKey, cell);\n\n    // Just draw render if the cell layout has been filled\n    if (cell && cell.length > 0) {\n      var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\n      if (!self.properties.editable) cellIcon.detach();\n\n      // Apply styles to cell\n      self.applyColumnStyles(cell);\n\n      if (self.properties.align == \"left\") {\n        cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\n      }\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Document Generator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.document\", {}, {\n\n  /**\r\n                                                                                                         * Apply custom overrides to each decorated instance\r\n                                                                                                         * @param decorated\r\n                                                                                                         */\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode !== \"design\") {\n      self.surrogateKey = decorated.surrogateKey;\n\n      decorated.getXpath = this.getXpath;\n      decorated.getDocumentXpath = this.getDocumentXpath;\n      decorated.getContextXpath = this.getContextXpath;\n      decorated.documentTemplateGenerate = this.documentTemplateGenerate;\n      decorated.preRenderControl = this.preRenderControl;\n      decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\n      decorated.properties.xpathContext = self.getContextXpath();\n    }\n  },\n\n  /**\r\n      * This method tries to get the HTML template an render the current object inside\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderControl: function renderControl() {\n    this.preRenderControl();\n\n    return this._super();\n  },\n\n  /**\r\n      * Creates the event of generation of templates.\r\n      */\n  documentTemplateGenerate: function documentTemplateGenerate() {\n    var self = this;\n    var properties = self.properties;\n\n    self.startLoading();\n\n    // Get the context xPath\n    properties.xpathcontext = self.getContextXpath();\n    properties.xpath = self.getDocumentXpath(properties.xpath);\n\n    var grid = self.parent;\n    var form = self.getFormContainer();\n\n    $.when(form.submitData()).done(function () {\n      $.when(self.dataService.generateDocumentTemplate(properties)).done(function (response) {\n        $.when(grid.refresh()).done(function () {\n          self.autoOpenDocuments();\n        });\n\n        self.endLoading();\n\n      }).fail(function () {\n        self.showErrorMessage();\n        self.endLoading();\n      });\n    }).fail(function (message) {\n      // Add error messages\n      self.getFormContainer().addErrorMessage(message);\n\n      self.endLoading();\n    });\n  },\n\n  /**\r\n      * Apply custom overrides to each decorated instance\r\n      * @param xpath\r\n      * @returns {string}\r\n      */\n  getXpath: function getXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @param xpath\r\n      * @returns {*|string}\r\n      */\n  getDocumentXpath: function getDocumentXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return xpathPath;\n  },\n\n  /**\r\n      * Post process the element after it has been rendered\r\n      * @param surrogateKey\r\n      * @param cell\r\n      * @param tableCell\r\n      */\n  postRenderReadOnly: function postRenderReadOnly(surrogateKey, cell, tableCell) {\n    // Call base\n    this._super(surrogateKey, cell, tableCell);\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @returns {string}\r\n      */\n  getContextXpath: function getContextXpath() {\n    var self = this;\n    var form = self.getFormContainer();\n    var xpathContext = form.properties.xpathContext ? form.properties.xpathContext + \".\" : \"\";\n    return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n  },\n\n  /**\r\n      * Template method to implement in each children to customize each control\r\n      */\n  preRenderControl: function preRenderControl() {\n    if (this.value != undefined && this.properties.value != undefined) {\n      this.properties.value = this.value;\n    }\n  },\n\n  /**\r\n      * Creates the event of generation of templates.\r\n      * @param filename\r\n      */\n  deleteDocumentTemplate: function deleteDocumentTemplate(filename) {\n    var self = this;\n    var grid = self.parent;\n    var params = {};\n\n    params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\n    params.idRender = self.properties.id;\n    params.xpathContext = self.getContextXpath();\n    params.idPageCache = self.properties.idPageCache;\n\n    $.when(self.dataService.deleteUploadFile(params)).done(function () {\n      grid.refresh();\n    });\n  } });","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.date\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Text Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.text\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Number Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.number\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.image\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n\n    this._super(decorated);\n\n    var propertiesGrid = self.grid.properties != \"undefined\" ? self.grid.properties : decorated.grid.properties;\n    var xpath = propertiesGrid.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\n    //decorated.getUploadXpath = this.getUploadXpath;\n    decorated.properties.xpathContext =\n    self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\n    decorated.setDisplayValue = function () {\n      return true;\n    };\n  }\n  /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\n  /*getUploadXpath: function() {\r\n            return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n        }*/ });","/*\r\n*   Name: Bizagi smartphone Upload Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the upload column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.upload\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode != \"design\" && mode != \"layout\") {\n\n      decorated.getUploadXpath = self.getUploadXpath;\n\n      decorated.getXpathContext = function () {\n\n        var surrogateKey = this.surrogateKey || \"\";\n        var columnXpath = self.getUploadXpath(decorated);\n        var columnXpathSplit = columnXpath.split(\".\");\n        var nameFile = columnXpathSplit[columnXpathSplit.length - 1];\n        var xpath = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\n\n        var xpathContext = self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\n\n        return { xpathContext: xpathContext, nameFile: nameFile };\n      };\n\n      decorated.buildItemUrl = function (file) {\n        var that = this;\n        var form = that.getFormContainer();\n        var context = that.getXpathContext();\n\n        return that.dataService.getUploadFileUrl({\n          idRender: that.properties.id,\n          xpath: context.nameFile,\n          xpathContext: context.xpathContext,\n          idPageCache: that.properties.idPageCache,\n          fileId: file.id,\n          sessionId: form.properties.sessionId,\n          contexttype: that.properties.contexttype });\n\n      };\n\n    }\n  },\n\n  /**\r\n      * Returns the xpath to be used  \r\n      * @param {} decorated \r\n      * @returns {} \r\n      */\n  getUploadXpath: function getUploadXpath(decorated) {\n    var self = decorated || this;\n\n    return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\n  } });","/**\r\n *   Name: Bizagi Smartphone Link Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.link\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode !== \"design\" && mode !== \"layout\") {\n      self.surrogateKey = decorated.surrogateKey;\n\n      decorated.getXpath = self.getXpath;\n      decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\n\n      if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) === -1) {\n        decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\n      }\n\n    }\n\n    if (decorated.properties.type === \"columnFormLink\") {\n      decorated.getFormLinkXpath = this.getFormLinkXpath;\n    }\n  },\n\n  /**\r\n      * Apply custom overrides to each decorated instance\r\n      * @param {} xpath\r\n      * @returns {}\r\n      */\n  getXpath: function getXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @returns {}\r\n      */\n  getContextXpath: function getContextXpath() {\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n  },\n\n  /**\r\n      * Get Form Link xpath to use\r\n      * @returns {*}\r\n      */\n  getFormLinkXpath: function getFormLinkXpath() {\n    // Calculate layout properties to maximized property\n    this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) !== null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\n    this.calculateInitialLayoutProperties();\n\n    if (!this.properties.xpath) return;\n    return this.properties.xpath;\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.search\", {}, bizagi.rendering.columns.search.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.search.extend(\"bizagi.rendering.smartphone.columns.search\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    this._super(decorated);\n  },\n\n  render: function render(surrogateKey, value) {\n    var self = this;\n    if (value && value.length > 0) {\n      value = [].concat(value[0]);\n      return self._super(surrogateKey, {\n        id: value[0],\n        label: value[1],\n        additionallabel: value[2] || undefined });\n\n    } else {\n      return self._super(surrogateKey, value);\n    }\n  },\n\n  /*\r\n     *   Post process the element after it has been rendered\r\n     */\n  postRender: function postRender(surrogateKey, cell) {\n    // Call base\n    this._super(surrogateKey, cell);\n    var decorated = this.getDecorated(surrogateKey);\n    decorated.refreshControl = this.refreshControl;\n  },\n\n  refreshControl: function refreshControl() {\n    this.grid.refreshCell({\n      key: this.surrogateKey,\n      column: this.properties.xpath,\n      xpathContext: this.getFormContainer().properties.xpathContext });\n\n  } });","/*\r\n*   Name: Bizagi Smartphone ECM Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the ECM column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.uploadecm\", {}, {\n\n  /**\r\n                                                                                                          * Apply custom overrides to each decorated instance\r\n                                                                                                          * @param {} decorated      \r\n                                                                                                          */\n  applyOverrides: function applyOverrides(decorated) {\n    this._super(decorated);\n\n    if (decorated && decorated.getControl) {\n      this.originalGetControl = decorated.getControl;\n      decorated.getControl = this.getControl;\n    }\n\n    decorated.getUploadXpath = this.getUploadXpath;\n    decorated.getXpathContext = this.getECMXpathContext;\n\n    decorated.buildItemUrl = function (file) {\n      var self = this;\n      var properties = self.properties;\n      var form = self.getFormContainer();\n      var columnXpath = self.getUploadXpath(self.surrogateKey);\n\n      columnXpath = columnXpath.split(\".\");\n\n      var nameFile = columnXpath[columnXpath.length - 1];\n      var xpathContext = self.getXpathContext(self.surrogateKey);\n\n      return self.dataService.getUploadFileUrl({\n        idRender: properties.id,\n        xpath: nameFile,\n        xpathContext: xpathContext,\n        idPageCache: properties.idPageCache,\n        fileId: file.idFileUpload,\n        sessionId: form.properties.sessionId,\n        contexttype: properties.contexttype });\n\n    };\n\n    decorated.buildAddParams = function () {\n      var self = this;\n      var properties = self.properties;\n      var form = self.getFormContainer();\n      var columnXpath = self.getUploadXpath(self.surrogateKey);\n\n      columnXpath = columnXpath.split(\".\");\n      var nameFile = columnXpath[columnXpath.length - 1];\n      var xpathContext = self.getXpathContext(self.surrogateKey);\n\n      var data = {\n        url: properties.addUrl,\n        xpath: properties.xpath,\n        idAttrib: properties.idAttrib,\n        xpathContext: xpathContext,\n        metaValues: [],\n        idSession: form.properties.sessionId,\n        contexttype: \"entity\",\n        validExtensions: properties.validExtensions,\n        maxSize: properties.maxSize };\n\n\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\n\n      return data;\n    };\n  },\n\n  /**\r\n      * Post process the element after it has been rendered\r\n      * @param {} surrogateKey      \r\n      */\n  getUploadXpath: function getUploadXpath(surrogateKey) {\n    surrogateKey = this.surrogateKey || surrogateKey || \"\";\n    return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\n  },\n\n\n  getControl: function getControl() {\n    var result = this._super();\n\n    if (!result || result.length == 0) {\n      return $(\".ui-bizagi-cell-readonly\", this.element || this.observableElement);\n    } else {\n      return $(\".bz-control\", this.element || this.observableElement);\n    }\n\n  },\n\n  getECMXpathContext: function getECMXpathContext() {\n    var xpath = this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n\n    return this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" + xpath : xpath;\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.button\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from column\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.radio\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to Smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.list\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.exclusiveCheck\", {}, {\n\n  /*\r\n                                                                                                               *   Returns the in-memory processed element\r\n                                                                                                               *   so the caller could append it to any place\r\n                                                                                                               */\n  render: function render(surrogateKey, value) {\n\n    var self = this;\n    // Set flag to check when a render has changed\n    self.changed = false;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var gridChanges = self.grid.changes;\n    // Set grid and id references to the control in order to render the content\n    var decorated = self.getDecorated(surrogateKey);\n    decorated.grid = self.grid;\n    decorated.column = this;\n    decorated.surrogateKey = surrogateKey;\n\n    value = self.mapValue(value);\n    // Set cell value\n    if (self.getMode() == \"execution\") {\n      self.setValue(surrogateKey, value);\n      //Add to enabledCheck\n      if (form.isOfflineForm) {\n        self.mapEnabledOfflineChecks();\n      } else\n      {\n        self.mapEnabledCheck(surrogateKey, value);\n      }\n    }\n    if (value == null) {\n      self.changed = true;\n      var obj = {};\n      obj[self.properties.xpath] = self.getValue(surrogateKey);\n      if (bizagi.util.isEmpty(gridChanges[surrogateKey])) gridChanges[surrogateKey] = {};\n      gridChanges[surrogateKey] = $.extend({}, gridChanges[surrogateKey], obj);\n    }\n\n    // Override render properties\n    self.overrideDecoratedRenderProperties(surrogateKey);\n\n\n    // If the render is not editable return the readonly version of the column\n    if (!properties.editable)\n    return self.renderReadOnly.apply(self, arguments);\n\n    // Returns the decorated render inside a custom layout for columns\n    self.readyDeferred = new $.Deferred();\n    var cell = decorated.render(\"cell\");\n\n    // If the render changes set the flag on\n    decorated.bind(\"renderchange\", function () {\n      self.changed = true;\n      var checkList = self.grid.enabledChecks[self.properties.xpath];\n\n      checkList.forEach(function (el) {\n        if (el.id == surrogateKey) {\n          el.value = decorated.value;\n          el.changed = true;\n        } else\n        if (decorated.value && el.value) {\n          var tmpDecorated = self.getDecorated(el.id);\n          tmpDecorated.setDisplayValue(false);\n          self.setValue(el.id, false);\n          el.value = false;\n          el.changed = true;\n          if (form.isOfflineForm) {\n            self.handleOfflineChange(tmpDecorated, el);\n          }\n        }\n      });\n\n      var simpleXpathArray = self.properties.xpath.split(\".\");\n      self.grid.exclusiveChanges[self.properties.xpath] = {\n        xpath: self.properties.xpath,\n        simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\n        value: self.getValue(surrogateKey),\n        key: surrogateKey };\n\n    });\n\n    self.bind(\"rendered\", function () {\n      self.readyDeferred.resolve();\n    });\n\n\n    return cell;\n  },\n\n  /*\r\n      *   Post process the element after it has been rendered\r\n      */\n  postRender: function postRender(surrogateKey, cell) {\n    // Call base\n    this._super(surrogateKey, cell);\n\n    var self = this;\n    var mode = self.getMode();\n\n    this.setSurrogateKey(surrogateKey);\n    if (mode == \"execution\") {\n\n      var decorated = this.getDecorated(surrogateKey);\n      var control = decorated.getControl();\n\n      // Check if its new row\n      if (control.parents(\"tr\").data(\"new-row\")) {\n        // Show a disabled check box\n        control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\n\n        //Set the column with this attribute, so when the control is evaluated in isValid(), validated\n        //also if it is required, and belongs from a new row\n        self.isNewRow = true;\n      } else {\n        self.isNewRow = false;\n      }\n    }\n  },\n\n  isValueValid: function isValueValid(surrogateKey, value, invalidElements, propertyOverrides) {\n    var self = this;\n    self.grid.enabledChecks = self.grid.enabledChecks || {};\n    var checkedValues = (self.grid.enabledChecks[self.properties.xpath] || []).filter(function (el) {\n      return el.value;\n    });\n\n    if (checkedValues.length > 1) {\n      var message = self.getResource(\"render-exclusive-column-check-error\").replaceAll(\"#label#\", self.properties.displayName);\n      /* var messageData = {xpath: self.properties.xpath, message: message}; */\n      invalidElements.push(message);\n      return false;\n    } else {\n      return true;\n    }\n\n  },\n  /**\r\n     * Add change in grid changes and update grid data rows\r\n     * @param {*} decorated \r\n     * @param {*} element \r\n     */\n  handleOfflineChange: function handleOfflineChange(decorated, element) {\n    var self = this;\n    var gridChanges = self.grid.changes;\n    var newChange = {};\n    newChange[decorated.properties.xpath] = element.value;\n    if (bizagi.util.isEmpty(gridChanges[element.id])) gridChanges[element.id] = {};\n    gridChanges[element.id] = $.extend({}, gridChanges[element.id], newChange);\n    //Update grid data (grid.properties.data.completeRows)\n    self.updateGridData(element);\n  },\n  /**\r\n      * Update completeRows property of grid \r\n      */\n  updateGridData: function updateGridData(element) {\n    var gridProperties = this.grid.properties || {};\n    var data = gridProperties.data || {};\n    var row = (data.completeRows || []).find(function (r) {\n      return r[0] === element.id;\n    });\n    if (row && typeof row[this.columnIndex] !== \"undefined\") {\n      row[this.columnIndex] = element.value || false;\n    }\n  },\n  /**\r\n      * Add all enabled checks in offline grid\r\n      */\n  mapEnabledOfflineChecks: function mapEnabledOfflineChecks() {\n    var self = this;\n\n    var gridProperties = self.grid.properties || {};\n    var data = gridProperties.data || {};\n    var allRows = data.completeRows || [];\n    var columnIndex = self.columnIndex;\n    var enabledChecks = self.grid.enabledChecks;\n\n    allRows.forEach(function (row) {\n      var rowId = row[0];\n      var rowValue = row[columnIndex];\n\n      var tmpCheck = enabledChecks[self.properties.xpath].find(function (el) {\n        return el.id == rowId;\n      });\n\n      if (typeof tmpCheck === \"undefined\") {\n        enabledChecks[self.properties.xpath].push({\n          id: rowId,\n          value: rowValue,\n          originalValue: rowValue,\n          changed: false });\n\n      }\n    });\n  },\n  /**\r\n      * Add current check in enabled check\r\n      * @param {*} surrogateKey \r\n      * @param {*} value \r\n      */\n  mapEnabledCheck: function mapEnabledCheck(surrogateKey, value) {\n    var self = this;\n    var enabledChecks = self.grid.enabledChecks;\n\n    var tmpCheck = enabledChecks[self.properties.xpath].find(function (el) {\n      return el.id == surrogateKey;\n    });\n    if (typeof tmpCheck == \"undefined\") {\n      enabledChecks[self.properties.xpath].push({\n        id: surrogateKey,\n        value: value || false,\n        originalValue: value || false,\n        changed: false });\n\n    }\n  },\n  mapValue: function mapValue(value) {\n    var self = this;\n    value = value || false;\n    self.grid.changes = self.grid.changes || {};\n\n    if (value) {\n      for (var key in self.grid.changes) {\n        var changes = self.grid.changes;\n        if (changes[key][self.properties.xpath] && key != self.surrogateKey) {\n          value = false;\n          break;\n        }\n      }\n    }\n    return value;\n  } });","/**\r\n *   Name: Bizagi Smartphone Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from columns smartphone base\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.readonly.extend(\"bizagi.rendering.smartphone.columns.readonly\", {}, {});","/**\r\n *   Name: Bizagi Render Hidden Column Decorator Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n */\n\n// Extends from columns smartphone base\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.hidden\", bizagi.rendering.columns.hidden.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.hidden.extend(\"bizagi.rendering.smartphone.columns.hidden\", {}, {});","/**\r\n *   Name: Bizagi smartphone Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base and document base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.document\", bizagi.rendering.document.prototype);\n// Extends itself\nbizagi.rendering.smartphone.document.extend(\"bizagi.rendering.smartphone.document\", {\n  ACTION_SHOW: \"show\",\n  ACTION_DOWNLOAD: \"download\",\n  ACTION_DELETE: \"delete\" },\n{\n\n  /**\r\n   * This method tries to get the HTML template an render the current object inside\r\n   * @return {jQuery} $.Deferred()\r\n   */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(self.getTemplate());\n    var documents = this.properties.value || [];\n\n    var data = {\n      downloadalldocuments: this.properties.downloadalldocuments,\n      allowgenerate: this.properties.allowGenerate,\n      noFiles: documents ? documents.length === 0 : true,\n      append: this.properties.append,\n      caption: this.properties.caption };\n\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    var items = this.renderDocumentsHtml(documents);\n    html = this.replaceFilesHtml(html, items);\n\n    // Render current children\n    var actions = this.renderActionsHtml(documents, data.noFiles, data.downloadalldocuments);\n    html = this.replaceActionsHtml(html, actions);\n\n    return html;\n  },\n\n  /**\r\n      * Method to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$inputDocument = $(\".bz-document-template__container\", $control);\n    this.$listDocuments = $(\"[data-component=files]\", $control);\n    this.$listActions = $(\"[data-component=actions]\", $control);\n\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(self.getTemplateReadonly());\n    var documents = this.properties.value || [];\n    var noFiles = documents ? documents.length === 0 : true;\n\n    // Render template\n    var html = $.fasttmpl(template, { noFiles: noFiles });\n\n    // Render current children\n    var items = this.renderDocumentsHtml(documents);\n    html = this.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n\n    this.$listDocuments = $(\"[data-component=files]\", $control);\n  },\n\n  /**\r\n      * TMethod to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Attach handler\n    this.$inputDocument.on(\"click\", function (evt) {\n      self.properties.buttonExecuted = true;\n\n      if (self.properties.validate) {\n        // Check if the form is valid, then generate\n        if (self.validateContainer()) self.documentTemplateGenerate();\n      } else {\n        // Just generate the form\n        self.documentTemplateGenerate();\n      }\n\n      self.properties.buttonExecuted = false;\n    });\n\n    // Configure delete and preview handler\n    this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n\n    // Configure delete and download handler\n    self.$listActions.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document__download\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n\n    // Configure delete and preview handler\n    this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n  },\n\n  /**\r\n      * This method must be implemented by the specific class of each device. (Virtual method)\r\n      * @param file\r\n      * @returns {*|*|*}\r\n      */\n  renderAllDocumentDownload: function renderAllDocumentDownload(file) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(self.getTemplateDownload());\n    var url = self.buildAllDocumentsUrl();\n\n    // Don't render urls when not running in execution mode\n    if (!this.isExecutionMode()) url = \"javascript:void(0);\";\n\n    var html = $.fasttmpl(template, {\n      url: url,\n      filename: file.fileName,\n      joined: true });\n\n\n    return html;\n  },\n\n  /**\r\n      * Redraw documents when needed\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  redrawDocuments: function redrawDocuments(documents, noFiles, downloadAllDocuments) {\n    var self = this;\n    var $control = self.getControl();\n    var $documentContainer = $(\"[data-component='files']\", $control);\n    var $actionContainer = $(\"[data-component='actions']\", $control);\n\n    // Clear current links\n    $documentContainer.empty();\n    $actionContainer.empty();\n\n    // Draw links again\n    var items = this.renderDocumentsHtml(documents);\n    $documentContainer.append(items);\n\n    // Check if there are documents and the flag to download all are available to show the link.\n    var actions = this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\n    $actionContainer.append(actions);\n\n    //Set value\n    self.setValue(documents);\n  },\n\n  /**\r\n      * Method to customize each render after processed (Virtual method)\r\n      * @param url\r\n      * @param filename\r\n      */\n  showDocumentPreview: function showDocumentPreview(url, filename) {\n    var self = this;\n    bizagi.loading.start();\n\n    $.when(bizagi.util.media.downloadFile(url, filename)).\n    fail(function (error) {\n      if (error.responseText) {\n        self.getFormContainer().failHandler(error.responseText);\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Process request of DocumentTemplateGenerate action\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  resolveDocumentTemplateGenerate: function resolveDocumentTemplateGenerate(documents, noFiles, downloadAllDocuments) {\n    // Redraw documents\n    this.redrawDocuments(documents, noFiles, downloadAllDocuments);\n    this.value = documents;\n  },\n\n  /**\r\n      * Process request of DocumentTemplateGenerate action\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  resolveDeleteDocumentTemplate: function resolveDeleteDocumentTemplate(documents, noFiles, downloadAllDocuments) {\n    // Redraw documents\n    this.redrawDocuments(documents, noFiles, downloadAllDocuments);\n    this.value = documents;\n  },\n\n  processAction: function processAction(action, documentFile) {\n    if (action === this.Class.ACTION_DELETE) {\n      this.deleteDocumentTemplate(documentFile.filename);\n    } else if (action === this.Class.ACTION_SHOW) {\n      this.showDocumentPreview(documentFile.url, documentFile.filename);\n    } else if (action === this.Class.ACTION_DOWNLOAD) {\n      this.showDocumentPreview(documentFile.url, documentFile.filename);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone queryForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n *   -   Will apply a desktop form template\r\n */\n\n// Extends from form smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.queryForm\", {}, {});","/**\r\n *   Name: Bizagi Smartphone FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to smartphone devices\r\n */\n\n// Extends from form smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.formTemplate\", bizagi.rendering.formTemplate.prototype);\n// Extends itself\nbizagi.rendering.smartphone.formTemplate.extend(\"bizagi.rendering.smartphone.formTemplate\", {}, {});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\n\n// Extends from container smartphone form base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.usersForm\", {}, {});","/*\r\n *   Name: BizAgi Render Text Class\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\n\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.specific_text\", {}, {\n\n  /*\r\n                                                                                             *   Update or init the element data\r\n                                                                                             */\n  initializeData: function initializeData(data) {\n    var self = this;\n    // Call base\n    this._super(data);\n\n    // Fill default properties\n    var properties = this.properties;\n    if (properties.regularExpressionExpression) {\n      properties.regularExpression = {\n        \"expression\": properties.regularExpressionExpression,\n        \"message\": properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\") };\n\n    }\n  },\n  /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\n  renderControl: function renderControl() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"text\");\n    // Render template\n    var html = $.fasttmpl(template, { value: properties.value, \"isEmptyField\": typeof properties.value === \"undefined\", helpText: properties.helpText, editable: properties.editable });\n    return html;\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"text-read-only\");\n\n    // Render template\n    var html = $.fasttmpl(template, { value: self.getValue() });\n    return html;\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n\n    // Call base\n    self._super();\n\n    self.input = control.find(\"input\");\n    //Attach event for retype double\n    if (properties.retype == \"double\") {\n      self.attachRetypeDouble();\n    }\n\n  },\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length == 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      if ($(control).attr(\"type\") != \"hidden\" &&\n      $(control).css(\"display\") != \"none\" &&\n      $(control).css(\"visibility\") != \"hidden\") {\n\n        if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\n\n          // Check that there is something in the value\n          if (control.val() == \"\")\n          return;\n\n          // Check if a value has already been set\n          if (control.val() == control.attr(\"newValue\"))\n          return;\n\n          control.data(\"oldValue\", control.val());\n          control.val(\"\");\n          // Create new tooltip\n          try {\n            control.tooltip(\"destroy\");\n          } catch (e) {}\n          control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\n          control.tooltip();\n          control.tooltip(\"open\");\n          // Focus after 100ms to avoid bubbling\n          setTimeout(function () {control.focus();input.focus();}, 100);\n\n        } else\n\n        {\n          if (control.val() != control.data(\"oldValue\")) {\n            self.setValue(\"\");\n            control.val(\"\");\n            control.data(\"oldValue\", \"\");\n            control.tooltip(\"destroy\");\n            control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\n            control.tooltip();\n            control.tooltip(\"open\");\n            setTimeout(function () {control.focus();}, 100);\n          } else {\n\n            control.data(\"newValue\", control.val());\n            control.data(\"oldValue\", \"\");\n            // Destroy tooltips\n            control.tooltip(\"destroy\");\n          }\n\n        }\n      }\n    });\n\n  },\n  /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    var input = self.input;\n\n    // Check mask property\n    if (properties.mask) {\n      self.input.mask({ mask: properties.mask });\n    }\n\n    // Attach change event\n    self.input.bind(\"change\", function () {\n\n      // Updates internal value\n      var oldValue = self.getValue();\n      self.setValue(self.input.val(), false);\n\n      // Check that the value is valid\n      var validationMessages = [];\n      if (properties.retype != \"duplicate\") {\n        if (self.isValid(validationMessages) || typeof properties.regularExpression == \"undefined\") {\n          // Update value again triggering handlers\n          self.setValue(self.input.val(), true);\n        } else {\n          // Set error message\n          message = validationMessages[0].message;\n          //bizagi.showMessageBox(message, \"Bizagi\", \"error\");\n        }\n      }\n\n    }).keypress(function (e) {\n      e = window.event || e;\n      var keyUnicode = e.charCode || e.keyCode;\n      if (e !== undefined) {\n        if (keyUnicode == 13) {\n          $(this).trigger(\"change\");\n        }\n      }\n    });\n  },\n  /* \r\n     * Public method to determine if a value is valid or not\r\n     */\n  isValid: function isValid(invalidElements) {\n    var self = this,\n    properties = self.properties;\n\n    // Call base\n    var bValid = this._super(invalidElements);\n    var value = self.getValue();\n\n    //When the form have big data, block browser executing RegExp. QAF-1418.\n    // Check regular expression\n    if (typeof value == \"string\") {\n      if (properties.regularExpression) {\n        if (value && (value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\")) || !value.match(new RegExp(properties.regularExpression.expression)) && self.properties && self.properties.xpath === \"userName\")) {\n          var message = properties.regularExpression.message;\n          invalidElements.push({ xpath: properties.xpath, message: message });\n          bValid = false;\n        } else {\n          if (value && (value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\")) || !value.match(new RegExp(properties.regularExpression.expression)))) {\n            var message = properties.regularExpression.message;\n            invalidElements.push({ xpath: properties.xpath, message: message });\n            bValid = false;\n          }\n        }\n      } else {\n        //strange behavior on IE. When matchs are united on IE have is very slow\n        //solution, divide matchs\n        //.*? means for more information search: \"Lazy matching regexp\"\n        if (value && value.match(new RegExp(\".*?eval\\\\(\", \"g\")) && value.match(new RegExp(\".*?eval\\\\u0028\", \"g\"))) {\n          if (properties.editable) {\n            var message = this.getResource(\"render-text-regular-expression-default-message\");\n            invalidElements.push({ xpath: properties.xpath, message: message });\n            bValid = false;\n          }\n        }\n      }\n    }\n\n    return bValid;\n  },\n  /*\r\n     *   Sets the value in the rendered control\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var control = self.getControl();\n    var displayValue = self.getDisplayValue();\n\n    if (!bizagi.util.parseBoolean(self.properties.editable)) {\n      // Render as simple value\n      if (typeof value == \"string\") {\n        // Replace line breaks for html line breaks\n        var valueToDisplay = displayValue.replaceAll(\"&\", \"&amp;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\n        control.html(\"<input class='readonly-control bz-form-control' readonly='readonly' value=\" + valueToDisplay + \" >\");\n\n      } else {\n        if (bizagi.util.isNull(value)) {\n          control.html(\"\");\n        }\n      }\n    }\n    // Set internal value\n    self.setValue(value, false);\n  },\n\n  /*\r\n     *   Execute design only methods\r\n     */\n  performDesignModeMethods: function performDesignModeMethods() {\n    var self = this;\n    var properties = self.properties;\n\n    // Set all controls read-only\n    var control = self.getControl();\n    //Valid control\n    if (control !== null) {\n      $(\"select, button, textarea\", control).attr(\"readonly\", true);\n    }\n    // Execute custom code for each render\n    self.configureDesignView();\n\n    // Set initial value\n    self.internalSetInitialValue();\n  } });","/*\r\n*   Name: Bizagi Smartphone Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define a render factory to create smartphone versions of each render type\r\n*/\n\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.smartphone.factory\", {}, {\n\n  /**\r\n                                                                                   * Load all the templates used for rendering\r\n                                                                                   * @returns {} \r\n                                                                                   */\n  loadTemplates: function loadTemplates() {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(\n    // Icons\n    self.loadTemplate(\"icons\", self.getFileTemplate(\"common.bizagi.rendering.icons\")),\n\n    // Containers\n    self.loadTemplate(\"form\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-container\"),\n    self.loadTemplate(\"complexgateway\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-complex-gateway\"),\n\n    self.loadTemplate(\"panel\", self.getFileTemplate(\"bizagi.rendering.smartphone.panel\")),\n    self.loadTemplate(\"tab\", self.getFileTemplate(\"bizagi.rendering.smartphone.tab\")),\n    self.loadTemplate(\"tabItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.tabItem\")),\n    self.loadTemplate(\"horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.horizontal\")),\n    self.loadTemplate(\"group\", self.getFileTemplate(\"bizagi.rendering.smartphone.group\")),\n    self.loadTemplate(\"section\", self.getFileTemplate(\"bizagi.rendering.smartphone.section\")),\n    self.loadTemplate(\"searchForm\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchForm\")),\n    self.loadTemplate(\"accordion\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordion\")),\n    self.loadTemplate(\"accordionItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordionItem\")),\n    self.loadTemplate(\"contentPanel\", self.getFileTemplate(\"bizagi.rendering.smartphone.contentPanel\")),\n\n    // Renders\n    self.loadTemplate(\"render\", self.getFileTemplate(\"bizagi.rendering.smartphone.render\")),\n    self.loadTemplate(\"readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.readonly\")),\n    self.loadTemplate(\"readonly-value\", self.getFileTemplate(\"bizagi.rendering.smartphone.readonly\")),\n    self.loadTemplate(\"text\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text\"),\n    self.loadTemplate(\"text-read-only\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text-readonly\"),\n\n    self.loadTemplate(\"number\", self.getFileTemplate(\"bizagi.rendering.smartphone.number\")),\n    self.loadTemplate(\"extendedText\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text\"),\n    self.loadTemplate(\"extendedText-readOnly\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text-readonly\"),\n    self.loadTemplate(\"date\", self.getFileTemplate(\"bizagi.rendering.smartphone.date\")),\n    self.loadTemplate(\"yesno\", self.getFileTemplate(\"bizagi.rendering.smartphone.yesno\")),\n    self.loadTemplate(\"check\", self.getFileTemplate(\"bizagi.rendering.smartphone.check\")),\n    self.loadTemplate(\"checkList\", self.getFileTemplate(\"bizagi.rendering.smartphone.checkList\")),\n    self.loadTemplate(\"button\", self.getFileTemplate(\"bizagi.rendering.smartphone.button\")),\n    self.loadTemplate(\"link\", self.getFileTemplate(\"bizagi.rendering.smartphone.link\")),\n    self.loadTemplate(\"formLink\", self.getFileTemplate(\"bizagi.rendering.smartphone.formLink\")),\n    self.loadTemplate(\"geolocation\", self.getFileTemplate(\"bizagi.rendering.smartphone.geolocation\")),\n    self.loadTemplate(\"radio\", self.getFileTemplate(\"bizagi.rendering.smartphone.radio\")),\n\n    self.loadTemplate('association', self.getFileTemplate('bizagi.rendering.smartphone.association')),\n\n    self.loadTemplate(\"ecm\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm\"),\n    self.loadTemplate(\"ecm-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-item\"),\n    self.loadTemplate(\"ecm-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-readonly\"),\n\n    self.loadTemplate(\"image\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image\"),\n    self.loadTemplate(\"image-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-item\"),\n    self.loadTemplate(\"image-preview\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-preview\"),\n    self.loadTemplate(\"image-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-readonly\"),\n\n    self.loadTemplate(\"upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload\"),\n    self.loadTemplate(\"upload-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-readonly\"),\n    self.loadTemplate(\"upload-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-item\"),\n\n    self.loadTemplate(\"document\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator\"),\n    self.loadTemplate(\"document-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-item\"),\n    self.loadTemplate(\"document-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-readonly\"),\n    self.loadTemplate(\"document-download\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-download\"),\n\n    self.loadTemplate(\"list-multiselect\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect\"),\n    self.loadTemplate(\"multiselect-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect-list\"),\n\n    self.loadTemplate(\"combo\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control\"),\n    self.loadTemplate(\"combo-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-readonly\"),\n    self.loadTemplate(\"combo-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-list\"),\n\n    self.loadTemplate(\"modal-header-search\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-search\"),\n    self.loadTemplate(\"modal-header-title\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-title\"),\n    self.loadTemplate(\"modal-footer-done\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-footer-done\"),\n\n    self.loadTemplate(\"list\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list\"),\n    self.loadTemplate(\"list-items\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list-items\"),\n\n    self.loadTemplate(\"search\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search\"),\n    self.loadTemplate(\"search.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-item\"),\n    self.loadTemplate(\"search.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-items\"),\n\n    self.loadTemplate('searchList', self.getFileTemplate('bizagi.rendering.smartphone.searchList') + \"#bz-render-search-list\"),\n    self.loadTemplate(\"searchList.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-item\"),\n    self.loadTemplate(\"searchList.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-items\"),\n    self.loadTemplate(\"searchList.actions\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-actions\"),\n    self.loadTemplate(\"searchList.tag\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-tag\"),\n    self.loadTemplate(\"searchList.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-readonly\"),\n    self.loadTemplate(\"searchList-modal-header\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-modal-header\"),\n\n    self.loadTemplate(\"letter\", self.getFileTemplate(\"bizagi.rendering.smartphone.letter\")),\n\n    // Hand Signature\n    self.loadTemplate(\"hand-signature\", self.getFileTemplate(\"bizagi.rendering.smartphone.handSignature\") + \"#bz-signature\"),\n    self.loadTemplate(\"hand-signature-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.handSignature\") + \"#bz-signature-readonly\"),\n\n    //Renders commons\n    self.loadTemplate(\"form-error\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-error\")),\n    self.loadTemplate(\"form-waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-waiting\")),\n\n    // Action launcher\n    self.loadTemplate(\"render-actionLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\n    self.loadTemplate(\"render-actionLauncher-horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\n    self.loadTemplate(\"render-actionLauncher-vertical\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\n    self.loadTemplate(\"render-actionLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\n    self.loadTemplate(\"render-actionLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\n\n    // Polymorphic launcher\n    self.loadTemplate(\"render-polymorphicLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\n    self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\n    self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\n    self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\n    self.loadTemplate(\"render-polymorphicLauncher-confirm\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\n    self.loadTemplate(\"render-polymorphicLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\n\n    //GRIDS SMARTPHONES\n    self.loadTemplate(\"grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.grid\")),\n    self.loadTemplate(\"cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell\")),\n    self.loadTemplate(\"cell.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell.readonly\")),\n\n    //grid items\n    self.loadTemplate(\"bizagi.grid.grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid\"),\n    self.loadTemplate(\"bizagi.grid.totalizer\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-totalizer\"),\n    self.loadTemplate(\"bizagi.grid.waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-waiting\"),\n    self.loadTemplate(\"bizagi.grid.table\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table\"),\n    self.loadTemplate(\"bizagi.grid.table.empty\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table-empty\"),\n    self.loadTemplate(\"bizagi.grid.column\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column\"),\n    self.loadTemplate(\"bizagi.grid.column.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column-special\"),\n    self.loadTemplate(\"bizagi.grid.row\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row\"),\n    self.loadTemplate(\"bizagi.grid.row.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row-buttons\"),\n    self.loadTemplate(\"bizagi.grid.cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell\"),\n    self.loadTemplate(\"bizagi.grid.cell.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell-special\"),\n    self.loadTemplate(\"bizagi.grid.pager\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-pager\"),\n    self.loadTemplate(\"bizagi.grid.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-buttons\"),\n\n    // Renders Layouts\n    self.loadTemplate(\"render-layout\", self.getFileTemplate(\"bizagi.rendering.smartphone.render.layout\")),\n\n    self.loadTemplate(\"layout-image\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image\"),\n    self.loadTemplate(\"layout-image64\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\n    self.loadTemplate(\"layout-label\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.label\")),\n    self.loadTemplate(\"layout-link\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.link\")),\n    self.loadTemplate(\"layout-text\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.text\")),\n    self.loadTemplate(\"layout-date-time\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.dateTime\")),\n    self.loadTemplate(\"layout-money\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.money\")),\n    self.loadTemplate(\"layout-number\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.number\")),\n    self.loadTemplate(\"layout-upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.upload\"))).\n\n    done(function () {\n      var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\n      var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\n\n      if (svgStoreCounter === 0) {\n        $(\"head\").append(tmplIcons);\n      }\n\n      // Resolve when all templates are loaded\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  getFileTemplate: function getFileTemplate(src, onDemand) {\n    var device = bizagi.detectDevice();\n    return bizagi.getTemplate(src, onDemand, device == \"desktop\" ? \"smartphone_ios\" : device);\n  },\n\n  /**\r\n      * Returns the appropiate container based on the container type\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getContainer: function getContainer(params) {\n    var self = this;\n    var type = params.type;\n    var containerParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"form\")\n    return new bizagi.rendering.smartphone.form(containerParams);\n\n    if (type == \"template\")\n    return new bizagi.rendering.smartphone.formTemplate(containerParams);\n\n    if (type == \"queryForm\")\n    return new bizagi.rendering.smartphone.queryForm(containerParams);\n\n    if (type == \"layout\")\n    return new bizagi.rendering.smartphone.layout(containerParams);\n\n    if (type == \"usersForm\")\n    return new bizagi.rendering.smartphone.usersForm(containerParams);\n\n    if (type == \"panel\")\n    return new bizagi.rendering.smartphone.panel(containerParams);\n\n    if (/^contentpanel$/i.test(type))\n    return new bizagi.rendering.smartphone.contentPanel(containerParams);\n\n    if (/^nestedform$/i.test(type))\n    return new bizagi.rendering.smartphone.nestedForm(containerParams);\n\n    if (type == \"tab\")\n    return new bizagi.rendering.smartphone.tab(containerParams);\n\n    if (/^tabitem$/i.test(type))\n    return new bizagi.rendering.smartphone.tabItem(containerParams);\n\n    if (type == \"horizontal\")\n    return new bizagi.rendering.smartphone.horizontal(containerParams);\n\n    if (type == \"accordion\")\n    return new bizagi.rendering.smartphone.accordion(containerParams);\n\n    if (type == \"accordionItem\")\n    return new bizagi.rendering.smartphone.accordionItem(containerParams);\n\n    if (type == \"group\")\n    return new bizagi.rendering.smartphone.group(containerParams);\n\n    if (type == \"searchForm\") {\n      containerParams.context = \"search\";\n      containerParams.contexttype = \"metadata\";\n      return new bizagi.rendering.smartphone.searchForm(containerParams);\n    }\n\n    if (type == \"mobileform\")\n    return new bizagi.rendering.mobileform(containerParams);\n\n    if (type == \"mobilegroup\")\n    return new bizagi.rendering.mobilegroup(containerParams);\n\n    if (type == \"section\")\n    return new bizagi.rendering.smartphone.section(containerParams);\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\n\n    return null;\n  },\n\n  /**\r\n      * Returns the appropriate column based on the render type\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getColumn: function getColumn(params) {\n    var type = params.type;\n    var data = params.data;\n    var properties = data.properties;\n    var columnParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService,\n      singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"columnText\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      if (isExtended) {\n        // Creates one extended render\n        columnParams.decorated = bizagi.rendering.smartphone.extendedText;\n      } else {\n        // Creates one normal text render\n        columnParams.decorated = bizagi.rendering.smartphone.text;\n      }\n\n      return new bizagi.rendering.smartphone.columns.text(columnParams);\n    }\n\n    if (type == \"columnSearchList\") {\n      columnParams.decorated = bizagi.rendering.smartphone.searchList;\n      return new bizagi.rendering.smartphone.columns.searchList(columnParams);\n    }\n\n    if (type == \"columnNumber\") {\n      columnParams.decorated = bizagi.rendering.smartphone.number;\n      return new bizagi.rendering.smartphone.columns.number(columnParams);\n    }\n\n    if (type == \"columnMoney\") {\n      columnParams.decorated = bizagi.rendering.smartphone.money;\n      return new bizagi.rendering.smartphone.columns.number(columnParams);\n    }\n\n    if (type == \"columnDate\") {\n      columnParams.decorated = bizagi.rendering.smartphone.date;\n      return new bizagi.rendering.smartphone.columns.date(columnParams);\n    }\n\n    if (type == \"columnBoolean\") {\n      var display = data.properties.display || \"option\";\n\n      if (display == \"check\") {\n        // Creates one check render\n        columnParams.decorated = bizagi.rendering.smartphone.check;\n        if (params.data.properties.isExclusive) {\n          return new bizagi.rendering.smartphone.columns.exclusiveCheck(columnParams);\n        }\n      } else {\n        // Creates one yes-no render\n        columnParams.decorated = bizagi.rendering.smartphone.yesno;\n      }\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnCombo\") {\n      columnParams.decorated = bizagi.rendering.smartphone.combo;\n      return new bizagi.rendering.smartphone.columns.combo(columnParams);\n    }\n\n    if (type == \"columnRadio\") {\n      columnParams.decorated = bizagi.rendering.smartphone.radio;\n      return new bizagi.rendering.smartphone.columns.radio(columnParams);\n    }\n\n    if (type == \"columnList\") {\n      columnParams.decorated = bizagi.rendering.smartphone.list;\n      return new bizagi.rendering.smartphone.columns.list(columnParams);\n    }\n\n    if (type == \"columnHidden\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      columnParams.decorated = bizagi.rendering.smartphone.hidden;\n      return new bizagi.rendering.smartphone.columns.hidden(columnParams);\n    }\n\n    if (type == \"columnUpload\") {\n      columnParams.decorated = bizagi.rendering.smartphone.upload;\n      return new bizagi.rendering.smartphone.columns.upload(columnParams);\n    }\n\n    if (type == \"columnImage\") {\n      columnParams.decorated = bizagi.rendering.smartphone.image;\n      return new bizagi.rendering.smartphone.columns.image(columnParams);\n    }\n\n    if (type == \"columnUploadEcm\") {\n      columnParams.decorated = bizagi.rendering.smartphone.ecm;\n      return new bizagi.rendering.smartphone.columns.uploadecm(columnParams);\n    }\n\n    if (type == \"columnLink\") {\n      columnParams.decorated = bizagi.rendering.smartphone.link;\n      return new bizagi.rendering.smartphone.columns.link(columnParams);\n    }\n\n    if (type == \"columnFormLink\") {\n      columnParams.decorated = bizagi.rendering.smartphone.formLink;\n      return new bizagi.rendering.smartphone.columns.link(columnParams);\n    }\n\n    if (type == \"columnUserfield\") {\n      columnParams.decorated = bizagi.rendering.smartphone.userfieldWrapper;\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnSearch\") {\n      columnParams.decorated = bizagi.rendering.smartphone.search;\n      return new bizagi.rendering.smartphone.columns.search(columnParams);\n    }\n\n    if (type == \"columnLabel\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      columnParams.decorated = bizagi.rendering.smartphone.label;\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnReadonly\") {\n      columnParams.decorated = bizagi.rendering.smartphone.readonly;\n      return new bizagi.rendering.smartphone.columns.readonly(columnParams);\n    }\n\n    if (type == \"columnDocument\") {\n      columnParams.decorated = bizagi.rendering.smartphone.document;\n      return new bizagi.rendering.smartphone.columns.document(columnParams);\n    }\n\n    /*\r\n      Not supported\r\n       if (type == \"columnLetter\") {\r\n          columnParams.decorated = bizagi.rendering.letter;\r\n          return new bizagi.rendering.columns.letter(columnParams);\r\n      } */\n\n    if (type == \"columnButton\") {\n      columnParams.decorated = bizagi.rendering.smartphone.button;\n      return new bizagi.rendering.smartphone.columns.button(columnParams);\n    }\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  getRender: function getRender(params) {\n    var self = this;\n    var type = params.type;\n    var data = params.data;\n    var properties = data.properties;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    // Check is offline form        \n    var isOfflineForm = bizagi.util.isOfflineForm({ container: params.parent });\n\n    if (!type)\n    type = \"label\";\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"text\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      // Creates one extended render\n      if (isExtended) {\n        return new bizagi.rendering.smartphone.extendedText(renderParams);\n      }\n\n      // Creates one normal text render\n      return new bizagi.rendering.smartphone.text(renderParams);\n    }\n\n    if (type == \"association\") {\n      return new bizagi.rendering.smartphone.association(renderParams);\n    }\n\n    if (type == \"label\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      return new bizagi.rendering.smartphone.label(renderParams);\n    }\n\n    if (type == \"hidden\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      return new bizagi.rendering.smartphone.hidden(renderParams);\n    }\n\n    if (type == \"number\") {\n      // Number Scientific Notation\n      if (properties && properties.dataType === 29) {\n        return new bizagi.rendering.smartphone.numberScientificNotation(renderParams);\n      }\n\n      return new bizagi.rendering.smartphone.number(renderParams);\n    }\n\n    if (type == \"money\") {\n      return new bizagi.rendering.smartphone.money(renderParams);\n    }\n\n    if (type == \"date\") {\n      return new bizagi.rendering.smartphone.date(renderParams);\n    }\n\n    if (type == \"boolean\") {\n      var display = data.properties.display || \"option\";\n\n      // Creates one check render\n      if (display == \"check\") {\n        return new bizagi.rendering.smartphone.check(renderParams);\n      }\n\n      // Creates one yes-no render\n      return new bizagi.rendering.smartphone.yesno(renderParams);\n    }\n\n    if (type == \"combo\") {\n      return new bizagi.rendering.smartphone.combo(renderParams);\n    }\n\n    if (/^cascadingcombo$/i.test(type)) {\n      return new bizagi.rendering.smartphone.cascadingCombo(renderParams);\n    }\n\n    if (type == \"list\") {\n      return new bizagi.rendering.smartphone.list(renderParams);\n    }\n\n    if (type == \"radio\") {\n      return new bizagi.rendering.smartphone.radio(renderParams);\n    }\n\n    if (type == \"image\") {\n      return new bizagi.rendering.smartphone.image(renderParams);\n    }\n\n    if (type == \"uploadecm\") {\n      return new bizagi.rendering.smartphone.ecm(renderParams);\n    }\n\n    if (type == \"upload\") {\n      if (isOfflineForm) {\n        return new bizagi.rendering.smartphone.upload.offline(renderParams);\n      } else\n      {\n        return new bizagi.rendering.smartphone.upload(renderParams);\n      }\n    }\n\n    if (type == \"grid\") {\n      if (isOfflineForm) {\n        return new bizagi.rendering.smartphone.grid.offline(renderParams);\n      } else {\n        return new bizagi.rendering.smartphone.grid(renderParams);\n      }\n    }\n\n    if (type == \"groupedgrid\") {\n      // return new bizagi.rendering.smartphone.grid.grouped(renderParams);\n      return new bizagi.rendering.smartphone.grid(renderParams); // Not supported. Nonetheless, all entries are shown.\n    }\n\n    if (type == \"search\") {\n      return new bizagi.rendering.smartphone.search(renderParams);\n    }\n\n    if (type == \"suggest\") {\n      renderParams.data.properties.enableQuerySuggestBehavior = true;\n      return new bizagi.rendering.smartphone.search(renderParams);\n    }\n\n    if (type == \"searchList\") {\n      return new bizagi.rendering.smartphone.searchList(renderParams);\n    }\n\n    if (type == \"multiSelect\") {\n      return new bizagi.rendering.smartphone.multiSelect(renderParams);\n    }\n\n    if (type == \"button\") {\n      return new bizagi.rendering.smartphone.button(renderParams);\n    }\n\n    if (type == \"formLink\") {\n      return new bizagi.rendering.smartphone.formLink(renderParams);\n    }\n\n    if (type == \"link\") {\n      return new bizagi.rendering.smartphone.link(renderParams);\n    }\n\n    if (type == \"actionLauncher\") {\n      return new bizagi.rendering.smartphone.actionLauncher(renderParams);\n    }\n\n    if (type == \"entityTemplate\") {\n      return new bizagi.rendering.smartphone.entityTemplate(renderParams);\n    }\n\n    if (type == \"polymorphicLauncher\") {\n      return new bizagi.rendering.smartphone.polymorphicLauncher(renderParams);\n    }\n\n    if (type == \"userfield\") {\n      return new bizagi.rendering.smartphone.userfieldWrapper(renderParams);\n    }\n\n    // Check query renders (starts with \"query\")\n    //if (type.indexOf(\"query\") == 0) {\n    //    return this.getQueryRender(params);\n    //}\n\n    // Check search renders (starts with \"search\")\n    if (type.indexOf(\"search\") == 0) {\n      return this.getSearchRender(params);\n    }\n\n    if (type == \"document\") {\n      return new bizagi.rendering.smartphone.document(renderParams);\n    }\n\n    if (type == \"image\") {\n      return new bizagi.rendering.smartphone.image(renderParams);\n    }\n\n    if (type == \"fileprint\") {\n      return new bizagi.rendering.smartphone.fileprint(renderParams);\n    }\n\n    if (type == \"geolocation\") {\n      return new bizagi.rendering.smartphone.geolocation(renderParams);\n    }\n\n    if (type == \"collectionnavigator\") {\n      return new bizagi.rendering.smartphone.collectionnavigator(renderParams);\n    }\n\n    if (type == \"activityCheckList\") {\n      return new bizagi.rendering.smartphone.activityCheckList(renderParams);\n    }\n\n    // Check layout renders (starts with \"layout\")\n    if (type.indexOf(\"layout\") === 0) {\n      return self.getLayoutRender(params);\n    }\n\n    // Check range renders (starts with \"range\")\n    if (type.indexOf(\"range\") === 0) {\n      return self.getRangeRender(params);\n    }\n\n    if (type == \"mobiletext\") {\n      return new bizagi.rendering.smartphone.specific_text(renderParams);\n    }\n\n    // Deprecated control\n    if (type == \"letter\")\n    return new bizagi.rendering.smartphone.letter(renderParams);\n\n    if (/^signature$/i.test(type)) {\n      return new bizagi.rendering.smartphone.handSignature(renderParams);\n    }\n\n    if (/^readonly$/i.test(type)) {\n      return new bizagi.rendering.smartphone.readonly(renderParams);\n    }\n\n    // No type supported\n    //bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    //return null;\n\n    return this._super(params);\n  },\n\n  /**\r\n     * Returns the appropiatelayout render based on the type   \r\n     */\n  getLayoutRender: function getLayoutRender(params) {\n    var type = params.type;\n    var data = params.data;\n    var properties = data.properties;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"layoutImage\")\n    return new bizagi.rendering.smartphone.layoutImage(renderParams);\n\n    if (type == \"layoutLink\")\n    return new bizagi.rendering.smartphone.layoutLink(renderParams);\n\n    if (type == \"layoutLabel\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      return new bizagi.rendering.smartphone.layoutLabel(renderParams);\n    }\n\n    if (type == \"layoutText\")\n    return new bizagi.rendering.smartphone.layoutText(renderParams);\n\n    if (type == 'layoutDateTime')\n    return new bizagi.rendering.smartphone.layoutDateTime(renderParams);\n\n    if (type == \"layoutNumber\")\n    return new bizagi.rendering.smartphone.layoutNumber(renderParams);\n\n    if (type == \"layoutMoney\")\n    return new bizagi.rendering.smartphone.layoutMoney(renderParams);\n\n    if (type == \"layoutPlaceholder\")\n    return new bizagi.rendering.smartphone.layoutPlaceholder(renderParams);\n\n    if (type == \"layoutBoolean\")\n    return new bizagi.rendering.smartphone.layoutBoolean(renderParams);\n\n    if (type == \"layoutUpload\")\n    return new bizagi.rendering.smartphone.layoutUpload(renderParams);\n\n    return this._super(params);\n  },\n\n  /**\r\n      * Returns the appropiate search render based on the type     \r\n      */\n  getRangeRender: function getRangeRender(params) {\n    var type = params.type;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type === \"rangeDate\")\n    return new bizagi.rendering.smartphone.rangeDate(renderParams);\n\n    if (type === \"rangeMoney\")\n    return new bizagi.rendering.smartphone.rangeMoney(renderParams);\n\n    if (type === \"rangeNumber\")\n    return new bizagi.rendering.smartphone.rangeNumber(renderParams);\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * Returns the appropiate search render based on the type     \r\n      */\n  getSearchRender: function getSearchRender(params) {\n    var type = params.type;\n    var data = params.data;\n    var properties = data.properties;\n    var searchParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"searchText\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      // Creates one extended render\n      if (isExtended)\n      return new bizagi.rendering.smartphone.extendedText(searchParams);\n\n      // Creates one normal text render\n      return new bizagi.rendering.smartphone.text(searchParams);\n    }\n\n    if (type == \"searchBoolean\") {\n      var display = data.properties.display || \"option\";\n\n      // Creates one check render\n      if (display == \"check\")\n      return new bizagi.rendering.smartphone.check(searchParams);\n\n      // Creates one yes-no render\n      return new bizagi.rendering.smartphone.yesno(searchParams);\n    }\n\n    if (type == \"searchNumber\") {\n      // Creates a Scientific Notation render\n      if (data.properties.dataType == 29)\n      return new bizagi.rendering.smartphone.numberScientificNotation(searchParams);\n\n      return new bizagi.rendering.smartphone.number(searchParams);\n    }\n\n    if (type == \"searchMoney\")\n    return new bizagi.rendering.smartphone.money(searchParams);\n\n    if (type == \"searchDate\")\n    return new bizagi.rendering.smartphone.date(searchParams);\n\n    if (type == \"searchCombo\")\n    return new bizagi.rendering.smartphone.combo(searchParams);\n\n    if (type == \"searchSuggest\")\n    return new bizagi.rendering.smartphone.search(searchParams);\n\n    if (type == \"searchLabel\") {\n      if (!bizagi.override.hiddenControlsWithDataType) {\n        delete properties.dataType;\n      }\n      return new bizagi.rendering.smartphone.label(searchParams);\n    }\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  } });"]}