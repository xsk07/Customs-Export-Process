{"version":3,"sources":["jquery/workportal/desktop/widget/project.plan.activity.sidebar/bizagi.workportal.desktop.widgets.project.plan.activity.sidebar.js","jquery/workportal/desktop/widget/project.plan.activity.action/bizagi.workportal.desktop.widgets.project.plan.activity.action.js","jquery/workportal/desktop/widget/project.plan.activity.time/bizagi.workportal.desktop.widgets.project.plan.activity.time.js","jquery/workportal/desktop/widget/project.plan.activity.progress/bizagi.workportal.desktop.widgets.project.plan.activity.progress.js","jquery/workportal/desktop/widget/project.plan.activity.subprocesses/bizagi.workportal.desktop.widgets.project.plan.activity.subprocesses.js","jquery/workportal/desktop/widget/project.plan.activity.parent/bizagi.workportal.desktop.widgets.project.plan.activity.parent.js","jquery/workportal/desktop/widget/project.plan.activity.users/bizagi.workportal.desktop.widgets.project.plan.activity.users.js","jquery/workportal/desktop/widget/project.dashboard.menu/bizagi.workportal.desktop.widgets.project.dashboard.menu.js","jquery/workportal/desktop/widget/project.dashboard.menu.activity.plan/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.attachments/bizagi.workportal.desktop.widgets.project.attachments.js","jquery/workportal/desktop/widget/project.files/bizagi.workportal.desktop.widgets.project.files.js","jquery/workportal/desktop/widget/project.filesPreview/bizagi.workportal.desktop.widgets.project.filesPreview.js","jquery/workportal/desktop/widget/project.file.sidebar/bizagi.workportal.desktop.widgets.project.file.sidebar.js"],"names":["bizagi","workportal","widgets","project","base","extend","init","workportalFacade","dataService","serviceloadDataPlan","params","this","_super","loadTemplates","project-plan-activity-sidebar","getTemplate","concat","renderContent","template","content","render","postRender","sub","$","proxy","onNotifyLoadInfoPlan","event","parans","plan","idActivitySelected","idPlan","id","loadData","getDateServer","subscribe","loadedWithDataActivities","loadedWithDataFirstParent","pub","type","args","clean","unsubscribe","injector","register","activity","sidebar","notifier","dateFormat","localization","getResource","timeFormat","estimatedFinishDateTime","beforeUserAssignedActivity","activity-action-main","activity-action-editionpopup","dialogBox","onNotifyLoadInfoActivityExecution","onNotifyExpandedRightSidebar","self","$content","getContent","empty","currentActivity","activities","filter","toUpperCase","idUserCreator","currentUser","idUser","userAssigned","argsTemplate","currentActivityName","name","showEditAction","tmpl","append","initilizeActionMenu","initializeTempleteAndEvents","plugins","activityEdition","initPluginPopupEdition","formEditActivity","assignee","date","duration","buttonCancel","buttonUpdate","on","onClickPopupButtonCancel","onClickPopupButtonUpdate","onDeleteDate","onTypeDuration","menu","select","onSelectMenu","removeClass","popupEditActivity","formContent","initializeAutoComplete","element","url","serviceLocator","getUrl","autocomplete","minLength","source","request","response","ajax","data","domain","userName","fullName","term","organization","pag","pagSize","orderField","success","map","users","item","label","user","value","ui","val","IdAssignee","focus","change","initializeDatePicker","datepicker","onSelect","getTime","undefined","util","dateFormatter","getDateFormatByDatePickerJqueryUI","initializeSpiner","desactivateDateByDuration","newValue","target","isNumeric","parseInt","spinner","min","max","placeHolder","spin","keyCode","fieldDurationActive","activateElement","form","currentTarget","find","length","onClickOpenPopupEdition","dialog","resizable","draggable","height","width","modal","title","maximize","open","onOpenPopupEdition","close","onClosePopupEdition","activityDate","isEmpty","estimatedFinishDate","isNaN","formatInvariant","Date","getDateFromInvariant","isMinimumDate","setUserAssignedById","removePopupWidgets","callGetDataUsers","then","responseUsers","preventDefault","next","html","remove","validateParamsOfFormEditActivity","idUserAssigned","updateActivity","progress","startDate","allowEdition","description","finishDate","items","when","editActivityPlan","done","refreshAllWidgets","showContextByMenuDashboard","showSucessMessage","onClickFavorite","favoriteOptions","hasClass","idObject","idCase","favoriteType","addFavorite","favoritesData","guidFavorite","idFavorites","addClass","delFavorite","unsub","messageValidationField","replace","toLowerCase","csvIdUsers","defer","Deferred","userIds","getUsersData","always","resolve","promise","action","widget","EXECUTING_ACTIVITY","FINISHED_ACTIVITY","datePickerRegional","plan-time-main","onNotifyLoadInfoActivitySummary","getStateActivity","time","fromDate","getFormattedDate","getFirstDate","dataProgressWidget","getDataByScenarios","unitTime","auxUnitTime","updateWidget","contentTemplate","relativeTime","getRelativeTime","now","minutes","messageDescripionDifference","keywordResource","messageTime","appendTo","$barRemainingDate","widthNumberDays","css","toString","percentBar","currentState","colorBar","getColorByCreatedAndEstimatedDate","toDate","callGetEffectiveDuration","getColorBar","getPercentBar","getKeywordResourceDescriptionBar","getUnitTime","getUTCDate","dateObj","monthNames","getMonth","formatDate","d","getEffectiveDuration","plan-progress-main","plan-progress-popup-edit","onNotifyUpdateItemFromRender","activityToShow","valuePercentBarComplete","canEdit","popupEditProgress","initPluginPopupEditProgress","formEditProgress","sliderProgress","slider","orientation","range","from","to","step","slide","onChangesliderProgress","each","vals","i","el","numericTextBoxPlugin","format","onChangeNumericTextBoxProgress","decimals","buttonChangeProgress","onShowPopupEditProgress","onClickCancel","onSubmitFormChangeProgress","updateProgressUI","listItems","activityWork","hide","show","text","newPercentProgress","templatePopupEditProgress","onOpenPopupPlan","detach","previusValueProgress","prop","project-subprocesses","project-subprocesses-tootip-custom-properties","subprocesses","plan-parent-main","getPlanParent","planParent","parent","idParent","radNumber","nameParent","displayName","idWorkflow","idWorkItem","idTask","onClickGoToParentCase","routingExecute","closest","usersMap","usersInformation","globalHandlersService","get","usersAssignees","plan-users-main","activityRunning","cvsGuidUsers","activitiesUsers","ownerUserId","ownerUserGuid","push","guidUser","userType","picture","guid","index","userId","userGuid","userAssignedGuid","inArray","justAssignees","addEventHandlersModal","showCreatorInformation","renderUserProfilesAndImages","allUsers","usersAssignee","isOwner","indexOf","isAssignee","usersAdapter","createJsonUserInfo","userCreator","userInfo","username","email","getInitials","userinformation","obj","$li","console","log","not","ev","userSelected","$target","usersActivities","userParam","getIsAssignee","getIsOwner","usertooltip","usersGuids","join","getUsersAssignees","getUserAssignee","tasks","types","actUser","click","stopPropagation","publish","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","modalParameters","refreshInbox","onDiscussionsMenuStatusChange","updateDiscussionsIcons","hasDiscussionsOrComment","toggle","dashboard","project-dashboard-menu","contextsLeftSidebarCaseDashboard","forEach","context","updateView","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","contextualized","siblings","handlerEvents","paramsGetPlan","callGetPlan","responsePlan","loadContentById","$item","autoSave","document","getLevelNavigator","newLevelNavigator","refreshLastItemBreadcrumb","histName","level","getPlan","status","reject","subMenuHandler","$comments","$files","$timeline","off","project-content-dashboard","setTimeout","window","trigger","kendo","Widget","ProjectAttachments","options","fn","call","_maxFilesSize","maxSize","_fileList","_onlyValidateServerFileExtension","onlyValidateServerFileExtension","_supportFileExt","extensions","_uploadMaxFilesSize","upload","_initUpload","loadNotifier","_initLoadNotifier","notification","_initNotification","_eventsHandler","_initLocalization","wrapper","multiple","dropZone","maxFilesSize","uploadMaxFileSize","enabled","that","auxNumberFilesSuccess","kendoUpload","async","saveUrl","getXSRFToken","autoUpload","_filterMaxFilesSize","complete","interval","setInterval","_showNotificationCompleteUpload","clearInterval","_onProgressFile","files","error","onErrorFile","selectFiles","dropFilesHere","showFileList","kendoNotification","position","pinned","kendoWindow","notifierTitle","actions","animation","visible","maxHeight","minWidth","objectOptionsLocalization","optionsLocalizationByDefault","errorUpload","errorSecurity","errorSize","errorMaxFilesSize","_getSize","cancel","retry","Math","round","$file","_getFileItemByUID","uid","percent","percentComplete","_onShowUploadNotifier","top","left","bottom","right","wrapperMessage","_autoHideMessage","fadeOut","_onCancelFile","$fileWrapper","$uploadWrapper","_onRemoveFile","_onRetryFile","file","grep","validation","_isValidFile","message","setStatus","valid","size","extension","total","_notifySizeExceeded","_switchEvents","cancelFilesUpload","destroy","errorUploadiis","plugin","jQuery","prefixBase64","usersData","currentFilesList","fileDateInterval","project-files","project-files-uploaditem","project-files-list","project-attachments","templateHomeFiles","isOpen","parseBoolean","isClosedForAllUsers","renderFilesList","initializeUploadFiles","eventsHandler","restrictedEventsHandler","filesLength","globalParent","dateTime","count","flowContext","getFilesListByRadNumber","renderFiles","$showMoreWrapper","displayFileList","updateRelativeTime","setAdditionalData","notifyFilesNumber","renderNoFiles","noFilesTmpl","resources","$noFiles","kendoProjectAttachments","onSuccessFile","addFileData","onSaveFileData","supportFileExt","uploadMaxFilesSize","thumbnails","guidsUsers","attachment","setUserData","setThumbnails","getFileInfoByGuid","guids","getFilesThumbnails","thumbnail","$wrapper","$img","src","setFilePreview","guidAttch","guidFile","img","fileData","userData","XMLHttpRequest","JSON","parse","saveFileData","fail","onRetryFile","attachmentsToCreate","unshift","createProjectFile","photo","$filesList","equalizeHeights","deleteFile","updateFileData","changeRelativeTime","onSelectFiles","bannedFiles","isValidFile","bannedFile","splice","showFilesError","resetWidget","switchFilesEvents","fileName","getDownloadAttachment","mandatory","filesNumber","project-filespreview-wrapper","project-filespreview-preview","project-filespreview-popup","project-filespreview-thenumber","generalTmpl","setFilesNumber","fileEdition","image","edit","parameters","isEmptyObject","currentFile","$filesNumber","showPreview","idCurrentUser","applyMenu","setEditionData","onResetFileForm","onSaveEdition","onOpenEdition","onDeleteFile","onDownloadFile","showConfirmationBox","attachmentsToDelete","validateAddFileDescriptionForm","updateProjectFile","printf","showErrorMessage","$description","result","$textAreadescription","trim","descriptionValidation","filesPreview","supportNav","project-file-sidebar","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_PROJECT_FILE_SIDEBAR"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal Project Activity Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", {}, {\n\n  /*\r\n                                                                                                                *   Constructor\r\n                                                                                                                */\n  init: function init(workportalFacade, dataService, serviceloadDataPlan, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.serviceloadDataPlan = serviceloadDataPlan;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-plan-activity-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.sidebar\").concat(\"#project-plan-activity-sidebar\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-plan-activity-sidebar\");\n    self.content = template.render({});\n\n    return self.content;\n  },\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_PLAN\", $.proxy(self.onNotifyLoadInfoPlan, self));\n  },\n\n  onNotifyLoadInfoPlan: function onNotifyLoadInfoPlan(event, parans) {\n    var self = this;\n    if (self.params.plan.idActivitySelected) {\n\n      var params = { idPlan: self.params.plan.id };\n      self.serviceloadDataPlan.loadData(params, self.getDateServer, self.params);\n      self.serviceloadDataPlan.subscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\n      self.serviceloadDataPlan.subscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\n    }\n  },\n\n  loadedWithDataActivities: function loadedWithDataActivities() {\n    var self = this;\n    self.pub(\"notify\", {\n      type: \"LOADED_ACTIVITIES_PLAN\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_SUMMARY_PROGRESS_PLAN\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_ACTIVITY_SUMMARY\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_ACTIVITIES_PLAN\",\n      args: self.params });\n\n  },\n\n  loadedWithDataFirstParent: function loadedWithDataFirstParent() {\n    var self = this;\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_SUMMARY_PLAN\",\n      args: self.params });\n\n  },\n\n  clean: function clean() {\n    var self = this;\n    if (self.serviceloadDataPlan) {\n      self.serviceloadDataPlan.unsubscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\n      self.serviceloadDataPlan.unsubscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\n    }\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", [\"workportalFacade\", \"dataService\", \"bizagi.workportal.services.behaviors.loadDataPlan\", bizagi.workportal.widgets.project.plan.activity.sidebar], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Action\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.action\", {}, {\n\n  /**\r\n                                                                                                               *   Constructor\r\n                                                                                                               */\n  init: function init(workportalFacade, dataService, notifier, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.dateFormat = bizagi.localization.getResource(\"dateFormat\");\n    self.timeFormat = bizagi.localization.getResource(\"timeFormat\");\n    self.estimatedFinishDateTime; //Save complete date and time, because datepicker dont save time\n\n    self.beforeUserAssignedActivity = \"\";\n    self.notifier = notifier;\n\n\n    //Load templates\n    self.loadTemplates({\n      \"activity-action-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action\"),\n      \"activity-action-editionpopup\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action-editionpopup\") });\n\n\n    self.dialogBox = {};\n  },\n\n  /**\r\n      *\r\n      * @returns {*|jQuery|HTMLElement}\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /**\r\n      *\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.sub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n\n    var $content = self.getContent().empty();\n\n    var currentActivity = {};\n    if (self.params.plan.idActivitySelected) {\n      currentActivity = self.params.plan.activities.filter(function (activity) {\n        return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n      })[0];\n    }\n\n    if (self.params.plan.idUserCreator === bizagi.currentUser.idUser || currentActivity.userAssigned == bizagi.currentUser.idUser) {\n\n      var argsTemplate = {};\n      argsTemplate.currentActivityName = currentActivity.name;\n      argsTemplate.showEditAction = true;\n      if (self.params.plan.idUserCreator !== bizagi.currentUser.idUser) {\n        argsTemplate.showEditAction = false;\n      }\n\n      var tmpl = self.getTemplate(\"activity-action-main\");\n      $content.append(tmpl.render(argsTemplate));\n\n      if (argsTemplate.showEditAction) {\n        self.initilizeActionMenu();\n        self.beforeUserAssignedActivity = currentActivity.userAssigned;\n        self.content.append($content);\n        self.initializeTempleteAndEvents();\n      }\n    }\n  },\n\n  initializeTempleteAndEvents: function initializeTempleteAndEvents() {\n    var self = this;\n    self.plugins = {};\n    self.plugins.activityEdition = self.initPluginPopupEdition();\n\n    self.formEditActivity = {\n      assignee: $(\"#activity-form-assignee\", self.plugins.activityEdition),\n      date: $(\"#activity-form-date\", self.plugins.activityEdition),\n      duration: $(\"#activity-form-duration\", self.plugins.activityEdition),\n      buttonCancel: $(\"#ui-bizagi-wp-project-popupform-action-cancel\", self.plugins.activityEdition),\n      buttonUpdate: $(\"#ui-bizagi-wp-project-popupform-action-update\", self.plugins.activityEdition) };\n\n\n    self.formEditActivity.buttonCancel.on(\"click\", $.proxy(self.onClickPopupButtonCancel, self));\n    self.formEditActivity.buttonUpdate.on(\"click\", $.proxy(self.onClickPopupButtonUpdate, self));\n\n    self.formEditActivity.date.on(\"keydown\", $.proxy(self.onDeleteDate, self));\n    self.formEditActivity.duration.on(\"keyup\", $.proxy(self.onTypeDuration, self));\n  },\n\n  /**\r\n      *\r\n      */\n  onNotifyExpandedRightSidebar: function onNotifyExpandedRightSidebar() {\n    var self = this;\n    self.initilizeActionMenu();\n  },\n\n  /**\r\n      *\r\n      */\n  initilizeActionMenu: function initilizeActionMenu() {\n    var self = this;\n    $(\"#ui-bizagi-wp-project-plan-activity-action .menu\", self.content).menu({\n      select: $.proxy(self.onSelectMenu, self) }).\n    removeClass(\"ui-widget-content\");\n  },\n\n  /**\r\n      *\r\n      * @returns dialogBox.formContent\r\n      */\n  initPluginPopupEdition: function initPluginPopupEdition() {\n    var self = this;\n    var popupEditActivity = self.getTemplate(\"activity-action-editionpopup\");\n    self.dialogBox.formContent = popupEditActivity.render({});\n    return self.dialogBox.formContent;\n\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeAutoComplete: function initializeAutoComplete(element) {\n    var self = this;\n    var url = self.dataService.serviceLocator.getUrl(\"admin-getUsersList\");\n\n    element.autocomplete({\n      minLength: 2,\n      source: function source(request, response) {\n        $.ajax({\n          url: url,\n          data: {\n            domain: \"\",\n            userName: \"\",\n            fullName: request.term,\n            organization: \"\",\n            pag: 1,\n            pagSize: 100,\n            orderField: \"fullName\" },\n\n          success: function success(data) {\n            response($.map(data.users, function (item) {\n              return {\n                label: item.user,\n                value: item.idUser };\n\n            }));\n          } });\n\n      },\n      select: function select(event, ui) {\n        var name = ui.item.label;\n        element.val(name);\n        self.formEditActivity.IdAssignee = ui.item.value;\n        return false;\n      },\n      focus: function focus() {\n        return false;\n      },\n      change: function change(event, ui) {\n        if (ui.item === null) {\n          self.formEditActivity.IdAssignee = null;\n          self.formEditActivity.assignee.val(\"\");\n        }\n        return false;\n      } });\n\n\n\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeDatePicker: function initializeDatePicker(element) {\n    var self = this;\n    element.datepicker({\n      onSelect: function onSelect() {\n        self.formEditActivity.duration.val(\"\");\n        self.estimatedFinishDateTime = self.formEditActivity.date.datepicker(\"getDate\") ? self.formEditActivity.date.datepicker(\"getDate\").getTime() : undefined;\n      } });\n\n    element.datepicker(\"option\", \"dateFormat\", bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI());\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeSpiner: function initializeSpiner(element) {\n    var self = this;\n    function desactivateDateByDuration(event, newValue) {\n      var value = newValue || $(event.target).val();\n      if (bizagi.util.isNumeric(value) && parseInt(value, 10) > 0) {\n        self.formEditActivity.date.val(\"\");\n        self.estimatedFinishDateTime = undefined;\n      } else {\n        $(event.target).val(\"\");\n      }\n    }\n\n    element.spinner({\n      min: 1,\n      max: 1000,\n      placeHolder: bizagi.localization.getResource(\"workportal-hours\"),\n      change: function change(event) {\n        desactivateDateByDuration(event);\n      },\n      spin: function spin(event, ui) {\n        desactivateDateByDuration(event, ui.value);\n      } });\n\n  },\n\n  /***\r\n      * Events\r\n      * @param event\r\n      */\n\n  onDeleteDate: function onDeleteDate(event) {\n    var self = this;\n    if (event.keyCode === 8) {\n      $(event.target).val(\"\");\n      self.fieldDurationActive(true);\n    }\n  },\n\n  /**\r\n      *\r\n      * @param event\r\n      */\n  onTypeDuration: function onTypeDuration(event) {\n    var self = this;\n    var $target = $(event.target);\n    if ($target.val() !== \"\") {\n      self.estimatedFinishDateTime = undefined;\n    } else {\n      self.activateElement(self.form.date);\n    }\n  },\n\n  /**\r\n      * When select menu\r\n      * @param event\r\n      * @param ui\r\n      */\n  onSelectMenu: function onSelectMenu(event, ui) {\n    var self = this;\n    if ($(event.currentTarget).find(\"i\").length === 0) {\n      var item = $(ui.item).data(\"item\");\n      switch (item) {\n        case \"edit\":\n          self.onClickOpenPopupEdition();\n          break;}\n\n    }\n  },\n\n  /**\r\n      *\r\n      */\n  onClickOpenPopupEdition: function onClickOpenPopupEdition() {\n    var self = this;\n    self.initializeTempleteAndEvents();\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: \"auto\",\n      width: \"600px\",\n      modal: true,\n      title: bizagi.localization.getResource(\"workportal-project-plan-title-activity-properties\"),\n      maximize: true,\n      open: $.proxy(self.onOpenPopupEdition, self),\n      close: $.proxy(self.onClosePopupEdition, self) });\n\n  },\n\n  /**\r\n     *\r\n     */\n  onOpenPopupEdition: function onOpenPopupEdition() {\n    var self = this;\n    var currentActivity = self.params.plan.activities.filter(function (activity) {\n      return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n    })[0];\n\n    var activityDate = currentActivity && !bizagi.util.isEmpty(currentActivity.estimatedFinishDate) ? currentActivity.estimatedFinishDate : \"\";\n    if (!isNaN(activityDate)) {\n      activityDate = bizagi.util.dateFormatter.formatInvariant(new Date(activityDate));\n    }\n    var estimatedFinishDate = activityDate ? bizagi.util.dateFormatter.getDateFromInvariant(activityDate) : \"\";\n    var isMinimumDate = estimatedFinishDate instanceof Date ? estimatedFinishDate.getTime() < self.getDateServer() : false;\n\n    self.initializeAutoComplete(self.formEditActivity.assignee);\n    self.initializeDatePicker(self.formEditActivity.date);\n    self.initializeSpiner(self.formEditActivity.duration);\n\n    if (currentActivity.userAssigned) {\n      self.setUserAssignedById(currentActivity.userAssigned);\n    }\n\n    self.formEditActivity.date.datepicker(\"option\", \"minDate\", new Date(self.getDateServer()));\n\n    if (currentActivity.estimatedFinishDate && isMinimumDate) {\n      self.formEditActivity.date.datepicker(\"option\", \"minDate\", estimatedFinishDate); //set minimum because, if date is past\n    }\n\n    if (currentActivity.estimatedFinishDate) {\n      if (estimatedFinishDate) {\n        self.formEditActivity.date.datepicker(\"setDate\", estimatedFinishDate);\n      }\n      self.estimatedFinishDateTime = currentActivity.estimatedFinishDate;\n    }\n\n    if (currentActivity.duration) {\n      self.formEditActivity.duration.val(parseInt(currentActivity.duration, 10));\n    }\n  },\n\n  /**\r\n      * When close popup edition\r\n      */\n  onClosePopupEdition: function onClosePopupEdition() {\n    var self = this;\n    self.removePopupWidgets();\n  },\n\n  /**\r\n      *\r\n      * @param idUser\r\n      */\n  setUserAssignedById: function setUserAssignedById(idUser) {\n    var self = this;\n    //Show images users\n    self.callGetDataUsers(idUser).then(function (responseUsers) {\n      self.formEditActivity.assignee.val(responseUsers[0].name);\n    });\n    self.formEditActivity.IdAssignee = idUser;\n  },\n\n  /**\r\n      *\r\n      * @param event\r\n      */\n  onClickPopupButtonCancel: function onClickPopupButtonCancel(event) {\n    var self = this;\n    event.preventDefault();\n    self.removePopupWidgets();\n  },\n\n  /**\r\n     * Remove popup widgets\r\n     */\n  removePopupWidgets: function removePopupWidgets() {\n    var self = this;\n    self.formEditActivity.assignee.next().find(\"span\").html(\"\");\n    self.dialogBox.formContent.remove();\n    $(\"#ui-datepicker-div\").remove();\n  },\n\n  /**\r\n      *  Triggered when click update plan activity\r\n      */\n  onClickPopupButtonUpdate: function onClickPopupButtonUpdate() {\n    var self = this;\n    if (self.validateParamsOfFormEditActivity()) {\n      var currentActivity = self.params.plan.activities.filter(function (activity) {\n        return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n      })[0];\n      var idUserAssigned = self.formEditActivity.IdAssignee || bizagi.currentUser.idUser;\n      if (self.formEditActivity.duration.val() != \"\") {\n        self.params.plan.activities.filter(function (activity) {\n          return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n        })[0].estimatedFinishDate = \"\";\n      }\n      var updateActivity = {\n        progress: currentActivity.progress,\n        id: currentActivity.id,\n        startDate: currentActivity.startDate,\n        duration: self.formEditActivity.duration.val(),\n        userAssigned: idUserAssigned,\n        allowEdition: currentActivity.allowEdition,\n        description: currentActivity.description,\n        name: currentActivity.name,\n        idPlan: currentActivity.idPlan,\n        estimatedFinishDate: self.estimatedFinishDateTime,\n        finishDate: currentActivity.finishDate,\n        items: currentActivity.items };\n\n      $.when(self.dataService.editActivityPlan(updateActivity)).done(function () {\n        currentActivity = $.extend(currentActivity, updateActivity);\n        self.removePopupWidgets();\n\n        if (self.beforeUserAssignedActivity !== self.formEditActivity.IdAssignee) {\n          self.pub(\"notify\", {\n            type: \"ACTIVITYPLANCOMMENTS\",\n            args: $.extend(self.params, { refreshAllWidgets: true }) });\n\n        } else\n        {\n          self.pub(\"notify\", {\n            type: self.params.showContextByMenuDashboard,\n            args: self.params });\n\n        }\n\n        self.removePopupWidgets();\n        self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-project-plan-activity-update-message\"));\n      });\n    }\n  },\n\n  /***\r\n      * Events\r\n      */\n  onClickFavorite: function onClickFavorite(event) {\n    event.preventDefault();\n    var self = this;\n    var favoriteOptions = {};\n    if ($(event.target).hasClass(\"bz-icon-star-outline\")) {\n      favoriteOptions = {\n        idObject: self.params.idCase,\n        favoriteType: \"CASES\" };\n\n      $.when(self.dataService.addFavorite(favoriteOptions)).done(function (favoritesData) {\n        self.params.guidFavorite = favoritesData.idFavorites;\n        $(event.target).removeClass(\"bz-icon-star-outline\");\n        $(event.target).addClass(\"bz-icon-star\");\n      });\n    } else\n    {\n      favoriteOptions = {\n        idObject: self.params.guidFavorite,\n        favoriteType: \"CASES\" };\n\n      $.when(self.dataService.delFavorite(favoriteOptions)).done(function () {\n        $(event.target).addClass(\"bz-icon-star-outline\");\n        $(event.target).removeClass(\"bz-icon-star\");\n      });\n    }\n  },\n\n  /**\r\n      * Clean events and plugins\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.unsub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.unsub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\n  },\n\n  /**\r\n      * Validate form edit plan activity\r\n      * @returns {boolean}\r\n      */\n  validateParamsOfFormEditActivity: function validateParamsOfFormEditActivity() {\n    var self = this;\n    var userAssigned = self.formEditActivity.assignee;\n    if (userAssigned.val() && userAssigned.val() !== \"\" && self.formEditActivity.IdAssignee) {\n      return true;\n    } else {\n      var messageValidationField = bizagi.localization.getResource(\"workportal-general-error-field-required\");\n      messageValidationField = messageValidationField.replace(\"{0}\", bizagi.localization.getResource(\"workportal-project-plan-assignee\").toLowerCase());\n      userAssigned.next().find(\"span\").html(messageValidationField);\n      return false;\n    }\n  },\n\n  /**\r\n      * Call services\r\n      */\n  callGetDataUsers: function callGetDataUsers(csvIdUsers) {\n    var self = this,\n    defer = $.Deferred();\n    var params = {\n      userIds: csvIdUsers,\n      width: 50,\n      height: 50 };\n\n\n    self.dataService.getUsersData(params).always(function (response) {\n      defer.resolve(response);\n    });\n    return defer.promise();\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.action\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.plan.activity.action]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Time\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n/***\r\n     * TODO IMPORTANT: This widget is development with TDD, test this file when changes\r\n     */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.time\", {}, {\n\n  /*\r\n                                                                                                       *   Constructor\r\n                                                                                                       *\r\n                                                                                                       */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Constants\n    self.EXECUTING_ACTIVITY = \"EXECUTING\";\n    self.FINISHED_ACTIVITY = \"FINISHED\";\n\n    //Regional\n    self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-time-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.time\").concat(\"#project-plan-activity-time\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivitySummary, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivitySummary: function onNotifyLoadInfoActivitySummary(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    self.getContent().empty();\n\n    var currentActivity = self.params.plan.activities.filter(function (activity) {\n      return activity.id === self.params.plan.idActivitySelected;\n    })[0];\n\n    if (currentActivity.startDate) {\n      self.getStateActivity(currentActivity);\n\n      var argsTemplate = {\n        time: {\n          fromDate: self.getFormattedDate(new Date(self.getFirstDate(currentActivity))) } };\n\n\n      var dataProgressWidget = self.getDataByScenarios(currentActivity, true);\n\n      $.when(dataProgressWidget.unitTime).done(function (auxUnitTime) {\n        dataProgressWidget = $.extend(dataProgressWidget, {\n          unitTime: auxUnitTime });\n\n        self.updateWidget($.extend(argsTemplate.time, dataProgressWidget));\n      });\n\n    }\n  },\n  updateWidget: function updateWidget(argsTemplate) {\n    var self = this;\n    var $content = self.getContent().empty();\n    var contentTemplate = self.getTemplate(\"plan-time-main\");\n\n    var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - argsTemplate.unitTime.minutes * 60 * 1000), null, false);\n\n    var messageDescripionDifference = bizagi.localization.getResource(\"workportal-project-activity-state-\" + argsTemplate.keywordResource);\n    argsTemplate.messageTime = messageDescripionDifference.replace(\"%s\", relativeTime);\n\n    contentTemplate.\n    render(argsTemplate).\n    appendTo($content);\n\n    //Begin Adjust status bar next to the number days\n    var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\n    var widthNumberDays = $(\".remaining-days .days\", $content).width();\n    $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\n\n    var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\n\n    $barCompletedDate.css(\"width\", argsTemplate.percentBar + \"%\");\n    //End Adjust status bar next to the number days\n\n  },\n  getStateActivity: function getStateActivity(activity) {\n    var self = this;\n    if (activity.finishDate) {\n      activity.currentState = self.FINISHED_ACTIVITY;\n      return self.FINISHED_ACTIVITY;\n    } else\n    {\n      activity.currentState = self.EXECUTING_ACTIVITY;\n      return self.EXECUTING_ACTIVITY;\n    }\n  },\n  getFirstDate: function getFirstDate(activity) {\n    var self = this;\n    if (activity.currentState === self.EXECUTING_ACTIVITY) {\n      return activity.startDate;\n    } else {\n      return activity.finishDate;\n    }\n  },\n  getDataByScenarios: function getDataByScenarios(activity) {\n    var self = this;\n    var response = {\n      colorBar: null,\n      percentBar: 100,\n      keywordResource: null,\n      unitTime: null };\n\n    var params = {};\n    switch (activity.currentState) {\n      case self.EXECUTING_ACTIVITY:\n        response.keywordResource = \"opened\";\n        response.colorBar = self.getColorByCreatedAndEstimatedDate(activity);\n\n        params = {\n          idUser: bizagi.currentUser.idUser,\n          fromDate: activity.startDate,\n          toDate: Date.now() };\n\n        response.unitTime = self.callGetEffectiveDuration(params);\n\n        break;\n      case self.FINISHED_ACTIVITY:\n        response.colorBar = \"Gray\";\n        response.keywordResource = \"closed\";\n        params = {\n          idUser: bizagi.currentUser.idUser,\n          fromDate: activity.finishDate,\n          toDate: Date.now() };\n\n        response.unitTime = self.callGetEffectiveDuration(params);\n        break;}\n\n    return response;\n  },\n\n  getColorBar: function getColorBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).colorBar;\n  },\n  getPercentBar: function getPercentBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).percentBar;\n  },\n  getKeywordResourceDescriptionBar: function getKeywordResourceDescriptionBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).keywordResource;\n  },\n  getUnitTime: function getUnitTime(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).unitTime;\n  },\n\n  getColorByCreatedAndEstimatedDate: function getColorByCreatedAndEstimatedDate(activity) {\n    var self = this;\n    var response = \"Red\";\n    if (activity.estimatedFinishDate) {\n      if (Date.now() < activity.estimatedFinishDate) {\n        var theSameDay = new Date().getUTCDate() === new Date(activity.estimatedFinishDate).getUTCDate();\n        if (theSameDay) {\n          response = \"Yellow\";\n        } else\n        {\n          response = \"Green\";\n        }\n      }\n    }\n    return response;\n  },\n\n  getFormattedDate: function getFormattedDate(dateObj) {\n    var self = this;\n    var monthsNames = self.datePickerRegional.monthNames;\n    var shortMonth = dateObj.getMonth();\n\n    return monthsNames[shortMonth] + \" \" + bizagi.util.dateFormatter.formatDate(dateObj, \"dd hh:mm tt\", bizagi.localization.getResource(\"datePickerRegional\"));\n  },\n\n  /**\r\n      * Call services\r\n      */\n  callGetEffectiveDuration: function callGetEffectiveDuration(params) {\n    var self = this;\n    var d = $.Deferred();\n    $.when(\n    self.dataService.getEffectiveDuration(params)).\n    done(function (data) {\n      d.resolve(data);\n    });\n    return d.promise();\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.time\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.time], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Progress\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.progress\", {}, {\n\n  /*\r\n                                                                                                           *   Constructor\r\n                                                                                                           */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.plugins = {};\n    self.dialogBox = {};\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-progress-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-progress\"),\n      \"plan-progress-popup-edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-edit-progress\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.sub(\"UPDATE_ITEMS_FROM_FORMRENDER\", $.proxy(self.onNotifyUpdateItemFromRender, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    var $content = self.getContent().empty();\n\n    var activityToShow = self.params.plan.activities.filter(function (activity) {\n      return activity.id.toUpperCase() == self.params.plan.idActivitySelected.toUpperCase();\n    })[0];\n\n    var argsTemplate = {};\n    argsTemplate.valuePercentBarComplete = 0;\n    argsTemplate.progress = {\n      progress: activityToShow.progress,\n      canEdit: activityToShow.items.length === 0 };\n\n\n    if (argsTemplate.progress.progress) {\n      argsTemplate.valuePercentBarComplete = argsTemplate.progress.progress;\n    }\n\n    //Update widget\n    var templateMain = self.getTemplate(\"plan-progress-main\");\n    templateMain.render(argsTemplate).appendTo($content);\n\n    self.plugins.popupEditProgress = self.initPluginPopupEditProgress();\n\n    var popupEditProgress = self.plugins.popupEditProgress;\n\n    self.formEditProgress = {\n      sliderProgress: $(\"#sliderProgress\", popupEditProgress).slider({\n        orientation: \"horizontal\",\n        range: \"min\",\n        max: 100,\n        width: 100,\n        from: 5,\n        to: 50,\n        step: 1,\n        value: argsTemplate.valuePercentBarComplete,\n        slide: $.proxy(self.onChangesliderProgress, self),\n        change: $.proxy(self.onChangesliderProgress, self) }).\n      each(function () {\n        var vals = $(this).slider(\"option\", \"max\") - $(this).slider(\"option\", \"min\");\n        for (var i = 0; i <= vals; i += 10) {\n          var el = $(\"<label class='step'>\" + i + \"</label>\").css(\"left\", i / vals * 100 + \"%\");\n          $(this).append(el);\n        }\n      }),\n      numericTextBoxPlugin: $(\"#inputProgressNumericTextBox\", popupEditProgress).spinner({\n        format: \"n0\",\n        min: 0,\n        max: 100,\n        spin: $.proxy(self.onChangeNumericTextBoxProgress, self),\n        change: $.proxy(self.onChangeNumericTextBoxProgress, self),\n        value: argsTemplate.valuePercentBarComplete,\n        decimals: 0 }),\n\n      buttonChangeProgress: $(\"#button-accept-change-progress\", popupEditProgress),\n      buttonCancel: $(\"#button-cancel-change-progress\", popupEditProgress) };\n\n\n    //Handlers\n    $(\".action-open-popup-edit-progress\", $content).on(\"click\", $.proxy(self.onShowPopupEditProgress, self));\n\n    self.formEditProgress.buttonCancel.on(\"click\", $.proxy(self.onClickCancel, self));\n    self.formEditProgress.buttonChangeProgress.on(\"click\", $.proxy(self.onSubmitFormChangeProgress, self));\n\n    self.updateProgressUI(argsTemplate.valuePercentBarComplete);\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", argsTemplate.valuePercentBarComplete);\n\n  },\n\n  onNotifyUpdateItemFromRender: function onNotifyUpdateItemFromRender(event, params) {\n    var self = this;\n    var listItems = params.args.items;\n    var activityWork = params.args.activityWork;\n\n    var progress;\n    if (listItems.length > 0) {\n      //Hide edit progress\n      $(\".action-open-popup-edit-progress\", self.content).hide();\n    } else {\n      $(\".action-open-popup-edit-progress\", self.content).show();\n    }\n    //set new progress\n    $(\".bz-wp-timestamp span\", self.content).text(activityWork);\n    $(\".bz-wp-progress-bar\", self.content).css(\"width\", activityWork + \"%\");\n\n  },\n\n  updateProgressUI: function updateProgressUI(newPercentProgress) {\n    var self = this,\n    $content = self.getContent();\n\n    $(\".bz-wp-timestamp span\", $content).text(newPercentProgress);\n\n    //Begin Adjust status bar next to the number days\n    var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\n    var widthNumberDays = $(\".remaining-days .days\", $content).width();\n    $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\n\n    var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\n\n    $barCompletedDate.css(\"width\", newPercentProgress.toString() + \"%\");\n    //End Adjust status bar next to the number days\n  },\n\n  initPluginPopupEditProgress: function initPluginPopupEditProgress() {\n    var self = this;\n    var templatePopupEditProgress = self.getTemplate(\"plan-progress-popup-edit\");\n    self.dialogBox.formContent = templatePopupEditProgress.render();\n    return self.dialogBox.formContent;\n\n  },\n  /*\r\n      * UI\r\n      */\n\n  onShowPopupEditProgress: function onShowPopupEditProgress() {\n    var self = this;\n\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: \"auto\",\n      width: \"600px\",\n      modal: true,\n      title: bizagi.localization.getResource(\"workportal-project-plan-progress-title\"),\n      maximize: true,\n      open: $.proxy(self.onOpenPopupPlan, self),\n      close: function close() {\n        self.dialogBox.formContent.dialog(\"destroy\");\n        self.dialogBox.formContent.detach();\n      } });\n\n\n    self.previusValueProgress = self.formEditProgress.sliderProgress.slider(\"value\");\n\n  },\n\n  onChangeNumericTextBoxProgress: function onChangeNumericTextBoxProgress(event) {\n    var self = this;\n    var newValue = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\n    self.formEditProgress.sliderProgress.slider(\"value\", newValue);\n  },\n\n  onChangesliderProgress: function onChangesliderProgress(event) {\n    var self = this;\n    var newValue = self.formEditProgress.sliderProgress.slider(\"value\");\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", newValue);\n  },\n\n  onClickCancel: function onClickCancel(event) {\n    event.preventDefault();\n    var self = this;\n\n    self.dialogBox.formContent.dialog(\"destroy\");\n    self.dialogBox.formContent.detach();\n    //return before value progress\n    self.formEditProgress.sliderProgress.slider(\"value\", self.previusValueProgress);\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", self.previusValueProgress);\n  },\n\n  onSubmitFormChangeProgress: function onSubmitFormChangeProgress(event) {\n    event.preventDefault();\n    var self = this;\n\n    self.formEditProgress.buttonChangeProgress.prop(\"disabled\", true);\n\n    var activityToShow = self.params.plan.activities.filter(function (activity) {\n      return activity.id == self.params.plan.idActivitySelected;\n    })[0];\n    var params = $.extend(activityToShow, {\n      progress: self.formEditProgress.numericTextBoxPlugin.spinner(\"value\"),\n      idPlan: self.params.plan.id });\n\n    $.when(self.dataService.editActivityPlan(params)).done(function () {\n      self.formEditProgress.buttonChangeProgress.prop(\"disabled\", false);\n      activityToShow.progress = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\n      self.updateProgressUI(activityToShow.progress);\n      self.dialogBox.formContent.dialog(\"destroy\");\n      self.dialogBox.formContent.detach();\n    });\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.progress\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.progress], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Subprocesses Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", {}, {\n  /*\r\n                                                                                                               *   Constructor\r\n                                                                                                               */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-subprocesses\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-plan-activity-plan-subprocesses-wrapper\"),\n      \"project-subprocesses-tootip-custom-properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-activity-plan-subprocesses-tooltip-custom-properties-wrapper\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /*\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.subprocesses]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Parent\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.parent\", {}, {\n\n  /*\r\n                                                                                                         *   Constructor\r\n                                                                                                         */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-parent-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.parent\").concat(\"#project-plan-activity-parent\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    var $content = self.getContent().empty();\n\n    $.when(self.dataService.getPlanParent({ idPlan: self.params.plan.id })).done(function (planParent) {\n      self.params.plan.parent = planParent;\n      if (self.params.plan.parent) {\n        var argsTemplate = {};\n        argsTemplate.parent = {\n          idParent: self.params.plan.parent.radNumber,\n          nameParent: self.params.plan.parent.displayName,\n          idCase: self.params.plan.parent.idCase,\n          idWorkflow: self.params.plan.parent.idWorkflow,\n          idWorkItem: self.params.plan.parent.idWorkItem,\n          idTask: self.params.plan.parent.idTask };\n\n\n        //Update widget\n        var contentTemplate = self.getTemplate(\"plan-parent-main\");\n        contentTemplate.\n        render(argsTemplate).\n        appendTo($content);\n\n        $(\"#go-to-parent-case\", $content).on(\"click\", $.proxy(self.onClickGoToParentCase, self));\n      }\n    });\n\n\n  },\n\n  onClickGoToParentCase: function onClickGoToParentCase(event) {\n    event.preventDefault();\n    var self = this;\n    self.routingExecute($(event.target).closest(\"#go-to-parent-case\"));\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.parent\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.parent], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Users Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.users\", {}, {\n  /*\r\n                                                                                                        *   Constructor\r\n                                                                                                        */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    self.usersMap = {};\n    self.plugins = {};\n    self.usersInformation = [];\n    self.globalHandlersService = bizagi.injector.get('globalHandlersService');\n    self.usersAssignees = [];\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    //The load template the users plan because they are the same\n    self.loadTemplates({\n      \"plan-users-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.users\").concat(\"#project-plan-users\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /*\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n  },\n\n  /*\r\n      * validate if the activity is running\r\n      */\n  activityRunning: function activityRunning(activity) {\n    return activity.startDate !== null && activity.finishDate === null;\n  },\n\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this,\n    cvsGuidUsers = [],\n    activitiesUsers = [],\n    $content = self.getContent().empty();\n    self.params = $.extend(self.params, params.args);\n\n    var ownerUserId = self.params.plan.idUserCreator;\n    var ownerUserGuid = self.params.plan.idUserCreator;\n\n    activitiesUsers.push({ \"idUser\": ownerUserId, \"guidUser\": ownerUserGuid, \"userType\": [\"owner\"] });\n    self.usersMap[\"-\" + ownerUserId + \"-\"] = {\n      picture: \"\",\n      id: ownerUserId,\n      guid: ownerUserGuid,\n      name: \"\",\n      userType: [\"owner\"] };\n\n    cvsGuidUsers.push(ownerUserGuid);\n    $.each(self.params.plan.activities, function (index, activity) {\n      if (self.activityRunning(activity)) {\n        var userId = activity.userAssigned;\n        var userGuid = activity.userAssignedGuid;\n        if (userId === ownerUserId) {\n          if ($.inArray(\"Assigned\", activitiesUsers[0].userType) === -1) {\n            activitiesUsers[0].userType.push(\"Assigned\");\n            self.usersMap[\"-\" + ownerUserId + \"-\"].userType.push(\"Assigned\");\n          }\n        } else\n        {\n          self.usersMap[\"-\" + userId + \"-\"] = {\n            picture: \"\",\n            id: userId,\n            name: \"\",\n            userType: [\"Assigned\"] };\n\n          if (activitiesUsers.filter(function (user) {return user.idUser == userId;}).length === 0) {\n            var id = userGuid ? userGuid : userId;\n            activitiesUsers.push({ \"idUser\": id, \"userGuid\": id, \"userType\": [\"Assigned\"] });\n            cvsGuidUsers.push(id);\n          }\n        }\n      }\n    });\n    self.activitiesUsers = activitiesUsers;\n\n    //Update widget\n    var contentTemplate = self.getTemplate(\"plan-users-main\");\n    contentTemplate.\n    render({\n      assignee: self.justAssignees(activitiesUsers),\n      label: bizagi.localization.getResource(\"workportal-project-plan-assignee\") }).\n\n    appendTo($content);\n    self.addEventHandlersModal();\n    $.when(self.callGetDataUsers(cvsGuidUsers)).then(function () {\n      self.showCreatorInformation(ownerUserId);\n      self.renderUserProfilesAndImages();\n    });\n  },\n\n  /**\r\n      * return standar userAdapter information with only assigned users\r\n      * @param {Array} allUsers \r\n      */\n  justAssignees: function justAssignees(allUsers) {\n    var usersAssignee = [];\n    allUsers.map(function (user) {\n      var isOwner = user.userType.indexOf(\"owner\") !== -1;\n      var isAssignee = user.userType.indexOf(\"Assigned\") !== -1;\n      usersAssignee.push(usersAdapter.createJsonUserInfo(user.idUser, \"\", \"\", \"\", \"\", \"\", isAssignee, isOwner, [], []));\n    });\n    return usersAdapter.justAssignees(usersAssignee);\n  },\n\n  /**\r\n      * show the information of the creator case\r\n      * @param {string} ownerUserId guid user creator\r\n      */\n  showCreatorInformation: function showCreatorInformation(ownerUserId) {\n    var self = this;\n    var userCreator = self.usersMap[\"-\" + ownerUserId + \"-\"];\n    var userInfo = usersAdapter.createJsonUserInfo(\n    userCreator.id,\n    userCreator.name,\n    userCreator.username,\n    userCreator.picture ? userCreator.picture : undefined,\n    userCreator.email,\n    userCreator.name.getInitials(),\n    false,\n    true,\n    [],\n    []);\n\n    self.content.find(\".ui-bizagi-wp-project-plan-users .ui-bizagi-wp-project-users-creator-info\").userinformation(self, { user: userInfo });\n  },\n\n  /**\r\n      * UI\r\n      */\n\n  renderUserProfilesAndImages: function renderUserProfilesAndImages() {\n    var self = this;\n    $.each(self.usersMap, function (i, obj) {\n      var $li = $(\".ui-bizagi-wp-userlist li[data-iduser=\" + obj.id + \"]\", self.content);\n      if (obj.picture !== \"\") {\n        $li.find(\"img\").prop(\"src\", obj.picture);\n      } else\n      {\n        $li.find(\"img\").hide();\n        if (obj.name !== undefined) {\n          $li.find(\"span\").html(obj.name.getInitials());\n        } else\n        {\n          console.log(\"obj.name is undefined\");\n        }\n\n      }\n    });\n    $(\".ui-bizagi-wp-userlist li\", self.content).not(\".moreUsers\").on('mouseenter', function (ev) {\n      var $target = $(ev.target);\n      var userId = $(this).data(\"iduser\");\n      var userSelected;\n      $.each(self.usersMap, function (i, obj) {\n        if (obj.id === userId)\n        userSelected = obj;\n      });\n      var usersActivities = self.usersAssignees.find(function (assignee) {\n        return assignee.userAssigned === userSelected.id;\n      });\n      var activities = [];\n      if (usersActivities)\n      usersActivities.activities.map(function (activity) {\n        activities.push(activity.name);\n      });\n      var userParam = usersAdapter.createJsonUserInfo(userSelected.id, userSelected.name, userSelected.username, userSelected.picture, userSelected.email, userSelected.name.getInitials(), self.getIsAssignee(userSelected), self.getIsOwner(userSelected), activities, undefined);\n\n      $target.parent().usertooltip(self, { target: $target, user: userParam });\n    });\n  },\n\n  getIsAssignee: function getIsAssignee(userSelected) {\n    if (userSelected.userType.indexOf(\"Assigned\") > -1) {\n      return true;\n    }\n    return false;\n  },\n\n  getIsOwner: function getIsOwner(userSelected) {\n    if (userSelected.userType.indexOf(\"owner\") > -1) {\n      return true;\n    }\n    return false;\n  },\n  /*\r\n      *  Get data for users\r\n      */\n  callGetDataUsers: function callGetDataUsers(cvsGuidUsers) {\n    var self = this,\n    params = {},\n    defer = $.Deferred();\n    params = {\n      usersGuids: cvsGuidUsers.join(),\n      width: 50,\n      height: 50 };\n\n    $.when(self.dataService.getUsersData(params)).always(function (response) {\n      self.usersInformation = response;\n      for (var i = 0, length = response.length; i < length; i += 1) {\n        if (typeof response[i].name === \"undefined\") {\n          bizagi.log(response[i] + \" Id Not Found\", response, \"error\");\n        } else {\n          if (self.usersMap[\"-\" + response[i].id + \"-\"]) {\n            self.usersMap[\"-\" + response[i].id + \"-\"].picture += response[i].picture ? \"data:image/png;base64,\" + response[i].picture : \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].name = response[i].name || \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].username = response[i].username || \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].email = response[i].email || \"\";\n          } else\n          {\n            console.log(\"The object is undefined\");\n          }\n        }\n      }\n      self.getUsersAssignees();\n      defer.resolve();\n    });\n    return defer.promise();\n  },\n\n  getUsersAssignees: function getUsersAssignees() {\n    var self = this;\n    for (var i = 0; i < self.usersInformation.length; i++) {\n      self.usersAssignees.push(self.getUserAssignee(self.usersInformation[i]));\n    }\n\n  },\n\n  getUserAssignee: function getUserAssignee(user) {\n    var self = this;\n    var tasks = [];\n    $.each(self.params.plan.activities, function (index, activity) {\n      var userId = activity.userAssigned;\n      if (userId === user.id && self.activityRunning(activity)) {\n        tasks.push({ \"name\": activity.name });\n      }\n    });\n    user.tasks = tasks;\n    var types = self.activitiesUsers.find(function (actUser) {\n      return actUser.idUser == user.id;\n    });\n    user.userType = types.userType;\n\n    var userAssignees = usersAdapter.createJsonUserInfo(\n    user.id,\n    user.name,\n    user.username,\n    user.picture ? \"data:image/png;base64,\" + user.picture : undefined,\n    user.email,\n    user.name.getInitials(),\n    self.getIsAssignee(user),\n    self.getIsOwner(user),\n    user.tasks,\n    []);\n\n    return userAssignees;\n  },\n\n  addEventHandlersModal: function addEventHandlersModal() {\n    var self = this;\n    $(\".moreUsers\").click(function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var usersAssignees = self.usersAssignees || [];\n      self.globalHandlersService.publish(\"showDialogWidget\", {\n        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\n        closeVisible: true,\n        data: usersAssignees,\n        maximize: true,\n        modalParameters: {\n          title: bizagi.localization.getResource(\"workportal-project-users-title\") + \" (\" + usersAssignees.length + \")\",\n          width: 790,\n          height: 526,\n          refreshInbox: false } });\n\n\n    });\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.users\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.users], true);","/**\r\n * Name: BizAgi Desktop Widget Dashboard menu (left sidebar) * \r\n * @author Valeria Vanegas\r\n */\n\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu\", {}, {\n\n  /**\r\n                                                                                                   * Handler when discussions menu status change\r\n                                                                                                   * @param {*} ev \r\n                                                                                                   * @param {*} params \r\n                                                                                                   */\n  onDiscussionsMenuStatusChange: function onDiscussionsMenuStatusChange(ev, params) {\n    var self = this;\n    self.updateDiscussionsIcons(params.hasDiscussionsOrComment);\n  },\n\n  /**\r\n      * Update discussions icon on sidebar menu\r\n      * The icon is different when there is other discussion or there are comments\r\n      * @param {*} hasDiscussionsOrComment \r\n      */\n  updateDiscussionsIcons: function updateDiscussionsIcons(hasDiscussionsOrComment) {\n    var self = this;\n\n    self.sub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n\n    $(\".bz-icon-discussion-comment\").toggle(hasDiscussionsOrComment);\n    $(\".bz-icon-discussion-no-comment\").toggle(!hasDiscussionsOrComment);\n    self.params.hasDiscussionsOrComment = hasDiscussionsOrComment;\n  },\n\n  /**\r\n      * Detach events\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.unsub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu], true);","/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity Plan\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.dashboard.menu.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", {}, {\n\n  /**\r\n                                                                                                                                 *   Constructor\r\n                                                                                                                                 */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    self.params = params || {};\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan\").concat(\"#project-dashboard-menu2\") });\n\n  },\n\n  /**\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /**\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self._super();\n    //Handlers\n    self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n      self.sub(context, $.proxy(self.updateView, self));\n    });\n  },\n\n  /**\r\n      * Update view\r\n      * @param event\r\n      * @param params\r\n      */\n  updateView: function updateView(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    self.clean();\n    var $content = self.getContent().empty();\n\n    var argsTemplate = {\n      showFormOverview: self.params.menuDashboard.showFormOverview,\n      showFormActivity: self.params.menuDashboard.showFormActivity,\n      showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\n      showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\n      showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu,\n      showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\n      contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\n      contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu,\n      contextualized: self.params.plan.contextualized };\n\n\n    //Update widget\n    var template = self.getTemplate(\"project-dashboard-menu\");\n    template.render(argsTemplate).appendTo($content);\n\n    if (self.params.showContextByMenuDashboard) {\n      $(\"li[data-context='\" + event.type.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n    }\n\n    self.updateDiscussionsIcons(self.params.hasDiscussionsOrComment);\n    self.handlerEvents();\n\n    var paramsGetPlan = { idPlan: self.params.plan.id };\n    $.when(self.callGetPlan(paramsGetPlan)).then(function (responsePlan) {\n      $.extend(self.params.plan, responsePlan);\n      self.pub(\"notify\", {\n        type: \"LOAD_INFO_PLAN\",\n        args: self.params });\n\n    });\n  },\n\n  /**\r\n      *   Load Content By Id\r\n      */\n  loadContentById: function loadContentById(event) {\n    var self = this;\n    event.preventDefault();\n    var $item = $(event.target).closest(\"li\");\n\n    if (!$item.hasClass(\"active\")) {\n      $.when(bizagi.util.autoSave()).done(function () {\n        $(document).data('auto-save', '');\n\n        var showContextByMenuDashboard = $item.data(\"context\");\n        if (showContextByMenuDashboard) {\n          var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\n          var currentLevelNavigator = parseInt(getLevelNavigator[0]);\n          var nameItemNavigator = \"\";\n          var newLevelNavigator = currentLevelNavigator;\n\n          self.params.refreshLastItemBreadcrumb = false;\n          self.pub(\"notify\", {\n            type: showContextByMenuDashboard.toUpperCase(),\n            args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\n              histName: nameItemNavigator,\n              level: newLevelNavigator }) });\n\n          $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n        }\n      });\n    }\n  },\n\n  /**\r\n      * Call services\r\n      */\n\n  callGetPlan: function callGetPlan(params) {\n    var self = this;\n    var defer = $.Deferred();\n    self.dataService.getPlan(params).always(function (response) {\n      if (response.status === 200 || response.status === 201 || response.status === undefined) {\n        defer.resolve(response);\n      } else\n      {\n        defer.reject();\n      }\n    });\n\n    return defer.promise();\n  },\n\n  subMenuHandler: function subMenuHandler() {\n    var self = this;\n    var content = self.getContent();\n    var $comments = $(\"[data-context='ACTIVITYPLANCOMMENTS']\", content);\n    var $files = $(\"[data-context='ACTIVITYPLANFILES']\", content);\n    var $timeline = $(\"[data-context='ACTIVITYPLANTIMELINE']\", content);\n\n    $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\n      $comments.toggle();\n      $files.toggle();\n      $timeline.toggle();\n    });\n  },\n\n  /**\r\n      * Handler events\r\n      */\n  handlerEvents: function handlerEvents() {\n    var self = this;\n    var content = self.getContent();\n    self.subMenuHandler();\n    $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\n  },\n\n  /**\r\n      * Clean widgets and events\r\n      */\n  clean: function clean() {\n    var self = this;\n    var content = self.getContent();\n\n    self._super();\n\n    if (self.params && self.params.contextsLeftSidebarCaseDashboard) {\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n        self.unsub(context, $.proxy(self.updateView, self));\n      });\n    }\n\n    $(\".ui-bizagi-wp-project-tab-links a\", content).off();\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity.plan], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\n\n  /*\r\n                                                                                                      *   Constructor\r\n                                                                                                      */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\") });\n\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-content-dashboard\");\n    self.content = template.render({});\n\n    return self.content;\n  },\n  postRender: function postRender() {\n    var self = this;\n\n    setTimeout(function () {\n      $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\n    }, 1000);\n\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","\n/*\r\n *   Name: BizAgi Workportal Widget Project Attachments\r\n *   Author: David Romero Estrada\r\n *   Comments:\r\n *   -   This script will define the framework API to manage attachments\r\n */\n\n(function ($) {\n\n  // shorten references to variables. this is better for uglification \n  var kendo = window.kendo,\n  ui = kendo.ui,\n  Widget = ui.Widget;\n\n  var ProjectAttachments = Widget.extend({\n\n    init: function init(element, options) {\n\n      var that = this;\n\n      // base call to initialize widget\n      Widget.fn.init.call(that, element, options);\n\n      that._maxFilesSize = options.maxSize;\n      that._fileList = [];\n      that._onlyValidateServerFileExtension = options.onlyValidateServerFileExtension || true;\n      that._supportFileExt = options.extensions;\n      that._uploadMaxFilesSize = options.maxSize;\n      that.upload = that._initUpload();\n      that.loadNotifier = that._initLoadNotifier();\n      that.notification = that._initNotification();\n\n      that._eventsHandler();\n\n      that._initLocalization(that.options.localization);\n    },\n\n    options: {\n      name: \"ProjectAttachments\",\n      wrapper: $(\"<div class=\\\"project-attachments\\\"></div>\"),\n      multiple: true,\n      dropZone: true,\n      maxFilesSize: bizagi.currentUser ? bizagi.currentUser.uploadMaxFileSize : 25000,\n      enabled: true,\n      localization: {} },\n\n\n    _initUpload: function _initUpload() {\n\n      var that = this,\n      options = that.options,\n      localization = options.localization || {},\n      auxNumberFilesSuccess = 0;\n\n      that._initLocalization(localization);\n\n      return this.element.kendoUpload({\n        async: {\n          saveUrl: options.saveUrl + '?xsrf=' + bizagi.getXSRFToken(),\n          autoUpload: true },\n\n        select: function select(event) {\n          that._filterMaxFilesSize(event);\n          auxNumberFilesSuccess = 0;\n        },\n        complete: function complete() {\n          var interval = setInterval(function () {\n            if (that.loadNotifier.wrapper.find(\"li.k-file-progress\").length === 0) {\n              that._showNotificationCompleteUpload(that.loadNotifier.wrapper, auxNumberFilesSuccess);\n              clearInterval(interval);\n            }\n          }, 300);\n        },\n        upload: options.upload,\n        progress: function progress(event) {\n          that._onProgressFile(event);\n        },\n        success: function success(event) {\n          that._fileList.push(event.files[0]);\n          auxNumberFilesSuccess += 1;\n          options.success(event);\n        },\n        error: function error(event) {\n          that.onErrorFile(event);\n        },\n        localization: {\n          select: localization.selectFiles,\n          dropFilesHere: localization.dropFilesHere },\n\n        multiple: options.multiple,\n        enabled: options.enabled,\n        dropZone: options.dropZone,\n        showFileList: false }).\n      data(\"kendoUpload\");\n\n    },\n\n    _initNotification: function _initNotification() {\n      return $(\"<div></div>\").kendoNotification({\n        position: {\n          pinned: true } }).\n\n      data(\"kendoNotification\");\n    },\n\n    _initLoadNotifier: function _initLoadNotifier() {\n\n      var that = this,\n      localization = that.options.localization,\n      $wrapper = that.options.wrapper;\n\n      return $wrapper.kendoWindow({\n        title: localization.notifierTitle,\n        actions: [\"Close\"],\n        animation: {\n          open: {\n            duration: 100 },\n\n          close: {\n            duration: 100 } },\n\n\n        open: function open() {\n          this.wrapper.addClass(\"project-attachments-wrapper-window\");\n        },\n        visible: false,\n        resizable: false,\n        draggable: false,\n        maxHeight: \"300px\",\n        minWidth: \"430px\" }).\n      data(\"kendoWindow\");\n\n    },\n\n    _initLocalization: function _initLocalization(objectOptionsLocalization) {\n      var that = this;\n      var optionsLocalizationByDefault = {\n        selectFiles: bizagi.localization.getResource(\"workportal-project-attachments-addfiles\"),\n        notifierTitle: bizagi.localization.getResource(\"workportal-project-attachments-notifiertitle\"),\n        errorUpload: bizagi.localization.getResource(\"workportal-project-attachments-file-error\"),\n        errorSecurity: bizagi.localization.getResource(\"workportal-project-attachments-blockedext\"),\n        errorSize: bizagi.localization.getResource(\"workportal-project-attachments-blockedsize\"),\n        errorMaxFilesSize: bizagi.localization.getResource(\"workportal-project-discussion-maxfilessize\").replace(\"%s\", that._getSize(that._maxFilesSize)),\n        dropFilesHere: bizagi.localization.getResource(\"workportal-project-attachments-drophere\"),\n        cancel: bizagi.localization.getResource(\"workportal-widget-reports-confirm-cancel\"),\n        retry: bizagi.localization.getResource(\"workportal-project-attachments-retry\"),\n        close: bizagi.localization.getResource(\"workportal-widget-dialog-box-close\") };\n\n\n      $.extend(objectOptionsLocalization, optionsLocalizationByDefault);\n    },\n\n    /**\r\n        * return maxSize in MB\r\n        * @param {*} maxSize \r\n        */\n    _getSize: function _getSize(maxSize) {\n      return Math.round(maxSize / (1024 * 1024), -1);\n    },\n\n    _onProgressFile: function _onProgressFile(event) {\n\n      var that = this;\n      var $file = that._getFileItemByUID(event.files[0].uid);\n      var percent = event.percentComplete;\n\n      $(\".k-progress\", $file).css({\n        width: percent + \"%\" });\n\n\n      $(\".k-upload-pct\", $file).removeClass(\"k-icon k-loading\").text(percent + \"%\");\n\n      if (percent === 100) {$(\".k-upload-action .k-icon\", $file).hide();}\n    },\n\n    _onShowUploadNotifier: function _onShowUploadNotifier(event) {\n\n      var that = this,\n      files = event.files,\n      template = that.options.template;\n\n      that.loadNotifier.content(template.render({ files: files }));\n      that.loadNotifier.wrapper.css({\n        top: \"auto\",\n        left: \"auto\",\n        bottom: \"1em\",\n        right: \"1em\" });\n\n\n      that.loadNotifier.open();\n    },\n\n    _showNotificationCompleteUpload: function _showNotificationCompleteUpload(wrapperMessage, auxNumberFilesSuccess) {\n      var that = this;\n      if (wrapperMessage.find(\"li.k-file-success\").length === auxNumberFilesSuccess && wrapperMessage.find(\"li.k-file-error\").length === 0)\n      {\n        that._autoHideMessage(wrapperMessage);\n      }\n    },\n\n    _autoHideMessage: function _autoHideMessage(wrapperMessage) {\n      var that = this;\n      setTimeout(function () {\n        wrapperMessage.fadeOut(function () {\n          that.loadNotifier.close();\n        });\n      }, 2000);\n    },\n\n    _onCancelFile: function _onCancelFile($target) {\n      var that = this,\n      $fileWrapper = $target.closest(\"li\"),\n      $uploadWrapper = that.upload.wrapper,\n      guid = $fileWrapper.data(\"guid\");\n\n      $uploadWrapper.find(\"li[data-uid=\" + guid + \"] .k-upload-action\").trigger(\"click\");\n      $fileWrapper.remove();\n    },\n\n    _onRemoveFile: function _onRemoveFile($target) {\n      var $fileWrapper = $target.closest(\"li\");\n      $fileWrapper.remove();\n    },\n\n    _onRetryFile: function _onRetryFile($target) {\n      var that = this;\n      var $file = $target.closest(\"li\");\n      var guid = $file.data(\"guid\");\n      var file = $.grep(that._fileList, function (i) {\n        return i.uid === guid;\n      });\n\n      that.options.retry(file[0]);\n    },\n\n    onErrorFile: function onErrorFile(event) {\n\n      var that = this,\n      localization = that.options.localization,\n      file = event.files[0],\n      validation = that._isValidFile(file);\n      var message = validation.message !== \"\" ? validation.message : localization.errorUpload;\n\n      that.setStatus(\"ERROR\", file.uid, message);\n    },\n\n    _isValidFile: function _isValidFile(file) {\n\n      var that = this,\n      localization = that.options.localization,\n      valid = true,\n      message = \"\";\n\n      if (file.size > that._uploadMaxFilesSize || file.size == undefined || file.size == 0) {\n        message = localization.errorSize;\n        valid = false;\n      }\n\n      if (!that._onlyValidateServerFileExtension) {\n        if ($.inArray(file.extension, that._supportFileExt) === -1) {\n          message = localization.errorSecurity;\n          valid = false;\n        }\n      }\n\n      return {\n        valid: valid,\n        message: message };\n\n    },\n\n    _filterMaxFilesSize: function _filterMaxFilesSize(event) {\n\n      var that = this;\n      var total = 0;\n\n      for (var i = 0, length = event.files.length; i < length; i++) {\n        total += event.files[i].size;\n      }\n      if (total > that._maxFilesSize) {\n        that._notifySizeExceeded();\n        event.preventDefault();\n      } else {\n        that._onShowUploadNotifier(event);\n      }\n    },\n\n    _notifySizeExceeded: function _notifySizeExceeded() {\n\n      var that = this;\n\n      that.notification.show(that.options.localization.errorMaxFilesSize, \"error\");\n    },\n\n    _getFileItemByUID: function _getFileItemByUID(uid) {\n      var that = this;\n      return $(\"li[data-guid=\" + uid + \"]\", that.loadNotifier.element);\n    },\n\n    _switchEvents: function _switchEvents(event) {\n      var that = this;\n      var $target = $(\".k-icon\", event.currentTarget);\n      if ($target.hasClass(\"k-update\") || $target.hasClass(\"k-remove\")) {\n        that._onRemoveFile($target);\n      } else if ($target.hasClass(\"k-retry\")) {\n        that._onRetryFile($target);\n      } else if ($target.hasClass(\"k-cancel\")) {\n        that._onCancelFile($target);\n      }\n    },\n\n    _eventsHandler: function _eventsHandler() {\n      var that = this;\n\n      that.loadNotifier.element.on(\"click\", \"button.k-upload-action\", function (event) {\n        that._switchEvents(event);\n      });\n    },\n\n    cancelFilesUpload: function cancelFilesUpload() {\n      var that = this;\n      var $uploadWrapper = that.upload.wrapper;\n\n      $uploadWrapper.find(\"li .k-upload-action\").trigger(\"click\");\n      that.close();\n    },\n\n    close: function close() {\n      this.loadNotifier.close();\n    },\n\n    destroy: function destroy() {\n      this.loadNotifier.destroy();\n      this.upload.destroy();\n    },\n\n    setStatus: function setStatus(status, uid, message) {\n\n      var $file = this._getFileItemByUID(uid),\n      localization = this.options.localization;\n\n      switch (status) {\n        case \"SUCCESS\":\n          $file.removeClass(\"k-file-progress k-file-error\").addClass(\"k-file-success\");\n          $(\".k-upload-action .k-icon\", $file).removeClass(\"k-cancel k-i-refresh k-retry\").addClass(\"k-update\").prop(\"title\", localization.close).show();\n          $(\".k-errormsg\", $file).text(\"\");\n          break;\n        case \"ERROR\":\n          $file.removeClass(\"k-file-progress\").addClass(\"k-file-error\");\n          $(\".k-upload-action .k-icon\", $file).removeClass(\"k-i-refresh k-retry\").addClass(\"k-remove\").show();\n          $(\".k-upload-status .k-upload-pct\", $file).removeClass(\"k-upload-pct k-loading\").addClass(\"k-icon k-warning\");\n          $(\".k-errormsg\", $file).text(message).prop(\"title\", message);\n          break;\n        case \"RETRY\":\n          $file.removeClass(\"k-file-progress\").addClass(\"k-file-error\");\n          $(\".k-upload-status .k-upload-pct\", $file).removeClass(\"k-upload-pct k-loading\").addClass(\"k-warning\").text(\"\");\n          $(\".k-upload-action .k-icon\", $file).removeClass(\"k-cancel k-remove\").addClass(\"k-i-refresh k-retry\").prop(\"title\", localization.retry).show();\n          $(\".k-errormsg\", $file).text(localization.errorUpload).prop(\"title\", localization.errorUploadiis);\n          break;}\n\n    } });\n\n\n\n  ui.plugin(ProjectAttachments);\n})(jQuery);","/*\r\n *   Name: Bizagi Workportal Desktop Project Files Controller\r\n *   Author: David Romero Estrada\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.files\", {}, {\n  /**\r\n                                                                                               *   Constructor\r\n                                                                                               */\n  init: function init(workportalFacade, dataService, params) {\n\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.plugins = {};\n    self.prefixBase64 = \"data:image/png;base64,\";\n    self.usersData = {};\n    self.currentFilesList = [];\n    self.fileDateInterval;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-files\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.files\").concat(\"#project-files-wrapper\"),\n      \"project-files-uploaditem\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.files\").concat(\"#project-files-uploaditem\"),\n      \"project-files-list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.files\").concat(\"#project-files-list\"),\n      \"project-attachments\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.attachments\").concat(\"#project-attachments\") });\n\n  },\n\n  /**\r\n     * Renders the template defined in the widget\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n    var templateHomeFiles = self.getTemplate(\"project-files\");\n    self.content = templateHomeFiles.render({ isOpen: !bizagi.util.parseBoolean(self.params.isClosedForAllUsers) });\n    return self.content;\n  },\n\n  /**\r\n     * Post render and links events with handlers\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    $.when(self.renderFilesList()).done(function () {\n      self.plugins[\"uploadFiles\"] = self.initializeUploadFiles();\n      self.eventsHandler();\n      self.restrictedEventsHandler();\n    });\n  },\n\n  /**\r\n     *   Render Files List\r\n     */\n  renderFilesList: function renderFilesList() {\n    var self = this;\n    var defer = $.Deferred();\n    var filesLength = self.currentFilesList.length;\n    var params = {\n      globalParent: self.radNumber,\n      dateTime: !filesLength ? self.getDateServer() : self.currentFilesList[filesLength - 1].date,\n      count: 12 };\n\n    if (self.params.flowContext === \"FLOW-DECONTEXTUALIZED-PLANS\") {\n      params.globalParent = self.params.plan.id;\n    }\n    $.when(self.dataService.getFilesListByRadNumber(params)).done(function (files) {\n      self.currentFilesList = self.currentFilesList.concat(files);\n\n      self.renderFiles(files);\n\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n     * Render Files\r\n     */\n  renderFiles: function renderFiles(files) {\n\n    var self = this;\n\n    var $content = self.getContent();\n    var $showMoreWrapper = $(\"#project-files-showmore\", $content);\n    self.displayFileList(files, \"append\");\n    self.updateRelativeTime();\n\n    if (files.length) {\n      self.setAdditionalData(files);\n    }\n\n    if (self.currentFilesList.length >= 12) {\n      $showMoreWrapper.show();\n\n      if (files.length < 12) {\n        $(\"button\", $showMoreWrapper).remove();\n        $(\"#project-files-nomore\", $showMoreWrapper).show();\n      }\n    }\n\n    self.notifyFilesNumber(false);\n  },\n\n  /**\r\n     * Render no files\r\n     */\n  renderNoFiles: function renderNoFiles() {\n\n    var self = this;\n    var noFilesTmpl = self.workportalFacade.getTemplate(\"info-message\");\n    var message = self.resources.getResource(\"workportal-project-files-noavailable\");\n\n    /* self.disableSideBar();*/\n\n    var $noFiles = $.tmpl(noFilesTmpl, {\n      message: message });\n\n\n    self.content.html($noFiles);\n  },\n\n  /**\r\n     * Initialize upload files\r\n     */\n  initializeUploadFiles: function initializeUploadFiles() {\n    var self = this;\n    var content = self.getContent();\n\n    return $(\"#project-files-upload\", content).kendoProjectAttachments({\n      saveUrl: self.dataService.serviceLocator.getUrl(\"project-comments-uploadfiles\"),\n      template: self.getTemplate(\"project-attachments\"),\n      success: $.proxy(self.onSuccessFile, self),\n      upload: $.proxy(self.addFileData, self),\n      retry: $.proxy(self.onSaveFileData, self),\n      enabled: true,\n      extensions: self.supportFileExt,\n      maxSize: self.uploadMaxFilesSize }).\n    data(\"kendoProjectAttachments\");\n  },\n\n  /**\r\n     * Set Additional Data For Files\r\n     */\n  setAdditionalData: function setAdditionalData(files) {\n\n    var self = this;\n    var thumbnails = [],users = [],guidsUsers = [];\n\n    for (var i = 0, length = files.length - 1; i <= length; i++) {\n      users.push(files[i].user);\n      guidsUsers.push(files[i].user);\n      thumbnails.push(files[i].attachment.guid);\n    }\n\n    self.setUserData(guidsUsers.join());\n    self.setThumbnails(thumbnails.join());\n  },\n\n  /**\r\n     * Set User Data\r\n     */\n  setUserData: function setUserData(users) {\n    var self = this;\n    var $content = self.getContent();\n\n    var params = {\n      usersGuids: users,\n      width: 50,\n      height: 50 };\n\n\n    $.when(self.dataService.getUsersData(params)).done(function (users) {\n      for (var i = 0, length = users.length - 1; i <= length; i++) {\n        if (users[i].picture) {\n          users[i].picture = self.prefixBase64 + users[i].picture;\n        }\n        self.usersData[\"id\" + users[i].id] = users[i];\n        $(\"#project-files-list .ui-bizagi-wp-project-files-user[data-userId=\" + users[i].id + \"]\", $content).text(users[i].name);\n      }\n    });\n  },\n\n  /**\r\n     * Get file list \r\n     */\n  getFileInfoByGuid: function getFileInfoByGuid(guid) {\n    var self = this;\n    var file;\n    for (var i = 0, length = self.currentFilesList.length; i < length; i++) {\n\n      if (guid === self.currentFilesList[i].guid) {\n        file = self.currentFilesList[i];\n        i = length;\n      }\n    }\n    return file;\n  },\n\n  /**\r\n     * Set Thumbnails\r\n     */\n  setThumbnails: function setThumbnails(thumbnails) {\n    var self = this;\n    var $content = self.getContent();\n\n    var params = {\n      guids: thumbnails,\n      width: 480,\n      height: 150,\n      globalParent: self.params.radNumber };\n\n\n    $.when(self.dataService.getFilesThumbnails(params)).done(function (files) {\n      var thumbnail, $wrapper, $img;\n\n      $.each(files, function (guid, src) {\n        guid = guid.toLowerCase();\n        thumbnail = self.prefixBase64 + src;\n        $wrapper = $(\"#project-files-list .ui-bizagi-wp-project-files-wrapitem[data-attchGuid=\" + guid + \"]\", $content);\n        $img = $(\".ui-bizagi-wp-project-files-thumbnail\", $wrapper);\n\n        $img.prop(\"src\", thumbnail);\n        $(\".ui-bizagi-wp-project-files-icon\", $wrapper).remove();\n        $img.css(\"display\", \"block\");\n      });\n    });\n  },\n\n  /**\r\n     * Set Preview\r\n     */\n  setFilePreview: function setFilePreview($target, guidAttch, guidFile) {\n\n    var self = this;\n    var img = \"\";\n    var params = {\n      guids: [guidAttch].join(),\n      width: 500,\n      height: 500,\n      globalParent: self.params.radNumber };\n\n\n    $.when(self.dataService.getFilesThumbnails(params)).done(function (files) {\n      var $userTag = $target.find(\".ui-bizagi-wp-project-files-user\");\n      var userId = $userTag.data(\"userid\");\n\n      $.each(files, function (guid, src) {\n        img = self.prefixBase64 + src;\n      });\n\n      self.pub(\"notify\", {\n        type: \"FILEPREVIEW\",\n        args: {\n          radNumber: self.radNumber,\n          fileData: self.getFileInfoByGuid(guidFile),\n          userData: self.usersData[\"id\" + userId],\n          isOpen: !bizagi.util.parseBoolean(self.params.isClosedForAllUsers),\n          img: img } });\n\n\n\n      self.pub(\"notify\", {\n        type: \"OPEN_RIGHT_SIDEBAR\" });\n\n    });\n  },\n\n  /**\r\n     *  On Success File\r\n     */\n  onSuccessFile: function onSuccessFile(event) {\n\n    var self = this;\n    var status = event.XMLHttpRequest.response ? JSON.parse(event.XMLHttpRequest.response) : {};\n\n    if (!status.error) {\n      self.onSaveFileData(event.files[0]);\n    } else {\n      self.plugins[\"uploadFiles\"].onErrorFile(event);\n    }\n  },\n\n  /**\r\n     * On Save File Data\r\n     */\n  onSaveFileData: function onSaveFileData(file) {\n\n    var self = this;\n\n    $.when(self.saveFileData(file)).done(function () {\n      self.notifyFilesNumber();\n      self.plugins[\"uploadFiles\"].setStatus(\"SUCCESS\", file.uid);\n    }).fail(function () {\n      self.plugins[\"uploadFiles\"].setStatus(\"RETRY\", file.uid);\n    });\n  },\n\n  /**\r\n      * Retry file\r\n      * @param $target\r\n      */\n  onRetryFile: function onRetryFile($target) {\n    var self = this;\n    var $file = $target.closest(\"li\");\n    var guid = $file.data(\"guid\");\n\n    var file = $.grep(self.currentFilesList, function (i) {\n      return i.uid === guid;\n    });\n\n    self.onSaveFileData($file, file[0]);\n  },\n\n  /**\r\n      * Add Guid to Files Data\r\n      * @param event\r\n      */\n  addFileData: function addFileData(event) {\n    var self = this;\n\n    //add guid to send\n    event.data = {\n      guid: event.files[0].uid };\n\n  },\n\n  /**\r\n      * Save Files\r\n      * @param file\r\n      * @return {*}\r\n      */\n  saveFileData: function saveFileData(file) {\n\n    var self = this;\n    var defer = $.Deferred();\n\n    var guid = Math.guid();\n    var globalParent = self.radNumber ? self.radNumber.toString() : \"\";\n    if (self.params.flowContext === \"FLOW-DECONTEXTUALIZED-PLANS\") {\n      globalParent = self.params.plan.id;\n    }\n\n    var params = {\n      \"content\": {\n        \"guid\": guid,\n        \"description\": \"\",\n        \"name\": file.name,\n        \"attachment\": {\n          \"guid\": file.uid,\n          \"name\": file.name },\n\n        \"date\": self.getDateServer(),\n        \"user\": bizagi.currentUser.idUser,\n        \"globalParent\": globalParent },\n\n      \"attachmentsToCreate\": [\n      file.uid] };\n\n\n\n    self.currentFilesList.unshift(file);\n\n    $.when(self.dataService.createProjectFile(params)).always(function (response) {\n      if (response.status === 200 || response.status === 201 || response.status === undefined) {\n\n        //extend file data\n        $.extend(file, {\n          user: bizagi.currentUser.idUser,\n          userName: bizagi.currentUser.userName,\n          date: new Date().getTime(),\n          attachment: params.content.attachment,\n          guid: params.content.guid,\n          description: params.content.description });\n\n\n        self.usersData[\"id\" + bizagi.currentUser.idUser] = {\n          picture: bizagi.currentUser.photo,\n          name: bizagi.currentUser.userName,\n          id: bizagi.currentUser.idUser };\n\n\n        self.displayFileList(file, \"prepend\");\n\n        self.updateRelativeTime();\n        self.setThumbnails(file.uid);\n\n        defer.resolve();\n      } else {\n\n        defer.reject();\n      }\n    });\n\n    return defer;\n  },\n\n  /**\r\n      * Display File List\r\n      * @param files\r\n      * @param action\r\n      */\n  displayFileList: function displayFileList(files, action) {\n    var self = this;\n    var tmpl = self.getTemplate(\"project-files-list\");\n    var files = files || self.currentFilesList;\n    var content = self.getContent();\n    var $filesList = tmpl.render({\n      files: files });\n\n\n    $(\"#project-files-list\", content)[action]($filesList);\n    $.equalizeHeights(\".bz-card\");\n  },\n\n  /**\r\n      * Delete file\r\n      * @param event\r\n      * @param params\r\n      */\n  deleteFile: function deleteFile(event, params) {\n    var self = this;\n\n    var content = self.getContent();\n    $(\"div[data-fileguid='\" + params.args.guid + \"']\", content).remove();\n\n    self.currentFilesList = self.currentFilesList.filter(function (file) {\n      return file.guid !== params.args.guid;\n    });\n\n    self.notifyFilesNumber(true);\n  },\n\n  /**\r\n      * Update File Data\r\n      * @param event\r\n      * @param params\r\n      */\n  updateFileData: function updateFileData(event, params) {\n\n    var self = this;\n    var file = self.getFileInfoByGuid(params.args.guid);\n\n    file.description = params.args.description;\n  },\n\n  /**\r\n     * Update relative time\r\n     */\n  updateRelativeTime: function updateRelativeTime() {\n\n    var self = this;\n\n    if (self.fileDateInterval) clearInterval(self.fileDateInterval);\n\n    self.fileDateInterval = setInterval($.proxy(self.changeRelativeTime, self), \"7000\");\n  },\n\n  /**\r\n     * Change Relative Time\r\n     */\n  changeRelativeTime: function changeRelativeTime() {\n\n    var self = this;\n    var $content = self.getContent();\n\n    $(\"#project-files-list .ui-bizagi-wp-project-files-date\", $content).each(function (i, item) {\n      var dateTime = $(item).data(\"date\");\n      var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(dateTime), null, false);\n\n      $(item).text(relativeTime);\n    });\n  },\n\n  /**\r\n      * Filter files by some criteria\r\n      * @param event\r\n      */\n  onSelectFiles: function onSelectFiles(event) {\n\n    var self = this,\n    bannedFiles = [],\n    files = event.files;\n\n    for (var i = files.length - 1; i >= 0; i--) {\n\n      if (!self.isValidFile(files[i]).valid) {\n        var bannedFile = files.splice(i, i + 1);\n        bannedFiles.unshift(bannedFile[0]);\n      }\n    }\n\n    if (bannedFiles.length > 0) {\n      self.showFilesError(bannedFiles);\n    }\n  },\n\n  /**\r\n      * Reset widget\r\n      */\n  resetWidget: function resetWidget() {\n\n    var self = this;\n    if (self.plugins[\"uploadFiles\"]) {\n      self.plugins[\"uploadFiles\"].close();\n    }\n    self.currentFilesList = [];\n    clearInterval(self.fileDateInterval);\n  },\n\n  /**\r\n     * Switch Events\r\n     */\n  switchFilesEvents: function switchFilesEvents(event) {\n\n    event.stopPropagation();\n\n    var self = this;\n\n    var $target = $(event.target),\n    $item = $target.closest(\".ui-bizagi-wp-project-files-wrapitem\");\n\n    if ($item.length) {\n\n      var guidAttch = $item.data(\"attchguid\"),\n      guidFile = $item.data(\"fileguid\");\n\n      if ($target.hasClass(\"ui-bizagi-wp-project-files-file\")) {\n        var fileName = $target.text();\n\n        self.dataService.getDownloadAttachment(guidAttch, fileName);\n      } else {\n        self.setFilePreview($item, guidAttch, guidFile);\n      }\n\n    } else if ($target.parent().prop(\"id\") === \"project-files-showmore\") {\n      self.renderFilesList();\n    } else if ($target.prop(\"id\") !== \"project-files-upload\") {\n      self.notifyFilesNumber(true);\n    }\n\n  },\n\n  /**\r\n      * Show number files to right sidebar\r\n      * @param mandatory\r\n      */\n  notifyFilesNumber: function notifyFilesNumber(mandatory) {\n    var self = this;\n\n    self.pub(\"notify\", {\n      type: \"SETFILESNUMBER\",\n      args: {\n        filesNumber: self.currentFilesList.length,\n        mandatory: mandatory } });\n\n\n  },\n\n  /**\r\n      * Restricted Event Handler\r\n      */\n  restrictedEventsHandler: function restrictedEventsHandler() {\n    var self = this;\n    self.content.on(\"click\", $.proxy(self.switchFilesEvents, self));\n  },\n\n  /**\r\n     *  Events Handler\r\n     */\n  eventsHandler: function eventsHandler() {\n\n    var self = this;\n    var $content = self.getContent();\n\n    self.sub(\"changeProjectWidget\", $.proxy(self.resetWidget, self));\n    self.sub(\"UPDATEFILE\", $.proxy(self.updateFileData, self));\n    self.sub(\"DELETEFILE\", $.proxy(self.deleteFile, self));\n\n    $content.on(\"click\", $.proxy(self.switchFilesEvents, self));\n  },\n\n  /**\r\n     * Clean\r\n     */\n  clean: function clean() {\n    var self = this;\n    self.resetWidget();\n\n    self.unsub(\"changeProjectWidget\", $.proxy(self.resetWidget, self));\n    self.unsub(\"UPDATEFILE\", $.proxy(self.updateFileData, self));\n    self.unsub(\"DELETEFILE\", $.proxy(self.deleteFile, self));\n\n    for (var i in self.plugins) {\n      if (self.plugins[i])\n      self.plugins[i].destroy();\n    }\n\n    clearInterval(self.fileDateInterval);\n    self._super();\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.files\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.files], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project File Preview\r\n *   Author: David Romero Estrada\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.filesPreview\", {}, {\n  /*\r\n                                                                                                      *   Constructor\r\n                                                                                                      */\n  init: function init(workportalFacade, dataService, notifier, params) {\n    var self = this;\n\n    //Regional\n    self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\n\n    self.dialogBox = {};\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n    self.notifier = notifier;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-filespreview-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.filesPreview\").concat(\"#project-filespreview-wrapper\"),\n      \"project-filespreview-preview\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.filesPreview\").concat(\"#project-filespreview-preview\"),\n      \"project-filespreview-popup\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.filesPreview\").concat(\"#project-filespreview-popup\"),\n      \"project-filespreview-thenumber\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.filesPreview\").concat(\"#project-filespreview-thenumber\") });\n\n  },\n\n  /**\r\n     * Renders the template defined in the widget\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n    var generalTmpl = self.getTemplate(\"project-filespreview-wrapper\");\n\n    self.content = generalTmpl.render();\n\n    self.sub(\"SETFILESNUMBER\", $.proxy(self.setFilesNumber, self));\n\n    return self.content;\n  },\n\n  /**\r\n     * links events with handlers\r\n     */\n  postRender: function postRender() {\n    var self = this;\n\n    self.plugins.fileEdition = self.initPluginPopupEdition();\n\n    self.form = {\n      description: $(\"#ui-bizagi-wp-project-filespreview-popup-description\", self.plugins.fileEdition),\n      image: $(\".ui-bizagi-wp-project-popupform-user-image\", self.plugins.fileEdition),\n      cancel: $(\"#ui-bizagi-wp-project-popupform-action-cancel\", self.plugins.fileEdition),\n      edit: $(\"#ui-bizagi-wp-project-popupform-action-editfile\", self.plugins.fileEdition) };\n\n\n    self.eventsHandler();\n  },\n\n  setFilesNumber: function setFilesNumber(event, params) {\n    var self = this;\n    var parameters = params.args;\n\n    if ($.isEmptyObject(self.currentFile) || parameters.mandatory) {\n      var tmpl = self.getTemplate(\"project-filespreview-thenumber\");\n      var $filesNumber = tmpl.render({ filesNumber: parameters.filesNumber });\n      self.currentFile = {};\n      $(\"#ui-bizagi-wp-project-filespreview-wrapper\", self.content).html($filesNumber);\n    }\n  },\n\n  initPluginPopupEdition: function initPluginPopupEdition() {\n    var self = this;\n    var tmpl = self.getTemplate(\"project-filespreview-popup\");\n\n    self.dialogBox.formContent = tmpl.render();\n\n    return self.dialogBox.formContent;\n  },\n\n  showPreview: function showPreview(event, params) {\n    var self = this;\n    var template = self.getTemplate(\"project-filespreview-preview\");\n    self.currentFile = params.args;\n\n    var content = template.render($.extend(params.args, { idCurrentUser: bizagi.currentUser.idUser }));\n\n    $(\"#ui-bizagi-wp-project-filespreview-wrapper\", self.content).html(content);\n    self.applyMenu();\n  },\n\n  setEditionData: function setEditionData() {\n    var self = this;\n    self.form.description.val(self.currentFile.fileData.description);\n    if (self.currentFile.userData.picture) {\n      self.form.image.prop(\"src\", self.currentFile.userData.picture);\n    }\n  },\n\n  eventsHandler: function eventsHandler() {\n    var self = this;\n    self.form.cancel.on(\"click\", $.proxy(self.onResetFileForm, self));\n    self.form.edit.on(\"click\", $.proxy(self.onSaveEdition, self));\n    self.sub(\"FILEPREVIEW\", $.proxy(self.showPreview, self));\n  },\n\n  onSelectMenu: function onSelectMenu(event, ui) {\n    var self = this;\n    if ($(event.currentTarget).find(\"i\").length === 0) {\n      var item = $(ui.item).data(\"item\");\n      switch (item) {\n        case \"edit\":\n          self.onOpenEdition();\n          break;\n        case \"delete\":\n          self.onDeleteFile();\n          break;\n        case \"download\":\n          self.onDownloadFile();\n          break;}\n\n    }\n  },\n\n  onDownloadFile: function onDownloadFile() {\n    var self = this;\n    self.dataService.getDownloadAttachment(self.currentFile.fileData.attachment.guid, self.currentFile.fileData.name);\n  },\n\n  onOpenEdition: function onOpenEdition() {\n    var self = this;\n\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: \"auto\",\n      width: \"650px\",\n      modal: true,\n      title: bizagi.localization.getResource(\"workportal-project-files-editfile\"),\n      maximize: true,\n      close: function close() {\n        self.onResetFileForm();\n      } });\n\n\n    self.setEditionData();\n    self.form.description.focus();\n  },\n\n  onDeleteFile: function onDeleteFile() {\n    var self = this;\n    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-project-file-querydelete\"), \"\", \"info\")).done(function () {\n      var params = {\n        content: {\n          guid: self.currentFile.fileData.guid },\n\n        attachmentsToDelete: [self.currentFile.fileData.attachment.guid] };\n\n\n      $.when(self.dataService.deleteFile(params)).always(function (response) {\n        if (response.status === 200 || response.status === 201 || response.status === undefined) {\n          self.pub(\"notify\", {\n            type: \"DELETEFILE\",\n            args: {\n              guid: params.content.guid } });\n\n\n        }\n      });\n    });\n  },\n\n  onSaveEdition: function onSaveEdition() {\n    var self = this;\n    if (self.validateAddFileDescriptionForm(self.form.description)) {\n      self.currentFile.fileData.description = self.form.description.val();\n\n      var params = {\n        \"content\": {\n          \"guid\": self.currentFile.fileData.guid,\n          \"description\": self.currentFile.fileData.description,\n          \"attachment\": self.currentFile.fileData.attachment,\n          \"name\": self.currentFile.fileData.name,\n          \"date\": self.currentFile.fileData.date,\n          \"user\": bizagi.currentUser.idUser,\n          \"globalParent\": self.currentFile.radNumber } };\n\n\n\n      $.when(self.dataService.updateProjectFile(params)).always(function (response) {\n        if (response.status === 200 || response.status === 201 || response.status === undefined) {\n          $(\"#ui-bizagi-wp-project-filespreview-description\", self.content).text(params.content.description);\n\n          self.onResetFileForm();\n          self.notifier.showSucessMessage(\n          printf(bizagi.localization.getResource(\"workportal-project-files-editionsuccess\"), \"\"));\n\n          self.pub(\"notify\", {\n            type: \"UPDATEFILE\",\n            args: {\n              description: params.content.description,\n              guid: params.content.guid } });\n\n\n        } else {\n          self.onResetFileForm();\n          self.notifier.showErrorMessage(\n          printf(bizagi.localization.getResource(\"workportal-general-error-generic\"), \"\"));\n        }\n      });\n    }\n  },\n\n  validateAddFileDescriptionForm: function validateAddFileDescriptionForm($description) {\n    var result = false,\n    $textAreadescription = $description;\n    if ($textAreadescription.val().trim() === \"\") {\n      var descriptionValidation = bizagi.localization.getResource(\"workportal-project-discussion-requireddescription\");\n      $textAreadescription.parent().next().find(\"span\").html(descriptionValidation);\n    } else\n    {\n      $textAreadescription.parent().next().find(\"span\").empty();\n      result = true;\n    }\n    return result;\n  },\n\n  onResetFileForm: function onResetFileForm() {\n    var self = this;\n    self.form.description.parent().next().find(\"span\").empty();\n    self.dialogBox.formContent.dialog(\"destroy\");\n    self.dialogBox.formContent.detach();\n  },\n\n  applyMenu: function applyMenu() {\n    var self = this;\n\n    $(\".ui-bizagi-wp-project-filespreview-edit\", self.content).menu({\n      select: $.proxy(self.onSelectMenu, self) }).\n    removeClass(\"ui-widget-content\");\n  },\n\n  clean: function clean() {\n    var self = this;\n\n    self.plugins = {};\n    self.form = {};\n    self.currentFile = {};\n    self.filesNumber = 0;\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.filesPreview\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.filesPreview]);","/*\r\n *   Name: Bizagi Workportal project File Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.file.sidebar\", {}, {\n\n  /*\r\n                                                                                                *   Constructor\r\n                                                                                                */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    params = params || {};\n    params.supportNav = false;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-file-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.file.sidebar\").concat(\"#project-file-sidebar\") });\n\n\n  },\n\n  /*\r\n     *   Returns the widget name\r\n     */\n  getWidgetName: function getWidgetName() {\n    return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_FILE_SIDEBAR;\n  },\n\n  /*\r\n     * Renders the template defined in the widget\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-file-sidebar\");\n    self.content = template.render({});\n\n    return self.content;\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.file.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.file.sidebar], true);"]}