{"version":3,"sources":["jquery/workportal/desktop/widget/project.overview/bizagi.workportal.desktop.widgets.project.overview.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.activity.log.js","jquery/workportal/desktop/widget/project.dashboard.menu/bizagi.workportal.desktop.widgets.project.dashboard.menu.js","jquery/workportal/desktop/widget/project.dashboard.menu.activity/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.timeline/bizagi.workportal.desktop.widgets.project.timeline.js","jquery/workportal/desktop/widget/project.timeline.sidebar/bizagi.workportal.desktop.widgets.project.timeline.sidebar.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.services.project.processMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processDiagram.helper.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.activityMap.tooltip.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.activity.log.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.authentication.log.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","bizagi","workportal","widgets","widget","extend","onDiscussionsMenuStatusChange","ev","params","this","updateDiscussionsIcons","hasDiscussionsOrComment","sub","$","proxy","toggle","clean","unsub","injector","register","project","dashboard","menu","init","workportalFacade","dataService","_super","loadTemplates","project-dashboard-menu","getTemplate","concat","renderContent","content","postRender","self","contextsLeftSidebarCaseDashboard","forEach","context","updateView","event","args","plan","idActivitySelected","undefined","$content","getContent","empty","type","showContextByMenuDashboard","argsTemplate","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","isAdhocProcess","util","isEnableFeature","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","render","appendTo","toUpperCase","addClass","siblings","removeClass","handlerEvents","loadContentById","preventDefault","$item","target","closest","hasClass","data","getLevelNavigator","pub","currentLevelNavigator","parseInt","nameItemNavigator","newLevelNavigator","localization","getResource","refreshLastItemBreadcrumb","histName","level","subMenuHandler","$comments","$files","$timeline","on","options","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","idCase","idTask","idWorkflow","idWorkItem","idWorkitem","referrer","publish","off","activity","project-content-dashboard","template","setTimeout","window","trigger","base","usersByName","userPictures","usersInformation","showCurrentDate","timelineData","auxNoRepeatTypesUser","hashTypesUser","assigned","owner","numberOfResults","project-timeline-markup","project-timeline-empty-process","project-timeline-single-process","project-timeline-activity-assignee","project-timeline-empty-results","showMoreUsersModal","e","when","getItemsAssignees","done","userListAItems","getUsersForUnassignedActivityModal","usersForModal","task","events","find","dataForModal","users","isActivity","activityName","displayName","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","maximize","modalParameters","title","length","width","height","refreshInbox","defer","Deferred","usersMissingInformation","map","u","userFounded","u2","guidUser","id","push","resolve","prepareUsersForModal","getUsersData","join","rawData","usersReady","initials","name","getInitials","user","usersAdapter","createJsonUserInfo","username","picture","email","usersWithoutAnonymized","viewProcesses","viewActivities","currentDate","getDataObj","date","container","renderActivities","textToSearch","val","filterActivities","change","keypress","isIE","keyCode","which","helper","getFormattedDate","getFormattedTime","getPastEvents","getCurrentEvents","canShowActivity","canShowGraphicQuery","canShowStateLog","getRadNumber","radNumber","getTimelineData","templateRender","security","menuSecurity","templateNoResults","append","click","showGlobalForm","showGraphicQuery","loader","startAndThen","then","showLog","eventAsTasks","onlyUserWorkItems","renderAssignees","showEmptyTimelineTemplate","templateContent","getEmptyTimelineContent","adjustElementsForEmptyTimeline","customMessage","originalFirst","originalSecond","extendData","messages","message","first","second","dataTemplate","css","getIdCase","value","isGUID","getCaseByPlan","idPlan","response","contextualized","parent","promise","caseNumber","encodeURIComponent","dialog","get","widgetInstance","close","renderWidget","assignees","each","i","item","assignee","renderAssigneePictures","Object","keys","guidUsers","assigneeTemplate","allUsersInCache","cachedKeys","inArray","Number","getAssigneePicture","joinUsersInformation","status","types","addEventHandlersTooltip","typesToAssignUsers","getCaseSummary","summary","createdBy","userId","typeName","getCaseAssignees","dataAssignedUser","csvUserGuids","getCSVUserGuids","preparedData","prepareData","$target","id_userSelected","attr","isAssignee","toLowerCase","userParam","usertooltip","arrayIdsUsers","itemUser","idUser","unshift","csvguidUsers","usersGuids","fail","mergeTypesToAssignUsers","totalDataAssigned","toString","rawUsersData","dataProcessed","j","prepareDataUser","rawDataUser","dataAssignedUsers","assignUserTypes","tasks","getTasksUser","typesString","filter","total","taskType","parseBoolean","isEvent","taskName","typesUser","totalTypeUser","trim","getTimeLineActivities","timestamp","dateObj","Date","monthNames","getMonth","dateFormatter","formatDate","grep","indexOf","filteredUsers","validValues","result","GraphicQuery","StateLog","regional","currentDay","dayNames","getDay","currentMonth","storage","services","preferences","getPreferences","getDate","getFullYear","longDateFormat","timeline","notifier","project-timeline-sidebar","isAdhoc","showProcessMap","showActivityMap","showProcessDiagram","getNewInstance","sidebar","project-overview","project-overview-no-summary-form-found","contentWidget","canvas","bind","isPropagationStopped","stopPropagation","oldrenderevent","eventMethod","addEventListener","eventer","getWorkitems","workItems","url","serviceLocator","getUrl","tmpl","iframeOldRender","getCaseFormsRenderVersion","formsVersion","formsRenderVersion","renderSummaryForm","proxyPrefix","rendering","facade","execute","summaryForm","subscribe","renderingFacade","resizeLayout","iframe","queryString","readQueryString","is","load","contents","cssLocation","browser","mozilla","webkit","replace","overview","service","getActivityMap","read","getActivitySummary","guidWorkitem","ajax","dataType","getSubProcessMap","instanceBizagiProcessMap","processMap","project-processmap","project-process-diagram","project-activity-map","project-subprocess","viewOptions","configureHandlers","onProcessDiagram","onActivityMap","onSupprocess","navigationManager","renderProcessDiagram","resize","renderActivityMap","renderSubProcessMap","appendActivityMapZoom","appendProcessMapZoom","appendSubprocessZoom","appendSubprocessDragScroll","bindTooltip","tooltipParams","graphicquery","getPVHeight","defaultHeight","canvasPst","$header","project-tooltip","cache","dateFormat","gqData","onProcess","onIdCase","currentTarget","tooltipClass","$container","tooltip","items","callback","diagram","className","baseVal","getActivityMapTooltipContent","getSubprocessTooltipContent","open","ui","remove","show","duration","effect","hide","delay","position","my","hover","stop","fadeTo","fadeOut","$ui","def","isCached","buildContent","appendToCache","endDate","startDate","process","assigneeName","graphicQuery","html","formatInvariantDate","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","log","ATTR_VALUE_INDEX_COLUMN","ActivityLog","EntityLog","UserLog","ATTR_VALUE_MAX_LENGTH","SELECTORS","ATTR_VALUE_VIEW_MORE","DETAIL_WRAPPER","totalPages","maxRows","maxPages","currentPage","activity.log","activity.log.general.content","activity.log.header","activity.log.detail.header","activity.log.detail.content","useNewEngine","generalContentTmpl","generalHeaderContentTmpl","detailHeaderTmpl","detailContentTmpl","logCategories","ACTIVITIES","serviceMethod","detailServiceMethod","selectedDetailId","ENTITIES","USERS","ADMINISTRATION","containtersID","GENERAL","DETAIL","getCaseNumber","initWidget","displayNoResults","setupHeader","headerWrapper","supportedLogTypes","supportedLogTypesData","Supported","available","getFirstAvailableLogTypes","getActivityLogByCategory","bindHeaderElementInteraction","error","att","x","element","categoryObj","selectedCategoryObj","isEmptyObject","idActualPage","pageSize","generalActivityDataValidator","showErrorAlertDialog","showMessageBox","JSON","parse","responseText","rows","currentLogData","renderContentByCategory","generalWrapper","switchContent","pagData","getPaginationData","logCategory","logItems","getIcon","setUpPagination","selectedLogItemIndex","index","preprocessDetailRender","pagination","page","pagesArray","pagesToShow","a","$pager","method","bizagiPagination","maxElemShow","actualPage","listElement","clickCallBack","selectedElement","getDetailRenderParams","currentDetailLogData","renderLogDetail","idWorkItemFrom","idEntity","selectedElementData","detailWrapper","renderDetailContent","logFilterWrapper","showDetailResultMessage","applyDetailFilter","_eventsDeclare","$detailWrapper","getFilterParams","renderedTmpl","_renderDetailContentTmpl","insertAfter","userFullName","attribDisplayName","entDisplayName","$logFilterWrapper","_SELECTORS","Class","_content","_detailWrapper","_showCompleteAttributeValue","_params","detailItems","isAttrValue","_isAttrValue","attrValue2show","_attrValue2show","showMoreButton4AttrValue","_showMoreButton4AttrValue","_html","showSimpleBox","selectedCategoryObjId","_position","console","substr","_deferHeaderTmpl","_deferContentTmpl","detailHeaderResult","detailContentResult","contentToDisplay","icons","icon"],"mappings":"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","sourcesContent":["function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Workportal Desktop Project Overview Controller\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: David Romero Estrada\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.overview\", {}, {\n\n  /*\r\n                                                                                            *   Constructor\r\n                                                                                            */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-overview\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview\"),\n      \"project-overview-no-summary-form-found\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview-no-summary-form-found\") });\n\n  },\n\n  /*\r\n     * Renders the template defined in the widget\r\n     */\n  renderContent: function renderContent() {\n\n    var self = this;\n    var template = self.getTemplate(\"project-overview\");\n\n    self.content = template.render({});\n    return self.content;\n  },\n\n  /*\r\n     * Links events with handlers\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    var contentWidget = self.getContent();\n\n    var canvas = $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget);\n\n    // Define action when render form has not been migrated\n    canvas.bind(\"oldrenderintegration\", function (e) {\n      if (e.isPropagationStopped()) {\n        return;\n      }\n      e.stopPropagation();\n\n      var template = self.workportalFacade.getTemplate(\"inbox-common-case-summary-oldrender\");\n      var data = {};\n\n      bizagi.oldrenderevent = true; // has been loaded\n      var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\n      var eventer = window[eventMethod];\n      var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\n\n      // Listen to message from child window\n      eventer(messageEvent, function (e) {\n        e.stopPropagation();\n        self.publish(\"executeAction\", {\n          action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n          idCase: e.data });\n\n      }, false);\n\n      // Define wirkitem and idtask\n      $.when(self.dataService.getWorkitems({\n        idCase: self.params.idCase,\n        onlyUserWorkItems: true })).\n      done(function (getWorkitems) {\n        // verify workitem, in some cases these variables are not available\n        if (_typeof(getWorkitems.workItems) == \"object\" && getWorkitems.workItems.length >= 1) {\n          // Case Open\n          var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\n          var idTask = getWorkitems.workItems[0]['idTask'];\n          data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\n        } else {\n          // Case closed\n          data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\n        }\n\n        // Render content\n        canvas.empty();\n        $.tmpl(template, data).appendTo(canvas);\n        //Set styles\n        self.iframeOldRender($(\"iframe\", canvas));\n      });\n    });\n\n    var params = {\n      idCase: self.params.idCase };\n\n    $.when(self.dataService.getCaseFormsRenderVersion(params)).\n    done(function (formsVersion) {\n      if (formsVersion.formsRenderVersion == 1) {\n        canvas.trigger(\"oldrenderintegration\");\n      } else {\n        self.renderSummaryForm(self.params.idCase, $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget));\n      }\n    });\n  },\n\n  renderSummaryForm: function renderSummaryForm(idCase, container) {\n    var self = this;\n\n    var proxyPrefix = _typeof(self.dataService.serviceLocator.proxyPrefix) != undefined ? self.dataService.serviceLocator.proxyPrefix : \"\";\n\n    // Load render page\n    var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\n\n    // Executes rendering into render container\n    rendering.execute({\n      canvas: container,\n      summaryForm: true,\n      idCase: idCase });\n\n    rendering.subscribe(\"no-data-found\", function () {\n      var template = self.getTemplate(\"project-overview-no-summary-form-found\");\n      container.append(template.render());\n    });\n\n    // Keep reference to rendering facade\n    self.renderingFacade = rendering;\n\n    // Resize layout\n    setTimeout(function () {\n      self.resizeLayout();\n    }, 1000);\n  },\n\n  /**\r\n      * Inject styles and js into the iframe\r\n      */\n  iframeOldRender: function iframeOldRender(canvas) {\n    var self = this;\n    var iframe;\n    var content = self.getContent();\n    var theme = \"bizagiDefault\";\n    var queryString = bizagi.readQueryString();\n\n    $.each(canvas, function () {\n      if ($(this).is(\"iframe\")) {\n        iframe = $(this);\n      }\n    });\n\n    iframe.load(function () {\n      // inject css\n      var content = $(this).contents();\n\n      // Fixed problem with relative path across the different browsers\n      var cssLocation = $.browser.mozilla || $.browser.webkit ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\n\n      // Define theme\n      cssLocation = cssLocation.replace(\"%theme%\", queryString[\"theme\"] || theme);\n\n      // Append css\n      $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\n\n      // Append javascript\n      //  $('head',content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\n    });\n  } });\n\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.overview', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.overview], true);","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                * Admin module to case massively reassign\r\n                                                                                                                                                                                                                                                                                                                                                                                * \r\n                                                                                                                                                                                                                                                                                                                                                                                * @author David Nino, David Romero, Edward J Morales\r\n                                                                                                                                                                                                                                                                                                                                                                                */\nbizagi.workportal.widgets.activity.log.extend(\"bizagi.workportal.widgets.activity.log\", {\n\n  /**\r\n                                                                                           * index for attribute value column data from backend\r\n                                                                                           */\n  ATTR_VALUE_INDEX_COLUMN: {\n    ActivityLog: 2,\n    EntityLog: 1,\n    UserLog: 2 },\n\n\n  /**\r\n                   * string limit length for attribute value to show in table cell, limited by \"M\" Uppercase letter for 3 maximum text lines\r\n                   */\n  ATTR_VALUE_MAX_LENGTH: 89,\n\n  SELECTORS: {\n\n    /**\r\n                * view more button in attribute value table cell\r\n                */\n    ATTR_VALUE_VIEW_MORE: \".activity-log-attribute-value-container > a\",\n\n    /**\r\n                                                                          * detail wrapper for data in activity log\r\n                                                                          */\n    DETAIL_WRAPPER: \"#activity-log-data-detail-wrapper\" } },\n\n{\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    self.totalPages = 0;\n    self.maxRows = 10;\n    self.maxPages = 10;\n    self.currentPage = 1;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"activity.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log\"),\n      \"activity.log.general.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-general-content\"),\n      \"activity.log.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-header\"),\n      \"activity.log.detail.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-header\"),\n      \"activity.log.detail.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-content\"),\n      useNewEngine: false });\n\n  },\n  postRender: function postRender() {\n    var self = this;\n\n    //Template vars\n    self.generalContentTmpl = self.getTemplate(\"activity.log.general.content\");\n    self.generalHeaderContentTmpl = self.getTemplate(\"activity.log.header\");\n\n    self.detailHeaderTmpl = self.getTemplate(\"activity.log.detail.header\");\n    self.detailContentTmpl = self.getTemplate(\"activity.log.detail.content\");\n\n    //Set the keys for each type of log, the service for the general table, and detail table\n    self.logCategories = {\n      ACTIVITIES: { id: \"ActivityLog\", serviceMethod: \"getActivityLog\", detailServiceMethod: \"getActivityDetailLog\", selectedDetailId: 0 },\n      ENTITIES: { id: \"EntityLog\", serviceMethod: \"getEntityLog\", detailServiceMethod: \"getEntityDetailLog\", selectedDetailId: 0 },\n      USERS: { id: \"UserLog\", serviceMethod: \"getUserLog\", detailServiceMethod: \"getUserDetailLog\", selectedDetailId: 0 },\n      ADMINISTRATION: { id: \"AdminLog\", serviceMethod: \"getAdminLog\" } };\n\n\n    //Sets the containers id\n    self.containtersID = {\n      GENERAL: \"general\",\n      DETAIL: \"detail\" };\n\n\n    //Creates an instance of render Services\n    var proxyPrefix = _typeof(self.dataService.serviceLocator.proxyPrefix) != undefined ? self.dataService.serviceLocator.proxyPrefix : \"\";\n    var renderServices = new bizagi.render.services.service({ \"proxyPrefix\": proxyPrefix });\n\n    //Gets the case number using the caseId\n    renderServices.getCaseNumber({\n      idCase: self.idCase }).\n    done(function (response) {\n      var caseNumber = response.caseNumber;\n      self.caseNumber = caseNumber ? caseNumber : self.idCase;\n\n      self.initWidget();\n    });\n\n  },\n\n  /*\r\n     *   Init the widgets building each separated element\r\n     */\n  initWidget: function initWidget() {\n\n    var self = this;\n\n    //Hides the \"no results\" message container\n    self.displayNoResults(false);\n\n    //set up the header\n    self.setupHeader();\n  },\n\n  /*\r\n     *   Setup the header using the results from the service supported log types\r\n     */\n  setupHeader: function setupHeader() {\n    var self = this;\n    content = self.getContent();\n\n    var headerWrapper = $(\"#activity-log-data-header-wrapper\", content);\n\n    $.when(self.dataService.supportedLogTypes()).done(function (supportedLogTypesData) {\n\n      //update the log types with the supported ones\n      $.tmpl(self.generalHeaderContentTmpl, { supportedLogTypes: supportedLogTypesData.Supported }).appendTo(headerWrapper);\n\n      //Find the first supported log type\n      var available = self.getFirstAvailableLogTypes(supportedLogTypesData.Supported);\n\n      //Reset  current page\n      self.currentPage = 1;\n\n      //Sends the object with the available log type\n      self.getActivityLogByCategory(self.logCategories[available]);\n\n      //Add the click events from the elements in the header\n      self.bindHeaderElementInteraction($(\"#LnkActivities\", self.content), self.logCategories.ACTIVITIES);\n      self.bindHeaderElementInteraction($(\"#LnkEntities\", self.content), self.logCategories.ENTITIES);\n      self.bindHeaderElementInteraction($(\"#LnkUsers\", self.content), self.logCategories.USERS);\n      self.bindHeaderElementInteraction($(\"#LnkAdmin\", self.content), self.logCategories.ADMINISTRATION);\n    }).fail(function (error) {});\n  },\n\n  /*\r\n     * Uses the supported log types data, finds the first element wich is available\r\n     */\n  getFirstAvailableLogTypes: function getFirstAvailableLogTypes(supportedLogTypesData) {\n    var self = this;\n    for (var att in self.logCategories) {\n      for (var x in supportedLogTypesData) {\n        if (self.logCategories[att].id == x && (supportedLogTypesData[x] == \"true\" || supportedLogTypesData[x] == true)) {\n          return att;\n        }\n      }\n    }\n\n    return \"\";\n  },\n\n  /*\r\n     *   Bind the element interaction with the category which it belongs\r\n     *   @param element (Object) DOM element which is going to be added the click event\r\n     *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n     */\n  bindHeaderElementInteraction: function bindHeaderElementInteraction(element, categoryObj) {\n    var self = this;\n\n    element.click(function () {\n      if (!$(this).hasClass('active')) {\n\n        $(\".active\", self.content).removeClass('active');\n\n        $(this).addClass('active');\n\n        self.currentPage = 1;\n        self.getActivityLogByCategory(categoryObj);\n      }\n    });\n  },\n\n  /*\r\n     *   Using the categoryOjb, get the service method and call the service to retrieve the log\r\n     *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n     */\n  getActivityLogByCategory: function getActivityLogByCategory(categoryObj) {\n    var self = this;\n\n    var params = {};\n\n    self.selectedCategoryObj = $.isEmptyObject(categoryObj) ? self.selectedCategoryObj : $.extend({}, categoryObj);\n\n    params = { idCase: self.idCase, idActualPage: self.currentPage, pageSize: self.maxRows };\n\n    var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\n    generalWrapper.addClass(\"ui-bizagi-component-loading\");\n\n    $.when(self.dataService[self.selectedCategoryObj.serviceMethod](params)).done(function (result) {\n      self.totalPages = result.total;\n      self.generalActivityDataValidator(result);\n    }).fail(function (error) {\n      bizagi.showErrorAlertDialog = false;\n      bizagi.showMessageBox(JSON.parse(error.responseText).message, \"Bizagi\", \"Error\");\n    });\n  },\n\n  /*\r\n     *   Validate the info gathered from the log service, and pre-render to show it in the required way\r\n     *   @param data (Object) Result from the log service\r\n     */\n  generalActivityDataValidator: function generalActivityDataValidator(data) {\n    var self = this,\n    content = self.getContent();\n\n    var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\n\n    if (data.rows) {\n      //Stores the current data\n      self.currentLogData = [].concat(data.rows);\n    } else {\n      self.currentLogData = [];\n    }\n\n    self.renderContentByCategory();\n  },\n\n  /*\r\n     *   Render the content from the selected log category\r\n     */\n  renderContentByCategory: function renderContentByCategory() {\n    var self = this,\n    content = self.getContent();\n\n    var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\n\n    var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\n\n\n    //Removes the loading class\n    generalWrapper.removeClass(\"ui-bizagi-component-loading\");\n\n    //Clean the content\n    generalWrapper.empty();\n\n    self.switchContent(self.containtersID.GENERAL);\n\n    //Get data for pagination\n    var pagData = self.getPaginationData();\n\n    // Render Form\n    $.tmpl(self.generalContentTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, logItems: self.currentLogData, pagData: pagData, getIcon: self.getIcon }).appendTo(generalWrapper);\n\n    self.setUpPagination($(\"#biz-wp-activitylog-category-pager ul\", self.content), \"getActivityLogByCategory\");\n\n    //Show/hide the no-result message\n    if (self.currentLogData.length > 0) {\n      self.displayNoResults(false);\n      $(\".activity-log-table\", generalWrapper).show();\n    } else\n    {\n      self.displayNoResults(true);\n      $(\".activity-log-table\", generalWrapper).hide();\n    }\n\n    //Add Interactions\n    $(\".detail-item\", generalWrapper).click(function (e) {\n      e.preventDefault();\n\n      //Stores the Log  Item Index\n      self.selectedLogItemIndex = $($(e.currentTarget).closest(\"tr\")[0]).index() - 1;\n\n      //reset current page\n      self.currentPage = 1;\n\n      self.preprocessDetailRender($(this));\n    });\n\n    $(\".listHeaderLinks\", generalWrapper).click(function (e) {\n      e.preventDefault();\n    });\n  },\n\n  /*\r\n     * Get Pagination Data\r\n     */\n  getPaginationData: function getPaginationData() {\n\n    var self = this;\n    var pagination = self.totalPages > 1 ? true : false;\n\n    var pagData = {\n      page: self.currentPage,\n      pagesArray: [],\n      pagination: pagination };\n\n\n    var pagesToShow = self.maxPages > self.totalPages ? self.totalPages : self.maxPages;\n\n    for (var a = 0; a < pagesToShow; a++) {\n      pagData.pagesArray.push(a + 1);\n    }\n\n    return pagData;\n  },\n\n  /*\r\n     * SetUp Pagination\r\n     */\n  setUpPagination: function setUpPagination($pager, method) {\n\n    var self = this;\n\n    $pager.bizagiPagination({\n      maxElemShow: self.maxRows,\n      totalPages: self.totalPages,\n      actualPage: self.currentPage,\n      listElement: $pager,\n      clickCallBack: function clickCallBack(options) {\n        self.currentPage = parseInt(options.page);\n        self[method]({}, $pager);\n      } });\n\n  },\n\n  /*\r\n     *   Render the content from the selected log item\r\n     */\n  preprocessDetailRender: function preprocessDetailRender(selectedElement) {\n\n    var self = this,\n    content = self.getContent();\n\n    var params = self.getDetailRenderParams(selectedElement);\n\n    //Checks if the selected category have the detail service, and invokes it\n    if (self.selectedCategoryObj.detailServiceMethod) {\n      $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\n\n        self.totalPages = result.total;\n\n        self.switchContent(self.containtersID.DETAIL);\n\n        //Current Log Data\n        if (result.rows) {\n          self.currentDetailLogData = [].concat(result.rows);\n        } else\n        {\n          self.currentDetailLogData = [];\n        }\n\n        self.renderLogDetail(result);\n\n      }).fail(function (error) {});\n    }\n  },\n\n  /*\r\n     * Get Detail Render Params\r\n     */\n  getDetailRenderParams: function getDetailRenderParams(selectedElement) {\n\n    var self = this;\n    var params, selectedDetailId;\n\n    switch (self.selectedCategoryObj.id) {\n      case self.logCategories.ACTIVITIES.id:\n\n        if ($.isEmptyObject(selectedElement)) {\n          selectedDetailId = self.logCategories.ACTIVITIES.selectedDetailId;\n        } else {\n          self.logCategories.ACTIVITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\n        }\n\n        params = { idCase: self.idCase, idWorkItemFrom: selectedDetailId };\n\n        break;\n\n      case self.logCategories.ENTITIES.id:\n\n        if ($.isEmptyObject(selectedElement)) {\n          selectedDetailId = self.logCategories.ENTITIES.selectedDetailId;\n        } else {\n          self.logCategories.ENTITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\n        }\n\n        params = { idCase: self.idCase, idEntity: selectedDetailId };\n\n        break;\n\n      case self.logCategories.USERS.id:\n\n        if ($.isEmptyObject(selectedElement)) {\n          selectedDetailId = self.logCategories.USERS.selectedDetailId;\n        } else {\n          self.logCategories.USERS.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\n        }\n\n        params = { idCase: self.idCase, idUser: selectedDetailId };\n\n        break;}\n\n\n    $.extend(params, { idActualPage: self.currentPage, pageSize: self.maxRows });\n\n    return params;\n  },\n\n  /*\r\n     *   Render the detail from the selected log item\r\n     */\n  renderLogDetail: function renderLogDetail(selectedElementData) {\n    var self = this,\n    content = self.getContent();\n\n    //Template Vars\n    var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\n\n    //empty previous content\n    detailWrapper.empty();\n\n    //removes the loading class\n    detailWrapper.removeClass(\"ui-bizagi-component-loading\");\n\n    //render the detail content, including headers and table\n    $.when(self.renderDetailContent()).done(function () {\n      var logFilterWrapper = $(\"#log-filter-wrapper\", content);\n\n      //Show/hide the no-result message\n      self.showDetailResultMessage();\n\n      //Add the interaction handlers\n      $(\"#back-general-content\", detailWrapper).click(function (e) {\n        e.preventDefault();\n        self.displayNoResults(false);\n        self.switchContent(self.containtersID.GENERAL);\n      });\n\n      $(\"#apply-filter\", logFilterWrapper).click(function (e) {\n        e.preventDefault();\n\n        self.currentPage = 1;\n        self.applyDetailFilter();\n      });\n\n      $(\"#remove-filter\", logFilterWrapper).click(function (e) {\n        e.preventDefault();\n\n        //Clean the filter inputs\n        $(\"input\", logFilterWrapper).val(\"\");\n\n        self.currentPage = 1;\n        self.applyDetailFilter();\n      });\n\n      $(\".listHeaderLinks\", detailWrapper).click(function (e) {\n        e.preventDefault();\n      });\n\n      self._eventsDeclare();\n    });\n  },\n\n  /*\r\n     * Show detail result message \r\n     */\n  showDetailResultMessage: function showDetailResultMessage() {\n\n    var self = this;\n    var $detailWrapper = $(\"#activity-log-data-detail-wrapper\", self.getContent());\n\n    if (self.currentDetailLogData.length > 0) {\n      self.displayNoResults(false);\n      $(\".activity-log-table\", $detailWrapper).show();\n    } else\n    {\n      self.displayNoResults(true);\n      $(\".activity-log-table\", $detailWrapper).hide();\n    }\n  },\n\n  /*\r\n     * Apply detail filter\r\n     */\n  applyDetailFilter: function applyDetailFilter() {\n\n    var self = this;\n    var params = self.getFilterParams(),content = self.getContent();\n\n    //Checks if the selected category have the detail service, and invokes it\n    if (self.selectedCategoryObj.detailServiceMethod) {\n      $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\n\n        self.totalPages = result.total;\n\n        //Current Log Data\n        if (result.rows) {\n          self.currentDetailLogData = [].concat(result.rows);\n        } else {\n          self.currentDetailLogData = [];\n        }\n\n        //Get data for pagination\n        var pagData = self.getPaginationData(),\n        renderedTmpl = self._renderDetailContentTmpl(pagData);\n\n        //Remove table\n        $(\"#bz-workportal-activitylog-detailcontent-wrapper\", content).remove();\n        $(renderedTmpl).insertAfter(\"#activity-log-data-detail-header-wrapper\", content);\n\n        //Show/hide the no-result message\n        self.showDetailResultMessage();\n\n        //Set up pagination\n        self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", content), \"applyDetailFilter\");\n        self._eventsDeclare();\n      });\n    }\n\n  },\n\n  /*\r\n     * Get params for the filter\r\n     */\n  getFilterParams: function getFilterParams() {\n\n    var self = this,\n    content = self.getContent(),\n    $logFilterWrapper = $(\"#log-filter-wrapper\", content),\n    params = self.getDetailRenderParams(),\n    userFullName,attribDisplayName,entDisplayName;\n\n    if (self.selectedCategoryObj.id == self.logCategories.ENTITIES.id) {\n      userFullName = $(\"#filterUser\", $logFilterWrapper).val().toLowerCase();\n    } else if (self.selectedCategoryObj.id == self.logCategories.USERS.id) {\n      entDisplayName = $(\"#filterEntity\", $logFilterWrapper).val().toLowerCase();\n    }\n\n    attribDisplayName = $(\"#filterAttribute\", $logFilterWrapper).val().toLowerCase();\n\n    $.extend(params, { userFullName: userFullName, attribDisplayName: attribDisplayName, entDisplayName: entDisplayName });\n\n    return params;\n  },\n\n  /**\r\n      * declare events for activity log results\r\n      */\n  _eventsDeclare: function _eventsDeclare() {\n    var self = this,\n    _SELECTORS = self.Class.SELECTORS,\n    _content = self.getContent(),\n    _detailWrapper = $(_SELECTORS.DETAIL_WRAPPER, _content);\n\n    $(_SELECTORS.ATTR_VALUE_VIEW_MORE, _detailWrapper).click(self._showCompleteAttributeValue);\n  },\n\n  /**\r\n      * render the Detail content\r\n      * @param {JSON} pagData \r\n      */\n  _renderDetailContentTmpl: function _renderDetailContentTmpl(pagData) {\n    var self = this,\n    _params = {\n      logCategory: self.selectedCategoryObj.id,\n      title: self.selectedCategoryObj.title,\n      detailItems: self.currentDetailLogData,\n      pagData: pagData,\n      isAttrValue: self._isAttrValue.bind(self, self.selectedCategoryObj.id),\n      attrValue2show: self._attrValue2show.bind(self),\n      showMoreButton4AttrValue: self._showMoreButton4AttrValue.bind(self) };\n\n\n    return $.tmpl(self.detailContentTmpl, _params);\n  },\n\n  /**\r\n      * shows a modal with the complete attribute value\r\n      * @param {Event} e \r\n      */\n  _showCompleteAttributeValue: function _showCompleteAttributeValue(e) {\n    var _html = $(this).find(\"span\").html();\n    e.preventDefault();\n    bizagi.showSimpleBox(_html, bizagi.localization.getResource(\"workportal-widget-activity-log-table-details-title-attrvalue\"));\n  },\n\n  /**\r\n      * if is the 3th column is attribute value\r\n      * @param {ATTR_VALUE_INDEX_COLUMN} selectedCategoryObjId selected category\r\n      * @param {Int} i col index\r\n      */\n  _isAttrValue: function _isAttrValue(selectedCategoryObjId, i) {\n    var self = this,\n    _position = self.Class.ATTR_VALUE_INDEX_COLUMN[selectedCategoryObjId];\n    if (_position === undefined)\n    console.error(\"_isAttrValue: the selectedCategoryObjId \" + selectedCategoryObjId + \" does not exist\");\n    return i == _position;\n  },\n\n  /**\r\n      * split string for max length in column\r\n      * @param {String} value attribute value to show\r\n      */\n  _attrValue2show: function _attrValue2show(value) {\n    var self = this;\n    return value.substr(0, self.Class.ATTR_VALUE_MAX_LENGTH);\n  },\n\n  /**\r\n      * validate if the view more button is necessary\r\n      * @param {String} value attribute value to show\r\n      */\n  _showMoreButton4AttrValue: function _showMoreButton4AttrValue(value) {\n    var self = this;\n    return value.length > self.Class.ATTR_VALUE_MAX_LENGTH;\n  },\n\n  /*\r\n     *   Renders the detail info from the selected log item\r\n     *   return (Object) returns the promise after processing and attaching to the DOM the detail from the selected log item\r\n     */\n  renderDetailContent: function renderDetailContent() {\n    var self = this,\n    content = self.getContent(),\n    def = $.Deferred();\n\n    //DOM Vars\n    var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\n\n    //Get data for pagination\n    var pagData = self.getPaginationData(),\n    _deferHeaderTmpl = $.tmpl(self.detailHeaderTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, data: self.currentLogData[self.selectedLogItemIndex] }),\n    _deferContentTmpl = self._renderDetailContentTmpl(pagData);\n\n    //append tree to wrapper\n    $.when(_deferHeaderTmpl, _deferContentTmpl).done(function (detailHeaderResult, detailContentResult) {\n\n      detailWrapper.append(detailHeaderResult);\n      detailContentResult.insertAfter(\"#activity-log-data-detail-header-wrapper\", detailWrapper);\n\n      //set up pagination\n      self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", self.content), \"preprocessDetailRender\");\n\n      def.resolve();\n    });\n\n    return def.promise();\n  },\n\n  /*\r\n     *   Switch the view from general view, and detail\r\n     *   @param (string) contentToDisplay : Specifies wich element want to display, the DETAIL view or GENERAL\r\n     */\n  switchContent: function switchContent(contentToDisplay) {\n    var self = this,\n    content = self.getContent();\n\n    var generalWrapper = $(\"#activity-log-data-general-wrapper\", content),\n    detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\n\n\n    if (self.containtersID.DETAIL == contentToDisplay) {\n      generalWrapper.hide();\n\n      detailWrapper.show();\n    } else {\n      generalWrapper.show();\n\n      detailWrapper.hide();\n    }\n  },\n\n  /*\r\n     * Display the \"no result\" message\r\n     */\n  displayNoResults: function displayNoResults(value) {\n    var self = this,\n    content = self.getContent();\n\n    if (value)\n    $(\"#activity-log-no-results\", content).show();else\n\n    $(\"#activity-log-no-results\", content).hide();\n  },\n\n  /**\r\n      * Return icon to show \r\n      * @param {*} id \r\n      */\n  getIcon: function getIcon(id) {\n    var icons = {\n      allocation: \"bzg-case-allocation\",\n      info: \"bzg-case-allocation-info\",\n      cancelled: \"bzg-case-canceled\" };\n\n    var icon = '';\n    switch (id) {\n      case 1:\n      case 6:\n      case 7:\n      case 1002:\n        icon = icons.allocation;\n        break;\n      case 3:\n      case 4:\n        icon = icons.info;\n        break;\n      case 1001:\n        icon = icons.cancelled;\n        break;}\n\n    return icon;\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.activity.log', ['workportalFacade', 'dataService', bizagi.workportal.widgets.activity.log], true);","/**\r\n * Name: BizAgi Desktop Widget Dashboard menu (left sidebar) * \r\n * @author Valeria Vanegas\r\n */\n\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu\", {}, {\n\n  /**\r\n                                                                                                   * Handler when discussions menu status change\r\n                                                                                                   * @param {*} ev \r\n                                                                                                   * @param {*} params \r\n                                                                                                   */\n  onDiscussionsMenuStatusChange: function onDiscussionsMenuStatusChange(ev, params) {\n    var self = this;\n    self.updateDiscussionsIcons(params.hasDiscussionsOrComment);\n  },\n\n  /**\r\n      * Update discussions icon on sidebar menu\r\n      * The icon is different when there is other discussion or there are comments\r\n      * @param {*} hasDiscussionsOrComment \r\n      */\n  updateDiscussionsIcons: function updateDiscussionsIcons(hasDiscussionsOrComment) {\n    var self = this;\n\n    self.sub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n\n    $(\".bz-icon-discussion-comment\").toggle(hasDiscussionsOrComment);\n    $(\".bz-icon-discussion-no-comment\").toggle(!hasDiscussionsOrComment);\n    self.params.hasDiscussionsOrComment = hasDiscussionsOrComment;\n  },\n\n  /**\r\n      * Detach events\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.unsub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu], true);","/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.dashboard.menu.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", {}, {\n\n  /**\r\n                                                                                                                            *   Constructor\r\n                                                                                                                            */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    self.params = params || {};\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity\").concat(\"#project-dashboard-menu1\") });\n\n  },\n\n  /**\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /**\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self._super();\n    //Handlers\n    self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n      self.sub(context, $.proxy(self.updateView, self));\n    });\n  },\n\n  /**\r\n      * Update view\r\n      * @param event\r\n      * @param params\r\n      */\n  updateView: function updateView(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    self.params.plan.idActivitySelected = undefined;\n    self.clean();\n    var $content = self.getContent().empty();\n\n    if (typeof event.type !== \"undefined\") {\n      self.params.showContextByMenuDashboard = event.type;\n    }\n\n    var argsTemplate = {\n      showFormOverview: self.params.menuDashboard.showFormOverview,\n      showFormActivity: self.params.menuDashboard.showFormActivity,\n      showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\n      showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\n      showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu && (\n      !self.params.isAdhocProcess ||\n      self.params.isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\")),\n      showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\n      contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\n      contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu };\n\n\n    //Update widget\n    var template = self.getTemplate(\"project-dashboard-menu\");\n    template.render(argsTemplate).appendTo($content);\n\n\n    if (self.params.showContextByMenuDashboard) {\n      $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n    }\n\n    self.updateDiscussionsIcons(self.params.hasDiscussionsOrComment);\n    self.handlerEvents();\n  },\n\n  /**\r\n      *   Load Content By Id\r\n      */\n  loadContentById: function loadContentById(event) {\n    var self = this;\n    event.preventDefault();\n    var $item = $(event.target).closest(\"li\");\n\n    if (!$item.hasClass(\"active\")) {\n\n      var showContextByMenuDashboard = $item.data(\"context\");\n\n      if (showContextByMenuDashboard) {\n        var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\n        var currentLevelNavigator = parseInt(getLevelNavigator[0], 10);\n        var nameItemNavigator = \"\";\n        var newLevelNavigator = currentLevelNavigator;\n\n        if (showContextByMenuDashboard == \"PLANACTIVITIES\") {\n          newLevelNavigator = currentLevelNavigator + 1;\n          nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\n        }\n\n        self.params.refreshLastItemBreadcrumb = false;\n        self.pub(\"notify\", {\n          type: showContextByMenuDashboard.toUpperCase(),\n          args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\n            histName: nameItemNavigator,\n            level: newLevelNavigator }) });\n\n        $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n      }\n    }\n  },\n\n  subMenuHandler: function subMenuHandler() {\n    var self = this;\n    var content = self.getContent();\n    var $comments = $(\"[data-context='COMMENTS']\", content);\n    var $files = $(\"[data-context='FILES']\", content);\n    var $timeline = $(\"[data-context='TIMELINE']\", content);\n\n    $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\n      $comments.toggle();\n      $files.toggle();\n      $timeline.toggle();\n    });\n  },\n\n  /**\r\n      * Handler events\r\n      */\n  handlerEvents: function handlerEvents() {\n    var self = this;\n    var content = self.getContent();\n\n    self.subMenuHandler();\n\n    $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\n\n    // Bind for click event on refresh botton\n    $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).on(\"click\", function () {\n      var options = {\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n        idCase: self.params.idCase,\n        idTask: self.params.idTask,\n        idWorkflow: self.params.idWorkflow,\n        idWorkItem: self.params.idWorkitem,\n        referrer: self.params.referrer || \"inboxGrid\" };\n\n      self.publish(\"executeAction\", options);\n    });\n  },\n\n  /**\r\n      * Clean widgets and events\r\n      */\n  clean: function clean() {\n    var self = this;\n    var content = self.getContent();\n\n    self._super();\n\n    if (self.params && self.params.contextsLeftSidebarCaseDashboard) {\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n        self.unsub(context, $.proxy(self.updateView, self));\n      });\n    }\n\n    $(\".ui-bizagi-wp-project-tab-links a\", content).off();\n    $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).off();\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\n\n  /*\r\n                                                                                                      *   Constructor\r\n                                                                                                      */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\") });\n\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-content-dashboard\");\n    self.content = template.render({});\n\n    return self.content;\n  },\n  postRender: function postRender() {\n    var self = this;\n\n    setTimeout(function () {\n      $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\n    }, 1000);\n\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Timeline Controller\r\n *   Author: Diego Parra\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.timeline\", {}, {\n  /*\r\n                                                                                                   *   Constructor\r\n                                                                                                   */\n  init: function init(workportalFacade, dataService, params) {\n\n    var self = this;\n\n    if (params.data) {\n      $.extend(params, params.data);\n    }\n\n    //Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Create hashtables to hold user names and pictures\n    self.usersByName = {};\n    self.userPictures = {};\n    self.usersInformation = [];\n\n    //Show Current Date flag\n    self.showCurrentDate = params.showCurrentDate || false;\n\n    // Create a slot to hold timeline data and avoid going to server after filtering\n    self.timelineData = null;\n\n    self.auxNoRepeatTypesUser = {};\n    self.hashTypesUser = {\n      \"assigned\": bizagi.localization.getResource(\"workportal-project-user-assigned\"),\n      \"owner\": bizagi.localization.getResource(\"workportal-project-user-owner\") };\n\n\n    self.numberOfResults = 0;\n    //Load templates\n    self.loadTemplates({\n      \"project-timeline-markup\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-markup\"),\n      \"project-timeline-empty-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-empty-process\"),\n      \"project-timeline-single-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-single-process\"),\n      \"project-timeline-activity-assignee\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-activity-assignee\"),\n      \"project-timeline-empty-results\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-empty-results\") });\n\n\n  },\n\n  /**\r\n      * show the usersModal for this activity}\r\n      * @param {widget.project.timeline} self is the this reference of the class, in this method this is and eventElement\r\n      * @param {Event} e event element\r\n      */\n  showMoreUsersModal: function showMoreUsersModal(self, e) {\n    var idWorkitem = $(e.target).closest(\".bz-project-timeline-content\").data(\"workitem\");\n    $.when(self.dataService.getItemsAssignees(idWorkitem)).done(function (userListAItems) {\n      self.getUsersForUnassignedActivityModal(self, userListAItems).done(function (usersForModal) {\n        var task = self.timelineData.events.find(function (ev) {\n          return ev.idWorkitem == idWorkitem;\n        });\n        var dataForModal = {\n          users: usersForModal,\n          isActivity: task.type === \"activity\",\n          activityName: task.displayName };\n\n        self.publish(\"showDialogWidget\", {\n          widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\n          closeVisible: true,\n          data: dataForModal,\n          maximize: true,\n          modalParameters: {\n            title: bizagi.localization.getResource(\"workportal-widget-timeline-show-more-users-modal-title\") + \" (\" + usersForModal.length + \")\",\n            width: 790,\n            height: 526,\n            refreshInbox: false } });\n\n\n      });\n    });\n  },\n\n  /**\r\n      * get the users from usersInformation for the modal but if needs more get it from userPictures endpoint\r\n      * @param {widget.project.timeline} self \r\n      * @param {Array} userListAItems id users for the modal\r\n      */\n  getUsersForUnassignedActivityModal: function getUsersForUnassignedActivityModal(self, userListAItems) {\n    var defer = $.Deferred();\n    var usersForModal = [];\n    var usersMissingInformation = [];\n    userListAItems.map(function (u) {\n      var userFounded = self.usersInformation.find(function (u2) {\n        return u.guidUser == u2.id;\n      });\n      if (userFounded === undefined) {\n        usersMissingInformation.push(u.guidUser);\n      } else {\n        usersForModal.push(userFounded);\n      }\n    });\n    if (usersMissingInformation.length == 0) {// has all users information needed\n      defer.resolve(self.prepareUsersForModal(usersForModal));\n    } else {//look for missing user information\n      $.when(self.getUsersData(usersMissingInformation.join(\",\"))).done(function (rawData) {\n        defer.resolve(self.prepareUsersForModal(usersForModal.concat(rawData)));\n      });\n    }\n\n    return defer;\n  },\n\n  /**\r\n      * apply the userAdapter standard for the userModal\r\n      * @param {Array} usersForModal users for the modal but missing userAdapter standars\r\n      */\n  prepareUsersForModal: function prepareUsersForModal(usersForModal) {\n    var usersReady = [];\n    usersForModal.map(function (u) {\n      var initials = u.initials == undefined ? u.name.getInitials() : u.initials;\n      var user = usersAdapter.createJsonUserInfo(u.id, u.name, u.username, u.picture, u.email, initials, null, null, [], []);\n      usersReady.push(user);\n    });\n    return usersAdapter.usersWithoutAnonymized(usersReady);\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate(\"project-timeline-markup\");\n\n    // Define initial filters\n    self.viewProcesses = false;\n    self.viewActivities = true;\n\n    //\n    self.currentDate = self.getDataObj().date;\n\n    var content = self.content = template.render({ viewProcesses: self.viewProcesses, viewActivities: self.viewActivities, showCurrentDate: self.showCurrentDate, date: self.currentDate });\n    var container = $(\"#bz-project-timeline-activities\", self.content);\n\n    // Draw activities\n    self.renderActivities(container);\n\n    // Search option handlers\n    $(\".bz-project-timeline-search .bz-icon-search\", content).on(\"click\", function () {\n      var textToSearch = $(\".bz-project-timeline-search input\", content).val();\n      self.filterActivities(container, textToSearch);\n    });\n\n    $(\".bz-project-timeline-search input\", content).change(function () {\n      var textToSearch = $(\".bz-project-timeline-search input\", content).val();\n      self.filterActivities(container, textToSearch);\n    }).keypress(function (e) {\n      // keypress event ensures enter key to action the below implementation on IE browser.\n      if (bizagi.util.isIE() && (e.keyCode || e.which) == 13) {\n        var textToSearch = $(\".bz-project-timeline-search input\", content).val();\n        self.filterActivities(container, textToSearch);\n      }\n    });\n\n    return self.content;\n  },\n\n  renderActivities: function renderActivities(container) {\n    var self = this;\n    var content = self.getContent();\n    container.empty();\n\n    // Define helper functions\n    var helper = {\n      getFormattedDate: self.getFormattedDate,\n      getFormattedTime: self.getFormattedTime,\n      getPastEvents: self.getPastEvents,\n      getCurrentEvents: self.getCurrentEvents,\n      canShowActivity: $.proxy(self, 'canShowActivity'),\n      canShowGraphicQuery: $.proxy(self, 'canShowGraphicQuery'),\n      canShowStateLog: $.proxy(self, 'canShowStateLog') };\n\n\n    // Draw timeline\n    $.when(self.getRadNumber(self.radNumber)).done(function (radNumber) {\n      $.when(self.getTimelineData(radNumber)).\n      done(function (data) {\n\n        if (data.events.length > 0) {\n\n          self.numberOfResults = 0;\n          var template = self.getTemplate(\"project-timeline-single-process\");\n          var templateRender = template.render($.extend(data, { security: bizagi.menuSecurity }), helper); //Template with results\n\n          if (self.numberOfResults === 0) {//If there is no results it is shown a message telling that (the variable numberOfResults is incremented in the canShowActivity method)\n            var templateNoResults = self.getTemplate(\"project-timeline-empty-results\");\n            container.append(templateNoResults.render($.extend(data, { security: bizagi.menuSecurity }), helper));\n          } else {//In the other case, the activities in the timeline are shown\n            container.append(templateRender);\n          }\n\n          // Add handlers\n          $(\".bz-more-users-link\", content).click(function (e) {\n            self.showMoreUsersModal(self, e);\n          });\n\n          $(\".bz-project-timeline-type-activity .bz-project-timeline-content h2, .bz-project-timeline-type-event .bz-project-timeline-content h2\", container).on(\"click\", function () {\n            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\n            self.showGlobalForm(idCase);\n          });\n\n          $(\".bz-project-timeline-content .bz-show-diagrams\", container).on(\"click\", function () {\n            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\n            var idWorkflow = $(this).closest(\".bz-project-timeline-content\").data(\"workflow\");\n            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\n          });\n\n          $(\".bz-project-timeline-content .bz-show-log\", container).on(\"click\", function () {\n            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\n            bizagi.loader.startAndThen(\"activity\").then(function () {\n              self.showLog(idCase);\n            });\n          });\n\n          $(\".bz-project-timeline-content .bz-show-case\", container).on(\"click\", function (event) {\n            //event.preventDefault();\n            // Call routing action\n            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\n            var idWorkItem = $(this).closest(\".bz-project-timeline-content\").data(\"workitem\");\n            var idWorkflow = $(this).closest(\".bz-project-timeline-content\").data(\"workflow\");\n\n            self.publish(\"closeAllDialogs\");\n            self.publish(\"executeAction\", {\n              action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n              idCase: idCase,\n              idWorkItem: idWorkItem,\n              idTask: \"\",\n              idWorkflow: idWorkflow,\n              eventAsTasks: true,\n              onlyUserWorkItems: \"true\" });\n\n          });\n\n          // Add animation\n          $(\"#bz-project-timeline-content\", content).addClass(\"bz-project-timeline-content-bounce\");\n\n          // Render assignees\n          self.renderAssignees(container);\n\n        } else {\n          self.showEmptyTimelineTemplate(container, data, helper, content, bizagi.menuSecurity);\n        }\n      });\n    });\n  },\n\n  /**\r\n      * show timeline empty template\r\n      * @param {Jquery Element} container for template to create\r\n      * @param {JSON} data response from timeline endpoint\r\n      * @param {JSON functions} helper for template methods\r\n      * @param {Jquery Element} content \r\n      * @param {JSON} menuSecurity for template\r\n      */\n  showEmptyTimelineTemplate: function showEmptyTimelineTemplate(container, data, helper, content, menuSecurity) {\n    var self = this,\n    templateContent = self.getEmptyTimelineContent(data, helper, menuSecurity);\n    container.append(templateContent);\n    self.adjustElementsForEmptyTimeline(content);\n  },\n\n  /**\r\n      * return timeline template empty and the message depends of data.message value\r\n      * @param {JSON} data response from timeline endpoint\r\n      * @param {JSON functions} helper for template methods\r\n      * @param {JSON} menuSecurity for template\r\n      */\n  getEmptyTimelineContent: function getEmptyTimelineContent(data, helper, menuSecurity) {\n    var self = this,\n    template = self.getTemplate(\"project-timeline-empty-process\"),\n    getMessages = function getMessages(customMessage) {\n      var originalFirst = bizagi.localization.getResource(\"workportal-general-first-line-not-find-a-historical-record\"),\n      originalSecond = bizagi.localization.getResource(\"workportal-general-second-line-not-find-a-historical-record\"),\n      first = customMessage ? customMessage : originalFirst,\n      second = customMessage ? \"\" : originalSecond;\n      return {\n        first: first,\n        second: second };\n\n    },\n    extendData = {\n      security: menuSecurity,\n      messages: getMessages(data.message) },\n\n    dataTemplate = $.extend(data, extendData);\n    return template.render(dataTemplate, helper);\n  },\n\n  /**\r\n      * adjust the HTML Elements for empty timeline\r\n      * @param {Jquery Element} content \r\n      */\n  adjustElementsForEmptyTimeline: function adjustElementsForEmptyTimeline(content) {\n    $(\".bz-project-timeline-search\", content).css(\"display\", \"none\");\n    $(\"#bz-project-timeline-content\", content).css(\"visibility\", \"visible\");\n  },\n\n  /**\r\n      * Get idCase by if case is contextualized or not\r\n      * @param value\r\n      * @returns {*}\r\n      */\n  getIdCase: function getIdCase(value) {\n    var self = this,\n    defer = $.Deferred();\n    if (bizagi.util.isGUID(value)) {\n      $.when(self.dataService.getCaseByPlan({ idPlan: value })).done(function (response) {\n        defer.resolve(response.id);\n      });\n    } else\n    {\n      if (self.params.idCase === undefined && self.params.plan.contextualized === true) {\n        self.params.idCase = self.params.plan.parent.idCase;\n      }\n      defer.resolve(self.params.idCase);\n    }\n    return defer.promise();\n  },\n\n  /**\r\n      * Get Rad Number. Validate if is contextualized activity\r\n      * @param value\r\n      * @returns {*}\r\n      */\n  getRadNumber: function getRadNumber(value) {\n    var self = this,\n    defer = $.Deferred();\n\n    if (typeof value === \"undefined\") {\n      value = self.params.plan.id;\n    }\n\n    if (bizagi.util.isGUID(value)) {\n      value = self.params.plan.id;\n      $.when(self.dataService.getCaseByPlan({ idPlan: value })).done(function (response) {\n        defer.resolve(\"idCase=\" + response.id);\n      });\n    } else\n    if (self.params.caseNumber === \"\") {// Case Creation phase, without Case Number\n      defer.resolve(\"idCase=\" + encodeURIComponent(value));\n    } else {\n      defer.resolve(\"radNumber=\" + encodeURIComponent(value));\n    }\n    return defer.promise();\n  },\n\n  showGlobalForm: function showGlobalForm(idCase) {\n    var dialog = bizagi.injector.get(\"dialogWidgets\");\n    var data = {\n      closeVisible: true,\n      modalParameters: {\n        title: bizagi.localization.getResource(\"workportal-project-casedashboard-overview\"),\n        refreshInbox: false },\n\n      idCase: idCase };\n\n    data.widgetInstance = bizagi.injector.get(\"bizagi.workportal.widgets.project.overview\", data);\n    data.widgetInstance.sub(\"closeDialog\", function (ev, data) {\n      dialog.close();\n      defer.resolve(data);\n    });\n\n    dialog.renderWidget(data);\n  },\n\n  showLog: function showLog(idCase) {\n    var dialog = bizagi.injector.get(\"dialogWidgets\");\n    var data = {\n      closeVisible: true,\n      modalParameters: {\n        title: bizagi.localization.getResource(\"workportal-project-casedashboard-history\"),\n        refreshInbox: false },\n\n      idCase: idCase };\n\n    data.widgetInstance = bizagi.injector.get(\"bizagi.workportal.widgets.activity.log\", data);\n    data.widgetInstance.sub(\"closeDialog\", function (ev, data) {\n      dialog.close();\n      defer.resolve(data);\n    });\n\n    dialog.renderWidget(data);\n  },\n\n  renderAssignees: function renderAssignees(container) {\n    var self = this;\n    var assignees = {};\n    $.each($(\".bz-assignee\", container), function (i, item) {\n      var assignee = $(item).data(\"guidassignee\");\n      assignees[assignee] = assignee;\n    });\n\n    // Render assignee pictures\n    self.renderAssigneePictures(Object.keys(assignees), container);\n  },\n\n  renderAssigneePictures: function renderAssigneePictures(users, container, guidUsers) {\n    var self = this;\n    var assigneeTemplate = self.getTemplate(\"project-timeline-activity-assignee\");\n    var helper = {\n      getInitials: function getInitials(name) {return name.getInitials();} };\n\n    if (guidUsers == undefined) {\n      guidUsers = users;\n    }\n\n    // Check in hash first\n    var allUsersInCache = true;\n    var cachedKeys = $.map(self.userPictures, function (user) {return user.id;});\n    $.each(users, function (i, user) {if ($.inArray(Number(user), cachedKeys) === -1) allUsersInCache = false;});\n\n    // Go for cache if everything is there\n    if (allUsersInCache) {\n      $.each(users, function (i, user) {\n        $(\".bz-assignee[data-guidassignee=\" + user + \"]\", container).append(assigneeTemplate.render(self.userPictures[user], helper));\n      });\n      return;\n    }\n\n    // Draw assignee pictures\n    $.when(self.dataService.getAssigneePicture(guidUsers)).\n    done(function (data) {\n      self.joinUsersInformation(data);\n      $.each(data, function (i, item) {\n        var assigned = false;\n        self.timelineData.events.map(function (event) {\n          assigned |= event.status == \"open\" && event.assignee == item.id;\n        });\n        if (assigned) {\n          item.types = item.types || [];\n          item.types.push(\"assigned\");\n        }\n        $(\".bz-assignee[data-guidassignee=\" + item.id + \"]\", container).append(assigneeTemplate.render(item, helper));\n        self.usersByName[item.name] = item.id;\n        self.userPictures[item.id] = item;\n      });\n      self.addEventHandlersTooltip(data, container);\n    });\n  },\n\n  /**\r\n      * join the users information into self.usersInformation, used for show all usertooltips\r\n      * @param {JSON} users \r\n      */\n  joinUsersInformation: function joinUsersInformation(users) {\n    var self = this;\n    if (self.usersInformation == undefined) self.usersInformation = [];\n    users.map(function (u) {\n      var userFounded = false;\n      self.usersInformation.map(function (u2) {\n        if (u2.id == u.id) {\n          userFounded = true;\n          u2 = $.extend(u2, u);\n        }\n      });\n      if (userFounded == false) {\n        //if don't know if the user is owner or assignee\n        if (u.types == undefined) {\n          u.types = [];\n        }\n        if (u.initials == undefined) {\n          u.initials = u.name.getInitials();\n        }\n        self.usersInformation.push(u);\n      }\n    });\n  },\n\n  //Add event handler for tooltip\n  addEventHandlersTooltip: function addEventHandlersTooltip(data, container) {\n    var self = this;\n    var typesToAssignUsers = [];\n\n\n    $.when(self.getIdCase(self.radNumber)).done(function (idCase) {\n      self.dataService.getCaseSummary({ idCase: idCase }).done(function (summary) {\n        typesToAssignUsers = [{\n          id: summary.createdBy.userId,\n          typeName: \"owner\" }];\n\n\n        self.dataService.getCaseAssignees({ idCase: idCase }).done(function (dataAssignedUser) {\n          var csvUserGuids = self.getCSVUserGuids(dataAssignedUser.assignees, typesToAssignUsers);\n          $.when(self.getUsersData(csvUserGuids)).done(function (rawData) {\n            var preparedData = self.prepareData(rawData, typesToAssignUsers, dataAssignedUser);\n            self.joinUsersInformation(preparedData);\n          });\n        });\n      });\n    });\n\n    $(\".bz-project-timeline-content > .bz-assignee\", self.content).on('mouseenter', '', function (ev) {\n      var $target = $(ev.target);\n      var id_userSelected = $target.closest('.bz-assignee').attr('data-assignee');\n      var user = self.usersInformation.find(function (user) {\n        return user.id == id_userSelected;\n      });\n      if (user && user.id == id_userSelected) {\n        if (user.types === undefined || user.types.length === 0) {\n          user.owner = false;\n          user.isAssignee = false;\n        } else\n        user.types.forEach(function (type) {\n          if (type == \"owner\") {\n            user.owner = true;\n          }\n          user.isAssignee = type.toLowerCase() == \"assigned\";\n        });\n        var userParam = usersAdapter.createJsonUserInfo(user.id, user.name, user.username, user.picture ? \"data:image/png;base64,\" + user.picture : undefined, user.email, user.initials, user.isAssignee, user.owner, [], []);\n        $target.parent().usertooltip(self, { target: $target, user: userParam });\n      }\n    });\n  },\n\n\n  /**\r\n      *\r\n      * @param assignees\r\n      * @param typesToAssignUsers\r\n      * @returns {*}\r\n      */\n  getCSVUserGuids: function getCSVUserGuids(assignees, typesToAssignUsers) {\n    var arrayIdsUsers = $.map(assignees, function (itemUser) {\n      return itemUser.idUser;\n    });\n    arrayIdsUsers.unshift(typesToAssignUsers[0].id);\n    return arrayIdsUsers.join(\",\");\n  },\n\n  /**\r\n     * Get data users with service\r\n     */\n  getUsersData: function getUsersData(csvguidUsers) {\n    var self = this;\n    var defer = $.Deferred();\n    var params = {\n      usersGuids: csvguidUsers,\n      width: 50,\n      height: 50 };\n\n\n    self.dataService.getUsersData(params).done(function (response) {\n      defer.resolve(response);\n    }).fail(function () {\n      defer.resolve([]);\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n     *\r\n     * @param typesToAssignUsers\r\n     * @param dataAssignedUser\r\n     */\n  mergeTypesToAssignUsers: function mergeTypesToAssignUsers(typesToAssignUsers, dataAssignedUser) {\n    var self = this;\n    for (var i = 0, totalDataAssigned = dataAssignedUser.assignees.length; i < totalDataAssigned; i++) {\n      //Using the hash, validate no repeat elements on typesToAssignUsers\n      var temp = self.auxNoRepeatTypesUser[dataAssignedUser.assignees[i].idUser.toString() + \"assigned\"];\n      if (typeof temp === \"undefined\") {\n        self.auxNoRepeatTypesUser[dataAssignedUser.assignees[i].idUser.toString() + \"assigned\"] = \"\";\n        typesToAssignUsers.push({\n          id: dataAssignedUser.assignees[i].idUser || -1,\n          typeName: \"assigned\" });\n\n      }\n    }\n  },\n\n  prepareData: function prepareData(rawUsersData, typesToAssignUsers, dataAssignedUser) {\n    var self = this;\n    var dataProcessed = [];\n    if (rawUsersData) {\n      self.mergeTypesToAssignUsers(typesToAssignUsers, dataAssignedUser);\n      for (var i = 0, j = rawUsersData.length; i < j; i++) {\n        var user = self.prepareDataUser(rawUsersData[i], typesToAssignUsers, dataAssignedUser);\n        dataProcessed.push(user);\n      }\n    }\n    return dataProcessed;\n  },\n\n  /**\r\n     * Prepare data by user\r\n     */\n  prepareDataUser: function prepareDataUser(rawDataUser, typesToAssignUsers, dataAssignedUsers) {\n    var self = this;\n    var id = rawDataUser.id;\n    var user = {\n      id: id,\n      name: rawDataUser.name,\n      username: rawDataUser.username,\n      email: rawDataUser.email,\n      initials: rawDataUser.name.getInitials(),\n      picture: rawDataUser.picture ? \"data:image/png;base64,\" + rawDataUser.picture : undefined,\n      types: self.assignUserTypes(id.toString(), typesToAssignUsers),\n      tasks: self.getTasksUser(dataAssignedUsers, id.toString()) };\n\n\n    user.typesString = $.map(user.types, function (type) {\n      return self.hashTypesUser[type];\n    }).join(\",\");\n\n    return user;\n  },\n\n  /**\r\n     *\r\n     * @param dataAssignedUsers\r\n     * @param idUser\r\n     * @returns {Array}\r\n     */\n  getTasksUser: function getTasksUser(dataAssignedUsers, idUser) {\n    var tasks = [];\n    var dataAssignedUser = dataAssignedUsers.assignees.filter(function (user) {\n      return user.idUser.toString() === idUser;\n    });\n\n    for (var i = 0, total = dataAssignedUser.length; i < total; i += 1) {\n      tasks.push({\n        taskType: bizagi.util.parseBoolean(dataAssignedUser[i].isEvent) ? bizagi.localization.getResource(\"workportal-project-user-event\") : bizagi.localization.getResource(\"workportal-project-user-task\"),\n        taskName: dataAssignedUser[i].taskName });\n\n    }\n    return tasks;\n  },\n\n  /**\r\n      *\r\n      * @param userId\r\n      * @param typesToAssignUsers\r\n      * @returns {Array}\r\n      */\n  assignUserTypes: function assignUserTypes(userId, typesToAssignUsers) {\n    var typesUser = [];\n\n    for (var i = 0, totalTypeUser = typesToAssignUsers.length; i < totalTypeUser; i += 1) {\n      if (userId === typesToAssignUsers[i].id.toString()) {\n        typesUser.push(typesToAssignUsers[i].typeName);\n      }\n    }\n\n    return typesUser;\n  },\n\n  filterActivities: function filterActivities(container, textToSearch) {\n    var self = this;\n    self.filter = textToSearch.trim().toLowerCase();\n\n    // Draw activities again\n    self.renderActivities(container);\n  },\n\n  getTimelineData: function getTimelineData(radNumber) {\n    var self = this;\n    if (self.timelineData) {\n      return $.Deferred().resolve(self.timelineData);\n    }\n\n    return $.when(self.dataService.getTimeLineActivities(radNumber)).\n    done(function (data) {\n      self.timelineData = data;\n    });\n  },\n\n  /* HELPER FUNCTIONS */\n  getFormattedDate: function getFormattedDate(timestamp) {\n    var dateObj = new Date(timestamp);\n    var monthsNames = bizagi.localization.getResource(\"datePickerRegional\").monthNames;\n    var shortMonth = dateObj.getMonth();\n    return monthsNames[shortMonth] + \" \" + bizagi.util.dateFormatter.formatDate(dateObj, \"d yyyy\");\n  },\n  getFormattedTime: function getFormattedTime(timestamp) {\n    var date = new Date(timestamp);\n    return bizagi.util.dateFormatter.formatDate(date, \"HH:mm\");\n  },\n\n  getPastEvents: function getPastEvents(events) {\n    return $.grep(events, function (event) {return event.date != null;});\n  },\n\n  getCurrentEvents: function getCurrentEvents(events) {\n    return $.grep(events, function (event) {return event.date == null;});\n  },\n\n  canShowActivity: function canShowActivity(activity) {\n    /**\r\n                                                        * When this method returns true (it means the activity will be shown or not according to the filter applied) \r\n                                                        * the variable numberOfResult increments to get the total number of results (activities) that will be shown, \r\n                                                        * in order to show a message when there is no results\r\n                                                        * (this method is executed for each activity of the timeline)\r\n                                                        */\n    //\n    var self = this;\n    if (!self.filter) {\n      self.numberOfResults = self.numberOfResults + 1;\n      return true;}\n    if (self.filter === \"\") {\n      self.numberOfResults = self.numberOfResults + 1;\n      return true;}\n    if (activity.displayName.toLowerCase().indexOf(self.filter) > -1) {\n      self.numberOfResults = self.numberOfResults + 1;\n      return true;\n    }\n\n    // Filter by user name\n    var filteredUsers = $.grep(Object.keys(self.usersByName), function (user) {return user.toLowerCase().indexOf(self.filter) > -1;});\n    var validValues = $.map(filteredUsers, function (user) {return self.usersByName[user];});\n    if ($.inArray(activity.assignee, validValues) > -1) {\n      self.numberOfResults = self.numberOfResults + 1;\n      return true;\n    }\n    return false;\n  },\n\n  canShowGraphicQuery: function canShowGraphicQuery() {\n    var result = false;\n    if (bizagi.menuSecurity.GraphicQuery) {\n      result = true;\n    }\n    return result;\n  },\n\n  canShowStateLog: function canShowStateLog() {\n    var result = false;\n    if (bizagi.menuSecurity.StateLog) {\n      result = true;\n    }\n    return result;\n  },\n  getDataObj: function getDataObj() {\n    var self = this,\n    regional = self.getResource(\"datePickerRegional\"),\n    currentDate = new Date(),\n    currentDay = regional.dayNames[currentDate.getDay()],\n    currentMonth = regional.monthNames[currentDate.getMonth()],\n    date,\n    storage = bizagi.services.preferences().getPreferences() || {};\n\n    date = currentDay + \", \" + currentMonth + \" \" + currentDate.getDate() + \", \" + currentDate.getFullYear();\n    if (storage.longDateFormat)\n    date = bizagi.util.dateFormatter.formatDate(currentDate, storage.longDateFormat);\n\n    return {\n      \"date\": date };\n\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.timeline\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.timeline], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Timeline Controller\r\n *   Author: Diego Parra\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.timeline.sidebar\", {}, {\n  /*\r\n                                                                                                           *   Constructor\r\n                                                                                                           */\n  init: function init(workportalFacade, dataService, notifier, params) {\n\n    var self = this;\n\n    //Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-timeline-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline.sidebar\").concat(\"#project-timeline-sidebar\") });\n\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    var isAdhoc = false;\n    if (!self.params.isAdhocProcess || typeof self.params.isAdhocProcess === 'undefined') {\n      isAdhoc = false;\n    } else\n    {\n      isAdhoc = this.params.isAdhocProcess;\n    }\n    var template = self.getTemplate(\"project-timeline-sidebar\");\n\n    var content = self.content = template.render({ isAdhocProcess: isAdhoc });\n\n    // Add handlers\n    $(\".bz-timeline-show-process-map\", content).on(\"click\", function () {\n      self.showProcessMap();\n    });\n    $(\".bz-timeline-show-activity-map\", content).on(\"click\", function () {\n      self.showActivityMap();\n    });\n\n    return self.content;\n  },\n\n  showProcessMap: function showProcessMap() {\n    var self = this;\n    var dialog = bizagi.injector.get(\"dialogWidgets\");\n    var data = {\n      closeVisible: true,\n      modalParameters: {\n        title: bizagi.localization.getResource(\"workportal-project-casedashboard-timeline-diagram-popup-title\"),\n        refreshInbox: false },\n\n      idWorkflow: self.params.idWorkflow,\n      idCase: self.params.idCase,\n      plan: self.params.plan,\n      radNumber: self.params.caseNumber,\n      showProcessDiagram: false,\n      showActivityMap: false,\n      showProcessMap: true };\n\n    data.widgetInstance = bizagi.injector.getNewInstance(\"bizagi.workportal.widgets.project.processMap\", data);\n    data.widgetInstance.sub(\"closeDialog\", function (ev, params) {\n      dialog.close();\n      defer.resolve(params);\n    });\n\n    dialog.renderWidget(data);\n\n    self.publish(\"addDialogToDialogStack\", dialog);\n  },\n\n  showActivityMap: function showActivityMap() {\n    var self = this;\n    var dialog = bizagi.injector.get(\"dialogWidgets\");\n    var data = {\n      closeVisible: true,\n      modalParameters: {\n        title: bizagi.localization.getResource(\"workportal-project-casedashboard-timeline-diagram-popup-title\"),\n        refreshInbox: false },\n\n      idWorkflow: self.params.idWorkflow,\n      idCase: self.params.idCase,\n      plan: self.params.plan,\n      showProcessDiagram: false,\n      showActivityMap: true,\n      showProcessMap: false };\n\n    data.widgetInstance = bizagi.injector.getNewInstance(\"bizagi.workportal.widgets.project.processMap\", data);\n    data.widgetInstance.sub(\"closeDialog\", function (ev, params) {\n      dialog.close();\n      defer.resolve(params);\n    });\n\n    dialog.renderWidget(data);\n\n    self.publish(\"addDialogToDialogStack\", dialog);\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.timeline.sidebar\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.timeline.sidebar], true);","/**\r\n * Extend service for Process Map\r\n */\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\n  getActivityMap: function getActivityMap(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"activity-map\");\n    var data = {};\n    params.radNumber ? data.radNumber = params.radNumber : \"\";\n    return $.read({\n      url: url,\n      data: data });\n\n  },\n  /*\r\n      * Get activity information\r\n      * */\n  getActivitySummary: function getActivitySummary(params) {\n    var self = this;\n    // Define data\n    var data = {};\n    data[\"guidWorkitem\"] = params.guidWorkitem;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"activity-map-getActivitySummary\"),\n      data: data,\n      type: \"GET\",\n      dataType: \"json\" });\n\n  },\n\n  getSubProcessMap: function getSubProcessMap(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"subprocess-map\");\n    var data = {};\n    params = params || {};\n    params.radNumber ? data.radNumber = params.radNumber : \"\";\n\n    return $.read({\n      url: url,\n      data: data });\n\n  } });","/**\r\n * This module manage all graphical diagrams of process map\r\n *\r\n * @author Edward J Morales\r\n */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.processMap\", {}, {\n\n  /**\r\n                                                                                               * Constructor\r\n                                                                                               * @param workportalFacade instance of facade, mandatory\r\n                                                                                               * @param dataService instance of service tier, mandatory\r\n                                                                                               * @param params extra params, its not mandatory\r\n                                                                                               */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call parent instance\n    self._super(workportalFacade, dataService, params);\n    self.instanceBizagiProcessMap = new bizagi.processMap(this);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-processmap\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-wrapper\"),\n      \"project-process-diagram\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-process-diagram\"),\n      \"project-activity-map\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-activity-map\"),\n      \"project-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-subprocess\") });\n\n  },\n\n  /**\r\n      * Render a content of the module\r\n      * @return {string} html\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.instanceBizagiProcessMap.renderContent();\n    self.content = template.render(self.viewOptions);\n    return self.content;\n  },\n\n  /**\r\n      * Set binding and set data\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.instanceBizagiProcessMap.postRender();\n  },\n\n  /**\r\n     *  Binds events to handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    self.instanceBizagiProcessMap.configureHandlers();\n  },\n\n  /**\r\n      * Process diagram handler\r\n      */\n  onProcessDiagram: function onProcessDiagram() {\n    var self = this;\n    self.instanceBizagiProcessMap.onProcessDiagram();\n  },\n\n  /**\r\n      * Activity map handler\r\n      */\n  onActivityMap: function onActivityMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.onActivityMap();\n  },\n\n  /**\r\n      * Subprocess handler\r\n      */\n  onSupprocess: function onSupprocess() {\n    var self = this;\n    self.instanceBizagiProcessMap.onSupprocess();\n  },\n\n  /**\r\n      * Manage navigation between the 3 diagrams\r\n      * @param template\r\n      * @param params\r\n      */\n  navigationManager: function navigationManager(template) {\n    var self = this;\n    var response = self.instanceBizagiProcessMap.navigationManager(template);\n    response.container.append(response.template.render(response.viewOptions));\n  },\n\n  /**\r\n      * Render the process diagram in the process diagram container\r\n      */\n  renderProcessDiagram: function renderProcessDiagram() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderProcessDiagram();\n  },\n\n  resize: function resize() {\n    var self = this;\n    self.instanceBizagiProcessMap.resize();\n  },\n  /**\r\n      * Set plugin activity map, draw sequence map\r\n      */\n  renderActivityMap: function renderActivityMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderActivityMap();\n  },\n\n  renderSubProcessMap: function renderSubProcessMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderSubProcessMap();\n  },\n\n  /**\r\n      * Append the activity map zoom\r\n      */\n  appendActivityMapZoom: function appendActivityMapZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendActivityMapZoom();\n  },\n\n  /**\r\n      * Append the process map zoom\r\n      */\n  appendProcessMapZoom: function appendProcessMapZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendProcessMapZoom();\n  },\n\n  /**\r\n      * Append the subprocess zoom\r\n      */\n  appendSubprocessZoom: function appendSubprocessZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendSubprocessZoom();\n  },\n  /**\r\n      * Append the subprocess drag and scroll\r\n      */\n  appendSubprocessDragScroll: function appendSubprocessDragScroll() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendSubprocessDragScroll();\n\n  },\n\n  /**\r\n      * binds the tooltip to each activity in activity map\r\n      */\n  bindTooltip: function bindTooltip(tooltipParams) {\n    var self = this;\n    self.instanceBizagiProcessMap.bindTooltip(tooltipParams);\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.processMap', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.processMap]);","/**\r\n * This module manage graphical diagram of process diagram\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\nbizagi.workportal.widgets.graphicquery.extend(\"bizagi.workportal.widgets.project.processDiagram.helper\", {}, {\n  /**\r\n                                                                                                                * Set Height for process viewer\r\n                                                                                                                * @Overriden\r\n                                                                                                                */\n  getPVHeight: function getPVHeight() {\n    var self = this;\n    var defaultHeight = $(window).height() - 50;\n    var canvasPst = self.$header.height() + 180;\n    var cntHeight = $(\".ui-bizagi-wp-project-tab-content\").height();\n    var cntHeight = cntHeight || defaultHeight;\n    return cntHeight - canvasPst;\n  } });","/**\r\n * This module manage the tooltip to show information in activity map and subprocess diagrams\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityMap.tooltip\", {}, {\n\n  /**\r\n                                                                                                        * Constructor\r\n                                                                                                        * @param workportalFacade instance of facade, mandatory\r\n                                                                                                        * @param dataService instance of service tier, mandatory\r\n                                                                                                        * @param params extra params, its not mandatory\r\n                                                                                                        */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    // Call parent instance\n    self._super(workportalFacade, dataService, params);\n    //Load templates\n    self.loadTemplates({\n      \"project-tooltip\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.activityMap.tooltip\").concat(\"#project-processmap-tooltip\") });\n\n\n    self.cache = {};\n    self.radNumber = params.radNumber;\n  },\n  /**\r\n      * Render a content of the module\r\n      * @return {string} html\r\n      */\n  renderContent: function renderContent() {},\n  /**\r\n                                               * Set binding and set data\r\n                                               */\n  postRender: function postRender() {\n    var self = this;\n    self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\n  },\n  /**\r\n      *  Binds events to handlers\r\n      */\n  configureHandlers: function configureHandlers(content, gqData) {\n    var self = this;\n    content.find('.ui-bizagi-wp-project-processmap-process').on('click', $.proxy(self.onProcess, self, gqData));\n    content.find('.ui-bizagi-wp-project-processmap-tooltip-title').on('click', $.proxy(self.onIdCase, self, gqData));\n  },\n  /**\r\n      * Process handler\r\n      * @param ev\r\n      */\n  onProcess: function onProcess(gqData, ev) {\n    var self = this;\n    self.showGraphicQuery(gqData);\n  },\n  /**\r\n      * Id case handler\r\n      * @param ev\r\n      */\n  onIdCase: function onIdCase(gqData, ev) {\n    var self = this;\n    var idCase = $(ev.currentTarget).data(\"idcase\");\n    var idWorkitem = $(ev.currentTarget).data(\"idworkitem\");\n    var idTask = $(ev.currentTarget).data(\"idtask\");\n    var idWorkflow = $(ev.currentTarget).data(\"idworkflow\");\n\n    self.publish(\"executeAction\", {\n      action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n      idCase: idCase,\n      idWorkItem: idWorkitem,\n      idTask: idTask,\n      idWorkflow: idWorkflow });\n\n  },\n  /**\r\n      * Binds the tooltip to activities\r\n      * @param params\r\n      */\n  bindTooltip: function bindTooltip(tooltipParams) {\n    var self = this;\n    self.tooltipClass = tooltipParams.tooltipClass;\n    tooltipParams.$container.tooltip({\n      items: tooltipParams.items,\n      content: function content(callback) {\n        var isContanerClicked = tooltipParams.$container.data(\"clicked\") || false;\n        if (isContanerClicked) {\n          return;\n        }\n        var diagram = tooltipParams.diagram;\n        if (diagram == \"activityMap\") {\n          if (!$(this).is(\"circle\")) {\n            return;\n          } else if (this.className.baseVal.indexOf('activity-map-activity-highlight') < 0) {\n            return;\n          }\n          $.when(self.getActivityMapTooltipContent($(this))).done(function (content) {\n            callback(content);\n          });\n        } else {\n          var content = self.getSubprocessTooltipContent($(this));\n          callback(content);\n        }\n        return \"loading..\";\n      },\n      open: function open(event, ui) {\n        for (var i = 0; i < $(\".ui-tooltip\").length - 1; i++) {\n          $('#' + $(\".ui-tooltip\")[i].id).remove();\n        }\n\n      },\n      show: { duration: 60, effect: 'none' },\n      tooltipClass: self.tooltipClass,\n      hide: { delay: 60, duration: 60 },\n      position: { my: \"left+20 top+20\" },\n      close: function close(event, ui) {\n        ui.tooltip.hover(\n        function () {\n          $(this).stop(true).fadeTo(120, 1);\n        },\n        function () {\n          $(this).fadeOut(20, function () {\n            $(this).remove();\n          });\n        });\n\n      } });\n\n  },\n\n  /**\r\n      * Returns the activity map tooltip content\r\n      * @param $ui\r\n      * @returns {*}\r\n      */\n  getActivityMapTooltipContent: function getActivityMapTooltipContent($ui) {\n    var self = this,def = new $.Deferred(),\n    guidWorkitem = $ui.data(\"guidWorkitem\"),\n    idCase = $ui.data(\"idCase\"),\n    idWorkflow = $ui.data(\"idWorkflow\"),\n    params = {\n      guidWorkitem: guidWorkitem,\n      gqData: { idCase: idCase, idWorkflow: idWorkflow } };\n\n    self.guidWorkitem = guidWorkitem;\n\n    if (self.isCached(params.guidWorkitem)) {\n      var data = self.cache[params.guidWorkitem];\n      def.resolve(self.buildContent(data, params.gqData));\n    } else {\n      $.when(self.dataService.getActivitySummary(params)).done(function (data) {\n        def.resolve(self.buildContent(data, params.gqData));\n        self.appendToCache(params.guidWorkitem, data);\n      });\n    }\n    return def.promise();\n  },\n  /**\r\n      * Returns the subprocess tooltip content\r\n      * @param $ui\r\n      * @returns {*}\r\n      */\n  getSubprocessTooltipContent: function getSubprocessTooltipContent($ui) {\n    var self = this,\n    idCase = $ui.data(\"idcase\"),\n    idWorkflow = $ui.data(\"idworkflow\"),\n    params = {\n      gqData: { idCase: idCase, idWorkflow: idWorkflow } };\n\n\n    var data = {\n      \"endDate\": $ui.data(\"enddate\"),\n      \"startDate\": $ui.data(\"startdate\"),\n      \"process\": $ui.data(\"process\"),\n      \"idCase\": $ui.data(\"idcase\") };\n\n    return self.buildContent(data, params.gqData);\n  },\n  /**\r\n      * Fill the cache object with data for respective guidWorkitem\r\n      * @param guidWorkitem\r\n      * @param data\r\n      */\n  appendToCache: function appendToCache(guidWorkitem, data) {\n    var self = this;\n    self.cache[guidWorkitem] = data;\n  },\n  /**\r\n      * Returns true if the guidWorkitem is cached, false otherwise\r\n      * @param guidWorkitem\r\n      * @returns {boolean}\r\n      */\n  isCached: function isCached(guidWorkitem) {\n    var self = this;\n    return typeof self.cache[guidWorkitem] !== \"undefined\";\n  },\n  /**\r\n      * Build the tooltip content\r\n      * @param data\r\n      * @param gqData\r\n      * @returns {*|jQuery|HTMLElement}\r\n      */\n  buildContent: function buildContent(data, gqData) {\n    var self = this,\n    content = $(\"<div></div>\"),\n    tmpl = self.getTemplate(\"project-tooltip\"),\n    assignee = typeof data.assigneeName !== \"undefined\";\n\n    data.assignee = assignee;\n    data.radNumber = self.radNumber;\n    data.idWorkflow = gqData.idWorkflow;\n    data.idTask = data.idTask || 0;\n    data.idWorkitem = data.idWorkItem || 0;\n    data.graphicQuery = bizagi.menuSecurity.GraphicQuery;\n    content = tmpl.render(data);\n    $(\".\" + self.tooltipClass).html(content);\n    bizagi.util.formatInvariantDate(content, self.dateFormat);\n    self.configureHandlers(content, gqData);\n    return content;\n  } });","/**\r\n * Activiy log for  activities, entities, and users\r\n * \r\n * @author David Andrés Niño\r\n */\n\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\n  /*\r\n                                                                                        *   Returns the widget name\r\n                                                                                        */\n  getWidgetName: function getWidgetName() {\n    return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG;\n  },\n  /*\r\n     *   Renders the content for the current controller\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate(\"activity.log\");\n\n    self.idCase = self.params.idCase;\n    self.idWorkflow = self.params.idWorkflow;\n\n    var content = self.content = $.tmpl(template, { idCase: self.idCase });\n\n    return content;\n  } });","/**\r\n * Authentication log for users\r\n * \r\n * @author Christian Collazos\r\n */\n\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\n  /*\r\n                                                                                              *   Returns the widget name\r\n                                                                                              */\n  getWidgetName: function getWidgetName() {\n    return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG;\n  },\n  /*\r\n     *   Renders the content for the current controller\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate(\"authentication.log\");\n    var content;\n\n    content = self.content = $.tmpl(template, {});\n\n    return content;\n  } });"]}