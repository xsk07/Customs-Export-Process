{"version":3,"sources":["jquery/workportal/desktop/widget/decontextualized.plans.manager/bizagi.workportal.desktop.widgets.plans.manager.js","jquery/workportal/desktop/widget/decontextualized.plans.topmenu/bizagi.workportal.desktop.widgets.plans.topmenu.js","jquery/workportal/desktop/widget/decontextualized.plans.manager/jquery.knob.js","jquery/workportal/desktop/widget/decontextualized.plans.filters/bizagi.workportal.desktop.widgets.plans.filters.js","jquery/workportal/desktop/widget/project.plan.activities.sidebar/bizagi.workportal.desktop.widgets.project.plan.activities.sidebar.js","jquery/workportal/desktop/widget/project.plan.create/bizagi.workportal.desktop.project.plan.create.js","jquery/workportal/desktop/widget/project.plan.edit/bizagi.workportal.desktop.project.plan.edit.js","jquery/workportal/desktop/widget/project.plan.template.create/bizagi.workportal.desktop.project.plan.template.create.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.reassigncase.js"],"names":["bizagi","workportal","widgets","widget","extend","usersMap","init","workportalFacade","dataService","actionService","notifier","planTemplateCreate","planPopupEdit","serviceOrderActivitiesByTransitions","params","this","_super","plans","editDialogBox","allIdUsers","allGuidUsers","globalHandlersService","injector","get","usersFromIdPlan","Array","loadTemplates","plans.manager.wrapper","getTemplate","concat","plans.manager.empty","plans.manager.users","plans.manager.activities.tooltip","plans.manager.context.menu.content","renderContent","content","$","postRender","self","getCalculatedDateServer","sub","proxy","updateView","showSucessMessage","printf","localization","getResource","showErrorMessage","args","histName","planState","level","pub","type","configureHandlers","$content","getContent","on","onClickPlan","event","stopPropagation","planId","target","closest","data","activities","forEach","activity","runningActivity","goToWorkOnIt","idCase","idWorkItem","ev","idPlan","plan","name","id","showPlanDashBoard","servicesPD","services","behaviors","projectDashboard","showContextByMenuDashboard","menuPlanDashboard","showCommentsOptionMenu","getMenuDashboardSecurity","menuSecurity","isVisibleButtonComments","showFilesOptionMenu","isVisibleButtonFiles","showTimeLineOptionMenu","isVisibleButtonTimeLine","length","substring","contextualized","flowContext","when","getFirstParentInfo","done","response","radNumber","hasDiscussionsOrComment","deletePlan","showConfirmationBox","always","status","executePlan","activitiesLength","putExecutePlan","updateParams","currentState","startDate","getDateServer","updatePlan","closePlan","fail","openPopupEditTemplate","planSelected","selectedPlan","showPopup","openPopupSaveTemplate","showPopupAddTemplatePlan","empty","template","getData","arrayPlans","processData","totalAssignees","assignees","append","render","knob","updatePlanDetails","configureContextMenu","addClass","removeClass","getPictureAndName","idCurrentPlan","thereWasUsersMap","j","user","userAssigned","picture","orderActivitiesByTransitions","transitions","getActivitiesByTransitions","i","fromDate","creationDate","toDate","dueDate","Date","util","dateFormatter","getRelativeTime","value","completedActivities","dueDateFormat","getFormattedDate","locatedState","toLowerCase","idsUsers","deferreds","push","idUserCreator","def","getMetaData","paintPlanDetails","configureActivitiesTooltip","apply","then","equalizeHeights","getUsers","getUsersFromIdPlan","id_activity","usersFromPlan","map","uuser","usersAdapter","createJsonUserInfo","username","email","getInitials","progressPlan","currentActivities","planUsersId","planUsers","users","nameFirstDate","firstDate","lastUpdateToCalculatedClosed","$currentCard","auxLastDate","finishDate","workItemState","progress","indexOf","a","u","undefined","Math","round","find","html","val","trigger","click","preventDefault","attr","usersAssignees","publish","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","maximize","modalParameters","title","width","height","refreshInbox","getVisibleButtonWorkonit","join","show","hide","formatFirstDate","key","dateObject","dateFormat","dateInvariant","formatInvariant","formatInvariantDate","text","planProgress","currentActiveActivities","responseVisibility","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","toolTiptemplate","tooltip","$elementsTmpl","estimatedFinishDate","userName","userPicture","formatedEstimatedFinishDate","formatDate","activityItem","configureUserTooltip","not","$target","id_userSelected","userParam","usertooltip","lstUsers","lstCurrentUsers","usersGuids","getUsersData","isAnonymized","configureAvatar","k","idUser","$avatar","menuTemplate","planCard","planName","planCurrentState","planActivitiesLength","parseInt","pendingActivities","isNaN","completed","contextMenuContent","menu","configureMenuHandlers","position","my","at","of","collision","document","one","remove","defer","Deferred","paramsActivities","paramsWorkItems","paramsTransition","getActivities","getWorkitemsPlan","getTransitionsByPlan","responseActivities","responseWorkitems","responseTransitions","mergePropertiesActivitiesWithWorkitems","resolve","promise","getCurrentTimeDateServer","differenceMillisecondsServer","getDifferenceBetweenDates","date","getTime","$args","getUserPlans","getEmptyDataMessage","workItems","workItemFilter","filter","workItem","guidActivity","wiEntryDate","wiSolutionDate","wiEstimatedSolutionDate","clean","unsub","register","manager","planCreate","plans.topmenu.wrapper","onClickAddPlan","showPopupAddPlan","paramsNewPlan","topmenu","max","min","c","d","t","e","originalEvent","touches","o","s","g","v","cv","x","y","w","h","$c","isInit","fgColor","pColor","dH","cH","eH","rH","scale","relative","relativeWidth","relativeHeight","$div","run","cf","conf","_carve","_configure","_draw","stopper","readOnly","cursor","thickness","lineCap","displayInput","displayPrevious","inputColor","font","fontWeight","inline","step","rotation","draw","change","cancel","release","format","parse","parseFloat","flip","is","each","$this","bind","_validate","createElement","wrap","before","parent","G_vmlCanvasManager","initElement","getContext","message","toString","window","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","Object","copy","_listen","_xy","css","clear","_touch","touchMove","xy2val","pageX","pageY","unbind","_mouse","mouseMove","keyCode","offset","left","top","listen","resize","h2rgba","_clear","rgb","f","Dial","call","startAngle","xy","radius","lineWidth","cursorExt","w2","PI2","PI","bgColor","angleOffset","angleArc","triggerRelease","ret","atan2","mwTimerStop","mwTimerRelease","kval","to","mw","ori","deltaX","detail","wheelDeltaX","deltaY","wheelDeltaY","clearTimeout","setTimeout","m","kv","37","38","39","40","kc","String","fromCharCode","match","inArray","endAngle","abs","vertical-align","margin-top","margin-left","border","background","text-align","color","padding","-webkit-appearance","visibility","angle","arc","sa","ea","pa","r","beginPath","strokeStyle","stroke","fn","dial","plansLinks","plans.filters.wrapper","filteredData","items","setSelectedFilter","item","siblings","onLoadPlansView","onClickFilter","off","filters","project-plan-activities-sidebar","project","sidebar","plan-create","dialogBox","initPlugins","formContent","elements","inputName","inputTemplate","buttonSave","buttonCancel","onClickSavePlan","closeDialogBox","dialog","detach","templateGuid","getTemplatesByParentWorkItem","parentWorkItem","guidWorkItem","comboDataSource","combo","uicombo","isEditable","itemValue","obj","itemText","onChange","ui","keydown","resizable","draggable","modal","close","validateParams","createNewPlan","parentWorkItemRaw","currentUser","description","waitForCompletion","idTemplate","sendDataInsertPlan","encodeHtml","nameValidation","next","postPlan","responseText","xhr","reject","create","planToEdit","plans.manager.popup.edit.plan","closeEditDialogBox","inputDueDate","datepicker","initEditDialogBox","decodeHtmlEntities","inputDesc","inputWaitForCompletion","prop","getDateFormatByDatePickerJqueryUI","editPlanTemplate","saveEditedPlan","validateEditDialogBoxParams","getParamsUpdatePlan","paramsEditPlan","dueDateRaw","getEndHourWorkingByDate","dateTime","edit","idPlanSelected","plan-template-create","onClickSaveTemplate","validateSaveDialogBoxParams","createTemplateByPlan","admin","caseSearch","admin.case.search","admin.case.search.fields","admin.case.search.button","admin.case.search.result","admin.case.search.pagination","admin.case.search.invalidate","admin.case.search.reassign","admin.case.search.reassign.form","admin.case.search.action.result","useNewEngine","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE","tmpl","loadtemplates","generalContentTmpl","fieldsContentTmpl","buttonContentTmpl","resultContentTmpl","paginationTmpl","invalidateContentTmpl","reassignContentTmpl","reassignFormTmpl","actionResultContentTmpl","maxElemShow","maxPageToShow","processNavigation","setupData","selectedTasks","cases","selectedTasksToShow","setupInitialData","setupDatePicker","setupProcessTree","setupMainButtons","taskItem","idtask","showReassignForm","fields","buttonBackAction","selectedUserId","selectedUserName","searchParams","processTree","controlType","treeRoutSelected","processtree","canvas","setupUsersSearchForm","usersTable","userstable","userLinkLabel","parentDef","userId","assignEventReassignLinks","findResults","pageToShow","Page","getAdminCasesList","resultList","totalRecords","records","totalPages","total","rows","showCasesSearchResultFrame","setupActionsButton","paginationHtml","pageToshow","summaryWrapper","pagerData","pagination","page","pages","pageNumber","bizagiPagination","actualPage","listElement","clickCallBack","options","showMessageBox","error","log","processedItems","preprocessResultList","headers","resultTemplate","invalidateForm","reassignForm","setupActivitiesLink","setupGraphicQueryEvent","processResultItem","rowItem","taskElements","taskElementsLength","currentTaskObj","taskColumnIndexLength","rowItemData","idWorkflow","idWorkFlow","resultArray","firstRowItem","taskColumnIndex","columnIndex","resultTaskArray","fieldName","columnsID","caseNumber","process","task","taskDueDate","isArray","splice","processTaskObjectUser","processTaskObject","processTaskObjectDate","estimatedSolutionDate","processCreationDate","processDueDate","idworkflow","taskData","totalTask","taskObject","taskName","colorState","idTask","assignee","invalidateCases","selectedCases","reason","JSON","stringify","abortReassignItems","abortResult","showActionResultFrame","showReassignTasksFrame","tasks","split","reassignTasks","idNewUser","reassignCurrent","reassignResult","result","itemsFailed","resultStatus","deleted","reassigned","innerHTML","replace","buttons","widgetButtonSet","idAppToSend","idCategorytoSend","idProcessToSend","errorMessage","errorFieldName","selectedProcessRoute","getTreeRouteSelected","h_action","I_ProcessState","h_idApp","I_Users","eventAsTask","orderType","order","orderField","I_radNumber","I_idWFClass","I_USERFULLNAME","I_USERPOSITION","I_From__CreationDate","I_To__CreationDate","h_idWFClassAuth","I_idCategory","I_idApplication","PageSize","isDate","backToMainForm","backToCases","getAttribute","columnOrderId","columnOrderBy","columnOrderName","showGraphicQuery"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal Desktop descontextualized plans Manager\r\n *   Author: Iv�n Ricardo Taimal Narv�ez\r\n */\n\nbizagi.workportal.widgets.widget.extend('bizagi.workportal.widgets.plans.manager', {}, {\n\n  usersMap: {},\n  /*\r\n                 *   Constructor\r\n                 */\n  init: function init(workportalFacade, dataService, actionService, notifier, planTemplateCreate, planPopupEdit, serviceOrderActivitiesByTransitions, params) {\n    var self = this;\n    // Call base\n    self._super(workportalFacade, dataService, params);\n    self.serviceOrderActivitiesByTransitions = serviceOrderActivitiesByTransitions;\n\n    self.plans = {};\n    self.editDialogBox = {};\n    self.allIdUsers = [];\n    self.allGuidUsers = [];\n    self.notifier = notifier;\n    self.planTemplateCreate = planTemplateCreate;\n    self.planPopupEdit = planPopupEdit;\n    self.globalHandlersService = bizagi.injector.get('globalHandlersService');\n    self.usersFromIdPlan = Array();\n\n    //Load templates\n    self.loadTemplates({\n      'plans.manager.wrapper': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.manager').concat('#plans-manager-wrapper'),\n      'plans.manager.empty': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.manager').concat('#plans-manager-empty-message'),\n      'plans.manager.users': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.manager').concat('#plans-manager-users'),\n      'plans.manager.activities.tooltip': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.manager').concat('#plans-manager-activities-tooltip'),\n      'plans.manager.context.menu.content': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.manager').concat('#plans-manager-context-menu-content') });\n\n  },\n\n  /**\r\n      * Renders the template defined in the widget\r\n      * @return {*|jQuery|HTMLElement}\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    self.content = $('<div/>'); // self.getEmptyDataMessage().render({});\n    return self.content;\n  },\n\n  /**\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n\n    self.getCalculatedDateServer();\n\n    self.sub('PLANS-VIEW', $.proxy(self.updateView, self));\n\n    self.planTemplateCreate.sub('planTemplateCreatedSuccess', function () {\n      self.notifier.showSucessMessage(\n      printf(bizagi.localization.getResource('workportal-project-plan-create-template-success'), ''));\n    });\n    self.planTemplateCreate.sub('planTemplateCreatedFailed', function () {\n      self.notifier.showErrorMessage(\n      printf(bizagi.localization.getResource('workportal-project-plan-create-template-fail'), ''));\n    });\n\n    self.planPopupEdit.sub('planEditedSuccess', function () {\n      var args = {\n        histName: self.params.histName,\n        planState: self.params.planState,\n        level: 1 };\n\n      self.pub('notify', {\n        type: 'PLANS-VIEW',\n        args: $.extend(self.params, args) });\n\n\n      self.notifier.showSucessMessage(\n      printf(bizagi.localization.getResource('workportal-project-plan-edit-success'), ''));\n    });\n\n    self.planPopupEdit.sub('planEditedFailed', function () {\n      self.notifier.showErrorMessage(\n      printf(bizagi.localization.getResource('workportal-project-plan-edit-fail'), ''));\n    });\n\n  },\n\n  /**\r\n      * Binds events to handles\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this,\n    $content = self.getContent();\n    $('.wdg-plans-manager-card', $content).on('click', $.proxy(self.onClickPlan, self));\n    $('.wdg-plans-manager-card .btn-workonit', $content).on('click', function (event) {\n      event.stopPropagation();\n      var target = $(event.target);\n      var planCard = target.closest('.wdg-plans-manager-card');\n      var planId = planCard.data('plan-id');\n      self.plans[planId].activities.forEach(function (activity) {\n        if (self.runningActivity(activity)) {\n          self.goToWorkOnIt(activity.idCase, activity.idWorkItem);\n        }\n      });\n    });\n  },\n\n  /**\r\n      *\r\n      * @param ev\r\n      */\n  onClickPlan: function onClickPlan(ev) {\n    var self = this,\n    target = $(ev.target).closest('.wdg-plans-manager-card'),\n    idPlan = target.data('plan-id'),\n    namePlan = target.data('plan-name');\n    var plan = {\n      name: namePlan,\n      id: idPlan };\n\n    self.showPlanDashBoard(plan);\n  },\n\n  /**\r\n      * Show plan dashboard\r\n      * @param plan\r\n      */\n  showPlanDashBoard: function showPlanDashBoard(plan) {\n    var self = this;\n    var servicesPD = new bizagi.workportal.services.behaviors.projectDashboard(self.dataService);\n\n    self.params.showContextByMenuDashboard = \"PLANACTIVITIES\";\n    self.params.menuPlanDashboard = {};\n    self.params.menuPlanDashboard.showCommentsOptionMenu =\n    servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonComments;\n    self.params.menuPlanDashboard.showFilesOptionMenu =\n    servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonFiles;\n    self.params.menuPlanDashboard.showTimeLineOptionMenu =\n    servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonTimeLine;\n\n    plan = self.plans[plan.id];\n    if (plan.name.length > 28) {\n      plan.name = plan.name.substring(0, 29) + \"...\";\n    }\n\n    if (plan.contextualized) {\n      delete self.params.flowContext;\n    }\n\n    $.when(servicesPD.getFirstParentInfo(plan.id, plan.contextualized)).done(function (response) {\n      self.params.radNumber = response.id;\n      var args = {\n        plan: plan,\n        level: 2,\n        histName: plan.name,\n        hasDiscussionsOrComment: response.hasDiscussionsOrComment };\n\n      self.pub('notify', {\n        type: self.params.showContextByMenuDashboard,\n        args: $.extend(self.params, args) });\n\n    });\n  },\n\n  /**\r\n      * delete plan\r\n      * @param plan\r\n      */\n  deletePlan: function deletePlan(plan) {\n    var self = this;\n    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource('workportal-project-plan-action-delete-confirmation'), '', 'info')).done(function () {\n      var params = {\n        id: plan.id };\n\n      $.when(self.dataService.deletePlan(params)).always(function (response) {\n        if (response.status === 200 || typeof response.status === \"undefined\") {\n          $.extend(self.params.plan, params);\n          var args = {\n            histName: self.params.histName,\n            planState: self.params.planState,\n            level: 1 };\n\n          self.pub('notify', {\n            type: 'PLANS-VIEW',\n            args: $.extend(self.params, args) });\n\n          self.notifier.showSucessMessage(\n          printf(bizagi.localization.getResource('workportal-project-plan-delete-success'), ''));\n        } else\n        {\n          self.notifier.showErrorMessage(\n          printf(bizagi.localization.getResource('workportal-project-plan-delete-fail'), ''));\n        }\n      });\n    });\n  },\n\n  /**\r\n      * Execute plan\r\n      * @param plan\r\n      */\n  executePlan: function executePlan(plan) {\n    var self = this;\n    var numberActivitiesCreated = plan.activitiesLength;\n    if (numberActivitiesCreated > 0) {\n      var params = {\n        idPlan: plan.id };\n\n      $.when(self.dataService.putExecutePlan(params)).done(function () {\n        var updateParams = self.plans[plan.id];\n        if (updateParams) {\n          updateParams.currentState = 'EXECUTING';\n          updateParams = $.extend(updateParams, { startDate: self.getDateServer() });\n          $.when(self.dataService.updatePlan(updateParams)).done(function () {\n            var args = {\n              histName: self.params.histName,\n              planState: self.params.planState,\n              level: 1 };\n\n            self.pub('notify', {\n              type: 'PLANS-VIEW',\n              args: $.extend(self.params, args) });\n\n            self.notifier.showSucessMessage(\n            printf(bizagi.localization.getResource('workportal-project-plan-state-change-running'), ''));\n          });\n        }\n      });\n    } else {\n      self.notifier.showErrorMessage(\n      printf(bizagi.localization.getResource('workportal-project-plan-action-execute-message-activities-required'), ''));\n    }\n  },\n\n  /**\r\n      * Close plan\r\n      * @param plan\r\n      */\n  closePlan: function closePlan(plan) {\n    var self = this;\n    var updateParams = self.plans[plan.id];\n    if (updateParams) {\n      updateParams.currentState = 'CLOSED';\n      $.when(self.dataService.closePlan({ idPlan: plan.id })).done(function () {\n        $.when(self.dataService.updatePlan(updateParams)).done(function () {\n          var args = {\n            histName: self.params.histName,\n            planState: self.params.planState,\n            level: 1 };\n\n          self.pub('notify', {\n            type: 'PLANS-VIEW',\n            args: $.extend(self.params, args) });\n\n          self.notifier.showSucessMessage(\n          printf(bizagi.localization.getResource('workportal-project-plan-close-success'), ''));\n        });\n      }).fail(function () {\n        self.notifier.showErrorMessage(\n        printf(bizagi.localization.getResource('workportal-project-plan-close-fail'), ''));\n      });\n    }\n  },\n\n  /**\r\n      * Show popup for edit plan\r\n      */\n  openPopupEditTemplate: function openPopupEditTemplate() {\n    var self = this;\n    var planSelected = self.plans[self.selectedPlan.id] || {};\n\n    self.planPopupEdit.showPopup(self.params, self.dataService, planSelected);\n  },\n\n  /**\r\n      * Show popup for save plan as template\r\n      */\n  openPopupSaveTemplate: function openPopupSaveTemplate() {\n    var self = this;\n    var planSelected = self.plans[self.selectedPlan.id] || {};\n\n    self.planTemplateCreate.showPopupAddTemplatePlan(self.params,\n    self.dataService, planSelected.contextualized, planSelected.id);\n\n  },\n\n  /**\r\n      * Render content widget\r\n      * @param event\r\n      * @param params\r\n      */\n  updateView: function updateView(event, params) {\n    var self = this;\n    self.params = params.args;\n    self.getContent().empty();\n    var template = self.getTemplate('plans.manager.wrapper');\n\n    $.when(self.getData()).\n    done(function (data) {\n      if (data.length > 0) {\n        self.content.empty();\n        self.arrayPlans = self.processData(data);\n        var totalAssignees = self.arrayPlans.length;\n        var assignees = self.arrayPlans;\n        assignees.totalAssignees = totalAssignees;\n        self.content.append(template.render({ plans: assignees }));\n        $('.wdg-plans-row-dial', self.content).knob();\n        self.updatePlanDetails();\n        self.configureHandlers();\n        self.configureContextMenu();\n\n        $(\"#ui-bizagi-wp-project-homeportal-main\").addClass(\"disabled-right-sidebar\").removeClass(\"enabled-right-sidebar\");\n      } else\n      {\n        self.content.empty();\n        self.content.append(self.getTemplate('plans.manager.empty').render());\n      }\n    });\n  },\n  getPictureAndName: function getPictureAndName(idCurrentPlan) {//The first time that the page is loaded usersMap doesn't have data. So this method verify and complete the data if this is not completed\n    var self = this;\n    if (self.thereWasUsersMap === false) {\n      if (self.usersMap) {\n        for (var j = 0; j < self.usersFromIdPlan[idCurrentPlan].length; j += 1) {\n          var user = self.usersMap[self.usersFromIdPlan[idCurrentPlan][j].userAssigned];\n          self.usersFromIdPlan[idCurrentPlan][j].picture = user.picture;\n          self.usersFromIdPlan[idCurrentPlan][j].name = user.name;\n        }\n      }\n    }\n  },\n\n\n  /**\r\n      *\r\n      * @param activities\r\n      * @param transitions\r\n      */\n  orderActivitiesByTransitions: function orderActivitiesByTransitions(activities, transitions) {\n    var self = this;\n    return self.serviceOrderActivitiesByTransitions.\n    getActivitiesByTransitions(activities, transitions);\n  },\n\n  /**\r\n      * Process data for render widget\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  processData: function processData(data) {\n    var self = this;\n    var length = data.length;\n    for (var i = 0; i < length; i += 1) {\n      self.plans[data[i].id] = data[i];\n      var fromDate = data[i].startDate || data[i].creationDate;\n      var toDate = data[i].dueDate;\n\n      if (fromDate) {\n        fromDate = new Date(fromDate);\n        data[i].fromDate = bizagi.util.dateFormatter.getRelativeTime(fromDate, null, false);\n      }\n\n      if (toDate) {\n        toDate = new Date(toDate);\n        data[i].toDate = bizagi.util.dateFormatter.getRelativeTime(toDate, null, false);\n      }\n\n      data[i].value = 0;\n      data[i].completedActivities = 0;\n      data[i].activitiesLength = 0;\n      if (data[i].dueDate) {\n        data[i].dueDateFormat = self.getFormattedDate(new Date(data[i].dueDate));\n      }\n\n      data[i].locatedState = bizagi.localization.getResource(\"workportal-project-plan-state-\" + data[i].currentState.toLowerCase());\n    }\n\n    return data;\n  },\n\n  /**\r\n      * Update sections details plans\r\n      */\n  updatePlanDetails: function updatePlanDetails() {\n    var self = this,\n    idsUsers = [],\n    deferreds = [];\n\n    for (var i = 0; i < self.arrayPlans.length; i += 1) {\n      idsUsers.push(self.arrayPlans[i].idUserCreator);\n      var def = self.getMetaData(self.arrayPlans[i].id);\n\n      $.when(def, self.arrayPlans[i].id).\n      done(function (activities, idCurrentPlan) {\n        self.plans[idCurrentPlan].activities = activities;\n        self.paintPlanDetails(activities, idCurrentPlan);\n        self.configureActivitiesTooltip(activities, idCurrentPlan);\n      });\n      deferreds.push(def);\n    }\n\n    $.when.apply($, deferreds).then(function () {\n      $.equalizeHeights(\".wdg-plans-manager-card\");\n      self.getUsers(idsUsers.concat(self.allIdUsers));\n    });\n  },\n\n  /***\r\n      * return the array users from an activity\r\n      */\n  getUsersFromIdPlan: function getUsersFromIdPlan(id_activity) {\n    var self = this;\n    var usersFromPlan = [];\n    self.usersFromIdPlan[id_activity].map(function (uuser) {\n      var user = self.usersMap[uuser.userAssigned];\n      usersFromPlan.push(\n      usersAdapter.createJsonUserInfo(uuser.userAssigned, user.name, user.username, user.picture, user.email, user.name.getInitials(), false, false, uuser.activities, []));\n\n    });\n    return usersFromPlan;\n  },\n\n  /**\r\n      * Render plan details\r\n      * @param activities\r\n      * @param idCurrentPlan\r\n      */\n  paintPlanDetails: function paintPlanDetails(activities, idCurrentPlan) {\n    var self = this;\n    var activitiesLength = activities.length,\n    completedActivities = 0,\n    progressPlan = 0,\n    currentActivities = [],\n    planUsersId = [],\n    planUsers = [],\n    template = self.getTemplate('plans.manager.users');\n    self.plans[idCurrentPlan].users = {};\n    var lastUpdateToCalculatedClosed = self.plans[idCurrentPlan].startDate || self.plans[idCurrentPlan].creationDate;\n\n    var $currentCard = $('[data-plan-id=\"' + self.plans[idCurrentPlan].id + '\"]', self.content);\n    if (activitiesLength == 0) {\n      self.usersFromIdPlan[idCurrentPlan] = [{ userAssigned: self.plans[idCurrentPlan].idUserCreator, activities: [] }];\n    } else {\n      self.usersFromIdPlan[idCurrentPlan] = [];\n      for (var i = 0; i < activitiesLength; i += 1) {\n\n        var auxLastDate = activities[i].finishDate || activities[i].startDate;\n        lastUpdateToCalculatedClosed = lastUpdateToCalculatedClosed < auxLastDate ? auxLastDate : lastUpdateToCalculatedClosed;\n\n        if (activities[i].workItemState === 'Completed') {\n          completedActivities += 1;\n          activities[i].progress = 100;\n        }\n        if (self.runningActivity(activities[i])) {\n          currentActivities.push(activities[i].name);\n          activities[i].progress = 0;\n        }\n        if (planUsersId.indexOf(activities[i].userAssigned) < 0) {\n          self.plans[idCurrentPlan].users[activities[i].userAssigned] = [activities[i]];\n          planUsersId.push(activities[i].userAssigned);\n        } else\n        {\n          self.plans[idCurrentPlan].users[activities[i].userAssigned].push(activities[i]);\n        }\n        if (self.allIdUsers.indexOf(activities[i].userAssigned) < 0) {\n          self.allIdUsers.push(activities[i].userAssigned);\n          self.allGuidUsers.push(activities[i].userAssigned);\n        }\n        progressPlan += activities[i].progress;\n      }\n\n      for (var j = 0; j < planUsersId.length; j += 1) {\n        if (!self.usersMap[planUsersId[j]]) {\n          self.thereWasUsersMap = false;\n          planUsers.push({\n            userAssigned: planUsersId[j],\n            picture: '',\n            name: '' });\n\n          self.usersFromIdPlan[idCurrentPlan].push(\n          usersAdapter.createJsonUserInfo(planUsersId[j], '', '', '', '', '', false, false, [], []));\n\n        } else\n        {\n          var user = self.usersMap[planUsersId[j]];\n          planUsers.push(user);\n          thereWasUsersMap = true;\n          self.usersFromIdPlan[idCurrentPlan].push({ userAssigned: planUsersId[j], activities: [] });\n        }\n      }\n\n      //Add activities to self.usersFromIdPlan\n      for (var a = 0; a < self.plans[idCurrentPlan].activities.length; a++) {\n        for (var u = 0; u < self.usersFromIdPlan[idCurrentPlan].length; u++) {\n          if (self.usersFromIdPlan[idCurrentPlan][u].userAssigned === self.plans[idCurrentPlan].activities[a].userAssigned) {\n            if (self.usersFromIdPlan[idCurrentPlan][u][\"activities\"] == undefined)\n            self.usersFromIdPlan[idCurrentPlan][u][\"activities\"] = [];\n            self.usersFromIdPlan[idCurrentPlan][u][\"activities\"].push(self.plans[idCurrentPlan].activities[a]);\n          }\n        }\n      }\n\n      progressPlan = Math.round(progressPlan / activitiesLength);\n\n      $currentCard.find('.wdg-plans-row-completed').html(completedActivities);\n      $currentCard.find('.wdg-plans-row-activities-length').html(activitiesLength);\n      $currentCard.find('.wdg-plans-row-dial').val(progressPlan).trigger('change');\n      planUsers.idPlan = self.plans[idCurrentPlan].id;\n      $currentCard.find('.wdg-plans-users').html(template.render({ users: planUsers }));\n      $currentCard.find(\".moreUsers\").click(function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n        var id_activity = $(this).attr(\"data-plan-id\");\n        self.getPictureAndName(id_activity);\n        var usersAssignees = self.getUsersFromIdPlan(id_activity);\n        self.globalHandlersService.publish(\"showDialogWidget\", {\n          widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\n          closeVisible: true,\n          data: usersAssignees,\n          maximize: true,\n          modalParameters: {\n            title: bizagi.localization.getResource(\"workportal-project-users-title\") + \" (\" + usersAssignees.length + \")\",\n            width: 790,\n            height: 526,\n            refreshInbox: false } });\n\n\n      });\n\n      if (self.getVisibleButtonWorkonit(self.plans[idCurrentPlan], progressPlan, currentActivities)) {\n        $currentCard.find('.wdg-plans-row-activities').html(currentActivities.join(','));\n        $currentCard.find('.wdg-plans-workonit-row').show();\n      } else\n      {\n        $currentCard.find('.wdg-plans-activities-row').hide();\n        $currentCard.find('.wdg-plans-workonit-row').hide();\n      }\n    }\n\n    var nameFirstDate;\n    var firstDate;\n    if (self.plans[idCurrentPlan].currentState === \"PENDING\") {\n      nameFirstDate = bizagi.localization.getResource(\"workportal-general-properties-last-update\");\n      firstDate = self.plans[idCurrentPlan].creationDate;\n    } else\n    if (self.plans[idCurrentPlan].currentState === \"EXECUTING\") {\n      nameFirstDate = bizagi.localization.getResource(\"workportal-general-properties-start-date\");\n      firstDate = self.plans[idCurrentPlan].startDate;\n    } else\n    if (self.plans[idCurrentPlan].currentState === \"CLOSED\") {\n      nameFirstDate = bizagi.localization.getResource(\"workportal-general-properties-closed-date\");\n      firstDate = lastUpdateToCalculatedClosed;\n    }\n\n    var formatFirstDate = self.getFormattedDate(new Date(firstDate));\n    $currentCard.find('.first-date-plan').html(nameFirstDate + \": \" + formatFirstDate);\n  },\n\n  getResource: function getResource(key) {\n    return bizagi.localization.getResource(key);\n  },\n\n  getFormattedDate: function getFormattedDate(dateObject) {\n    var self = this;\n    var dateFormat = self.getResource(\"dateFormat\");\n    var dateInvariant = bizagi.util.dateFormatter.formatInvariant(dateObject, false);\n    var content = $(\"<span class='formatDate'>\" + dateInvariant + \"</span>\");\n    bizagi.util.formatInvariantDate(content, dateFormat);\n    return content.text();\n  },\n\n  /**\r\n      * Get visible property of the button work on it\r\n      * @param plan\r\n      * @param planProgress\r\n      * @returns {boolean}\r\n      * @param currentActiveActivities\r\n      */\n  getVisibleButtonWorkonit: function getVisibleButtonWorkonit(plan, planProgress, currentActiveActivities) {\n    var responseVisibility = false;\n    if (plan.currentState === \"EXECUTING\" && planProgress < 100 && currentActiveActivities.length > 0) {\n      responseVisibility = true;\n    }\n    return responseVisibility;\n  },\n\n  /**\r\n      * Go to Workitem\r\n      * @param idCase\r\n      * @param idWorkItem\r\n      */\n  goToWorkOnIt: function goToWorkOnIt(idCase, idWorkItem) {\n    var self = this;\n    self.publish(\"executeAction\", {\n      action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n      idCase: idCase,\n      idWorkItem: idWorkItem });\n\n  },\n\n  /**\r\n      *\r\n      * @param activities\r\n      * @param idCurrentPlan\r\n      */\n  configureActivitiesTooltip: function configureActivitiesTooltip(activities, idCurrentPlan) {\n    var self = this;\n    var toolTiptemplate = self.getTemplate('plans.manager.activities.tooltip');\n    var currentPlanCard = $('[data-plan-id=\"' + idCurrentPlan + '\"]', self.content);\n    currentPlanCard.find('.wdg-plans-activities-row').tooltip({\n      content: function content() {\n        var $elementsTmpl = $();\n        activities.forEach(function (activity) {\n          if (self.runningActivity(activity)) {\n            var estimatedFinishDate = activity.estimatedFinishDate ? new Date(activity.estimatedFinishDate) : null;\n            if (self.usersMap[activity.userAssigned]) {\n              activity.userName = self.usersMap[activity.userAssigned].name;\n              activity.userPicture = self.usersMap[activity.userAssigned].picture;\n              activity.formatedEstimatedFinishDate = estimatedFinishDate ? bizagi.util.dateFormatter.formatDate(estimatedFinishDate, bizagi.localization.getResource(\"dateFormat\")) : null;\n            }\n            var activityItem = toolTiptemplate.render({ activity: activity });\n            $elementsTmpl.push.apply($elementsTmpl, activityItem);\n          }\n        });\n        return $elementsTmpl;\n      } });\n\n  },\n\n  /**\r\n      * Know if the activity is running\r\n      * @param activity\r\n      * @returns {boolean}\r\n      */\n  runningActivity: function runningActivity(activity) {\n    //Inactive represent created but user dont access yet\n    return activity.workItemState === 'Active' || activity.workItemState === 'Inactive';\n  },\n\n  /**\r\n      * User tooltip\r\n      */\n  configureUserTooltip: function configureUserTooltip() {\n    var self = this;\n    $(\".wdg-plans-users > li\", self.content).not('.icon-more').on('mouseenter', '', function (ev) {\n      var $target = $(ev.target);\n      var id_userSelected = $target.closest(\"[data-iduser]\").attr('data-iduser');\n      var idCurrentPlan = $target.closest(\".wdg-plans-manager-card\").attr('data-plan-id');\n      var user = self.usersFromIdPlan[idCurrentPlan].find(function (user) {\n        return user.userAssigned == id_userSelected;\n      });\n      if (user && user.userAssigned == id_userSelected) {\n        var activities = [];\n        user.activities.map(function (activity) {\n          activities.push(activity.name);\n        });\n        user = self.usersMap[user.userAssigned];\n        var userParam = usersAdapter.createJsonUserInfo(user.userAssigned, user.name, user.username, user.picture, user.email, user.name.getInitials(), false, false, activities, []);\n        $target.closest(\".wdg-plans-users\").usertooltip(self, { target: $target, user: userParam });\n      }\n    });\n  },\n\n  /**\r\n      * Get data users\r\n      * @param lstUsers\r\n      */\n  getUsers: function getUsers(lstUsers) {\n    var self = this;\n    var lstCurrentUsers = [];\n    var length = lstUsers.length;\n    for (var i = 0; i < length; i += 1) {\n      if (!self.usersMap[lstUsers[i]]) {\n        lstCurrentUsers.push(lstUsers[i]);\n      }\n    }\n    if (lstCurrentUsers.length > 0) {\n      var params = {\n        usersGuids: lstUsers.join(),\n        width: 32,\n        height: 32 };\n\n      $.when(self.dataService.getUsersData(params)).done(function (users) {\n        var length = users.length;\n        for (var i = 0; i < length; i += 1) {\n          self.usersMap[users[i].id] = {\n            picture: users[i].picture ? 'data:image/png;base64,' + users[i].picture : '',\n            name: users[i].name || '',\n            userAssigned: users[i].id,\n            username: users[i].username,\n            isAnonymized: users[i].isAnonymized,\n            email: users[i].email };\n\n          self.configureAvatar(users[i].id);\n        }\n        self.configureUserTooltip();\n      });\n    } else {\n      for (var k = 0; k < lstUsers.length; k += 1) {\n        self.configureAvatar(lstUsers[k]);\n      }\n      self.configureUserTooltip();\n    }\n  },\n\n  /**\r\n      *\r\n      * @param idUser\r\n      */\n  configureAvatar: function configureAvatar(idUser) {\n    var self = this;\n    var $avatar = $('[data-iduser=\"' + idUser + '\"]', self.content);\n    if (self.usersMap[idUser].picture) {\n      $avatar.find('.bz-wp-avatar-img').attr('src', self.usersMap[idUser].picture);\n    } else\n    {\n      $avatar.find('.bz-wp-avatar-img').hide();\n      $avatar.find('.wdg-plans-row-user-label').html(self.usersMap[idUser].name.getInitials()).show();\n    }\n  },\n\n  /**\r\n      * Configure context menu by plan\r\n      */\n  configureContextMenu: function configureContextMenu() {\n    var self = this;\n    var $content = self.getContent();\n    var menuTemplate = self.getTemplate('plans.manager.context.menu.content');\n    $('.wdg-plans-leftmenu', $content).on('click', function (event) {\n      event.stopPropagation();\n      var target = $(event.target);\n      var planCard = target.closest('.wdg-plans-manager-card');\n      var planId = planCard.data('plan-id');\n      var planName = planCard.data('plan-name');\n      var planCurrentState = planCard.data('plan-current-state');\n      var planActivitiesLength = parseInt(planCard.find('.wdg-plans-row-activities-length').html(), 0);\n      var completedActivities = parseInt(planCard.find('.wdg-plans-row-completed').html(), 0);\n      var pendingActivities = isNaN(planActivitiesLength) || isNaN(completedActivities) ? 0 : planActivitiesLength - completedActivities;\n      self.selectedPlan = {\n        id: planId,\n        name: planName,\n        activitiesLength: isNaN(planActivitiesLength) ? 0 : planActivitiesLength,\n        completed: pendingActivities <= 0 };\n\n      var contextMenuContent = menuTemplate.render({\n        currentState: planCurrentState,\n        completed: self.selectedPlan.completed });\n\n      $('.plans-manager-context-menu-wrapper', $content).append(contextMenuContent);\n      contextMenuContent.menu();\n      self.configureMenuHandlers(contextMenuContent);\n\n      contextMenuContent.position({\n        my: 'left top',\n        at: 'left bottom',\n        of: target,\n        collision: 'fit' });\n\n      contextMenuContent.show();\n      $(document).one('click', function () {\n        contextMenuContent.remove();\n      });\n      $('.wdg-plans-manager-card').one('click', function () {\n        contextMenuContent.remove();\n      });\n      $('.wdg-plans-leftmenu').one('click', function () {\n        contextMenuContent.remove();\n      });\n      // return false;\n    });\n  },\n\n  /**\r\n      * Events on contextual menu by plan\r\n      * @param contextMenuContent\r\n      */\n  configureMenuHandlers: function configureMenuHandlers(contextMenuContent) {\n    var self = this;\n    $('#edit', contextMenuContent).on('click', function (event) {\n      event.stopPropagation();\n      self.openPopupEditTemplate(self.selectedPlan);\n    });\n    $('#save', contextMenuContent).on('click', function (event) {\n      event.stopPropagation();\n      self.openPopupSaveTemplate(self.selectedPlan);\n    });\n    $('#enable', contextMenuContent).on('click', function (event) {\n      event.stopPropagation();\n      self.executePlan(self.selectedPlan);\n    });\n    $('#delete', contextMenuContent).on('click', function (event) {\n      event.stopPropagation();\n      self.deletePlan(self.selectedPlan);\n    });\n    $('#close', contextMenuContent).on('click', function (event) {\n      event.stopPropagation();\n      self.closePlan(self.selectedPlan);\n    });\n  },\n\n\n  /**\r\n      * Get activities and workitems and merge\r\n      * @param idPlan\r\n      * @returns {*}\r\n      */\n  getMetaData: function getMetaData(idPlan) {\n    var self = this;\n    var defer = $.Deferred();\n    var paramsActivities = { idPlan: idPlan };\n    var paramsWorkItems = { idPlan: idPlan };\n    var paramsTransition = { idPlan: idPlan };\n    $.when(self.dataService.getActivities(paramsActivities),\n    self.dataService.getWorkitemsPlan(paramsWorkItems),\n    self.dataService.getTransitionsByPlan(paramsTransition)).done(\n    function (responseActivities, responseWorkitems, responseTransitions) {\n      var activities = responseActivities || [];\n      activities = self.orderActivitiesByTransitions(responseActivities, responseTransitions);\n      self.mergePropertiesActivitiesWithWorkitems(activities, responseWorkitems);\n      defer.resolve(activities);\n    });\n    return defer.promise();\n\n  },\n  /**\r\n      * Calculated date server\r\n      * @returns {*}\r\n      */\n  getCalculatedDateServer: function getCalculatedDateServer() {\n    var self = this;\n    return $.when(self.dataService.getCurrentTimeDateServer()).done(function (response) {\n      self.differenceMillisecondsServer = bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date(), new Date(response.date), \"milliseconds\");\n    });\n  },\n\n  /**\r\n      *\r\n      * Return date server\r\n      * @return {*}\r\n      */\n  getDateServer: function getDateServer() {\n    var dateLocal = new Date();\n    return dateLocal.getTime() + this.differenceMillisecondsServer;\n  },\n\n\n  /**\r\n      * @return {object} data\r\n      */\n  getData: function getData() {\n    var self = this;\n    var $args = {};\n    if (self.params.planState !== 'all') {\n      $args.currentState = self.params.planState;\n    }\n    return self.dataService.getUserPlans($args);\n  },\n\n  /**\r\n      * Gets Message when there aren't data\r\n      * @returns {templateEmptyData}\r\n      */\n  getEmptyDataMessage: function getEmptyDataMessage() {\n    var self = this;\n    return self.getTemplate('plans.manager.empty');\n  },\n\n  mergePropertiesActivitiesWithWorkitems: function mergePropertiesActivitiesWithWorkitems(activities, workItems) {\n    activities.forEach(function (activity) {\n      var workItemFilter = workItems.filter(function (workItem) {\n        return workItem.guidActivity == activity.id;\n      });\n      if (workItemFilter.length > 0) {\n        $.extend(activity, {\n          startDate: workItemFilter[0].wiEntryDate || null,\n          finishDate: workItemFilter[0].wiSolutionDate || null,\n          idWorkItem: workItemFilter[0].idWorkItem,\n          workItemState: workItemFilter[0].workItemState,\n          idCase: workItemFilter[0].idCase,\n          estimatedFinishDate: workItemFilter[0].wiEstimatedSolutionDate || activity.estimatedFinishDate });\n\n      }\n    });\n  },\n\n  /**\r\n      * Detach events\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.params = {};\n    self.unsub('PLANS-VIEW', $.proxy(self.updateView, self));\n    self.planTemplateCreate.unsub('planTemplateCreatedSuccess');\n    self.planTemplateCreate.unsub('planTemplateCreatedFailed');\n    self.planPopupEdit.unsub('planEditedSuccess');\n    self.planPopupEdit.unsub('planEditedFailed');\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.plans.manager', ['workportalFacade', 'dataService', 'actionService', 'notifier',\n'bizagi.workportal.widgets.project.plan.template.create',\n'bizagi.workportal.widgets.project.plan.edit',\n'bizagi.workportal.services.behaviors.orderActivitiesByTransitions',\nbizagi.workportal.widgets.plans.manager]);","/*\r\n *   Name: Bizagi Workportal Desktop  plan topmenu controller\r\n *   Author: Iván Ricardo Taimal Narváez\r\n */\n\nbizagi.workportal.widgets.widget.extend('bizagi.workportal.widgets.plans.topmenu', {}, {\n\n  init: function init(workportalFacade, dataService, planCreate, params) {\n    var self = this;\n    self.params = params;\n    // Call base\n    self._super(workportalFacade, dataService, params);\n    self.planCreate = planCreate;\n    //Load templates\n    self.loadTemplates({\n      'plans.topmenu.wrapper': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.topmenu').concat('#plans-topmenu-wrapper') });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate('plans.topmenu.wrapper');\n    self.content = template.render({});\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.configureHandlers();\n  },\n  /**\r\n      * Binds events to handles\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this,\n    $content = self.getContent();\n    $('.wdg-topmenu-add', $content).on('click', $.proxy(self.onClickAddPlan, self));\n  },\n\n  onClickAddPlan: function onClickAddPlan() {\n    var self = this;\n\n    self.planCreate.showPopupAddPlan(self.params, self.dataService, false);\n    self.planCreate.unsub('planCreated');\n    self.planCreate.sub('planCreated', function (ev, params) {\n      var paramsNewPlan = params.paramsNewPlan;\n      var histName = paramsNewPlan.name;\n      if (paramsNewPlan.name.length > 28) {\n        histName = paramsNewPlan.name.substring(0, 29) + '...';\n      }\n      self.params.radNumber = params.radNumber;\n      self.params.showContextByMenuDashboard = 'PLANACTIVITIES';\n      self.params.hasDiscussionsOrComment = params.hasDiscussionsOrComment;\n\n      self.pub('notify', {\n        type: 'PLANACTIVITIES',\n        args: $.extend(self.params, {\n          plan: params.paramsNewPlan,\n          level: 2,\n          histName: histName }) });\n\n\n    });\n  } });\n\n\n\n\nbizagi.injector.register('bizagi.workportal.widgets.plans.topmenu', ['workportalFacade', 'dataService', 'bizagi.workportal.widgets.project.plan.create', bizagi.workportal.widgets.plans.topmenu]);","(function knob($) {\n\n  /**\n                    * Kontrol library\n                    */\n  \"use strict\";\n\n  /**\n                 * Definition of globals and core\n                 */\n  var k = {}, // kontrol\n  max = Math.max,\n  min = Math.min;\n\n  k.c = {};\n  k.c.d = $(document);\n  k.c.t = function (e) {\n    return e.originalEvent.touches.length - 1;\n  };\n\n  /**\n      * Kontrol Object\n      *\n      * Definition of an abstract UI control\n      *\n      * Each concrete component must call this one.\n      * <code>\n      * k.o.call(this);\n      * </code>\n      */\n  k.o = function () {\n    var s = this;\n\n    this.o = null; // array of options\n    this.$ = null; // jQuery wrapped element\n    this.i = null; // mixed HTMLInputElement or array of HTMLInputElement\n    this.g = null; // deprecated 2D graphics context for 'pre-rendering'\n    this.v = null; // value ; mixed array or integer\n    this.cv = null; // change value ; not commited value\n    this.x = 0; // canvas x position\n    this.y = 0; // canvas y position\n    this.w = 0; // canvas width\n    this.h = 0; // canvas height\n    this.$c = null; // jQuery canvas element\n    this.c = null; // rendered canvas context\n    this.t = 0; // touches index\n    this.isInit = false;\n    this.fgColor = null; // main color\n    this.pColor = null; // previous color\n    this.dH = null; // draw hook\n    this.cH = null; // change hook\n    this.eH = null; // cancel hook\n    this.rH = null; // release hook\n    this.scale = 1; // scale factor\n    this.relative = false;\n    this.relativeWidth = false;\n    this.relativeHeight = false;\n    this.$div = null; // component div\n\n    this.run = function () {\n      var cf = function cf(e, conf) {\n        var k;\n        for (k in conf) {\n          s.o[k] = conf[k];\n        }\n        s._carve().init();\n        s._configure().\n        _draw();\n      };\n\n      if (this.$.data('kontroled')) return;\n      this.$.data('kontroled', true);\n\n      this.extend();\n      this.o = $.extend({\n        // Config\n        min: this.$.data('min') !== undefined ? this.$.data('min') : 0,\n        max: this.$.data('max') !== undefined ? this.$.data('max') : 100,\n        stopper: true,\n        readOnly: this.$.data('readonly') || this.$.attr('readonly') === 'readonly',\n\n        // UI\n        cursor: this.$.data('cursor') === true && 30 ||\n        this.$.data('cursor') || 0,\n        thickness: this.$.data('thickness') &&\n        Math.max(Math.min(this.$.data('thickness'), 1), 0.01) ||\n        0.35,\n        lineCap: this.$.data('linecap') || 'butt',\n        width: this.$.data('width') || 200,\n        height: this.$.data('height') || 200,\n        displayInput: this.$.data('displayinput') == null || this.$.data('displayinput'),\n        displayPrevious: this.$.data('displayprevious'),\n        fgColor: this.$.data('fgcolor') || '#87CEEB',\n        inputColor: this.$.data('inputcolor'),\n        font: this.$.data('font') || 'Arial',\n        fontWeight: this.$.data('font-weight') || 'bold',\n        inline: false,\n        step: this.$.data('step') || 1,\n        rotation: this.$.data('rotation'),\n\n        // Hooks\n        draw: null, // function () {}\n        change: null, // function (value) {}\n        cancel: null, // function () {}\n        release: null, // function (value) {}\n\n        // Output formatting, allows to add unit: %, ms ...\n        format: function format(v) {\n          return v;\n        },\n        parse: function parse(v) {\n          return parseFloat(v);\n        } },\n      this.o);\n\n\n      // finalize options\n      this.o.flip = this.o.rotation === 'anticlockwise' || this.o.rotation === 'acw';\n      if (!this.o.inputColor) {\n        this.o.inputColor = this.o.fgColor;\n      }\n\n      // routing value\n      if (this.$.is('fieldset')) {\n\n        // fieldset = array of integer\n        this.v = {};\n        this.i = this.$.find('input');\n        this.i.each(function (k) {\n          var $this = $(this);\n          s.i[k] = $this;\n          s.v[k] = s.o.parse($this.val());\n\n          $this.bind(\n          'change blur',\n          function () {\n            var val = {};\n            val[k] = $this.val();\n            s.val(s._validate(val));\n          });\n\n        });\n        this.$.find('legend').remove();\n      } else {\n\n        // input = integer\n        this.i = this.$;\n        this.v = this.o.parse(this.$.val());\n        this.v === '' && (this.v = this.o.min);\n        this.$.bind(\n        'change blur',\n        function () {\n          s.val(s._validate(s.o.parse(s.$.val())));\n        });\n\n\n      }\n\n      !this.o.displayInput && this.$.hide();\n\n      // adds needed DOM elements (canvas, div)\n      this.$c = $(document.createElement('canvas')).attr({\n        width: this.o.width,\n        height: this.o.height });\n\n\n      // wraps all elements in a div\n      // add to DOM before Canvas init is triggered\n      this.$div = $('<div style=\"' + (\n      this.o.inline ? 'display:inline;' : '') +\n      'width:' + this.o.width + 'px;height:' + this.o.height + 'px;' +\n      '\"></div>');\n\n      this.$.wrap(this.$div).before(this.$c);\n      this.$div = this.$.parent();\n\n      if (typeof G_vmlCanvasManager !== 'undefined') {\n        G_vmlCanvasManager.initElement(this.$c[0]);\n      }\n\n      this.c = this.$c[0].getContext ? this.$c[0].getContext('2d') : null;\n\n      if (!this.c) {\n        throw {\n          name: \"CanvasNotSupportedException\",\n          message: \"Canvas not supported. Please use excanvas on IE8.0.\",\n          toString: function toString() {return this.name + \": \" + this.message;} };\n\n      }\n\n      // hdpi support\n      this.scale = (window.devicePixelRatio || 1) / (\n      this.c.webkitBackingStorePixelRatio ||\n      this.c.mozBackingStorePixelRatio ||\n      this.c.msBackingStorePixelRatio ||\n      this.c.oBackingStorePixelRatio ||\n      this.c.backingStorePixelRatio || 1);\n\n\n      // detects relative width / height\n      this.relativeWidth = this.o.width % 1 !== 0 &&\n      this.o.width.indexOf('%');\n      this.relativeHeight = this.o.height % 1 !== 0 &&\n      this.o.height.indexOf('%');\n      this.relative = this.relativeWidth || this.relativeHeight;\n\n      // computes size and carves the component\n      this._carve();\n\n      // prepares props for transaction\n      if (this.v instanceof Object) {\n        this.cv = {};\n        this.copy(this.v, this.cv);\n      } else {\n        this.cv = this.v;\n      }\n\n      // binds configure event\n      this.$.\n      bind(\"configure\", cf).\n      parent().\n      bind(\"configure\", cf);\n\n      // finalize init\n      this._listen().\n      _configure().\n      _xy().\n      init();\n\n      this.isInit = true;\n\n      this.$.val(this.o.format(this.v));\n      this._draw();\n\n      return this;\n    };\n\n    this._carve = function () {\n      if (this.relative) {\n        var w = this.relativeWidth ?\n        this.$div.parent().width() *\n        parseInt(this.o.width) / 100 :\n        this.$div.parent().width(),\n        h = this.relativeHeight ?\n        this.$div.parent().height() *\n        parseInt(this.o.height) / 100 :\n        this.$div.parent().height();\n\n        // apply relative\n        this.w = this.h = Math.min(w, h);\n      } else {\n        this.w = this.o.width;\n        this.h = this.o.height;\n      }\n\n      // finalize div\n      this.$div.css({\n        'width': this.w + 'px',\n        'height': this.h + 'px' });\n\n\n      // finalize canvas with computed width\n      this.$c.attr({\n        width: this.w,\n        height: this.h });\n\n\n      // scaling\n      if (this.scale !== 1) {\n        this.$c[0].width = this.$c[0].width * this.scale;\n        this.$c[0].height = this.$c[0].height * this.scale;\n        this.$c.width(this.w);\n        this.$c.height(this.h);\n      }\n\n      return this;\n    };\n\n    this._draw = function () {\n\n      // canvas pre-rendering\n      var d = true;\n\n      s.g = s.c;\n\n      s.clear();\n\n      s.dH && (d = s.dH());\n\n      d !== false && s.draw();\n    };\n\n    this._touch = function (e) {\n      var touchMove = function touchMove(e) {\n        var v = s.xy2val(\n        e.originalEvent.touches[s.t].pageX,\n        e.originalEvent.touches[s.t].pageY);\n\n\n        if (v == s.cv) return;\n\n        if (s.cH && s.cH(v) === false) return;\n\n        s.change(s._validate(v));\n        s._draw();\n      };\n\n      // get touches index\n      this.t = k.c.t(e);\n\n      // First touch\n      touchMove(e);\n\n      // Touch events listeners\n      k.c.d.\n      bind(\"touchmove.k\", touchMove).\n      bind(\n      \"touchend.k\",\n      function () {\n        k.c.d.unbind('touchmove.k touchend.k');\n        s.val(s.cv);\n      });\n\n\n      return this;\n    };\n\n    this._mouse = function (e) {\n      var mouseMove = function mouseMove(e) {\n        var v = s.xy2val(e.pageX, e.pageY);\n\n        if (v == s.cv) return;\n\n        if (s.cH && s.cH(v) === false) return;\n\n        s.change(s._validate(v));\n        s._draw();\n      };\n\n      // First click\n      mouseMove(e);\n\n      // Mouse events listeners\n      k.c.d.\n      bind(\"mousemove.k\", mouseMove).\n      bind(\n      // Escape key cancel current change\n      \"keyup.k\",\n      function (e) {\n        if (e.keyCode === 27) {\n          k.c.d.unbind(\"mouseup.k mousemove.k keyup.k\");\n\n          if (s.eH && s.eH() === false)\n          return;\n\n          s.cancel();\n        }\n      }).\n\n      bind(\n      \"mouseup.k\",\n      function (e) {\n        k.c.d.unbind('mousemove.k mouseup.k keyup.k');\n        s.val(s.cv);\n      });\n\n\n      return this;\n    };\n\n    this._xy = function () {\n      var o = this.$c.offset();\n      this.x = o.left;\n      this.y = o.top;\n\n      return this;\n    };\n\n    this._listen = function () {\n      if (!this.o.readOnly) {\n        this.$c.\n        bind(\n        \"mousedown\",\n        function (e) {\n          e.preventDefault();\n          s._xy()._mouse(e);\n        }).\n\n        bind(\n        \"touchstart\",\n        function (e) {\n          e.preventDefault();\n          s._xy()._touch(e);\n        });\n\n\n        this.listen();\n      } else {\n        this.$.attr('readonly', 'readonly');\n      }\n\n      if (this.relative) {\n        $(window).resize(function () {\n          s._carve().init();\n          s._draw();\n        });\n      }\n\n      return this;\n    };\n\n    this._configure = function () {\n\n      // Hooks\n      if (this.o.draw) this.dH = this.o.draw;\n      if (this.o.change) this.cH = this.o.change;\n      if (this.o.cancel) this.eH = this.o.cancel;\n      if (this.o.release) this.rH = this.o.release;\n\n      if (this.o.displayPrevious) {\n        this.pColor = this.h2rgba(this.o.fgColor, \"0.4\");\n        this.fgColor = this.h2rgba(this.o.fgColor, \"0.6\");\n      } else {\n        this.fgColor = this.o.fgColor;\n      }\n\n      return this;\n    };\n\n    this._clear = function () {\n      this.$c[0].width = this.$c[0].width;\n    };\n\n    this._validate = function (v) {\n      var val = ~~((v < 0 ? -0.5 : 0.5) + v / this.o.step) * this.o.step;\n      return Math.round(val * 100) / 100;\n    };\n\n    // Abstract methods\n    this.listen = function () {}; // on start, one time\n    this.extend = function () {}; // each time configure triggered\n    this.init = function () {}; // each time configure triggered\n    this.change = function (v) {}; // on change\n    this.val = function (v) {}; // on release\n    this.xy2val = function (x, y) {}; //\n    this.draw = function () {}; // on change / on release\n    this.clear = function () {this._clear();};\n\n    // Utils\n    this.h2rgba = function (h, a) {\n      var rgb;\n      h = h.substring(1, 7);\n      rgb = [\n      parseInt(h.substring(0, 2), 16),\n      parseInt(h.substring(2, 4), 16),\n      parseInt(h.substring(4, 6), 16)];\n\n\n      return \"rgba(\" + rgb[0] + \",\" + rgb[1] + \",\" + rgb[2] + \",\" + a + \")\";\n    };\n\n    this.copy = function (f, t) {\n      for (var i in f) {\n        t[i] = f[i];\n      }\n    };\n  };\n\n\n  /**\n      * k.Dial\n      */\n  k.Dial = function () {\n    k.o.call(this);\n\n    this.startAngle = null;\n    this.xy = null;\n    this.radius = null;\n    this.lineWidth = null;\n    this.cursorExt = null;\n    this.w2 = null;\n    this.PI2 = 2 * Math.PI;\n\n    this.extend = function () {\n      this.o = $.extend({\n        bgColor: this.$.data('bgcolor') || '#EEEEEE',\n        angleOffset: this.$.data('angleoffset') || 0,\n        angleArc: this.$.data('anglearc') || 360,\n        inline: true },\n      this.o);\n    };\n\n    this.val = function (v, triggerRelease) {\n      if (null != v) {\n\n        // reverse format\n        v = this.o.parse(v);\n\n        if (triggerRelease !== false &&\n        v != this.v &&\n        this.rH &&\n        this.rH(v) === false) {return;}\n\n        this.cv = this.o.stopper ? max(min(v, this.o.max), this.o.min) : v;\n        this.v = this.cv;\n        this.$.val(this.o.format(this.v));\n        this._draw();\n      } else {\n        return this.v;\n      }\n    };\n\n    this.xy2val = function (x, y) {\n      var a, ret;\n\n      a = Math.atan2(\n      x - (this.x + this.w2),\n      -(y - this.y - this.w2)) -\n      this.angleOffset;\n\n      if (this.o.flip) {\n        a = this.angleArc - a - this.PI2;\n      }\n\n      if (this.angleArc != this.PI2 && a < 0 && a > -0.5) {\n\n        // if isset angleArc option, set to min if .5 under min\n        a = 0;\n      } else if (a < 0) {\n        a += this.PI2;\n      }\n\n      ret = a * (this.o.max - this.o.min) / this.angleArc + this.o.min;\n\n      this.o.stopper && (ret = max(min(ret, this.o.max), this.o.min));\n\n      return ret;\n    };\n\n    this.listen = function () {\n\n      // bind MouseWheel\n      var s = this,mwTimerStop,\n      mwTimerRelease,\n      mw = function mw(e) {\n        e.preventDefault();\n\n        var ori = e.originalEvent,\n        deltaX = ori.detail || ori.wheelDeltaX,\n        deltaY = ori.detail || ori.wheelDeltaY,\n        v = s._validate(s.o.parse(s.$.val())) + (\n\n        deltaX > 0 || deltaY > 0 ?\n        s.o.step :\n        deltaX < 0 || deltaY < 0 ? -s.o.step : 0);\n\n\n        v = max(min(v, s.o.max), s.o.min);\n\n        s.val(v, false);\n\n        if (s.rH) {\n          // Handle mousewheel stop\n          clearTimeout(mwTimerStop);\n          mwTimerStop = setTimeout(function () {\n            s.rH(v);\n            mwTimerStop = null;\n          }, 100);\n\n          // Handle mousewheel releases\n          if (!mwTimerRelease) {\n            mwTimerRelease = setTimeout(function () {\n              if (mwTimerStop)\n              s.rH(v);\n              mwTimerRelease = null;\n            }, 200);\n          }\n        }\n      },\n      kval,\n      to,\n      m = 1,\n      kv = {\n        37: -s.o.step,\n        38: s.o.step,\n        39: s.o.step,\n        40: -s.o.step };\n\n\n      this.$.\n      bind(\n      \"keydown\",\n      function (e) {\n        var kc = e.keyCode;\n\n        // numpad support\n        if (kc >= 96 && kc <= 105) {\n          kc = e.keyCode = kc - 48;\n        }\n\n        kval = parseInt(String.fromCharCode(kc));\n\n        if (isNaN(kval)) {\n          kc !== 13 && // enter\n          kc !== 8 // bs\n          && kc !== 9 // tab\n          && kc !== 189 // -\n          && (kc !== 190 ||\n          s.$.val().match(/\\./)) // . allowed once\n          && e.preventDefault();\n\n          // arrows\n          if ($.inArray(kc, [37, 38, 39, 40]) > -1) {\n            e.preventDefault();\n\n            var v = s.o.parse(s.$.val()) + kv[kc] * m;\n            s.o.stopper && (v = max(min(v, s.o.max), s.o.min));\n\n            s.change(s._validate(v));\n            s._draw();\n\n            // long time keydown speed-up\n            to = window.setTimeout(function () {\n              m *= 2;\n            }, 30);\n          }\n        }\n      }).\n\n      bind(\n      \"keyup\",\n      function (e) {\n        if (isNaN(kval)) {\n          if (to) {\n            window.clearTimeout(to);\n            to = null;\n            m = 1;\n            s.val(s.$.val());\n          }\n        } else {\n          // kval postcond\n          s.$.val() > s.o.max && s.$.val(s.o.max) ||\n          s.$.val() < s.o.min && s.$.val(s.o.min);\n        }\n      });\n\n\n      this.$c.bind(\"mousewheel DOMMouseScroll\", mw);\n      this.$.bind(\"mousewheel DOMMouseScroll\", mw);\n    };\n\n    this.init = function () {\n      if (this.v < this.o.min ||\n      this.v > this.o.max) {this.v = this.o.min;}\n\n      this.$.val(this.v);\n      this.w2 = this.w / 2;\n      this.cursorExt = this.o.cursor / 100;\n      this.xy = this.w2 * this.scale;\n      this.lineWidth = this.xy * this.o.thickness;\n      this.lineCap = this.o.lineCap;\n      this.radius = this.xy - this.lineWidth / 2;\n\n      this.o.angleOffset && (\n      this.o.angleOffset = isNaN(this.o.angleOffset) ? 0 : this.o.angleOffset);\n\n      this.o.angleArc && (\n      this.o.angleArc = isNaN(this.o.angleArc) ? this.PI2 : this.o.angleArc);\n\n      // deg to rad\n      this.angleOffset = this.o.angleOffset * Math.PI / 180;\n      this.angleArc = this.o.angleArc * Math.PI / 180;\n\n      // compute start and end angles\n      this.startAngle = 1.5 * Math.PI + this.angleOffset;\n      this.endAngle = 1.5 * Math.PI + this.angleOffset + this.angleArc;\n\n      var s = max(\n      String(Math.abs(this.o.max)).length,\n      String(Math.abs(this.o.min)).length,\n      2) +\n      2;\n\n      this.o.displayInput &&\n      this.i.css({\n        'width': (this.w / 2 + 4 >> 0) + 'px',\n        'height': (this.w / 3 >> 0) + 'px',\n        'position': 'absolute',\n        'vertical-align': 'middle',\n        'margin-top': (this.w / 3 >> 0) + 'px',\n        'margin-left': '-' + (this.w * 3 / 4 + 2 >> 0) + 'px',\n        'border': 0,\n        'background': 'none',\n        'font': this.o.fontWeight + ' ' + (this.w / s >> 0) + 'px ' + this.o.font,\n        'text-align': 'center',\n        'color': this.o.inputColor || this.o.fgColor,\n        'padding': '0px',\n        '-webkit-appearance': 'none' }) ||\n      this.i.css({\n        'width': '0px',\n        'visibility': 'hidden' });\n\n    };\n\n    this.change = function (v) {\n      this.cv = v;\n      this.$.val(this.o.format(v));\n    };\n\n    this.angle = function (v) {\n      return (v - this.o.min) * this.angleArc / (this.o.max - this.o.min);\n    };\n\n    this.arc = function (v) {\n      var sa, ea;\n      v = this.angle(v);\n      if (this.o.flip) {\n        sa = this.endAngle + 0.00001;\n        ea = sa - v - 0.00001;\n      } else {\n        sa = this.startAngle - 0.00001;\n        ea = sa + v + 0.00001;\n      }\n      this.o.cursor && (\n      sa = ea - this.cursorExt) && (\n      ea = ea + this.cursorExt);\n\n      return {\n        s: sa,\n        e: ea,\n        d: this.o.flip && !this.o.cursor };\n\n    };\n\n    this.draw = function () {\n      var c = this.g, // context\n      a = this.arc(this.cv), // Arc\n      pa, // Previous arc\n      r = 1;\n\n      c.lineWidth = this.lineWidth;\n      c.lineCap = this.lineCap;\n\n      if (this.o.bgColor !== \"none\") {\n        c.beginPath();\n        c.strokeStyle = this.o.bgColor;\n        c.arc(this.xy, this.xy, this.radius, this.endAngle - 0.00001, this.startAngle + 0.00001, true);\n        c.stroke();\n      }\n\n      if (this.o.displayPrevious) {\n        pa = this.arc(this.v);\n        c.beginPath();\n        c.strokeStyle = this.pColor;\n        c.arc(this.xy, this.xy, this.radius, pa.s, pa.e, pa.d);\n        c.stroke();\n        r = this.cv == this.v;\n      }\n\n      c.beginPath();\n      c.strokeStyle = r ? this.o.fgColor : this.fgColor;\n      c.arc(this.xy, this.xy, this.radius, a.s, a.e, a.d);\n      c.stroke();\n    };\n\n    this.cancel = function () {\n      this.val(this.v);\n    };\n  };\n\n  $.fn.dial = $.fn.knob = function (o) {\n    return this.each(\n    function () {\n      var d = new k.Dial();\n      d.o = o;\n      d.$ = $(this);\n      d.run();\n    }).\n    parent();\n  };\n})($);","/*\r\n *   Name: Bizagi Workportal Desktop  plan filters controller\r\n *   Author: Iván Ricardo Taimal Narváez\r\n */\n\nbizagi.workportal.widgets.widget.extend('bizagi.workportal.widgets.plans.filters', {}, {\n\n\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    self.params = params;\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.plansLinks = bizagi.injector.get('bizagi.workportal.widgets.decontextualized.plans', params);\n\n    //Load templates\n    self.loadTemplates({\n      'plans.filters.wrapper': bizagi.getTemplate('bizagi.workportal.desktop.widget.decontextualized.plans.filters').concat('#plans-filter-wrapper') });\n\n\n  },\n\n\n  renderContent: function renderContent() {\n    var self = this,\n    data,\n    filteredData = {},\n    template;\n    template = self.getTemplate('plans.filters.wrapper');\n    data = self.getData();\n    filteredData.items = data.items;\n    self.content = template.render(filteredData);\n\n    return self.content;\n  },\n\n\n  postRender: function postRender() {\n    var self = this;\n    self.configureHandlers();\n  },\n\n  setSelectedFilter: function setSelectedFilter(item) {\n    $(item).addClass(\"wdg-ftr-selected\").siblings().removeClass(\"wdg-ftr-selected\");\n  },\n\n  onLoadPlansView: function onLoadPlansView(event, params) {\n    var self = this;\n    self.setSelectedFilter($(\".wdg-plan-filter-card[data-data='\" + params.args.planState + \"']\", self.content));\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this,\n    $content = self.getContent();\n    $('.wdg-plan-filter-card', $content).on('click', $.proxy(self.onClickFilter, self));\n    self.sub('PLANS-VIEW', $.proxy(self.onLoadPlansView, self));\n  },\n\n  clean: function clean() {\n    var self = this,\n    $content = self.getContent();\n\n    if ($content) {\n      $('.wdg-plan-filter-card', $content).off('click');\n    }\n    self.unsub('PLANS-VIEW', $.proxy(self.onLoadPlansView, self));\n  },\n\n\n  getData: function getData() {\n    var self = this;\n    return self.plansLinks.getData();\n  },\n\n  onClickFilter: function onClickFilter(ev) {\n    var self = this,\n    target = $(ev.target).closest('.wdg-plan-filter-card'),\n    title = target.data('title'),\n    data = target.data('data'),\n    icon = data.toLowerCase();\n\n    self.setSelectedFilter(target);\n\n    var args = {\n      histName: title,\n      planState: data,\n      level: 1 };\n\n    self.pub('notify', {\n      type: 'PLANS-VIEW',\n      args: $.extend(self.params, args) });\n\n  } });\n\n\n\n\nbizagi.injector.register('bizagi.workportal.widgets.plans.filters', ['workportalFacade', 'dataService', bizagi.workportal.widgets.plans.filters]);","/*\r\n *   Name: Bizagi Workportal Project File Sidebar\r\n *   Author: David Romero Estrada\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activities.sidebar\", {}, {\n\n  /*\r\n                                                                                                           *   Constructor\r\n                                                                                                           */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    params = params || {};\n\n    //Load templates\n    self.loadTemplates({\n      \"project-plan-activities-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activities.sidebar\").concat(\"#project-plan-activities-sidebar\") });\n\n\n  },\n\n  /*\r\n     * Renders the template defined in the widget\r\n     */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-plan-activities-sidebar\");\n    self.content = template.render({});\n\n    return self.content;\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.activities.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.plan.activities.sidebar], true);","/**\r\n * Name: Bizagi Workportal Desktop Create plan\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.create\", {}, {\n  /**\r\n                                                                                                * Constructor\r\n                                                                                                */\n  init: function init(workportalFacade, dataService, notifier, params) {\n    var self = this;\n    self.params = params;\n    self.contextualized;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n    self.notifier = notifier;\n\n    //Load template\n    self.loadTemplates({\n      \"plan-create\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.plan.create\").concat(\"#plan-create\") });\n\n\n    self.dialogBox = {};\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.initPlugins();\n  },\n\n  initPlugins: function initPlugins() {\n    var self = this,\n    template = self.getTemplate('plan-create');\n    self.dialogBox.formContent = template.render({});\n    self.dialogBox.elements = {\n      inputName: $('#input-name-plan', self.dialogBox.formContent),\n      inputTemplate: $('#templates-plan', self.dialogBox.formContent),\n      buttonSave: $('#button-accept-create-plan', self.dialogBox.formContent),\n      buttonCancel: $('#button-cancel-create-plan', self.dialogBox.formContent) };\n\n    self.dialogBox.elements.buttonSave.on('click', $.proxy(self.onClickSavePlan, self));\n    self.dialogBox.elements.buttonCancel.on('click', $.proxy(self.closeDialogBox, self));\n\n    self.notifier = bizagi.injector.get('notifier');\n  },\n\n  closeDialogBox: function closeDialogBox() {\n    var self = this;\n    self.dialogBox.formContent.dialog('destroy');\n    self.dialogBox.formContent.detach();\n    self.dialogBox.templateGuid = '';\n  },\n\n  showPopupAddPlan: function showPopupAddPlan(params, dataService, contextualized) {\n    var self = this;\n    self.params = params;\n    self.dataService = dataService;\n    self.contextualized = contextualized;\n    self.content = $(\"<div></div>\");\n    self.initPlugins();\n\n    self.dialogBox.elements.inputTemplate.html('');\n    self.dataService.getTemplatesByParentWorkItem({ parentWorkItem: params.guidWorkItem }).done(function (data) {\n      var comboDataSource = { combo: [], id: 'templates' };\n      comboDataSource.combo = data;\n      self.dialogBox.elements.inputTemplate.uicombo({\n        isEditable: false,\n        data: comboDataSource,\n        itemValue: function itemValue(obj) {\n          return obj.id;\n        },\n        itemText: function itemText(obj) {\n          return obj.name;\n        },\n        onChange: function onChange(obj) {\n          var value = obj.ui.data('value');\n          self.dialogBox.elements.inputTemplate.val(value);\n          self.dialogBox.templateGuid = value;\n        }, css: 'display: none' });\n\n\n      self.dialogBox.elements.inputTemplate.keydown(function () {\n        if (event.keyCode == 8 || event.keyCode == 46) {\n          event.preventDefault();\n          self.dialogBox.templateGuid = '';\n          self.dialogBox.elements.inputTemplate.val('');\n          $('input', self.dialogBox.elements.inputTemplate).val('');\n        }\n      });\n\n      if (data.length > 0) {\n        $(\".field-template\", self.dialogBox.formContent).show();\n      } else\n      {\n        $(\".field-template\", self.dialogBox.formContent).hide();\n      }\n    }).fail(function () {\n      $(\".field-template\", self.dialogBox.formContent).hide();\n    });\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: 'auto',\n      width: '600px',\n      modal: true,\n      title: bizagi.localization.getResource('workportal-project-plan-popup-title-add-plan'),\n      maximize: false,\n      close: function close() {\n        self.dialogBox.formContent.dialog('destroy');\n        self.dialogBox.formContent.detach();\n      } });\n\n  },\n\n  onClickSavePlan: function onClickSavePlan(event) {\n    event.preventDefault();\n    var self = this;\n    if (self.validateParams()) {\n      self.createNewPlan();\n    }\n\n  },\n\n  createNewPlan: function createNewPlan() {\n    var self = this;\n    var parentWorkItemRaw = self.params.guidWorkItem || null;\n\n    var paramsNewPlan = {\n      idUserCreator: bizagi.currentUser.idUser,\n      id: undefined,\n      startDate: null,\n      creationDate: null,\n      parentWorkItem: parentWorkItemRaw,\n      description: null,\n      currentState: 'PENDING',\n      name: self.dialogBox.elements.inputName.val(),\n      waitForCompletion: true,\n      dueDate: null,\n      contextualized: self.contextualized,\n      idTemplate: self.dialogBox.templateGuid };\n\n    $.when(self.sendDataInsertPlan(paramsNewPlan)).then(function (response) {\n      paramsNewPlan = $.extend(paramsNewPlan, { id: response.id });\n      paramsNewPlan.activities = [];\n      paramsNewPlan.users = [];\n\n      //Set security menuDashboard\n      var servicesPD = new bizagi.workportal.services.behaviors.projectDashboard(self.dataService);\n      self.params.menuPlanDashboard = {};\n      self.params.menuPlanDashboard.showCommentsOptionMenu =\n      servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonComments;\n      self.params.menuPlanDashboard.showFilesOptionMenu =\n      servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonFiles;\n      self.params.menuPlanDashboard.showTimeLineOptionMenu =\n      servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonTimeLine;\n\n      //XSS Security\n      paramsNewPlan.name = bizagi.util.encodeHtml(paramsNewPlan.name);\n\n      $.when(servicesPD.getFirstParentInfo(paramsNewPlan.id, paramsNewPlan.contextualized)).done(function (response) {\n        var args = {\n          paramsNewPlan: paramsNewPlan,\n          radNumber: response.id,\n          hasDiscussionsOrComment: response.hasDiscussionsOrComment };\n\n\n        self.pub('planCreated', args);\n\n        self.closeDialogBox();\n        self.notifier.showSucessMessage(printf(bizagi.localization.getResource('workportal-project-plan-created'), ''));\n      });\n    });\n  },\n\n  validateParams: function validateParams() {\n    var self = this;\n    var name = self.dialogBox.elements.inputName;\n    if (name.val() && name.val() !== '') {\n      return true;\n    } else {\n      var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\n      name.next().find('span').html(nameValidation);\n      return false;\n    }\n  },\n\n  sendDataInsertPlan: function sendDataInsertPlan(params) {\n    var self = this;\n    var defer = $.Deferred();\n    $.when(self.dataService.postPlan(params)).always(function (response, responseText, xhr) {\n      if (xhr.status === 201) {\n        defer.resolve(response);\n      } else\n      {\n        defer.reject();\n      }\n    });\n    return defer.promise();\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.create', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.project.plan.create]);","/**\r\n * Name: Bizagi Workportal Desktop Edit plan\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.edit\", {}, {\n  /**\r\n                                                                                              * Constructor\r\n                                                                                              */\n  init: function init(workportalFacade, dataService, notifier, params) {\n    var self = this;\n    self.params = params;\n    self.planToEdit;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n    self.notifier = notifier;\n\n    //Load template\n    self.loadTemplates({\n      'plans.manager.popup.edit.plan': bizagi.getTemplate('bizagi.workportal.desktop.widgets.project.plan.edit').concat('#plans-manager-popup-edit-plan') });\n\n\n    self.editDialogBox = {};\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n  },\n\n  closeEditDialogBox: function closeEditDialogBox() {\n    var self = this;\n    self.editDialogBox.elements.inputDueDate.datepicker(\"destroy\");\n    self.editDialogBox.formContent.dialog('destroy');\n    self.editDialogBox.formContent.detach();\n  },\n\n  showPopup: function showPopup(params, dataService, planToEdit) {\n    var self = this;\n    var defer = $.Deferred();\n    self.planToEdit = planToEdit;\n    self.initEditDialogBox(planToEdit);\n    self.editDialogBox.elements.inputName.val(bizagi.util.decodeHtmlEntities(planToEdit.name));\n    self.editDialogBox.elements.inputDesc.val(bizagi.util.decodeHtmlEntities(planToEdit.description));\n    self.editDialogBox.elements.inputWaitForCompletion.prop(\"checked\", planToEdit.waitForCompletion);\n    self.editDialogBox.elements.inputDueDate.datepicker();\n    self.editDialogBox.elements.inputDueDate.datepicker(\"option\", \"dateFormat\", bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI());\n    if (planToEdit.dueDate) {\n      self.editDialogBox.elements.inputDueDate.datepicker('setDate', new Date(planToEdit.dueDate));\n    }\n    self.editDialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: 'auto',\n      width: '600px',\n      modal: true,\n      title: bizagi.localization.getResource('workportal-project-plan-editplan'),\n      maximize: true,\n      close: function close(ev, ui) {\n        self.editDialogBox.elements.inputDueDate.datepicker(\"destroy\");\n        self.editDialogBox.formContent.dialog('destroy');\n        self.editDialogBox.formContent.detach();\n        defer.resolve();\n      } });\n\n    return defer.promise();\n  },\n\n  initEditDialogBox: function initEditDialogBox(plan) {\n    var self = this,\n    editPlanTemplate = self.getTemplate('plans.manager.popup.edit.plan');\n    self.editDialogBox.formContent = editPlanTemplate.render(plan);\n    self.editDialogBox.elements = {\n      inputName: $('#input-name-plan', self.editDialogBox.formContent),\n      inputDesc: $('#input-desc-plan', self.editDialogBox.formContent),\n      inputDueDate: $('#input-dueDate-plan', self.editDialogBox.formContent),\n      inputWaitForCompletion: $('#input-waitForCompletion', self.editDialogBox.formContent),\n      buttonSave: $('#button-accept-edit-plan', self.editDialogBox.formContent),\n      buttonCancel: $('#button-cancel-edit-plan', self.editDialogBox.formContent) };\n\n    self.editDialogBox.elements.buttonSave.on('click', $.proxy(self.saveEditedPlan, self));\n    self.editDialogBox.elements.buttonCancel.on('click', $.proxy(self.closeEditDialogBox, self));\n  },\n\n\n  saveEditedPlan: function saveEditedPlan(event) {\n    event.preventDefault();\n    var self = this;\n    if (self.validateEditDialogBoxParams()) {\n      $.when(self.getParamsUpdatePlan()).done(function (updateParams) {\n        $.when(self.dataService.updatePlan(updateParams)).done(function () {\n          self.closeEditDialogBox();\n          self.pub('planEditedSuccess', {\n            paramsEditPlan: updateParams });\n\n\n        }).fail(function () {\n          self.pub('planEditedFailed');\n        });\n      });\n    }\n  },\n\n  getParamsUpdatePlan: function getParamsUpdatePlan() {\n    var self = this;\n    var defer = $.Deferred();\n    var updateParams = {};\n    updateParams = self.planToEdit;\n\n    updateParams.name = self.editDialogBox.elements.inputName.val();\n    updateParams.description = self.editDialogBox.elements.inputDesc.val();\n    if (self.editDialogBox.elements.inputWaitForCompletion.length !== 0) {\n      updateParams.waitForCompletion = self.editDialogBox.elements.inputWaitForCompletion.prop(\"checked\");\n    }\n\n    var dueDateRaw = self.editDialogBox.elements.inputDueDate.datepicker('getDate');\n    if (dueDateRaw) {\n      var params = {\n        idUser: bizagi.currentUser.idUser,\n        date: dueDateRaw.getTime() };\n\n      $.when(self.dataService.getEndHourWorkingByDate(params)).done(function (data) {\n        updateParams.dueDate = data.dateTime;\n        defer.resolve(updateParams);\n      });\n    } else\n    {\n      defer.resolve(updateParams);\n    }\n\n    return defer.promise();\n  },\n\n\n  validateEditDialogBoxParams: function validateEditDialogBoxParams() {\n    var self = this;\n    var name = self.editDialogBox.elements.inputName;\n    if (name.val() && name.val() !== '') {\n      return true;\n    } else {\n      var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\n      name.next().find('span').html(nameValidation);\n      return false;\n    }\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.edit', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.project.plan.edit], true);","/**\r\n * Name: Bizagi Workportal Desktop Create plan template\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.template.create\", {}, {\n  /**\r\n                                                                                                         * Constructor\r\n                                                                                                         */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    self.params = params;\n    self.contextualized;\n    self.idPlanSelected;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load template\n    self.loadTemplates({\n      \"plan-template-create\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.plan.template.create\").concat(\"#plan-template-create\") });\n\n\n    self.dialogBox = {};\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.initPlugins();\n  },\n\n  initPlugins: function initPlugins() {\n    var self = this,\n    template = self.getTemplate('plan-template-create');\n    self.dialogBox.formContent = template.render({});\n    self.dialogBox.elements = {\n      inputName: $('#input-name-template', self.dialogBox.formContent),\n      buttonSave: $('#button-accept-create-template', self.dialogBox.formContent),\n      buttonCancel: $('#button-cancel-create-template', self.dialogBox.formContent) };\n\n    self.dialogBox.elements.buttonSave.on('click', $.proxy(self.onClickSaveTemplate, self));\n    self.dialogBox.elements.buttonCancel.on('click', $.proxy(self.closeDialogBox, self));\n  },\n\n  closeDialogBox: function closeDialogBox() {\n    var self = this;\n    self.dialogBox.formContent.dialog('destroy');\n    self.dialogBox.formContent.detach();\n  },\n\n  showPopupAddTemplatePlan: function showPopupAddTemplatePlan(params, dataService, contextualized, idPlanSelected) {\n    var self = this;\n    self.params = params;\n    self.dataService = dataService;\n    self.contextualized = contextualized;\n    self.idPlanSelected = idPlanSelected;\n    self.content = $(\"<div></div>\");\n    self.initPlugins();\n\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: 'auto',\n      width: '600px',\n      modal: true,\n      title: bizagi.localization.getResource('workportal-project-plan-action-popup-save-as-template'),\n      maximize: false,\n      close: function close(ev, ui) {\n        self.dialogBox.formContent.dialog('destroy');\n        self.dialogBox.formContent.detach();\n      } });\n\n  },\n\n  onClickSaveTemplate: function onClickSaveTemplate(event) {\n    event.preventDefault();\n    var self = this;\n\n    if (self.validateSaveDialogBoxParams()) {\n      var params = {\n        idPlan: self.idPlanSelected,\n        name: self.dialogBox.elements.inputName.val() };\n\n      $.when(self.dataService.createTemplateByPlan(params)).done(function () {\n        self.closeDialogBox();\n        self.pub('planTemplateCreatedSuccess', {});\n      }).fail(function () {\n        self.pub('planTemplateCreatedFailed', {});\n      });\n    }\n\n  },\n\n  validateSaveDialogBoxParams: function validateSaveDialogBoxParams() {\n    var self = this;\n    var name = self.dialogBox.elements.inputName;\n    if (name.val() && name.val() !== '') {\n      return true;\n    } else {\n      var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\n      name.next().find('span').html(nameValidation);\n      return false;\n    }\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.template.create', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.plan.template.create]);","/**\r\n* Name: BizAgi Desktop Widget Reassing Case\r\n* @author NAN\r\n*/\n\n\nbizagi.workportal.widgets.admin.caseSearch.extend(\"bizagi.workportal.widgets.reassigncase\", {}, {\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"admin.case.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search\"),\n      \"admin.case.search.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-fields\"),\n      \"admin.case.search.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-buttons\"),\n      \"admin.case.search.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-result\"),\n      \"admin.case.search.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-pagination\"),\n      \"admin.case.search.invalidate\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-invalidate\"),\n      \"admin.case.search.reassign\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign\"),\n      \"admin.case.search.reassign.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign-form\"),\n      \"admin.case.search.action.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-action-result\"),\n      useNewEngine: false });\n\n  },\n  getWidgetName: function getWidgetName() {\n    return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE;\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate(\"admin.case.search\");\n    var content;\n\n    content = self.content = $.tmpl(template, {});\n    self.loadtemplates();\n    return content;\n  },\n\n\n  loadtemplates: function loadtemplates() {\n    var self = this;\n\n    //Template vars \n    self.generalContentTmpl = self.getTemplate(\"admin.case.search\");\n    self.fieldsContentTmpl = self.getTemplate(\"admin.case.search.fields\");\n    self.buttonContentTmpl = self.getTemplate(\"admin.case.search.button\");\n    self.resultContentTmpl = self.getTemplate(\"admin.case.search.result\");\n    self.paginationTmpl = self.getTemplate(\"admin.case.search.pagination\");\n    self.invalidateContentTmpl = self.getTemplate(\"admin.case.search.invalidate\");\n    self.reassignContentTmpl = self.getTemplate(\"admin.case.search.reassign\");\n    self.reassignFormTmpl = self.getTemplate(\"admin.case.search.reassign.form\");\n    self.actionResultContentTmpl = self.getTemplate(\"admin.case.search.action.result\");\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.maxElemShow = 10;\n    self.maxPageToShow = 5;\n\n    //load form data\n    self.processNavigation = [];\n    self.setupData();\n  },\n\n  /*\r\n     * Setup form data\r\n     */\n  setupData: function setupData() {\n    var self = this;\n\n\n    var selectedTasks = {\n      cases: [] };\n\n    var selectedTasksToShow = [];\n\n    self.setupInitialData();\n    self.setupDatePicker();\n    self.setupProcessTree();\n    self.setupMainButtons();\n\n    selectedTasks.cases.push({\n      idCase: self.params.data.idCase,\n      idWorkItem: self.params.data.idWorkItem });\n\n    selectedTasksToShow.push({\n      taskItem: self.params.data.idCase + \": \" + self.params.data.idtask,\n      idWorkItem: self.params.data.idWorkItem });\n\n\n    self.selectedTasks = selectedTasks;\n    self.selectedTasksToShow = selectedTasksToShow;\n    self.showReassignForm(self.content, self.selectedTasksToShow);\n  },\n\n  /*\r\n     * Load form data\r\n     */\n  setupInitialData: function setupInitialData() {\n    var self = this,\n    content = self.getContent(),\n    fields;\n\n    //set self variables to default\n    self.buttonBackAction = \"backToMainForm\";\n    self.selectedUserId = \"\";\n    self.selectedUserName = \"\";\n    self.selectedTasks = \"\";\n    self.selectedTasksToShow = \"\";\n    self.searchParams = \"\";\n    self.processTree = \"\";\n\n\n    //set content form to default\n    $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\n    $(\"#mainForm\", content).remove();\n    $(\"#dinamicContent\", content).remove();\n    $(\"#case-search-log-data-buttonset\", content).remove();\n\n    //append fields to wrapper\n    fields = $.tmpl(self.reassignFormTmpl, {});\n    content.append(fields);\n  },\n\n  /*\r\n     * Load dateTime plugin and apply to respective fields\r\n     */\n  setupDatePicker: function setupDatePicker() {\n    var self = this,\n    content = self.getContent();\n\n    $(\".biz-wp-form-datepicker\", content).datepicker({\n      controlType: 'select',\n      dateFormat: 'dd/mm/yy' });\n\n  },\n\n  /*\r\n     * initialize the process tree widget\r\n     */\n  setupProcessTree: function setupProcessTree() {\n    var self = this,\n    content = self.getContent();\n\n    bizagi.treeRoutSelected = [];\n    $(\"#treeLinksId\").remove();\n\n    self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, $.extend(self.params, {\n      canvas: $(\"#processTree\", content) }));\n\n\n    self.processTree.render();\n  },\n\n  /*\r\n     * initialize the users search form widget\r\n     */\n  setupUsersSearchForm: function setupUsersSearchForm() {\n    var self = this,\n    content = self.getContent(),\n    def = $.Deferred();\n\n    $(\"#biz-wp-users-table-form\").html(\"\");\n\n    self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\n      canvas: $(\"#biz-wp-users-table-form\", content),\n      userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign\")],\n      parentDef: def }));\n\n\n    self.usersTable.render();\n\n    $.when(def).done(function (userId, userName) {\n      self.assignEventReassignLinks(userId, userName);\n    });\n  },\n\n  /*\r\n     * Find cases results using the input data\r\n     */\n  findResults: function findResults(content, params, pageToShow) {\n    var self = this;\n\n    //If there is not a page to Show, begins whith the fist one\n    pageToShow ? params.Page = pageToShow : params.Page = 1;\n\n    $.when(\n    self.dataService.getAdminCasesList(params)).\n    done(function (resultList) {\n\n      //clean old results\n      $(\".biz-wp-table\").remove();\n      $(\".case-search-action-wrapper\").remove();\n      $(\"#biz-wp-table-summary-wrapper\").remove();\n\n      //Keep in track the total Records\n      self.totalRecords = resultList.records;\n      //keep in track the total pages\n      self.totalPages = resultList.total;\n\n      if (resultList.rows.length > 0) {\n\n        self.showCasesSearchResultFrame(content, resultList);\n        self.setupActionsButton(content);\n\n        var pageToshow = self.maxPageToShow > self.totalPages ? self.totalPages : self.maxPageToShow;\n        var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\"),\n        pagerData = {},\n        paginationHtml;\n\n        // show or hide \"load more\" button\n        pagerData.pagination = self.totalPages > 1 ? true : false;\n        pagerData.page = resultList.page;\n        pagerData.pages = {};\n\n        for (var i = 1; i <= pageToshow; i++) {\n          pagerData[\"pages\"][i] = {\n            \"pageNumber\": i };\n\n        }\n\n        //load and append the paginator to the result table\n        paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\n        summaryWrapper.append(paginationHtml);\n\n        //add data and behaviour to pager\n        $(\"ul\").bizagiPagination({\n          maxElemShow: self.maxElemShow,\n          totalPages: self.totalPages,\n          actualPage: resultList.page,\n          listElement: $(\"#biz-wp-table-pager-wrapper\"),\n          clickCallBack: function clickCallBack(options) {\n            self.findResults(content, params, options.page);\n          } });\n\n      } else {\n        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), \"Bizagi\", \"warning\");\n      }\n\n\n    }).fail(function (error) {\n      bizagi.log(error);\n    });\n  },\n\n  /*\r\n     * Show cases search result frames\r\n     */\n  showCasesSearchResultFrame: function showCasesSearchResultFrame(content, resultList) {\n    var self = this;\n\n    var processedItems = self.preprocessResultList(resultList.headers, resultList);\n    var resultTemplate = $.tmpl(self.resultContentTmpl, {\n      headers: resultList.headers,\n      rows: processedItems });\n\n\n    var invalidateForm = $.tmpl(self.invalidateContentTmpl, {}),\n    reassignForm = $.tmpl(self.reassignContentTmpl, {});\n\n    $(\"#mainForm\", content).hide();\n    $(\"#dinamicContent\", content).html(resultTemplate);\n    $(\".case-search-action-wrapper\", content).append(invalidateForm);\n    $(\".case-search-action-wrapper\", content).append(reassignForm);\n\n    $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\n    $(\"#btn-admin-case-search-clear\", content).hide();\n    $(\"#btn-admin-case-search\", content).hide();\n    $(\"#btn-admin-case-back\", content).css(\"display\", \"inline\");\n\n    self.setupActivitiesLink(content);\n    self.setupGraphicQueryEvent(content);\n  },\n\n  /*\r\n     *\r\n     */\n  preprocessResultList: function preprocessResultList(headers, resultList) {\n    var self = this;\n\n    var processedItems = [],\n    length = resultList.rows.length,\n    i = 0;\n\n    for (; i < length; i++) {\n      processedItems.push(self.processResultItem(headers, resultList.rows[i]));\n    }\n\n    return processedItems;\n  },\n\n  /*\r\n     * Process each result item\r\n     */\n  processResultItem: function processResultItem(headers, rowItem) {\n    var self = this;\n\n    var rowItemData = rowItem.data,\n    idCase = rowItem.idCase,\n    idWorkflow = rowItem.idWorkFlow;\n\n    var resultArray = [],\n    firstRowItem = [];\n\n    //Handle the task elements\n    var taskElements,\n    taskElementsLength;\n\n    var currentTaskObj;\n\n    var taskColumnIndex = [],\n    taskColumnIndexLength;\n\n    var j = -1,\n    columnIndex = 0;\n\n    var resultTaskArray = false;\n\n\n    firstRowItem.push({\n      id: \"checkCaseAdmin\",\n      value: idCase });\n\n\n    while (j++ < headers.length - 1) {\n\n      switch (headers[j].fieldName) {\n        case self.columnsID.caseNumber:\n          //Insert case number\n          firstRowItem.push({\n            id: \"caseNumber\",\n            value: {\n              'idCase': idCase,\n              'caseNumber': rowItemData[columnIndex] } });\n\n\n\n          columnIndex++;\n          break;\n\n        case self.columnsID.process:\n          //Insert process name\n          firstRowItem.push({\n            id: \"idWorkItem\",\n            value: rowItemData[columnIndex] });\n\n\n          columnIndex++;\n          break;\n\n        case self.columnsID.userName:\n        case self.columnsID.task:\n        case self.columnsID.taskDueDate:\n\n          //Gets the row elements if is not already assigned to taskElements array\n          if (taskElements === undefined) {\n            var k = rowItemData.length;\n            while (k-- > 0) {\n              if (Array.isArray(rowItemData[k])) {\n                taskElements = rowItemData[k];\n\n                //Notifies the existence of the array of task elements\n                resultTaskArray = true;\n                break;\n              }\n            }\n            columnIndex++;\n          }\n\n          //set the current task obj\n          if (resultTaskArray) {\n\n            //Removes the unecessary due date\n            if (headers[j].fieldName == self.columnsID.taskDueDate) {\n              rowItemData.splice(j, 1);\n            }\n\n            currentTaskObj = taskElements[0];\n\n            if (self.columnsID.userName == headers[j].fieldName) {\n              firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\n\n              if (taskColumnIndex.indexOf(self.columnsID.userName) == -1)\n              taskColumnIndex.push(self.columnsID.userName);\n            } else\n            if (self.columnsID.task == headers[j].fieldName) {\n              firstRowItem = firstRowItem.concat(self.processTaskObject(currentTaskObj, idCase));\n\n              if (taskColumnIndex.indexOf(self.columnsID.task) == -1)\n              taskColumnIndex.push(self.columnsID.task);\n            } else\n            if (self.columnsID.taskDueDate == headers[j].fieldName) {\n              firstRowItem = firstRowItem.concat(self.processTaskObjectDate(currentTaskObj));\n\n              if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\n              taskColumnIndex.push(self.columnsID.taskDueDate);\n            }\n            //TODO : userLocation logic in case its come inside the task array\n          } else {\n            if (headers[j].fieldName == self.columnsID.taskDueDate) {\n              //inserts the estimated Solution date in a object\n              firstRowItem = firstRowItem.concat({\n                'estimatedSolutionDate': rowItemData[j] });\n\n\n              if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\n              taskColumnIndex.push(self.columnsID.taskDueDate);\n            }\n          }\n\n          break;\n        //TODO : create case logic for single element, or create the required logic whe userLocation comes in the task list array               \n        /*\r\n        case self.columnsID.userLocation:\r\n        break;\r\n        /**/\n\n\n        case self.columnsID.processCreationDate:\n          //Creation Date\n          firstRowItem.push({\n            id: \"processCreationDate\",\n            value: rowItemData[columnIndex] });\n\n\n          columnIndex++;\n          break;\n\n        case self.columnsID.processDueDate:\n          //Task Due Date\n          firstRowItem.push({\n            id: \"processDueDate\",\n            value: rowItemData[columnIndex] });\n\n\n          columnIndex++;\n          break;\n\n        default:\n          firstRowItem.push({\n            id: \"customField\",\n            value: rowItemData[columnIndex] });\n\n\n          columnIndex++;\n          break;}\n\n    }\n\n    //Inserts view Process Column\n    firstRowItem.push({\n      id: \"viewProcess\",\n      value: {\n        'idCase': idCase,\n        'idworkflow': idWorkflow } });\n\n\n\n    //Insert the first row element\n    resultArray.push({\n      attr: \"first_row\",\n      data: firstRowItem });\n\n\n    taskElementsLength = taskElements ? taskElements.length : 0;\n\n    //If there is more task, add the remaining rows\n    if (taskElementsLength > 1) {\n      taskColumnIndexLength = taskColumnIndex.length;\n      for (var i = 1; i < taskElementsLength; i++) {\n\n        var taskData = [],\n        k = -1;\n        //Adds the elements in the right order as the columns are\n\n        while (k++ < taskColumnIndexLength - 1) {\n          if (taskColumnIndex[k] == self.columnsID.task)\n          taskData.push(self.processTaskObject(taskElements[i], idCase));else\n\n          if (taskColumnIndex[k] == self.columnsID.taskDueDate)\n          taskData.push(self.processTaskObjectDate(taskElements[i]));else\n\n          if (taskColumnIndex[k] == self.columnsID.userName)\n          taskData.push(self.processTaskObjectUser(taskElements[i]));\n        }\n\n        resultArray.push({\n          attr: \"next_row\",\n          data: taskData });\n\n      }\n    }\n\n    return {\n      data: resultArray,\n      totalTask: taskElementsLength };\n\n  },\n\n  /*\r\n     *   Process each task object\r\n     */\n  processTaskObject: function processTaskObject(taskObject, idCase) {\n    var obj = {\n      'taskName': taskObject.taskName,\n      'colorState': taskObject.colorState,\n      'idCase': idCase,\n      'idWorkItem': taskObject.idWorkItem,\n      'idTask': taskObject.idTask };\n\n    return obj;\n  },\n\n  /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\n  processTaskObjectDate: function processTaskObjectDate(taskObject) {\n    var obj = {};\n    taskObject.estimatedSolutionDate ? obj.estimatedSolutionDate = taskObject.estimatedSolutionDate : obj.estimatedSolutionDate = \"\";\n\n    return obj;\n  },\n\n  /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\n  processTaskObjectUser: function processTaskObjectUser(taskObject) {\n    var obj = {};\n    taskObject.assignee ? obj.userName = taskObject.assignee : obj.userName = \"\";\n\n    return obj;\n  },\n\n  /*\r\n     * Invalidate selected cases\r\n     */\n  invalidateCases: function invalidateCases(content) {\n    var self = this;\n    var selectedCases = {\n      cases: [] };\n\n\n    $(\"input:checkbox[name=CaseAdmin]:checked\", content).each(function () {\n      var val = $(this).val();\n      selectedCases.cases.push({\n        idCase: val });\n\n    });\n\n    if (selectedCases.cases.length == 0) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-empty-msg\"), \"Bizagi\", \"warning\");\n    } else {\n      $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-confirm-msg\"), \"Bizagi\", \"warning\")).\n      done(function () {\n        var reason = $(\"#txtReason\", content).val();\n        var params = {\n          action: \"abort\",\n          cases: JSON.stringify(selectedCases),\n          reason: reason };\n\n\n        $.when(self.dataService.abortReassignItems(params)).done(function (abortResult) {\n          self.showActionResultFrame(content, abortResult.response, \"invalidate\");\n        }).fail(function (error) {\n          bizagi.log(error);\n        });\n      });\n    }\n  },\n\n  /*\r\n     * Reassign selected tasks\r\n     */\n  showReassignTasksFrame: function showReassignTasksFrame(content) {\n    var self = this;\n    var selectedTasks = {\n      cases: [] };\n\n    var selectedTasksToShow = [];\n\n    $(\"input:checkbox[name=workItemAdmin]:checked\", content).each(function () {\n      var tasks = $(this).val();\n      tasks = tasks.split(\"|\");\n      selectedTasks.cases.push({\n        idCase: tasks[0],\n        idWorkItem: tasks[1] });\n\n      selectedTasksToShow.push({\n        taskItem: tasks[0] + \": \" + tasks[2],\n        idWorkItem: tasks[1] });\n\n    });\n\n    if (selectedTasksToShow.length == 0) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-empty-msg\"), \"Bizagi\", \"warning\");\n    } else {\n      self.selectedTasks = selectedTasks;\n      self.selectedTasksToShow = selectedTasksToShow;\n      self.showReassignForm(content, selectedTasksToShow);\n    }\n  },\n\n  /*\r\n     * Show Reassign frame\r\n     */\n  showReassignForm: function showReassignForm(content, selectedTasksToShow) {\n    var self = this;\n    self.buttonBackAction = \"backToCases\";\n    var resultTemplate = $.tmpl(self.reassignFormTmpl, {\n      tasks: selectedTasksToShow });\n\n\n    $(\"#dinamicContent\", content).hide();\n    $(\"#dinamicContent2\", content).html(resultTemplate);\n    $(\"#btn-admin-case-search-clear\", content).hide();\n    $(\"#btn-admin-case-search\", content).hide();\n    $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-title\"));\n    self.setupUsersSearchForm();\n\n  },\n\n  /*\r\n     * Reassign one or more taskt to other user\r\n     */\n  reassignTasks: function reassignTasks() {\n    var self = this;\n    var content = self.getContent();\n\n    var params = {\n      action: \"reassignItems\",\n      cases: JSON.stringify(self.selectedTasks),\n      idNewUser: self.selectedUserId };\n\n\n    $.when(self.dataService.reassignCurrent(params)).done(function (reassignResult) {\n      self.showActionResultFrame(content, reassignResult.response, \"reassign\");\n    }).fail(function (error) {\n      bizagi.log(error);\n    });\n  },\n\n  /*\r\n     * Show Invalidate / Reassign Result frame\r\n     */\n  showActionResultFrame: function showActionResultFrame(content, result, type) {\n    var self = this;\n    var action = result.length > 1 ? \"-several\" : \"\";\n    var items = \"\";\n    var itemsFailed = \"\";\n    var resultStatus = [];\n    action = type + action;\n\n    if (action == \"invalidate\") {\n      for (var i = 0; i < result.length; i++) {\n        if (result[i].deleted == true) {\n          items = result[i].idCase;\n          items += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[0] = true;\n        } else {\n          itemsFailed = result[i].idCase;\n          itemsFailed += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[1] = false;\n        }\n      }\n    } else if (action == \"invalidate-several\") {\n      for (var i = 0; i < result.length; i++) {\n        if (result[i].deleted == true) {\n          items += result[i].idCase;\n          items += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[0] = true;\n        } else {\n          itemsFailed += result[i].idCase;\n          itemsFailed += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[1] = false;\n        }\n      }\n    } else if (action == \"reassign\") {\n      for (var i = 0; i < result.length; i++) {\n        if (result[i].reassigned == true) {\n          items += result[i].idCase;\n          items += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[0] = true;\n        } else {\n          itemsFailed = result[i].idCase;\n          itemsFailed += i + 1 < result.length ? \", \" : \"\";\n          resultStatus[1] = false;\n        }\n      }\n    } else if (action == \"reassign-several\") {\n      items += \"<br/><br/>\";\n      itemsFailed += \"<br/><br/>\";\n      for (var i = 0; i < result.length; i++) {\n        if (result[i].reassigned == true) {\n          items += result[i].idCase + \"<br/>\";\n          resultStatus[0] = true;\n        } else {\n          itemsFailed += result[i].idCase + \"<br/>\";\n          resultStatus[1] = false;\n        }\n      }\n      items += \"<br/>\";\n      itemsFailed += \"<br/>\";\n    }\n\n    //load result template\n    var resultTemplate = $.tmpl(self.actionResultContentTmpl, {\n      action: action,\n      resultStatus: resultStatus });\n\n    resultTemplate = resultTemplate[0].innerHTML.replace(\"{0}\", \"<strong>\" + items + \"</strong>\");\n    resultTemplate = resultTemplate.replace(\"{3}\", \"<strong>\" + itemsFailed + \"</strong>\");\n    resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\n    resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\n\n    //reset and load respective result data and elements\n    if (type == \"invalidate\") $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-result-title\"));\n    $(\"#mainForm\", content).html(\"\");\n    $(\"#dinamicContent\", content).css(\"display\", \"inline\");\n    $(\"#dinamicContent\", content).html(resultTemplate);\n    $(\"#dinamicContent2\", content).remove();\n    $(\"#usersTable\", content).remove();\n    $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\n    $(\"#btn-admin-case-search-clear\", content).css(\"display\", \"none\");\n    $(\"#btn-admin-case-search\", content).css(\"display\", \"none\");\n    $(\"#btn-admin-case-finish\", content).css(\"display\", \"inline\");\n    $(\"#biz-wp-userstable-wrapperform\").hide();\n    $(\"#biz-wp-userstable-wrapperlist\").hide();\n    // Next variable specifies whether is redirecting to inbox or back to the case depending on the result status.\n    self.usersTable.resultStatus = resultStatus.indexOf(false) == -1;\n  },\n\n\n\n  //******************************** EVENTS ********************************//\n\n  /*\r\n  * Implement main buttons behaviour\r\n  */\n  setupMainButtons: function setupMainButtons() {\n    var self = this,\n    content = self.getContent(),\n    buttons = $.tmpl(self.buttonContentTmpl, {});\n\n    content.append(buttons);\n\n    var widgetButtonSet = $(\"#case-search-log-data-buttonset\", content);\n\n    $(\"#btn-admin-case-search-clear\", widgetButtonSet).click(function (e) {\n\n      //clear all fields\n      $(\".biz-wp-input-text\", content).val(\"\");\n      $(\".biz-wp-form-datepicker\", content).val(\"\");\n      self.setupProcessTree();\n\n    });\n\n    $(\"#btn-admin-case-search\", widgetButtonSet).click(function (e) {\n\n      var idAppToSend = \"\";\n      var idCategorytoSend = \"\";\n      var idProcessToSend = \"\";\n      var errorMessage = \"\";\n      var errorFieldName = \"\";\n\n      var selectedProcessRoute = self.processTree.getTreeRouteSelected();\n\n      if (selectedProcessRoute.length > 0) {\n        if (selectedProcessRoute.length == 2) {\n          idAppToSend = selectedProcessRoute[1];\n          idProcessToSend = selectedProcessRoute[0];\n          idCategorytoSend = \"\";\n        } else\n        {\n          idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\n          idCategorytoSend = selectedProcessRoute[1];\n          idProcessToSend = selectedProcessRoute[0];\n        }\n      }\n\n      var params = {\n        h_action: \"getCases\",\n        I_ProcessState: \"Running\",\n        h_idApp: \"\",\n        I_Users: \"ALL\",\n        eventAsTask: true,\n        orderType: 1,\n        order: \"\",\n        orderField: \"\",\n        I_radNumber: $(\"#caseInput\").val(),\n        I_idWFClass: idProcessToSend,\n        I_USERFULLNAME: $(\"#userNameInput\").val(),\n        I_USERPOSITION: $(\"#userPositionInput\").val(),\n        I_From__CreationDate: $(\"#sinceDate\").val(),\n        I_To__CreationDate: $(\"#toDate\").val(),\n        h_idWFClassAuth: \"\",\n        I_idCategory: idCategorytoSend,\n        I_idApplication: idAppToSend,\n        PageSize: self.maxElemShow };\n\n\n\n      if ($(\"#sinceDate\").val() != \"\" && !bizagi.util.isDate($(\"#sinceDate\").val())) {\n        errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\n        errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-date-since\");\n        errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\n        bizagi.showMessageBox(errorMessage, \"Bizagi\", \"warning\");\n      } else if ($(\"#toDate\").val() != \"\" && !bizagi.util.isDate($(\"#toDate\").val())) {\n        errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\n        errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-to-date\");\n        errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\n        bizagi.showMessageBox(errorMessage, \"Bizagi\", \"warning\");\n      } else {\n        self.searchParams = params;\n        self.findResults(content, params);\n      }\n\n    });\n\n    $(\"#btn-admin-case-back\", widgetButtonSet).click(function (e) {\n      if (self.buttonBackAction == \"backToMainForm\") {\n        self.backToMainForm();\n      } else if (self.buttonBackAction == \"backToCases\") {\n        self.backToCases();\n      }\n    });\n\n    $(\"#btn-admin-case-finish\", widgetButtonSet).click(function (e) {\n      self.publish(\"closeCurrentDialog\");\n    });\n\n  },\n\n  /*\r\n     * Back to Cases\r\n     */\n  backToCases: function backToCases() {\n\n    var self = this;\n    var content = self.getContent();\n\n    self.buttonBackAction = \"backToMainForm\";\n    $(\"#dinamicContent\", content).show();\n    $(\"#dinamicContent2\", content).html(\"\");\n    $(\"#usersTable\").remove();\n    $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\n    $(\"#btn-admin-case-search-clear\", content).hide();\n    $(\"#btn-admin-case-search\", content).hide();\n  },\n\n  /*\r\n     * Back to Main Form\r\n     */\n  backToMainForm: function backToMainForm() {\n\n    var self = this;\n    var content = self.getContent();\n\n    $(\"#mainForm\", content).show();\n    $(\"#dinamicContent\", content).html(\"\");\n    $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\n    $(\"#btn-admin-case-search-clear\", content).show();\n    $(\"#btn-admin-case-search\", content).show();\n    $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\n  },\n\n  /*\r\n     * Set event to reassign link in users table\r\n     */\n  assignEventReassignLinks: function assignEventReassignLinks(userId, userName) {\n    var self = this;\n    self.selectedUserId = userId;\n    self.selectedUserName = userName;\n    self.reassignTasks();\n  },\n\n  /*\r\n     * Implement actions buttons behaviour\r\n     */\n  setupActionsButton: function setupActionsButton(content) {\n    var self = this;\n\n    //boton invalidar\n    $(\"#btn-admin-case-invalidate\", content).click(function (e) {\n      self.invalidateCases(content);\n    });\n\n    //boton reasignar\n    $(\"#btn-admin-case-reassign\", content).click(function (e) {\n      self.showReassignTasksFrame(content);\n    });\n  },\n\n  /*\r\n     * Manage cases table links events(cases, activities and view workflow)\r\n     */\n  setupActivitiesLink: function setupActivitiesLink(content) {\n    var self = this;\n\n    // Add click event to task (Activity) link\n    $(\".activityClicked\", content).click(function () {\n      self.publish(\"executeAction\", {\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n        idCase: $(this)[0].getAttribute(\"data-idCase\"),\n        idWorkItem: $(this)[0].getAttribute(\"data-idworkItem\"),\n        idTask: $(this)[0].getAttribute(\"data-idTask\") });\n\n      self.publish(\"closeCurrentDialog\");\n\n    });\n\n    // Add click event to case link\n    $(\".caseClicked\", content).click(function () {\n      self.publish(\"executeAction\", {\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n        idCase: $(this)[0].getAttribute(\"data-idCase\"),\n        idWorkItem: \"\",\n        idTask: \"\" });\n\n      self.publish(\"closeCurrentDialog\");\n    });\n\n    // Add click event to column header\n    $(\".cases-column-header\", content).click(function () {\n      var columnOrderId = $(this)[0].getAttribute(\"data-columnorder\");\n      var columnOrderBy = $(this)[0].getAttribute(\"data-ordertype\");\n      var columnOrderName = $(this)[0].getAttribute(\"data-columnOrderName\");\n\n      if (columnOrderBy == \"1\") {\n        columnOrderBy = 0;\n      } else {\n        columnOrderBy = 1;\n      }\n\n      self.searchParams.order = columnOrderId;\n      self.searchParams.orderType = columnOrderBy;\n      self.searchParams.orderField = columnOrderName;\n      self.findResults(content, self.searchParams, self.searchParams.Page);\n\n    });\n  },\n\n  /*\r\n     * Set up graphic query event\r\n     */\n  setupGraphicQueryEvent: function setupGraphicQueryEvent(content) {\n\n    var self = this;\n\n    // Add click event to view workflow\n    $(\".biz-wp-diagram-view-icon\", content).click(function () {\n      var idCase = $(this).data(\"idcase\");\n      var idWorkflow = $(this).data('idworkflow');\n      self.showGraphicQuery({\n        idCase: idCase,\n        idWorkflow: idWorkflow });\n\n    });\n  } });"]}