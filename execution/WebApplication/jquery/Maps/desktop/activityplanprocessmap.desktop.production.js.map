{"version":3,"sources":["jquery/workportal/desktop/widget/project.plan.activity.sidebar/bizagi.workportal.desktop.widgets.project.plan.activity.sidebar.js","jquery/workportal/desktop/widget/project.plan.activity.action/bizagi.workportal.desktop.widgets.project.plan.activity.action.js","jquery/workportal/desktop/widget/project.plan.activity.time/bizagi.workportal.desktop.widgets.project.plan.activity.time.js","jquery/workportal/desktop/widget/project.plan.activity.progress/bizagi.workportal.desktop.widgets.project.plan.activity.progress.js","jquery/workportal/desktop/widget/project.plan.activity.subprocesses/bizagi.workportal.desktop.widgets.project.plan.activity.subprocesses.js","jquery/workportal/desktop/widget/project.plan.activity.parent/bizagi.workportal.desktop.widgets.project.plan.activity.parent.js","jquery/workportal/desktop/widget/project.plan.activity.users/bizagi.workportal.desktop.widgets.project.plan.activity.users.js","jquery/workportal/desktop/widget/project.dashboard.menu/bizagi.workportal.desktop.widgets.project.dashboard.menu.js","jquery/workportal/desktop/widget/project.dashboard.menu.activity.plan/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processDiagram.helper.js","jquery/workportal/desktop/widget/project.activity.sidebar/bizagi.workportal.desktop.widgets.project.activity.sidebar.js","jquery/workportal/desktop/widget/project.activityMap/bizagi.workportal.desktop.widgets.project.activityMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.activityMap.tooltip.js"],"names":["bizagi","workportal","widgets","project","base","extend","init","workportalFacade","dataService","serviceloadDataPlan","params","this","_super","loadTemplates","project-plan-activity-sidebar","getTemplate","concat","renderContent","template","content","render","postRender","sub","$","proxy","onNotifyLoadInfoPlan","event","parans","plan","idActivitySelected","idPlan","id","loadData","getDateServer","subscribe","loadedWithDataActivities","loadedWithDataFirstParent","pub","type","args","clean","unsubscribe","injector","register","activity","sidebar","notifier","dateFormat","localization","getResource","timeFormat","estimatedFinishDateTime","beforeUserAssignedActivity","activity-action-main","activity-action-editionpopup","dialogBox","onNotifyLoadInfoActivityExecution","onNotifyExpandedRightSidebar","self","$content","getContent","empty","currentActivity","activities","filter","toUpperCase","idUserCreator","currentUser","idUser","userAssigned","argsTemplate","currentActivityName","name","showEditAction","tmpl","append","initilizeActionMenu","initializeTempleteAndEvents","plugins","activityEdition","initPluginPopupEdition","formEditActivity","assignee","date","duration","buttonCancel","buttonUpdate","on","onClickPopupButtonCancel","onClickPopupButtonUpdate","onDeleteDate","onTypeDuration","menu","select","onSelectMenu","removeClass","popupEditActivity","formContent","initializeAutoComplete","element","url","serviceLocator","getUrl","autocomplete","minLength","source","request","response","ajax","data","domain","userName","fullName","term","organization","pag","pagSize","orderField","success","map","users","item","label","user","value","ui","val","IdAssignee","focus","change","initializeDatePicker","datepicker","onSelect","getTime","undefined","util","dateFormatter","getDateFormatByDatePickerJqueryUI","initializeSpiner","desactivateDateByDuration","newValue","target","isNumeric","parseInt","spinner","min","max","placeHolder","spin","keyCode","fieldDurationActive","activateElement","form","currentTarget","find","length","onClickOpenPopupEdition","dialog","resizable","draggable","height","width","modal","title","maximize","open","onOpenPopupEdition","close","onClosePopupEdition","activityDate","isEmpty","estimatedFinishDate","isNaN","formatInvariant","Date","getDateFromInvariant","isMinimumDate","setUserAssignedById","removePopupWidgets","callGetDataUsers","then","responseUsers","preventDefault","next","html","remove","validateParamsOfFormEditActivity","idUserAssigned","updateActivity","progress","startDate","allowEdition","description","finishDate","items","when","editActivityPlan","done","refreshAllWidgets","showContextByMenuDashboard","showSucessMessage","onClickFavorite","favoriteOptions","hasClass","idObject","idCase","favoriteType","addFavorite","favoritesData","guidFavorite","idFavorites","addClass","delFavorite","unsub","messageValidationField","replace","toLowerCase","csvIdUsers","defer","Deferred","userIds","getUsersData","always","resolve","promise","action","widget","EXECUTING_ACTIVITY","FINISHED_ACTIVITY","datePickerRegional","plan-time-main","onNotifyLoadInfoActivitySummary","getStateActivity","time","fromDate","getFormattedDate","getFirstDate","dataProgressWidget","getDataByScenarios","unitTime","auxUnitTime","updateWidget","contentTemplate","relativeTime","getRelativeTime","now","minutes","messageDescripionDifference","keywordResource","messageTime","appendTo","$barRemainingDate","widthNumberDays","css","toString","percentBar","currentState","colorBar","getColorByCreatedAndEstimatedDate","toDate","callGetEffectiveDuration","getColorBar","getPercentBar","getKeywordResourceDescriptionBar","getUnitTime","getUTCDate","dateObj","monthNames","getMonth","formatDate","d","getEffectiveDuration","plan-progress-main","plan-progress-popup-edit","onNotifyUpdateItemFromRender","activityToShow","valuePercentBarComplete","canEdit","popupEditProgress","initPluginPopupEditProgress","formEditProgress","sliderProgress","slider","orientation","range","from","to","step","slide","onChangesliderProgress","each","vals","i","el","numericTextBoxPlugin","format","onChangeNumericTextBoxProgress","decimals","buttonChangeProgress","onShowPopupEditProgress","onClickCancel","onSubmitFormChangeProgress","updateProgressUI","listItems","activityWork","hide","show","text","newPercentProgress","templatePopupEditProgress","onOpenPopupPlan","detach","previusValueProgress","prop","project-subprocesses","project-subprocesses-tootip-custom-properties","subprocesses","plan-parent-main","getPlanParent","planParent","parent","idParent","radNumber","nameParent","displayName","idWorkflow","idWorkItem","idTask","onClickGoToParentCase","routingExecute","closest","usersMap","usersInformation","globalHandlersService","get","usersAssignees","plan-users-main","activityRunning","cvsGuidUsers","activitiesUsers","ownerUserId","ownerUserGuid","push","guidUser","userType","picture","guid","index","userId","userGuid","userAssignedGuid","inArray","justAssignees","addEventHandlersModal","showCreatorInformation","renderUserProfilesAndImages","allUsers","usersAssignee","isOwner","indexOf","isAssignee","usersAdapter","createJsonUserInfo","userCreator","userInfo","username","email","getInitials","userinformation","obj","$li","console","log","not","ev","userSelected","$target","usersActivities","userParam","getIsAssignee","getIsOwner","usertooltip","usersGuids","join","getUsersAssignees","getUserAssignee","tasks","types","actUser","click","stopPropagation","publish","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","modalParameters","refreshInbox","onDiscussionsMenuStatusChange","updateDiscussionsIcons","hasDiscussionsOrComment","toggle","dashboard","project-dashboard-menu","contextsLeftSidebarCaseDashboard","forEach","context","updateView","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","contextualized","siblings","handlerEvents","paramsGetPlan","callGetPlan","responsePlan","loadContentById","$item","autoSave","document","getLevelNavigator","newLevelNavigator","refreshLastItemBreadcrumb","histName","level","getPlan","status","reject","subMenuHandler","$comments","$files","$timeline","off","project-content-dashboard","setTimeout","window","trigger","instanceBizagiProcessMap","processMap","project-processmap","project-process-diagram","project-activity-map","project-subprocess","viewOptions","configureHandlers","onProcessDiagram","onActivityMap","onSupprocess","navigationManager","container","renderProcessDiagram","resize","renderActivityMap","renderSubProcessMap","appendActivityMapZoom","appendProcessMapZoom","appendSubprocessZoom","appendSubprocessDragScroll","bindTooltip","tooltipParams","graphicquery","getPVHeight","defaultHeight","canvasPst","$header","supportNav","project-activity-sidebar","project-activityMap","actualState","state","activityMap","project-tooltip","cache","gqData","onProcess","onIdCase","showGraphicQuery","idWorkitem","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","tooltipClass","$container","tooltip","callback","diagram","is","className","baseVal","getActivityMapTooltipContent","getSubprocessTooltipContent","effect","delay","position","my","hover","stop","fadeTo","fadeOut","$ui","def","guidWorkitem","isCached","buildContent","getActivitySummary","appendToCache","endDate","process","assigneeName","graphicQuery","menuSecurity","GraphicQuery","formatInvariantDate"],"mappings":"AAKAA,OAAOC,WAAWC,QAAQC,QAAQC,KAAKC,OAAO,0DAA2D,GAAI,CAK3GC,KAAM,SAAcC,EAAkBC,EAAaC,EAAqBC,GAC3DC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAKNF,oBAAsBA,EALhBE,KAQNE,cAAc,CACjBC,gCAAiCd,OAAOe,YAAY,2DAA2DC,OAAO,qCAO1HC,cAAe,WACb,IAEIC,EAFOP,KAESI,YAAY,iCAGhC,OALWJ,KAGNQ,QAAUD,EAASE,OAAO,IAHpBT,KAKCQ,SAEdE,WAAY,WACCV,KACNW,IAAI,iBAAkBC,EAAEC,MADlBb,KAC6Bc,qBAD7Bd,QAIbc,qBAAsB,SAA8BC,EAAOC,GAEzD,GADWhB,KACFD,OAAOkB,KAAKC,mBAAoB,CAEvC,IAAInB,EAAS,CAAEoB,OAHNnB,KAGmBD,OAAOkB,KAAKG,IAH/BpB,KAIJF,oBAAoBuB,SAAStB,EAJzBC,KAIsCsB,cAJtCtB,KAI0DD,QAJ1DC,KAKJF,oBAAoByB,UAAU,2BAA4BX,EAAEC,MALxDb,KAKmEwB,yBALnExB,OAAAA,KAMJF,oBAAoByB,UAAU,4BAA6BX,EAAEC,MANzDb,KAMoEyB,0BANpEzB,SAUbwB,yBAA0B,WACbxB,KACN0B,IAAI,SAAU,CACjBC,KAAM,yBACNC,KAHS5B,KAGED,SAHFC,KAKN0B,IAAI,SAAU,CACjBC,KAAM,kCACNC,KAPS5B,KAOED,SAPFC,KASN0B,IAAI,SAAU,CACjBC,KAAM,6BACNC,KAXS5B,KAWED,SAXFC,KAaN0B,IAAI,SAAU,CACjBC,KAAM,4BACNC,KAfS5B,KAeED,UAIf0B,0BAA2B,WACdzB,KACN0B,IAAI,SAAU,CACjBC,KAAM,yBACNC,KAHS5B,KAGED,UAIf8B,MAAO,WACM7B,KACFF,sBADEE,KAEJF,oBAAoBgC,YAAY,2BAA4BlB,EAAEC,MAF1Db,KAEqEwB,yBAFrExB,OAAAA,KAGJF,oBAAoBgC,YAAY,4BAA6BlB,EAAEC,MAH3Db,KAGsEyB,0BAHtEzB,WASfX,OAAO0C,SAASC,SAAS,0DAA2D,CAAC,mBAAoB,cAAe,oDAAqD3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAASC,UAAU,GCpFvO7C,OAAOC,WAAWC,QAAQC,QAAQC,KAAKC,OAAO,yDAA0D,GAAI,CAK1GC,KAAM,SAAcC,EAAkBC,EAAasC,EAAUpC,GAChDC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAKNoC,WAAa/C,OAAOgD,aAAaC,YAAY,cALvCtC,KAMNuC,WAAalD,OAAOgD,aAAaC,YAAY,cANvCtC,KAONwC,wBAPMxC,KASNyC,2BAA6B,GATvBzC,KAUNmC,SAAWA,EAVLnC,KAcNE,cAAc,CACjBwC,uBAAwBrD,OAAOe,YAAY,0DAA0DC,OAAO,iCAC5GsC,+BAAgCtD,OAAOe,YAAY,0DAA0DC,OAAO,gDAhB3GL,KAmBN4C,UAAY,IAOnBtC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAMdE,WAAY,WACCV,KACNW,IAAI,6BAA8BC,EAAEC,MAD9Bb,KACyC6C,kCADzC7C,OAAAA,KAENW,IAAI,yBAA0BC,EAAEC,MAF1Bb,KAEqC8C,6BAFrC9C,QAQb6C,kCAAmC,SAA2C9B,EAAOhB,GACnF,IAAIgD,EAAO/C,KACX+C,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAE3C,IAAIoB,EAAWD,EAAKE,aAAaC,QAE7BC,EAAkB,GAOtB,GANIJ,EAAKhD,OAAOkB,KAAKC,qBACnBiC,EAAkBJ,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GAC7D,OAAOA,EAASb,GAAGkC,gBAAkBP,EAAKhD,OAAOkB,KAAKC,mBAAmBoC,iBACxE,IAGDP,EAAKhD,OAAOkB,KAAKsC,gBAAkBlE,OAAOmE,YAAYC,QAAUN,EAAgBO,cAAgBrE,OAAOmE,YAAYC,OAAQ,CAE7H,IAAIE,EAAe,GACnBA,EAAaC,oBAAsBT,EAAgBU,KACnDF,EAAaG,gBAAiB,EAC1Bf,EAAKhD,OAAOkB,KAAKsC,gBAAkBlE,OAAOmE,YAAYC,SACxDE,EAAaG,gBAAiB,GAGhC,IAAIC,EAAOhB,EAAK3C,YAAY,wBAC5B4C,EAASgB,OAAOD,EAAKtD,OAAOkD,IAExBA,EAAaG,iBACff,EAAKkB,sBACLlB,EAAKN,2BAA6BU,EAAgBO,aAClDX,EAAKvC,QAAQwD,OAAOhB,GACpBD,EAAKmB,iCAKXA,4BAA6B,WAChBlE,KACNmE,QAAU,GADJnE,KAENmE,QAAQC,gBAFFpE,KAEyBqE,yBAFzBrE,KAINsE,iBAAmB,CACtBC,SAAU3D,EAAE,0BALHZ,KAKmCmE,QAAQC,iBACpDI,KAAM5D,EAAE,sBANCZ,KAM2BmE,QAAQC,iBAC5CK,SAAU7D,EAAE,0BAPHZ,KAOmCmE,QAAQC,iBACpDM,aAAc9D,EAAE,gDARPZ,KAQ6DmE,QAAQC,iBAC9EO,aAAc/D,EAAE,gDATPZ,KAS6DmE,QAAQC,kBATrEpE,KAYNsE,iBAAiBI,aAAaE,GAAG,QAAShE,EAAEC,MAZtCb,KAYiD6E,yBAZjD7E,OAAAA,KAaNsE,iBAAiBK,aAAaC,GAAG,QAAShE,EAAEC,MAbtCb,KAaiD8E,yBAbjD9E,OAAAA,KAeNsE,iBAAiBE,KAAKI,GAAG,UAAWhE,EAAEC,MAfhCb,KAe2C+E,aAf3C/E,OAAAA,KAgBNsE,iBAAiBG,SAASG,GAAG,QAAShE,EAAEC,MAhBlCb,KAgB6CgF,eAhB7ChF,QAsBb8C,6BAA8B,WACjB9C,KACNiE,uBAMPA,oBAAqB,WAEnBrD,EAAE,mDADSZ,KACgDQ,SAASyE,KAAK,CACvEC,OAAQtE,EAAEC,MAFDb,KAEYmF,aAFZnF,QAGXoF,YAAY,sBAOdf,uBAAwB,WACtB,IACIgB,EADOrF,KACkBI,YAAY,gCAEzC,OAHWJ,KAEN4C,UAAU0C,YAAcD,EAAkB5E,OAAO,IAF3CT,KAGC4C,UAAU0C,aAQxBC,uBAAwB,SAAgCC,GACtD,IAAIzC,EAAO/C,KACPyF,EAAM1C,EAAKlD,YAAY6F,eAAeC,OAAO,sBAEjDH,EAAQI,aAAa,CACnBC,UAAW,EACXC,OAAQ,SAAgBC,EAASC,GAC/BpF,EAAEqF,KAAK,CACLR,IAAKA,EACLS,KAAM,CACJC,OAAQ,GACRC,SAAU,GACVC,SAAUN,EAAQO,KAClBC,aAAc,GACdC,IAAK,EACLC,QAAS,IACTC,WAAY,YAEdC,QAAS,SAAiBT,GACxBF,EAASpF,EAAEgG,IAAIV,EAAKW,OAAO,SAAUC,GACnC,MAAO,CACLC,MAAOD,EAAKE,KACZC,MAAOH,EAAKrD,gBAMtByB,OAAQ,SAAgBnE,EAAOmG,GAC7B,IAAIrD,EAAOqD,EAAGJ,KAAKC,MAGnB,OAFAvB,EAAQ2B,IAAItD,GACZd,EAAKuB,iBAAiB8C,WAAaF,EAAGJ,KAAKG,OACpC,GAETI,MAAO,WACL,OAAO,GAETC,OAAQ,SAAgBvG,EAAOmG,GAK7B,OAJgB,OAAZA,EAAGJ,OACL/D,EAAKuB,iBAAiB8C,WAAa,KACnCrE,EAAKuB,iBAAiBC,SAAS4C,IAAI,MAE9B,MAWbI,qBAAsB,SAA8B/B,GAClD,IAAIzC,EAAO/C,KACXwF,EAAQgC,WAAW,CACjBC,SAAU,WACR1E,EAAKuB,iBAAiBG,SAAS0C,IAAI,IACnCpE,EAAKP,wBAA0BO,EAAKuB,iBAAiBE,KAAKgD,WAAW,WAAazE,EAAKuB,iBAAiBE,KAAKgD,WAAW,WAAWE,eAAYC,KAGnJnC,EAAQgC,WAAW,SAAU,aAAcnI,OAAOuI,KAAKC,cAAcC,sCAOvEC,iBAAkB,SAA0BvC,GAC1C,IAAIzC,EAAO/C,KACX,SAASgI,EAA0BjH,EAAOkH,GACxC,IAAIhB,EAAQgB,GAAYrH,EAAEG,EAAMmH,QAAQf,MACpC9H,OAAOuI,KAAKO,UAAUlB,IAAUmB,SAASnB,EAAO,IAAM,GACxDlE,EAAKuB,iBAAiBE,KAAK2C,IAAI,IAC/BpE,EAAKP,6BAA0BmF,GAE/B/G,EAAEG,EAAMmH,QAAQf,IAAI,IAIxB3B,EAAQ6C,QAAQ,CACdC,IAAK,EACLC,IAAK,IACLC,YAAanJ,OAAOgD,aAAaC,YAAY,oBAC7CgF,OAAQ,SAAgBvG,GACtBiH,EAA0BjH,IAE5B0H,KAAM,SAAc1H,EAAOmG,GACzBc,EAA0BjH,EAAOmG,EAAGD,WAU1ClC,aAAc,SAAsBhE,GAEZ,IAAlBA,EAAM2H,UACR9H,EAAEG,EAAMmH,QAAQf,IAAI,IAFXnH,KAGJ2I,qBAAoB,KAQ7B3D,eAAgB,SAAwBjE,GAGhB,KADRH,EAAEG,EAAMmH,QACVf,MAFDnH,KAGJwC,6BAA0BmF,EAHtB3H,KAKJ4I,gBALI5I,KAKiB6I,KAAKrE,OASnCW,aAAc,SAAsBpE,EAAOmG,GAEzC,GAAgD,IAA5CtG,EAAEG,EAAM+H,eAAeC,KAAK,KAAKC,OAEnC,OADWpI,EAAEsG,EAAGJ,MAAMZ,KAAK,SAEzB,IAAK,OAJElG,KAKAiJ,4BASbA,wBAAyB,WACZjJ,KACNkE,8BADMlE,KAEN4C,UAAU0C,YAAY4D,OAAO,CAChCC,WAAW,EACXC,WAAW,EACXC,OAAQ,OACRC,MAAO,QACPC,OAAO,EACPC,MAAOnK,OAAOgD,aAAaC,YAAY,qDACvCmH,UAAU,EACVC,KAAM9I,EAAEC,MAVCb,KAUU2J,mBAVV3J,MAWT4J,MAAOhJ,EAAEC,MAXAb,KAWW6J,oBAXX7J,SAkBb2J,mBAAoB,WAClB,IAAI5G,EAAO/C,KACPmD,EAAkBJ,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GACjE,OAAOA,EAASb,GAAGkC,gBAAkBP,EAAKhD,OAAOkB,KAAKC,mBAAmBoC,iBACxE,GAECwG,EAAe3G,IAAoB9D,OAAOuI,KAAKmC,QAAQ5G,EAAgB6G,qBAAuB7G,EAAgB6G,oBAAsB,GACnIC,MAAMH,KACTA,EAAezK,OAAOuI,KAAKC,cAAcqC,gBAAgB,IAAIC,KAAKL,KAEpE,IAAIE,EAAsBF,EAAezK,OAAOuI,KAAKC,cAAcuC,qBAAqBN,GAAgB,GACpGO,EAAgBL,aAA+BG,MAAOH,EAAoBtC,UAAY3E,EAAKzB,gBAE/FyB,EAAKwC,uBAAuBxC,EAAKuB,iBAAiBC,UAClDxB,EAAKwE,qBAAqBxE,EAAKuB,iBAAiBE,MAChDzB,EAAKgF,iBAAiBhF,EAAKuB,iBAAiBG,UAExCtB,EAAgBO,cAClBX,EAAKuH,oBAAoBnH,EAAgBO,cAG3CX,EAAKuB,iBAAiBE,KAAKgD,WAAW,SAAU,UAAW,IAAI2C,KAAKpH,EAAKzB,kBAErE6B,EAAgB6G,qBAAuBK,GACzCtH,EAAKuB,iBAAiBE,KAAKgD,WAAW,SAAU,UAAWwC,GAGzD7G,EAAgB6G,sBACdA,GACFjH,EAAKuB,iBAAiBE,KAAKgD,WAAW,UAAWwC,GAEnDjH,EAAKP,wBAA0BW,EAAgB6G,qBAG7C7G,EAAgBsB,UAClB1B,EAAKuB,iBAAiBG,SAAS0C,IAAIiB,SAASjF,EAAgBsB,SAAU,MAO1EoF,oBAAqB,WACR7J,KACNuK,sBAOPD,oBAAqB,SAA6B7G,GAChD,IAAIV,EAAO/C,KAEX+C,EAAKyH,iBAAiB/G,GAAQgH,MAAK,SAAUC,GAC3C3H,EAAKuB,iBAAiBC,SAAS4C,IAAIuD,EAAc,GAAG7G,SAEtDd,EAAKuB,iBAAiB8C,WAAa3D,GAOrCoB,yBAA0B,SAAkC9D,GAE1DA,EAAM4J,iBADK3K,KAENuK,sBAMPA,mBAAoB,WACPvK,KACNsE,iBAAiBC,SAASqG,OAAO7B,KAAK,QAAQ8B,KAAK,IAD7C7K,KAEN4C,UAAU0C,YAAYwF,SAC3BlK,EAAE,sBAAsBkK,UAM1BhG,yBAA0B,WACxB,IAAI/B,EAAO/C,KACX,GAAI+C,EAAKgI,mCAAoC,CAC3C,IAAI5H,EAAkBJ,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GACjE,OAAOA,EAASb,GAAGkC,gBAAkBP,EAAKhD,OAAOkB,KAAKC,mBAAmBoC,iBACxE,GACC0H,EAAiBjI,EAAKuB,iBAAiB8C,YAAc/H,OAAOmE,YAAYC,OAChC,IAAxCV,EAAKuB,iBAAiBG,SAAS0C,QACjCpE,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GAC3C,OAAOA,EAASb,GAAGkC,gBAAkBP,EAAKhD,OAAOkB,KAAKC,mBAAmBoC,iBACxE,GAAG0G,oBAAsB,IAE9B,IAAIiB,EAAiB,CACnBC,SAAU/H,EAAgB+H,SAC1B9J,GAAI+B,EAAgB/B,GACpB+J,UAAWhI,EAAgBgI,UAC3B1G,SAAU1B,EAAKuB,iBAAiBG,SAAS0C,MACzCzD,aAAcsH,EACdI,aAAcjI,EAAgBiI,aAC9BC,YAAalI,EAAgBkI,YAC7BxH,KAAMV,EAAgBU,KACtB1C,OAAQgC,EAAgBhC,OACxB6I,oBAAqBjH,EAAKP,wBAC1B8I,WAAYnI,EAAgBmI,WAC5BC,MAAOpI,EAAgBoI,OAEzB3K,EAAE4K,KAAKzI,EAAKlD,YAAY4L,iBAAiBR,IAAiBS,MAAK,WAC7DvI,EAAkBvC,EAAElB,OAAOyD,EAAiB8H,GAC5ClI,EAAKwH,qBAEDxH,EAAKN,6BAA+BM,EAAKuB,iBAAiB8C,WAC5DrE,EAAKrB,IAAI,SAAU,CACjBC,KAAM,uBACNC,KAAMhB,EAAElB,OAAOqD,EAAKhD,OAAQ,CAAE4L,mBAAmB,MAInD5I,EAAKrB,IAAI,SAAU,CACjBC,KAAMoB,EAAKhD,OAAO6L,2BAClBhK,KAAMmB,EAAKhD,SAIfgD,EAAKwH,qBACLxH,EAAKZ,SAAS0J,kBAAkBxM,OAAOgD,aAAaC,YAAY,yDAQtEwJ,gBAAiB,SAAyB/K,GACxCA,EAAM4J,iBACN,IAAI5H,EAAO/C,KACP+L,EAAkB,GAClBnL,EAAEG,EAAMmH,QAAQ8D,SAAS,yBAC3BD,EAAkB,CAChBE,SAAUlJ,EAAKhD,OAAOmM,OACtBC,aAAc,SAEhBvL,EAAE4K,KAAKzI,EAAKlD,YAAYuM,YAAYL,IAAkBL,MAAK,SAAUW,GACnEtJ,EAAKhD,OAAOuM,aAAeD,EAAcE,YACzC3L,EAAEG,EAAMmH,QAAQ9C,YAAY,wBAC5BxE,EAAEG,EAAMmH,QAAQsE,SAAS,qBAI3BT,EAAkB,CAChBE,SAAUlJ,EAAKhD,OAAOuM,aACtBH,aAAc,SAEhBvL,EAAE4K,KAAKzI,EAAKlD,YAAY4M,YAAYV,IAAkBL,MAAK,WACzD9K,EAAEG,EAAMmH,QAAQsE,SAAS,wBACzB5L,EAAEG,EAAMmH,QAAQ9C,YAAY,qBAQlCvD,MAAO,WACM7B,KACN0M,MAAM,6BAA8B9L,EAAEC,MADhCb,KAC2C6C,kCAD3C7C,OAAAA,KAEN0M,MAAM,yBAA0B9L,EAAEC,MAF5Bb,KAEuC8C,6BAFvC9C,QASb+K,iCAAkC,WAChC,IACIrH,EADO1D,KACasE,iBAAiBC,SACzC,GAAIb,EAAayD,OAAgC,KAAvBzD,EAAayD,OAF5BnH,KAEiDsE,iBAAiB8C,WAC3E,OAAO,EAEP,IAAIuF,EAAyBtN,OAAOgD,aAAaC,YAAY,2CAG7D,OAFAqK,EAAyBA,EAAuBC,QAAQ,MAAOvN,OAAOgD,aAAaC,YAAY,oCAAoCuK,eACnInJ,EAAakH,OAAO7B,KAAK,QAAQ8B,KAAK8B,IAC/B,GAOXnC,iBAAkB,SAA0BsC,GAC1C,IACAC,EAAQnM,EAAEoM,WACNjN,EAAS,CACXkN,QAASH,EACTxD,MAAO,GACPD,OAAQ,IAMV,OAXWrJ,KAQNH,YAAYqN,aAAanN,GAAQoN,QAAO,SAAUnH,GACrD+G,EAAMK,QAAQpH,MAET+G,EAAMM,aAIjBhO,OAAO0C,SAASC,SAAS,yDAA0D,CAAC,mBAAoB,cAAe,WAAY3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAASqL,SCtfnLjO,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,uDAAwD,GAAI,CAMlGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAMNwN,mBAAqB,YANfxN,KAONyN,kBAAoB,WAPdzN,KAUN0N,mBAAqBrO,OAAOgD,aAAaC,YAAY,sBAV/CtC,KAaNE,cAAc,CACjByN,iBAAkBtO,OAAOe,YAAY,wDAAwDC,OAAO,kCAIxGC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAGdE,WAAY,WACCV,KACNW,IAAI,6BAA8BC,EAAEC,MAD9Bb,KACyC4N,gCADzC5N,QAOb4N,gCAAiC,SAAyC7M,EAAOhB,GAC/E,IAAIgD,EAAO/C,KACX+C,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAC3CmB,EAAKE,aAAaC,QAElB,IAAIC,EAAkBJ,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GACjE,OAAOA,EAASb,KAAO2B,EAAKhD,OAAOkB,KAAKC,sBACvC,GAEH,GAAIiC,EAAgBgI,UAAW,CAC7BpI,EAAK8K,iBAAiB1K,GAEtB,IAAIQ,EAAe,CACjBmK,KAAM,CACJC,SAAUhL,EAAKiL,iBAAiB,IAAI7D,KAAKpH,EAAKkL,aAAa9K,OAG3D+K,EAAqBnL,EAAKoL,mBAAmBhL,GAAiB,GAElEvC,EAAE4K,KAAK0C,EAAmBE,UAAU1C,MAAK,SAAU2C,GACjDH,EAAqBtN,EAAElB,OAAOwO,EAAoB,CAChDE,SAAUC,IAEZtL,EAAKuL,aAAa1N,EAAElB,OAAOiE,EAAamK,KAAMI,SAKpDI,aAAc,SAAsB3K,GAClC,IACIX,EADOhD,KACSiD,aAAaC,QAC7BqL,EAFOvO,KAEgBI,YAAY,kBAEnCoO,EAAenP,OAAOuI,KAAKC,cAAc4G,gBAAgB,IAAItE,KAAKA,KAAKuE,MAAwC,GAAhC/K,EAAayK,SAASO,QAAe,KAAO,MAAM,GAEjIC,EAA8BvP,OAAOgD,aAAaC,YAAY,qCAAuCqB,EAAakL,iBACtHlL,EAAamL,YAAcF,EAA4BhC,QAAQ,KAAM4B,GAErED,EACA9N,OAAOkD,GACPoL,SAAS/L,GAGT,IAAIgM,EAAoBpO,EAAE,kCAAmCoC,GACzDiM,EAAkBrO,EAAE,wBAAyBoC,GAAUsG,QAC3D0F,EAAkBE,IAAI,gBAAiBD,EAAkB,GAAGE,WAAa,MAEjDvO,EAAE,iCAAkCoC,GAE1CkM,IAAI,QAASvL,EAAayL,WAAa,MAI3DvB,iBAAkB,SAA0B5L,GAE1C,OAAIA,EAASqJ,YACXrJ,EAASoN,aAFArP,KAEoByN,kBAFpBzN,KAGGyN,oBAGZxL,EAASoN,aANArP,KAMoBwN,mBANpBxN,KAOGwN,qBAGhBS,aAAc,SAAsBhM,GAElC,OAAIA,EAASoN,eADFrP,KACwBwN,mBAC1BvL,EAASkJ,UAETlJ,EAASqJ,YAGpB6C,mBAAoB,SAA4BlM,GAC9C,IACI+D,EAAW,CACbsJ,SAAU,KACVF,WAAY,IACZP,gBAAiB,KACjBT,SAAU,MAERrO,EAAS,GACb,OAAQkC,EAASoN,cACf,KATSrP,KASCwN,mBACRxH,EAAS6I,gBAAkB,SAC3B7I,EAASsJ,SAXFtP,KAWkBuP,kCAAkCtN,GAE3DlC,EAAS,CACP0D,OAAQpE,OAAOmE,YAAYC,OAC3BsK,SAAU9L,EAASkJ,UACnBqE,OAAQrF,KAAKuE,OAEf1I,EAASoI,SAlBFpO,KAkBkByP,yBAAyB1P,GAElD,MACF,KArBSC,KAqBCyN,kBACRzH,EAASsJ,SAAW,OACpBtJ,EAAS6I,gBAAkB,SAC3B9O,EAAS,CACP0D,OAAQpE,OAAOmE,YAAYC,OAC3BsK,SAAU9L,EAASqJ,WACnBkE,OAAQrF,KAAKuE,OAEf1I,EAASoI,SA7BFpO,KA6BkByP,yBAAyB1P,GAGtD,OAAOiG,GAGT0J,YAAa,SAAqBzN,GAEhC,OADWjC,KACCmO,mBAAmBlM,GAAUqN,UAE3CK,cAAe,SAAuB1N,GAEpC,OADWjC,KACCmO,mBAAmBlM,GAAUmN,YAE3CQ,iCAAkC,SAA0C3N,GAE1E,OADWjC,KACCmO,mBAAmBlM,GAAU4M,iBAE3CgB,YAAa,SAAqB5N,GAEhC,OADWjC,KACCmO,mBAAmBlM,GAAUmM,UAG3CmB,kCAAmC,SAA2CtN,GAC5E,IACI+D,EAAW,MACX/D,EAAS+H,sBACPG,KAAKuE,MAAQzM,EAAS+H,sBAGtBhE,GAFe,IAAImE,MAAO2F,eAAiB,IAAI3F,KAAKlI,EAAS+H,qBAAqB8F,aAEvE,SAGA,UAIjB,OAAO9J,GAGTgI,iBAAkB,SAA0B+B,GAK1C,OAJW/P,KACY0N,mBAAmBsC,WACzBD,EAAQE,YAEQ,IAAM5Q,OAAOuI,KAAKC,cAAcqI,WAAWH,EAAS,cAAe1Q,OAAOgD,aAAaC,YAAY,wBAMtImN,yBAA0B,SAAkC1P,GAC1D,IACIoQ,EAAIvP,EAAEoM,WAMV,OALApM,EAAE4K,KAFSxL,KAGNH,YAAYuQ,qBAAqBrQ,IACtC2L,MAAK,SAAUxF,GACbiK,EAAE/C,QAAQlH,MAELiK,EAAE9C,aAKbhO,OAAO0C,SAASC,SAAS,uDAAwD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAAS6L,OAAO,GC/M5KzO,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,2DAA4D,GAAI,CAKtGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAKNmE,QAAU,GALJnE,KAMN4C,UAAY,GANN5C,KASNE,cAAc,CACjBmQ,qBAAsBhR,OAAOe,YAAY,4DAA4DC,OAAO,mCAC5GiQ,2BAA4BjR,OAAOe,YAAY,4DAA4DC,OAAO,2CAItHC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAGdE,WAAY,WACCV,KACNW,IAAI,6BAA8BC,EAAEC,MAD9Bb,KACyC6C,kCADzC7C,OAAAA,KAENW,IAAI,+BAAgCC,EAAEC,MAFhCb,KAE2CuQ,6BAF3CvQ,QAQb6C,kCAAmC,SAA2C9B,EAAOhB,GACnF,IAAIgD,EAAO/C,KACX+C,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAC3C,IAAIoB,EAAWD,EAAKE,aAAaC,QAE7BsN,EAAiBzN,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GAChE,OAAOA,EAASb,GAAGkC,eAAiBP,EAAKhD,OAAOkB,KAAKC,mBAAmBoC,iBACvE,GAECK,EAAe,CACnB8M,wBAAuC,GACvC9M,EAAauH,SAAW,CACtBA,SAAUsF,EAAetF,SACzBwF,QAAyC,IAAhCF,EAAejF,MAAMvC,QAG5BrF,EAAauH,SAASA,WACxBvH,EAAa8M,wBAA0B9M,EAAauH,SAASA,UAI5CnI,EAAK3C,YAAY,sBACvBK,OAAOkD,GAAcoL,SAAS/L,GAE3CD,EAAKoB,QAAQwM,kBAAoB5N,EAAK6N,8BAEtC,IAAID,EAAoB5N,EAAKoB,QAAQwM,kBAErC5N,EAAK8N,iBAAmB,CACtBC,eAAgBlQ,EAAE,kBAAmB+P,GAAmBI,OAAO,CAC7DC,YAAa,aACbC,MAAO,MACP1I,IAAK,IACLe,MAAO,IACP4H,KAAM,EACNC,GAAI,GACJC,KAAM,EACNnK,MAAOtD,EAAa8M,wBACpBY,MAAOzQ,EAAEC,MAAMkC,EAAKuO,uBAAwBvO,GAC5CuE,OAAQ1G,EAAEC,MAAMkC,EAAKuO,uBAAwBvO,KAC/CwO,MAAK,WAEH,IADA,IAAIC,EAAO5Q,EAAEZ,MAAM+Q,OAAO,SAAU,OAASnQ,EAAEZ,MAAM+Q,OAAO,SAAU,OAC7DU,EAAI,EAAGA,GAAKD,EAAMC,GAAK,GAAI,CAClC,IAAIC,EAAK9Q,EAAE,uBAAyB6Q,EAAI,YAAYvC,IAAI,OAAQuC,EAAID,EAAO,IAAM,KACjF5Q,EAAEZ,MAAMgE,OAAO0N,OAGnBC,qBAAsB/Q,EAAE,+BAAgC+P,GAAmBtI,QAAQ,CACjFuJ,OAAQ,KACRtJ,IAAK,EACLC,IAAK,IACLE,KAAM7H,EAAEC,MAAMkC,EAAK8O,+BAAgC9O,GACnDuE,OAAQ1G,EAAEC,MAAMkC,EAAK8O,+BAAgC9O,GACrDkE,MAAOtD,EAAa8M,wBACpBqB,SAAU,IAEZC,qBAAsBnR,EAAE,iCAAkC+P,GAC1DjM,aAAc9D,EAAE,iCAAkC+P,IAIpD/P,EAAE,mCAAoCoC,GAAU4B,GAAG,QAAShE,EAAEC,MAAMkC,EAAKiP,wBAAyBjP,IAElGA,EAAK8N,iBAAiBnM,aAAaE,GAAG,QAAShE,EAAEC,MAAMkC,EAAKkP,cAAelP,IAC3EA,EAAK8N,iBAAiBkB,qBAAqBnN,GAAG,QAAShE,EAAEC,MAAMkC,EAAKmP,2BAA4BnP,IAEhGA,EAAKoP,iBAAiBxO,EAAa8M,yBACnC1N,EAAK8N,iBAAiBc,qBAAqBtJ,QAAQ,QAAS1E,EAAa8M,0BAI3EF,6BAA8B,SAAsCxP,EAAOhB,GACzE,IACIqS,EAAYrS,EAAO6B,KAAK2J,MACxB8G,EAAetS,EAAO6B,KAAKyQ,aAG3BD,EAAUpJ,OAAS,EAErBpI,EAAE,mCAPOZ,KAOkCQ,SAAS8R,OAEpD1R,EAAE,mCATOZ,KASkCQ,SAAS+R,OAGtD3R,EAAE,wBAZSZ,KAYqBQ,SAASgS,KAAKH,GAC9CzR,EAAE,sBAbSZ,KAamBQ,SAAS0O,IAAI,QAASmD,EAAe,MAIrEF,iBAAkB,SAA0BM,GAC1C,IACAzP,EADWhD,KACKiD,aAEhBrC,EAAE,wBAAyBoC,GAAUwP,KAAKC,GAG1C,IAAIzD,EAAoBpO,EAAE,kCAAmCoC,GACzDiM,EAAkBrO,EAAE,wBAAyBoC,GAAUsG,QAC3D0F,EAAkBE,IAAI,gBAAiBD,EAAkB,GAAGE,WAAa,MAEjDvO,EAAE,iCAAkCoC,GAE1CkM,IAAI,QAASuD,EAAmBtD,WAAa,MAIjEyB,4BAA6B,WAC3B,IACI8B,EADO1S,KAC0BI,YAAY,4BAEjD,OAHWJ,KAEN4C,UAAU0C,YAAcoN,EAA0BjS,SAF5CT,KAGC4C,UAAU0C,aAOxB0M,wBAAyB,WACvB,IAAIjP,EAAO/C,KAEX+C,EAAKH,UAAU0C,YAAY4D,OAAO,CAChCC,WAAW,EACXC,WAAW,EACXC,OAAQ,OACRC,MAAO,QACPC,OAAO,EACPC,MAAOnK,OAAOgD,aAAaC,YAAY,0CACvCmH,UAAU,EACVC,KAAM9I,EAAEC,MAAMkC,EAAK4P,gBAAiB5P,GACpC6G,MAAO,WACL7G,EAAKH,UAAU0C,YAAY4D,OAAO,WAClCnG,EAAKH,UAAU0C,YAAYsN,YAI/B7P,EAAK8P,qBAAuB9P,EAAK8N,iBAAiBC,eAAeC,OAAO,UAI1Ec,+BAAgC,SAAwC9Q,GACtE,IACIkH,EADOjI,KACS6Q,iBAAiBc,qBAAqBtJ,QAAQ,SADvDrI,KAEN6Q,iBAAiBC,eAAeC,OAAO,QAAS9I,IAGvDqJ,uBAAwB,SAAgCvQ,GACtD,IACIkH,EADOjI,KACS6Q,iBAAiBC,eAAeC,OAAO,SADhD/Q,KAEN6Q,iBAAiBc,qBAAqBtJ,QAAQ,QAASJ,IAG9DgK,cAAe,SAAuBlR,GACpCA,EAAM4J,iBACK3K,KAEN4C,UAAU0C,YAAY4D,OAAO,WAFvBlJ,KAGN4C,UAAU0C,YAAYsN,SAHhB5S,KAKN6Q,iBAAiBC,eAAeC,OAAO,QALjC/Q,KAK+C6S,sBAL/C7S,KAMN6Q,iBAAiBc,qBAAqBtJ,QAAQ,QANxCrI,KAMsD6S,uBAGnEX,2BAA4B,SAAoCnR,GAC9DA,EAAM4J,iBACN,IAAI5H,EAAO/C,KAEX+C,EAAK8N,iBAAiBkB,qBAAqBe,KAAK,YAAY,GAE5D,IAAItC,EAAiBzN,EAAKhD,OAAOkB,KAAKmC,WAAWC,QAAO,SAAUpB,GAChE,OAAOA,EAASb,IAAM2B,EAAKhD,OAAOkB,KAAKC,sBACtC,GACCnB,EAASa,EAAElB,OAAO8Q,EAAgB,CACpCtF,SAAUnI,EAAK8N,iBAAiBc,qBAAqBtJ,QAAQ,SAC7DlH,OAAQ4B,EAAKhD,OAAOkB,KAAKG,KAE3BR,EAAE4K,KAAKzI,EAAKlD,YAAY4L,iBAAiB1L,IAAS2L,MAAK,WACrD3I,EAAK8N,iBAAiBkB,qBAAqBe,KAAK,YAAY,GAC5DtC,EAAetF,SAAWnI,EAAK8N,iBAAiBc,qBAAqBtJ,QAAQ,SAC7EtF,EAAKoP,iBAAiB3B,EAAetF,UACrCnI,EAAKH,UAAU0C,YAAY4D,OAAO,WAClCnG,EAAKH,UAAU0C,YAAYsN,eAMjCvT,OAAO0C,SAASC,SAAS,2DAA4D,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAASiJ,WAAW,GC9NpL7L,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,+DAAgE,GAAI,CAI1GC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAMNE,cAAc,CACjB6S,uBAAwB1T,OAAOe,YAAY,gEAAgEC,OAAO,oDAClH2S,gDAAiD3T,OAAOe,YAAY,gEAAgEC,OAAO,4EAO/IC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAMdE,WAAY,eAMdrB,OAAO0C,SAASC,SAAS,+DAAgE,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAASgR,eCnC7K5T,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,yDAA0D,GAAI,CAKpGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAMNE,cAAc,CACjBgT,mBAAoB7T,OAAOe,YAAY,0DAA0DC,OAAO,oCAI5GC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAGdE,WAAY,WACCV,KACNW,IAAI,6BAA8BC,EAAEC,MAD9Bb,KACyC6C,kCADzC7C,QAQb6C,kCAAmC,SAA2C9B,EAAOhB,GACnF,IAAIgD,EAAO/C,KACX+C,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAC3C,IAAIoB,EAAWD,EAAKE,aAAaC,QAEjCtC,EAAE4K,KAAKzI,EAAKlD,YAAYsT,cAAc,CAAEhS,OAAQ4B,EAAKhD,OAAOkB,KAAKG,MAAOsK,MAAK,SAAU0H,GAErF,GADArQ,EAAKhD,OAAOkB,KAAKoS,OAASD,EACtBrQ,EAAKhD,OAAOkB,KAAKoS,OAAQ,CAC3B,IAAI1P,EAAe,GACnBA,EAAa0P,OAAS,CACpBC,SAAUvQ,EAAKhD,OAAOkB,KAAKoS,OAAOE,UAClCC,WAAYzQ,EAAKhD,OAAOkB,KAAKoS,OAAOI,YACpCvH,OAAQnJ,EAAKhD,OAAOkB,KAAKoS,OAAOnH,OAChCwH,WAAY3Q,EAAKhD,OAAOkB,KAAKoS,OAAOK,WACpCC,WAAY5Q,EAAKhD,OAAOkB,KAAKoS,OAAOM,WACpCC,OAAQ7Q,EAAKhD,OAAOkB,KAAKoS,OAAOO,QAIZ7Q,EAAK3C,YAAY,oBAEvCK,OAAOkD,GACPoL,SAAS/L,GAETpC,EAAE,qBAAsBoC,GAAU4B,GAAG,QAAShE,EAAEC,MAAMkC,EAAK8Q,sBAAuB9Q,SAOxF8Q,sBAAuB,SAA+B9S,GACpDA,EAAM4J,iBACK3K,KACN8T,eAAelT,EAAEG,EAAMmH,QAAQ6L,QAAQ,0BAIhD1U,OAAO0C,SAASC,SAAS,yDAA0D,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAASoR,SAAS,GCtEhLhU,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,wDAAyD,GAAI,CAInGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAENgU,SAAW,GAFLhU,KAGNmE,QAAU,GAHJnE,KAINiU,iBAAmB,GAJbjU,KAKNkU,sBAAwB7U,OAAO0C,SAASoS,IAAI,yBALtCnU,KAMNoU,eAAiB,GANXpU,KASNC,OAAOL,EAAkBC,EAAaE,GAThCC,KAaNE,cAAc,CACjBmU,kBAAmBhV,OAAOe,YAAY,gDAAgDC,OAAO,0BAOjGC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAMdE,WAAY,WACCV,KACNW,IAAI,6BAA8BC,EAAEC,MAD9Bb,KACyC6C,kCADzC7C,QAObsU,gBAAiB,SAAyBrS,GACxC,OAA8B,OAAvBA,EAASkJ,WAA8C,OAAxBlJ,EAASqJ,YAGjDzI,kCAAmC,SAA2C9B,EAAOhB,GACnF,IAAIgD,EAAO/C,KACXuU,EAAe,GACfC,EAAkB,GAClBxR,EAAWD,EAAKE,aAAaC,QAC7BH,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAE3C,IAAI6S,EAAc1R,EAAKhD,OAAOkB,KAAKsC,cAC/BmR,EAAgB3R,EAAKhD,OAAOkB,KAAKsC,cAErCiR,EAAgBG,KAAK,CAAElR,OAAUgR,EAAaG,SAAYF,EAAeG,SAAY,CAAC,WACtF9R,EAAKiR,SAAS,IAAMS,EAAc,KAAO,CACvCK,QAAS,GACT1T,GAAIqT,EACJM,KAAML,EACN7Q,KAAM,GACNgR,SAAU,CAAC,UAEbN,EAAaI,KAAKD,GAClB9T,EAAE2Q,KAAKxO,EAAKhD,OAAOkB,KAAKmC,YAAY,SAAU4R,EAAO/S,GACnD,GAAIc,EAAKuR,gBAAgBrS,GAAW,CAClC,IAAIgT,EAAShT,EAASyB,aAClBwR,EAAWjT,EAASkT,iBACxB,GAAIF,IAAWR,GAC+C,IAAxD7T,EAAEwU,QAAQ,WAAYZ,EAAgB,GAAGK,YAC3CL,EAAgB,GAAGK,SAASF,KAAK,YACjC5R,EAAKiR,SAAS,IAAMS,EAAc,KAAKI,SAASF,KAAK,kBAUvD,GANA5R,EAAKiR,SAAS,IAAMiB,EAAS,KAAO,CAClCH,QAAS,GACT1T,GAAI6T,EACJpR,KAAM,GACNgR,SAAU,CAAC,aAE0E,IAAnFL,EAAgBnR,QAAO,SAAU2D,GAAO,OAAOA,EAAKvD,QAAUwR,KAAUjM,OAAc,CACxF,IAAI5H,EAAK8T,GAAsBD,EAC/BT,EAAgBG,KAAK,CAAElR,OAAUrC,EAAI8T,SAAY9T,EAAIyT,SAAY,CAAC,cAClEN,EAAaI,KAAKvT,QAK1B2B,EAAKyR,gBAAkBA,EAGDzR,EAAK3C,YAAY,mBAEvCK,OAAO,CACL8D,SAAUxB,EAAKsS,cAAcb,GAC7BzN,MAAO1H,OAAOgD,aAAaC,YAAY,sCAEzCyM,SAAS/L,GACTD,EAAKuS,wBACL1U,EAAE4K,KAAKzI,EAAKyH,iBAAiB+J,IAAe9J,MAAK,WAC/C1H,EAAKwS,uBAAuBd,GAC5B1R,EAAKyS,kCAQTH,cAAe,SAAuBI,GACpC,IAAIC,EAAgB,GAMpB,OALAD,EAAS7O,KAAI,SAAUI,GACrB,IAAI2O,GAA8C,IAApC3O,EAAK6N,SAASe,QAAQ,SAChCC,GAAoD,IAAvC7O,EAAK6N,SAASe,QAAQ,YACvCF,EAAcf,KAAKmB,aAAaC,mBAAmB/O,EAAKvD,OAAQ,GAAI,GAAI,GAAI,GAAI,GAAIoS,EAAYF,EAAS,GAAI,QAExGG,aAAaT,cAAcK,IAOpCH,uBAAwB,SAAgCd,GACtD,IACIuB,EADOhW,KACYgU,SAAS,IAAMS,EAAc,KAChDwB,EAAWH,aAAaC,mBAC5BC,EAAY5U,GACZ4U,EAAYnS,KACZmS,EAAYE,SACZF,EAAYlB,QAAUkB,EAAYlB,aAAUnN,EAC5CqO,EAAYG,MACZH,EAAYnS,KAAKuS,eACjB,GACA,EACA,GACA,IAZWpW,KAcNQ,QAAQuI,KAAK,6EAA6EsN,gBAdpFrW,KAc0G,CAAEgH,KAAMiP,KAO/HT,4BAA6B,WAC3B,IAAIzS,EAAO/C,KACXY,EAAE2Q,KAAKxO,EAAKiR,UAAU,SAAUvC,EAAG6E,GACjC,IAAIC,EAAM3V,EAAE,yCAA2C0V,EAAIlV,GAAK,IAAK2B,EAAKvC,SACtD,KAAhB8V,EAAIxB,QACNyB,EAAIxN,KAAK,OAAO+J,KAAK,MAAOwD,EAAIxB,UAGhCyB,EAAIxN,KAAK,OAAOuJ,YACC3K,IAAb2O,EAAIzS,KACN0S,EAAIxN,KAAK,QAAQ8B,KAAKyL,EAAIzS,KAAKuS,eAG/BI,QAAQC,IAAI,6BAKlB7V,EAAE,4BAA6BmC,EAAKvC,SAASkW,IAAI,cAAc9R,GAAG,cAAc,SAAU+R,GACxF,IAEIC,EAFAC,EAAUjW,EAAE+V,EAAGzO,QACf+M,EAASrU,EAAEZ,MAAMkG,KAAK,UAE1BtF,EAAE2Q,KAAKxO,EAAKiR,UAAU,SAAUvC,EAAG6E,GAC7BA,EAAIlV,KAAO6T,IACf2B,EAAeN,MAEjB,IAAIQ,EAAkB/T,EAAKqR,eAAerL,MAAK,SAAUxE,GACvD,OAAOA,EAASb,eAAiBkT,EAAaxV,MAE5CgC,EAAa,GACb0T,GACJA,EAAgB1T,WAAWwD,KAAI,SAAU3E,GACvCmB,EAAWuR,KAAK1S,EAAS4B,SAE3B,IAAIkT,EAAYjB,aAAaC,mBAAmBa,EAAaxV,GAAIwV,EAAa/S,KAAM+S,EAAaV,SAAUU,EAAa9B,QAAS8B,EAAaT,MAAOS,EAAa/S,KAAKuS,cAAerT,EAAKiU,cAAcJ,GAAe7T,EAAKkU,WAAWL,GAAexT,OAAYuE,GAEnQkP,EAAQxD,SAAS6D,YAAYnU,EAAM,CAAEmF,OAAQ2O,EAAS7P,KAAM+P,QAIhEC,cAAe,SAAuBJ,GACpC,OAAIA,EAAa/B,SAASe,QAAQ,aAAe,GAMnDqB,WAAY,SAAoBL,GAC9B,OAAIA,EAAa/B,SAASe,QAAQ,UAAY,GAQhDpL,iBAAkB,SAA0B+J,GAC1C,IACAxU,EADIgD,EAAO/C,KAEX+M,EAAQnM,EAAEoM,WA0BV,OAzBAjN,EAAS,CACPoX,WAAY5C,EAAa6C,OACzB9N,MAAO,GACPD,OAAQ,IAEVzI,EAAE4K,KAAKzI,EAAKlD,YAAYqN,aAAanN,IAASoN,QAAO,SAAUnH,GAC7DjD,EAAKkR,iBAAmBjO,EACxB,IAAK,IAAIyL,EAAI,EAAGzI,EAAShD,EAASgD,OAAQyI,EAAIzI,EAAQyI,GAAK,OACzB,IAArBzL,EAASyL,GAAG5N,KACrBxE,OAAOoX,IAAIzQ,EAASyL,GAAK,gBAAiBzL,EAAU,SAEhDjD,EAAKiR,SAAS,IAAMhO,EAASyL,GAAGrQ,GAAK,MACvC2B,EAAKiR,SAAS,IAAMhO,EAASyL,GAAGrQ,GAAK,KAAK0T,SAAW9O,EAASyL,GAAGqD,QAAU,yBAA2B9O,EAASyL,GAAGqD,QAAU,GAC5H/R,EAAKiR,SAAS,IAAMhO,EAASyL,GAAGrQ,GAAK,KAAKyC,KAAOmC,EAASyL,GAAG5N,MAAQ,GACrEd,EAAKiR,SAAS,IAAMhO,EAASyL,GAAGrQ,GAAK,KAAK8U,SAAWlQ,EAASyL,GAAGyE,UAAY,GAC7EnT,EAAKiR,SAAS,IAAMhO,EAASyL,GAAGrQ,GAAK,KAAK+U,MAAQnQ,EAASyL,GAAG0E,OAAS,IAGvEK,QAAQC,IAAI,2BAIlB1T,EAAKsU,oBACLtK,EAAMK,aAEDL,EAAMM,WAGfgK,kBAAmB,WAEjB,IADA,IACS5F,EAAI,EAAGA,EADLzR,KACciU,iBAAiBjL,OAAQyI,IADvCzR,KAEJoU,eAAeO,KAFX3U,KAEqBsX,gBAFrBtX,KAE0CiU,iBAAiBxC,MAKxE6F,gBAAiB,SAAyBtQ,GACxC,IAAIjE,EAAO/C,KACPuX,EAAQ,GACZ3W,EAAE2Q,KAAKxO,EAAKhD,OAAOkB,KAAKmC,YAAY,SAAU4R,EAAO/S,GACtCA,EAASyB,eACPsD,EAAK5F,IAAM2B,EAAKuR,gBAAgBrS,IAC7CsV,EAAM5C,KAAK,CAAE9Q,KAAQ5B,EAAS4B,UAGlCmD,EAAKuQ,MAAQA,EACb,IAAIC,EAAQzU,EAAKyR,gBAAgBzL,MAAK,SAAU0O,GAC9C,OAAOA,EAAQhU,QAAUuD,EAAK5F,MAgBhC,OAdA4F,EAAK6N,SAAW2C,EAAM3C,SAEFiB,aAAaC,mBACjC/O,EAAK5F,GACL4F,EAAKnD,KACLmD,EAAKkP,SACLlP,EAAK8N,QAAU,yBAA2B9N,EAAK8N,aAAUnN,EACzDX,EAAKmP,MACLnP,EAAKnD,KAAKuS,cACVrT,EAAKiU,cAAchQ,GACnBjE,EAAKkU,WAAWjQ,GAChBA,EAAKuQ,MACL,KAKFjC,sBAAuB,WACrB,IAAIvS,EAAO/C,KACXY,EAAE,cAAc8W,OAAM,SAAU3W,GAC9BA,EAAM4J,iBACN5J,EAAM4W,kBACN,IAAIvD,EAAiBrR,EAAKqR,gBAAkB,GAC5CrR,EAAKmR,sBAAsB0D,QAAQ,mBAAoB,CACrDC,WAAYxY,OAAOC,WAAWC,QAAQgO,OAAOuK,qCAC7CC,cAAc,EACd7R,KAAMkO,EACN3K,UAAU,EACVuO,gBAAiB,CACfxO,MAAOnK,OAAOgD,aAAaC,YAAY,kCAAoC,KAAO8R,EAAepL,OAAS,IAC1GM,MAAO,IACPD,OAAQ,IACR4O,cAAc,WAQxB5Y,OAAO0C,SAASC,SAAS,wDAAyD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyB,KAAKgB,SAAS4E,QAAQ,GCxS9KxH,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,mDAAoD,GAAI,CAO9FwY,8BAA+B,SAAuCvB,EAAI5W,GAC7DC,KACNmY,uBAAuBpY,EAAOqY,0BAQrCD,uBAAwB,SAAgCC,GAC3CpY,KAENW,IAAI,iCAAkCC,EAAEC,MAFlCb,KAE6CkY,8BAF7ClY,OAIXY,EAAE,+BAA+ByX,OAAOD,GACxCxX,EAAE,kCAAkCyX,QAAQD,GALjCpY,KAMND,OAAOqY,wBAA0BA,GAMxCvW,MAAO,WACM7B,KACN0M,MAAM,iCAAkC9L,EAAEC,MADpCb,KAC+CkY,8BAD/ClY,UAKfX,OAAO0C,SAASC,SAAS,mDAAoD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQ8Y,UAAUrT,OAAO,GCrCpK5F,OAAOC,WAAWC,QAAQC,QAAQ8Y,UAAUrT,KAAKvF,OAAO,iEAAkE,GAAI,CAK5HC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KACND,OAASA,GAAU,GADbC,KAINC,OAAOL,EAAkBC,EAAaE,GAJhCC,KAONE,cAAc,CACjBqY,yBAA0BlZ,OAAOe,YAAY,0EAA0EC,OAAO,+BAOlIC,cAAe,WAGb,OAFWN,KACNQ,QAAUI,EAAE,eADNZ,KAECQ,SAMdE,WAAY,WACV,IAAIqC,EAAO/C,KACX+C,EAAK9C,SAEL8C,EAAKhD,OAAOyY,iCAAiCC,SAAQ,SAAUC,GAC7D3V,EAAKpC,IAAI+X,EAAS9X,EAAEC,MAAMkC,EAAK4V,WAAY5V,QAS/C4V,WAAY,SAAoB5X,EAAOhB,GACrC,IAAIgD,EAAO/C,KACX+C,EAAKhD,OAASa,EAAElB,OAAOqD,EAAKhD,OAAQA,EAAO6B,MAC3CmB,EAAKlB,QACL,IAAImB,EAAWD,EAAKE,aAAaC,QAE7BS,EAAe,CACjBiV,iBAAkB7V,EAAKhD,OAAO8Y,cAAcD,iBAC5CE,iBAAkB/V,EAAKhD,OAAO8Y,cAAcC,iBAC5CC,uBAAwBhW,EAAKhD,OAAO8Y,cAAcE,uBAClDC,oBAAqBjW,EAAKhD,OAAO8Y,cAAcG,oBAC/CC,uBAAwBlW,EAAKhD,OAAO8Y,cAAcI,uBAClDC,mBAAoBnW,EAAKhD,OAAO8Y,cAAcK,mBAC9CC,sBAAuBpW,EAAKhD,OAAO8Y,cAAcM,sBACjDC,8BAA+BrW,EAAKhD,OAAO8Y,cAAcO,8BACzDC,eAAgBtW,EAAKhD,OAAOkB,KAAKoY,gBAIpBtW,EAAK3C,YAAY,0BACvBK,OAAOkD,GAAcoL,SAAS/L,GAEnCD,EAAKhD,OAAO6L,4BACdhL,EAAE,oBAAsBG,EAAMY,KAAK2B,cAAgB,KAAMP,EAAKvC,SAASgM,SAAS,UAAU8M,WAAWlU,YAAY,UAGnHrC,EAAKoV,uBAAuBpV,EAAKhD,OAAOqY,yBACxCrV,EAAKwW,gBAEL,IAAIC,EAAgB,CAAErY,OAAQ4B,EAAKhD,OAAOkB,KAAKG,IAC/CR,EAAE4K,KAAKzI,EAAK0W,YAAYD,IAAgB/O,MAAK,SAAUiP,GACrD9Y,EAAElB,OAAOqD,EAAKhD,OAAOkB,KAAMyY,GAC3B3W,EAAKrB,IAAI,SAAU,CACjBC,KAAM,iBACNC,KAAMmB,EAAKhD,aAQjB4Z,gBAAiB,SAAyB5Y,GACxC,IAAIgC,EAAO/C,KACXe,EAAM4J,iBACN,IAAIiP,EAAQhZ,EAAEG,EAAMmH,QAAQ6L,QAAQ,MAE/B6F,EAAM5N,SAAS,WAClBpL,EAAE4K,KAAKnM,OAAOuI,KAAKiS,YAAYnO,MAAK,WAClC9K,EAAEkZ,UAAU5T,KAAK,YAAa,IAE9B,IAAI0F,EAA6BgO,EAAM1T,KAAK,WAC5C,GAAI0F,EAA4B,CAC9B,IAAImO,EAAoBhX,EAAKrB,IAAI,SAAU,CAAEC,KAAM,uBAG/CqY,EAFwB5R,SAAS2R,EAAkB,IAIvDhX,EAAKhD,OAAOka,2BAA4B,EACxClX,EAAKrB,IAAI,SAAU,CACjBC,KAAMiK,EAA2BtI,cACjC1B,KAAMhB,EAAElB,OAAOqD,EAAKhD,OAAQ,CAAE6L,2BAA4BA,EACxDsO,SAPoB,GAQpBC,MAAOH,MAEXpZ,EAAE,oBAAsBmC,EAAKhD,OAAO6L,2BAA2BtI,cAAgB,KAAMP,EAAKvC,SAASgM,SAAS,UAAU8M,WAAWlU,YAAY,eAUrJqU,YAAa,SAAqB1Z,GAChC,IACIgN,EAAQnM,EAAEoM,WAUd,OAXWhN,KAENH,YAAYua,QAAQra,GAAQoN,QAAO,SAAUnH,GACxB,MAApBA,EAASqU,QAAsC,MAApBrU,EAASqU,aAAsC1S,IAApB3B,EAASqU,OACjEtN,EAAMK,QAAQpH,GAGd+G,EAAMuN,YAIHvN,EAAMM,WAGfkN,eAAgB,WACd,IACI/Z,EADOR,KACQiD,aACfuX,EAAY5Z,EAAE,wCAAyCJ,GACvDia,EAAS7Z,EAAE,qCAAsCJ,GACjDka,EAAY9Z,EAAE,wCAAyCJ,GAE3DI,EAAE,sCAAuCJ,GAASoE,GAAG,SAAS,WAC5D4V,EAAUnC,SACVoC,EAAOpC,SACPqC,EAAUrC,aAOdkB,cAAe,WACb,IACI/Y,EADOR,KACQiD,aADRjD,KAENua,iBACL3Z,EAAE,oCAAqCJ,GAASoE,GAAG,QAAShE,EAAEC,MAHnDb,KAG8D2Z,gBAH9D3Z,QASb6B,MAAO,WACL,IAAIkB,EAAO/C,KACPQ,EAAUuC,EAAKE,aAEnBF,EAAK9C,SAED8C,EAAKhD,QAAUgD,EAAKhD,OAAOyY,kCAC7BzV,EAAKhD,OAAOyY,iCAAiCC,SAAQ,SAAUC,GAC7D3V,EAAK2J,MAAMgM,EAAS9X,EAAEC,MAAMkC,EAAK4V,WAAY5V,OAIjDnC,EAAE,oCAAqCJ,GAASma,SAKpDtb,OAAO0C,SAASC,SAAS,iEAAkE,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQ8Y,UAAUrT,KAAKhD,SAAShB,OAAO,GClLhM5B,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,sDAAuD,GAAI,CAKjGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAMNE,cAAc,CACjB0a,4BAA6Bvb,OAAOe,YAAY,8DAA8DC,OAAO,sCAQzHC,cAAe,WACb,IAEIC,EAFOP,KAESI,YAAY,6BAGhC,OALWJ,KAGNQ,QAAUD,EAASE,OAAO,IAHpBT,KAKCQ,SAEdE,WAAY,WAGVma,YAAW,WACTja,EAAEka,QAAQC,QAAQ,YACjB,QAMP1b,OAAO0C,SAASC,SAAS,sDAAuD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQgB,QAAQ8X,YAAY,GCxC1KjZ,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,+CAAgD,GAAI,CAQ1FC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,GAHhCC,KAINgb,yBAA2B,IAAI3b,OAAO4b,WAAWjb,MAJ3CA,KAONE,cAAc,CACjBgb,qBAAsB7b,OAAOe,YAAY,uDAAuDC,OAAO,+BACvG8a,0BAA2B9b,OAAOe,YAAY,uDAAuDC,OAAO,uCAC5G+a,uBAAwB/b,OAAOe,YAAY,uDAAuDC,OAAO,oCACzGgb,qBAAsBhc,OAAOe,YAAY,uDAAuDC,OAAO,qCAQ3GC,cAAe,WACb,IACIC,EADOP,KACSgb,yBAAyB1a,gBAE7C,OAHWN,KAENQ,QAAUD,EAASE,OAFbT,KAEyBsb,aAFzBtb,KAGCQ,SAMdE,WAAY,WACCV,KACNgb,yBAAyBta,cAMhC6a,kBAAmB,WACNvb,KACNgb,yBAAyBO,qBAMhCC,iBAAkB,WACLxb,KACNgb,yBAAyBQ,oBAMhCC,cAAe,WACFzb,KACNgb,yBAAyBS,iBAMhCC,aAAc,WACD1b,KACNgb,yBAAyBU,gBAQhCC,kBAAmB,SAA2Bpb,GAC5C,IACIyF,EADOhG,KACSgb,yBAAyBW,kBAAkBpb,GAC/DyF,EAAS4V,UAAU5X,OAAOgC,EAASzF,SAASE,OAAOuF,EAASsV,eAM9DO,qBAAsB,WACT7b,KACNgb,yBAAyBa,wBAGhCC,OAAQ,WACK9b,KACNgb,yBAAyBc,UAKhCC,kBAAmB,WACN/b,KACNgb,yBAAyBe,qBAGhCC,oBAAqB,WACRhc,KACNgb,yBAAyBgB,uBAMhCC,sBAAuB,WACVjc,KACNgb,yBAAyBiB,yBAMhCC,qBAAsB,WACTlc,KACNgb,yBAAyBkB,wBAMhCC,qBAAsB,WACTnc,KACNgb,yBAAyBmB,wBAKhCC,2BAA4B,WACfpc,KACNgb,yBAAyBoB,8BAOhCC,YAAa,SAAqBC,GACrBtc,KACNgb,yBAAyBqB,YAAYC,MAI9Cjd,OAAO0C,SAASC,SAAS,+CAAgD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyb,aCxJ/I5b,OAAOC,WAAWC,QAAQgd,aAAa7c,OAAO,0DAA2D,GAAI,CAK3G8c,YAAa,WACX,IACIC,EAAgB7b,EAAEka,QAAQzR,SAAW,GACrCqT,EAFO1c,KAEU2c,QAAQtT,SAAW,IAGxC,OAFgBzI,EAAE,qCAAqCyI,UAC1BoT,GACVC,KCXvBrd,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,qDAAsD,GAAI,CAKhGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNC,OAAOL,EAAkBC,EAAaE,IAE3CA,EAASA,GAAU,IACZ6c,YAAa,EANT5c,KASNE,cAAc,CACjB2c,2BAA4Bxd,OAAOe,YAAY,6DAA6DC,OAAO,gCAQvHC,cAAe,WACb,IAEIC,EAFOP,KAESI,YAAY,4BAGhC,OALWJ,KAGNQ,QAAUD,EAASE,OAAO,IAHpBT,KAKCQ,WAKhBnB,OAAO0C,SAASC,SAAS,qDAAsD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyC,SAASC,UCnC9J7C,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,gDAAiD,GAAI,CAI3FC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAGNuT,UAAYxT,EAAOwT,UAHbvT,KAMNC,OAAOL,EAAkBC,EAAaE,GANhCC,KASNE,cAAc,CACjB4c,sBAAuBzd,OAAOe,YAAY,wDAAwDC,OAAO,mCAO7GC,cAAe,WACb,IACIC,EADOP,KACSI,YAAY,uBAGhC,OAJWJ,KAGNQ,QAAUD,EAASE,OAAO,IAHpBT,KAICQ,SAMdE,WAAY,WACCV,KAGNW,IAAI,OAAQC,EAAEC,MAHRb,KAGmB2Y,WAHnB3Y,OAAAA,KAINW,IAAI,WAAYC,EAAEC,MAJZb,KAIuB2Y,WAJvB3Y,OAAAA,KAKNW,IAAI,WAAYC,EAAEC,MALZb,KAKuB2Y,WALvB3Y,OAAAA,KAMNW,IAAI,aAAcC,EAAEC,MANdb,KAMyB2Y,WANzB3Y,OAAAA,KAONW,IAAI,eAAgBC,EAAEC,MAPhBb,KAO2B2Y,WAP3B3Y,QAUb2Y,WAAY,SAAoB5X,EAAOhB,GACrC,IACA6B,EAAO7B,EAAO6B,KACdoB,EAFWhD,KAEKiD,aAAaC,QAEzBS,EAAe,CACnBoZ,YAA8B,IAC1Bnb,EAAKyN,aAAa,KACpB1L,EAA0B,YAAI/B,EAAKyN,aAAa,GAAG2N,OAP1Chd,KAWgBI,YAAY,uBAEvCK,OAAOG,EAAElB,OAAOkC,EAAM+B,IACtBoL,SAAS/L,GAdEhD,KAgBND,OAAS6B,KAIlBvC,OAAO0C,SAASC,SAAS,gDAAiD,CAAC,mBAAoB,cAAe3C,OAAOC,WAAWC,QAAQC,QAAQyd,cAAc,GCjE9J5d,OAAOC,WAAWC,QAAQgO,OAAO7N,OAAO,wDAAyD,GAAI,CAQnGC,KAAM,SAAcC,EAAkBC,EAAaE,GACtCC,KAENC,OAAOL,EAAkBC,EAAaE,GAFhCC,KAINE,cAAc,CACjBgd,kBAAmB7d,OAAOe,YAAY,wDAAwDC,OAAO,iCAL5FL,KAQNmd,MAAQ,GARFnd,KASNuT,UAAYxT,EAAOwT,WAM1BjT,cAAe,aAIfI,WAAY,WACCV,KACNoC,WADMpC,KACYsC,YAAY,cAAgB,IADxCtC,KACmDsC,YAAY,eAK5EiZ,kBAAmB,SAA2B/a,EAAS4c,GAErD5c,EAAQuI,KAAK,4CAA4CnE,GAAG,QAAShE,EAAEC,MAD5Db,KACuEqd,UADvErd,KACwFod,IACnG5c,EAAQuI,KAAK,kDAAkDnE,GAAG,QAAShE,EAAEC,MAFlEb,KAE6Esd,SAF7Etd,KAE6Fod,KAM1GC,UAAW,SAAmBD,EAAQzG,GACzB3W,KACNud,iBAAiBH,IAMxBE,SAAU,SAAkBF,EAAQzG,GAClC,IACIzK,EAAStL,EAAE+V,EAAG7N,eAAe5C,KAAK,UAClCsX,EAAa5c,EAAE+V,EAAG7N,eAAe5C,KAAK,cACtC0N,EAAShT,EAAE+V,EAAG7N,eAAe5C,KAAK,UAClCwN,EAAa9S,EAAE+V,EAAG7N,eAAe5C,KAAK,cAJ/BlG,KAMN4X,QAAQ,gBAAiB,CAC5BtK,OAAQjO,OAAOC,WAAWme,QAAQnQ,OAAOoQ,iCACzCxR,OAAQA,EACRyH,WAAY6J,EACZ5J,OAAQA,EACRF,WAAYA,KAOhB2I,YAAa,SAAqBC,GAChC,IAAIvZ,EAAO/C,KACX+C,EAAK4a,aAAerB,EAAcqB,aAClCrB,EAAcsB,WAAWC,QAAQ,CAC/BtS,MAAO+Q,EAAc/Q,MACrB/K,QAAS,SAAiBsd,GAExB,KADwBxB,EAAcsB,WAAW1X,KAAK,aAAc,GACpE,CAIA,GAAe,eADDoW,EAAcyB,QACE,CAC5B,IAAKnd,EAAEZ,MAAMge,GAAG,UACd,OACK,GAAIhe,KAAKie,UAAUC,QAAQtI,QAAQ,mCAAqC,EAC7E,OAEFhV,EAAE4K,KAAKzI,EAAKob,6BAA6Bvd,EAAEZ,QAAQ0L,MAAK,SAAUlL,GAChEsd,EAAStd,UAEN,CACL,IAAIA,EAAUuC,EAAKqb,4BAA4Bxd,EAAEZ,OACjD8d,EAAStd,GAEX,MAAO,cAETkJ,KAAM,SAAc3I,EAAOmG,GACzB,IAAK,IAAIuK,EAAI,EAAGA,EAAI7Q,EAAE,eAAeoI,OAAS,EAAGyI,IAC/C7Q,EAAE,IAAMA,EAAE,eAAe6Q,GAAGrQ,IAAI0J,UAIpCyH,KAAM,CAAE9N,SAAU,GAAI4Z,OAAQ,QAC9BV,aAAc5a,EAAK4a,aACnBrL,KAAM,CAAEgM,MAAO,GAAI7Z,SAAU,IAC7B8Z,SAAU,CAAEC,GAAI,kBAChB5U,MAAO,SAAe7I,EAAOmG,GAC3BA,EAAG2W,QAAQY,OACX,WACE7d,EAAEZ,MAAM0e,MAAK,GAAMC,OAAO,IAAK,MAEjC,WACE/d,EAAEZ,MAAM4e,QAAQ,IAAI,WAClBhe,EAAEZ,MAAM8K,mBAalBqT,6BAA8B,SAAsCU,GAClE,IAAI9b,EAAO/C,KAAK8e,EAAM,IAAIle,EAAEoM,SAC5B+R,EAAeF,EAAI3Y,KAAK,gBAGxBnG,EAAS,CACPgf,aAAcA,EACd3B,OAAQ,CAAElR,OAJH2S,EAAI3Y,KAAK,UAIUwN,WAHfmL,EAAI3Y,KAAK,gBAOtB,GAFAnD,EAAKgc,aAAeA,EAEhBhc,EAAKic,SAASjf,EAAOgf,cAAe,CACtC,IAAI7Y,EAAOnD,EAAKoa,MAAMpd,EAAOgf,cAC7BD,EAAI1R,QAAQrK,EAAKkc,aAAa/Y,EAAMnG,EAAOqd,cAE3Cxc,EAAE4K,KAAKzI,EAAKlD,YAAYqf,mBAAmBnf,IAAS2L,MAAK,SAAUxF,GACjE4Y,EAAI1R,QAAQrK,EAAKkc,aAAa/Y,EAAMnG,EAAOqd,SAC3Cra,EAAKoc,cAAcpf,EAAOgf,aAAc7Y,MAG5C,OAAO4Y,EAAIzR,WAOb+Q,4BAA6B,SAAqCS,GAChE,IAGA9e,EAAS,CACPqd,OAAQ,CAAElR,OAHH2S,EAAI3Y,KAAK,UAGUwN,WAFfmL,EAAI3Y,KAAK,gBAKlBA,EAAO,CACTkZ,QAAWP,EAAI3Y,KAAK,WACpBiF,UAAa0T,EAAI3Y,KAAK,aACtBmZ,QAAWR,EAAI3Y,KAAK,WACpBgG,OAAU2S,EAAI3Y,KAAK,WAErB,OAbWlG,KAaCif,aAAa/Y,EAAMnG,EAAOqd,SAOxC+B,cAAe,SAAuBJ,EAAc7Y,GACvClG,KACNmd,MAAM4B,GAAgB7Y,GAO7B8Y,SAAU,SAAkBD,GAE1B,YAA2C,IADhC/e,KACQmd,MAAM4B,IAQ3BE,aAAc,SAAsB/Y,EAAMkX,GACxC,IACA5c,EAAUI,EAAE,eACZmD,EAFW/D,KAECI,YAAY,mBACxBmE,OAAwC,IAAtB2B,EAAKoZ,aAYvB,OAVApZ,EAAK3B,SAAWA,EAChB2B,EAAKqN,UANMvT,KAMWuT,UACtBrN,EAAKwN,WAAa0J,EAAO1J,WACzBxN,EAAK0N,OAAS1N,EAAK0N,QAAU,EAC7B1N,EAAKsX,WAAatX,EAAKyN,YAAc,EACrCzN,EAAKqZ,aAAelgB,OAAOmgB,aAAaC,aACxCjf,EAAUuD,EAAKtD,OAAOyF,GACtBtF,EAAE,IAZSZ,KAYE2d,cAAc9S,KAAKrK,GAChCnB,OAAOuI,KAAK8X,oBAAoBlf,EAbrBR,KAamCoC,YAbnCpC,KAcNub,kBAAkB/a,EAAS4c,GACzB5c","sourcesContent":["/*\r\n *   Name: Bizagi Workportal Project Activity Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", {}, {\n\n  /*\r\n                                                                                                                *   Constructor\r\n                                                                                                                */\n  init: function init(workportalFacade, dataService, serviceloadDataPlan, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.serviceloadDataPlan = serviceloadDataPlan;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-plan-activity-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.sidebar\").concat(\"#project-plan-activity-sidebar\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-plan-activity-sidebar\");\n    self.content = template.render({});\n\n    return self.content;\n  },\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_PLAN\", $.proxy(self.onNotifyLoadInfoPlan, self));\n  },\n\n  onNotifyLoadInfoPlan: function onNotifyLoadInfoPlan(event, parans) {\n    var self = this;\n    if (self.params.plan.idActivitySelected) {\n\n      var params = { idPlan: self.params.plan.id };\n      self.serviceloadDataPlan.loadData(params, self.getDateServer, self.params);\n      self.serviceloadDataPlan.subscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\n      self.serviceloadDataPlan.subscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\n    }\n  },\n\n  loadedWithDataActivities: function loadedWithDataActivities() {\n    var self = this;\n    self.pub(\"notify\", {\n      type: \"LOADED_ACTIVITIES_PLAN\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_SUMMARY_PROGRESS_PLAN\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_ACTIVITY_SUMMARY\",\n      args: self.params });\n\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_ACTIVITIES_PLAN\",\n      args: self.params });\n\n  },\n\n  loadedWithDataFirstParent: function loadedWithDataFirstParent() {\n    var self = this;\n    self.pub(\"notify\", {\n      type: \"LOAD_INFO_SUMMARY_PLAN\",\n      args: self.params });\n\n  },\n\n  clean: function clean() {\n    var self = this;\n    if (self.serviceloadDataPlan) {\n      self.serviceloadDataPlan.unsubscribe(\"loadedWithDataActivities\", $.proxy(self.loadedWithDataActivities, self));\n      self.serviceloadDataPlan.unsubscribe(\"loadedWithDataFirstParent\", $.proxy(self.loadedWithDataFirstParent, self));\n    }\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.sidebar\", [\"workportalFacade\", \"dataService\", \"bizagi.workportal.services.behaviors.loadDataPlan\", bizagi.workportal.widgets.project.plan.activity.sidebar], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Action\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.plan.activity.action\", {}, {\n\n  /**\r\n                                                                                                               *   Constructor\r\n                                                                                                               */\n  init: function init(workportalFacade, dataService, notifier, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.dateFormat = bizagi.localization.getResource(\"dateFormat\");\n    self.timeFormat = bizagi.localization.getResource(\"timeFormat\");\n    self.estimatedFinishDateTime; //Save complete date and time, because datepicker dont save time\n\n    self.beforeUserAssignedActivity = \"\";\n    self.notifier = notifier;\n\n\n    //Load templates\n    self.loadTemplates({\n      \"activity-action-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action\"),\n      \"activity-action-editionpopup\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.action\").concat(\"#project-plan-activity-action-editionpopup\") });\n\n\n    self.dialogBox = {};\n  },\n\n  /**\r\n      *\r\n      * @returns {*|jQuery|HTMLElement}\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /**\r\n      *\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.sub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n\n    var $content = self.getContent().empty();\n\n    var currentActivity = {};\n    if (self.params.plan.idActivitySelected) {\n      currentActivity = self.params.plan.activities.filter(function (activity) {\n        return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n      })[0];\n    }\n\n    if (self.params.plan.idUserCreator === bizagi.currentUser.idUser || currentActivity.userAssigned == bizagi.currentUser.idUser) {\n\n      var argsTemplate = {};\n      argsTemplate.currentActivityName = currentActivity.name;\n      argsTemplate.showEditAction = true;\n      if (self.params.plan.idUserCreator !== bizagi.currentUser.idUser) {\n        argsTemplate.showEditAction = false;\n      }\n\n      var tmpl = self.getTemplate(\"activity-action-main\");\n      $content.append(tmpl.render(argsTemplate));\n\n      if (argsTemplate.showEditAction) {\n        self.initilizeActionMenu();\n        self.beforeUserAssignedActivity = currentActivity.userAssigned;\n        self.content.append($content);\n        self.initializeTempleteAndEvents();\n      }\n    }\n  },\n\n  initializeTempleteAndEvents: function initializeTempleteAndEvents() {\n    var self = this;\n    self.plugins = {};\n    self.plugins.activityEdition = self.initPluginPopupEdition();\n\n    self.formEditActivity = {\n      assignee: $(\"#activity-form-assignee\", self.plugins.activityEdition),\n      date: $(\"#activity-form-date\", self.plugins.activityEdition),\n      duration: $(\"#activity-form-duration\", self.plugins.activityEdition),\n      buttonCancel: $(\"#ui-bizagi-wp-project-popupform-action-cancel\", self.plugins.activityEdition),\n      buttonUpdate: $(\"#ui-bizagi-wp-project-popupform-action-update\", self.plugins.activityEdition) };\n\n\n    self.formEditActivity.buttonCancel.on(\"click\", $.proxy(self.onClickPopupButtonCancel, self));\n    self.formEditActivity.buttonUpdate.on(\"click\", $.proxy(self.onClickPopupButtonUpdate, self));\n\n    self.formEditActivity.date.on(\"keydown\", $.proxy(self.onDeleteDate, self));\n    self.formEditActivity.duration.on(\"keyup\", $.proxy(self.onTypeDuration, self));\n  },\n\n  /**\r\n      *\r\n      */\n  onNotifyExpandedRightSidebar: function onNotifyExpandedRightSidebar() {\n    var self = this;\n    self.initilizeActionMenu();\n  },\n\n  /**\r\n      *\r\n      */\n  initilizeActionMenu: function initilizeActionMenu() {\n    var self = this;\n    $(\"#ui-bizagi-wp-project-plan-activity-action .menu\", self.content).menu({\n      select: $.proxy(self.onSelectMenu, self) }).\n    removeClass(\"ui-widget-content\");\n  },\n\n  /**\r\n      *\r\n      * @returns dialogBox.formContent\r\n      */\n  initPluginPopupEdition: function initPluginPopupEdition() {\n    var self = this;\n    var popupEditActivity = self.getTemplate(\"activity-action-editionpopup\");\n    self.dialogBox.formContent = popupEditActivity.render({});\n    return self.dialogBox.formContent;\n\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeAutoComplete: function initializeAutoComplete(element) {\n    var self = this;\n    var url = self.dataService.serviceLocator.getUrl(\"admin-getUsersList\");\n\n    element.autocomplete({\n      minLength: 2,\n      source: function source(request, response) {\n        $.ajax({\n          url: url,\n          data: {\n            domain: \"\",\n            userName: \"\",\n            fullName: request.term,\n            organization: \"\",\n            pag: 1,\n            pagSize: 100,\n            orderField: \"fullName\" },\n\n          success: function success(data) {\n            response($.map(data.users, function (item) {\n              return {\n                label: item.user,\n                value: item.idUser };\n\n            }));\n          } });\n\n      },\n      select: function select(event, ui) {\n        var name = ui.item.label;\n        element.val(name);\n        self.formEditActivity.IdAssignee = ui.item.value;\n        return false;\n      },\n      focus: function focus() {\n        return false;\n      },\n      change: function change(event, ui) {\n        if (ui.item === null) {\n          self.formEditActivity.IdAssignee = null;\n          self.formEditActivity.assignee.val(\"\");\n        }\n        return false;\n      } });\n\n\n\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeDatePicker: function initializeDatePicker(element) {\n    var self = this;\n    element.datepicker({\n      onSelect: function onSelect() {\n        self.formEditActivity.duration.val(\"\");\n        self.estimatedFinishDateTime = self.formEditActivity.date.datepicker(\"getDate\") ? self.formEditActivity.date.datepicker(\"getDate\").getTime() : undefined;\n      } });\n\n    element.datepicker(\"option\", \"dateFormat\", bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI());\n  },\n\n  /**\r\n      *\r\n      * @param element\r\n      */\n  initializeSpiner: function initializeSpiner(element) {\n    var self = this;\n    function desactivateDateByDuration(event, newValue) {\n      var value = newValue || $(event.target).val();\n      if (bizagi.util.isNumeric(value) && parseInt(value, 10) > 0) {\n        self.formEditActivity.date.val(\"\");\n        self.estimatedFinishDateTime = undefined;\n      } else {\n        $(event.target).val(\"\");\n      }\n    }\n\n    element.spinner({\n      min: 1,\n      max: 1000,\n      placeHolder: bizagi.localization.getResource(\"workportal-hours\"),\n      change: function change(event) {\n        desactivateDateByDuration(event);\n      },\n      spin: function spin(event, ui) {\n        desactivateDateByDuration(event, ui.value);\n      } });\n\n  },\n\n  /***\r\n      * Events\r\n      * @param event\r\n      */\n\n  onDeleteDate: function onDeleteDate(event) {\n    var self = this;\n    if (event.keyCode === 8) {\n      $(event.target).val(\"\");\n      self.fieldDurationActive(true);\n    }\n  },\n\n  /**\r\n      *\r\n      * @param event\r\n      */\n  onTypeDuration: function onTypeDuration(event) {\n    var self = this;\n    var $target = $(event.target);\n    if ($target.val() !== \"\") {\n      self.estimatedFinishDateTime = undefined;\n    } else {\n      self.activateElement(self.form.date);\n    }\n  },\n\n  /**\r\n      * When select menu\r\n      * @param event\r\n      * @param ui\r\n      */\n  onSelectMenu: function onSelectMenu(event, ui) {\n    var self = this;\n    if ($(event.currentTarget).find(\"i\").length === 0) {\n      var item = $(ui.item).data(\"item\");\n      switch (item) {\n        case \"edit\":\n          self.onClickOpenPopupEdition();\n          break;}\n\n    }\n  },\n\n  /**\r\n      *\r\n      */\n  onClickOpenPopupEdition: function onClickOpenPopupEdition() {\n    var self = this;\n    self.initializeTempleteAndEvents();\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: \"auto\",\n      width: \"600px\",\n      modal: true,\n      title: bizagi.localization.getResource(\"workportal-project-plan-title-activity-properties\"),\n      maximize: true,\n      open: $.proxy(self.onOpenPopupEdition, self),\n      close: $.proxy(self.onClosePopupEdition, self) });\n\n  },\n\n  /**\r\n     *\r\n     */\n  onOpenPopupEdition: function onOpenPopupEdition() {\n    var self = this;\n    var currentActivity = self.params.plan.activities.filter(function (activity) {\n      return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n    })[0];\n\n    var activityDate = currentActivity && !bizagi.util.isEmpty(currentActivity.estimatedFinishDate) ? currentActivity.estimatedFinishDate : \"\";\n    if (!isNaN(activityDate)) {\n      activityDate = bizagi.util.dateFormatter.formatInvariant(new Date(activityDate));\n    }\n    var estimatedFinishDate = activityDate ? bizagi.util.dateFormatter.getDateFromInvariant(activityDate) : \"\";\n    var isMinimumDate = estimatedFinishDate instanceof Date ? estimatedFinishDate.getTime() < self.getDateServer() : false;\n\n    self.initializeAutoComplete(self.formEditActivity.assignee);\n    self.initializeDatePicker(self.formEditActivity.date);\n    self.initializeSpiner(self.formEditActivity.duration);\n\n    if (currentActivity.userAssigned) {\n      self.setUserAssignedById(currentActivity.userAssigned);\n    }\n\n    self.formEditActivity.date.datepicker(\"option\", \"minDate\", new Date(self.getDateServer()));\n\n    if (currentActivity.estimatedFinishDate && isMinimumDate) {\n      self.formEditActivity.date.datepicker(\"option\", \"minDate\", estimatedFinishDate); //set minimum because, if date is past\n    }\n\n    if (currentActivity.estimatedFinishDate) {\n      if (estimatedFinishDate) {\n        self.formEditActivity.date.datepicker(\"setDate\", estimatedFinishDate);\n      }\n      self.estimatedFinishDateTime = currentActivity.estimatedFinishDate;\n    }\n\n    if (currentActivity.duration) {\n      self.formEditActivity.duration.val(parseInt(currentActivity.duration, 10));\n    }\n  },\n\n  /**\r\n      * When close popup edition\r\n      */\n  onClosePopupEdition: function onClosePopupEdition() {\n    var self = this;\n    self.removePopupWidgets();\n  },\n\n  /**\r\n      *\r\n      * @param idUser\r\n      */\n  setUserAssignedById: function setUserAssignedById(idUser) {\n    var self = this;\n    //Show images users\n    self.callGetDataUsers(idUser).then(function (responseUsers) {\n      self.formEditActivity.assignee.val(responseUsers[0].name);\n    });\n    self.formEditActivity.IdAssignee = idUser;\n  },\n\n  /**\r\n      *\r\n      * @param event\r\n      */\n  onClickPopupButtonCancel: function onClickPopupButtonCancel(event) {\n    var self = this;\n    event.preventDefault();\n    self.removePopupWidgets();\n  },\n\n  /**\r\n     * Remove popup widgets\r\n     */\n  removePopupWidgets: function removePopupWidgets() {\n    var self = this;\n    self.formEditActivity.assignee.next().find(\"span\").html(\"\");\n    self.dialogBox.formContent.remove();\n    $(\"#ui-datepicker-div\").remove();\n  },\n\n  /**\r\n      *  Triggered when click update plan activity\r\n      */\n  onClickPopupButtonUpdate: function onClickPopupButtonUpdate() {\n    var self = this;\n    if (self.validateParamsOfFormEditActivity()) {\n      var currentActivity = self.params.plan.activities.filter(function (activity) {\n        return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n      })[0];\n      var idUserAssigned = self.formEditActivity.IdAssignee || bizagi.currentUser.idUser;\n      if (self.formEditActivity.duration.val() != \"\") {\n        self.params.plan.activities.filter(function (activity) {\n          return activity.id.toUpperCase() === self.params.plan.idActivitySelected.toUpperCase();\n        })[0].estimatedFinishDate = \"\";\n      }\n      var updateActivity = {\n        progress: currentActivity.progress,\n        id: currentActivity.id,\n        startDate: currentActivity.startDate,\n        duration: self.formEditActivity.duration.val(),\n        userAssigned: idUserAssigned,\n        allowEdition: currentActivity.allowEdition,\n        description: currentActivity.description,\n        name: currentActivity.name,\n        idPlan: currentActivity.idPlan,\n        estimatedFinishDate: self.estimatedFinishDateTime,\n        finishDate: currentActivity.finishDate,\n        items: currentActivity.items };\n\n      $.when(self.dataService.editActivityPlan(updateActivity)).done(function () {\n        currentActivity = $.extend(currentActivity, updateActivity);\n        self.removePopupWidgets();\n\n        if (self.beforeUserAssignedActivity !== self.formEditActivity.IdAssignee) {\n          self.pub(\"notify\", {\n            type: \"ACTIVITYPLANCOMMENTS\",\n            args: $.extend(self.params, { refreshAllWidgets: true }) });\n\n        } else\n        {\n          self.pub(\"notify\", {\n            type: self.params.showContextByMenuDashboard,\n            args: self.params });\n\n        }\n\n        self.removePopupWidgets();\n        self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-project-plan-activity-update-message\"));\n      });\n    }\n  },\n\n  /***\r\n      * Events\r\n      */\n  onClickFavorite: function onClickFavorite(event) {\n    event.preventDefault();\n    var self = this;\n    var favoriteOptions = {};\n    if ($(event.target).hasClass(\"bz-icon-star-outline\")) {\n      favoriteOptions = {\n        idObject: self.params.idCase,\n        favoriteType: \"CASES\" };\n\n      $.when(self.dataService.addFavorite(favoriteOptions)).done(function (favoritesData) {\n        self.params.guidFavorite = favoritesData.idFavorites;\n        $(event.target).removeClass(\"bz-icon-star-outline\");\n        $(event.target).addClass(\"bz-icon-star\");\n      });\n    } else\n    {\n      favoriteOptions = {\n        idObject: self.params.guidFavorite,\n        favoriteType: \"CASES\" };\n\n      $.when(self.dataService.delFavorite(favoriteOptions)).done(function () {\n        $(event.target).addClass(\"bz-icon-star-outline\");\n        $(event.target).removeClass(\"bz-icon-star\");\n      });\n    }\n  },\n\n  /**\r\n      * Clean events and plugins\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.unsub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.unsub(\"EXPANDED_RIGHT_SIDEBAR\", $.proxy(self.onNotifyExpandedRightSidebar, self));\n  },\n\n  /**\r\n      * Validate form edit plan activity\r\n      * @returns {boolean}\r\n      */\n  validateParamsOfFormEditActivity: function validateParamsOfFormEditActivity() {\n    var self = this;\n    var userAssigned = self.formEditActivity.assignee;\n    if (userAssigned.val() && userAssigned.val() !== \"\" && self.formEditActivity.IdAssignee) {\n      return true;\n    } else {\n      var messageValidationField = bizagi.localization.getResource(\"workportal-general-error-field-required\");\n      messageValidationField = messageValidationField.replace(\"{0}\", bizagi.localization.getResource(\"workportal-project-plan-assignee\").toLowerCase());\n      userAssigned.next().find(\"span\").html(messageValidationField);\n      return false;\n    }\n  },\n\n  /**\r\n      * Call services\r\n      */\n  callGetDataUsers: function callGetDataUsers(csvIdUsers) {\n    var self = this,\n    defer = $.Deferred();\n    var params = {\n      userIds: csvIdUsers,\n      width: 50,\n      height: 50 };\n\n\n    self.dataService.getUsersData(params).always(function (response) {\n      defer.resolve(response);\n    });\n    return defer.promise();\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.action\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.plan.activity.action]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Time\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n/***\r\n     * TODO IMPORTANT: This widget is development with TDD, test this file when changes\r\n     */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.time\", {}, {\n\n  /*\r\n                                                                                                       *   Constructor\r\n                                                                                                       *\r\n                                                                                                       */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Constants\n    self.EXECUTING_ACTIVITY = \"EXECUTING\";\n    self.FINISHED_ACTIVITY = \"FINISHED\";\n\n    //Regional\n    self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-time-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.time\").concat(\"#project-plan-activity-time\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivitySummary, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivitySummary: function onNotifyLoadInfoActivitySummary(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    self.getContent().empty();\n\n    var currentActivity = self.params.plan.activities.filter(function (activity) {\n      return activity.id === self.params.plan.idActivitySelected;\n    })[0];\n\n    if (currentActivity.startDate) {\n      self.getStateActivity(currentActivity);\n\n      var argsTemplate = {\n        time: {\n          fromDate: self.getFormattedDate(new Date(self.getFirstDate(currentActivity))) } };\n\n\n      var dataProgressWidget = self.getDataByScenarios(currentActivity, true);\n\n      $.when(dataProgressWidget.unitTime).done(function (auxUnitTime) {\n        dataProgressWidget = $.extend(dataProgressWidget, {\n          unitTime: auxUnitTime });\n\n        self.updateWidget($.extend(argsTemplate.time, dataProgressWidget));\n      });\n\n    }\n  },\n  updateWidget: function updateWidget(argsTemplate) {\n    var self = this;\n    var $content = self.getContent().empty();\n    var contentTemplate = self.getTemplate(\"plan-time-main\");\n\n    var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - argsTemplate.unitTime.minutes * 60 * 1000), null, false);\n\n    var messageDescripionDifference = bizagi.localization.getResource(\"workportal-project-activity-state-\" + argsTemplate.keywordResource);\n    argsTemplate.messageTime = messageDescripionDifference.replace(\"%s\", relativeTime);\n\n    contentTemplate.\n    render(argsTemplate).\n    appendTo($content);\n\n    //Begin Adjust status bar next to the number days\n    var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\n    var widthNumberDays = $(\".remaining-days .days\", $content).width();\n    $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\n\n    var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\n\n    $barCompletedDate.css(\"width\", argsTemplate.percentBar + \"%\");\n    //End Adjust status bar next to the number days\n\n  },\n  getStateActivity: function getStateActivity(activity) {\n    var self = this;\n    if (activity.finishDate) {\n      activity.currentState = self.FINISHED_ACTIVITY;\n      return self.FINISHED_ACTIVITY;\n    } else\n    {\n      activity.currentState = self.EXECUTING_ACTIVITY;\n      return self.EXECUTING_ACTIVITY;\n    }\n  },\n  getFirstDate: function getFirstDate(activity) {\n    var self = this;\n    if (activity.currentState === self.EXECUTING_ACTIVITY) {\n      return activity.startDate;\n    } else {\n      return activity.finishDate;\n    }\n  },\n  getDataByScenarios: function getDataByScenarios(activity) {\n    var self = this;\n    var response = {\n      colorBar: null,\n      percentBar: 100,\n      keywordResource: null,\n      unitTime: null };\n\n    var params = {};\n    switch (activity.currentState) {\n      case self.EXECUTING_ACTIVITY:\n        response.keywordResource = \"opened\";\n        response.colorBar = self.getColorByCreatedAndEstimatedDate(activity);\n\n        params = {\n          idUser: bizagi.currentUser.idUser,\n          fromDate: activity.startDate,\n          toDate: Date.now() };\n\n        response.unitTime = self.callGetEffectiveDuration(params);\n\n        break;\n      case self.FINISHED_ACTIVITY:\n        response.colorBar = \"Gray\";\n        response.keywordResource = \"closed\";\n        params = {\n          idUser: bizagi.currentUser.idUser,\n          fromDate: activity.finishDate,\n          toDate: Date.now() };\n\n        response.unitTime = self.callGetEffectiveDuration(params);\n        break;}\n\n    return response;\n  },\n\n  getColorBar: function getColorBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).colorBar;\n  },\n  getPercentBar: function getPercentBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).percentBar;\n  },\n  getKeywordResourceDescriptionBar: function getKeywordResourceDescriptionBar(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).keywordResource;\n  },\n  getUnitTime: function getUnitTime(activity) {\n    var self = this;\n    return self.getDataByScenarios(activity).unitTime;\n  },\n\n  getColorByCreatedAndEstimatedDate: function getColorByCreatedAndEstimatedDate(activity) {\n    var self = this;\n    var response = \"Red\";\n    if (activity.estimatedFinishDate) {\n      if (Date.now() < activity.estimatedFinishDate) {\n        var theSameDay = new Date().getUTCDate() === new Date(activity.estimatedFinishDate).getUTCDate();\n        if (theSameDay) {\n          response = \"Yellow\";\n        } else\n        {\n          response = \"Green\";\n        }\n      }\n    }\n    return response;\n  },\n\n  getFormattedDate: function getFormattedDate(dateObj) {\n    var self = this;\n    var monthsNames = self.datePickerRegional.monthNames;\n    var shortMonth = dateObj.getMonth();\n\n    return monthsNames[shortMonth] + \" \" + bizagi.util.dateFormatter.formatDate(dateObj, \"dd hh:mm tt\", bizagi.localization.getResource(\"datePickerRegional\"));\n  },\n\n  /**\r\n      * Call services\r\n      */\n  callGetEffectiveDuration: function callGetEffectiveDuration(params) {\n    var self = this;\n    var d = $.Deferred();\n    $.when(\n    self.dataService.getEffectiveDuration(params)).\n    done(function (data) {\n      d.resolve(data);\n    });\n    return d.promise();\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.time\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.time], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Progress\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.progress\", {}, {\n\n  /*\r\n                                                                                                           *   Constructor\r\n                                                                                                           */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    self.plugins = {};\n    self.dialogBox = {};\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-progress-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-progress\"),\n      \"plan-progress-popup-edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.progress\").concat(\"#project-plan-activity-edit-progress\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n    self.sub(\"UPDATE_ITEMS_FROM_FORMRENDER\", $.proxy(self.onNotifyUpdateItemFromRender, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    var $content = self.getContent().empty();\n\n    var activityToShow = self.params.plan.activities.filter(function (activity) {\n      return activity.id.toUpperCase() == self.params.plan.idActivitySelected.toUpperCase();\n    })[0];\n\n    var argsTemplate = {};\n    argsTemplate.valuePercentBarComplete = 0;\n    argsTemplate.progress = {\n      progress: activityToShow.progress,\n      canEdit: activityToShow.items.length === 0 };\n\n\n    if (argsTemplate.progress.progress) {\n      argsTemplate.valuePercentBarComplete = argsTemplate.progress.progress;\n    }\n\n    //Update widget\n    var templateMain = self.getTemplate(\"plan-progress-main\");\n    templateMain.render(argsTemplate).appendTo($content);\n\n    self.plugins.popupEditProgress = self.initPluginPopupEditProgress();\n\n    var popupEditProgress = self.plugins.popupEditProgress;\n\n    self.formEditProgress = {\n      sliderProgress: $(\"#sliderProgress\", popupEditProgress).slider({\n        orientation: \"horizontal\",\n        range: \"min\",\n        max: 100,\n        width: 100,\n        from: 5,\n        to: 50,\n        step: 1,\n        value: argsTemplate.valuePercentBarComplete,\n        slide: $.proxy(self.onChangesliderProgress, self),\n        change: $.proxy(self.onChangesliderProgress, self) }).\n      each(function () {\n        var vals = $(this).slider(\"option\", \"max\") - $(this).slider(\"option\", \"min\");\n        for (var i = 0; i <= vals; i += 10) {\n          var el = $(\"<label class='step'>\" + i + \"</label>\").css(\"left\", i / vals * 100 + \"%\");\n          $(this).append(el);\n        }\n      }),\n      numericTextBoxPlugin: $(\"#inputProgressNumericTextBox\", popupEditProgress).spinner({\n        format: \"n0\",\n        min: 0,\n        max: 100,\n        spin: $.proxy(self.onChangeNumericTextBoxProgress, self),\n        change: $.proxy(self.onChangeNumericTextBoxProgress, self),\n        value: argsTemplate.valuePercentBarComplete,\n        decimals: 0 }),\n\n      buttonChangeProgress: $(\"#button-accept-change-progress\", popupEditProgress),\n      buttonCancel: $(\"#button-cancel-change-progress\", popupEditProgress) };\n\n\n    //Handlers\n    $(\".action-open-popup-edit-progress\", $content).on(\"click\", $.proxy(self.onShowPopupEditProgress, self));\n\n    self.formEditProgress.buttonCancel.on(\"click\", $.proxy(self.onClickCancel, self));\n    self.formEditProgress.buttonChangeProgress.on(\"click\", $.proxy(self.onSubmitFormChangeProgress, self));\n\n    self.updateProgressUI(argsTemplate.valuePercentBarComplete);\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", argsTemplate.valuePercentBarComplete);\n\n  },\n\n  onNotifyUpdateItemFromRender: function onNotifyUpdateItemFromRender(event, params) {\n    var self = this;\n    var listItems = params.args.items;\n    var activityWork = params.args.activityWork;\n\n    var progress;\n    if (listItems.length > 0) {\n      //Hide edit progress\n      $(\".action-open-popup-edit-progress\", self.content).hide();\n    } else {\n      $(\".action-open-popup-edit-progress\", self.content).show();\n    }\n    //set new progress\n    $(\".bz-wp-timestamp span\", self.content).text(activityWork);\n    $(\".bz-wp-progress-bar\", self.content).css(\"width\", activityWork + \"%\");\n\n  },\n\n  updateProgressUI: function updateProgressUI(newPercentProgress) {\n    var self = this,\n    $content = self.getContent();\n\n    $(\".bz-wp-timestamp span\", $content).text(newPercentProgress);\n\n    //Begin Adjust status bar next to the number days\n    var $barRemainingDate = $(\".remaining-days .time-remaining\", $content);\n    var widthNumberDays = $(\".remaining-days .days\", $content).width();\n    $barRemainingDate.css(\"padding-left\", (widthNumberDays + 7).toString() + \"px\");\n\n    var $barCompletedDate = $(\".remaining-days .bar-completed\", $content);\n\n    $barCompletedDate.css(\"width\", newPercentProgress.toString() + \"%\");\n    //End Adjust status bar next to the number days\n  },\n\n  initPluginPopupEditProgress: function initPluginPopupEditProgress() {\n    var self = this;\n    var templatePopupEditProgress = self.getTemplate(\"plan-progress-popup-edit\");\n    self.dialogBox.formContent = templatePopupEditProgress.render();\n    return self.dialogBox.formContent;\n\n  },\n  /*\r\n      * UI\r\n      */\n\n  onShowPopupEditProgress: function onShowPopupEditProgress() {\n    var self = this;\n\n    self.dialogBox.formContent.dialog({\n      resizable: false,\n      draggable: false,\n      height: \"auto\",\n      width: \"600px\",\n      modal: true,\n      title: bizagi.localization.getResource(\"workportal-project-plan-progress-title\"),\n      maximize: true,\n      open: $.proxy(self.onOpenPopupPlan, self),\n      close: function close() {\n        self.dialogBox.formContent.dialog(\"destroy\");\n        self.dialogBox.formContent.detach();\n      } });\n\n\n    self.previusValueProgress = self.formEditProgress.sliderProgress.slider(\"value\");\n\n  },\n\n  onChangeNumericTextBoxProgress: function onChangeNumericTextBoxProgress(event) {\n    var self = this;\n    var newValue = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\n    self.formEditProgress.sliderProgress.slider(\"value\", newValue);\n  },\n\n  onChangesliderProgress: function onChangesliderProgress(event) {\n    var self = this;\n    var newValue = self.formEditProgress.sliderProgress.slider(\"value\");\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", newValue);\n  },\n\n  onClickCancel: function onClickCancel(event) {\n    event.preventDefault();\n    var self = this;\n\n    self.dialogBox.formContent.dialog(\"destroy\");\n    self.dialogBox.formContent.detach();\n    //return before value progress\n    self.formEditProgress.sliderProgress.slider(\"value\", self.previusValueProgress);\n    self.formEditProgress.numericTextBoxPlugin.spinner(\"value\", self.previusValueProgress);\n  },\n\n  onSubmitFormChangeProgress: function onSubmitFormChangeProgress(event) {\n    event.preventDefault();\n    var self = this;\n\n    self.formEditProgress.buttonChangeProgress.prop(\"disabled\", true);\n\n    var activityToShow = self.params.plan.activities.filter(function (activity) {\n      return activity.id == self.params.plan.idActivitySelected;\n    })[0];\n    var params = $.extend(activityToShow, {\n      progress: self.formEditProgress.numericTextBoxPlugin.spinner(\"value\"),\n      idPlan: self.params.plan.id });\n\n    $.when(self.dataService.editActivityPlan(params)).done(function () {\n      self.formEditProgress.buttonChangeProgress.prop(\"disabled\", false);\n      activityToShow.progress = self.formEditProgress.numericTextBoxPlugin.spinner(\"value\");\n      self.updateProgressUI(activityToShow.progress);\n      self.dialogBox.formContent.dialog(\"destroy\");\n      self.dialogBox.formContent.detach();\n    });\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.progress\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.progress], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Subprocesses Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", {}, {\n  /*\r\n                                                                                                               *   Constructor\r\n                                                                                                               */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-subprocesses\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-plan-activity-plan-subprocesses-wrapper\"),\n      \"project-subprocesses-tootip-custom-properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.subprocesses\").concat(\"#project-activity-plan-subprocesses-tooltip-custom-properties-wrapper\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /*\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.subprocesses\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.subprocesses]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Parent\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.parent\", {}, {\n\n  /*\r\n                                                                                                         *   Constructor\r\n                                                                                                         */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"plan-parent-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activity.parent\").concat(\"#project-plan-activity-parent\") });\n\n  },\n\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n  },\n\n  /**\r\n      * Notifies when an event is raised\r\n      */\n\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    var $content = self.getContent().empty();\n\n    $.when(self.dataService.getPlanParent({ idPlan: self.params.plan.id })).done(function (planParent) {\n      self.params.plan.parent = planParent;\n      if (self.params.plan.parent) {\n        var argsTemplate = {};\n        argsTemplate.parent = {\n          idParent: self.params.plan.parent.radNumber,\n          nameParent: self.params.plan.parent.displayName,\n          idCase: self.params.plan.parent.idCase,\n          idWorkflow: self.params.plan.parent.idWorkflow,\n          idWorkItem: self.params.plan.parent.idWorkItem,\n          idTask: self.params.plan.parent.idTask };\n\n\n        //Update widget\n        var contentTemplate = self.getTemplate(\"plan-parent-main\");\n        contentTemplate.\n        render(argsTemplate).\n        appendTo($content);\n\n        $(\"#go-to-parent-case\", $content).on(\"click\", $.proxy(self.onClickGoToParentCase, self));\n      }\n    });\n\n\n  },\n\n  onClickGoToParentCase: function onClickGoToParentCase(event) {\n    event.preventDefault();\n    var self = this;\n    self.routingExecute($(event.target).closest(\"#go-to-parent-case\"));\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.parent\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.parent], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Plan Activity Users Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activity.users\", {}, {\n  /*\r\n                                                                                                        *   Constructor\r\n                                                                                                        */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    self.usersMap = {};\n    self.plugins = {};\n    self.usersInformation = [];\n    self.globalHandlersService = bizagi.injector.get('globalHandlersService');\n    self.usersAssignees = [];\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    //The load template the users plan because they are the same\n    self.loadTemplates({\n      \"plan-users-main\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.users\").concat(\"#project-plan-users\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /*\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.sub(\"LOAD_INFO_ACTIVITY_SUMMARY\", $.proxy(self.onNotifyLoadInfoActivityExecution, self));\n  },\n\n  /*\r\n      * validate if the activity is running\r\n      */\n  activityRunning: function activityRunning(activity) {\n    return activity.startDate !== null && activity.finishDate === null;\n  },\n\n  onNotifyLoadInfoActivityExecution: function onNotifyLoadInfoActivityExecution(event, params) {\n    var self = this,\n    cvsGuidUsers = [],\n    activitiesUsers = [],\n    $content = self.getContent().empty();\n    self.params = $.extend(self.params, params.args);\n\n    var ownerUserId = self.params.plan.idUserCreator;\n    var ownerUserGuid = self.params.plan.idUserCreator;\n\n    activitiesUsers.push({ \"idUser\": ownerUserId, \"guidUser\": ownerUserGuid, \"userType\": [\"owner\"] });\n    self.usersMap[\"-\" + ownerUserId + \"-\"] = {\n      picture: \"\",\n      id: ownerUserId,\n      guid: ownerUserGuid,\n      name: \"\",\n      userType: [\"owner\"] };\n\n    cvsGuidUsers.push(ownerUserGuid);\n    $.each(self.params.plan.activities, function (index, activity) {\n      if (self.activityRunning(activity)) {\n        var userId = activity.userAssigned;\n        var userGuid = activity.userAssignedGuid;\n        if (userId === ownerUserId) {\n          if ($.inArray(\"Assigned\", activitiesUsers[0].userType) === -1) {\n            activitiesUsers[0].userType.push(\"Assigned\");\n            self.usersMap[\"-\" + ownerUserId + \"-\"].userType.push(\"Assigned\");\n          }\n        } else\n        {\n          self.usersMap[\"-\" + userId + \"-\"] = {\n            picture: \"\",\n            id: userId,\n            name: \"\",\n            userType: [\"Assigned\"] };\n\n          if (activitiesUsers.filter(function (user) {return user.idUser == userId;}).length === 0) {\n            var id = userGuid ? userGuid : userId;\n            activitiesUsers.push({ \"idUser\": id, \"userGuid\": id, \"userType\": [\"Assigned\"] });\n            cvsGuidUsers.push(id);\n          }\n        }\n      }\n    });\n    self.activitiesUsers = activitiesUsers;\n\n    //Update widget\n    var contentTemplate = self.getTemplate(\"plan-users-main\");\n    contentTemplate.\n    render({\n      assignee: self.justAssignees(activitiesUsers),\n      label: bizagi.localization.getResource(\"workportal-project-plan-assignee\") }).\n\n    appendTo($content);\n    self.addEventHandlersModal();\n    $.when(self.callGetDataUsers(cvsGuidUsers)).then(function () {\n      self.showCreatorInformation(ownerUserId);\n      self.renderUserProfilesAndImages();\n    });\n  },\n\n  /**\r\n      * return standar userAdapter information with only assigned users\r\n      * @param {Array} allUsers \r\n      */\n  justAssignees: function justAssignees(allUsers) {\n    var usersAssignee = [];\n    allUsers.map(function (user) {\n      var isOwner = user.userType.indexOf(\"owner\") !== -1;\n      var isAssignee = user.userType.indexOf(\"Assigned\") !== -1;\n      usersAssignee.push(usersAdapter.createJsonUserInfo(user.idUser, \"\", \"\", \"\", \"\", \"\", isAssignee, isOwner, [], []));\n    });\n    return usersAdapter.justAssignees(usersAssignee);\n  },\n\n  /**\r\n      * show the information of the creator case\r\n      * @param {string} ownerUserId guid user creator\r\n      */\n  showCreatorInformation: function showCreatorInformation(ownerUserId) {\n    var self = this;\n    var userCreator = self.usersMap[\"-\" + ownerUserId + \"-\"];\n    var userInfo = usersAdapter.createJsonUserInfo(\n    userCreator.id,\n    userCreator.name,\n    userCreator.username,\n    userCreator.picture ? userCreator.picture : undefined,\n    userCreator.email,\n    userCreator.name.getInitials(),\n    false,\n    true,\n    [],\n    []);\n\n    self.content.find(\".ui-bizagi-wp-project-plan-users .ui-bizagi-wp-project-users-creator-info\").userinformation(self, { user: userInfo });\n  },\n\n  /**\r\n      * UI\r\n      */\n\n  renderUserProfilesAndImages: function renderUserProfilesAndImages() {\n    var self = this;\n    $.each(self.usersMap, function (i, obj) {\n      var $li = $(\".ui-bizagi-wp-userlist li[data-iduser=\" + obj.id + \"]\", self.content);\n      if (obj.picture !== \"\") {\n        $li.find(\"img\").prop(\"src\", obj.picture);\n      } else\n      {\n        $li.find(\"img\").hide();\n        if (obj.name !== undefined) {\n          $li.find(\"span\").html(obj.name.getInitials());\n        } else\n        {\n          console.log(\"obj.name is undefined\");\n        }\n\n      }\n    });\n    $(\".ui-bizagi-wp-userlist li\", self.content).not(\".moreUsers\").on('mouseenter', function (ev) {\n      var $target = $(ev.target);\n      var userId = $(this).data(\"iduser\");\n      var userSelected;\n      $.each(self.usersMap, function (i, obj) {\n        if (obj.id === userId)\n        userSelected = obj;\n      });\n      var usersActivities = self.usersAssignees.find(function (assignee) {\n        return assignee.userAssigned === userSelected.id;\n      });\n      var activities = [];\n      if (usersActivities)\n      usersActivities.activities.map(function (activity) {\n        activities.push(activity.name);\n      });\n      var userParam = usersAdapter.createJsonUserInfo(userSelected.id, userSelected.name, userSelected.username, userSelected.picture, userSelected.email, userSelected.name.getInitials(), self.getIsAssignee(userSelected), self.getIsOwner(userSelected), activities, undefined);\n\n      $target.parent().usertooltip(self, { target: $target, user: userParam });\n    });\n  },\n\n  getIsAssignee: function getIsAssignee(userSelected) {\n    if (userSelected.userType.indexOf(\"Assigned\") > -1) {\n      return true;\n    }\n    return false;\n  },\n\n  getIsOwner: function getIsOwner(userSelected) {\n    if (userSelected.userType.indexOf(\"owner\") > -1) {\n      return true;\n    }\n    return false;\n  },\n  /*\r\n      *  Get data for users\r\n      */\n  callGetDataUsers: function callGetDataUsers(cvsGuidUsers) {\n    var self = this,\n    params = {},\n    defer = $.Deferred();\n    params = {\n      usersGuids: cvsGuidUsers.join(),\n      width: 50,\n      height: 50 };\n\n    $.when(self.dataService.getUsersData(params)).always(function (response) {\n      self.usersInformation = response;\n      for (var i = 0, length = response.length; i < length; i += 1) {\n        if (typeof response[i].name === \"undefined\") {\n          bizagi.log(response[i] + \" Id Not Found\", response, \"error\");\n        } else {\n          if (self.usersMap[\"-\" + response[i].id + \"-\"]) {\n            self.usersMap[\"-\" + response[i].id + \"-\"].picture += response[i].picture ? \"data:image/png;base64,\" + response[i].picture : \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].name = response[i].name || \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].username = response[i].username || \"\";\n            self.usersMap[\"-\" + response[i].id + \"-\"].email = response[i].email || \"\";\n          } else\n          {\n            console.log(\"The object is undefined\");\n          }\n        }\n      }\n      self.getUsersAssignees();\n      defer.resolve();\n    });\n    return defer.promise();\n  },\n\n  getUsersAssignees: function getUsersAssignees() {\n    var self = this;\n    for (var i = 0; i < self.usersInformation.length; i++) {\n      self.usersAssignees.push(self.getUserAssignee(self.usersInformation[i]));\n    }\n\n  },\n\n  getUserAssignee: function getUserAssignee(user) {\n    var self = this;\n    var tasks = [];\n    $.each(self.params.plan.activities, function (index, activity) {\n      var userId = activity.userAssigned;\n      if (userId === user.id && self.activityRunning(activity)) {\n        tasks.push({ \"name\": activity.name });\n      }\n    });\n    user.tasks = tasks;\n    var types = self.activitiesUsers.find(function (actUser) {\n      return actUser.idUser == user.id;\n    });\n    user.userType = types.userType;\n\n    var userAssignees = usersAdapter.createJsonUserInfo(\n    user.id,\n    user.name,\n    user.username,\n    user.picture ? \"data:image/png;base64,\" + user.picture : undefined,\n    user.email,\n    user.name.getInitials(),\n    self.getIsAssignee(user),\n    self.getIsOwner(user),\n    user.tasks,\n    []);\n\n    return userAssignees;\n  },\n\n  addEventHandlersModal: function addEventHandlersModal() {\n    var self = this;\n    $(\".moreUsers\").click(function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var usersAssignees = self.usersAssignees || [];\n      self.globalHandlersService.publish(\"showDialogWidget\", {\n        widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\n        closeVisible: true,\n        data: usersAssignees,\n        maximize: true,\n        modalParameters: {\n          title: bizagi.localization.getResource(\"workportal-project-users-title\") + \" (\" + usersAssignees.length + \")\",\n          width: 790,\n          height: 526,\n          refreshInbox: false } });\n\n\n    });\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.plan.activity.users\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.plan.activity.users], true);","/**\r\n * Name: BizAgi Desktop Widget Dashboard menu (left sidebar) * \r\n * @author Valeria Vanegas\r\n */\n\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu\", {}, {\n\n  /**\r\n                                                                                                   * Handler when discussions menu status change\r\n                                                                                                   * @param {*} ev \r\n                                                                                                   * @param {*} params \r\n                                                                                                   */\n  onDiscussionsMenuStatusChange: function onDiscussionsMenuStatusChange(ev, params) {\n    var self = this;\n    self.updateDiscussionsIcons(params.hasDiscussionsOrComment);\n  },\n\n  /**\r\n      * Update discussions icon on sidebar menu\r\n      * The icon is different when there is other discussion or there are comments\r\n      * @param {*} hasDiscussionsOrComment \r\n      */\n  updateDiscussionsIcons: function updateDiscussionsIcons(hasDiscussionsOrComment) {\n    var self = this;\n\n    self.sub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n\n    $(\".bz-icon-discussion-comment\").toggle(hasDiscussionsOrComment);\n    $(\".bz-icon-discussion-no-comment\").toggle(!hasDiscussionsOrComment);\n    self.params.hasDiscussionsOrComment = hasDiscussionsOrComment;\n  },\n\n  /**\r\n      * Detach events\r\n      */\n  clean: function clean() {\n    var self = this;\n    self.unsub(\"UPDATE_DISCUSSIONS_MENU_STATUS\", $.proxy(self.onDiscussionsMenuStatusChange, self));\n  } });\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu], true);","/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity Plan\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.project.dashboard.menu.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", {}, {\n\n  /**\r\n                                                                                                                                 *   Constructor\r\n                                                                                                                                 */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    self.params = params || {};\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.plan\").concat(\"#project-dashboard-menu2\") });\n\n  },\n\n  /**\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    self.content = $(\"<div></div>\");\n    return self.content;\n  },\n\n  /**\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self._super();\n    //Handlers\n    self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n      self.sub(context, $.proxy(self.updateView, self));\n    });\n  },\n\n  /**\r\n      * Update view\r\n      * @param event\r\n      * @param params\r\n      */\n  updateView: function updateView(event, params) {\n    var self = this;\n    self.params = $.extend(self.params, params.args);\n    self.clean();\n    var $content = self.getContent().empty();\n\n    var argsTemplate = {\n      showFormOverview: self.params.menuDashboard.showFormOverview,\n      showFormActivity: self.params.menuDashboard.showFormActivity,\n      showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\n      showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\n      showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu,\n      showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\n      contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\n      contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu,\n      contextualized: self.params.plan.contextualized };\n\n\n    //Update widget\n    var template = self.getTemplate(\"project-dashboard-menu\");\n    template.render(argsTemplate).appendTo($content);\n\n    if (self.params.showContextByMenuDashboard) {\n      $(\"li[data-context='\" + event.type.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n    }\n\n    self.updateDiscussionsIcons(self.params.hasDiscussionsOrComment);\n    self.handlerEvents();\n\n    var paramsGetPlan = { idPlan: self.params.plan.id };\n    $.when(self.callGetPlan(paramsGetPlan)).then(function (responsePlan) {\n      $.extend(self.params.plan, responsePlan);\n      self.pub(\"notify\", {\n        type: \"LOAD_INFO_PLAN\",\n        args: self.params });\n\n    });\n  },\n\n  /**\r\n      *   Load Content By Id\r\n      */\n  loadContentById: function loadContentById(event) {\n    var self = this;\n    event.preventDefault();\n    var $item = $(event.target).closest(\"li\");\n\n    if (!$item.hasClass(\"active\")) {\n      $.when(bizagi.util.autoSave()).done(function () {\n        $(document).data('auto-save', '');\n\n        var showContextByMenuDashboard = $item.data(\"context\");\n        if (showContextByMenuDashboard) {\n          var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\n          var currentLevelNavigator = parseInt(getLevelNavigator[0]);\n          var nameItemNavigator = \"\";\n          var newLevelNavigator = currentLevelNavigator;\n\n          self.params.refreshLastItemBreadcrumb = false;\n          self.pub(\"notify\", {\n            type: showContextByMenuDashboard.toUpperCase(),\n            args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\n              histName: nameItemNavigator,\n              level: newLevelNavigator }) });\n\n          $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\n        }\n      });\n    }\n  },\n\n  /**\r\n      * Call services\r\n      */\n\n  callGetPlan: function callGetPlan(params) {\n    var self = this;\n    var defer = $.Deferred();\n    self.dataService.getPlan(params).always(function (response) {\n      if (response.status === 200 || response.status === 201 || response.status === undefined) {\n        defer.resolve(response);\n      } else\n      {\n        defer.reject();\n      }\n    });\n\n    return defer.promise();\n  },\n\n  subMenuHandler: function subMenuHandler() {\n    var self = this;\n    var content = self.getContent();\n    var $comments = $(\"[data-context='ACTIVITYPLANCOMMENTS']\", content);\n    var $files = $(\"[data-context='ACTIVITYPLANFILES']\", content);\n    var $timeline = $(\"[data-context='ACTIVITYPLANTIMELINE']\", content);\n\n    $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\n      $comments.toggle();\n      $files.toggle();\n      $timeline.toggle();\n    });\n  },\n\n  /**\r\n      * Handler events\r\n      */\n  handlerEvents: function handlerEvents() {\n    var self = this;\n    var content = self.getContent();\n    self.subMenuHandler();\n    $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\n  },\n\n  /**\r\n      * Clean widgets and events\r\n      */\n  clean: function clean() {\n    var self = this;\n    var content = self.getContent();\n\n    self._super();\n\n    if (self.params && self.params.contextsLeftSidebarCaseDashboard) {\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function (context) {\n        self.unsub(context, $.proxy(self.updateView, self));\n      });\n    }\n\n    $(\".ui-bizagi-wp-project-tab-links a\", content).off();\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity.plan\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity.plan], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\n\n  /*\r\n                                                                                                      *   Constructor\r\n                                                                                                      */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\") });\n\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-content-dashboard\");\n    self.content = template.render({});\n\n    return self.content;\n  },\n  postRender: function postRender() {\n    var self = this;\n\n    setTimeout(function () {\n      $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\n    }, 1000);\n\n  } });\n\n\n\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/**\r\n * This module manage all graphical diagrams of process map\r\n *\r\n * @author Edward J Morales\r\n */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.processMap\", {}, {\n\n  /**\r\n                                                                                               * Constructor\r\n                                                                                               * @param workportalFacade instance of facade, mandatory\r\n                                                                                               * @param dataService instance of service tier, mandatory\r\n                                                                                               * @param params extra params, its not mandatory\r\n                                                                                               */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call parent instance\n    self._super(workportalFacade, dataService, params);\n    self.instanceBizagiProcessMap = new bizagi.processMap(this);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-processmap\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-wrapper\"),\n      \"project-process-diagram\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-process-diagram\"),\n      \"project-activity-map\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-activity-map\"),\n      \"project-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-subprocess\") });\n\n  },\n\n  /**\r\n      * Render a content of the module\r\n      * @return {string} html\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.instanceBizagiProcessMap.renderContent();\n    self.content = template.render(self.viewOptions);\n    return self.content;\n  },\n\n  /**\r\n      * Set binding and set data\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    self.instanceBizagiProcessMap.postRender();\n  },\n\n  /**\r\n     *  Binds events to handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    self.instanceBizagiProcessMap.configureHandlers();\n  },\n\n  /**\r\n      * Process diagram handler\r\n      */\n  onProcessDiagram: function onProcessDiagram() {\n    var self = this;\n    self.instanceBizagiProcessMap.onProcessDiagram();\n  },\n\n  /**\r\n      * Activity map handler\r\n      */\n  onActivityMap: function onActivityMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.onActivityMap();\n  },\n\n  /**\r\n      * Subprocess handler\r\n      */\n  onSupprocess: function onSupprocess() {\n    var self = this;\n    self.instanceBizagiProcessMap.onSupprocess();\n  },\n\n  /**\r\n      * Manage navigation between the 3 diagrams\r\n      * @param template\r\n      * @param params\r\n      */\n  navigationManager: function navigationManager(template) {\n    var self = this;\n    var response = self.instanceBizagiProcessMap.navigationManager(template);\n    response.container.append(response.template.render(response.viewOptions));\n  },\n\n  /**\r\n      * Render the process diagram in the process diagram container\r\n      */\n  renderProcessDiagram: function renderProcessDiagram() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderProcessDiagram();\n  },\n\n  resize: function resize() {\n    var self = this;\n    self.instanceBizagiProcessMap.resize();\n  },\n  /**\r\n      * Set plugin activity map, draw sequence map\r\n      */\n  renderActivityMap: function renderActivityMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderActivityMap();\n  },\n\n  renderSubProcessMap: function renderSubProcessMap() {\n    var self = this;\n    self.instanceBizagiProcessMap.renderSubProcessMap();\n  },\n\n  /**\r\n      * Append the activity map zoom\r\n      */\n  appendActivityMapZoom: function appendActivityMapZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendActivityMapZoom();\n  },\n\n  /**\r\n      * Append the process map zoom\r\n      */\n  appendProcessMapZoom: function appendProcessMapZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendProcessMapZoom();\n  },\n\n  /**\r\n      * Append the subprocess zoom\r\n      */\n  appendSubprocessZoom: function appendSubprocessZoom() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendSubprocessZoom();\n  },\n  /**\r\n      * Append the subprocess drag and scroll\r\n      */\n  appendSubprocessDragScroll: function appendSubprocessDragScroll() {\n    var self = this;\n    self.instanceBizagiProcessMap.appendSubprocessDragScroll();\n\n  },\n\n  /**\r\n      * binds the tooltip to each activity in activity map\r\n      */\n  bindTooltip: function bindTooltip(tooltipParams) {\n    var self = this;\n    self.instanceBizagiProcessMap.bindTooltip(tooltipParams);\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.processMap', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.processMap]);","/**\r\n * This module manage graphical diagram of process diagram\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\nbizagi.workportal.widgets.graphicquery.extend(\"bizagi.workportal.widgets.project.processDiagram.helper\", {}, {\n  /**\r\n                                                                                                                * Set Height for process viewer\r\n                                                                                                                * @Overriden\r\n                                                                                                                */\n  getPVHeight: function getPVHeight() {\n    var self = this;\n    var defaultHeight = $(window).height() - 50;\n    var canvasPst = self.$header.height() + 180;\n    var cntHeight = $(\".ui-bizagi-wp-project-tab-content\").height();\n    var cntHeight = cntHeight || defaultHeight;\n    return cntHeight - canvasPst;\n  } });","/*\r\n *   Name: Bizagi Workportal project Activity Sidebar\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activity.sidebar\", {}, {\n\n  /*\r\n                                                                                                     *   Constructor\r\n                                                                                                     */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    params = params || {};\n    params.supportNav = false;\n\n    //Load templates\n    self.loadTemplates({\n      \"project-activity-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activity.sidebar\").concat(\"#project-activity-sidebar\") });\n\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n\n    var template = self.getTemplate(\"project-activity-sidebar\");\n    self.content = template.render({});\n\n    return self.content;\n  } });\n\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.activity.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activity.sidebar]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Activity Map Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\n\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityMap\", {}, {\n  /*\r\n                                                                                                *   Constructor\r\n                                                                                                */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    // Set radNumber\n    self.radNumber = params.radNumber;\n\n    // Call base\n    self._super(workportalFacade, dataService, params);\n\n    //Load templates\n    self.loadTemplates({\n      \"project-activityMap\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activityMap\").concat(\"#project-activityMap-wrapper\") });\n\n  },\n\n  /*\r\n      * Renders the template defined in the widget\r\n      */\n  renderContent: function renderContent() {\n    var self = this;\n    var template = self.getTemplate(\"project-activityMap\");\n\n    self.content = template.render({});\n    return self.content;\n  },\n\n  /*\r\n      * links events with handlers\r\n      */\n  postRender: function postRender() {\n    var self = this;\n\n    //Handlers\n    self.sub(\"HOME\", $.proxy(self.updateView, self));\n    self.sub(\"OVERVIEW\", $.proxy(self.updateView, self));\n    self.sub(\"COMMENTS\", $.proxy(self.updateView, self));\n    self.sub(\"PLANCREATE\", $.proxy(self.updateView, self));\n    self.sub(\"PLANCOMMENTS\", $.proxy(self.updateView, self));\n  },\n\n  updateView: function updateView(event, params) {\n    var self = this,\n    args = params.args,\n    $content = self.getContent().empty();\n\n    var argsTemplate = {};\n    argsTemplate[\"actualState\"] = \"\";\n    if (args.currentState[0]) {\n      argsTemplate[\"actualState\"] = args.currentState[0].state;\n    }\n\n    //Update widget\n    var contentTemplate = self.getTemplate(\"project-activityMap\");\n    contentTemplate.\n    render($.extend(args, argsTemplate)).\n    appendTo($content);\n\n    self.params = args;\n  } });\n\n\nbizagi.injector.register('bizagi.workportal.widgets.project.activityMap', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activityMap], true);","/**\r\n * This module manage the tooltip to show information in activity map and subprocess diagrams\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityMap.tooltip\", {}, {\n\n  /**\r\n                                                                                                        * Constructor\r\n                                                                                                        * @param workportalFacade instance of facade, mandatory\r\n                                                                                                        * @param dataService instance of service tier, mandatory\r\n                                                                                                        * @param params extra params, its not mandatory\r\n                                                                                                        */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n    // Call parent instance\n    self._super(workportalFacade, dataService, params);\n    //Load templates\n    self.loadTemplates({\n      \"project-tooltip\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.activityMap.tooltip\").concat(\"#project-processmap-tooltip\") });\n\n\n    self.cache = {};\n    self.radNumber = params.radNumber;\n  },\n  /**\r\n      * Render a content of the module\r\n      * @return {string} html\r\n      */\n  renderContent: function renderContent() {},\n  /**\r\n                                               * Set binding and set data\r\n                                               */\n  postRender: function postRender() {\n    var self = this;\n    self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\n  },\n  /**\r\n      *  Binds events to handlers\r\n      */\n  configureHandlers: function configureHandlers(content, gqData) {\n    var self = this;\n    content.find('.ui-bizagi-wp-project-processmap-process').on('click', $.proxy(self.onProcess, self, gqData));\n    content.find('.ui-bizagi-wp-project-processmap-tooltip-title').on('click', $.proxy(self.onIdCase, self, gqData));\n  },\n  /**\r\n      * Process handler\r\n      * @param ev\r\n      */\n  onProcess: function onProcess(gqData, ev) {\n    var self = this;\n    self.showGraphicQuery(gqData);\n  },\n  /**\r\n      * Id case handler\r\n      * @param ev\r\n      */\n  onIdCase: function onIdCase(gqData, ev) {\n    var self = this;\n    var idCase = $(ev.currentTarget).data(\"idcase\");\n    var idWorkitem = $(ev.currentTarget).data(\"idworkitem\");\n    var idTask = $(ev.currentTarget).data(\"idtask\");\n    var idWorkflow = $(ev.currentTarget).data(\"idworkflow\");\n\n    self.publish(\"executeAction\", {\n      action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\n      idCase: idCase,\n      idWorkItem: idWorkitem,\n      idTask: idTask,\n      idWorkflow: idWorkflow });\n\n  },\n  /**\r\n      * Binds the tooltip to activities\r\n      * @param params\r\n      */\n  bindTooltip: function bindTooltip(tooltipParams) {\n    var self = this;\n    self.tooltipClass = tooltipParams.tooltipClass;\n    tooltipParams.$container.tooltip({\n      items: tooltipParams.items,\n      content: function content(callback) {\n        var isContanerClicked = tooltipParams.$container.data(\"clicked\") || false;\n        if (isContanerClicked) {\n          return;\n        }\n        var diagram = tooltipParams.diagram;\n        if (diagram == \"activityMap\") {\n          if (!$(this).is(\"circle\")) {\n            return;\n          } else if (this.className.baseVal.indexOf('activity-map-activity-highlight') < 0) {\n            return;\n          }\n          $.when(self.getActivityMapTooltipContent($(this))).done(function (content) {\n            callback(content);\n          });\n        } else {\n          var content = self.getSubprocessTooltipContent($(this));\n          callback(content);\n        }\n        return \"loading..\";\n      },\n      open: function open(event, ui) {\n        for (var i = 0; i < $(\".ui-tooltip\").length - 1; i++) {\n          $('#' + $(\".ui-tooltip\")[i].id).remove();\n        }\n\n      },\n      show: { duration: 60, effect: 'none' },\n      tooltipClass: self.tooltipClass,\n      hide: { delay: 60, duration: 60 },\n      position: { my: \"left+20 top+20\" },\n      close: function close(event, ui) {\n        ui.tooltip.hover(\n        function () {\n          $(this).stop(true).fadeTo(120, 1);\n        },\n        function () {\n          $(this).fadeOut(20, function () {\n            $(this).remove();\n          });\n        });\n\n      } });\n\n  },\n\n  /**\r\n      * Returns the activity map tooltip content\r\n      * @param $ui\r\n      * @returns {*}\r\n      */\n  getActivityMapTooltipContent: function getActivityMapTooltipContent($ui) {\n    var self = this,def = new $.Deferred(),\n    guidWorkitem = $ui.data(\"guidWorkitem\"),\n    idCase = $ui.data(\"idCase\"),\n    idWorkflow = $ui.data(\"idWorkflow\"),\n    params = {\n      guidWorkitem: guidWorkitem,\n      gqData: { idCase: idCase, idWorkflow: idWorkflow } };\n\n    self.guidWorkitem = guidWorkitem;\n\n    if (self.isCached(params.guidWorkitem)) {\n      var data = self.cache[params.guidWorkitem];\n      def.resolve(self.buildContent(data, params.gqData));\n    } else {\n      $.when(self.dataService.getActivitySummary(params)).done(function (data) {\n        def.resolve(self.buildContent(data, params.gqData));\n        self.appendToCache(params.guidWorkitem, data);\n      });\n    }\n    return def.promise();\n  },\n  /**\r\n      * Returns the subprocess tooltip content\r\n      * @param $ui\r\n      * @returns {*}\r\n      */\n  getSubprocessTooltipContent: function getSubprocessTooltipContent($ui) {\n    var self = this,\n    idCase = $ui.data(\"idcase\"),\n    idWorkflow = $ui.data(\"idworkflow\"),\n    params = {\n      gqData: { idCase: idCase, idWorkflow: idWorkflow } };\n\n\n    var data = {\n      \"endDate\": $ui.data(\"enddate\"),\n      \"startDate\": $ui.data(\"startdate\"),\n      \"process\": $ui.data(\"process\"),\n      \"idCase\": $ui.data(\"idcase\") };\n\n    return self.buildContent(data, params.gqData);\n  },\n  /**\r\n      * Fill the cache object with data for respective guidWorkitem\r\n      * @param guidWorkitem\r\n      * @param data\r\n      */\n  appendToCache: function appendToCache(guidWorkitem, data) {\n    var self = this;\n    self.cache[guidWorkitem] = data;\n  },\n  /**\r\n      * Returns true if the guidWorkitem is cached, false otherwise\r\n      * @param guidWorkitem\r\n      * @returns {boolean}\r\n      */\n  isCached: function isCached(guidWorkitem) {\n    var self = this;\n    return typeof self.cache[guidWorkitem] !== \"undefined\";\n  },\n  /**\r\n      * Build the tooltip content\r\n      * @param data\r\n      * @param gqData\r\n      * @returns {*|jQuery|HTMLElement}\r\n      */\n  buildContent: function buildContent(data, gqData) {\n    var self = this,\n    content = $(\"<div></div>\"),\n    tmpl = self.getTemplate(\"project-tooltip\"),\n    assignee = typeof data.assigneeName !== \"undefined\";\n\n    data.assignee = assignee;\n    data.radNumber = self.radNumber;\n    data.idWorkflow = gqData.idWorkflow;\n    data.idTask = data.idTask || 0;\n    data.idWorkitem = data.idWorkItem || 0;\n    data.graphicQuery = bizagi.menuSecurity.GraphicQuery;\n    content = tmpl.render(data);\n    $(\".\" + self.tooltipClass).html(content);\n    bizagi.util.formatInvariantDate(content, self.dateFormat);\n    self.configureHandlers(content, gqData);\n    return content;\n  } });"]}